{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.565921794456434, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0010000000000000002, "total_loss": 8.454737635290241, "policy_loss": -0.0006609662689245199, "vf_loss": 8.468641905915247, "vf_explained_var": 0.27733388924163227, "kl": 0.005012823464180469, "entropy": 1.4245873891327478, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.94520547945206, "num_grad_updates_lifetime": 2190.5, "diff_num_grad_updates_vs_sampler_policy": 2189.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 18680, "num_agent_steps_trained": 18680}, "env_runners": {"episode_reward_max": -2370.8475137010723, "episode_reward_min": -4716.992523151849, "episode_reward_mean": -3456.2945999096955, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 3000, "policy_reward_min": {"policy_0": -1282.0641029422281}, "policy_reward_max": {"policy_0": -13.808750012601902}, "policy_reward_mean": {"policy_0": -691.2589199819392}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3100.1426053381288, -3655.6916648894944, -2599.194846886818, -4271.244414951633, -4013.393183154115, -3312.321389789376, -4109.756553661341, -2896.320361337121, -3875.236413736546, -2975.976674975392, -3508.518428316412, -3867.1808730457665, -3799.318335829713, -2370.8475137010723, -2512.8117100040727, -4288.419495620737, -3067.615676129812, -3538.0101379974362, -2646.8991956770874, -4716.992523151849], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-475.00712595888837, -964.569388813725, -450.25353633424277, -556.5990688492407, -653.7134853820338, -779.3123035543439, -537.8979857599948, -645.0136251656406, -725.7914335944316, -967.6763168150806, -383.4524407120059, -526.0012374875266, -75.06556821428157, -758.0932286587368, -856.5823718142666, -590.80886864979, -1282.0641029422281, -225.30994041811647, -1091.1049010341146, -1081.956601907382, -966.9821296425213, -518.9756694727519, -793.6575912821721, -704.6169298296979, -1029.1608629269751, -788.008684045771, -1280.0774898849954, -979.0189073506547, -90.04481733559739, -175.17149117235854, -38.21573079091705, -835.8455552600507, -1046.9243627924184, -962.863520354764, -1225.907384463195, -546.4708451100246, -974.0744889131515, -487.0214408359895, -38.14104355884631, -850.6125429191073, -500.7299145270452, -937.7714243142025, -1040.2548490593751, -420.8555936393752, -975.6246321965489, -260.86208374867306, -773.8389572542454, -820.3261729842313, -78.69002006775212, -1042.259440920491, -343.10197762185885, -264.7723844943257, -862.6942892994311, -1022.9640244443854, -1014.9857524564093, -1027.8865252181656, -362.4614065468431, -636.5857107238741, -883.1597084155916, -957.0875221412924, -1161.5654890959356, -965.8494412839864, -551.1913742162986, -247.707170201656, -873.0048610318398, -651.27816975771, -769.3864816710311, -237.0222103779482, -399.30374151277596, -313.8569103816063, -365.0687588467011, -831.0557099340258, -693.6675138382573, -23.067484546760095, -599.9522428383289, -808.9696634862463, -888.284692643512, -848.2247485330431, -910.2000708555033, -832.740320102427, -795.5600106459495, -251.20151773411834, -663.1492692098092, -479.6974063683763, -878.0074721715581, -934.5067942304283, -447.1466620940854, -968.055686222893, -550.7877032401972, -637.5132922098334, -772.8296082335257, -66.02229070859036, -13.808750012601902, -1043.6800249655053, -750.558521756864, -1016.5475666005722, -533.3622036095313, -921.6554481197392, -1116.645967138972, -1128.7813376830375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7217994329348134, "mean_inference_ms": 1.7823173038995086, "mean_action_processing_ms": 0.8727350638280461, "mean_env_wait_ms": 11.051651909576716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017811059951782227, "StateBufferConnector_ms": 0.014308691024780273, "ViewRequirementAgentConnector_ms": 0.5093419551849365}, "num_episodes": 20, "episode_return_max": -2370.8475137010723, "episode_return_min": -4716.992523151849, "episode_return_mean": -3456.2945999096955, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18680, "num_agent_steps_trained": 18680, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 65.6317885699211, "num_env_steps_trained_throughput_per_sec": 65.6317885699211, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 18680, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 18680, "timers": {"training_iteration_time_ms": 60946.096, "restore_workers_time_ms": 0.051, "training_step_time_ms": 60945.973, "sample_time_ms": 3585.191, "learn_time_ms": 57295.837, "learn_throughput": 69.813, "synch_weights_time_ms": 61.654}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 18680, "num_agent_steps_trained": 18680}, "done": false, "training_iteration": 1, "trial_id": "efc54_00000", "date": "2024-07-24_18-41-00", "timestamp": 1721826660, "time_this_iter_s": 60.95774817466736, "time_total_s": 60.95774817466736, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x717b99570670>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 60.95774817466736, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 9.912643678160919, "ram_util_percent": 23.29770114942529}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 73.91313215714761, "cur_kl_coeff": 0.19999999999999996, "cur_lr": 0.001, "total_loss": 6.575453182198536, "policy_loss": 0.0007883606004346719, "vf_loss": 6.587727211480853, "vf_explained_var": 0.8516336082453015, "kl": 0.004452040015569963, "entropy": 1.395280009384813, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.88275862068966, "num_grad_updates_lifetime": 6555.5, "diff_num_grad_updates_vs_sampler_policy": 2174.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 37223, "num_agent_steps_trained": 37223}, "env_runners": {"episode_reward_max": -2370.8475137010723, "episode_reward_min": -4925.8961807500455, "episode_reward_mean": -3547.3508285100006, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 6000, "policy_reward_min": {"policy_0": -1282.0641029422281}, "policy_reward_max": {"policy_0": -13.808750012601902}, "policy_reward_mean": {"policy_0": -709.4701657019999}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3100.1426053381288, -3655.6916648894944, -2599.194846886818, -4271.244414951633, -4013.393183154115, -3312.321389789376, -4109.756553661341, -2896.320361337121, -3875.236413736546, -2975.976674975392, -3508.518428316412, -3867.1808730457665, -3799.318335829713, -2370.8475137010723, -2512.8117100040727, -4288.419495620737, -3067.615676129812, -3538.0101379974362, -2646.8991956770874, -4716.992523151849, -3351.2845121528176, -4040.0559589289987, -4141.762869420736, -2818.382898132429, -4406.1166086525045, -4925.8961807500455, -3625.1223696366847, -3942.9588325229756, -4211.902921836197, -3382.19504107639, -4296.7592676401155, -3461.3330831328503, -2941.4437443547527, -2862.0478478150726, -3791.2721298886636, -2778.5181253288115, -3509.53209629346, -3668.4773644682496, -2743.3384362201746, -3869.740853954143], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-475.00712595888837, -964.569388813725, -450.25353633424277, -556.5990688492407, -653.7134853820338, -779.3123035543439, -537.8979857599948, -645.0136251656406, -725.7914335944316, -967.6763168150806, -383.4524407120059, -526.0012374875266, -75.06556821428157, -758.0932286587368, -856.5823718142666, -590.80886864979, -1282.0641029422281, -225.30994041811647, -1091.1049010341146, -1081.956601907382, -966.9821296425213, -518.9756694727519, -793.6575912821721, -704.6169298296979, -1029.1608629269751, -788.008684045771, -1280.0774898849954, -979.0189073506547, -90.04481733559739, -175.17149117235854, -38.21573079091705, -835.8455552600507, -1046.9243627924184, -962.863520354764, -1225.907384463195, -546.4708451100246, -974.0744889131515, -487.0214408359895, -38.14104355884631, -850.6125429191073, -500.7299145270452, -937.7714243142025, -1040.2548490593751, -420.8555936393752, -975.6246321965489, -260.86208374867306, -773.8389572542454, -820.3261729842313, -78.69002006775212, -1042.259440920491, -343.10197762185885, -264.7723844943257, -862.6942892994311, -1022.9640244443854, -1014.9857524564093, -1027.8865252181656, -362.4614065468431, -636.5857107238741, -883.1597084155916, -957.0875221412924, -1161.5654890959356, -965.8494412839864, -551.1913742162986, -247.707170201656, -873.0048610318398, -651.27816975771, -769.3864816710311, -237.0222103779482, -399.30374151277596, -313.8569103816063, -365.0687588467011, -831.0557099340258, -693.6675138382573, -23.067484546760095, -599.9522428383289, -808.9696634862463, -888.284692643512, -848.2247485330431, -910.2000708555033, -832.740320102427, -795.5600106459495, -251.20151773411834, -663.1492692098092, -479.6974063683763, -878.0074721715581, -934.5067942304283, -447.1466620940854, -968.055686222893, -550.7877032401972, -637.5132922098334, -772.8296082335257, -66.02229070859036, -13.808750012601902, -1043.6800249655053, -750.558521756864, -1016.5475666005722, -533.3622036095313, -921.6554481197392, -1116.645967138972, -1128.7813376830375, -1195.3939982433092, -418.4439331909546, -940.6721109366154, -349.052376153659, -447.7220936282799, -1137.6580733239286, -878.3826897132718, -881.1396094660962, -738.3980773744963, -404.4775090512066, -500.0420382647161, -833.1899613458532, -966.8190661394674, -943.8301785341753, -897.8816251365225, -1274.9737836964778, -837.0473003911308, -218.7336439764126, -412.73179591660903, -74.89637415180124, -1073.6835465473291, -1192.5785770240204, -312.95323944157565, -751.6884146867471, -1075.2128309528355, -1040.7094259088865, -951.4901698794461, -956.7167717766057, -908.485837987322, -1068.493975197783, -644.4329037943041, -793.7359059232234, -776.4086716306732, -920.0479894906728, -490.4968987978107, -1019.3552029041315, -769.2197553106283, -897.4501853773601, -842.6889753671451, -414.2447135637125, -395.8026282545485, -917.1728862753106, -1079.5998664152999, -1036.7683191196309, -782.559221771407, -523.2715870696683, -878.6007803555657, -1111.8815674324096, -848.8144725582451, -19.626633660499827, -595.9727516265648, -901.1101607018967, -1078.4289868068659, -1154.3804479358057, -566.8669205689762, -482.9795137785513, -140.38430319499733, -1181.6973056080506, -665.982292251654, -990.2896682995987, -449.5034088829554, -16.205417523262273, -1243.544916874862, -569.22016593576, -662.9698351379117, -245.4585973619411, -631.398848034515, -456.94196899714353, -661.8707162669446, -866.3777171545294, -900.4237906314092, -870.3605365383229, -608.4622615274975, -659.9088618476586, -752.1166793437789, -346.702046718153, -885.7037337770707, -713.9313404133167, -768.0714424393949, -64.10956198087867, -767.7505808441393, -394.04402639188856, -604.7821556766148, -977.1713755176092, -765.7839578632074, -1155.4600917377143, -878.0071098668437, -583.1669429244574, -32.637832530369536, -1019.2053874088656, -616.5491750304124, -100.60632387511431, -279.64970843059535, -639.580045619948, -1106.9531832641037, -897.7112661518684, -1053.66602209255, -766.2981453808461, -962.9479689099554, -189.11745141892348]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6873383759118206, "mean_inference_ms": 1.7673540054125632, "mean_action_processing_ms": 0.8723022140561332, "mean_env_wait_ms": 10.951487578712214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018869638442993164, "StateBufferConnector_ms": 0.013959407806396484, "ViewRequirementAgentConnector_ms": 0.5151122808456421}, "num_episodes": 20, "episode_return_max": -2370.8475137010723, "episode_return_min": -4925.8961807500455, "episode_return_mean": -3547.3508285100006, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37223, "num_agent_steps_trained": 37223, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 70.71553595096029, "num_env_steps_trained_throughput_per_sec": 70.71553595096029, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 37223, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 37223, "timers": {"training_iteration_time_ms": 58755.384, "restore_workers_time_ms": 0.041, "training_step_time_ms": 58755.284, "sample_time_ms": 3502.163, "learn_time_ms": 55198.063, "learn_throughput": 72.466, "synch_weights_time_ms": 52.009}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 37223, "num_agent_steps_trained": 37223}, "done": false, "training_iteration": 2, "trial_id": "efc54_00000", "date": "2024-07-24_18-41-57", "timestamp": 1721826717, "time_this_iter_s": 56.575165033340454, "time_total_s": 117.53291320800781, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d71cc10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 117.53291320800781, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 10.2075, "ram_util_percent": 23.405}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 97.92389905689, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 0.001, "total_loss": 6.000821950306763, "policy_loss": -0.0019659044363678577, "vf_loss": 6.015299127338169, "vf_explained_var": 0.9564289735109957, "kl": 0.009278580737645006, "entropy": 1.3439129751544814, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.61486486486487, "num_grad_updates_lifetime": 10950.5, "diff_num_grad_updates_vs_sampler_policy": 2219.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 56110, "num_agent_steps_trained": 56110}, "env_runners": {"episode_reward_max": -1946.7706171039279, "episode_reward_min": -4925.8961807500455, "episode_reward_mean": -3479.7348378670126, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 12000, "policy_reward_min": {"policy_0": -1282.0641029422281}, "policy_reward_max": {"policy_0": -0.4898393873872917}, "policy_reward_mean": {"policy_0": -695.9469675734025}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3100.1426053381288, -3655.6916648894944, -2599.194846886818, -4271.244414951633, -4013.393183154115, -3312.321389789376, -4109.756553661341, -2896.320361337121, -3875.236413736546, -2975.976674975392, -3508.518428316412, -3867.1808730457665, -3799.318335829713, -2370.8475137010723, -2512.8117100040727, -4288.419495620737, -3067.615676129812, -3538.0101379974362, -2646.8991956770874, -4716.992523151849, -3351.2845121528176, -4040.0559589289987, -4141.762869420736, -2818.382898132429, -4406.1166086525045, -4925.8961807500455, -3625.1223696366847, -3942.9588325229756, -4211.902921836197, -3382.19504107639, -4296.7592676401155, -3461.3330831328503, -2941.4437443547527, -2862.0478478150726, -3791.2721298886636, -2778.5181253288115, -3509.53209629346, -3668.4773644682496, -2743.3384362201746, -3869.740853954143, -1946.7706171039279, -2694.260258871643, -4410.555793742624, -3544.8703574500005, -2666.268173161631, -3369.337684551767, -2700.1540053239414, -2297.597422802779, -2538.3995335306704, -3095.8726333953086, -4080.9545600587367, -3863.8061413424607, -2554.7845478587396, -4341.711917325616, -3326.903389596772, -3634.3403810500845, -3998.312755730753, -2195.3951759394126, -3717.4963075849755, -2643.2048685385976, -3520.5634006556716, -4327.910743656148, -3566.4477074784722, -3568.022029180206, -4189.241147810213, -4144.101158997207, -4368.6542650613155, -3679.823024402295, -3985.654506552553, -3013.3088051511168, -3940.446298248734, -3564.846823045083, -3146.6458409730512, -2490.768164359117, -3226.7513047809452, -4065.3881123723895, -3536.739768393529, -4158.891813300242, -3742.261414605595, -2627.2910349766425], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-475.00712595888837, -964.569388813725, -450.25353633424277, -556.5990688492407, -653.7134853820338, -779.3123035543439, -537.8979857599948, -645.0136251656406, -725.7914335944316, -967.6763168150806, -383.4524407120059, -526.0012374875266, -75.06556821428157, -758.0932286587368, -856.5823718142666, -590.80886864979, -1282.0641029422281, -225.30994041811647, -1091.1049010341146, -1081.956601907382, -966.9821296425213, -518.9756694727519, -793.6575912821721, -704.6169298296979, -1029.1608629269751, -788.008684045771, -1280.0774898849954, -979.0189073506547, -90.04481733559739, -175.17149117235854, -38.21573079091705, -835.8455552600507, -1046.9243627924184, -962.863520354764, -1225.907384463195, -546.4708451100246, -974.0744889131515, -487.0214408359895, -38.14104355884631, -850.6125429191073, -500.7299145270452, -937.7714243142025, -1040.2548490593751, -420.8555936393752, -975.6246321965489, -260.86208374867306, -773.8389572542454, -820.3261729842313, -78.69002006775212, -1042.259440920491, -343.10197762185885, -264.7723844943257, -862.6942892994311, -1022.9640244443854, -1014.9857524564093, -1027.8865252181656, -362.4614065468431, -636.5857107238741, -883.1597084155916, -957.0875221412924, -1161.5654890959356, -965.8494412839864, -551.1913742162986, -247.707170201656, -873.0048610318398, -651.27816975771, -769.3864816710311, -237.0222103779482, -399.30374151277596, -313.8569103816063, -365.0687588467011, -831.0557099340258, -693.6675138382573, -23.067484546760095, -599.9522428383289, -808.9696634862463, -888.284692643512, -848.2247485330431, -910.2000708555033, -832.740320102427, -795.5600106459495, -251.20151773411834, -663.1492692098092, -479.6974063683763, -878.0074721715581, -934.5067942304283, -447.1466620940854, -968.055686222893, -550.7877032401972, -637.5132922098334, -772.8296082335257, -66.02229070859036, -13.808750012601902, -1043.6800249655053, -750.558521756864, -1016.5475666005722, -533.3622036095313, -921.6554481197392, -1116.645967138972, -1128.7813376830375, -1195.3939982433092, -418.4439331909546, -940.6721109366154, -349.052376153659, -447.7220936282799, -1137.6580733239286, -878.3826897132718, -881.1396094660962, -738.3980773744963, -404.4775090512066, -500.0420382647161, -833.1899613458532, -966.8190661394674, -943.8301785341753, -897.8816251365225, -1274.9737836964778, -837.0473003911308, -218.7336439764126, -412.73179591660903, -74.89637415180124, -1073.6835465473291, -1192.5785770240204, -312.95323944157565, -751.6884146867471, -1075.2128309528355, -1040.7094259088865, -951.4901698794461, -956.7167717766057, -908.485837987322, -1068.493975197783, -644.4329037943041, -793.7359059232234, -776.4086716306732, -920.0479894906728, -490.4968987978107, -1019.3552029041315, -769.2197553106283, -897.4501853773601, -842.6889753671451, -414.2447135637125, -395.8026282545485, -917.1728862753106, -1079.5998664152999, -1036.7683191196309, -782.559221771407, -523.2715870696683, -878.6007803555657, -1111.8815674324096, -848.8144725582451, -19.626633660499827, -595.9727516265648, -901.1101607018967, -1078.4289868068659, -1154.3804479358057, -566.8669205689762, -482.9795137785513, -140.38430319499733, -1181.6973056080506, -665.982292251654, -990.2896682995987, -449.5034088829554, -16.205417523262273, -1243.544916874862, -569.22016593576, -662.9698351379117, -245.4585973619411, -631.398848034515, -456.94196899714353, -661.8707162669446, -866.3777171545294, -900.4237906314092, -870.3605365383229, -608.4622615274975, -659.9088618476586, -752.1166793437789, -346.702046718153, -885.7037337770707, -713.9313404133167, -768.0714424393949, -64.10956198087867, -767.7505808441393, -394.04402639188856, -604.7821556766148, -977.1713755176092, -765.7839578632074, -1155.4600917377143, -878.0071098668437, -583.1669429244574, -32.637832530369536, -1019.2053874088656, -616.5491750304124, -100.60632387511431, -279.64970843059535, -639.580045619948, -1106.9531832641037, -897.7112661518684, -1053.66602209255, -766.2981453808461, -962.9479689099554, -189.11745141892348, -496.15618966319136, -1000.6077778512519, -325.454217075057, -90.5196776559875, -34.032754858439446, -857.3037273768324, -685.5345596068307, -435.40604810618385, -204.28234353407942, -511.73358024771744, -553.6376799050505, -828.8582296151543, -1186.727523868753, -932.726718654213, -908.6056416994536, -1075.0537758820833, -985.5925916858749, -23.567761288539877, -759.7344180864984, -700.9218105070015, -875.5925582317066, -324.0508736494884, -597.8893144512945, -145.15600817047653, -723.5794186586658, -893.7750085868219, -791.288328925321, -708.5208768707093, -210.56082648355604, -765.1926436853602, -505.0610294615311, -1054.5744943137015, -394.88931872869983, -280.26868853918285, -465.3604742808255, -513.1328147926899, -133.66531758127434, -844.2661407861167, -339.117595903146, -467.4155537395528, -860.4739208699849, -60.45179965299403, -121.99313530450046, -1118.571691380577, -376.90898632261445, -836.8368859056653, -609.2608758565528, -1101.0287675984953, -446.3165238249662, -102.42958020963246, -890.8548201719128, -714.8565301474524, -884.9942500141289, -611.1072121726921, -979.1417475525509, -919.3650250666774, -312.1362813506636, -944.7809549319334, -1058.9972933199103, -628.5265866732753, -555.7852339254911, -436.5851268510472, -395.32816172433814, -304.570569533276, -862.5154558245881, -901.4262348234341, -632.2057401040914, -956.109154596178, -706.0174798026496, -1145.953307999266, -650.134924604709, -35.84829432254958, -766.8611804072308, -1043.0160030309644, -831.0429872313176, -628.1148432398703, -584.6980398800746, -826.9460668607677, -793.9915710424373, -800.5898600269381, -773.3512311882814, -1055.5078114925693, -962.1249707512227, -949.3796579743583, -257.94908432431686, -153.92691139813763, -693.2333541764866, -267.5991157428729, -901.7792145334479, -178.85658008846394, -1067.615287410732, -287.45618589410356, -878.6384801213939, -1063.9348619303616, -419.8514922283885, -389.55340136577047, -536.8330105046124, -507.55818819112, -600.0088689448152, -609.2513995322767, -577.287775776532, -723.7172283942836, -510.20117249942547, -596.2012073157487, -1113.1560166696845, -518.0121947158436, -1099.237745122749, -1113.3212860337585, -875.886684088041, -721.4528336957603, -846.5347500004843, -861.2449974085578, -938.080311726214, -433.50948870869644, -487.07815963451753, -150.01113443378108, -1153.2821666916327, -55.064845295197486, -1061.6278983145985, -1148.0359844449993, -979.427342005782, -961.732977094883, -638.2042104286495, -920.3116698165667, -689.5649484643361, -963.6306472971645, -739.0180630470097, -876.7282137508566, -687.8814979328542, -876.8427369693238, -813.7328405093173, -954.0676433995111, -883.5446574418952, -794.902912872606, -922.406210837987, -1161.0362463401486, -856.5286304248158, -952.0681190523466, -396.73116572704754, -313.4588628579341, -1017.8059946849155, -186.6862580565787, -991.0096890114978, -850.1523924938784, -940.0001723056806, -290.1707830566428, -853.358256033946, -1031.826553243265, -561.4669840331635, -276.4862287840965, -774.0534218785997, -885.725407757887, -818.7862285087741, -719.4958654906666, -742.3853746128061, -889.0167826265828, -366.7286263199362, -791.6660881137598, -1179.0094865923097, -338.42583939249977, -923.2072029236705, -799.1087834609497, -710.9985862389955, -610.2863183739528, -103.04494997548315, -409.249483194042, -153.14355785399428, -515.2892920864099, -560.2239478553645, -852.8618833693072, -550.6056597960369, -0.4898393873872917, -914.5910649769734, -770.2556796680541, -990.8090609524924, -803.8793562217927, -1201.1446592993802, -1162.340404576143, -886.9127306082125, -11.110961666858554, -1156.7869657905571, -36.65413415178543, -616.6164813770088, -882.3923293257516, -844.2898577484275, -796.8151866093102, -593.1144581823089, -829.4379092992322, -895.2000486101439, -1044.324210599243, -269.9128751027733, -712.0916945888504, -961.4518144195208, -605.7512425718032, -1193.0537879226504, -929.8186848906947, -77.58928418751407, -798.024491495509, -758.1648331568363, -63.69374124608862]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6496458426021128, "mean_inference_ms": 1.7527113152353775, "mean_action_processing_ms": 0.8694457730200291, "mean_env_wait_ms": 10.846957452793708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01669764518737793, "StateBufferConnector_ms": 0.012555122375488281, "ViewRequirementAgentConnector_ms": 0.475006103515625}, "num_episodes": 40, "episode_return_max": -1946.7706171039279, "episode_return_min": -4925.8961807500455, "episode_return_mean": -3479.7348378670126, "episodes_this_iter": 40}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56110, "num_agent_steps_trained": 56110, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 65.13610553098155, "num_env_steps_trained_throughput_per_sec": 65.13610553098155, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 56110, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56110, "timers": {"training_iteration_time_ms": 59640.217, "restore_workers_time_ms": 0.035, "training_step_time_ms": 59640.13, "sample_time_ms": 3479.643, "learn_time_ms": 56105.238, "learn_throughput": 71.295, "synch_weights_time_ms": 52.107}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 56110, "num_agent_steps_trained": 56110}, "done": false, "training_iteration": 3, "trial_id": "efc54_00000", "date": "2024-07-24_18-42-58", "timestamp": 1721826778, "time_this_iter_s": 61.42193651199341, "time_total_s": 178.95484972000122, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d71e050>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 178.95484972000122, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 9.788505747126438, "ram_util_percent": 23.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 118.52116759120742, "cur_kl_coeff": 0.09999999999999998, "cur_lr": 0.001, "total_loss": 5.637046038915241, "policy_loss": -0.0031936823043455117, "vf_loss": 5.6533218950371085, "vf_explained_var": 0.9770069141642036, "kl": 0.00999481849679726, "entropy": 1.4081647611799695, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.39455782312925, "num_grad_updates_lifetime": 15375.5, "diff_num_grad_updates_vs_sampler_policy": 2204.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 74837, "num_agent_steps_trained": 74837}, "env_runners": {"episode_reward_max": -1919.0555072134846, "episode_reward_min": -4925.8961807500455, "episode_reward_mean": -3521.2369426427267, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1300.227821923066}, "policy_reward_max": {"policy_0": -0.4898393873872917}, "policy_reward_mean": {"policy_0": -704.2473885285453}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3100.1426053381288, -3655.6916648894944, -2599.194846886818, -4271.244414951633, -4013.393183154115, -3312.321389789376, -4109.756553661341, -2896.320361337121, -3875.236413736546, -2975.976674975392, -3508.518428316412, -3867.1808730457665, -3799.318335829713, -2370.8475137010723, -2512.8117100040727, -4288.419495620737, -3067.615676129812, -3538.0101379974362, -2646.8991956770874, -4716.992523151849, -3351.2845121528176, -4040.0559589289987, -4141.762869420736, -2818.382898132429, -4406.1166086525045, -4925.8961807500455, -3625.1223696366847, -3942.9588325229756, -4211.902921836197, -3382.19504107639, -4296.7592676401155, -3461.3330831328503, -2941.4437443547527, -2862.0478478150726, -3791.2721298886636, -2778.5181253288115, -3509.53209629346, -3668.4773644682496, -2743.3384362201746, -3869.740853954143, -1946.7706171039279, -2694.260258871643, -4410.555793742624, -3544.8703574500005, -2666.268173161631, -3369.337684551767, -2700.1540053239414, -2297.597422802779, -2538.3995335306704, -3095.8726333953086, -4080.9545600587367, -3863.8061413424607, -2554.7845478587396, -4341.711917325616, -3326.903389596772, -3634.3403810500845, -3998.312755730753, -2195.3951759394126, -3717.4963075849755, -2643.2048685385976, -3520.5634006556716, -4327.910743656148, -3566.4477074784722, -3568.022029180206, -4189.241147810213, -4144.101158997207, -4368.6542650613155, -3679.823024402295, -3985.654506552553, -3013.3088051511168, -3940.446298248734, -3564.846823045083, -3146.6458409730512, -2490.768164359117, -3226.7513047809452, -4065.3881123723895, -3536.739768393529, -4158.891813300242, -3742.261414605595, -2627.2910349766425, -4237.199307482893, -4155.346256344119, -4102.091677801175, -3217.3673936536807, -3399.259759851859, -3024.968667764605, -3668.05871142529, -1919.0555072134846, -4330.86807637279, -3052.262328429212, -4670.648733605028, -2908.3640527104108, -4255.981295948644, -3867.9767755827315, -4702.1139093455095, -4516.518452691654, -2059.1967857095824, -4037.321708924428, -4071.0313493714934, -3549.276484683152], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-475.00712595888837, -964.569388813725, -450.25353633424277, -556.5990688492407, -653.7134853820338, -779.3123035543439, -537.8979857599948, -645.0136251656406, -725.7914335944316, -967.6763168150806, -383.4524407120059, -526.0012374875266, -75.06556821428157, -758.0932286587368, -856.5823718142666, -590.80886864979, -1282.0641029422281, -225.30994041811647, -1091.1049010341146, -1081.956601907382, -966.9821296425213, -518.9756694727519, -793.6575912821721, -704.6169298296979, -1029.1608629269751, -788.008684045771, -1280.0774898849954, -979.0189073506547, -90.04481733559739, -175.17149117235854, -38.21573079091705, -835.8455552600507, -1046.9243627924184, -962.863520354764, -1225.907384463195, -546.4708451100246, -974.0744889131515, -487.0214408359895, -38.14104355884631, -850.6125429191073, -500.7299145270452, -937.7714243142025, -1040.2548490593751, -420.8555936393752, -975.6246321965489, -260.86208374867306, -773.8389572542454, -820.3261729842313, -78.69002006775212, -1042.259440920491, -343.10197762185885, -264.7723844943257, -862.6942892994311, -1022.9640244443854, -1014.9857524564093, -1027.8865252181656, -362.4614065468431, -636.5857107238741, -883.1597084155916, -957.0875221412924, -1161.5654890959356, -965.8494412839864, -551.1913742162986, -247.707170201656, -873.0048610318398, -651.27816975771, -769.3864816710311, -237.0222103779482, -399.30374151277596, -313.8569103816063, -365.0687588467011, -831.0557099340258, -693.6675138382573, -23.067484546760095, -599.9522428383289, -808.9696634862463, -888.284692643512, -848.2247485330431, -910.2000708555033, -832.740320102427, -795.5600106459495, -251.20151773411834, -663.1492692098092, -479.6974063683763, -878.0074721715581, -934.5067942304283, -447.1466620940854, -968.055686222893, -550.7877032401972, -637.5132922098334, -772.8296082335257, -66.02229070859036, -13.808750012601902, -1043.6800249655053, -750.558521756864, -1016.5475666005722, -533.3622036095313, -921.6554481197392, -1116.645967138972, -1128.7813376830375, -1195.3939982433092, -418.4439331909546, -940.6721109366154, -349.052376153659, -447.7220936282799, -1137.6580733239286, -878.3826897132718, -881.1396094660962, -738.3980773744963, -404.4775090512066, -500.0420382647161, -833.1899613458532, -966.8190661394674, -943.8301785341753, -897.8816251365225, -1274.9737836964778, -837.0473003911308, -218.7336439764126, -412.73179591660903, -74.89637415180124, -1073.6835465473291, -1192.5785770240204, -312.95323944157565, -751.6884146867471, -1075.2128309528355, -1040.7094259088865, -951.4901698794461, -956.7167717766057, -908.485837987322, -1068.493975197783, -644.4329037943041, -793.7359059232234, -776.4086716306732, -920.0479894906728, -490.4968987978107, -1019.3552029041315, -769.2197553106283, -897.4501853773601, -842.6889753671451, -414.2447135637125, -395.8026282545485, -917.1728862753106, -1079.5998664152999, -1036.7683191196309, -782.559221771407, -523.2715870696683, -878.6007803555657, -1111.8815674324096, -848.8144725582451, -19.626633660499827, -595.9727516265648, -901.1101607018967, -1078.4289868068659, -1154.3804479358057, -566.8669205689762, -482.9795137785513, -140.38430319499733, -1181.6973056080506, -665.982292251654, -990.2896682995987, -449.5034088829554, -16.205417523262273, -1243.544916874862, -569.22016593576, -662.9698351379117, -245.4585973619411, -631.398848034515, -456.94196899714353, -661.8707162669446, -866.3777171545294, -900.4237906314092, -870.3605365383229, -608.4622615274975, -659.9088618476586, -752.1166793437789, -346.702046718153, -885.7037337770707, -713.9313404133167, -768.0714424393949, -64.10956198087867, -767.7505808441393, -394.04402639188856, -604.7821556766148, -977.1713755176092, -765.7839578632074, -1155.4600917377143, -878.0071098668437, -583.1669429244574, -32.637832530369536, -1019.2053874088656, -616.5491750304124, -100.60632387511431, -279.64970843059535, -639.580045619948, -1106.9531832641037, -897.7112661518684, -1053.66602209255, -766.2981453808461, -962.9479689099554, -189.11745141892348, -496.15618966319136, -1000.6077778512519, -325.454217075057, -90.5196776559875, -34.032754858439446, -857.3037273768324, -685.5345596068307, -435.40604810618385, -204.28234353407942, -511.73358024771744, -553.6376799050505, -828.8582296151543, -1186.727523868753, -932.726718654213, -908.6056416994536, -1075.0537758820833, -985.5925916858749, -23.567761288539877, -759.7344180864984, -700.9218105070015, -875.5925582317066, -324.0508736494884, -597.8893144512945, -145.15600817047653, -723.5794186586658, -893.7750085868219, -791.288328925321, -708.5208768707093, -210.56082648355604, -765.1926436853602, -505.0610294615311, -1054.5744943137015, -394.88931872869983, -280.26868853918285, -465.3604742808255, -513.1328147926899, -133.66531758127434, -844.2661407861167, -339.117595903146, -467.4155537395528, -860.4739208699849, -60.45179965299403, -121.99313530450046, -1118.571691380577, -376.90898632261445, -836.8368859056653, -609.2608758565528, -1101.0287675984953, -446.3165238249662, -102.42958020963246, -890.8548201719128, -714.8565301474524, -884.9942500141289, -611.1072121726921, -979.1417475525509, -919.3650250666774, -312.1362813506636, -944.7809549319334, -1058.9972933199103, -628.5265866732753, -555.7852339254911, -436.5851268510472, -395.32816172433814, -304.570569533276, -862.5154558245881, -901.4262348234341, -632.2057401040914, -956.109154596178, -706.0174798026496, -1145.953307999266, -650.134924604709, -35.84829432254958, -766.8611804072308, -1043.0160030309644, -831.0429872313176, -628.1148432398703, -584.6980398800746, -826.9460668607677, -793.9915710424373, -800.5898600269381, -773.3512311882814, -1055.5078114925693, -962.1249707512227, -949.3796579743583, -257.94908432431686, -153.92691139813763, -693.2333541764866, -267.5991157428729, -901.7792145334479, -178.85658008846394, -1067.615287410732, -287.45618589410356, -878.6384801213939, -1063.9348619303616, -419.8514922283885, -389.55340136577047, -536.8330105046124, -507.55818819112, -600.0088689448152, -609.2513995322767, -577.287775776532, -723.7172283942836, -510.20117249942547, -596.2012073157487, -1113.1560166696845, -518.0121947158436, -1099.237745122749, -1113.3212860337585, -875.886684088041, -721.4528336957603, -846.5347500004843, -861.2449974085578, -938.080311726214, -433.50948870869644, -487.07815963451753, -150.01113443378108, -1153.2821666916327, -55.064845295197486, -1061.6278983145985, -1148.0359844449993, -979.427342005782, -961.732977094883, -638.2042104286495, -920.3116698165667, -689.5649484643361, -963.6306472971645, -739.0180630470097, -876.7282137508566, -687.8814979328542, -876.8427369693238, -813.7328405093173, -954.0676433995111, -883.5446574418952, -794.902912872606, -922.406210837987, -1161.0362463401486, -856.5286304248158, -952.0681190523466, -396.73116572704754, -313.4588628579341, -1017.8059946849155, -186.6862580565787, -991.0096890114978, -850.1523924938784, -940.0001723056806, -290.1707830566428, -853.358256033946, -1031.826553243265, -561.4669840331635, -276.4862287840965, -774.0534218785997, -885.725407757887, -818.7862285087741, -719.4958654906666, -742.3853746128061, -889.0167826265828, -366.7286263199362, -791.6660881137598, -1179.0094865923097, -338.42583939249977, -923.2072029236705, -799.1087834609497, -710.9985862389955, -610.2863183739528, -103.04494997548315, -409.249483194042, -153.14355785399428, -515.2892920864099, -560.2239478553645, -852.8618833693072, -550.6056597960369, -0.4898393873872917, -914.5910649769734, -770.2556796680541, -990.8090609524924, -803.8793562217927, -1201.1446592993802, -1162.340404576143, -886.9127306082125, -11.110961666858554, -1156.7869657905571, -36.65413415178543, -616.6164813770088, -882.3923293257516, -844.2898577484275, -796.8151866093102, -593.1144581823089, -829.4379092992322, -895.2000486101439, -1044.324210599243, -269.9128751027733, -712.0916945888504, -961.4518144195208, -605.7512425718032, -1193.0537879226504, -929.8186848906947, -77.58928418751407, -798.024491495509, -758.1648331568363, -63.69374124608862, -798.0582406318587, -1059.075202896564, -1198.1652547297897, -377.4016767293646, -804.4989324953194, -749.8961248174843, -1000.2402916447915, -1026.1313446731442, -594.1220063932824, -784.9564888154209, -719.7197096076069, -679.1634521615665, -819.5986732332665, -1141.0606492654124, -742.5491935333242, -1140.3323745192597, -1013.6403468461552, -69.25675118762179, -50.298598329510746, -943.8393227711309, -1281.0719104220627, -485.61508077002145, -396.74192972501294, -1164.4654209217472, -71.36541801301847, -156.81728594624735, -170.0867441650268, -938.449184443208, -758.7908187246467, -1000.8246344854748, -746.9634638568498, -590.1469735912345, -1084.686957820186, -488.4552672085627, -757.8060489484631, -844.0383537445471, -174.9381059041416, -679.6512425674355, -26.919507428925805, -193.50829756843328, -888.0344986631759, -832.0542222690868, -808.2843448978481, -920.8048867737139, -881.6901237689636, -875.8095449092957, -744.6903167208297, -553.2758430892699, -124.44926900798839, -754.037354701826, -813.5777689167662, -1073.559396971199, -1005.0845503937512, -704.525123807182, -1073.9018935161262, -882.2691990474285, -585.0562193168427, -112.25783350923928, -555.9440687642964, -772.8367320726011, -1213.2876079445916, -697.3245192667326, -668.8647480998748, -776.0080842220023, -900.4963364154434, -418.7889859253863, -244.08344528096185, -1002.438943644751, -1105.6523791646855, -1097.013021566946, -1098.7764767777728, -914.7545804278478, -1015.258348525818, -721.4973874785102, -951.8271161355614, -957.2770173971181, -1121.6479158960171, -858.2874434262761, -719.4892787155684, -859.8167972566708, -920.0267038377226, -711.9341248641534, -17.270620022482476, -39.27888394112452, -370.6864530440992, -316.8063217936393, -1155.4430868230263, -762.6152081001204, -914.8853693816352, -887.5717228260063, -927.3284694388781, -1068.9631937777363, -1182.302669681392, -696.6566929586727, -195.78032351481113, -883.3226963660663, -895.4705232374711, -467.338926450441, -1300.227821923066, -2.9165167061074047]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.644161397270493, "mean_inference_ms": 1.7499578266048408, "mean_action_processing_ms": 0.8688039819506339, "mean_env_wait_ms": 10.838908946814293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016718626022338867, "StateBufferConnector_ms": 0.012575626373291016, "ViewRequirementAgentConnector_ms": 0.4807462692260742}, "num_episodes": 20, "episode_return_max": -1919.0555072134846, "episode_return_min": -4925.8961807500455, "episode_return_mean": -3521.2369426427267, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 74837, "num_agent_steps_trained": 74837, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 65.84023047339474, "num_env_steps_trained_throughput_per_sec": 65.84023047339474, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 74837, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 74837, "timers": {"training_iteration_time_ms": 59918.449, "restore_workers_time_ms": 0.034, "training_step_time_ms": 59918.364, "sample_time_ms": 3488.25, "learn_time_ms": 56371.51, "learn_throughput": 70.958, "synch_weights_time_ms": 55.36}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 74837, "num_agent_steps_trained": 74837}, "done": false, "training_iteration": 4, "trial_id": "efc54_00000", "date": "2024-07-24_18-43-59", "timestamp": 1721826839, "time_this_iter_s": 60.763341426849365, "time_total_s": 239.7181911468506, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d71e3b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 239.7181911468506, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 9.9816091954023, "ram_util_percent": 23.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 141.01119254996243, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 0.0010000000000000002, "total_loss": 5.13222372989132, "policy_loss": -0.00171413830546322, "vf_loss": 5.147631080618732, "vf_explained_var": 0.979359428523338, "kl": 0.00810985985748854, "entropy": 1.4504204296902434, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.5068493150685, "num_grad_updates_lifetime": 19770.5, "diff_num_grad_updates_vs_sampler_policy": 2189.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 93453, "num_agent_steps_trained": 93453}, "env_runners": {"episode_reward_max": -1919.0555072134846, "episode_reward_min": -4925.8961807500455, "episode_reward_mean": -3499.5513899874895, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1304.2835778585659}, "policy_reward_max": {"policy_0": -0.4898393873872917}, "policy_reward_mean": {"policy_0": -699.910277997498}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3351.2845121528176, -4040.0559589289987, -4141.762869420736, -2818.382898132429, -4406.1166086525045, -4925.8961807500455, -3625.1223696366847, -3942.9588325229756, -4211.902921836197, -3382.19504107639, -4296.7592676401155, -3461.3330831328503, -2941.4437443547527, -2862.0478478150726, -3791.2721298886636, -2778.5181253288115, -3509.53209629346, -3668.4773644682496, -2743.3384362201746, -3869.740853954143, -1946.7706171039279, -2694.260258871643, -4410.555793742624, -3544.8703574500005, -2666.268173161631, -3369.337684551767, -2700.1540053239414, -2297.597422802779, -2538.3995335306704, -3095.8726333953086, -4080.9545600587367, -3863.8061413424607, -2554.7845478587396, -4341.711917325616, -3326.903389596772, -3634.3403810500845, -3998.312755730753, -2195.3951759394126, -3717.4963075849755, -2643.2048685385976, -3520.5634006556716, -4327.910743656148, -3566.4477074784722, -3568.022029180206, -4189.241147810213, -4144.101158997207, -4368.6542650613155, -3679.823024402295, -3985.654506552553, -3013.3088051511168, -3940.446298248734, -3564.846823045083, -3146.6458409730512, -2490.768164359117, -3226.7513047809452, -4065.3881123723895, -3536.739768393529, -4158.891813300242, -3742.261414605595, -2627.2910349766425, -4237.199307482893, -4155.346256344119, -4102.091677801175, -3217.3673936536807, -3399.259759851859, -3024.968667764605, -3668.05871142529, -1919.0555072134846, -4330.86807637279, -3052.262328429212, -4670.648733605028, -2908.3640527104108, -4255.981295948644, -3867.9767755827315, -4702.1139093455095, -4516.518452691654, -2059.1967857095824, -4037.321708924428, -4071.0313493714934, -3549.276484683152, -3944.5908429895176, -2842.660221455312, -4660.77723445276, -3957.3182101150137, -3373.4459044398386, -2744.813865172942, -3470.458992577602, -4351.740520398174, -4309.123129319183, -2903.89662407099, -3172.9410137859213, -2966.036504706872, -2690.1589680630514, -2860.0395898727256, -2137.670129494542, -3401.3651769366897, -4034.166491026194, -2197.812824263542, -3371.4957488027817, -3566.8247407265653], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1195.3939982433092, -418.4439331909546, -940.6721109366154, -349.052376153659, -447.7220936282799, -1137.6580733239286, -878.3826897132718, -881.1396094660962, -738.3980773744963, -404.4775090512066, -500.0420382647161, -833.1899613458532, -966.8190661394674, -943.8301785341753, -897.8816251365225, -1274.9737836964778, -837.0473003911308, -218.7336439764126, -412.73179591660903, -74.89637415180124, -1073.6835465473291, -1192.5785770240204, -312.95323944157565, -751.6884146867471, -1075.2128309528355, -1040.7094259088865, -951.4901698794461, -956.7167717766057, -908.485837987322, -1068.493975197783, -644.4329037943041, -793.7359059232234, -776.4086716306732, -920.0479894906728, -490.4968987978107, -1019.3552029041315, -769.2197553106283, -897.4501853773601, -842.6889753671451, -414.2447135637125, -395.8026282545485, -917.1728862753106, -1079.5998664152999, -1036.7683191196309, -782.559221771407, -523.2715870696683, -878.6007803555657, -1111.8815674324096, -848.8144725582451, -19.626633660499827, -595.9727516265648, -901.1101607018967, -1078.4289868068659, -1154.3804479358057, -566.8669205689762, -482.9795137785513, -140.38430319499733, -1181.6973056080506, -665.982292251654, -990.2896682995987, -449.5034088829554, -16.205417523262273, -1243.544916874862, -569.22016593576, -662.9698351379117, -245.4585973619411, -631.398848034515, -456.94196899714353, -661.8707162669446, -866.3777171545294, -900.4237906314092, -870.3605365383229, -608.4622615274975, -659.9088618476586, -752.1166793437789, -346.702046718153, -885.7037337770707, -713.9313404133167, -768.0714424393949, -64.10956198087867, -767.7505808441393, -394.04402639188856, -604.7821556766148, -977.1713755176092, -765.7839578632074, -1155.4600917377143, -878.0071098668437, -583.1669429244574, -32.637832530369536, -1019.2053874088656, -616.5491750304124, -100.60632387511431, -279.64970843059535, -639.580045619948, -1106.9531832641037, -897.7112661518684, -1053.66602209255, -766.2981453808461, -962.9479689099554, -189.11745141892348, -496.15618966319136, -1000.6077778512519, -325.454217075057, -90.5196776559875, -34.032754858439446, -857.3037273768324, -685.5345596068307, -435.40604810618385, -204.28234353407942, -511.73358024771744, -553.6376799050505, -828.8582296151543, -1186.727523868753, -932.726718654213, -908.6056416994536, -1075.0537758820833, -985.5925916858749, -23.567761288539877, -759.7344180864984, -700.9218105070015, -875.5925582317066, -324.0508736494884, -597.8893144512945, -145.15600817047653, -723.5794186586658, -893.7750085868219, -791.288328925321, -708.5208768707093, -210.56082648355604, -765.1926436853602, -505.0610294615311, -1054.5744943137015, -394.88931872869983, -280.26868853918285, -465.3604742808255, -513.1328147926899, -133.66531758127434, -844.2661407861167, -339.117595903146, -467.4155537395528, -860.4739208699849, -60.45179965299403, -121.99313530450046, -1118.571691380577, -376.90898632261445, -836.8368859056653, -609.2608758565528, -1101.0287675984953, -446.3165238249662, -102.42958020963246, -890.8548201719128, -714.8565301474524, -884.9942500141289, -611.1072121726921, -979.1417475525509, -919.3650250666774, -312.1362813506636, -944.7809549319334, -1058.9972933199103, -628.5265866732753, -555.7852339254911, -436.5851268510472, -395.32816172433814, -304.570569533276, -862.5154558245881, -901.4262348234341, -632.2057401040914, -956.109154596178, -706.0174798026496, -1145.953307999266, -650.134924604709, -35.84829432254958, -766.8611804072308, -1043.0160030309644, -831.0429872313176, -628.1148432398703, -584.6980398800746, -826.9460668607677, -793.9915710424373, -800.5898600269381, -773.3512311882814, -1055.5078114925693, -962.1249707512227, -949.3796579743583, -257.94908432431686, -153.92691139813763, -693.2333541764866, -267.5991157428729, -901.7792145334479, -178.85658008846394, -1067.615287410732, -287.45618589410356, -878.6384801213939, -1063.9348619303616, -419.8514922283885, -389.55340136577047, -536.8330105046124, -507.55818819112, -600.0088689448152, -609.2513995322767, -577.287775776532, -723.7172283942836, -510.20117249942547, -596.2012073157487, -1113.1560166696845, -518.0121947158436, -1099.237745122749, -1113.3212860337585, -875.886684088041, -721.4528336957603, -846.5347500004843, -861.2449974085578, -938.080311726214, -433.50948870869644, -487.07815963451753, -150.01113443378108, -1153.2821666916327, -55.064845295197486, -1061.6278983145985, -1148.0359844449993, -979.427342005782, -961.732977094883, -638.2042104286495, -920.3116698165667, -689.5649484643361, -963.6306472971645, -739.0180630470097, -876.7282137508566, -687.8814979328542, -876.8427369693238, -813.7328405093173, -954.0676433995111, -883.5446574418952, -794.902912872606, -922.406210837987, -1161.0362463401486, -856.5286304248158, -952.0681190523466, -396.73116572704754, -313.4588628579341, -1017.8059946849155, -186.6862580565787, -991.0096890114978, -850.1523924938784, -940.0001723056806, -290.1707830566428, -853.358256033946, -1031.826553243265, -561.4669840331635, -276.4862287840965, -774.0534218785997, -885.725407757887, -818.7862285087741, -719.4958654906666, -742.3853746128061, -889.0167826265828, -366.7286263199362, -791.6660881137598, -1179.0094865923097, -338.42583939249977, -923.2072029236705, -799.1087834609497, -710.9985862389955, -610.2863183739528, -103.04494997548315, -409.249483194042, -153.14355785399428, -515.2892920864099, -560.2239478553645, -852.8618833693072, -550.6056597960369, -0.4898393873872917, -914.5910649769734, -770.2556796680541, -990.8090609524924, -803.8793562217927, -1201.1446592993802, -1162.340404576143, -886.9127306082125, -11.110961666858554, -1156.7869657905571, -36.65413415178543, -616.6164813770088, -882.3923293257516, -844.2898577484275, -796.8151866093102, -593.1144581823089, -829.4379092992322, -895.2000486101439, -1044.324210599243, -269.9128751027733, -712.0916945888504, -961.4518144195208, -605.7512425718032, -1193.0537879226504, -929.8186848906947, -77.58928418751407, -798.024491495509, -758.1648331568363, -63.69374124608862, -798.0582406318587, -1059.075202896564, -1198.1652547297897, -377.4016767293646, -804.4989324953194, -749.8961248174843, -1000.2402916447915, -1026.1313446731442, -594.1220063932824, -784.9564888154209, -719.7197096076069, -679.1634521615665, -819.5986732332665, -1141.0606492654124, -742.5491935333242, -1140.3323745192597, -1013.6403468461552, -69.25675118762179, -50.298598329510746, -943.8393227711309, -1281.0719104220627, -485.61508077002145, -396.74192972501294, -1164.4654209217472, -71.36541801301847, -156.81728594624735, -170.0867441650268, -938.449184443208, -758.7908187246467, -1000.8246344854748, -746.9634638568498, -590.1469735912345, -1084.686957820186, -488.4552672085627, -757.8060489484631, -844.0383537445471, -174.9381059041416, -679.6512425674355, -26.919507428925805, -193.50829756843328, -888.0344986631759, -832.0542222690868, -808.2843448978481, -920.8048867737139, -881.6901237689636, -875.8095449092957, -744.6903167208297, -553.2758430892699, -124.44926900798839, -754.037354701826, -813.5777689167662, -1073.559396971199, -1005.0845503937512, -704.525123807182, -1073.9018935161262, -882.2691990474285, -585.0562193168427, -112.25783350923928, -555.9440687642964, -772.8367320726011, -1213.2876079445916, -697.3245192667326, -668.8647480998748, -776.0080842220023, -900.4963364154434, -418.7889859253863, -244.08344528096185, -1002.438943644751, -1105.6523791646855, -1097.013021566946, -1098.7764767777728, -914.7545804278478, -1015.258348525818, -721.4973874785102, -951.8271161355614, -957.2770173971181, -1121.6479158960171, -858.2874434262761, -719.4892787155684, -859.8167972566708, -920.0267038377226, -711.9341248641534, -17.270620022482476, -39.27888394112452, -370.6864530440992, -316.8063217936393, -1155.4430868230263, -762.6152081001204, -914.8853693816352, -887.5717228260063, -927.3284694388781, -1068.9631937777363, -1182.302669681392, -696.6566929586727, -195.78032351481113, -883.3226963660663, -895.4705232374711, -467.338926450441, -1300.227821923066, -2.9165167061074047, -934.3017303021901, -865.5024179197582, -563.3488206188889, -513.1199691530935, -1068.3179049955816, -257.28751812237687, -428.20486129446886, -468.60454020609274, -1016.0665179819806, -672.4967838503918, -962.0972568528512, -592.5281713450628, -1112.0614964025629, -993.701551969914, -1000.3887578823716, -1293.6502092818016, -420.57056511650757, -422.003640308041, -726.0053089481767, -1095.088486460483, -704.2144966617847, -966.5344313395163, -1044.7085673115964, -507.4022905887419, -150.58611853820022, -965.3813465021308, -154.77814131143998, -769.2493092013083, -456.59194226976376, -398.81312588829917, -318.79578346787343, -644.9942272158423, -946.826808633727, -1149.1662851572269, -410.67588810292875, -792.669319323287, -1067.4073028146963, -685.9996317518955, -672.1474941170972, -1133.516772391196, -867.3130355070583, -941.0311337248472, -927.8912748494826, -760.4058827030296, -812.4818025347656, -942.1353794318769, -489.54366805661107, -66.00336758084191, -1164.7146735272784, -241.4995354743765, -210.35541306073313, -981.1669519343192, -270.84249365928196, -1089.2866903207844, -621.2894648108032, -640.1516229424391, -322.11160522229983, -569.3968073752523, -1033.8018627404297, -400.57460642645407, -152.6779124104652, -664.9181915507919, -207.84929671498145, -519.0788189121333, -1145.63474847468, -927.7460339757478, -332.055882530628, -776.5843053585908, -814.5410400400477, -9.112327967710982, -614.3922207477012, -546.9403655842328, -772.1865317117363, -150.2360100599314, -53.91500139093968, -807.3710986354511, -930.3314709104013, -250.41151379928232, -1024.6696505497523, -388.58144304179854, -855.1737883616787, -595.5520170984241, -901.4234412651936, -404.96595965925536, -1277.051284641641, -426.48277018876166, -132.53320907847854, -84.62684802721265, -881.052634099566, -673.1173628695241, -393.7007877303855, -531.9214231989565, -670.4594400254906, -1304.2835778585659, -471.1305199893828, -995.4836119906286, -930.2612372156588, -703.5415550547376, -74.80833792891588, -862.7299985366234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.623924483105243, "mean_inference_ms": 1.7422537969303329, "mean_action_processing_ms": 0.9068549805143631, "mean_env_wait_ms": 10.79773650199359, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016993284225463867, "StateBufferConnector_ms": 0.012550115585327148, "ViewRequirementAgentConnector_ms": 0.4837675094604492}, "num_episodes": 20, "episode_return_max": -1919.0555072134846, "episode_return_min": -4925.8961807500455, "episode_return_mean": -3499.5513899874895, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 93453, "num_agent_steps_trained": 93453, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 66.9325796490236, "num_env_steps_trained_throughput_per_sec": 66.9325796490236, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 93453, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 93453, "timers": {"training_iteration_time_ms": 59887.087, "restore_workers_time_ms": 0.032, "training_step_time_ms": 59887.007, "sample_time_ms": 3539.539, "learn_time_ms": 56288.373, "learn_throughput": 71.063, "synch_weights_time_ms": 55.816}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 93453, "num_agent_steps_trained": 93453}, "done": false, "training_iteration": 5, "trial_id": "efc54_00000", "date": "2024-07-24_18-44-59", "timestamp": 1721826899, "time_this_iter_s": 59.77334666252136, "time_total_s": 299.49153780937195, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d71f9a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 299.49153780937195, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 10.311764705882354, "ram_util_percent": 23.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 150.7472022696717, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 0.0010000000000000002, "total_loss": 5.30321499468529, "policy_loss": -0.0034742812424064635, "vf_loss": 5.319742351579884, "vf_explained_var": 0.9766856611319329, "kl": 0.012436377599543826, "entropy": 1.4296711304144227, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.63013698630137, "num_grad_updates_lifetime": 24150.5, "diff_num_grad_updates_vs_sampler_policy": 2189.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 112087, "num_agent_steps_trained": 112087}, "env_runners": {"episode_reward_max": -1919.0555072134846, "episode_reward_min": -4773.80120630755, "episode_reward_mean": -3548.5315062856266, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1320.8347430537458}, "policy_reward_max": {"policy_0": -0.4898393873872917}, "policy_reward_mean": {"policy_0": -709.7063012571251}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3520.5634006556716, -4327.910743656148, -3566.4477074784722, -3568.022029180206, -4189.241147810213, -4144.101158997207, -4368.6542650613155, -3679.823024402295, -3985.654506552553, -3013.3088051511168, -3940.446298248734, -3564.846823045083, -3146.6458409730512, -2490.768164359117, -3226.7513047809452, -4065.3881123723895, -3536.739768393529, -4158.891813300242, -3742.261414605595, -2627.2910349766425, -4237.199307482893, -4155.346256344119, -4102.091677801175, -3217.3673936536807, -3399.259759851859, -3024.968667764605, -3668.05871142529, -1919.0555072134846, -4330.86807637279, -3052.262328429212, -4670.648733605028, -2908.3640527104108, -4255.981295948644, -3867.9767755827315, -4702.1139093455095, -4516.518452691654, -2059.1967857095824, -4037.321708924428, -4071.0313493714934, -3549.276484683152, -3944.5908429895176, -2842.660221455312, -4660.77723445276, -3957.3182101150137, -3373.4459044398386, -2744.813865172942, -3470.458992577602, -4351.740520398174, -4309.123129319183, -2903.89662407099, -3172.9410137859213, -2966.036504706872, -2690.1589680630514, -2860.0395898727256, -2137.670129494542, -3401.3651769366897, -4034.166491026194, -2197.812824263542, -3371.4957488027817, -3566.8247407265653, -3396.9815395325427, -4146.419313834879, -4671.98441843782, -3138.544123977323, -3483.2905876149443, -3601.834227304889, -3974.6748440088018, -2669.301652130309, -3680.0996745311927, -2262.462199579124, -2104.0317128991937, -3432.0869554955602, -4028.5149905844855, -1989.2858438289968, -3070.912349225417, -3272.401422266641, -3588.1392475486537, -3556.7548174100707, -3272.8155791737954, -3058.0309208335557, -3491.956261678072, -2449.6524728812046, -2868.466818972974, -3347.3283850446965, -3582.532199439243, -4235.881183952246, -4375.113508121671, -2619.529774426501, -4773.80120630755, -3314.680927814785, -4254.4309547634, -3862.1894040879547, -4286.271758852733, -4157.236431723589, -4527.804746901678, -4632.482606052846, -4049.250169304131, -2323.145612620908, -4170.880732362083, -3565.947721453658], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-577.287775776532, -723.7172283942836, -510.20117249942547, -596.2012073157487, -1113.1560166696845, -518.0121947158436, -1099.237745122749, -1113.3212860337585, -875.886684088041, -721.4528336957603, -846.5347500004843, -861.2449974085578, -938.080311726214, -433.50948870869644, -487.07815963451753, -150.01113443378108, -1153.2821666916327, -55.064845295197486, -1061.6278983145985, -1148.0359844449993, -979.427342005782, -961.732977094883, -638.2042104286495, -920.3116698165667, -689.5649484643361, -963.6306472971645, -739.0180630470097, -876.7282137508566, -687.8814979328542, -876.8427369693238, -813.7328405093173, -954.0676433995111, -883.5446574418952, -794.902912872606, -922.406210837987, -1161.0362463401486, -856.5286304248158, -952.0681190523466, -396.73116572704754, -313.4588628579341, -1017.8059946849155, -186.6862580565787, -991.0096890114978, -850.1523924938784, -940.0001723056806, -290.1707830566428, -853.358256033946, -1031.826553243265, -561.4669840331635, -276.4862287840965, -774.0534218785997, -885.725407757887, -818.7862285087741, -719.4958654906666, -742.3853746128061, -889.0167826265828, -366.7286263199362, -791.6660881137598, -1179.0094865923097, -338.42583939249977, -923.2072029236705, -799.1087834609497, -710.9985862389955, -610.2863183739528, -103.04494997548315, -409.249483194042, -153.14355785399428, -515.2892920864099, -560.2239478553645, -852.8618833693072, -550.6056597960369, -0.4898393873872917, -914.5910649769734, -770.2556796680541, -990.8090609524924, -803.8793562217927, -1201.1446592993802, -1162.340404576143, -886.9127306082125, -11.110961666858554, -1156.7869657905571, -36.65413415178543, -616.6164813770088, -882.3923293257516, -844.2898577484275, -796.8151866093102, -593.1144581823089, -829.4379092992322, -895.2000486101439, -1044.324210599243, -269.9128751027733, -712.0916945888504, -961.4518144195208, -605.7512425718032, -1193.0537879226504, -929.8186848906947, -77.58928418751407, -798.024491495509, -758.1648331568363, -63.69374124608862, -798.0582406318587, -1059.075202896564, -1198.1652547297897, -377.4016767293646, -804.4989324953194, -749.8961248174843, -1000.2402916447915, -1026.1313446731442, -594.1220063932824, -784.9564888154209, -719.7197096076069, -679.1634521615665, -819.5986732332665, -1141.0606492654124, -742.5491935333242, -1140.3323745192597, -1013.6403468461552, -69.25675118762179, -50.298598329510746, -943.8393227711309, -1281.0719104220627, -485.61508077002145, -396.74192972501294, -1164.4654209217472, -71.36541801301847, -156.81728594624735, -170.0867441650268, -938.449184443208, -758.7908187246467, -1000.8246344854748, -746.9634638568498, -590.1469735912345, -1084.686957820186, -488.4552672085627, -757.8060489484631, -844.0383537445471, -174.9381059041416, -679.6512425674355, -26.919507428925805, -193.50829756843328, -888.0344986631759, -832.0542222690868, -808.2843448978481, -920.8048867737139, -881.6901237689636, -875.8095449092957, -744.6903167208297, -553.2758430892699, -124.44926900798839, -754.037354701826, -813.5777689167662, -1073.559396971199, -1005.0845503937512, -704.525123807182, -1073.9018935161262, -882.2691990474285, -585.0562193168427, -112.25783350923928, -555.9440687642964, -772.8367320726011, -1213.2876079445916, -697.3245192667326, -668.8647480998748, -776.0080842220023, -900.4963364154434, -418.7889859253863, -244.08344528096185, -1002.438943644751, -1105.6523791646855, -1097.013021566946, -1098.7764767777728, -914.7545804278478, -1015.258348525818, -721.4973874785102, -951.8271161355614, -957.2770173971181, -1121.6479158960171, -858.2874434262761, -719.4892787155684, -859.8167972566708, -920.0267038377226, -711.9341248641534, -17.270620022482476, -39.27888394112452, -370.6864530440992, -316.8063217936393, -1155.4430868230263, -762.6152081001204, -914.8853693816352, -887.5717228260063, -927.3284694388781, -1068.9631937777363, -1182.302669681392, -696.6566929586727, -195.78032351481113, -883.3226963660663, -895.4705232374711, -467.338926450441, -1300.227821923066, -2.9165167061074047, -934.3017303021901, -865.5024179197582, -563.3488206188889, -513.1199691530935, -1068.3179049955816, -257.28751812237687, -428.20486129446886, -468.60454020609274, -1016.0665179819806, -672.4967838503918, -962.0972568528512, -592.5281713450628, -1112.0614964025629, -993.701551969914, -1000.3887578823716, -1293.6502092818016, -420.57056511650757, -422.003640308041, -726.0053089481767, -1095.088486460483, -704.2144966617847, -966.5344313395163, -1044.7085673115964, -507.4022905887419, -150.58611853820022, -965.3813465021308, -154.77814131143998, -769.2493092013083, -456.59194226976376, -398.81312588829917, -318.79578346787343, -644.9942272158423, -946.826808633727, -1149.1662851572269, -410.67588810292875, -792.669319323287, -1067.4073028146963, -685.9996317518955, -672.1474941170972, -1133.516772391196, -867.3130355070583, -941.0311337248472, -927.8912748494826, -760.4058827030296, -812.4818025347656, -942.1353794318769, -489.54366805661107, -66.00336758084191, -1164.7146735272784, -241.4995354743765, -210.35541306073313, -981.1669519343192, -270.84249365928196, -1089.2866903207844, -621.2894648108032, -640.1516229424391, -322.11160522229983, -569.3968073752523, -1033.8018627404297, -400.57460642645407, -152.6779124104652, -664.9181915507919, -207.84929671498145, -519.0788189121333, -1145.63474847468, -927.7460339757478, -332.055882530628, -776.5843053585908, -814.5410400400477, -9.112327967710982, -614.3922207477012, -546.9403655842328, -772.1865317117363, -150.2360100599314, -53.91500139093968, -807.3710986354511, -930.3314709104013, -250.41151379928232, -1024.6696505497523, -388.58144304179854, -855.1737883616787, -595.5520170984241, -901.4234412651936, -404.96595965925536, -1277.051284641641, -426.48277018876166, -132.53320907847854, -84.62684802721265, -881.052634099566, -673.1173628695241, -393.7007877303855, -531.9214231989565, -670.4594400254906, -1304.2835778585659, -471.1305199893828, -995.4836119906286, -930.2612372156588, -703.5415550547376, -74.80833792891588, -862.7299985366234, -1251.1398892004602, -160.39592606915514, -802.026102575876, -504.95837623415457, -678.4612454528971, -716.9789164113141, -995.8032990206764, -1005.9187907247222, -731.5548427879041, -696.1634648902602, -1069.38738754989, -728.009252533782, -776.1556672628475, -1126.4113027059523, -972.0208083853486, -989.3254212461724, -666.3031125732151, -599.6742218061854, -184.89257439016205, -698.348793961589, -718.2913062764493, -637.7562899121875, -539.9498346088562, -859.9475457168959, -727.3456111005559, -950.7097636460736, -935.6760076210696, -430.5006030816539, -924.4838615025623, -360.4639914535296, -721.3100750587937, -688.5809997589002, -730.3546966848371, -1193.4511019418912, -640.9779705643773, -24.8068370180777, -160.4215188516117, -1070.8697459616583, -651.3972808461255, -761.8062694528367, -667.7676479148711, -1076.813046714067, -736.1557475472871, -201.07921511977082, -998.2840172351946, -708.8023763311471, -15.078594087049607, -914.2937656948985, -390.31186174215287, -233.97560172387594, -665.4290201316378, -717.4850566960623, -15.100625787852799, -200.12991729121285, -505.8870929924265, -395.98683415658996, -464.74131098842224, -752.898490141099, -1186.4465348466579, -632.0137853627915, -359.2204028554123, -701.908000253621, -955.9478431563076, -1293.3754178668178, -718.0633264523236, -325.6977036558852, -462.97736960916853, -772.3307653701572, -310.5481045198851, -117.73190067390058, -673.5957123218504, -879.1531562617021, -763.0978729733988, -659.3025352699128, -95.7630723985496, -694.7813428235208, -753.2485054641313, -887.6053611477454, -186.38016208806818, -750.386050743175, -1009.8969086979868, -1006.6359195224722, -562.9330608389579, -909.3714582801507, -99.3019002090851, -408.77175272717284, -1069.2799507313782, -861.1266976292978, -790.5251569119954, -427.0512594102281, -472.9825445430798, -608.5611498349892, -742.6023195525229, -551.1542854743942, -897.5152797688078, -54.25485579473528, -762.7539908836862, -1043.873938677355, -403.97426714620156, -793.173868331579, -936.3209061640483, -738.4219080917027, -678.4244624118332, -839.0863872227885, -299.70259778769906, -110.43264101074654, -461.0235657354947, -320.11952344133533, -588.0612098298596, -970.015532863768, -708.1247498699776, -714.66476560768, -451.03092356449486, -691.6789180007429, -302.9674619300773, -984.5980212218276, -1011.5311318664073, -125.78787467245726, -144.8664760951646, -1080.544881188841, -611.7127001363056, -968.3975332867319, -109.97061868040763, -808.4964503402931, -1083.954896995505, -809.1898392311728, -403.44353862703525, -737.7370304025256, -1320.8347430537458, -964.6760326377632, -992.2543861360582, -894.1359479733784, -837.6742618423556, -1018.4437321249884, -632.605180044891, -499.06043615863877, -811.8714431739428, -450.583199359923, -41.06430757043061, -816.9503881635666, -802.8692474067071, -815.3588179260834, -1087.8169421435332, -1030.8401399003913, -1036.916058930835, -239.30210277783988, -791.7098731386894, -702.7501369988858, -646.0565487495179, -934.8622661498514, -364.7781710034706, -937.3687742963828, -995.4565426091679, -772.1321612402886, -1184.6953056140917, -697.1016880071007, -1059.7679821059623, -717.2512652809401, -886.1449953723568, -501.9234733215959, -1087.0619791723357, -885.274834225191, -921.0926164870984, -995.1091904048326, -397.7331385632794, -934.0872466397486, -551.9715347662592, -868.5744275563824, -1119.1901599265373, -683.4130628346577, -922.6773169260019, -762.4631544301594, -427.24510780827603, -1286.5844924625785, -1128.8346752746602, -350.5375703372716, -1193.7574382763296, -940.5213206012635, -1182.9137823740007, -964.7524944639798, -731.9728740652221, -937.1235892154848, -724.9591549588373, -720.3132449534293, -934.8813061111612, -970.8775352068902, -587.30355662977, -77.85371087424866, -29.824381759590157, -657.2864281504088, -1150.0207671297783, -268.5724039005044, -1164.9038127796186, -987.8486324736924, -599.5351160784902, -916.9077813524468, -803.5500931684654, -288.647871307024, -767.6598799895656, -789.1820956361564]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6244415704450987, "mean_inference_ms": 1.7468148879273746, "mean_action_processing_ms": 0.9733147793108352, "mean_env_wait_ms": 10.866895970574934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017006874084472656, "StateBufferConnector_ms": 0.012465953826904297, "ViewRequirementAgentConnector_ms": 0.48572301864624023}, "num_episodes": 40, "episode_return_max": -1919.0555072134846, "episode_return_min": -4773.80120630755, "episode_return_mean": -3548.5315062856266, "episodes_this_iter": 40}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112087, "num_agent_steps_trained": 112087, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 66.82231494531594, "num_env_steps_trained_throughput_per_sec": 66.82231494531594, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 112087, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112087, "timers": {"training_iteration_time_ms": 59882.616, "restore_workers_time_ms": 0.032, "training_step_time_ms": 59882.535, "sample_time_ms": 3508.233, "learn_time_ms": 56313.198, "learn_throughput": 71.031, "synch_weights_time_ms": 57.768}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 112087, "num_agent_steps_trained": 112087}, "done": false, "training_iteration": 6, "trial_id": "efc54_00000", "date": "2024-07-24_18-45-59", "timestamp": 1721826959, "time_this_iter_s": 59.872554063797, "time_total_s": 359.36409187316895, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d71ecb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 359.36409187316895, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 9.991764705882353, "ram_util_percent": 23.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 141.12314230038737, "cur_kl_coeff": 0.09999999999999998, "cur_lr": 0.001, "total_loss": 5.2546542946713855, "policy_loss": -0.0029327526756154705, "vf_loss": 5.270669778782764, "vf_explained_var": 0.9758627279275128, "kl": 0.010747043958786178, "entropy": 1.4157445029877211, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.78911564625851, "num_grad_updates_lifetime": 28545.5, "diff_num_grad_updates_vs_sampler_policy": 2204.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 130872, "num_agent_steps_trained": 130872}, "env_runners": {"episode_reward_max": -1478.835486955838, "episode_reward_min": -4773.80120630755, "episode_reward_mean": -3492.2220531046814, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1320.8347430537458}, "policy_reward_max": {"policy_0": -2.9165167061074047}, "policy_reward_mean": {"policy_0": -698.4444106209362}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4237.199307482893, -4155.346256344119, -4102.091677801175, -3217.3673936536807, -3399.259759851859, -3024.968667764605, -3668.05871142529, -1919.0555072134846, -4330.86807637279, -3052.262328429212, -4670.648733605028, -2908.3640527104108, -4255.981295948644, -3867.9767755827315, -4702.1139093455095, -4516.518452691654, -2059.1967857095824, -4037.321708924428, -4071.0313493714934, -3549.276484683152, -3944.5908429895176, -2842.660221455312, -4660.77723445276, -3957.3182101150137, -3373.4459044398386, -2744.813865172942, -3470.458992577602, -4351.740520398174, -4309.123129319183, -2903.89662407099, -3172.9410137859213, -2966.036504706872, -2690.1589680630514, -2860.0395898727256, -2137.670129494542, -3401.3651769366897, -4034.166491026194, -2197.812824263542, -3371.4957488027817, -3566.8247407265653, -3396.9815395325427, -4146.419313834879, -4671.98441843782, -3138.544123977323, -3483.2905876149443, -3601.834227304889, -3974.6748440088018, -2669.301652130309, -3680.0996745311927, -2262.462199579124, -2104.0317128991937, -3432.0869554955602, -4028.5149905844855, -1989.2858438289968, -3070.912349225417, -3272.401422266641, -3588.1392475486537, -3556.7548174100707, -3272.8155791737954, -3058.0309208335557, -3491.956261678072, -2449.6524728812046, -2868.466818972974, -3347.3283850446965, -3582.532199439243, -4235.881183952246, -4375.113508121671, -2619.529774426501, -4773.80120630755, -3314.680927814785, -4254.4309547634, -3862.1894040879547, -4286.271758852733, -4157.236431723589, -4527.804746901678, -4632.482606052846, -4049.250169304131, -2323.145612620908, -4170.880732362083, -3565.947721453658, -2937.8294274693603, -3242.9679532468363, -3939.540444946263, -3044.559371035566, -3959.88261457659, -3607.5217104329954, -3874.536433021573, -3591.6565634581652, -2510.1189000603717, -3563.728761414366, -2604.8294056825625, -4168.230826749333, -2450.2726446378733, -3640.854906722435, -4221.692276122858, -3446.951262531175, -1478.835486955838, -3235.221962670665, -3726.2118165754323, -3987.3692775957757], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-798.0582406318587, -1059.075202896564, -1198.1652547297897, -377.4016767293646, -804.4989324953194, -749.8961248174843, -1000.2402916447915, -1026.1313446731442, -594.1220063932824, -784.9564888154209, -719.7197096076069, -679.1634521615665, -819.5986732332665, -1141.0606492654124, -742.5491935333242, -1140.3323745192597, -1013.6403468461552, -69.25675118762179, -50.298598329510746, -943.8393227711309, -1281.0719104220627, -485.61508077002145, -396.74192972501294, -1164.4654209217472, -71.36541801301847, -156.81728594624735, -170.0867441650268, -938.449184443208, -758.7908187246467, -1000.8246344854748, -746.9634638568498, -590.1469735912345, -1084.686957820186, -488.4552672085627, -757.8060489484631, -844.0383537445471, -174.9381059041416, -679.6512425674355, -26.919507428925805, -193.50829756843328, -888.0344986631759, -832.0542222690868, -808.2843448978481, -920.8048867737139, -881.6901237689636, -875.8095449092957, -744.6903167208297, -553.2758430892699, -124.44926900798839, -754.037354701826, -813.5777689167662, -1073.559396971199, -1005.0845503937512, -704.525123807182, -1073.9018935161262, -882.2691990474285, -585.0562193168427, -112.25783350923928, -555.9440687642964, -772.8367320726011, -1213.2876079445916, -697.3245192667326, -668.8647480998748, -776.0080842220023, -900.4963364154434, -418.7889859253863, -244.08344528096185, -1002.438943644751, -1105.6523791646855, -1097.013021566946, -1098.7764767777728, -914.7545804278478, -1015.258348525818, -721.4973874785102, -951.8271161355614, -957.2770173971181, -1121.6479158960171, -858.2874434262761, -719.4892787155684, -859.8167972566708, -920.0267038377226, -711.9341248641534, -17.270620022482476, -39.27888394112452, -370.6864530440992, -316.8063217936393, -1155.4430868230263, -762.6152081001204, -914.8853693816352, -887.5717228260063, -927.3284694388781, -1068.9631937777363, -1182.302669681392, -696.6566929586727, -195.78032351481113, -883.3226963660663, -895.4705232374711, -467.338926450441, -1300.227821923066, -2.9165167061074047, -934.3017303021901, -865.5024179197582, -563.3488206188889, -513.1199691530935, -1068.3179049955816, -257.28751812237687, -428.20486129446886, -468.60454020609274, -1016.0665179819806, -672.4967838503918, -962.0972568528512, -592.5281713450628, -1112.0614964025629, -993.701551969914, -1000.3887578823716, -1293.6502092818016, -420.57056511650757, -422.003640308041, -726.0053089481767, -1095.088486460483, -704.2144966617847, -966.5344313395163, -1044.7085673115964, -507.4022905887419, -150.58611853820022, -965.3813465021308, -154.77814131143998, -769.2493092013083, -456.59194226976376, -398.81312588829917, -318.79578346787343, -644.9942272158423, -946.826808633727, -1149.1662851572269, -410.67588810292875, -792.669319323287, -1067.4073028146963, -685.9996317518955, -672.1474941170972, -1133.516772391196, -867.3130355070583, -941.0311337248472, -927.8912748494826, -760.4058827030296, -812.4818025347656, -942.1353794318769, -489.54366805661107, -66.00336758084191, -1164.7146735272784, -241.4995354743765, -210.35541306073313, -981.1669519343192, -270.84249365928196, -1089.2866903207844, -621.2894648108032, -640.1516229424391, -322.11160522229983, -569.3968073752523, -1033.8018627404297, -400.57460642645407, -152.6779124104652, -664.9181915507919, -207.84929671498145, -519.0788189121333, -1145.63474847468, -927.7460339757478, -332.055882530628, -776.5843053585908, -814.5410400400477, -9.112327967710982, -614.3922207477012, -546.9403655842328, -772.1865317117363, -150.2360100599314, -53.91500139093968, -807.3710986354511, -930.3314709104013, -250.41151379928232, -1024.6696505497523, -388.58144304179854, -855.1737883616787, -595.5520170984241, -901.4234412651936, -404.96595965925536, -1277.051284641641, -426.48277018876166, -132.53320907847854, -84.62684802721265, -881.052634099566, -673.1173628695241, -393.7007877303855, -531.9214231989565, -670.4594400254906, -1304.2835778585659, -471.1305199893828, -995.4836119906286, -930.2612372156588, -703.5415550547376, -74.80833792891588, -862.7299985366234, -1251.1398892004602, -160.39592606915514, -802.026102575876, -504.95837623415457, -678.4612454528971, -716.9789164113141, -995.8032990206764, -1005.9187907247222, -731.5548427879041, -696.1634648902602, -1069.38738754989, -728.009252533782, -776.1556672628475, -1126.4113027059523, -972.0208083853486, -989.3254212461724, -666.3031125732151, -599.6742218061854, -184.89257439016205, -698.348793961589, -718.2913062764493, -637.7562899121875, -539.9498346088562, -859.9475457168959, -727.3456111005559, -950.7097636460736, -935.6760076210696, -430.5006030816539, -924.4838615025623, -360.4639914535296, -721.3100750587937, -688.5809997589002, -730.3546966848371, -1193.4511019418912, -640.9779705643773, -24.8068370180777, -160.4215188516117, -1070.8697459616583, -651.3972808461255, -761.8062694528367, -667.7676479148711, -1076.813046714067, -736.1557475472871, -201.07921511977082, -998.2840172351946, -708.8023763311471, -15.078594087049607, -914.2937656948985, -390.31186174215287, -233.97560172387594, -665.4290201316378, -717.4850566960623, -15.100625787852799, -200.12991729121285, -505.8870929924265, -395.98683415658996, -464.74131098842224, -752.898490141099, -1186.4465348466579, -632.0137853627915, -359.2204028554123, -701.908000253621, -955.9478431563076, -1293.3754178668178, -718.0633264523236, -325.6977036558852, -462.97736960916853, -772.3307653701572, -310.5481045198851, -117.73190067390058, -673.5957123218504, -879.1531562617021, -763.0978729733988, -659.3025352699128, -95.7630723985496, -694.7813428235208, -753.2485054641313, -887.6053611477454, -186.38016208806818, -750.386050743175, -1009.8969086979868, -1006.6359195224722, -562.9330608389579, -909.3714582801507, -99.3019002090851, -408.77175272717284, -1069.2799507313782, -861.1266976292978, -790.5251569119954, -427.0512594102281, -472.9825445430798, -608.5611498349892, -742.6023195525229, -551.1542854743942, -897.5152797688078, -54.25485579473528, -762.7539908836862, -1043.873938677355, -403.97426714620156, -793.173868331579, -936.3209061640483, -738.4219080917027, -678.4244624118332, -839.0863872227885, -299.70259778769906, -110.43264101074654, -461.0235657354947, -320.11952344133533, -588.0612098298596, -970.015532863768, -708.1247498699776, -714.66476560768, -451.03092356449486, -691.6789180007429, -302.9674619300773, -984.5980212218276, -1011.5311318664073, -125.78787467245726, -144.8664760951646, -1080.544881188841, -611.7127001363056, -968.3975332867319, -109.97061868040763, -808.4964503402931, -1083.954896995505, -809.1898392311728, -403.44353862703525, -737.7370304025256, -1320.8347430537458, -964.6760326377632, -992.2543861360582, -894.1359479733784, -837.6742618423556, -1018.4437321249884, -632.605180044891, -499.06043615863877, -811.8714431739428, -450.583199359923, -41.06430757043061, -816.9503881635666, -802.8692474067071, -815.3588179260834, -1087.8169421435332, -1030.8401399003913, -1036.916058930835, -239.30210277783988, -791.7098731386894, -702.7501369988858, -646.0565487495179, -934.8622661498514, -364.7781710034706, -937.3687742963828, -995.4565426091679, -772.1321612402886, -1184.6953056140917, -697.1016880071007, -1059.7679821059623, -717.2512652809401, -886.1449953723568, -501.9234733215959, -1087.0619791723357, -885.274834225191, -921.0926164870984, -995.1091904048326, -397.7331385632794, -934.0872466397486, -551.9715347662592, -868.5744275563824, -1119.1901599265373, -683.4130628346577, -922.6773169260019, -762.4631544301594, -427.24510780827603, -1286.5844924625785, -1128.8346752746602, -350.5375703372716, -1193.7574382763296, -940.5213206012635, -1182.9137823740007, -964.7524944639798, -731.9728740652221, -937.1235892154848, -724.9591549588373, -720.3132449534293, -934.8813061111612, -970.8775352068902, -587.30355662977, -77.85371087424866, -29.824381759590157, -657.2864281504088, -1150.0207671297783, -268.5724039005044, -1164.9038127796186, -987.8486324736924, -599.5351160784902, -916.9077813524468, -803.5500931684654, -288.647871307024, -767.6598799895656, -789.1820956361564, -660.0663859373599, -1019.2927649051403, -217.6560343458906, -868.8602601110099, -171.95398216996082, -600.2051313229456, -716.6231305277743, -1042.3823645182483, -575.2925036261188, -308.46482325174696, -1065.5670727668698, -698.4865101430803, -807.070437986074, -758.1515914586729, -610.264832591564, -580.7871472565998, -783.3537441968392, -516.5986466266252, -74.66769400340279, -1089.1521389521015, -684.9682351599715, -808.8411855086704, -767.6233256942897, -842.4600686523396, -855.9897995613156, -407.5588686312747, -1030.8858024921171, -412.84750971626545, -846.3817908128508, -909.8477387804876, -318.23521185045905, -842.5144310839551, -764.5976212770505, -1168.018740960831, -781.1704278492787, -969.8432525600509, -630.0228743038799, -205.02157940360647, -1065.3463037369618, -721.4225534536655, -155.34989715210708, -886.6030856865957, -341.96438059044857, -468.3474302705946, -657.8541063606256, -641.9996069046721, -1154.5336595662905, -962.0733576369482, -114.05007961547368, -691.0720576909762, -449.73433081357587, -304.8161127649773, -471.879328118746, -636.127258892133, -742.2723750931314, -798.1477159533148, -722.8045437855274, -1064.3339105905902, -831.4739924788291, -751.470663941069, -894.9314813363768, -343.98137452864046, -28.907659346614867, -806.496590557013, -375.9555388692249, -375.9101828726347, -650.8534687848193, -657.192162333258, -918.9967563795975, -1037.9023363521246, -1036.9708195535088, -616.1592156807593, -900.3671680968903, -842.8083829073237, -825.3866898843785, -886.0228202589984, -642.8476223163966, -152.55269100455584, -877.8161272653014, -887.7120016859201, -89.17368759461782, -263.09061695016277, -10.300975250029515, -958.8027657425948, -157.4674414184321, -626.0586672661276, -873.8101199717424, -393.4253687657263, -254.35053681450725, -1087.577269852558, -20.56786563396359, -879.0650126415588, -909.2117552333766, -865.6797887726422, -1051.6873942938903, -876.3400379917265, -1079.7432896910593, -344.2304101750074, -718.03137457619, -969.0241651617891]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6188882729957, "mean_inference_ms": 1.7407897108176587, "mean_action_processing_ms": 0.9971605801612499, "mean_env_wait_ms": 10.814754825830871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017205476760864258, "StateBufferConnector_ms": 0.012534141540527344, "ViewRequirementAgentConnector_ms": 0.4875965118408203}, "num_episodes": 20, "episode_return_max": -1478.835486955838, "episode_return_min": -4773.80120630755, "episode_return_mean": -3492.2220531046814, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 130872, "num_agent_steps_trained": 130872, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 65.48745256538903, "num_env_steps_trained_throughput_per_sec": 65.48745256538903, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 130872, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 130872, "timers": {"training_iteration_time_ms": 60053.731, "restore_workers_time_ms": 0.031, "training_step_time_ms": 60053.649, "sample_time_ms": 3504.866, "learn_time_ms": 56486.478, "learn_throughput": 70.813, "synch_weights_time_ms": 58.803}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 130872, "num_agent_steps_trained": 130872}, "done": false, "training_iteration": 7, "trial_id": "efc54_00000", "date": "2024-07-24_18-47-00", "timestamp": 1721827020, "time_this_iter_s": 61.09345746040344, "time_total_s": 420.4575493335724, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7ac1f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 420.4575493335724, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 9.918390804597703, "ram_util_percent": 23.573563218390795}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 147.20589060695082, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 0.001, "total_loss": 5.315908098000067, "policy_loss": -0.002239524116157554, "vf_loss": 5.332363393295695, "vf_explained_var": 0.9788470329371868, "kl": 0.011636684305604258, "entropy": 1.5379433610924969, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.625, "num_grad_updates_lifetime": 32910.5, "diff_num_grad_updates_vs_sampler_policy": 2159.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 149250, "num_agent_steps_trained": 149250}, "env_runners": {"episode_reward_max": -1478.835486955838, "episode_reward_min": -4934.0849855596125, "episode_reward_mean": -3441.4604037247254, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1320.8347430537458}, "policy_reward_max": {"policy_0": -9.112327967710982}, "policy_reward_mean": {"policy_0": -688.292080744945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3944.5908429895176, -2842.660221455312, -4660.77723445276, -3957.3182101150137, -3373.4459044398386, -2744.813865172942, -3470.458992577602, -4351.740520398174, -4309.123129319183, -2903.89662407099, -3172.9410137859213, -2966.036504706872, -2690.1589680630514, -2860.0395898727256, -2137.670129494542, -3401.3651769366897, -4034.166491026194, -2197.812824263542, -3371.4957488027817, -3566.8247407265653, -3396.9815395325427, -4146.419313834879, -4671.98441843782, -3138.544123977323, -3483.2905876149443, -3601.834227304889, -3974.6748440088018, -2669.301652130309, -3680.0996745311927, -2262.462199579124, -2104.0317128991937, -3432.0869554955602, -4028.5149905844855, -1989.2858438289968, -3070.912349225417, -3272.401422266641, -3588.1392475486537, -3556.7548174100707, -3272.8155791737954, -3058.0309208335557, -3491.956261678072, -2449.6524728812046, -2868.466818972974, -3347.3283850446965, -3582.532199439243, -4235.881183952246, -4375.113508121671, -2619.529774426501, -4773.80120630755, -3314.680927814785, -4254.4309547634, -3862.1894040879547, -4286.271758852733, -4157.236431723589, -4527.804746901678, -4632.482606052846, -4049.250169304131, -2323.145612620908, -4170.880732362083, -3565.947721453658, -2937.8294274693603, -3242.9679532468363, -3939.540444946263, -3044.559371035566, -3959.88261457659, -3607.5217104329954, -3874.536433021573, -3591.6565634581652, -2510.1189000603717, -3563.728761414366, -2604.8294056825625, -4168.230826749333, -2450.2726446378733, -3640.854906722435, -4221.692276122858, -3446.951262531175, -1478.835486955838, -3235.221962670665, -3726.2118165754323, -3987.3692775957757, -3947.126067363528, -3514.1137291385753, -3181.5912994817577, -4558.441008367541, -2504.2236801135214, -3504.5178177805465, -2385.4373039047705, -3874.719298646957, -3329.580496498523, -3370.588976204538, -2677.5466809065942, -3892.063093535706, -4934.0849855596125, -4734.19074162153, -3873.3940114014417, -3127.7682688717205, -3096.14461833567, -2429.7067877333798, -3240.6075724685275, -2492.895858981745], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-934.3017303021901, -865.5024179197582, -563.3488206188889, -513.1199691530935, -1068.3179049955816, -257.28751812237687, -428.20486129446886, -468.60454020609274, -1016.0665179819806, -672.4967838503918, -962.0972568528512, -592.5281713450628, -1112.0614964025629, -993.701551969914, -1000.3887578823716, -1293.6502092818016, -420.57056511650757, -422.003640308041, -726.0053089481767, -1095.088486460483, -704.2144966617847, -966.5344313395163, -1044.7085673115964, -507.4022905887419, -150.58611853820022, -965.3813465021308, -154.77814131143998, -769.2493092013083, -456.59194226976376, -398.81312588829917, -318.79578346787343, -644.9942272158423, -946.826808633727, -1149.1662851572269, -410.67588810292875, -792.669319323287, -1067.4073028146963, -685.9996317518955, -672.1474941170972, -1133.516772391196, -867.3130355070583, -941.0311337248472, -927.8912748494826, -760.4058827030296, -812.4818025347656, -942.1353794318769, -489.54366805661107, -66.00336758084191, -1164.7146735272784, -241.4995354743765, -210.35541306073313, -981.1669519343192, -270.84249365928196, -1089.2866903207844, -621.2894648108032, -640.1516229424391, -322.11160522229983, -569.3968073752523, -1033.8018627404297, -400.57460642645407, -152.6779124104652, -664.9181915507919, -207.84929671498145, -519.0788189121333, -1145.63474847468, -927.7460339757478, -332.055882530628, -776.5843053585908, -814.5410400400477, -9.112327967710982, -614.3922207477012, -546.9403655842328, -772.1865317117363, -150.2360100599314, -53.91500139093968, -807.3710986354511, -930.3314709104013, -250.41151379928232, -1024.6696505497523, -388.58144304179854, -855.1737883616787, -595.5520170984241, -901.4234412651936, -404.96595965925536, -1277.051284641641, -426.48277018876166, -132.53320907847854, -84.62684802721265, -881.052634099566, -673.1173628695241, -393.7007877303855, -531.9214231989565, -670.4594400254906, -1304.2835778585659, -471.1305199893828, -995.4836119906286, -930.2612372156588, -703.5415550547376, -74.80833792891588, -862.7299985366234, -1251.1398892004602, -160.39592606915514, -802.026102575876, -504.95837623415457, -678.4612454528971, -716.9789164113141, -995.8032990206764, -1005.9187907247222, -731.5548427879041, -696.1634648902602, -1069.38738754989, -728.009252533782, -776.1556672628475, -1126.4113027059523, -972.0208083853486, -989.3254212461724, -666.3031125732151, -599.6742218061854, -184.89257439016205, -698.348793961589, -718.2913062764493, -637.7562899121875, -539.9498346088562, -859.9475457168959, -727.3456111005559, -950.7097636460736, -935.6760076210696, -430.5006030816539, -924.4838615025623, -360.4639914535296, -721.3100750587937, -688.5809997589002, -730.3546966848371, -1193.4511019418912, -640.9779705643773, -24.8068370180777, -160.4215188516117, -1070.8697459616583, -651.3972808461255, -761.8062694528367, -667.7676479148711, -1076.813046714067, -736.1557475472871, -201.07921511977082, -998.2840172351946, -708.8023763311471, -15.078594087049607, -914.2937656948985, -390.31186174215287, -233.97560172387594, -665.4290201316378, -717.4850566960623, -15.100625787852799, -200.12991729121285, -505.8870929924265, -395.98683415658996, -464.74131098842224, -752.898490141099, -1186.4465348466579, -632.0137853627915, -359.2204028554123, -701.908000253621, -955.9478431563076, -1293.3754178668178, -718.0633264523236, -325.6977036558852, -462.97736960916853, -772.3307653701572, -310.5481045198851, -117.73190067390058, -673.5957123218504, -879.1531562617021, -763.0978729733988, -659.3025352699128, -95.7630723985496, -694.7813428235208, -753.2485054641313, -887.6053611477454, -186.38016208806818, -750.386050743175, -1009.8969086979868, -1006.6359195224722, -562.9330608389579, -909.3714582801507, -99.3019002090851, -408.77175272717284, -1069.2799507313782, -861.1266976292978, -790.5251569119954, -427.0512594102281, -472.9825445430798, -608.5611498349892, -742.6023195525229, -551.1542854743942, -897.5152797688078, -54.25485579473528, -762.7539908836862, -1043.873938677355, -403.97426714620156, -793.173868331579, -936.3209061640483, -738.4219080917027, -678.4244624118332, -839.0863872227885, -299.70259778769906, -110.43264101074654, -461.0235657354947, -320.11952344133533, -588.0612098298596, -970.015532863768, -708.1247498699776, -714.66476560768, -451.03092356449486, -691.6789180007429, -302.9674619300773, -984.5980212218276, -1011.5311318664073, -125.78787467245726, -144.8664760951646, -1080.544881188841, -611.7127001363056, -968.3975332867319, -109.97061868040763, -808.4964503402931, -1083.954896995505, -809.1898392311728, -403.44353862703525, -737.7370304025256, -1320.8347430537458, -964.6760326377632, -992.2543861360582, -894.1359479733784, -837.6742618423556, -1018.4437321249884, -632.605180044891, -499.06043615863877, -811.8714431739428, -450.583199359923, -41.06430757043061, -816.9503881635666, -802.8692474067071, -815.3588179260834, -1087.8169421435332, -1030.8401399003913, -1036.916058930835, -239.30210277783988, -791.7098731386894, -702.7501369988858, -646.0565487495179, -934.8622661498514, -364.7781710034706, -937.3687742963828, -995.4565426091679, -772.1321612402886, -1184.6953056140917, -697.1016880071007, -1059.7679821059623, -717.2512652809401, -886.1449953723568, -501.9234733215959, -1087.0619791723357, -885.274834225191, -921.0926164870984, -995.1091904048326, -397.7331385632794, -934.0872466397486, -551.9715347662592, -868.5744275563824, -1119.1901599265373, -683.4130628346577, -922.6773169260019, -762.4631544301594, -427.24510780827603, -1286.5844924625785, -1128.8346752746602, -350.5375703372716, -1193.7574382763296, -940.5213206012635, -1182.9137823740007, -964.7524944639798, -731.9728740652221, -937.1235892154848, -724.9591549588373, -720.3132449534293, -934.8813061111612, -970.8775352068902, -587.30355662977, -77.85371087424866, -29.824381759590157, -657.2864281504088, -1150.0207671297783, -268.5724039005044, -1164.9038127796186, -987.8486324736924, -599.5351160784902, -916.9077813524468, -803.5500931684654, -288.647871307024, -767.6598799895656, -789.1820956361564, -660.0663859373599, -1019.2927649051403, -217.6560343458906, -868.8602601110099, -171.95398216996082, -600.2051313229456, -716.6231305277743, -1042.3823645182483, -575.2925036261188, -308.46482325174696, -1065.5670727668698, -698.4865101430803, -807.070437986074, -758.1515914586729, -610.264832591564, -580.7871472565998, -783.3537441968392, -516.5986466266252, -74.66769400340279, -1089.1521389521015, -684.9682351599715, -808.8411855086704, -767.6233256942897, -842.4600686523396, -855.9897995613156, -407.5588686312747, -1030.8858024921171, -412.84750971626545, -846.3817908128508, -909.8477387804876, -318.23521185045905, -842.5144310839551, -764.5976212770505, -1168.018740960831, -781.1704278492787, -969.8432525600509, -630.0228743038799, -205.02157940360647, -1065.3463037369618, -721.4225534536655, -155.34989715210708, -886.6030856865957, -341.96438059044857, -468.3474302705946, -657.8541063606256, -641.9996069046721, -1154.5336595662905, -962.0733576369482, -114.05007961547368, -691.0720576909762, -449.73433081357587, -304.8161127649773, -471.879328118746, -636.127258892133, -742.2723750931314, -798.1477159533148, -722.8045437855274, -1064.3339105905902, -831.4739924788291, -751.470663941069, -894.9314813363768, -343.98137452864046, -28.907659346614867, -806.496590557013, -375.9555388692249, -375.9101828726347, -650.8534687848193, -657.192162333258, -918.9967563795975, -1037.9023363521246, -1036.9708195535088, -616.1592156807593, -900.3671680968903, -842.8083829073237, -825.3866898843785, -886.0228202589984, -642.8476223163966, -152.55269100455584, -877.8161272653014, -887.7120016859201, -89.17368759461782, -263.09061695016277, -10.300975250029515, -958.8027657425948, -157.4674414184321, -626.0586672661276, -873.8101199717424, -393.4253687657263, -254.35053681450725, -1087.577269852558, -20.56786563396359, -879.0650126415588, -909.2117552333766, -865.6797887726422, -1051.6873942938903, -876.3400379917265, -1079.7432896910593, -344.2304101750074, -718.03137457619, -969.0241651617891, -561.807623086486, -899.3523596611284, -592.3207985161498, -1054.539494597779, -839.1057915019874, -621.0072171043723, -403.33763194837366, -449.7154567181982, -1104.0322387636757, -936.0211846039526, -276.52030978119035, -920.2169460885292, -773.597759632576, -336.72042015614977, -874.535863823315, -1161.9716838443592, -1263.9833061753786, -751.9565973824551, -687.383036930378, -693.1463840349693, -64.95478492064653, -1143.262984800613, -19.07735943902601, -545.2365049928792, -731.6920459603576, -635.0485026496136, -698.7821471965482, -782.2078070426393, -799.8021259165861, -588.6772349751602, -883.7998721655879, -45.85131870555225, -1158.1747885893226, -270.06876365558236, -27.542560788727975, -672.5622547087969, -960.8346188871736, -682.5737883029102, -1126.7127898170047, -432.0358469310729, -779.2243816848023, -16.773226942680616, -837.5193820708165, -1022.6606785085503, -673.4028272916737, -952.8792030617234, -864.6846202942576, -1276.477586504719, -28.226396156563254, -248.32117018727786, -616.4339056488968, -955.6573336659917, -73.56905397969054, -441.30379612244536, -590.5825914895673, -614.6812962140515, -872.0217747744366, -173.09462956742857, -1155.109927434381, -1077.1554655454033, -1171.2926651564412, -760.2569009030921, -824.7225481359038, -975.292786510684, -1202.5200848534892, -627.2412796198627, -894.0817566786078, -1189.044329992014, -1181.966040061868, -841.8573352691766, -1032.583333222872, -836.1650036749857, -989.9103955426301, -841.7341361625131, -173.00114279844325, -1150.6474659544278, -422.6585854409796, -759.4646812019578, -79.76373628569148, -715.2337999886629, -353.9248789599584, -630.2758028019801, -521.9248812186709, -688.3272428230476, -901.691812532013, -759.358024498401, -694.7095284369469, -710.5360045504499, -97.84344425205617, -167.25978599552607, -626.6944759087212, -72.12618984467872, -925.1991111777988, -378.06522959202675, -1238.5225659453024, -1102.9117907014734, -148.91058645976983, -115.11126933834393, -318.7935760884921, -807.1686363936657]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6163767350197367, "mean_inference_ms": 1.7393983905098112, "mean_action_processing_ms": 1.021092977878247, "mean_env_wait_ms": 10.812494949718687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017342090606689453, "StateBufferConnector_ms": 0.012658119201660156, "ViewRequirementAgentConnector_ms": 0.4876716136932373}, "num_episodes": 20, "episode_return_max": -1478.835486955838, "episode_return_min": -4934.0849855596125, "episode_return_mean": -3441.4604037247254, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149250, "num_agent_steps_trained": 149250, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 85.11589790426476, "num_env_steps_trained_throughput_per_sec": 85.11589790426476, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 149250, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 149250, "timers": {"training_iteration_time_ms": 58421.359, "restore_workers_time_ms": 0.031, "training_step_time_ms": 58421.277, "sample_time_ms": 3492.372, "learn_time_ms": 54866.931, "learn_throughput": 72.904, "synch_weights_time_ms": 58.48}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 149250, "num_agent_steps_trained": 149250}, "done": false, "training_iteration": 8, "trial_id": "efc54_00000", "date": "2024-07-24_18-47-47", "timestamp": 1721827067, "time_this_iter_s": 47.00658130645752, "time_total_s": 467.4641306400299, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x717b99645ab0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 467.4641306400299, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 11.153030303030304, "ram_util_percent": 23.599999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 154.80974085758064, "cur_kl_coeff": 0.09999999999999998, "cur_lr": 0.001, "total_loss": 5.22037083529561, "policy_loss": -0.0036059373707506307, "vf_loss": 5.23818309880168, "vf_explained_var": 0.9779658705063689, "kl": 0.013465013505709875, "entropy": 1.5552822175209755, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.4625850340136, "num_grad_updates_lifetime": 37275.5, "diff_num_grad_updates_vs_sampler_policy": 2204.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 167987, "num_agent_steps_trained": 167987}, "env_runners": {"episode_reward_max": -961.4966332566778, "episode_reward_min": -4934.0849855596125, "episode_reward_mean": -3431.125582344797, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1320.8347430537458}, "policy_reward_max": {"policy_0": -10.300975250029515}, "policy_reward_mean": {"policy_0": -686.2251164689595}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3491.956261678072, -2449.6524728812046, -2868.466818972974, -3347.3283850446965, -3582.532199439243, -4235.881183952246, -4375.113508121671, -2619.529774426501, -4773.80120630755, -3314.680927814785, -4254.4309547634, -3862.1894040879547, -4286.271758852733, -4157.236431723589, -4527.804746901678, -4632.482606052846, -4049.250169304131, -2323.145612620908, -4170.880732362083, -3565.947721453658, -2937.8294274693603, -3242.9679532468363, -3939.540444946263, -3044.559371035566, -3959.88261457659, -3607.5217104329954, -3874.536433021573, -3591.6565634581652, -2510.1189000603717, -3563.728761414366, -2604.8294056825625, -4168.230826749333, -2450.2726446378733, -3640.854906722435, -4221.692276122858, -3446.951262531175, -1478.835486955838, -3235.221962670665, -3726.2118165754323, -3987.3692775957757, -3947.126067363528, -3514.1137291385753, -3181.5912994817577, -4558.441008367541, -2504.2236801135214, -3504.5178177805465, -2385.4373039047705, -3874.719298646957, -3329.580496498523, -3370.588976204538, -2677.5466809065942, -3892.063093535706, -4934.0849855596125, -4734.19074162153, -3873.3940114014417, -3127.7682688717205, -3096.14461833567, -2429.7067877333798, -3240.6075724685275, -2492.895858981745, -1849.3285221994881, -1920.184493974282, -3077.4458024228934, -3470.737357689824, -3396.2723025003907, -961.4966332566778, -4150.024269628816, -4443.565193286303, -3670.7622177484213, -2314.5264878813127, -2203.480251632923, -4157.625041698704, -2403.111499257529, -2367.9606503677155, -2785.490756654219, -3479.748944458907, -4091.3590232742513, -2775.966949672135, -3098.541334132418, -3143.4135403048704, -3432.053984496454, -2986.987505685031, -4722.185681731863, -3662.2469998863885, -3287.3396007644005, -3279.9835094237374, -2822.169051150381, -3230.8114551219314, -3274.1444584373035, -3668.416381316151, -2873.895218827918, -3813.722321672067, -4225.32630291306, -3271.814965411965, -3518.403764378207, -4108.7384910274195, -4002.5287859466307, -3457.026363044525, -4803.320463214903, -4120.264438403209], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-936.3209061640483, -738.4219080917027, -678.4244624118332, -839.0863872227885, -299.70259778769906, -110.43264101074654, -461.0235657354947, -320.11952344133533, -588.0612098298596, -970.015532863768, -708.1247498699776, -714.66476560768, -451.03092356449486, -691.6789180007429, -302.9674619300773, -984.5980212218276, -1011.5311318664073, -125.78787467245726, -144.8664760951646, -1080.544881188841, -611.7127001363056, -968.3975332867319, -109.97061868040763, -808.4964503402931, -1083.954896995505, -809.1898392311728, -403.44353862703525, -737.7370304025256, -1320.8347430537458, -964.6760326377632, -992.2543861360582, -894.1359479733784, -837.6742618423556, -1018.4437321249884, -632.605180044891, -499.06043615863877, -811.8714431739428, -450.583199359923, -41.06430757043061, -816.9503881635666, -802.8692474067071, -815.3588179260834, -1087.8169421435332, -1030.8401399003913, -1036.916058930835, -239.30210277783988, -791.7098731386894, -702.7501369988858, -646.0565487495179, -934.8622661498514, -364.7781710034706, -937.3687742963828, -995.4565426091679, -772.1321612402886, -1184.6953056140917, -697.1016880071007, -1059.7679821059623, -717.2512652809401, -886.1449953723568, -501.9234733215959, -1087.0619791723357, -885.274834225191, -921.0926164870984, -995.1091904048326, -397.7331385632794, -934.0872466397486, -551.9715347662592, -868.5744275563824, -1119.1901599265373, -683.4130628346577, -922.6773169260019, -762.4631544301594, -427.24510780827603, -1286.5844924625785, -1128.8346752746602, -350.5375703372716, -1193.7574382763296, -940.5213206012635, -1182.9137823740007, -964.7524944639798, -731.9728740652221, -937.1235892154848, -724.9591549588373, -720.3132449534293, -934.8813061111612, -970.8775352068902, -587.30355662977, -77.85371087424866, -29.824381759590157, -657.2864281504088, -1150.0207671297783, -268.5724039005044, -1164.9038127796186, -987.8486324736924, -599.5351160784902, -916.9077813524468, -803.5500931684654, -288.647871307024, -767.6598799895656, -789.1820956361564, -660.0663859373599, -1019.2927649051403, -217.6560343458906, -868.8602601110099, -171.95398216996082, -600.2051313229456, -716.6231305277743, -1042.3823645182483, -575.2925036261188, -308.46482325174696, -1065.5670727668698, -698.4865101430803, -807.070437986074, -758.1515914586729, -610.264832591564, -580.7871472565998, -783.3537441968392, -516.5986466266252, -74.66769400340279, -1089.1521389521015, -684.9682351599715, -808.8411855086704, -767.6233256942897, -842.4600686523396, -855.9897995613156, -407.5588686312747, -1030.8858024921171, -412.84750971626545, -846.3817908128508, -909.8477387804876, -318.23521185045905, -842.5144310839551, -764.5976212770505, -1168.018740960831, -781.1704278492787, -969.8432525600509, -630.0228743038799, -205.02157940360647, -1065.3463037369618, -721.4225534536655, -155.34989715210708, -886.6030856865957, -341.96438059044857, -468.3474302705946, -657.8541063606256, -641.9996069046721, -1154.5336595662905, -962.0733576369482, -114.05007961547368, -691.0720576909762, -449.73433081357587, -304.8161127649773, -471.879328118746, -636.127258892133, -742.2723750931314, -798.1477159533148, -722.8045437855274, -1064.3339105905902, -831.4739924788291, -751.470663941069, -894.9314813363768, -343.98137452864046, -28.907659346614867, -806.496590557013, -375.9555388692249, -375.9101828726347, -650.8534687848193, -657.192162333258, -918.9967563795975, -1037.9023363521246, -1036.9708195535088, -616.1592156807593, -900.3671680968903, -842.8083829073237, -825.3866898843785, -886.0228202589984, -642.8476223163966, -152.55269100455584, -877.8161272653014, -887.7120016859201, -89.17368759461782, -263.09061695016277, -10.300975250029515, -958.8027657425948, -157.4674414184321, -626.0586672661276, -873.8101199717424, -393.4253687657263, -254.35053681450725, -1087.577269852558, -20.56786563396359, -879.0650126415588, -909.2117552333766, -865.6797887726422, -1051.6873942938903, -876.3400379917265, -1079.7432896910593, -344.2304101750074, -718.03137457619, -969.0241651617891, -561.807623086486, -899.3523596611284, -592.3207985161498, -1054.539494597779, -839.1057915019874, -621.0072171043723, -403.33763194837366, -449.7154567181982, -1104.0322387636757, -936.0211846039526, -276.52030978119035, -920.2169460885292, -773.597759632576, -336.72042015614977, -874.535863823315, -1161.9716838443592, -1263.9833061753786, -751.9565973824551, -687.383036930378, -693.1463840349693, -64.95478492064653, -1143.262984800613, -19.07735943902601, -545.2365049928792, -731.6920459603576, -635.0485026496136, -698.7821471965482, -782.2078070426393, -799.8021259165861, -588.6772349751602, -883.7998721655879, -45.85131870555225, -1158.1747885893226, -270.06876365558236, -27.542560788727975, -672.5622547087969, -960.8346188871736, -682.5737883029102, -1126.7127898170047, -432.0358469310729, -779.2243816848023, -16.773226942680616, -837.5193820708165, -1022.6606785085503, -673.4028272916737, -952.8792030617234, -864.6846202942576, -1276.477586504719, -28.226396156563254, -248.32117018727786, -616.4339056488968, -955.6573336659917, -73.56905397969054, -441.30379612244536, -590.5825914895673, -614.6812962140515, -872.0217747744366, -173.09462956742857, -1155.109927434381, -1077.1554655454033, -1171.2926651564412, -760.2569009030921, -824.7225481359038, -975.292786510684, -1202.5200848534892, -627.2412796198627, -894.0817566786078, -1189.044329992014, -1181.966040061868, -841.8573352691766, -1032.583333222872, -836.1650036749857, -989.9103955426301, -841.7341361625131, -173.00114279844325, -1150.6474659544278, -422.6585854409796, -759.4646812019578, -79.76373628569148, -715.2337999886629, -353.9248789599584, -630.2758028019801, -521.9248812186709, -688.3272428230476, -901.691812532013, -759.358024498401, -694.7095284369469, -710.5360045504499, -97.84344425205617, -167.25978599552607, -626.6944759087212, -72.12618984467872, -925.1991111777988, -378.06522959202675, -1238.5225659453024, -1102.9117907014734, -148.91058645976983, -115.11126933834393, -318.7935760884921, -807.1686363936657, -179.12183187943816, -346.68270322884547, -660.9869295335924, -280.5439686531048, -381.99308890450595, -164.76815902426463, -404.00318239410973, -1005.9244100153963, -108.11001838958165, -237.37872415092994, -381.21991826982526, -193.3068076129029, -786.9710951429204, -789.4203501687446, -926.5276312285033, -803.6206742646078, -679.1248197529892, -762.8532699747889, -418.67364731789746, -806.4649463795406, -247.30228744075845, -396.70183227117667, -861.0340928833798, -999.4499388598266, -891.7841510452483, -106.13343564504507, -509.168799727548, -110.32857805202262, -112.09060824446156, -123.77521158760031, -476.85484909780087, -1020.0618448449002, -861.7749396309796, -813.6644122545035, -977.6682238006252, -1304.5559260056598, -764.2388985160771, -1099.3590773806484, -800.7361493293815, -474.675142054535, -792.3282482493635, -797.7784476414304, -598.1297158283004, -1068.4523232132738, -414.073482816056, -523.0053294108031, -928.1383192992912, -93.1060845673733, -740.8207022315512, -29.456052372295108, -802.78809489306, -265.0683326099228, -768.7281109501272, -310.77279229863956, -56.12292088117302, -456.01039801804666, -1026.7899515214565, -777.0603027791768, -880.9841482354318, -1016.7802411445917, -73.81278333288506, -149.47919215395822, -673.3596085847029, -319.88023976737634, -1186.5796754186053, -873.4272753817125, -770.3594522193436, -190.011230091102, -479.109416402249, -55.053276273307915, -201.45209958564715, -873.4734675188539, -283.5742705805126, -565.1753595262217, -861.8155594429827, -1204.9480228399743, -523.31134607449, -760.6348842258955, -570.385581552918, -420.46910976563646, -953.1611613260301, -873.6848648127717, -637.2236507513454, -827.6489510620361, -799.6403953220665, -293.62864760778854, -851.6576293448852, -843.5363856712833, -309.2327512164852, -477.9115358316954, -846.6821606852203, -937.8799684394972, -620.2723956757875, -307.06130113774566, -386.64550819416905, -750.7359444208769, -1024.4305416290263, -369.0081399310361, -512.3362607357598, -486.90265358817055, -152.94127452969286, -1126.2385609679325, -1221.7813100448348, -326.543224217569, -604.5496147364278, -638.7637480898452, -720.2731026445454, -358.77495211607, -500.4666131639004, -768.7090896706691, -838.477470363806, -890.5678612983173, -1016.3943270805029, -955.8214125366273, -1020.9246104526168, -297.6809428569497, -863.9395735291863, -828.0261544924739, -911.2180377296463, -761.3822912781303, -1134.4351639626973, -754.9135141280932, -184.3108258037569, -686.2052624146047, -527.4748344552523, -579.32392293008, -859.9659971470608, -62.8526938774109, -952.834268536387, -825.0066269327971, -278.5784991480283, -726.1778219273028, -684.510093251328, -836.0510563568542, -296.8515804668688, -499.0437625225305, -1070.001575612523, -633.0382216223745, -948.9858978613975, -79.74199750310702, -757.2655970471078, -970.9103543810581, -67.49185934448177, -515.9627592763532, -962.5138883883061, -449.2195577205063, -565.4262237074976, -698.5722874205759, -1191.1588442462846, -764.0394682212901, -675.8474738441711, -445.5627787628311, -142.19752561575436, -1058.5660260814295, -551.7214145237319, -876.491398106856, -592.671431034673, -911.1963416327153, -286.9184137739637, -1146.4447371238573, -872.4785142539135, -521.0947879294308, -912.5070052225648, -677.4824225963621, -1241.7635729107833, -858.872039986435, -812.2276917971706, -62.54685859417518, -642.5326782973356, -895.6356967368528, -1159.0212193379527, -927.018342621715, -499.64941970602354, -509.37046378638, -423.34431892613406, -872.4894203947229, -458.43447070247583, -945.6449098944095, -723.5830105772437, -1108.5866794585654, -929.5714000842831, -1067.333356979173, -692.3568028284577, -787.5611491497647, -525.70607690495, -179.20555525454463, -920.0742545553344, -460.7351360504848, -818.7993332851139, -1078.2120838990477, -730.8927006124511, -718.5158411277507, -870.9108256980286, -1283.2502100090794, -1199.7508857675964, -1185.3625101895118, -545.7702014175359, -902.7661489111247, -1035.6026020310226, -450.76297585401176]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6175311167065995, "mean_inference_ms": 1.739285536055924, "mean_action_processing_ms": 0.9855288825498625, "mean_env_wait_ms": 10.841787729071866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016188383102416992, "StateBufferConnector_ms": 0.011972188949584961, "ViewRequirementAgentConnector_ms": 0.46340370178222656}, "num_episodes": 40, "episode_return_max": -961.4966332566778, "episode_return_min": -4934.0849855596125, "episode_return_mean": -3431.125582344797, "episodes_this_iter": 40}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 167987, "num_agent_steps_trained": 167987, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 69.93899611356875, "num_env_steps_trained_throughput_per_sec": 69.93899611356875, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 167987, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 167987, "timers": {"training_iteration_time_ms": 58284.843, "restore_workers_time_ms": 0.031, "training_step_time_ms": 58284.762, "sample_time_ms": 3476.873, "learn_time_ms": 54746.662, "learn_throughput": 73.064, "synch_weights_time_ms": 57.774}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 167987, "num_agent_steps_trained": 167987}, "done": false, "training_iteration": 9, "trial_id": "efc54_00000", "date": "2024-07-24_18-48-44", "timestamp": 1721827124, "time_this_iter_s": 57.20428729057312, "time_total_s": 524.668417930603, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d71f760>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 524.668417930603, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 10.067073170731707, "ram_util_percent": 23.599999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 151.00624281099107, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 0.001, "total_loss": 5.094601219707065, "policy_loss": -0.0035555269000534383, "vf_loss": 5.1119064300855, "vf_explained_var": 0.9776293872462378, "kl": 0.012838465625898809, "entropy": 1.5033523354795244, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.41333333333333, "num_grad_updates_lifetime": 41730.5, "diff_num_grad_updates_vs_sampler_policy": 2249.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 187099, "num_agent_steps_trained": 187099}, "env_runners": {"episode_reward_max": -961.4966332566778, "episode_reward_min": -4934.0849855596125, "episode_reward_mean": -3404.486322224705, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1304.5559260056598}, "policy_reward_max": {"policy_0": -10.300975250029515}, "policy_reward_mean": {"policy_0": -680.8972644449412}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2937.8294274693603, -3242.9679532468363, -3939.540444946263, -3044.559371035566, -3959.88261457659, -3607.5217104329954, -3874.536433021573, -3591.6565634581652, -2510.1189000603717, -3563.728761414366, -2604.8294056825625, -4168.230826749333, -2450.2726446378733, -3640.854906722435, -4221.692276122858, -3446.951262531175, -1478.835486955838, -3235.221962670665, -3726.2118165754323, -3987.3692775957757, -3947.126067363528, -3514.1137291385753, -3181.5912994817577, -4558.441008367541, -2504.2236801135214, -3504.5178177805465, -2385.4373039047705, -3874.719298646957, -3329.580496498523, -3370.588976204538, -2677.5466809065942, -3892.063093535706, -4934.0849855596125, -4734.19074162153, -3873.3940114014417, -3127.7682688717205, -3096.14461833567, -2429.7067877333798, -3240.6075724685275, -2492.895858981745, -1849.3285221994881, -1920.184493974282, -3077.4458024228934, -3470.737357689824, -3396.2723025003907, -961.4966332566778, -4150.024269628816, -4443.565193286303, -3670.7622177484213, -2314.5264878813127, -2203.480251632923, -4157.625041698704, -2403.111499257529, -2367.9606503677155, -2785.490756654219, -3479.748944458907, -4091.3590232742513, -2775.966949672135, -3098.541334132418, -3143.4135403048704, -3432.053984496454, -2986.987505685031, -4722.185681731863, -3662.2469998863885, -3287.3396007644005, -3279.9835094237374, -2822.169051150381, -3230.8114551219314, -3274.1444584373035, -3668.416381316151, -2873.895218827918, -3813.722321672067, -4225.32630291306, -3271.814965411965, -3518.403764378207, -4108.7384910274195, -4002.5287859466307, -3457.026363044525, -4803.320463214903, -4120.264438403209, -3096.2094379291875, -3052.7174789655246, -3865.110638702072, -2562.4679151933774, -4235.984397017631, -2877.362032192856, -4189.720543250451, -3789.654072346036, -3844.2288505809443, -3611.901223466806, -4762.814150669503, -4074.4109410111478, -4098.9872233747465, -3078.124553055052, -2219.306456075759, -4038.494044807121, -3418.9368248125406, -3408.374480548971, -4536.528175411707, -3463.3234253412593], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-660.0663859373599, -1019.2927649051403, -217.6560343458906, -868.8602601110099, -171.95398216996082, -600.2051313229456, -716.6231305277743, -1042.3823645182483, -575.2925036261188, -308.46482325174696, -1065.5670727668698, -698.4865101430803, -807.070437986074, -758.1515914586729, -610.264832591564, -580.7871472565998, -783.3537441968392, -516.5986466266252, -74.66769400340279, -1089.1521389521015, -684.9682351599715, -808.8411855086704, -767.6233256942897, -842.4600686523396, -855.9897995613156, -407.5588686312747, -1030.8858024921171, -412.84750971626545, -846.3817908128508, -909.8477387804876, -318.23521185045905, -842.5144310839551, -764.5976212770505, -1168.018740960831, -781.1704278492787, -969.8432525600509, -630.0228743038799, -205.02157940360647, -1065.3463037369618, -721.4225534536655, -155.34989715210708, -886.6030856865957, -341.96438059044857, -468.3474302705946, -657.8541063606256, -641.9996069046721, -1154.5336595662905, -962.0733576369482, -114.05007961547368, -691.0720576909762, -449.73433081357587, -304.8161127649773, -471.879328118746, -636.127258892133, -742.2723750931314, -798.1477159533148, -722.8045437855274, -1064.3339105905902, -831.4739924788291, -751.470663941069, -894.9314813363768, -343.98137452864046, -28.907659346614867, -806.496590557013, -375.9555388692249, -375.9101828726347, -650.8534687848193, -657.192162333258, -918.9967563795975, -1037.9023363521246, -1036.9708195535088, -616.1592156807593, -900.3671680968903, -842.8083829073237, -825.3866898843785, -886.0228202589984, -642.8476223163966, -152.55269100455584, -877.8161272653014, -887.7120016859201, -89.17368759461782, -263.09061695016277, -10.300975250029515, -958.8027657425948, -157.4674414184321, -626.0586672661276, -873.8101199717424, -393.4253687657263, -254.35053681450725, -1087.577269852558, -20.56786563396359, -879.0650126415588, -909.2117552333766, -865.6797887726422, -1051.6873942938903, -876.3400379917265, -1079.7432896910593, -344.2304101750074, -718.03137457619, -969.0241651617891, -561.807623086486, -899.3523596611284, -592.3207985161498, -1054.539494597779, -839.1057915019874, -621.0072171043723, -403.33763194837366, -449.7154567181982, -1104.0322387636757, -936.0211846039526, -276.52030978119035, -920.2169460885292, -773.597759632576, -336.72042015614977, -874.535863823315, -1161.9716838443592, -1263.9833061753786, -751.9565973824551, -687.383036930378, -693.1463840349693, -64.95478492064653, -1143.262984800613, -19.07735943902601, -545.2365049928792, -731.6920459603576, -635.0485026496136, -698.7821471965482, -782.2078070426393, -799.8021259165861, -588.6772349751602, -883.7998721655879, -45.85131870555225, -1158.1747885893226, -270.06876365558236, -27.542560788727975, -672.5622547087969, -960.8346188871736, -682.5737883029102, -1126.7127898170047, -432.0358469310729, -779.2243816848023, -16.773226942680616, -837.5193820708165, -1022.6606785085503, -673.4028272916737, -952.8792030617234, -864.6846202942576, -1276.477586504719, -28.226396156563254, -248.32117018727786, -616.4339056488968, -955.6573336659917, -73.56905397969054, -441.30379612244536, -590.5825914895673, -614.6812962140515, -872.0217747744366, -173.09462956742857, -1155.109927434381, -1077.1554655454033, -1171.2926651564412, -760.2569009030921, -824.7225481359038, -975.292786510684, -1202.5200848534892, -627.2412796198627, -894.0817566786078, -1189.044329992014, -1181.966040061868, -841.8573352691766, -1032.583333222872, -836.1650036749857, -989.9103955426301, -841.7341361625131, -173.00114279844325, -1150.6474659544278, -422.6585854409796, -759.4646812019578, -79.76373628569148, -715.2337999886629, -353.9248789599584, -630.2758028019801, -521.9248812186709, -688.3272428230476, -901.691812532013, -759.358024498401, -694.7095284369469, -710.5360045504499, -97.84344425205617, -167.25978599552607, -626.6944759087212, -72.12618984467872, -925.1991111777988, -378.06522959202675, -1238.5225659453024, -1102.9117907014734, -148.91058645976983, -115.11126933834393, -318.7935760884921, -807.1686363936657, -179.12183187943816, -346.68270322884547, -660.9869295335924, -280.5439686531048, -381.99308890450595, -164.76815902426463, -404.00318239410973, -1005.9244100153963, -108.11001838958165, -237.37872415092994, -381.21991826982526, -193.3068076129029, -786.9710951429204, -789.4203501687446, -926.5276312285033, -803.6206742646078, -679.1248197529892, -762.8532699747889, -418.67364731789746, -806.4649463795406, -247.30228744075845, -396.70183227117667, -861.0340928833798, -999.4499388598266, -891.7841510452483, -106.13343564504507, -509.168799727548, -110.32857805202262, -112.09060824446156, -123.77521158760031, -476.85484909780087, -1020.0618448449002, -861.7749396309796, -813.6644122545035, -977.6682238006252, -1304.5559260056598, -764.2388985160771, -1099.3590773806484, -800.7361493293815, -474.675142054535, -792.3282482493635, -797.7784476414304, -598.1297158283004, -1068.4523232132738, -414.073482816056, -523.0053294108031, -928.1383192992912, -93.1060845673733, -740.8207022315512, -29.456052372295108, -802.78809489306, -265.0683326099228, -768.7281109501272, -310.77279229863956, -56.12292088117302, -456.01039801804666, -1026.7899515214565, -777.0603027791768, -880.9841482354318, -1016.7802411445917, -73.81278333288506, -149.47919215395822, -673.3596085847029, -319.88023976737634, -1186.5796754186053, -873.4272753817125, -770.3594522193436, -190.011230091102, -479.109416402249, -55.053276273307915, -201.45209958564715, -873.4734675188539, -283.5742705805126, -565.1753595262217, -861.8155594429827, -1204.9480228399743, -523.31134607449, -760.6348842258955, -570.385581552918, -420.46910976563646, -953.1611613260301, -873.6848648127717, -637.2236507513454, -827.6489510620361, -799.6403953220665, -293.62864760778854, -851.6576293448852, -843.5363856712833, -309.2327512164852, -477.9115358316954, -846.6821606852203, -937.8799684394972, -620.2723956757875, -307.06130113774566, -386.64550819416905, -750.7359444208769, -1024.4305416290263, -369.0081399310361, -512.3362607357598, -486.90265358817055, -152.94127452969286, -1126.2385609679325, -1221.7813100448348, -326.543224217569, -604.5496147364278, -638.7637480898452, -720.2731026445454, -358.77495211607, -500.4666131639004, -768.7090896706691, -838.477470363806, -890.5678612983173, -1016.3943270805029, -955.8214125366273, -1020.9246104526168, -297.6809428569497, -863.9395735291863, -828.0261544924739, -911.2180377296463, -761.3822912781303, -1134.4351639626973, -754.9135141280932, -184.3108258037569, -686.2052624146047, -527.4748344552523, -579.32392293008, -859.9659971470608, -62.8526938774109, -952.834268536387, -825.0066269327971, -278.5784991480283, -726.1778219273028, -684.510093251328, -836.0510563568542, -296.8515804668688, -499.0437625225305, -1070.001575612523, -633.0382216223745, -948.9858978613975, -79.74199750310702, -757.2655970471078, -970.9103543810581, -67.49185934448177, -515.9627592763532, -962.5138883883061, -449.2195577205063, -565.4262237074976, -698.5722874205759, -1191.1588442462846, -764.0394682212901, -675.8474738441711, -445.5627787628311, -142.19752561575436, -1058.5660260814295, -551.7214145237319, -876.491398106856, -592.671431034673, -911.1963416327153, -286.9184137739637, -1146.4447371238573, -872.4785142539135, -521.0947879294308, -912.5070052225648, -677.4824225963621, -1241.7635729107833, -858.872039986435, -812.2276917971706, -62.54685859417518, -642.5326782973356, -895.6356967368528, -1159.0212193379527, -927.018342621715, -499.64941970602354, -509.37046378638, -423.34431892613406, -872.4894203947229, -458.43447070247583, -945.6449098944095, -723.5830105772437, -1108.5866794585654, -929.5714000842831, -1067.333356979173, -692.3568028284577, -787.5611491497647, -525.70607690495, -179.20555525454463, -920.0742545553344, -460.7351360504848, -818.7993332851139, -1078.2120838990477, -730.8927006124511, -718.5158411277507, -870.9108256980286, -1283.2502100090794, -1199.7508857675964, -1185.3625101895118, -545.7702014175359, -902.7661489111247, -1035.6026020310226, -450.76297585401176, -541.7510731653651, -676.2648629530355, -182.08317340001682, -781.1484075410087, -914.9619208697576, -629.3785966027625, -925.1533889922393, -636.4717421133729, -505.4048557574075, -356.3088954997423, -520.1081228852219, -853.7261696995304, -911.7753602136564, -590.3781377815133, -989.122848122149, -554.766844853525, -441.50469511029445, -615.6503722488713, -537.9167446707817, -412.6292583099041, -970.4150050066618, -996.1071136306554, -637.328130071222, -667.673653936642, -964.4604943724526, -498.11995533094074, -1051.0820639943486, -292.78600566470124, -180.64071372612426, -854.7332934767405, -210.97275772392183, -1169.6466788721852, -976.7213186048724, -963.5134449039637, -868.8663431455104, -980.5313367712386, -478.7291739161328, -1070.2595080426925, -291.54329609753535, -968.5907575184374, -1208.424160850802, -287.4017698586483, -1209.6752977168994, -341.7584798441155, -796.9691423104792, -323.5774421253052, -844.9758340548423, -799.0690041654682, -777.576638996747, -866.7023041244422, -689.4394959140143, -859.6027181627616, -950.3345629653963, -1067.620799480881, -1195.8165741464543, -695.3593739986583, -949.2355712170128, -762.2379101305836, -859.7857016395169, -807.792384025374, -798.5355248011272, -287.5442496618378, -819.2640500777997, -1039.4016349454598, -1154.2417638885256, -903.4947525462393, -640.0738067269026, -190.33507077497484, -490.29260053622374, -853.9283224707111, -618.7696083536462, -811.8444780253654, -205.47255567866463, -427.4098085488161, -155.8100054692647, -789.4538426826713, -965.1989376722183, -71.30077216691873, -1059.8512073124714, -1152.689284972842, -745.0906582917222, -768.8096012308041, -872.5579730395816, -140.38511460458884, -892.0934776458457, -977.8949890623611, -517.1563262303378, -209.9416371647458, -897.2474234690652, -806.1341046224632, -786.5063022727356, -1010.6503735990602, -627.3890060645517, -1050.910822448867, -1061.0716710264985, -198.2109083858388, -1069.4921578476728, -493.1995153901478, -1015.2579108991408, -687.162932818459]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.60956394094967, "mean_inference_ms": 1.72958480839452, "mean_action_processing_ms": 0.9770026808182969, "mean_env_wait_ms": 10.772398542045082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0161130428314209, "StateBufferConnector_ms": 0.012064218521118164, "ViewRequirementAgentConnector_ms": 0.4677925109863281}, "num_episodes": 20, "episode_return_max": -961.4966332566778, "episode_return_min": -4934.0849855596125, "episode_return_mean": -3404.486322224705, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 187099, "num_agent_steps_trained": 187099, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 65.82551449783092, "num_env_steps_trained_throughput_per_sec": 65.82551449783092, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 187099, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 187099, "timers": {"training_iteration_time_ms": 58533.031, "restore_workers_time_ms": 0.031, "training_step_time_ms": 58532.951, "sample_time_ms": 3488.352, "learn_time_ms": 54983.416, "learn_throughput": 72.749, "synch_weights_time_ms": 57.741}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 187099, "num_agent_steps_trained": 187099}, "done": false, "training_iteration": 10, "trial_id": "efc54_00000", "date": "2024-07-24_18-49-45", "timestamp": 1721827185, "time_this_iter_s": 60.77948808670044, "time_total_s": 585.4479060173035, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7ada20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 585.4479060173035, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 10.109302325581396, "ram_util_percent": 23.59999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 153.6372542817252, "cur_kl_coeff": 0.1, "cur_lr": 0.0010000000000000005, "total_loss": 5.255681180613381, "policy_loss": -0.002933605875975142, "vf_loss": 5.2724051007202695, "vf_explained_var": 0.9752610416781334, "kl": 0.013660545305011467, "entropy": 1.5156364019995645, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.35, "num_grad_updates_lifetime": 46080.5, "diff_num_grad_updates_vs_sampler_policy": 2099.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 204928, "num_agent_steps_trained": 204928}, "env_runners": {"episode_reward_max": -961.4966332566778, "episode_reward_min": -5082.012789409791, "episode_reward_mean": -3401.312097093255, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1368.2633583222332}, "policy_reward_max": {"policy_0": -16.773226942680616}, "policy_reward_mean": {"policy_0": -680.2624194186511}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3947.126067363528, -3514.1137291385753, -3181.5912994817577, -4558.441008367541, -2504.2236801135214, -3504.5178177805465, -2385.4373039047705, -3874.719298646957, -3329.580496498523, -3370.588976204538, -2677.5466809065942, -3892.063093535706, -4934.0849855596125, -4734.19074162153, -3873.3940114014417, -3127.7682688717205, -3096.14461833567, -2429.7067877333798, -3240.6075724685275, -2492.895858981745, -1849.3285221994881, -1920.184493974282, -3077.4458024228934, -3470.737357689824, -3396.2723025003907, -961.4966332566778, -4150.024269628816, -4443.565193286303, -3670.7622177484213, -2314.5264878813127, -2203.480251632923, -4157.625041698704, -2403.111499257529, -2367.9606503677155, -2785.490756654219, -3479.748944458907, -4091.3590232742513, -2775.966949672135, -3098.541334132418, -3143.4135403048704, -3432.053984496454, -2986.987505685031, -4722.185681731863, -3662.2469998863885, -3287.3396007644005, -3279.9835094237374, -2822.169051150381, -3230.8114551219314, -3274.1444584373035, -3668.416381316151, -2873.895218827918, -3813.722321672067, -4225.32630291306, -3271.814965411965, -3518.403764378207, -4108.7384910274195, -4002.5287859466307, -3457.026363044525, -4803.320463214903, -4120.264438403209, -3096.2094379291875, -3052.7174789655246, -3865.110638702072, -2562.4679151933774, -4235.984397017631, -2877.362032192856, -4189.720543250451, -3789.654072346036, -3844.2288505809443, -3611.901223466806, -4762.814150669503, -4074.4109410111478, -4098.9872233747465, -3078.124553055052, -2219.306456075759, -4038.494044807121, -3418.9368248125406, -3408.374480548971, -4536.528175411707, -3463.3234253412593, -2630.0393689639586, -3978.6186662387217, -3463.198414801461, -5069.114037559485, -3668.7127833888126, -2230.0288137120874, -3380.147283421671, -2834.038900604579, -2519.4334637560296, -2940.4628187982325, -3374.8050529800985, -4153.92563838342, -3863.767893571685, -3629.9118155919614, -3492.1542630316567, -1454.8391953296384, -5082.012789409791, -3008.6459042852575, -2564.349620073675, -3577.1828088588136], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-561.807623086486, -899.3523596611284, -592.3207985161498, -1054.539494597779, -839.1057915019874, -621.0072171043723, -403.33763194837366, -449.7154567181982, -1104.0322387636757, -936.0211846039526, -276.52030978119035, -920.2169460885292, -773.597759632576, -336.72042015614977, -874.535863823315, -1161.9716838443592, -1263.9833061753786, -751.9565973824551, -687.383036930378, -693.1463840349693, -64.95478492064653, -1143.262984800613, -19.07735943902601, -545.2365049928792, -731.6920459603576, -635.0485026496136, -698.7821471965482, -782.2078070426393, -799.8021259165861, -588.6772349751602, -883.7998721655879, -45.85131870555225, -1158.1747885893226, -270.06876365558236, -27.542560788727975, -672.5622547087969, -960.8346188871736, -682.5737883029102, -1126.7127898170047, -432.0358469310729, -779.2243816848023, -16.773226942680616, -837.5193820708165, -1022.6606785085503, -673.4028272916737, -952.8792030617234, -864.6846202942576, -1276.477586504719, -28.226396156563254, -248.32117018727786, -616.4339056488968, -955.6573336659917, -73.56905397969054, -441.30379612244536, -590.5825914895673, -614.6812962140515, -872.0217747744366, -173.09462956742857, -1155.109927434381, -1077.1554655454033, -1171.2926651564412, -760.2569009030921, -824.7225481359038, -975.292786510684, -1202.5200848534892, -627.2412796198627, -894.0817566786078, -1189.044329992014, -1181.966040061868, -841.8573352691766, -1032.583333222872, -836.1650036749857, -989.9103955426301, -841.7341361625131, -173.00114279844325, -1150.6474659544278, -422.6585854409796, -759.4646812019578, -79.76373628569148, -715.2337999886629, -353.9248789599584, -630.2758028019801, -521.9248812186709, -688.3272428230476, -901.691812532013, -759.358024498401, -694.7095284369469, -710.5360045504499, -97.84344425205617, -167.25978599552607, -626.6944759087212, -72.12618984467872, -925.1991111777988, -378.06522959202675, -1238.5225659453024, -1102.9117907014734, -148.91058645976983, -115.11126933834393, -318.7935760884921, -807.1686363936657, -179.12183187943816, -346.68270322884547, -660.9869295335924, -280.5439686531048, -381.99308890450595, -164.76815902426463, -404.00318239410973, -1005.9244100153963, -108.11001838958165, -237.37872415092994, -381.21991826982526, -193.3068076129029, -786.9710951429204, -789.4203501687446, -926.5276312285033, -803.6206742646078, -679.1248197529892, -762.8532699747889, -418.67364731789746, -806.4649463795406, -247.30228744075845, -396.70183227117667, -861.0340928833798, -999.4499388598266, -891.7841510452483, -106.13343564504507, -509.168799727548, -110.32857805202262, -112.09060824446156, -123.77521158760031, -476.85484909780087, -1020.0618448449002, -861.7749396309796, -813.6644122545035, -977.6682238006252, -1304.5559260056598, -764.2388985160771, -1099.3590773806484, -800.7361493293815, -474.675142054535, -792.3282482493635, -797.7784476414304, -598.1297158283004, -1068.4523232132738, -414.073482816056, -523.0053294108031, -928.1383192992912, -93.1060845673733, -740.8207022315512, -29.456052372295108, -802.78809489306, -265.0683326099228, -768.7281109501272, -310.77279229863956, -56.12292088117302, -456.01039801804666, -1026.7899515214565, -777.0603027791768, -880.9841482354318, -1016.7802411445917, -73.81278333288506, -149.47919215395822, -673.3596085847029, -319.88023976737634, -1186.5796754186053, -873.4272753817125, -770.3594522193436, -190.011230091102, -479.109416402249, -55.053276273307915, -201.45209958564715, -873.4734675188539, -283.5742705805126, -565.1753595262217, -861.8155594429827, -1204.9480228399743, -523.31134607449, -760.6348842258955, -570.385581552918, -420.46910976563646, -953.1611613260301, -873.6848648127717, -637.2236507513454, -827.6489510620361, -799.6403953220665, -293.62864760778854, -851.6576293448852, -843.5363856712833, -309.2327512164852, -477.9115358316954, -846.6821606852203, -937.8799684394972, -620.2723956757875, -307.06130113774566, -386.64550819416905, -750.7359444208769, -1024.4305416290263, -369.0081399310361, -512.3362607357598, -486.90265358817055, -152.94127452969286, -1126.2385609679325, -1221.7813100448348, -326.543224217569, -604.5496147364278, -638.7637480898452, -720.2731026445454, -358.77495211607, -500.4666131639004, -768.7090896706691, -838.477470363806, -890.5678612983173, -1016.3943270805029, -955.8214125366273, -1020.9246104526168, -297.6809428569497, -863.9395735291863, -828.0261544924739, -911.2180377296463, -761.3822912781303, -1134.4351639626973, -754.9135141280932, -184.3108258037569, -686.2052624146047, -527.4748344552523, -579.32392293008, -859.9659971470608, -62.8526938774109, -952.834268536387, -825.0066269327971, -278.5784991480283, -726.1778219273028, -684.510093251328, -836.0510563568542, -296.8515804668688, -499.0437625225305, -1070.001575612523, -633.0382216223745, -948.9858978613975, -79.74199750310702, -757.2655970471078, -970.9103543810581, -67.49185934448177, -515.9627592763532, -962.5138883883061, -449.2195577205063, -565.4262237074976, -698.5722874205759, -1191.1588442462846, -764.0394682212901, -675.8474738441711, -445.5627787628311, -142.19752561575436, -1058.5660260814295, -551.7214145237319, -876.491398106856, -592.671431034673, -911.1963416327153, -286.9184137739637, -1146.4447371238573, -872.4785142539135, -521.0947879294308, -912.5070052225648, -677.4824225963621, -1241.7635729107833, -858.872039986435, -812.2276917971706, -62.54685859417518, -642.5326782973356, -895.6356967368528, -1159.0212193379527, -927.018342621715, -499.64941970602354, -509.37046378638, -423.34431892613406, -872.4894203947229, -458.43447070247583, -945.6449098944095, -723.5830105772437, -1108.5866794585654, -929.5714000842831, -1067.333356979173, -692.3568028284577, -787.5611491497647, -525.70607690495, -179.20555525454463, -920.0742545553344, -460.7351360504848, -818.7993332851139, -1078.2120838990477, -730.8927006124511, -718.5158411277507, -870.9108256980286, -1283.2502100090794, -1199.7508857675964, -1185.3625101895118, -545.7702014175359, -902.7661489111247, -1035.6026020310226, -450.76297585401176, -541.7510731653651, -676.2648629530355, -182.08317340001682, -781.1484075410087, -914.9619208697576, -629.3785966027625, -925.1533889922393, -636.4717421133729, -505.4048557574075, -356.3088954997423, -520.1081228852219, -853.7261696995304, -911.7753602136564, -590.3781377815133, -989.122848122149, -554.766844853525, -441.50469511029445, -615.6503722488713, -537.9167446707817, -412.6292583099041, -970.4150050066618, -996.1071136306554, -637.328130071222, -667.673653936642, -964.4604943724526, -498.11995533094074, -1051.0820639943486, -292.78600566470124, -180.64071372612426, -854.7332934767405, -210.97275772392183, -1169.6466788721852, -976.7213186048724, -963.5134449039637, -868.8663431455104, -980.5313367712386, -478.7291739161328, -1070.2595080426925, -291.54329609753535, -968.5907575184374, -1208.424160850802, -287.4017698586483, -1209.6752977168994, -341.7584798441155, -796.9691423104792, -323.5774421253052, -844.9758340548423, -799.0690041654682, -777.576638996747, -866.7023041244422, -689.4394959140143, -859.6027181627616, -950.3345629653963, -1067.620799480881, -1195.8165741464543, -695.3593739986583, -949.2355712170128, -762.2379101305836, -859.7857016395169, -807.792384025374, -798.5355248011272, -287.5442496618378, -819.2640500777997, -1039.4016349454598, -1154.2417638885256, -903.4947525462393, -640.0738067269026, -190.33507077497484, -490.29260053622374, -853.9283224707111, -618.7696083536462, -811.8444780253654, -205.47255567866463, -427.4098085488161, -155.8100054692647, -789.4538426826713, -965.1989376722183, -71.30077216691873, -1059.8512073124714, -1152.689284972842, -745.0906582917222, -768.8096012308041, -872.5579730395816, -140.38511460458884, -892.0934776458457, -977.8949890623611, -517.1563262303378, -209.9416371647458, -897.2474234690652, -806.1341046224632, -786.5063022727356, -1010.6503735990602, -627.3890060645517, -1050.910822448867, -1061.0716710264985, -198.2109083858388, -1069.4921578476728, -493.1995153901478, -1015.2579108991408, -687.162932818459, -468.93147949439515, -410.18694981384607, -831.6433748352993, -676.0597159029783, -243.21784891744102, -656.1958678916776, -1223.0160009107092, -785.807968801602, -678.7889734342994, -634.8098552004374, -1002.3204568463625, -262.96090972009364, -759.7034113603579, -619.6747957895701, -818.5388410850788, -949.307191279859, -1089.9843269270018, -1016.7831518527967, -959.7206204779204, -1053.3187470219045, -926.5161162851335, -852.7683825009481, -570.8639482726556, -191.89328095660048, -1126.6710553734754, -711.5071611798741, -290.544781125236, -661.1175870946937, -301.10559275535, -265.7536915569301, -737.2339244195126, -83.40418812284294, -797.6018120662465, -1050.9698497888503, -710.9375090242211, -63.67936368827072, -929.9046873810406, -1072.9527129744886, -661.1011877706908, -106.40094879008623, -884.1155858800447, -760.5949513439859, -264.32463563416127, -566.3318586029784, -44.06643229485852, -773.6685899965948, -596.3572967210158, -508.82887181471057, -124.65120507350855, -936.9568551924016, -714.5116168004882, -346.0583600910952, -742.414018614917, -1013.233746040442, -558.5873114331538, -808.0663523136839, -1058.3140286489297, -298.64333729176116, -1107.409377874171, -881.492542254871, -1083.4853968752022, -520.2961787925921, -567.4505076576664, -508.61559110646107, -1183.9202191397621, -148.25683987365986, -790.7262070038099, -427.30396824340147, -1368.2633583222332, -895.3614421488536, -1020.5333654250439, -315.8053960173381, -584.0336381517892, -560.654987307105, -1011.1268761303824, -177.97010891378892, -279.00151562834697, -538.951142205777, -306.0913593677495, -152.8250692139753, -1101.1180036906717, -1138.3555905113765, -898.6389778112798, -954.5767770474789, -989.3234403489836, -30.40709115201681, -899.8560891039318, -1004.8500836776357, -779.1154802615029, -294.4171600901738, -735.8260199580236, -81.78080991874164, -63.964000415232455, -918.1350674206883, -764.6437223609844, -150.2437569212424, -895.646653944339, -1065.866137664145, -658.8001822252995, -806.6260781037919]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6088843783648843, "mean_inference_ms": 1.728435273800797, "mean_action_processing_ms": 0.9665721419605336, "mean_env_wait_ms": 10.768507191961572, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016281843185424805, "StateBufferConnector_ms": 0.012109518051147461, "ViewRequirementAgentConnector_ms": 0.46649932861328125}, "num_episodes": 20, "episode_return_max": -961.4966332566778, "episode_return_min": -5082.012789409791, "episode_return_mean": -3401.312097093255, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204928, "num_agent_steps_trained": 204928, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 69.72554749528481, "num_env_steps_trained_throughput_per_sec": 69.72554749528481, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 204928, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204928, "timers": {"training_iteration_time_ms": 58175.201, "restore_workers_time_ms": 0.028, "training_step_time_ms": 58175.126, "sample_time_ms": 3471.725, "learn_time_ms": 54642.759, "learn_throughput": 73.203, "synch_weights_time_ms": 57.251}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 204928, "num_agent_steps_trained": 204928}, "done": false, "training_iteration": 11, "trial_id": "efc54_00000", "date": "2024-07-24_18-50-42", "timestamp": 1721827242, "time_this_iter_s": 57.37900257110596, "time_total_s": 642.8269085884094, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d71fb50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 642.8269085884094, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 10.143209876543208, "ram_util_percent": 23.599999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 156.8771519321433, "cur_kl_coeff": 0.09999999999999998, "cur_lr": 0.001, "total_loss": 5.094172253089697, "policy_loss": -0.0027860069444694486, "vf_loss": 5.110829120374321, "vf_explained_var": 0.9764900178595736, "kl": 0.014189376822995368, "entropy": 1.5289799461559372, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.85034013605443, "num_grad_updates_lifetime": 50385.5, "diff_num_grad_updates_vs_sampler_policy": 2204.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 223722, "num_agent_steps_trained": 223722}, "env_runners": {"episode_reward_max": -1454.8391953296384, "episode_reward_min": -5082.012789409791, "episode_reward_mean": -3386.6473731198744, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1368.2633583222332}, "policy_reward_max": {"policy_0": -29.938907352164573}, "policy_reward_mean": {"policy_0": -677.3294746239749}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3432.053984496454, -2986.987505685031, -4722.185681731863, -3662.2469998863885, -3287.3396007644005, -3279.9835094237374, -2822.169051150381, -3230.8114551219314, -3274.1444584373035, -3668.416381316151, -2873.895218827918, -3813.722321672067, -4225.32630291306, -3271.814965411965, -3518.403764378207, -4108.7384910274195, -4002.5287859466307, -3457.026363044525, -4803.320463214903, -4120.264438403209, -3096.2094379291875, -3052.7174789655246, -3865.110638702072, -2562.4679151933774, -4235.984397017631, -2877.362032192856, -4189.720543250451, -3789.654072346036, -3844.2288505809443, -3611.901223466806, -4762.814150669503, -4074.4109410111478, -4098.9872233747465, -3078.124553055052, -2219.306456075759, -4038.494044807121, -3418.9368248125406, -3408.374480548971, -4536.528175411707, -3463.3234253412593, -2630.0393689639586, -3978.6186662387217, -3463.198414801461, -5069.114037559485, -3668.7127833888126, -2230.0288137120874, -3380.147283421671, -2834.038900604579, -2519.4334637560296, -2940.4628187982325, -3374.8050529800985, -4153.92563838342, -3863.767893571685, -3629.9118155919614, -3492.1542630316567, -1454.8391953296384, -5082.012789409791, -3008.6459042852575, -2564.349620073675, -3577.1828088588136, -3397.482570948273, -3948.717236778542, -3581.8872670836195, -2782.819463941938, -3830.16735817838, -2901.7200735099163, -3338.293366241974, -3119.250406461757, -4068.9289932286783, -2380.717467809047, -2381.5663877631464, -4525.431718794493, -3612.000118841009, -2553.303345004352, -2585.746972570097, -4305.892950694045, -3385.1444740218863, -2906.1435289983992, -2701.2543742336284, -4291.622957357088, -1702.3000149433271, -2560.824829896756, -2454.9735226901757, -3016.8155670380606, -4142.33331495746, -3626.450847277326, -3229.3616191197502, -2654.8126813773324, -2181.639242685516, -3599.885921031135, -2528.5021481216404, -2822.041551087055, -2675.808547817546, -3859.41717743856, -3539.338673384411, -3218.4710006844684, -2945.5822620621693, -2803.2275229705397, -3260.9997422475008, -3542.433952329133], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-152.94127452969286, -1126.2385609679325, -1221.7813100448348, -326.543224217569, -604.5496147364278, -638.7637480898452, -720.2731026445454, -358.77495211607, -500.4666131639004, -768.7090896706691, -838.477470363806, -890.5678612983173, -1016.3943270805029, -955.8214125366273, -1020.9246104526168, -297.6809428569497, -863.9395735291863, -828.0261544924739, -911.2180377296463, -761.3822912781303, -1134.4351639626973, -754.9135141280932, -184.3108258037569, -686.2052624146047, -527.4748344552523, -579.32392293008, -859.9659971470608, -62.8526938774109, -952.834268536387, -825.0066269327971, -278.5784991480283, -726.1778219273028, -684.510093251328, -836.0510563568542, -296.8515804668688, -499.0437625225305, -1070.001575612523, -633.0382216223745, -948.9858978613975, -79.74199750310702, -757.2655970471078, -970.9103543810581, -67.49185934448177, -515.9627592763532, -962.5138883883061, -449.2195577205063, -565.4262237074976, -698.5722874205759, -1191.1588442462846, -764.0394682212901, -675.8474738441711, -445.5627787628311, -142.19752561575436, -1058.5660260814295, -551.7214145237319, -876.491398106856, -592.671431034673, -911.1963416327153, -286.9184137739637, -1146.4447371238573, -872.4785142539135, -521.0947879294308, -912.5070052225648, -677.4824225963621, -1241.7635729107833, -858.872039986435, -812.2276917971706, -62.54685859417518, -642.5326782973356, -895.6356967368528, -1159.0212193379527, -927.018342621715, -499.64941970602354, -509.37046378638, -423.34431892613406, -872.4894203947229, -458.43447070247583, -945.6449098944095, -723.5830105772437, -1108.5866794585654, -929.5714000842831, -1067.333356979173, -692.3568028284577, -787.5611491497647, -525.70607690495, -179.20555525454463, -920.0742545553344, -460.7351360504848, -818.7993332851139, -1078.2120838990477, -730.8927006124511, -718.5158411277507, -870.9108256980286, -1283.2502100090794, -1199.7508857675964, -1185.3625101895118, -545.7702014175359, -902.7661489111247, -1035.6026020310226, -450.76297585401176, -541.7510731653651, -676.2648629530355, -182.08317340001682, -781.1484075410087, -914.9619208697576, -629.3785966027625, -925.1533889922393, -636.4717421133729, -505.4048557574075, -356.3088954997423, -520.1081228852219, -853.7261696995304, -911.7753602136564, -590.3781377815133, -989.122848122149, -554.766844853525, -441.50469511029445, -615.6503722488713, -537.9167446707817, -412.6292583099041, -970.4150050066618, -996.1071136306554, -637.328130071222, -667.673653936642, -964.4604943724526, -498.11995533094074, -1051.0820639943486, -292.78600566470124, -180.64071372612426, -854.7332934767405, -210.97275772392183, -1169.6466788721852, -976.7213186048724, -963.5134449039637, -868.8663431455104, -980.5313367712386, -478.7291739161328, -1070.2595080426925, -291.54329609753535, -968.5907575184374, -1208.424160850802, -287.4017698586483, -1209.6752977168994, -341.7584798441155, -796.9691423104792, -323.5774421253052, -844.9758340548423, -799.0690041654682, -777.576638996747, -866.7023041244422, -689.4394959140143, -859.6027181627616, -950.3345629653963, -1067.620799480881, -1195.8165741464543, -695.3593739986583, -949.2355712170128, -762.2379101305836, -859.7857016395169, -807.792384025374, -798.5355248011272, -287.5442496618378, -819.2640500777997, -1039.4016349454598, -1154.2417638885256, -903.4947525462393, -640.0738067269026, -190.33507077497484, -490.29260053622374, -853.9283224707111, -618.7696083536462, -811.8444780253654, -205.47255567866463, -427.4098085488161, -155.8100054692647, -789.4538426826713, -965.1989376722183, -71.30077216691873, -1059.8512073124714, -1152.689284972842, -745.0906582917222, -768.8096012308041, -872.5579730395816, -140.38511460458884, -892.0934776458457, -977.8949890623611, -517.1563262303378, -209.9416371647458, -897.2474234690652, -806.1341046224632, -786.5063022727356, -1010.6503735990602, -627.3890060645517, -1050.910822448867, -1061.0716710264985, -198.2109083858388, -1069.4921578476728, -493.1995153901478, -1015.2579108991408, -687.162932818459, -468.93147949439515, -410.18694981384607, -831.6433748352993, -676.0597159029783, -243.21784891744102, -656.1958678916776, -1223.0160009107092, -785.807968801602, -678.7889734342994, -634.8098552004374, -1002.3204568463625, -262.96090972009364, -759.7034113603579, -619.6747957895701, -818.5388410850788, -949.307191279859, -1089.9843269270018, -1016.7831518527967, -959.7206204779204, -1053.3187470219045, -926.5161162851335, -852.7683825009481, -570.8639482726556, -191.89328095660048, -1126.6710553734754, -711.5071611798741, -290.544781125236, -661.1175870946937, -301.10559275535, -265.7536915569301, -737.2339244195126, -83.40418812284294, -797.6018120662465, -1050.9698497888503, -710.9375090242211, -63.67936368827072, -929.9046873810406, -1072.9527129744886, -661.1011877706908, -106.40094879008623, -884.1155858800447, -760.5949513439859, -264.32463563416127, -566.3318586029784, -44.06643229485852, -773.6685899965948, -596.3572967210158, -508.82887181471057, -124.65120507350855, -936.9568551924016, -714.5116168004882, -346.0583600910952, -742.414018614917, -1013.233746040442, -558.5873114331538, -808.0663523136839, -1058.3140286489297, -298.64333729176116, -1107.409377874171, -881.492542254871, -1083.4853968752022, -520.2961787925921, -567.4505076576664, -508.61559110646107, -1183.9202191397621, -148.25683987365986, -790.7262070038099, -427.30396824340147, -1368.2633583222332, -895.3614421488536, -1020.5333654250439, -315.8053960173381, -584.0336381517892, -560.654987307105, -1011.1268761303824, -177.97010891378892, -279.00151562834697, -538.951142205777, -306.0913593677495, -152.8250692139753, -1101.1180036906717, -1138.3555905113765, -898.6389778112798, -954.5767770474789, -989.3234403489836, -30.40709115201681, -899.8560891039318, -1004.8500836776357, -779.1154802615029, -294.4171600901738, -735.8260199580236, -81.78080991874164, -63.964000415232455, -918.1350674206883, -764.6437223609844, -150.2437569212424, -895.646653944339, -1065.866137664145, -658.8001822252995, -806.6260781037919, -688.7090653052975, -955.0282382586064, -513.2798306371544, -792.8421244231688, -447.6233123240454, -1048.0278701740165, -417.2904453655845, -1077.6506017514403, -354.6236959966342, -1051.1246234908676, -50.18121738807751, -877.5139933945662, -1065.0243260174866, -589.533413308685, -999.6343169748045, -480.4813585526285, -111.39350159125557, -601.2506779088533, -945.5835266377102, -644.1103992514887, -671.4508151948398, -1102.1905816288265, -507.10251275062535, -781.5183207730249, -767.9051278310573, -853.8232470853754, -343.6345704494963, -310.03113190272865, -924.7544303697433, -469.4766937025711, -850.2605471610772, -1040.2552794460357, -978.8616977552527, -55.757080827230624, -413.15876105237606, -1171.959369827751, -276.8803921739462, -610.577608188488, -716.2785955566707, -343.55444071490257, -859.8631259988942, -826.5694803108178, -665.4779902034478, -922.9019524848351, -794.1164442306854, -312.06696853127414, -29.938907352164573, -962.865416991482, -462.74718565759287, -613.0989892765339, -66.73849954123489, -815.6750169807283, -404.1409289617554, -93.64854724106023, -1001.3633950383685, -755.1305122380583, -978.8451824689008, -744.7711312791527, -921.532736523646, -1125.152156284735, -133.25689960419078, -1209.1193218200506, -725.3265924909508, -1196.8065879471371, -347.4907169786793, -827.1116944143045, -231.76712749901003, -109.96014511370497, -218.8453222139979, -1165.6190557633354, -86.72223250247839, -646.8946291843885, -617.6760835119009, -215.24768923935508, -1019.2063381319762, -563.0294176741677, -969.9783496176822, -1158.4770869755398, -515.216838652595, -1099.191257774059, -1285.2640058934278, -437.83678326070293, -786.3673225785788, -676.9003145833581, -198.77604770581576, -359.91080692124876, -405.2331883039039, -554.7338253743233, -662.5837964174493, -923.6819119814746, -49.80418539156952, -627.4657521706227, -680.2834241312339, -870.9987194678096, -472.70229307239146, -1167.200131466732, -519.9775265268411, -899.7827073568467, -865.500209926159, -839.1623820805107, -324.8232676360851, -414.4955076130441, -723.6274926360891, -209.16690301043067, -30.18684404767878, -772.6584022603115, -526.9618281745694, -714.5701593734709, -276.9950281974706, -269.6394118909334, -424.5552572513504, -441.7582833288485, -293.82127695148483, -585.8397404437172, -708.9989647147744, -548.2611797413127, -745.8301743175301, -483.61931236981496, -170.53660379607564, -1068.5682968133262, -1079.71608881737, -1180.1829467725427, -774.4298554649944, -222.7280602057984, -885.2763636967525, -872.0568686983977, -714.019911083208, -610.2773765932317, -1043.6026314566882, -386.494059445799, -358.2915143579623, -941.2007679572698, -802.7956044178997, -600.7313611535343, -526.3423712330837, -965.3104249134046, -482.5094403110411, -353.51716704214743, -810.2050980198035, -43.270551090936614, -1094.1811117302107, -241.05378948089614, -274.41188205571564, -501.89755758073335, -70.0949018379624, -968.4843080976685, -1029.185400817853, -1127.7711425266673, -444.14468009543396, -30.300389493513894, -678.7285177555586, -360.72803138938156, -912.7595202480293, -96.81446661552589, -479.4716121131435, -305.90053214270534, -797.4709471004563, -417.5210482515692, -1066.1304812630603, -235.01854232926368, -826.8216905472943, -332.1212359676156, -258.7549671794072, -1028.0914254787888, -230.0192286444386, -727.6504926745365, -272.09739134676204, -826.244550990939, -824.2769648434067, -1209.147777582918, -904.7253171415491, -456.72494464364735, -302.5984062174926, -696.2012244919063, -1179.0887808898187, -1119.7149016140322, -606.6544661480083, -583.8914914258618, -821.2988465665836, -86.91129492998382, -148.3928928981043, -752.5557497989276, -958.248109177847, -847.4647101070359, -238.92080008025422, -880.8133704197522, -199.84557631462187, -206.9838070036331, -870.6123099042261, -644.9724593283048, -593.3395740648097, -226.95945357838832, -1001.7204416778943, -307.0186509843478, -1131.9616219420589, -980.286972852491, -1079.997624213753, -480.1075108733392, -732.895983597084, -269.1458607924637]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.61287504517895, "mean_inference_ms": 1.7306810881300396, "mean_action_processing_ms": 0.9490833674547353, "mean_env_wait_ms": 10.80748520911527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015540361404418945, "StateBufferConnector_ms": 0.01150822639465332, "ViewRequirementAgentConnector_ms": 0.44708991050720215}, "num_episodes": 40, "episode_return_max": -1454.8391953296384, "episode_return_min": -5082.012789409791, "episode_return_mean": -3386.6473731198744, "episodes_this_iter": 40}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 223722, "num_agent_steps_trained": 223722, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 66.93110115299893, "num_env_steps_trained_throughput_per_sec": 66.93110115299893, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 223722, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 223722, "timers": {"training_iteration_time_ms": 58495.03, "restore_workers_time_ms": 0.028, "training_step_time_ms": 58494.955, "sample_time_ms": 3456.53, "learn_time_ms": 54976.098, "learn_throughput": 72.759, "synch_weights_time_ms": 58.871}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 223722, "num_agent_steps_trained": 223722}, "done": false, "training_iteration": 12, "trial_id": "efc54_00000", "date": "2024-07-24_18-51-42", "timestamp": 1721827302, "time_this_iter_s": 59.774619579315186, "time_total_s": 702.6015281677246, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7ad1b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 702.6015281677246, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 9.771764705882353, "ram_util_percent": 23.59999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 138.02137684337353, "cur_kl_coeff": 0.1, "cur_lr": 0.001, "total_loss": 5.255786677004316, "policy_loss": -0.003529793297625356, "vf_loss": 5.273127405412372, "vf_explained_var": 0.9791904488212955, "kl": 0.014191457562390555, "entropy": 1.523007104019183, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 54705.5, "diff_num_grad_updates_vs_sampler_policy": 2114.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 241770, "num_agent_steps_trained": 241770}, "env_runners": {"episode_reward_max": -1454.8391953296384, "episode_reward_min": -5082.012789409791, "episode_reward_mean": -3272.6446777817287, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1368.2633583222332}, "policy_reward_max": {"policy_0": -14.348812118978364}, "policy_reward_mean": {"policy_0": -654.5289355563456}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3096.2094379291875, -3052.7174789655246, -3865.110638702072, -2562.4679151933774, -4235.984397017631, -2877.362032192856, -4189.720543250451, -3789.654072346036, -3844.2288505809443, -3611.901223466806, -4762.814150669503, -4074.4109410111478, -4098.9872233747465, -3078.124553055052, -2219.306456075759, -4038.494044807121, -3418.9368248125406, -3408.374480548971, -4536.528175411707, -3463.3234253412593, -2630.0393689639586, -3978.6186662387217, -3463.198414801461, -5069.114037559485, -3668.7127833888126, -2230.0288137120874, -3380.147283421671, -2834.038900604579, -2519.4334637560296, -2940.4628187982325, -3374.8050529800985, -4153.92563838342, -3863.767893571685, -3629.9118155919614, -3492.1542630316567, -1454.8391953296384, -5082.012789409791, -3008.6459042852575, -2564.349620073675, -3577.1828088588136, -3397.482570948273, -3948.717236778542, -3581.8872670836195, -2782.819463941938, -3830.16735817838, -2901.7200735099163, -3338.293366241974, -3119.250406461757, -4068.9289932286783, -2380.717467809047, -2381.5663877631464, -4525.431718794493, -3612.000118841009, -2553.303345004352, -2585.746972570097, -4305.892950694045, -3385.1444740218863, -2906.1435289983992, -2701.2543742336284, -4291.622957357088, -1702.3000149433271, -2560.824829896756, -2454.9735226901757, -3016.8155670380606, -4142.33331495746, -3626.450847277326, -3229.3616191197502, -2654.8126813773324, -2181.639242685516, -3599.885921031135, -2528.5021481216404, -2822.041551087055, -2675.808547817546, -3859.41717743856, -3539.338673384411, -3218.4710006844684, -2945.5822620621693, -2803.2275229705397, -3260.9997422475008, -3542.433952329133, -1973.8379595948118, -3348.2242919670484, -1679.5378593599578, -3941.5890174834162, -4710.185326768949, -3121.751463052554, -4124.862240793079, -2085.404940192082, -3311.3948290008966, -2782.8112944283985, -3002.3407313609255, -3431.955061165192, -2789.683162769114, -2181.550431248467, -3435.2919010683568, -3606.866051378012, -2647.754940140935, -1648.6275314501133, -3718.927717368673, -3618.5134584479856], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-541.7510731653651, -676.2648629530355, -182.08317340001682, -781.1484075410087, -914.9619208697576, -629.3785966027625, -925.1533889922393, -636.4717421133729, -505.4048557574075, -356.3088954997423, -520.1081228852219, -853.7261696995304, -911.7753602136564, -590.3781377815133, -989.122848122149, -554.766844853525, -441.50469511029445, -615.6503722488713, -537.9167446707817, -412.6292583099041, -970.4150050066618, -996.1071136306554, -637.328130071222, -667.673653936642, -964.4604943724526, -498.11995533094074, -1051.0820639943486, -292.78600566470124, -180.64071372612426, -854.7332934767405, -210.97275772392183, -1169.6466788721852, -976.7213186048724, -963.5134449039637, -868.8663431455104, -980.5313367712386, -478.7291739161328, -1070.2595080426925, -291.54329609753535, -968.5907575184374, -1208.424160850802, -287.4017698586483, -1209.6752977168994, -341.7584798441155, -796.9691423104792, -323.5774421253052, -844.9758340548423, -799.0690041654682, -777.576638996747, -866.7023041244422, -689.4394959140143, -859.6027181627616, -950.3345629653963, -1067.620799480881, -1195.8165741464543, -695.3593739986583, -949.2355712170128, -762.2379101305836, -859.7857016395169, -807.792384025374, -798.5355248011272, -287.5442496618378, -819.2640500777997, -1039.4016349454598, -1154.2417638885256, -903.4947525462393, -640.0738067269026, -190.33507077497484, -490.29260053622374, -853.9283224707111, -618.7696083536462, -811.8444780253654, -205.47255567866463, -427.4098085488161, -155.8100054692647, -789.4538426826713, -965.1989376722183, -71.30077216691873, -1059.8512073124714, -1152.689284972842, -745.0906582917222, -768.8096012308041, -872.5579730395816, -140.38511460458884, -892.0934776458457, -977.8949890623611, -517.1563262303378, -209.9416371647458, -897.2474234690652, -806.1341046224632, -786.5063022727356, -1010.6503735990602, -627.3890060645517, -1050.910822448867, -1061.0716710264985, -198.2109083858388, -1069.4921578476728, -493.1995153901478, -1015.2579108991408, -687.162932818459, -468.93147949439515, -410.18694981384607, -831.6433748352993, -676.0597159029783, -243.21784891744102, -656.1958678916776, -1223.0160009107092, -785.807968801602, -678.7889734342994, -634.8098552004374, -1002.3204568463625, -262.96090972009364, -759.7034113603579, -619.6747957895701, -818.5388410850788, -949.307191279859, -1089.9843269270018, -1016.7831518527967, -959.7206204779204, -1053.3187470219045, -926.5161162851335, -852.7683825009481, -570.8639482726556, -191.89328095660048, -1126.6710553734754, -711.5071611798741, -290.544781125236, -661.1175870946937, -301.10559275535, -265.7536915569301, -737.2339244195126, -83.40418812284294, -797.6018120662465, -1050.9698497888503, -710.9375090242211, -63.67936368827072, -929.9046873810406, -1072.9527129744886, -661.1011877706908, -106.40094879008623, -884.1155858800447, -760.5949513439859, -264.32463563416127, -566.3318586029784, -44.06643229485852, -773.6685899965948, -596.3572967210158, -508.82887181471057, -124.65120507350855, -936.9568551924016, -714.5116168004882, -346.0583600910952, -742.414018614917, -1013.233746040442, -558.5873114331538, -808.0663523136839, -1058.3140286489297, -298.64333729176116, -1107.409377874171, -881.492542254871, -1083.4853968752022, -520.2961787925921, -567.4505076576664, -508.61559110646107, -1183.9202191397621, -148.25683987365986, -790.7262070038099, -427.30396824340147, -1368.2633583222332, -895.3614421488536, -1020.5333654250439, -315.8053960173381, -584.0336381517892, -560.654987307105, -1011.1268761303824, -177.97010891378892, -279.00151562834697, -538.951142205777, -306.0913593677495, -152.8250692139753, -1101.1180036906717, -1138.3555905113765, -898.6389778112798, -954.5767770474789, -989.3234403489836, -30.40709115201681, -899.8560891039318, -1004.8500836776357, -779.1154802615029, -294.4171600901738, -735.8260199580236, -81.78080991874164, -63.964000415232455, -918.1350674206883, -764.6437223609844, -150.2437569212424, -895.646653944339, -1065.866137664145, -658.8001822252995, -806.6260781037919, -688.7090653052975, -955.0282382586064, -513.2798306371544, -792.8421244231688, -447.6233123240454, -1048.0278701740165, -417.2904453655845, -1077.6506017514403, -354.6236959966342, -1051.1246234908676, -50.18121738807751, -877.5139933945662, -1065.0243260174866, -589.533413308685, -999.6343169748045, -480.4813585526285, -111.39350159125557, -601.2506779088533, -945.5835266377102, -644.1103992514887, -671.4508151948398, -1102.1905816288265, -507.10251275062535, -781.5183207730249, -767.9051278310573, -853.8232470853754, -343.6345704494963, -310.03113190272865, -924.7544303697433, -469.4766937025711, -850.2605471610772, -1040.2552794460357, -978.8616977552527, -55.757080827230624, -413.15876105237606, -1171.959369827751, -276.8803921739462, -610.577608188488, -716.2785955566707, -343.55444071490257, -859.8631259988942, -826.5694803108178, -665.4779902034478, -922.9019524848351, -794.1164442306854, -312.06696853127414, -29.938907352164573, -962.865416991482, -462.74718565759287, -613.0989892765339, -66.73849954123489, -815.6750169807283, -404.1409289617554, -93.64854724106023, -1001.3633950383685, -755.1305122380583, -978.8451824689008, -744.7711312791527, -921.532736523646, -1125.152156284735, -133.25689960419078, -1209.1193218200506, -725.3265924909508, -1196.8065879471371, -347.4907169786793, -827.1116944143045, -231.76712749901003, -109.96014511370497, -218.8453222139979, -1165.6190557633354, -86.72223250247839, -646.8946291843885, -617.6760835119009, -215.24768923935508, -1019.2063381319762, -563.0294176741677, -969.9783496176822, -1158.4770869755398, -515.216838652595, -1099.191257774059, -1285.2640058934278, -437.83678326070293, -786.3673225785788, -676.9003145833581, -198.77604770581576, -359.91080692124876, -405.2331883039039, -554.7338253743233, -662.5837964174493, -923.6819119814746, -49.80418539156952, -627.4657521706227, -680.2834241312339, -870.9987194678096, -472.70229307239146, -1167.200131466732, -519.9775265268411, -899.7827073568467, -865.500209926159, -839.1623820805107, -324.8232676360851, -414.4955076130441, -723.6274926360891, -209.16690301043067, -30.18684404767878, -772.6584022603115, -526.9618281745694, -714.5701593734709, -276.9950281974706, -269.6394118909334, -424.5552572513504, -441.7582833288485, -293.82127695148483, -585.8397404437172, -708.9989647147744, -548.2611797413127, -745.8301743175301, -483.61931236981496, -170.53660379607564, -1068.5682968133262, -1079.71608881737, -1180.1829467725427, -774.4298554649944, -222.7280602057984, -885.2763636967525, -872.0568686983977, -714.019911083208, -610.2773765932317, -1043.6026314566882, -386.494059445799, -358.2915143579623, -941.2007679572698, -802.7956044178997, -600.7313611535343, -526.3423712330837, -965.3104249134046, -482.5094403110411, -353.51716704214743, -810.2050980198035, -43.270551090936614, -1094.1811117302107, -241.05378948089614, -274.41188205571564, -501.89755758073335, -70.0949018379624, -968.4843080976685, -1029.185400817853, -1127.7711425266673, -444.14468009543396, -30.300389493513894, -678.7285177555586, -360.72803138938156, -912.7595202480293, -96.81446661552589, -479.4716121131435, -305.90053214270534, -797.4709471004563, -417.5210482515692, -1066.1304812630603, -235.01854232926368, -826.8216905472943, -332.1212359676156, -258.7549671794072, -1028.0914254787888, -230.0192286444386, -727.6504926745365, -272.09739134676204, -826.244550990939, -824.2769648434067, -1209.147777582918, -904.7253171415491, -456.72494464364735, -302.5984062174926, -696.2012244919063, -1179.0887808898187, -1119.7149016140322, -606.6544661480083, -583.8914914258618, -821.2988465665836, -86.91129492998382, -148.3928928981043, -752.5557497989276, -958.248109177847, -847.4647101070359, -238.92080008025422, -880.8133704197522, -199.84557631462187, -206.9838070036331, -870.6123099042261, -644.9724593283048, -593.3395740648097, -226.95945357838832, -1001.7204416778943, -307.0186509843478, -1131.9616219420589, -980.286972852491, -1079.997624213753, -480.1075108733392, -732.895983597084, -269.1458607924637, -516.8779664154855, -793.0824359610986, -348.2588844161095, -292.78380201884005, -22.834870783278735, -972.7406007722004, -14.348812118978364, -570.5478303103345, -974.2397490314831, -816.3472997340479, -643.2865094996089, -185.33362214236047, -404.65771717310656, -257.83023096303026, -188.42977958185207, -721.3236858082848, -1166.6370238733803, -464.8997349979705, -743.070107143728, -845.6584656600537, -802.1454888638546, -1039.7318401289342, -1063.2164243611126, -1065.880720603865, -739.2108528111859, -480.8481976111959, -250.17726339298963, -294.3251828196706, -997.4449744619295, -1098.955844766772, -978.679822948529, -796.8181319329923, -557.24270118035, -852.063352777491, -940.0582319537187, -120.03301545817627, -786.4316669265334, -811.9340302337242, -262.8290271435936, -104.17720043005312, -382.4978950583676, -891.999708920234, -1030.4402469717343, -484.9067327786596, -521.550245271901, -39.06366942640442, -776.148083950859, -142.9638970955316, -862.8401212381593, -961.7955227174442, -987.2535101722989, -97.13809624669487, -165.9124229006987, -906.6545862113333, -845.3821158299006, -131.86713739328326, -830.4176483035352, -435.677043798296, -944.347609481502, -1089.6456221885758, -350.37639788541384, -864.6653077651802, -630.1504350544625, -581.4744831549369, -363.01653890912434, -967.4861836539825, -316.95561145458373, -26.11102756469455, -94.98151572289798, -776.0160928523079, -158.2526838851648, -507.2893627656606, -692.0769089261173, -1205.02672014912, -872.6462253422912, -459.4429599279636, -716.7229092980277, -828.3376921784212, -531.5707342690756, -1070.791755704523, -831.1955664800093, -449.0843347467925, -526.7863764026537, -67.25110012676176, -773.437562384717, -395.90705775692453, -21.75190663675168, -149.3479811287953, -99.89982699899154, -981.7207589286509, -991.3029510607479, -1039.0128848521904, -778.4853967100702, -408.8393494977502, -501.2871352479154, -784.2519365257365, -421.5268692071121, -764.8545431485411, -1109.756395617393, -538.123713949203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.608120067975689, "mean_inference_ms": 1.726558784845402, "mean_action_processing_ms": 0.9449292371904336, "mean_env_wait_ms": 10.756859371140242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01560521125793457, "StateBufferConnector_ms": 0.01151132583618164, "ViewRequirementAgentConnector_ms": 0.44350290298461914}, "num_episodes": 20, "episode_return_max": -1454.8391953296384, "episode_return_min": -5082.012789409791, "episode_return_mean": -3272.6446777817287, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 241770, "num_agent_steps_trained": 241770, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 70.63394452064536, "num_env_steps_trained_throughput_per_sec": 70.63394452064536, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 241770, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 241770, "timers": {"training_iteration_time_ms": 58017.042, "restore_workers_time_ms": 0.029, "training_step_time_ms": 58016.966, "sample_time_ms": 3462.064, "learn_time_ms": 54492.67, "learn_throughput": 73.404, "synch_weights_time_ms": 58.805}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 241770, "num_agent_steps_trained": 241770}, "done": false, "training_iteration": 13, "trial_id": "efc54_00000", "date": "2024-07-24_18-52-39", "timestamp": 1721827359, "time_this_iter_s": 56.64117240905762, "time_total_s": 759.2427005767822, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x717b995255a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 759.2427005767822, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 10.306172839506173, "ram_util_percent": 23.599999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 160.83385744233786, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 0.001, "total_loss": 5.312284683083599, "policy_loss": -0.0027829601453282895, "vf_loss": 5.329234072406253, "vf_explained_var": 0.9793147381091173, "kl": 0.017083905323534796, "entropy": 1.5874814226632907, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.12587412587412, "num_grad_updates_lifetime": 58965.5, "diff_num_grad_updates_vs_sampler_policy": 2144.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 259949, "num_agent_steps_trained": 259949}, "env_runners": {"episode_reward_max": -1454.8391953296384, "episode_reward_min": -5082.012789409791, "episode_reward_mean": -3226.9638209325512, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1368.2633583222332}, "policy_reward_max": {"policy_0": -13.946135782840468}, "policy_reward_mean": {"policy_0": -645.3927641865102}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2630.0393689639586, -3978.6186662387217, -3463.198414801461, -5069.114037559485, -3668.7127833888126, -2230.0288137120874, -3380.147283421671, -2834.038900604579, -2519.4334637560296, -2940.4628187982325, -3374.8050529800985, -4153.92563838342, -3863.767893571685, -3629.9118155919614, -3492.1542630316567, -1454.8391953296384, -5082.012789409791, -3008.6459042852575, -2564.349620073675, -3577.1828088588136, -3397.482570948273, -3948.717236778542, -3581.8872670836195, -2782.819463941938, -3830.16735817838, -2901.7200735099163, -3338.293366241974, -3119.250406461757, -4068.9289932286783, -2380.717467809047, -2381.5663877631464, -4525.431718794493, -3612.000118841009, -2553.303345004352, -2585.746972570097, -4305.892950694045, -3385.1444740218863, -2906.1435289983992, -2701.2543742336284, -4291.622957357088, -1702.3000149433271, -2560.824829896756, -2454.9735226901757, -3016.8155670380606, -4142.33331495746, -3626.450847277326, -3229.3616191197502, -2654.8126813773324, -2181.639242685516, -3599.885921031135, -2528.5021481216404, -2822.041551087055, -2675.808547817546, -3859.41717743856, -3539.338673384411, -3218.4710006844684, -2945.5822620621693, -2803.2275229705397, -3260.9997422475008, -3542.433952329133, -1973.8379595948118, -3348.2242919670484, -1679.5378593599578, -3941.5890174834162, -4710.185326768949, -3121.751463052554, -4124.862240793079, -2085.404940192082, -3311.3948290008966, -2782.8112944283985, -3002.3407313609255, -3431.955061165192, -2789.683162769114, -2181.550431248467, -3435.2919010683568, -3606.866051378012, -2647.754940140935, -1648.6275314501133, -3718.927717368673, -3618.5134584479856, -3584.0998294734736, -2882.103684577751, -3614.726993655357, -3019.6659003628365, -3208.27371097238, -3421.8991588918752, -3385.1623078109133, -3274.402952424453, -2638.6915403280445, -4508.318530299833, -4182.307162173165, -3365.4129824022602, -3493.7520218119557, -4089.421899259627, -2888.53792747279, -3649.967717552835, -3166.6380386866003, -2815.711518643562, -3129.5384379290135, -3337.938865106283], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-468.93147949439515, -410.18694981384607, -831.6433748352993, -676.0597159029783, -243.21784891744102, -656.1958678916776, -1223.0160009107092, -785.807968801602, -678.7889734342994, -634.8098552004374, -1002.3204568463625, -262.96090972009364, -759.7034113603579, -619.6747957895701, -818.5388410850788, -949.307191279859, -1089.9843269270018, -1016.7831518527967, -959.7206204779204, -1053.3187470219045, -926.5161162851335, -852.7683825009481, -570.8639482726556, -191.89328095660048, -1126.6710553734754, -711.5071611798741, -290.544781125236, -661.1175870946937, -301.10559275535, -265.7536915569301, -737.2339244195126, -83.40418812284294, -797.6018120662465, -1050.9698497888503, -710.9375090242211, -63.67936368827072, -929.9046873810406, -1072.9527129744886, -661.1011877706908, -106.40094879008623, -884.1155858800447, -760.5949513439859, -264.32463563416127, -566.3318586029784, -44.06643229485852, -773.6685899965948, -596.3572967210158, -508.82887181471057, -124.65120507350855, -936.9568551924016, -714.5116168004882, -346.0583600910952, -742.414018614917, -1013.233746040442, -558.5873114331538, -808.0663523136839, -1058.3140286489297, -298.64333729176116, -1107.409377874171, -881.492542254871, -1083.4853968752022, -520.2961787925921, -567.4505076576664, -508.61559110646107, -1183.9202191397621, -148.25683987365986, -790.7262070038099, -427.30396824340147, -1368.2633583222332, -895.3614421488536, -1020.5333654250439, -315.8053960173381, -584.0336381517892, -560.654987307105, -1011.1268761303824, -177.97010891378892, -279.00151562834697, -538.951142205777, -306.0913593677495, -152.8250692139753, -1101.1180036906717, -1138.3555905113765, -898.6389778112798, -954.5767770474789, -989.3234403489836, -30.40709115201681, -899.8560891039318, -1004.8500836776357, -779.1154802615029, -294.4171600901738, -735.8260199580236, -81.78080991874164, -63.964000415232455, -918.1350674206883, -764.6437223609844, -150.2437569212424, -895.646653944339, -1065.866137664145, -658.8001822252995, -806.6260781037919, -688.7090653052975, -955.0282382586064, -513.2798306371544, -792.8421244231688, -447.6233123240454, -1048.0278701740165, -417.2904453655845, -1077.6506017514403, -354.6236959966342, -1051.1246234908676, -50.18121738807751, -877.5139933945662, -1065.0243260174866, -589.533413308685, -999.6343169748045, -480.4813585526285, -111.39350159125557, -601.2506779088533, -945.5835266377102, -644.1103992514887, -671.4508151948398, -1102.1905816288265, -507.10251275062535, -781.5183207730249, -767.9051278310573, -853.8232470853754, -343.6345704494963, -310.03113190272865, -924.7544303697433, -469.4766937025711, -850.2605471610772, -1040.2552794460357, -978.8616977552527, -55.757080827230624, -413.15876105237606, -1171.959369827751, -276.8803921739462, -610.577608188488, -716.2785955566707, -343.55444071490257, -859.8631259988942, -826.5694803108178, -665.4779902034478, -922.9019524848351, -794.1164442306854, -312.06696853127414, -29.938907352164573, -962.865416991482, -462.74718565759287, -613.0989892765339, -66.73849954123489, -815.6750169807283, -404.1409289617554, -93.64854724106023, -1001.3633950383685, -755.1305122380583, -978.8451824689008, -744.7711312791527, -921.532736523646, -1125.152156284735, -133.25689960419078, -1209.1193218200506, -725.3265924909508, -1196.8065879471371, -347.4907169786793, -827.1116944143045, -231.76712749901003, -109.96014511370497, -218.8453222139979, -1165.6190557633354, -86.72223250247839, -646.8946291843885, -617.6760835119009, -215.24768923935508, -1019.2063381319762, -563.0294176741677, -969.9783496176822, -1158.4770869755398, -515.216838652595, -1099.191257774059, -1285.2640058934278, -437.83678326070293, -786.3673225785788, -676.9003145833581, -198.77604770581576, -359.91080692124876, -405.2331883039039, -554.7338253743233, -662.5837964174493, -923.6819119814746, -49.80418539156952, -627.4657521706227, -680.2834241312339, -870.9987194678096, -472.70229307239146, -1167.200131466732, -519.9775265268411, -899.7827073568467, -865.500209926159, -839.1623820805107, -324.8232676360851, -414.4955076130441, -723.6274926360891, -209.16690301043067, -30.18684404767878, -772.6584022603115, -526.9618281745694, -714.5701593734709, -276.9950281974706, -269.6394118909334, -424.5552572513504, -441.7582833288485, -293.82127695148483, -585.8397404437172, -708.9989647147744, -548.2611797413127, -745.8301743175301, -483.61931236981496, -170.53660379607564, -1068.5682968133262, -1079.71608881737, -1180.1829467725427, -774.4298554649944, -222.7280602057984, -885.2763636967525, -872.0568686983977, -714.019911083208, -610.2773765932317, -1043.6026314566882, -386.494059445799, -358.2915143579623, -941.2007679572698, -802.7956044178997, -600.7313611535343, -526.3423712330837, -965.3104249134046, -482.5094403110411, -353.51716704214743, -810.2050980198035, -43.270551090936614, -1094.1811117302107, -241.05378948089614, -274.41188205571564, -501.89755758073335, -70.0949018379624, -968.4843080976685, -1029.185400817853, -1127.7711425266673, -444.14468009543396, -30.300389493513894, -678.7285177555586, -360.72803138938156, -912.7595202480293, -96.81446661552589, -479.4716121131435, -305.90053214270534, -797.4709471004563, -417.5210482515692, -1066.1304812630603, -235.01854232926368, -826.8216905472943, -332.1212359676156, -258.7549671794072, -1028.0914254787888, -230.0192286444386, -727.6504926745365, -272.09739134676204, -826.244550990939, -824.2769648434067, -1209.147777582918, -904.7253171415491, -456.72494464364735, -302.5984062174926, -696.2012244919063, -1179.0887808898187, -1119.7149016140322, -606.6544661480083, -583.8914914258618, -821.2988465665836, -86.91129492998382, -148.3928928981043, -752.5557497989276, -958.248109177847, -847.4647101070359, -238.92080008025422, -880.8133704197522, -199.84557631462187, -206.9838070036331, -870.6123099042261, -644.9724593283048, -593.3395740648097, -226.95945357838832, -1001.7204416778943, -307.0186509843478, -1131.9616219420589, -980.286972852491, -1079.997624213753, -480.1075108733392, -732.895983597084, -269.1458607924637, -516.8779664154855, -793.0824359610986, -348.2588844161095, -292.78380201884005, -22.834870783278735, -972.7406007722004, -14.348812118978364, -570.5478303103345, -974.2397490314831, -816.3472997340479, -643.2865094996089, -185.33362214236047, -404.65771717310656, -257.83023096303026, -188.42977958185207, -721.3236858082848, -1166.6370238733803, -464.8997349979705, -743.070107143728, -845.6584656600537, -802.1454888638546, -1039.7318401289342, -1063.2164243611126, -1065.880720603865, -739.2108528111859, -480.8481976111959, -250.17726339298963, -294.3251828196706, -997.4449744619295, -1098.955844766772, -978.679822948529, -796.8181319329923, -557.24270118035, -852.063352777491, -940.0582319537187, -120.03301545817627, -786.4316669265334, -811.9340302337242, -262.8290271435936, -104.17720043005312, -382.4978950583676, -891.999708920234, -1030.4402469717343, -484.9067327786596, -521.550245271901, -39.06366942640442, -776.148083950859, -142.9638970955316, -862.8401212381593, -961.7955227174442, -987.2535101722989, -97.13809624669487, -165.9124229006987, -906.6545862113333, -845.3821158299006, -131.86713739328326, -830.4176483035352, -435.677043798296, -944.347609481502, -1089.6456221885758, -350.37639788541384, -864.6653077651802, -630.1504350544625, -581.4744831549369, -363.01653890912434, -967.4861836539825, -316.95561145458373, -26.11102756469455, -94.98151572289798, -776.0160928523079, -158.2526838851648, -507.2893627656606, -692.0769089261173, -1205.02672014912, -872.6462253422912, -459.4429599279636, -716.7229092980277, -828.3376921784212, -531.5707342690756, -1070.791755704523, -831.1955664800093, -449.0843347467925, -526.7863764026537, -67.25110012676176, -773.437562384717, -395.90705775692453, -21.75190663675168, -149.3479811287953, -99.89982699899154, -981.7207589286509, -991.3029510607479, -1039.0128848521904, -778.4853967100702, -408.8393494977502, -501.2871352479154, -784.2519365257365, -421.5268692071121, -764.8545431485411, -1109.756395617393, -538.123713949203, -979.5719723499077, -952.4797229341785, -194.44030190813777, -541.80578965458, -915.8020426266647, -912.7209189390056, -597.3810174820795, -73.67379100315007, -747.7663866886093, -550.5615704649036, -735.3461073467264, -689.8017167261509, -541.7633247597912, -1232.3913682818009, -415.42447654088534, -935.5872548885338, -429.2642477423572, -845.2151555038214, -98.5615675919227, -711.037674636205, -887.016337017966, -168.37945017345922, -864.023349548641, -213.74390871428142, -1075.1106655180329, -100.51923458188737, -878.5493384997006, -754.1514119215589, -603.8628248977869, -1084.8163489909414, -686.5659468473892, -816.9435510445296, -793.5404355353738, -366.49378261818435, -721.6185917654369, -631.1690986946381, -23.01817989408135, -651.2530634136892, -1062.1661623248478, -906.7964480971984, -590.786947952441, -13.946135782840468, -393.7401770331436, -584.8331388828652, -1055.3851406767567, -713.7522915753462, -764.351617280194, -879.7670410543524, -919.3823506833605, -1231.065229706579, -634.8607605030049, -1075.9344414427112, -1150.2682747753104, -171.44118984079026, -1149.8024956113497, -1095.4810331869892, -395.55237297003157, -40.371904462407386, -881.8426510516849, -952.1650207311455, -709.4223924926148, -1042.73610552408, -1093.1542636830702, -73.78075075194398, -574.6585093602446, -529.3394986808419, -917.8653608701851, -765.9959250652657, -768.9814837415496, -1107.2396309017854, -375.3569052356876, -941.8641325849424, -794.1818466762595, -30.328978274933693, -746.8060647009687, -891.3438586864744, -841.8667821852396, -931.3857491873597, -202.5062497961413, -782.8650776976217, -405.2448001598618, -1011.70434592283, -795.1068490935439, -100.66270331602414, -853.919340194343, -124.80203019309134, -172.56141256578184, -1025.9379458307847, -934.3725640987888, -558.0375659551144, -989.5353054256584, -143.23861511777542, -941.6305282761933, -987.4058103500728, -67.72817875931605, -617.0793744611046, -756.2549166629894, -314.2143195807378, -1192.9515752303898, -457.438679171061]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6064429983804347, "mean_inference_ms": 1.725897772203306, "mean_action_processing_ms": 0.9383334880729454, "mean_env_wait_ms": 10.743524124363589, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015730619430541992, "StateBufferConnector_ms": 0.011788129806518555, "ViewRequirementAgentConnector_ms": 0.45069289207458496}, "num_episodes": 20, "episode_return_max": -1454.8391953296384, "episode_return_min": -5082.012789409791, "episode_return_mean": -3226.9638209325512, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 259949, "num_agent_steps_trained": 259949, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 67.45349822256068, "num_env_steps_trained_throughput_per_sec": 67.45349822256068, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 259949, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 259949, "timers": {"training_iteration_time_ms": 57871.74, "restore_workers_time_ms": 0.029, "training_step_time_ms": 57871.665, "sample_time_ms": 3453.019, "learn_time_ms": 54358.117, "learn_throughput": 73.586, "synch_weights_time_ms": 57.181}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 259949, "num_agent_steps_trained": 259949}, "done": false, "training_iteration": 14, "trial_id": "efc54_00000", "date": "2024-07-24_18-53-38", "timestamp": 1721827418, "time_this_iter_s": 59.31025052070618, "time_total_s": 818.5529510974884, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7ae9e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 818.5529510974884, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 10.005952380952381, "ram_util_percent": 23.599999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 139.51187090306848, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 0.001, "total_loss": 5.067757116720115, "policy_loss": -0.0034923041778073065, "vf_loss": 5.085219315604452, "vf_explained_var": 0.977341487593862, "kl": 0.01746512331374615, "entropy": 1.5716406200037691, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.2867132867133, "num_grad_updates_lifetime": 63255.5, "diff_num_grad_updates_vs_sampler_policy": 2144.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 278151, "num_agent_steps_trained": 278151}, "env_runners": {"episode_reward_max": -935.720660997476, "episode_reward_min": -4710.185326768949, "episode_reward_mean": -3030.0213572203265, "episode_len_mean": 149.65, "episode_media": {}, "episodes_timesteps_total": 14965, "policy_reward_min": {"policy_0": -1319.55548707976}, "policy_reward_max": {"policy_0": -12.568672812846504}, "policy_reward_mean": {"policy_0": -606.0042714440651}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1702.3000149433271, -2560.824829896756, -2454.9735226901757, -3016.8155670380606, -4142.33331495746, -3626.450847277326, -3229.3616191197502, -2654.8126813773324, -2181.639242685516, -3599.885921031135, -2528.5021481216404, -2822.041551087055, -2675.808547817546, -3859.41717743856, -3539.338673384411, -3218.4710006844684, -2945.5822620621693, -2803.2275229705397, -3260.9997422475008, -3542.433952329133, -1973.8379595948118, -3348.2242919670484, -1679.5378593599578, -3941.5890174834162, -4710.185326768949, -3121.751463052554, -4124.862240793079, -2085.404940192082, -3311.3948290008966, -2782.8112944283985, -3002.3407313609255, -3431.955061165192, -2789.683162769114, -2181.550431248467, -3435.2919010683568, -3606.866051378012, -2647.754940140935, -1648.6275314501133, -3718.927717368673, -3618.5134584479856, -3584.0998294734736, -2882.103684577751, -3614.726993655357, -3019.6659003628365, -3208.27371097238, -3421.8991588918752, -3385.1623078109133, -3274.402952424453, -2638.6915403280445, -4508.318530299833, -4182.307162173165, -3365.4129824022602, -3493.7520218119557, -4089.421899259627, -2888.53792747279, -3649.967717552835, -3166.6380386866003, -2815.711518643562, -3129.5384379290135, -3337.938865106283, -2628.6350079130284, -2959.373213533507, -3112.546384221172, -2464.4869576854, -2948.9382355203456, -3525.8682960523497, -3324.035172847588, -1842.3369625325415, -1491.7725418955033, -4529.436185251219, -3026.4958371172015, -2212.0858673444704, -3057.274392778759, -2146.528496305781, -2748.097845689581, -3151.870546637451, -4287.321211935206, -2782.778988479158, -3079.4908910493236, -2006.931920035052, -2387.955743798089, -2836.4247977740933, -3658.5055248076314, -2625.0360163025616, -1993.0069737509223, -3175.170197456961, -1816.2992356237319, -3186.091612215115, -2784.769072431932, -3950.4635212842563, -3281.1870639131575, -2391.8707842880267, -3654.4396011705976, -2409.34255238713, -3962.823512041068, -3336.4101309643884, -935.720660997476, -3093.1166602035287, -2282.6856209081875, -2731.6099568552527], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150], "policy_policy_0_reward": [-324.8232676360851, -414.4955076130441, -723.6274926360891, -209.16690301043067, -30.18684404767878, -772.6584022603115, -526.9618281745694, -714.5701593734709, -276.9950281974706, -269.6394118909334, -424.5552572513504, -441.7582833288485, -293.82127695148483, -585.8397404437172, -708.9989647147744, -548.2611797413127, -745.8301743175301, -483.61931236981496, -170.53660379607564, -1068.5682968133262, -1079.71608881737, -1180.1829467725427, -774.4298554649944, -222.7280602057984, -885.2763636967525, -872.0568686983977, -714.019911083208, -610.2773765932317, -1043.6026314566882, -386.494059445799, -358.2915143579623, -941.2007679572698, -802.7956044178997, -600.7313611535343, -526.3423712330837, -965.3104249134046, -482.5094403110411, -353.51716704214743, -810.2050980198035, -43.270551090936614, -1094.1811117302107, -241.05378948089614, -274.41188205571564, -501.89755758073335, -70.0949018379624, -968.4843080976685, -1029.185400817853, -1127.7711425266673, -444.14468009543396, -30.300389493513894, -678.7285177555586, -360.72803138938156, -912.7595202480293, -96.81446661552589, -479.4716121131435, -305.90053214270534, -797.4709471004563, -417.5210482515692, -1066.1304812630603, -235.01854232926368, -826.8216905472943, -332.1212359676156, -258.7549671794072, -1028.0914254787888, -230.0192286444386, -727.6504926745365, -272.09739134676204, -826.244550990939, -824.2769648434067, -1209.147777582918, -904.7253171415491, -456.72494464364735, -302.5984062174926, -696.2012244919063, -1179.0887808898187, -1119.7149016140322, -606.6544661480083, -583.8914914258618, -821.2988465665836, -86.91129492998382, -148.3928928981043, -752.5557497989276, -958.248109177847, -847.4647101070359, -238.92080008025422, -880.8133704197522, -199.84557631462187, -206.9838070036331, -870.6123099042261, -644.9724593283048, -593.3395740648097, -226.95945357838832, -1001.7204416778943, -307.0186509843478, -1131.9616219420589, -980.286972852491, -1079.997624213753, -480.1075108733392, -732.895983597084, -269.1458607924637, -516.8779664154855, -793.0824359610986, -348.2588844161095, -292.78380201884005, -22.834870783278735, -972.7406007722004, -14.348812118978364, -570.5478303103345, -974.2397490314831, -816.3472997340479, -643.2865094996089, -185.33362214236047, -404.65771717310656, -257.83023096303026, -188.42977958185207, -721.3236858082848, -1166.6370238733803, -464.8997349979705, -743.070107143728, -845.6584656600537, -802.1454888638546, -1039.7318401289342, -1063.2164243611126, -1065.880720603865, -739.2108528111859, -480.8481976111959, -250.17726339298963, -294.3251828196706, -997.4449744619295, -1098.955844766772, -978.679822948529, -796.8181319329923, -557.24270118035, -852.063352777491, -940.0582319537187, -120.03301545817627, -786.4316669265334, -811.9340302337242, -262.8290271435936, -104.17720043005312, -382.4978950583676, -891.999708920234, -1030.4402469717343, -484.9067327786596, -521.550245271901, -39.06366942640442, -776.148083950859, -142.9638970955316, -862.8401212381593, -961.7955227174442, -987.2535101722989, -97.13809624669487, -165.9124229006987, -906.6545862113333, -845.3821158299006, -131.86713739328326, -830.4176483035352, -435.677043798296, -944.347609481502, -1089.6456221885758, -350.37639788541384, -864.6653077651802, -630.1504350544625, -581.4744831549369, -363.01653890912434, -967.4861836539825, -316.95561145458373, -26.11102756469455, -94.98151572289798, -776.0160928523079, -158.2526838851648, -507.2893627656606, -692.0769089261173, -1205.02672014912, -872.6462253422912, -459.4429599279636, -716.7229092980277, -828.3376921784212, -531.5707342690756, -1070.791755704523, -831.1955664800093, -449.0843347467925, -526.7863764026537, -67.25110012676176, -773.437562384717, -395.90705775692453, -21.75190663675168, -149.3479811287953, -99.89982699899154, -981.7207589286509, -991.3029510607479, -1039.0128848521904, -778.4853967100702, -408.8393494977502, -501.2871352479154, -784.2519365257365, -421.5268692071121, -764.8545431485411, -1109.756395617393, -538.123713949203, -979.5719723499077, -952.4797229341785, -194.44030190813777, -541.80578965458, -915.8020426266647, -912.7209189390056, -597.3810174820795, -73.67379100315007, -747.7663866886093, -550.5615704649036, -735.3461073467264, -689.8017167261509, -541.7633247597912, -1232.3913682818009, -415.42447654088534, -935.5872548885338, -429.2642477423572, -845.2151555038214, -98.5615675919227, -711.037674636205, -887.016337017966, -168.37945017345922, -864.023349548641, -213.74390871428142, -1075.1106655180329, -100.51923458188737, -878.5493384997006, -754.1514119215589, -603.8628248977869, -1084.8163489909414, -686.5659468473892, -816.9435510445296, -793.5404355353738, -366.49378261818435, -721.6185917654369, -631.1690986946381, -23.01817989408135, -651.2530634136892, -1062.1661623248478, -906.7964480971984, -590.786947952441, -13.946135782840468, -393.7401770331436, -584.8331388828652, -1055.3851406767567, -713.7522915753462, -764.351617280194, -879.7670410543524, -919.3823506833605, -1231.065229706579, -634.8607605030049, -1075.9344414427112, -1150.2682747753104, -171.44118984079026, -1149.8024956113497, -1095.4810331869892, -395.55237297003157, -40.371904462407386, -881.8426510516849, -952.1650207311455, -709.4223924926148, -1042.73610552408, -1093.1542636830702, -73.78075075194398, -574.6585093602446, -529.3394986808419, -917.8653608701851, -765.9959250652657, -768.9814837415496, -1107.2396309017854, -375.3569052356876, -941.8641325849424, -794.1818466762595, -30.328978274933693, -746.8060647009687, -891.3438586864744, -841.8667821852396, -931.3857491873597, -202.5062497961413, -782.8650776976217, -405.2448001598618, -1011.70434592283, -795.1068490935439, -100.66270331602414, -853.919340194343, -124.80203019309134, -172.56141256578184, -1025.9379458307847, -934.3725640987888, -558.0375659551144, -989.5353054256584, -143.23861511777542, -941.6305282761933, -987.4058103500728, -67.72817875931605, -617.0793744611046, -756.2549166629894, -314.2143195807378, -1192.9515752303898, -457.438679171061, -521.6477244442814, -949.3634470575205, -33.83031389860285, -150.3398761660016, -973.4536463466226, -697.818555048689, -182.70162882006474, -766.678694450435, -946.2649412283158, -365.90939398600244, -454.08703707555406, -1123.3953389935843, -603.4413506393266, -431.3723427437748, -500.25031476893105, -31.354370248924333, -800.3716701062281, -422.39898473030905, -442.21544752122816, -768.1464850787116, -871.2912269772967, -143.47566734363767, -544.1571859627197, -748.3508343796374, -641.6633208570572, -570.8047441869404, -854.4993429550553, -542.6612240598777, -434.97592508528675, -1122.927059765195, -692.759966881941, -615.0836531467497, -161.8492690526627, -879.6942298941597, -974.6480538720745, -436.1319931927595, -73.39092493964799, -538.9064639314735, -121.82794193590736, -672.0796385327523, -69.96619051512366, -104.43099125049032, -22.256584763090927, -411.3123958486291, -883.8063795181674, -1035.722065525042, -584.4509271637957, -1040.446006321095, -987.7389060701227, -881.0782801711696, -1006.097716914956, -309.0437090620146, -454.9600185270188, -792.7337442948902, -463.66064831832597, -833.1060598348295, -26.816425775241708, -428.2268550002919, -25.70603938207648, -898.2304873520307, -351.409457760641, -477.98502035422825, -806.7133135993186, -1029.4134783943962, -391.75312267017284, -65.4854426118736, -956.5137113233513, -832.6483753414683, -172.8485259111226, -119.03244111796481, -173.5828552715274, -128.5290662462311, -933.7720019862417, -845.1619263662559, -667.0519958193255, -833.5604181931577, -518.6380441109449, -662.4409725370335, -372.94985257736016, -764.2812592189524, -773.0461018338078, -543.7688611497729, -1319.55548707976, -1057.1934708764798, -593.7572909953884, -234.00709805907223, -982.992088378967, -919.3832855549372, -102.86962896814545, -543.5268875180361, -864.5444660576078, -739.6460053974354, -361.26031975361366, -376.6809848313355, -737.3591150093271, -976.3825987265257, -269.61159673609967, -143.11065594483037, -517.5902836255381, -100.23678500205925, -141.22864615419917, -734.8448236357755, -610.9442450523354, -415.5734491911489, -485.36457976463095, -444.2123199447412, -12.568672812846504, -648.9880726906589, -861.0509665156668, -869.604765810178, -970.2669116919935, -1196.3310425800246, -705.7213837742088, -743.6948477989935, -42.491338962412385, -141.14024486275358, -953.8598631226739, -536.4639067531153, -878.1595000197335, -115.41250154428437, -178.9567693759023, -698.2517491345533, -96.9680758706769, -900.4927417797256, -118.33763759006365, -921.5133977784753, -395.06652177490014, -1044.094230888861, -420.27607064842346, -394.2199763663038, -204.3221292802244, -355.4135025553416, -42.54629973061206, -266.1154685574497, -947.9018355001033, -1016.6332154644236, -575.4627582989494, -240.98275487467362, -330.77960783778684, -1022.2332757392838, -941.4672242573827, -904.4702478897544, -24.692610062147406, -625.3374915160103, -288.801498706636, -966.2094685177333, -448.56768712373747, -855.0320925417093, -975.5543130247729, -705.0999600763037, -797.0803970441552, -539.5965553927189, -402.7333635421545, -676.5553417877853, -865.2214061463445, -442.5218713312995, -197.954511169604, -737.4344860372016, -83.61131708234888, -930.3485986675731, -880.9511464493191, -1118.1204383965442, -770.916578657054, -221.44887539733222, -663.002562270352, -880.5297860674942, -341.6486290357279, -40.161206913301704, -578.8560916772346, -568.1468386933733, -1136.7355329905276, -465.1572605063683, -884.1268408919256, -797.3466090222922, -679.4572686299548, -371.4652653152212, -894.3311864908239, -859.5313723398377, -693.1754718213547, -517.9068349971498, -121.67146384271463, -45.276877263697536, -336.3016722028601, -180.8322858277782, -251.63836186042593, -635.866328566458, -982.8436453876352, -62.54318201635127, -758.2662135135145, -653.5972907195704, -308.99073610471476, -1229.6504888020415, -24.618262185445285, -508.79231036838047, -210.63382344760623, -640.3306039694162, -191.91755527370097, -719.6610095971644, -533.9628263797616, -645.7379616352061]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6062300833350809, "mean_inference_ms": 1.7261804670135785, "mean_action_processing_ms": 0.9242311919018007, "mean_env_wait_ms": 10.727380916947377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01480412483215332, "StateBufferConnector_ms": 0.011316776275634766, "ViewRequirementAgentConnector_ms": 0.42557454109191895}, "num_episodes": 40, "episode_return_max": -935.720660997476, "episode_return_min": -4710.185326768949, "episode_return_mean": -3030.0213572203265, "episodes_this_iter": 40}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 278151, "num_agent_steps_trained": 278151, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 71.35585882518023, "num_env_steps_trained_throughput_per_sec": 71.35585882518023, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 278151, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 278151, "timers": {"training_iteration_time_ms": 57501.284, "restore_workers_time_ms": 0.029, "training_step_time_ms": 57501.208, "sample_time_ms": 3401.426, "learn_time_ms": 54039.075, "learn_throughput": 74.021, "synch_weights_time_ms": 57.352}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 278151, "num_agent_steps_trained": 278151}, "done": false, "training_iteration": 15, "trial_id": "efc54_00000", "date": "2024-07-24_18-54-34", "timestamp": 1721827474, "time_this_iter_s": 56.0696439743042, "time_total_s": 874.6225950717926, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7ac700>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 874.6225950717926, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 10.0, "ram_util_percent": 23.59999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 145.00493789441657, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 0.001, "total_loss": 5.169651364724397, "policy_loss": -0.0023680078710205765, "vf_loss": 5.186326123006416, "vf_explained_var": 0.9770802943022935, "kl": 0.015445379949121095, "entropy": 1.585129354189048, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.57342657342657, "num_grad_updates_lifetime": 67545.5, "diff_num_grad_updates_vs_sampler_policy": 2144.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 296394, "num_agent_steps_trained": 296394}, "env_runners": {"episode_reward_max": -935.720660997476, "episode_reward_min": -4846.208216805499, "episode_reward_mean": -3075.05777136477, "episode_len_mean": 149.63, "episode_media": {}, "episodes_timesteps_total": 14963, "policy_reward_min": {"policy_0": -1319.55548707976}, "policy_reward_max": {"policy_0": -12.568672812846504}, "policy_reward_mean": {"policy_0": -615.0115542729541}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1973.8379595948118, -3348.2242919670484, -1679.5378593599578, -3941.5890174834162, -4710.185326768949, -3121.751463052554, -4124.862240793079, -2085.404940192082, -3311.3948290008966, -2782.8112944283985, -3002.3407313609255, -3431.955061165192, -2789.683162769114, -2181.550431248467, -3435.2919010683568, -3606.866051378012, -2647.754940140935, -1648.6275314501133, -3718.927717368673, -3618.5134584479856, -3584.0998294734736, -2882.103684577751, -3614.726993655357, -3019.6659003628365, -3208.27371097238, -3421.8991588918752, -3385.1623078109133, -3274.402952424453, -2638.6915403280445, -4508.318530299833, -4182.307162173165, -3365.4129824022602, -3493.7520218119557, -4089.421899259627, -2888.53792747279, -3649.967717552835, -3166.6380386866003, -2815.711518643562, -3129.5384379290135, -3337.938865106283, -2628.6350079130284, -2959.373213533507, -3112.546384221172, -2464.4869576854, -2948.9382355203456, -3525.8682960523497, -3324.035172847588, -1842.3369625325415, -1491.7725418955033, -4529.436185251219, -3026.4958371172015, -2212.0858673444704, -3057.274392778759, -2146.528496305781, -2748.097845689581, -3151.870546637451, -4287.321211935206, -2782.778988479158, -3079.4908910493236, -2006.931920035052, -2387.955743798089, -2836.4247977740933, -3658.5055248076314, -2625.0360163025616, -1993.0069737509223, -3175.170197456961, -1816.2992356237319, -3186.091612215115, -2784.769072431932, -3950.4635212842563, -3281.1870639131575, -2391.8707842880267, -3654.4396011705976, -2409.34255238713, -3962.823512041068, -3336.4101309643884, -935.720660997476, -3093.1166602035287, -2282.6856209081875, -2731.6099568552527, -2663.27386522907, -2918.9529577135145, -2639.898801399898, -3514.596996364345, -3965.661494597543, -3159.822645237146, -1427.4698953457892, -2845.109730644484, -3206.3103451352454, -1581.8326582975633, -2732.1964088700097, -4846.208216805499, -4564.229214045824, -2996.6152315391764, -3178.2511163481813, -4176.081730342377, -4306.540429521647, -3837.2386815626683, -2844.8695831436958, -3463.701551460667], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-516.8779664154855, -793.0824359610986, -348.2588844161095, -292.78380201884005, -22.834870783278735, -972.7406007722004, -14.348812118978364, -570.5478303103345, -974.2397490314831, -816.3472997340479, -643.2865094996089, -185.33362214236047, -404.65771717310656, -257.83023096303026, -188.42977958185207, -721.3236858082848, -1166.6370238733803, -464.8997349979705, -743.070107143728, -845.6584656600537, -802.1454888638546, -1039.7318401289342, -1063.2164243611126, -1065.880720603865, -739.2108528111859, -480.8481976111959, -250.17726339298963, -294.3251828196706, -997.4449744619295, -1098.955844766772, -978.679822948529, -796.8181319329923, -557.24270118035, -852.063352777491, -940.0582319537187, -120.03301545817627, -786.4316669265334, -811.9340302337242, -262.8290271435936, -104.17720043005312, -382.4978950583676, -891.999708920234, -1030.4402469717343, -484.9067327786596, -521.550245271901, -39.06366942640442, -776.148083950859, -142.9638970955316, -862.8401212381593, -961.7955227174442, -987.2535101722989, -97.13809624669487, -165.9124229006987, -906.6545862113333, -845.3821158299006, -131.86713739328326, -830.4176483035352, -435.677043798296, -944.347609481502, -1089.6456221885758, -350.37639788541384, -864.6653077651802, -630.1504350544625, -581.4744831549369, -363.01653890912434, -967.4861836539825, -316.95561145458373, -26.11102756469455, -94.98151572289798, -776.0160928523079, -158.2526838851648, -507.2893627656606, -692.0769089261173, -1205.02672014912, -872.6462253422912, -459.4429599279636, -716.7229092980277, -828.3376921784212, -531.5707342690756, -1070.791755704523, -831.1955664800093, -449.0843347467925, -526.7863764026537, -67.25110012676176, -773.437562384717, -395.90705775692453, -21.75190663675168, -149.3479811287953, -99.89982699899154, -981.7207589286509, -991.3029510607479, -1039.0128848521904, -778.4853967100702, -408.8393494977502, -501.2871352479154, -784.2519365257365, -421.5268692071121, -764.8545431485411, -1109.756395617393, -538.123713949203, -979.5719723499077, -952.4797229341785, -194.44030190813777, -541.80578965458, -915.8020426266647, -912.7209189390056, -597.3810174820795, -73.67379100315007, -747.7663866886093, -550.5615704649036, -735.3461073467264, -689.8017167261509, -541.7633247597912, -1232.3913682818009, -415.42447654088534, -935.5872548885338, -429.2642477423572, -845.2151555038214, -98.5615675919227, -711.037674636205, -887.016337017966, -168.37945017345922, -864.023349548641, -213.74390871428142, -1075.1106655180329, -100.51923458188737, -878.5493384997006, -754.1514119215589, -603.8628248977869, -1084.8163489909414, -686.5659468473892, -816.9435510445296, -793.5404355353738, -366.49378261818435, -721.6185917654369, -631.1690986946381, -23.01817989408135, -651.2530634136892, -1062.1661623248478, -906.7964480971984, -590.786947952441, -13.946135782840468, -393.7401770331436, -584.8331388828652, -1055.3851406767567, -713.7522915753462, -764.351617280194, -879.7670410543524, -919.3823506833605, -1231.065229706579, -634.8607605030049, -1075.9344414427112, -1150.2682747753104, -171.44118984079026, -1149.8024956113497, -1095.4810331869892, -395.55237297003157, -40.371904462407386, -881.8426510516849, -952.1650207311455, -709.4223924926148, -1042.73610552408, -1093.1542636830702, -73.78075075194398, -574.6585093602446, -529.3394986808419, -917.8653608701851, -765.9959250652657, -768.9814837415496, -1107.2396309017854, -375.3569052356876, -941.8641325849424, -794.1818466762595, -30.328978274933693, -746.8060647009687, -891.3438586864744, -841.8667821852396, -931.3857491873597, -202.5062497961413, -782.8650776976217, -405.2448001598618, -1011.70434592283, -795.1068490935439, -100.66270331602414, -853.919340194343, -124.80203019309134, -172.56141256578184, -1025.9379458307847, -934.3725640987888, -558.0375659551144, -989.5353054256584, -143.23861511777542, -941.6305282761933, -987.4058103500728, -67.72817875931605, -617.0793744611046, -756.2549166629894, -314.2143195807378, -1192.9515752303898, -457.438679171061, -521.6477244442814, -949.3634470575205, -33.83031389860285, -150.3398761660016, -973.4536463466226, -697.818555048689, -182.70162882006474, -766.678694450435, -946.2649412283158, -365.90939398600244, -454.08703707555406, -1123.3953389935843, -603.4413506393266, -431.3723427437748, -500.25031476893105, -31.354370248924333, -800.3716701062281, -422.39898473030905, -442.21544752122816, -768.1464850787116, -871.2912269772967, -143.47566734363767, -544.1571859627197, -748.3508343796374, -641.6633208570572, -570.8047441869404, -854.4993429550553, -542.6612240598777, -434.97592508528675, -1122.927059765195, -692.759966881941, -615.0836531467497, -161.8492690526627, -879.6942298941597, -974.6480538720745, -436.1319931927595, -73.39092493964799, -538.9064639314735, -121.82794193590736, -672.0796385327523, -69.96619051512366, -104.43099125049032, -22.256584763090927, -411.3123958486291, -883.8063795181674, -1035.722065525042, -584.4509271637957, -1040.446006321095, -987.7389060701227, -881.0782801711696, -1006.097716914956, -309.0437090620146, -454.9600185270188, -792.7337442948902, -463.66064831832597, -833.1060598348295, -26.816425775241708, -428.2268550002919, -25.70603938207648, -898.2304873520307, -351.409457760641, -477.98502035422825, -806.7133135993186, -1029.4134783943962, -391.75312267017284, -65.4854426118736, -956.5137113233513, -832.6483753414683, -172.8485259111226, -119.03244111796481, -173.5828552715274, -128.5290662462311, -933.7720019862417, -845.1619263662559, -667.0519958193255, -833.5604181931577, -518.6380441109449, -662.4409725370335, -372.94985257736016, -764.2812592189524, -773.0461018338078, -543.7688611497729, -1319.55548707976, -1057.1934708764798, -593.7572909953884, -234.00709805907223, -982.992088378967, -919.3832855549372, -102.86962896814545, -543.5268875180361, -864.5444660576078, -739.6460053974354, -361.26031975361366, -376.6809848313355, -737.3591150093271, -976.3825987265257, -269.61159673609967, -143.11065594483037, -517.5902836255381, -100.23678500205925, -141.22864615419917, -734.8448236357755, -610.9442450523354, -415.5734491911489, -485.36457976463095, -444.2123199447412, -12.568672812846504, -648.9880726906589, -861.0509665156668, -869.604765810178, -970.2669116919935, -1196.3310425800246, -705.7213837742088, -743.6948477989935, -42.491338962412385, -141.14024486275358, -953.8598631226739, -536.4639067531153, -878.1595000197335, -115.41250154428437, -178.9567693759023, -698.2517491345533, -96.9680758706769, -900.4927417797256, -118.33763759006365, -921.5133977784753, -395.06652177490014, -1044.094230888861, -420.27607064842346, -394.2199763663038, -204.3221292802244, -355.4135025553416, -42.54629973061206, -266.1154685574497, -947.9018355001033, -1016.6332154644236, -575.4627582989494, -240.98275487467362, -330.77960783778684, -1022.2332757392838, -941.4672242573827, -904.4702478897544, -24.692610062147406, -625.3374915160103, -288.801498706636, -966.2094685177333, -448.56768712373747, -855.0320925417093, -975.5543130247729, -705.0999600763037, -797.0803970441552, -539.5965553927189, -402.7333635421545, -676.5553417877853, -865.2214061463445, -442.5218713312995, -197.954511169604, -737.4344860372016, -83.61131708234888, -930.3485986675731, -880.9511464493191, -1118.1204383965442, -770.916578657054, -221.44887539733222, -663.002562270352, -880.5297860674942, -341.6486290357279, -40.161206913301704, -578.8560916772346, -568.1468386933733, -1136.7355329905276, -465.1572605063683, -884.1268408919256, -797.3466090222922, -679.4572686299548, -371.4652653152212, -894.3311864908239, -859.5313723398377, -693.1754718213547, -517.9068349971498, -121.67146384271463, -45.276877263697536, -336.3016722028601, -180.8322858277782, -251.63836186042593, -635.866328566458, -982.8436453876352, -62.54318201635127, -758.2662135135145, -653.5972907195704, -308.99073610471476, -1229.6504888020415, -24.618262185445285, -508.79231036838047, -210.63382344760623, -640.3306039694162, -191.91755527370097, -719.6610095971644, -533.9628263797616, -645.7379616352061, -658.0786148859682, -233.06974959210845, -761.1624232590166, -261.9278520463614, -749.0352254456136, -113.63121658566813, -1079.2281669747233, -367.81861754208694, -417.47414404940434, -940.8008125616351, -821.0424972157368, -1123.0161605771925, -69.41868293154165, -562.3281593288015, -64.09330134662576, -160.4850913563096, -1047.2835759269383, -486.74099553639013, -1036.1154781052264, -783.9718554394835, -1148.3419498468872, -152.66429850590015, -867.6158493631896, -668.167744916034, -1128.8716519655306, -58.8509302541687, -902.5120193213411, -831.2098477769756, -590.6823737508452, -776.5674741338158, -344.3933401300606, -363.40620921974, -60.894184181245315, -641.1925751635976, -17.58358665114714, -712.8310315441219, -115.80144882419148, -587.6301736669944, -914.3547247089948, -514.4923519001791, -159.32612649075998, -1243.2481359277035, -1058.3969802586403, -597.3420771704263, -147.99702528771815, -884.3372012760201, -250.15630610581604, -364.68073682195654, -16.388379953875777, -66.27003413989571, -297.7492246570752, -655.2020562997634, -325.53772771529685, -382.3235964424067, -1071.383803755468, -909.3747842731595, -1056.5345246949332, -1082.2573013437739, -897.4681486525267, -900.573457841106, -786.1965347956, -1239.7216727978537, -842.2781713774665, -846.0586499725304, -849.9741851023765, -757.76420795637, -144.96828272993818, -670.8839673572232, -861.5589834846794, -561.4397900109636, -955.6125568327807, -60.58632213860071, -795.6914475340635, -943.984435395444, -422.37635444728903, -207.87442354972234, -969.06434393088, -1159.9652759180608, -637.6224440177268, -1201.555242925986, -934.1299470182288, -759.850481932906, -642.9826082559586, -1065.3816734835377, -904.1957188310128, -1001.9695316094045, -709.1090598490676, -890.8290177424566, -168.5944807906538, -1066.736591571086, -662.0555814897187, -773.367097066892, -701.7377264319342, -577.8440237476813, -129.86515440746848, -1020.5702492050266, -895.7655273448726, -592.4634843288262, -798.5719585625736, -156.33033201936743]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6041608293542304, "mean_inference_ms": 1.7249296628023685, "mean_action_processing_ms": 0.922596373472971, "mean_env_wait_ms": 10.700016536048961, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015329837799072266, "StateBufferConnector_ms": 0.011475801467895508, "ViewRequirementAgentConnector_ms": 0.43138813972473145}, "num_episodes": 20, "episode_return_max": -935.720660997476, "episode_return_min": -4846.208216805499, "episode_return_mean": -3075.05777136477, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296394, "num_agent_steps_trained": 296394, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 69.5663458100394, "num_env_steps_trained_throughput_per_sec": 69.5663458100394, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 296394, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 296394, "timers": {"training_iteration_time_ms": 57265.166, "restore_workers_time_ms": 0.029, "training_step_time_ms": 57265.092, "sample_time_ms": 3419.671, "learn_time_ms": 53786.741, "learn_throughput": 74.368, "synch_weights_time_ms": 55.411}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 296394, "num_agent_steps_trained": 296394}, "done": false, "training_iteration": 16, "trial_id": "efc54_00000", "date": "2024-07-24_18-55-32", "timestamp": 1721827532, "time_this_iter_s": 57.5099573135376, "time_total_s": 932.1325523853302, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d71fe20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 932.1325523853302, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 10.143902439024389, "ram_util_percent": 23.599999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 139.26698362670675, "cur_kl_coeff": 0.10000000000000003, "cur_lr": 0.0010000000000000005, "total_loss": 5.196377163385823, "policy_loss": -0.0004160319212506867, "vf_loss": 5.211915336966224, "vf_explained_var": 0.9688725483098459, "kl": 0.015414730939346226, "entropy": 1.6663615529554603, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.39416058394161, "num_grad_updates_lifetime": 71745.5, "diff_num_grad_updates_vs_sampler_policy": 2054.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 313847, "num_agent_steps_trained": 313847}, "env_runners": {"episode_reward_max": -935.720660997476, "episode_reward_min": -4846.208216805499, "episode_reward_mean": -3053.646395936341, "episode_len_mean": 149.63, "episode_media": {}, "episodes_timesteps_total": 14963, "policy_reward_min": {"policy_0": -1319.55548707976}, "policy_reward_max": {"policy_0": -12.568672812846504}, "policy_reward_mean": {"policy_0": -610.729279187268}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3584.0998294734736, -2882.103684577751, -3614.726993655357, -3019.6659003628365, -3208.27371097238, -3421.8991588918752, -3385.1623078109133, -3274.402952424453, -2638.6915403280445, -4508.318530299833, -4182.307162173165, -3365.4129824022602, -3493.7520218119557, -4089.421899259627, -2888.53792747279, -3649.967717552835, -3166.6380386866003, -2815.711518643562, -3129.5384379290135, -3337.938865106283, -2628.6350079130284, -2959.373213533507, -3112.546384221172, -2464.4869576854, -2948.9382355203456, -3525.8682960523497, -3324.035172847588, -1842.3369625325415, -1491.7725418955033, -4529.436185251219, -3026.4958371172015, -2212.0858673444704, -3057.274392778759, -2146.528496305781, -2748.097845689581, -3151.870546637451, -4287.321211935206, -2782.778988479158, -3079.4908910493236, -2006.931920035052, -2387.955743798089, -2836.4247977740933, -3658.5055248076314, -2625.0360163025616, -1993.0069737509223, -3175.170197456961, -1816.2992356237319, -3186.091612215115, -2784.769072431932, -3950.4635212842563, -3281.1870639131575, -2391.8707842880267, -3654.4396011705976, -2409.34255238713, -3962.823512041068, -3336.4101309643884, -935.720660997476, -3093.1166602035287, -2282.6856209081875, -2731.6099568552527, -2663.27386522907, -2918.9529577135145, -2639.898801399898, -3514.596996364345, -3965.661494597543, -3159.822645237146, -1427.4698953457892, -2845.109730644484, -3206.3103451352454, -1581.8326582975633, -2732.1964088700097, -4846.208216805499, -4564.229214045824, -2996.6152315391764, -3178.2511163481813, -4176.081730342377, -4306.540429521647, -3837.2386815626683, -2844.8695831436958, -3463.701551460667, -3301.2846340033216, -3864.2641735675493, -2584.961823731773, -2382.0347891179, -4349.938399643476, -2750.3051874124317, -2716.0927361227614, -3493.0436422595308, -2380.861272484186, -3006.0090964630845, -2352.7761647370776, -2965.283441427639, -2211.2054273062954, -3567.756098291513, -2188.2485681298226, -4106.041736345625, -2649.5316553074604, -2580.4903920898723, -2822.246518682697, -2747.596909071934], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-979.5719723499077, -952.4797229341785, -194.44030190813777, -541.80578965458, -915.8020426266647, -912.7209189390056, -597.3810174820795, -73.67379100315007, -747.7663866886093, -550.5615704649036, -735.3461073467264, -689.8017167261509, -541.7633247597912, -1232.3913682818009, -415.42447654088534, -935.5872548885338, -429.2642477423572, -845.2151555038214, -98.5615675919227, -711.037674636205, -887.016337017966, -168.37945017345922, -864.023349548641, -213.74390871428142, -1075.1106655180329, -100.51923458188737, -878.5493384997006, -754.1514119215589, -603.8628248977869, -1084.8163489909414, -686.5659468473892, -816.9435510445296, -793.5404355353738, -366.49378261818435, -721.6185917654369, -631.1690986946381, -23.01817989408135, -651.2530634136892, -1062.1661623248478, -906.7964480971984, -590.786947952441, -13.946135782840468, -393.7401770331436, -584.8331388828652, -1055.3851406767567, -713.7522915753462, -764.351617280194, -879.7670410543524, -919.3823506833605, -1231.065229706579, -634.8607605030049, -1075.9344414427112, -1150.2682747753104, -171.44118984079026, -1149.8024956113497, -1095.4810331869892, -395.55237297003157, -40.371904462407386, -881.8426510516849, -952.1650207311455, -709.4223924926148, -1042.73610552408, -1093.1542636830702, -73.78075075194398, -574.6585093602446, -529.3394986808419, -917.8653608701851, -765.9959250652657, -768.9814837415496, -1107.2396309017854, -375.3569052356876, -941.8641325849424, -794.1818466762595, -30.328978274933693, -746.8060647009687, -891.3438586864744, -841.8667821852396, -931.3857491873597, -202.5062497961413, -782.8650776976217, -405.2448001598618, -1011.70434592283, -795.1068490935439, -100.66270331602414, -853.919340194343, -124.80203019309134, -172.56141256578184, -1025.9379458307847, -934.3725640987888, -558.0375659551144, -989.5353054256584, -143.23861511777542, -941.6305282761933, -987.4058103500728, -67.72817875931605, -617.0793744611046, -756.2549166629894, -314.2143195807378, -1192.9515752303898, -457.438679171061, -521.6477244442814, -949.3634470575205, -33.83031389860285, -150.3398761660016, -973.4536463466226, -697.818555048689, -182.70162882006474, -766.678694450435, -946.2649412283158, -365.90939398600244, -454.08703707555406, -1123.3953389935843, -603.4413506393266, -431.3723427437748, -500.25031476893105, -31.354370248924333, -800.3716701062281, -422.39898473030905, -442.21544752122816, -768.1464850787116, -871.2912269772967, -143.47566734363767, -544.1571859627197, -748.3508343796374, -641.6633208570572, -570.8047441869404, -854.4993429550553, -542.6612240598777, -434.97592508528675, -1122.927059765195, -692.759966881941, -615.0836531467497, -161.8492690526627, -879.6942298941597, -974.6480538720745, -436.1319931927595, -73.39092493964799, -538.9064639314735, -121.82794193590736, -672.0796385327523, -69.96619051512366, -104.43099125049032, -22.256584763090927, -411.3123958486291, -883.8063795181674, -1035.722065525042, -584.4509271637957, -1040.446006321095, -987.7389060701227, -881.0782801711696, -1006.097716914956, -309.0437090620146, -454.9600185270188, -792.7337442948902, -463.66064831832597, -833.1060598348295, -26.816425775241708, -428.2268550002919, -25.70603938207648, -898.2304873520307, -351.409457760641, -477.98502035422825, -806.7133135993186, -1029.4134783943962, -391.75312267017284, -65.4854426118736, -956.5137113233513, -832.6483753414683, -172.8485259111226, -119.03244111796481, -173.5828552715274, -128.5290662462311, -933.7720019862417, -845.1619263662559, -667.0519958193255, -833.5604181931577, -518.6380441109449, -662.4409725370335, -372.94985257736016, -764.2812592189524, -773.0461018338078, -543.7688611497729, -1319.55548707976, -1057.1934708764798, -593.7572909953884, -234.00709805907223, -982.992088378967, -919.3832855549372, -102.86962896814545, -543.5268875180361, -864.5444660576078, -739.6460053974354, -361.26031975361366, -376.6809848313355, -737.3591150093271, -976.3825987265257, -269.61159673609967, -143.11065594483037, -517.5902836255381, -100.23678500205925, -141.22864615419917, -734.8448236357755, -610.9442450523354, -415.5734491911489, -485.36457976463095, -444.2123199447412, -12.568672812846504, -648.9880726906589, -861.0509665156668, -869.604765810178, -970.2669116919935, -1196.3310425800246, -705.7213837742088, -743.6948477989935, -42.491338962412385, -141.14024486275358, -953.8598631226739, -536.4639067531153, -878.1595000197335, -115.41250154428437, -178.9567693759023, -698.2517491345533, -96.9680758706769, -900.4927417797256, -118.33763759006365, -921.5133977784753, -395.06652177490014, -1044.094230888861, -420.27607064842346, -394.2199763663038, -204.3221292802244, -355.4135025553416, -42.54629973061206, -266.1154685574497, -947.9018355001033, -1016.6332154644236, -575.4627582989494, -240.98275487467362, -330.77960783778684, -1022.2332757392838, -941.4672242573827, -904.4702478897544, -24.692610062147406, -625.3374915160103, -288.801498706636, -966.2094685177333, -448.56768712373747, -855.0320925417093, -975.5543130247729, -705.0999600763037, -797.0803970441552, -539.5965553927189, -402.7333635421545, -676.5553417877853, -865.2214061463445, -442.5218713312995, -197.954511169604, -737.4344860372016, -83.61131708234888, -930.3485986675731, -880.9511464493191, -1118.1204383965442, -770.916578657054, -221.44887539733222, -663.002562270352, -880.5297860674942, -341.6486290357279, -40.161206913301704, -578.8560916772346, -568.1468386933733, -1136.7355329905276, -465.1572605063683, -884.1268408919256, -797.3466090222922, -679.4572686299548, -371.4652653152212, -894.3311864908239, -859.5313723398377, -693.1754718213547, -517.9068349971498, -121.67146384271463, -45.276877263697536, -336.3016722028601, -180.8322858277782, -251.63836186042593, -635.866328566458, -982.8436453876352, -62.54318201635127, -758.2662135135145, -653.5972907195704, -308.99073610471476, -1229.6504888020415, -24.618262185445285, -508.79231036838047, -210.63382344760623, -640.3306039694162, -191.91755527370097, -719.6610095971644, -533.9628263797616, -645.7379616352061, -658.0786148859682, -233.06974959210845, -761.1624232590166, -261.9278520463614, -749.0352254456136, -113.63121658566813, -1079.2281669747233, -367.81861754208694, -417.47414404940434, -940.8008125616351, -821.0424972157368, -1123.0161605771925, -69.41868293154165, -562.3281593288015, -64.09330134662576, -160.4850913563096, -1047.2835759269383, -486.74099553639013, -1036.1154781052264, -783.9718554394835, -1148.3419498468872, -152.66429850590015, -867.6158493631896, -668.167744916034, -1128.8716519655306, -58.8509302541687, -902.5120193213411, -831.2098477769756, -590.6823737508452, -776.5674741338158, -344.3933401300606, -363.40620921974, -60.894184181245315, -641.1925751635976, -17.58358665114714, -712.8310315441219, -115.80144882419148, -587.6301736669944, -914.3547247089948, -514.4923519001791, -159.32612649075998, -1243.2481359277035, -1058.3969802586403, -597.3420771704263, -147.99702528771815, -884.3372012760201, -250.15630610581604, -364.68073682195654, -16.388379953875777, -66.27003413989571, -297.7492246570752, -655.2020562997634, -325.53772771529685, -382.3235964424067, -1071.383803755468, -909.3747842731595, -1056.5345246949332, -1082.2573013437739, -897.4681486525267, -900.573457841106, -786.1965347956, -1239.7216727978537, -842.2781713774665, -846.0586499725304, -849.9741851023765, -757.76420795637, -144.96828272993818, -670.8839673572232, -861.5589834846794, -561.4397900109636, -955.6125568327807, -60.58632213860071, -795.6914475340635, -943.984435395444, -422.37635444728903, -207.87442354972234, -969.06434393088, -1159.9652759180608, -637.6224440177268, -1201.555242925986, -934.1299470182288, -759.850481932906, -642.9826082559586, -1065.3816734835377, -904.1957188310128, -1001.9695316094045, -709.1090598490676, -890.8290177424566, -168.5944807906538, -1066.736591571086, -662.0555814897187, -773.367097066892, -701.7377264319342, -577.8440237476813, -129.86515440746848, -1020.5702492050266, -895.7655273448726, -592.4634843288262, -798.5719585625736, -156.33033201936743, -908.2863627642757, -868.8588025985626, -488.928539857247, -40.05362420199641, -995.1573045812338, -589.1752320720572, -879.6700233086063, -519.5101578335536, -692.2922610848345, -1183.6164992684953, -312.89270939636106, -314.4443050448225, -347.3449700487248, -859.4945967316997, -750.7852425101622, -638.1394291893159, -58.05135565693283, -743.4548547015535, -700.3199225973091, -242.06922697278682, -925.6600332439193, -962.3705836777029, -683.2616920930694, -793.857028224748, -984.7890624040367, -716.9735933511818, -44.48551906405047, -846.6933758004193, -453.0876707513206, -689.0650284454621, -509.94003857322264, -317.6696056203003, -255.84547832657623, -887.8046029668564, -744.8330106358042, -752.7130441320962, -916.2002311961635, -772.6964769336355, -305.5192249971184, -745.9146650005223, -152.35005770081204, -1142.2391070105243, -461.9051079254138, -66.38503424171222, -557.9819656057259, -245.13536371109439, -416.5392485207027, -741.5573947465155, -849.7274552855934, -753.0496341991791, -256.60472143475323, -107.15144693442124, -447.46733874576097, -713.4367649139631, -828.115892708178, -633.7639817105578, -728.9062733628126, -70.72644590183594, -835.9477474566614, -695.9389929957728, -1233.168673413577, -118.69685770691116, -367.33415632864825, -435.57679031358543, -56.42894954357379, -884.9685884793847, -567.583980081327, -1006.3799081798478, -495.0611655513403, -613.7624559996094, -1024.7922067503262, -287.4263522739294, -168.20775893141968, -499.17440620984326, -208.64784396430323, -1088.7495146830272, -999.9133580450809, -609.8287094645365, -630.2428435918678, -777.3073105611179, -283.60637442831626, -89.11124903901967, -868.6082812004136, -670.041589346384, -738.1641612933244, -110.66297987777538, -621.9828349823191, -831.4665086009267, -774.2006809594149, -242.17738766943233, -592.6365779436036, -972.7700339439888, -497.8024570938724, -519.630939321661, -239.40651037957014, -76.71587731845405, -629.3574946022707, -761.4728482589081, -372.3851221978041, -907.6655666944952]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6018876873391628, "mean_inference_ms": 1.723888961997998, "mean_action_processing_ms": 0.9176898756527693, "mean_env_wait_ms": 10.683632081905717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015555381774902344, "StateBufferConnector_ms": 0.011621713638305664, "ViewRequirementAgentConnector_ms": 0.4359467029571533}, "num_episodes": 20, "episode_return_max": -935.720660997476, "episode_return_min": -4846.208216805499, "episode_return_mean": -3053.646395936341, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 313847, "num_agent_steps_trained": 313847, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 70.28049923688182, "num_env_steps_trained_throughput_per_sec": 70.28049923688182, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 313847, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 313847, "timers": {"training_iteration_time_ms": 56848.604, "restore_workers_time_ms": 0.028, "training_step_time_ms": 56848.533, "sample_time_ms": 3407.949, "learn_time_ms": 53383.39, "learn_throughput": 74.93, "synch_weights_time_ms": 54.053}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 313847, "num_agent_steps_trained": 313847}, "done": false, "training_iteration": 17, "trial_id": "efc54_00000", "date": "2024-07-24_18-56-29", "timestamp": 1721827589, "time_this_iter_s": 56.925835609436035, "time_total_s": 989.0583879947662, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7ad870>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 989.0583879947662, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 10.117283950617285, "ram_util_percent": 23.599999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 143.85145609929012, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 0.001, "total_loss": 5.286453280749021, "policy_loss": -0.003248085495570809, "vf_loss": 5.304873547798548, "vf_explained_var": 0.9703942047271418, "kl": 0.01788322769972715, "entropy": 1.6960504589380918, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23776223776224, "num_grad_updates_lifetime": 75945.5, "diff_num_grad_updates_vs_sampler_policy": 2144.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 332042, "num_agent_steps_trained": 332042}, "env_runners": {"episode_reward_max": -935.720660997476, "episode_reward_min": -4846.208216805499, "episode_reward_mean": -2978.816246420325, "episode_len_mean": 149.63, "episode_media": {}, "episodes_timesteps_total": 14963, "policy_reward_min": {"policy_0": -1459.345166252031}, "policy_reward_max": {"policy_0": -12.076636473864816}, "policy_reward_mean": {"policy_0": -595.7632492840648}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2387.955743798089, -2836.4247977740933, -3658.5055248076314, -2625.0360163025616, -1993.0069737509223, -3175.170197456961, -1816.2992356237319, -3186.091612215115, -2784.769072431932, -3950.4635212842563, -3281.1870639131575, -2391.8707842880267, -3654.4396011705976, -2409.34255238713, -3962.823512041068, -3336.4101309643884, -935.720660997476, -3093.1166602035287, -2282.6856209081875, -2731.6099568552527, -2663.27386522907, -2918.9529577135145, -2639.898801399898, -3514.596996364345, -3965.661494597543, -3159.822645237146, -1427.4698953457892, -2845.109730644484, -3206.3103451352454, -1581.8326582975633, -2732.1964088700097, -4846.208216805499, -4564.229214045824, -2996.6152315391764, -3178.2511163481813, -4176.081730342377, -4306.540429521647, -3837.2386815626683, -2844.8695831436958, -3463.701551460667, -3301.2846340033216, -3864.2641735675493, -2584.961823731773, -2382.0347891179, -4349.938399643476, -2750.3051874124317, -2716.0927361227614, -3493.0436422595308, -2380.861272484186, -3006.0090964630845, -2352.7761647370776, -2965.283441427639, -2211.2054273062954, -3567.756098291513, -2188.2485681298226, -4106.041736345625, -2649.5316553074604, -2580.4903920898723, -2822.246518682697, -2747.596909071934, -1490.343233243401, -3263.68301356819, -1709.0806340734089, -1632.577078706758, -2764.2293787953327, -2468.4163826673393, -2142.620538378924, -1982.6997628133292, -3443.747165141799, -2632.8143150954843, -3664.970424855613, -2712.631306097586, -3923.624193715883, -2361.777670241462, -1453.9639128674035, -2923.0067007692055, -3054.465238957307, -2713.1028599686842, -3211.1300587961105, -1762.0878631836329, -3732.3269807833885, -2371.907352508321, -3042.7733095016615, -3550.9301083226724, -3055.131401197477, -4267.430303599486, -3401.423828047915, -3381.7442386202097, -2720.669800670639, -3568.2617639857435, -2100.8377705466937, -3389.9735045570537, -3089.6751438688952, -2766.623676019817, -3286.406682823219, -3374.573403162093, -2978.9234206349984, -3667.455097771012, -4052.1300750345663, -4389.691589465339], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-141.22864615419917, -734.8448236357755, -610.9442450523354, -415.5734491911489, -485.36457976463095, -444.2123199447412, -12.568672812846504, -648.9880726906589, -861.0509665156668, -869.604765810178, -970.2669116919935, -1196.3310425800246, -705.7213837742088, -743.6948477989935, -42.491338962412385, -141.14024486275358, -953.8598631226739, -536.4639067531153, -878.1595000197335, -115.41250154428437, -178.9567693759023, -698.2517491345533, -96.9680758706769, -900.4927417797256, -118.33763759006365, -921.5133977784753, -395.06652177490014, -1044.094230888861, -420.27607064842346, -394.2199763663038, -204.3221292802244, -355.4135025553416, -42.54629973061206, -266.1154685574497, -947.9018355001033, -1016.6332154644236, -575.4627582989494, -240.98275487467362, -330.77960783778684, -1022.2332757392838, -941.4672242573827, -904.4702478897544, -24.692610062147406, -625.3374915160103, -288.801498706636, -966.2094685177333, -448.56768712373747, -855.0320925417093, -975.5543130247729, -705.0999600763037, -797.0803970441552, -539.5965553927189, -402.7333635421545, -676.5553417877853, -865.2214061463445, -442.5218713312995, -197.954511169604, -737.4344860372016, -83.61131708234888, -930.3485986675731, -880.9511464493191, -1118.1204383965442, -770.916578657054, -221.44887539733222, -663.002562270352, -880.5297860674942, -341.6486290357279, -40.161206913301704, -578.8560916772346, -568.1468386933733, -1136.7355329905276, -465.1572605063683, -884.1268408919256, -797.3466090222922, -679.4572686299548, -371.4652653152212, -894.3311864908239, -859.5313723398377, -693.1754718213547, -517.9068349971498, -121.67146384271463, -45.276877263697536, -336.3016722028601, -180.8322858277782, -251.63836186042593, -635.866328566458, -982.8436453876352, -62.54318201635127, -758.2662135135145, -653.5972907195704, -308.99073610471476, -1229.6504888020415, -24.618262185445285, -508.79231036838047, -210.63382344760623, -640.3306039694162, -191.91755527370097, -719.6610095971644, -533.9628263797616, -645.7379616352061, -658.0786148859682, -233.06974959210845, -761.1624232590166, -261.9278520463614, -749.0352254456136, -113.63121658566813, -1079.2281669747233, -367.81861754208694, -417.47414404940434, -940.8008125616351, -821.0424972157368, -1123.0161605771925, -69.41868293154165, -562.3281593288015, -64.09330134662576, -160.4850913563096, -1047.2835759269383, -486.74099553639013, -1036.1154781052264, -783.9718554394835, -1148.3419498468872, -152.66429850590015, -867.6158493631896, -668.167744916034, -1128.8716519655306, -58.8509302541687, -902.5120193213411, -831.2098477769756, -590.6823737508452, -776.5674741338158, -344.3933401300606, -363.40620921974, -60.894184181245315, -641.1925751635976, -17.58358665114714, -712.8310315441219, -115.80144882419148, -587.6301736669944, -914.3547247089948, -514.4923519001791, -159.32612649075998, -1243.2481359277035, -1058.3969802586403, -597.3420771704263, -147.99702528771815, -884.3372012760201, -250.15630610581604, -364.68073682195654, -16.388379953875777, -66.27003413989571, -297.7492246570752, -655.2020562997634, -325.53772771529685, -382.3235964424067, -1071.383803755468, -909.3747842731595, -1056.5345246949332, -1082.2573013437739, -897.4681486525267, -900.573457841106, -786.1965347956, -1239.7216727978537, -842.2781713774665, -846.0586499725304, -849.9741851023765, -757.76420795637, -144.96828272993818, -670.8839673572232, -861.5589834846794, -561.4397900109636, -955.6125568327807, -60.58632213860071, -795.6914475340635, -943.984435395444, -422.37635444728903, -207.87442354972234, -969.06434393088, -1159.9652759180608, -637.6224440177268, -1201.555242925986, -934.1299470182288, -759.850481932906, -642.9826082559586, -1065.3816734835377, -904.1957188310128, -1001.9695316094045, -709.1090598490676, -890.8290177424566, -168.5944807906538, -1066.736591571086, -662.0555814897187, -773.367097066892, -701.7377264319342, -577.8440237476813, -129.86515440746848, -1020.5702492050266, -895.7655273448726, -592.4634843288262, -798.5719585625736, -156.33033201936743, -908.2863627642757, -868.8588025985626, -488.928539857247, -40.05362420199641, -995.1573045812338, -589.1752320720572, -879.6700233086063, -519.5101578335536, -692.2922610848345, -1183.6164992684953, -312.89270939636106, -314.4443050448225, -347.3449700487248, -859.4945967316997, -750.7852425101622, -638.1394291893159, -58.05135565693283, -743.4548547015535, -700.3199225973091, -242.06922697278682, -925.6600332439193, -962.3705836777029, -683.2616920930694, -793.857028224748, -984.7890624040367, -716.9735933511818, -44.48551906405047, -846.6933758004193, -453.0876707513206, -689.0650284454621, -509.94003857322264, -317.6696056203003, -255.84547832657623, -887.8046029668564, -744.8330106358042, -752.7130441320962, -916.2002311961635, -772.6964769336355, -305.5192249971184, -745.9146650005223, -152.35005770081204, -1142.2391070105243, -461.9051079254138, -66.38503424171222, -557.9819656057259, -245.13536371109439, -416.5392485207027, -741.5573947465155, -849.7274552855934, -753.0496341991791, -256.60472143475323, -107.15144693442124, -447.46733874576097, -713.4367649139631, -828.115892708178, -633.7639817105578, -728.9062733628126, -70.72644590183594, -835.9477474566614, -695.9389929957728, -1233.168673413577, -118.69685770691116, -367.33415632864825, -435.57679031358543, -56.42894954357379, -884.9685884793847, -567.583980081327, -1006.3799081798478, -495.0611655513403, -613.7624559996094, -1024.7922067503262, -287.4263522739294, -168.20775893141968, -499.17440620984326, -208.64784396430323, -1088.7495146830272, -999.9133580450809, -609.8287094645365, -630.2428435918678, -777.3073105611179, -283.60637442831626, -89.11124903901967, -868.6082812004136, -670.041589346384, -738.1641612933244, -110.66297987777538, -621.9828349823191, -831.4665086009267, -774.2006809594149, -242.17738766943233, -592.6365779436036, -972.7700339439888, -497.8024570938724, -519.630939321661, -239.40651037957014, -76.71587731845405, -629.3574946022707, -761.4728482589081, -372.3851221978041, -907.6655666944952, -248.21877173799373, -209.17867492305368, -887.7889007153038, -65.23360238647525, -79.92328348057448, -94.8399938202569, -940.6848468395556, -684.7592929390352, -695.2214284247813, -848.1774515445636, -99.56874629025985, -385.09365029734204, -169.90588334689667, -727.1177301698064, -327.3946239691054, -33.94738093135071, -941.9019467930176, -33.04106668314312, -151.3838527492528, -472.3028315499933, -392.4596655788688, -1012.6187689559598, -441.0213062046571, -403.3118218368029, -514.8178162190437, -641.7499150290936, -646.4171094822951, -27.651133037214322, -807.3834820219054, -345.21474309683, -107.76013643498241, -94.80307740423494, -524.2090362176261, -391.81280497439934, -1024.0354833476797, -137.60081145105977, -192.72779595956786, -632.1509341665027, -483.830229770878, -536.3899914653219, -481.60059460234527, -155.43719359144765, -832.7487509448159, -673.973013363623, -1299.987612639569, -91.33357696715457, -660.5411314266452, -421.5799483385213, -757.6756017381527, -701.6840566250098, -1020.8676352745763, -949.3371465614823, -140.42210146265614, -792.6575850272644, -761.6859565296306, -210.12819676981033, -121.52844670489657, -735.081515637158, -681.2640389031708, -964.6291080825478, -867.1328206869564, -732.7010401028565, -462.3167883278424, -741.8071286530409, -1119.6664159451896, -161.43716044365664, -660.0176460393031, -301.78387137625214, -17.128588972011368, -1221.410403410242, -399.39936768270326, -47.61448500141186, -198.46948539815898, -655.258273145006, -153.22230164012396, -440.4394757634828, -668.579381596563, -196.4691730409138, -918.3568962718238, -699.1617740964264, -376.2858991214266, -1004.8247709722554, -127.07467391029624, -609.6817094773676, -936.5981854759613, -749.7618304556854, -450.61266362070273, -244.49791821247547, -821.9603531180306, -446.270094561792, -920.0172629359722, -535.1224746494656, -843.727592115524, -121.69880294967169, -790.5639261454759, -270.8841831838607, -860.7853528773901, -552.1549374584341, -12.076636473864816, -66.18675319008292, -875.6265675653045, -986.7246434762991, -952.4903012675549, -832.4708251307848, -85.01464334344453, -895.4046212261236, -607.4454327387101, -814.7181261770895, -34.06661500179466, -20.27255736460029, -498.77654787570646, -678.5051306817288, -973.4872561330632, -58.82141167812199, -833.1829631330407, -767.0240716239143, -903.2563963753296, -582.0168778738711, -1122.718262304971, -175.91450014458837, -46.102330703862926, -690.1560269596996, -771.4314883033327, -1238.358052752832, -309.0835024777506, -313.1344773236724, -1459.345166252031, -877.4001128542351, -790.6777557094113, -826.872791460135, -826.2309189981028, -847.290324969794, -367.9013169676145, -595.9889745672682, -764.0122925451371, -699.3831064376952, -525.5830655176704, -916.4508866285837, -936.4632521329182, -303.8639279033392, -17.91662823134219, -563.1592520495174, -943.707342355008, -954.0857092396785, -241.80086879509008, -24.710338484327522, -1115.1080820707105, -888.0946729150402, -850.551182707926, -689.7974878077398, -111.0297483831393, -828.8617424108921, -827.0748555745874, -301.77677225842126, -32.094651919653515, -186.88301499671786, -1029.932317566556, -1126.3388995872133, -587.8315695171217, -458.98770288944434, -184.87868802081658, -1027.5055605279986, -966.9181355286635, -14.720993614430272, -895.6517661769897, -411.72441775041597, -520.4352675814307, -838.5068646335384, -120.24127033918549, -875.7158557152474, -241.42801501501862, -424.46000326458676, -762.1209645627987, -865.1716215772183, -993.2260784035968, -1154.9334559824122, -634.9603847701907, -312.02396242447213, -444.2779942280937, -828.3776057569272, -599.5930502255019, -741.2822128874766, -594.0782593755829, -478.06527669523194, -565.9046214512073, -509.2653567440457, -926.2776453448046, -415.7227577043645, -943.528960518438, -872.6603774593613, -878.9508893206321, -1227.8227892637842, -798.4499472129168, -365.2691272863671, -781.6373219508655, -977.1952653905413, -526.7625401099491, -1251.3401167884372, -1142.2264352745556, -492.16723190185525]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5974926977773152, "mean_inference_ms": 1.7238568707235418, "mean_action_processing_ms": 0.9069861265923218, "mean_env_wait_ms": 10.671376861165982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015088319778442383, "StateBufferConnector_ms": 0.010950803756713867, "ViewRequirementAgentConnector_ms": 0.4057276248931885}, "num_episodes": 40, "episode_return_max": -935.720660997476, "episode_return_min": -4846.208216805499, "episode_return_mean": -2978.816246420325, "episodes_this_iter": 40}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 332042, "num_agent_steps_trained": 332042, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 67.36688996727706, "num_env_steps_trained_throughput_per_sec": 67.36688996727706, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 332042, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 332042, "timers": {"training_iteration_time_ms": 58086.765, "restore_workers_time_ms": 0.028, "training_step_time_ms": 58086.693, "sample_time_ms": 3399.414, "learn_time_ms": 54628.998, "learn_throughput": 73.221, "synch_weights_time_ms": 55.131}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 332042, "num_agent_steps_trained": 332042}, "done": false, "training_iteration": 18, "trial_id": "efc54_00000", "date": "2024-07-24_18-57-28", "timestamp": 1721827648, "time_this_iter_s": 59.389036655426025, "time_total_s": 1048.4474246501923, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7af9a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1048.4474246501923, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 9.939285714285715, "ram_util_percent": 23.599999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 138.4026803750786, "cur_kl_coeff": 0.1, "cur_lr": 0.0010000000000000005, "total_loss": 5.100013767958259, "policy_loss": -0.002342613478698176, "vf_loss": 5.1180691603562245, "vf_explained_var": 0.9799854517697716, "kl": 0.017518160433028424, "entropy": 1.746460281316039, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.53237410071942, "num_grad_updates_lifetime": 80175.5, "diff_num_grad_updates_vs_sampler_policy": 2084.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 349769, "num_agent_steps_trained": 349769}, "env_runners": {"episode_reward_max": -1427.4698953457892, "episode_reward_min": -4846.208216805499, "episode_reward_mean": -3019.48119774091, "episode_len_mean": 149.98, "episode_media": {}, "episodes_timesteps_total": 14998, "policy_reward_min": {"policy_0": -1459.345166252031}, "policy_reward_max": {"policy_0": 0.5440268829059814}, "policy_reward_mean": {"policy_0": -603.896239548182}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2663.27386522907, -2918.9529577135145, -2639.898801399898, -3514.596996364345, -3965.661494597543, -3159.822645237146, -1427.4698953457892, -2845.109730644484, -3206.3103451352454, -1581.8326582975633, -2732.1964088700097, -4846.208216805499, -4564.229214045824, -2996.6152315391764, -3178.2511163481813, -4176.081730342377, -4306.540429521647, -3837.2386815626683, -2844.8695831436958, -3463.701551460667, -3301.2846340033216, -3864.2641735675493, -2584.961823731773, -2382.0347891179, -4349.938399643476, -2750.3051874124317, -2716.0927361227614, -3493.0436422595308, -2380.861272484186, -3006.0090964630845, -2352.7761647370776, -2965.283441427639, -2211.2054273062954, -3567.756098291513, -2188.2485681298226, -4106.041736345625, -2649.5316553074604, -2580.4903920898723, -2822.246518682697, -2747.596909071934, -1490.343233243401, -3263.68301356819, -1709.0806340734089, -1632.577078706758, -2764.2293787953327, -2468.4163826673393, -2142.620538378924, -1982.6997628133292, -3443.747165141799, -2632.8143150954843, -3664.970424855613, -2712.631306097586, -3923.624193715883, -2361.777670241462, -1453.9639128674035, -2923.0067007692055, -3054.465238957307, -2713.1028599686842, -3211.1300587961105, -1762.0878631836329, -3732.3269807833885, -2371.907352508321, -3042.7733095016615, -3550.9301083226724, -3055.131401197477, -4267.430303599486, -3401.423828047915, -3381.7442386202097, -2720.669800670639, -3568.2617639857435, -2100.8377705466937, -3389.9735045570537, -3089.6751438688952, -2766.623676019817, -3286.406682823219, -3374.573403162093, -2978.9234206349984, -3667.455097771012, -4052.1300750345663, -4389.691589465339, -2550.6552544372576, -2856.5934912435664, -3436.474087940505, -3940.2803301224085, -1879.3885045044417, -4762.91629739723, -4030.1650029590282, -3724.145850472983, -3732.918280305035, -2605.6500715979923, -3229.3139317820987, -2989.6237537527586, -3360.1156736513803, -2135.6896839540495, -1457.3699885826657, -2728.942136644375, -2429.0409937505647, -2434.0886655182235, -2947.071517289903, -3328.9808553261814], "episode_lengths": [150, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-658.0786148859682, -233.06974959210845, -761.1624232590166, -261.9278520463614, -749.0352254456136, -113.63121658566813, -1079.2281669747233, -367.81861754208694, -417.47414404940434, -940.8008125616351, -821.0424972157368, -1123.0161605771925, -69.41868293154165, -562.3281593288015, -64.09330134662576, -160.4850913563096, -1047.2835759269383, -486.74099553639013, -1036.1154781052264, -783.9718554394835, -1148.3419498468872, -152.66429850590015, -867.6158493631896, -668.167744916034, -1128.8716519655306, -58.8509302541687, -902.5120193213411, -831.2098477769756, -590.6823737508452, -776.5674741338158, -344.3933401300606, -363.40620921974, -60.894184181245315, -641.1925751635976, -17.58358665114714, -712.8310315441219, -115.80144882419148, -587.6301736669944, -914.3547247089948, -514.4923519001791, -159.32612649075998, -1243.2481359277035, -1058.3969802586403, -597.3420771704263, -147.99702528771815, -884.3372012760201, -250.15630610581604, -364.68073682195654, -16.388379953875777, -66.27003413989571, -297.7492246570752, -655.2020562997634, -325.53772771529685, -382.3235964424067, -1071.383803755468, -909.3747842731595, -1056.5345246949332, -1082.2573013437739, -897.4681486525267, -900.573457841106, -786.1965347956, -1239.7216727978537, -842.2781713774665, -846.0586499725304, -849.9741851023765, -757.76420795637, -144.96828272993818, -670.8839673572232, -861.5589834846794, -561.4397900109636, -955.6125568327807, -60.58632213860071, -795.6914475340635, -943.984435395444, -422.37635444728903, -207.87442354972234, -969.06434393088, -1159.9652759180608, -637.6224440177268, -1201.555242925986, -934.1299470182288, -759.850481932906, -642.9826082559586, -1065.3816734835377, -904.1957188310128, -1001.9695316094045, -709.1090598490676, -890.8290177424566, -168.5944807906538, -1066.736591571086, -662.0555814897187, -773.367097066892, -701.7377264319342, -577.8440237476813, -129.86515440746848, -1020.5702492050266, -895.7655273448726, -592.4634843288262, -798.5719585625736, -156.33033201936743, -908.2863627642757, -868.8588025985626, -488.928539857247, -40.05362420199641, -995.1573045812338, -589.1752320720572, -879.6700233086063, -519.5101578335536, -692.2922610848345, -1183.6164992684953, -312.89270939636106, -314.4443050448225, -347.3449700487248, -859.4945967316997, -750.7852425101622, -638.1394291893159, -58.05135565693283, -743.4548547015535, -700.3199225973091, -242.06922697278682, -925.6600332439193, -962.3705836777029, -683.2616920930694, -793.857028224748, -984.7890624040367, -716.9735933511818, -44.48551906405047, -846.6933758004193, -453.0876707513206, -689.0650284454621, -509.94003857322264, -317.6696056203003, -255.84547832657623, -887.8046029668564, -744.8330106358042, -752.7130441320962, -916.2002311961635, -772.6964769336355, -305.5192249971184, -745.9146650005223, -152.35005770081204, -1142.2391070105243, -461.9051079254138, -66.38503424171222, -557.9819656057259, -245.13536371109439, -416.5392485207027, -741.5573947465155, -849.7274552855934, -753.0496341991791, -256.60472143475323, -107.15144693442124, -447.46733874576097, -713.4367649139631, -828.115892708178, -633.7639817105578, -728.9062733628126, -70.72644590183594, -835.9477474566614, -695.9389929957728, -1233.168673413577, -118.69685770691116, -367.33415632864825, -435.57679031358543, -56.42894954357379, -884.9685884793847, -567.583980081327, -1006.3799081798478, -495.0611655513403, -613.7624559996094, -1024.7922067503262, -287.4263522739294, -168.20775893141968, -499.17440620984326, -208.64784396430323, -1088.7495146830272, -999.9133580450809, -609.8287094645365, -630.2428435918678, -777.3073105611179, -283.60637442831626, -89.11124903901967, -868.6082812004136, -670.041589346384, -738.1641612933244, -110.66297987777538, -621.9828349823191, -831.4665086009267, -774.2006809594149, -242.17738766943233, -592.6365779436036, -972.7700339439888, -497.8024570938724, -519.630939321661, -239.40651037957014, -76.71587731845405, -629.3574946022707, -761.4728482589081, -372.3851221978041, -907.6655666944952, -248.21877173799373, -209.17867492305368, -887.7889007153038, -65.23360238647525, -79.92328348057448, -94.8399938202569, -940.6848468395556, -684.7592929390352, -695.2214284247813, -848.1774515445636, -99.56874629025985, -385.09365029734204, -169.90588334689667, -727.1177301698064, -327.3946239691054, -33.94738093135071, -941.9019467930176, -33.04106668314312, -151.3838527492528, -472.3028315499933, -392.4596655788688, -1012.6187689559598, -441.0213062046571, -403.3118218368029, -514.8178162190437, -641.7499150290936, -646.4171094822951, -27.651133037214322, -807.3834820219054, -345.21474309683, -107.76013643498241, -94.80307740423494, -524.2090362176261, -391.81280497439934, -1024.0354833476797, -137.60081145105977, -192.72779595956786, -632.1509341665027, -483.830229770878, -536.3899914653219, -481.60059460234527, -155.43719359144765, -832.7487509448159, -673.973013363623, -1299.987612639569, -91.33357696715457, -660.5411314266452, -421.5799483385213, -757.6756017381527, -701.6840566250098, -1020.8676352745763, -949.3371465614823, -140.42210146265614, -792.6575850272644, -761.6859565296306, -210.12819676981033, -121.52844670489657, -735.081515637158, -681.2640389031708, -964.6291080825478, -867.1328206869564, -732.7010401028565, -462.3167883278424, -741.8071286530409, -1119.6664159451896, -161.43716044365664, -660.0176460393031, -301.78387137625214, -17.128588972011368, -1221.410403410242, -399.39936768270326, -47.61448500141186, -198.46948539815898, -655.258273145006, -153.22230164012396, -440.4394757634828, -668.579381596563, -196.4691730409138, -918.3568962718238, -699.1617740964264, -376.2858991214266, -1004.8247709722554, -127.07467391029624, -609.6817094773676, -936.5981854759613, -749.7618304556854, -450.61266362070273, -244.49791821247547, -821.9603531180306, -446.270094561792, -920.0172629359722, -535.1224746494656, -843.727592115524, -121.69880294967169, -790.5639261454759, -270.8841831838607, -860.7853528773901, -552.1549374584341, -12.076636473864816, -66.18675319008292, -875.6265675653045, -986.7246434762991, -952.4903012675549, -832.4708251307848, -85.01464334344453, -895.4046212261236, -607.4454327387101, -814.7181261770895, -34.06661500179466, -20.27255736460029, -498.77654787570646, -678.5051306817288, -973.4872561330632, -58.82141167812199, -833.1829631330407, -767.0240716239143, -903.2563963753296, -582.0168778738711, -1122.718262304971, -175.91450014458837, -46.102330703862926, -690.1560269596996, -771.4314883033327, -1238.358052752832, -309.0835024777506, -313.1344773236724, -1459.345166252031, -877.4001128542351, -790.6777557094113, -826.872791460135, -826.2309189981028, -847.290324969794, -367.9013169676145, -595.9889745672682, -764.0122925451371, -699.3831064376952, -525.5830655176704, -916.4508866285837, -936.4632521329182, -303.8639279033392, -17.91662823134219, -563.1592520495174, -943.707342355008, -954.0857092396785, -241.80086879509008, -24.710338484327522, -1115.1080820707105, -888.0946729150402, -850.551182707926, -689.7974878077398, -111.0297483831393, -828.8617424108921, -827.0748555745874, -301.77677225842126, -32.094651919653515, -186.88301499671786, -1029.932317566556, -1126.3388995872133, -587.8315695171217, -458.98770288944434, -184.87868802081658, -1027.5055605279986, -966.9181355286635, -14.720993614430272, -895.6517661769897, -411.72441775041597, -520.4352675814307, -838.5068646335384, -120.24127033918549, -875.7158557152474, -241.42801501501862, -424.46000326458676, -762.1209645627987, -865.1716215772183, -993.2260784035968, -1154.9334559824122, -634.9603847701907, -312.02396242447213, -444.2779942280937, -828.3776057569272, -599.5930502255019, -741.2822128874766, -594.0782593755829, -478.06527669523194, -565.9046214512073, -509.2653567440457, -926.2776453448046, -415.7227577043645, -943.528960518438, -872.6603774593613, -878.9508893206321, -1227.8227892637842, -798.4499472129168, -365.2691272863671, -781.6373219508655, -977.1952653905413, -526.7625401099491, -1251.3401167884372, -1142.2264352745556, -492.16723190185525, -451.6803844363882, -150.83347188635872, -859.184110791249, -70.72755955307564, -1018.2297277701898, -391.6299857303895, -392.54070676221465, -394.52713816030183, -1237.5755566953005, -440.3201038953612, -509.01202046288313, -616.2912099828275, -1362.3912528401363, -75.261122179, -873.5184824756568, -924.69758028535, -994.1402799039081, -694.0782415853848, -516.6297236095787, -810.7345047381868, -111.87507593883173, -656.091665960895, -22.930583303714197, -711.8205384754287, -376.6706408255726, -928.1148957795137, -705.8238604490765, -1060.539428405163, -994.5198900034211, -1073.9182227600556, -847.130685415207, -270.7176507307474, -1130.649775231752, -772.4031561129419, -1009.2637354683812, -641.5845661440229, -1001.8155264530749, -782.5658745269992, -856.044433660561, -442.1354496883296, -383.03766787357597, -771.2744834852409, -1022.2871707233276, -1100.8107887849435, -455.5081694379493, -122.14279416918959, -375.10583596141424, -535.5590482359978, -390.320919851913, -1182.521473379478, -346.8832031985665, -315.5884990938304, -920.7615202459766, -728.9680355742281, -917.1126736694931, -41.23893451975429, -86.6751698422646, -990.0600873456974, -901.6521117773226, -969.9974502677185, -1059.8886037087082, -962.0465242463035, -504.4643920521811, -187.30730898687898, -646.4088446573105, -86.17836119685147, -84.65981199079343, -605.425541409161, -1035.5782900619174, -323.8476792953296, -148.32378922999268, -987.2755716550976, -293.5211516302879, 0.5440268829059814, -28.793502950192835, -107.53151109675498, -850.8893076444471, -882.4842010311462, -27.232812788894197, -860.8043040831326, -21.057619640123963, -773.6223351506223, -602.7478180097347, -795.8277428918544, -235.78547805822865, -112.08101772691896, -168.27103873579432, -652.7740579495872, -975.5075334926345, -525.4550176132885, -694.3670370205448, -387.60143493589584, -565.7288549635446, -742.1251284580864, -557.24906191183, -542.7055259003657, -420.4692439306744, -1023.6791819723101, -151.0823415149695, -1191.0445620078629]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5936222072087471, "mean_inference_ms": 1.720282575203999, "mean_action_processing_ms": 0.9049975303693146, "mean_env_wait_ms": 10.633734143717689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015421867370605469, "StateBufferConnector_ms": 0.011224508285522461, "ViewRequirementAgentConnector_ms": 0.41857290267944336}, "num_episodes": 20, "episode_return_max": -1427.4698953457892, "episode_return_min": -4846.208216805499, "episode_return_mean": -3019.48119774091, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 349769, "num_agent_steps_trained": 349769, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 69.13501152591117, "num_env_steps_trained_throughput_per_sec": 69.13501152591117, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 349769, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 349769, "timers": {"training_iteration_time_ms": 58153.276, "restore_workers_time_ms": 0.028, "training_step_time_ms": 58153.203, "sample_time_ms": 3412.28, "learn_time_ms": 54681.672, "learn_throughput": 73.151, "synch_weights_time_ms": 56.056}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 349769, "num_agent_steps_trained": 349769}, "done": false, "training_iteration": 19, "trial_id": "efc54_00000", "date": "2024-07-24_18-58-26", "timestamp": 1721827706, "time_this_iter_s": 57.871551513671875, "time_total_s": 1106.3189761638641, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7ac3a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1106.3189761638641, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 10.03048780487805, "ram_util_percent": 23.599999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 151.18045919502484, "cur_kl_coeff": 0.10000000000000003, "cur_lr": 0.0010000000000000005, "total_loss": 5.0490686209178435, "policy_loss": -0.002609523209656461, "vf_loss": 5.06707191455598, "vf_explained_var": 0.9809899833856844, "kl": 0.020404310653347968, "entropy": 1.7434199187101103, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.7720588235294, "num_grad_updates_lifetime": 84300.5, "diff_num_grad_updates_vs_sampler_policy": 2039.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 367146, "num_agent_steps_trained": 367146}, "env_runners": {"episode_reward_max": -1453.9639128674035, "episode_reward_min": -4762.91629739723, "episode_reward_mean": -2993.106606002317, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1459.345166252031}, "policy_reward_max": {"policy_0": 0.5440268829059814}, "policy_reward_mean": {"policy_0": -598.6213212004634}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3301.2846340033216, -3864.2641735675493, -2584.961823731773, -2382.0347891179, -4349.938399643476, -2750.3051874124317, -2716.0927361227614, -3493.0436422595308, -2380.861272484186, -3006.0090964630845, -2352.7761647370776, -2965.283441427639, -2211.2054273062954, -3567.756098291513, -2188.2485681298226, -4106.041736345625, -2649.5316553074604, -2580.4903920898723, -2822.246518682697, -2747.596909071934, -1490.343233243401, -3263.68301356819, -1709.0806340734089, -1632.577078706758, -2764.2293787953327, -2468.4163826673393, -2142.620538378924, -1982.6997628133292, -3443.747165141799, -2632.8143150954843, -3664.970424855613, -2712.631306097586, -3923.624193715883, -2361.777670241462, -1453.9639128674035, -2923.0067007692055, -3054.465238957307, -2713.1028599686842, -3211.1300587961105, -1762.0878631836329, -3732.3269807833885, -2371.907352508321, -3042.7733095016615, -3550.9301083226724, -3055.131401197477, -4267.430303599486, -3401.423828047915, -3381.7442386202097, -2720.669800670639, -3568.2617639857435, -2100.8377705466937, -3389.9735045570537, -3089.6751438688952, -2766.623676019817, -3286.406682823219, -3374.573403162093, -2978.9234206349984, -3667.455097771012, -4052.1300750345663, -4389.691589465339, -2550.6552544372576, -2856.5934912435664, -3436.474087940505, -3940.2803301224085, -1879.3885045044417, -4762.91629739723, -4030.1650029590282, -3724.145850472983, -3732.918280305035, -2605.6500715979923, -3229.3139317820987, -2989.6237537527586, -3360.1156736513803, -2135.6896839540495, -1457.3699885826657, -2728.942136644375, -2429.0409937505647, -2434.0886655182235, -2947.071517289903, -3328.9808553261814, -2444.4042677069456, -3616.539231307428, -1459.7301977780194, -2848.31805318824, -3909.499830093373, -3407.6832404052316, -2729.3757447906964, -3362.0670118430235, -3721.91309238295, -3129.6298680881714, -2116.6057230643787, -2381.545330868726, -3047.322323983527, -3355.5800076721134, -3685.5124850491443, -2793.272139883034, -3828.995675474207, -3952.3029649100777, -2495.1663596684293, -3945.9388315873766], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-908.2863627642757, -868.8588025985626, -488.928539857247, -40.05362420199641, -995.1573045812338, -589.1752320720572, -879.6700233086063, -519.5101578335536, -692.2922610848345, -1183.6164992684953, -312.89270939636106, -314.4443050448225, -347.3449700487248, -859.4945967316997, -750.7852425101622, -638.1394291893159, -58.05135565693283, -743.4548547015535, -700.3199225973091, -242.06922697278682, -925.6600332439193, -962.3705836777029, -683.2616920930694, -793.857028224748, -984.7890624040367, -716.9735933511818, -44.48551906405047, -846.6933758004193, -453.0876707513206, -689.0650284454621, -509.94003857322264, -317.6696056203003, -255.84547832657623, -887.8046029668564, -744.8330106358042, -752.7130441320962, -916.2002311961635, -772.6964769336355, -305.5192249971184, -745.9146650005223, -152.35005770081204, -1142.2391070105243, -461.9051079254138, -66.38503424171222, -557.9819656057259, -245.13536371109439, -416.5392485207027, -741.5573947465155, -849.7274552855934, -753.0496341991791, -256.60472143475323, -107.15144693442124, -447.46733874576097, -713.4367649139631, -828.115892708178, -633.7639817105578, -728.9062733628126, -70.72644590183594, -835.9477474566614, -695.9389929957728, -1233.168673413577, -118.69685770691116, -367.33415632864825, -435.57679031358543, -56.42894954357379, -884.9685884793847, -567.583980081327, -1006.3799081798478, -495.0611655513403, -613.7624559996094, -1024.7922067503262, -287.4263522739294, -168.20775893141968, -499.17440620984326, -208.64784396430323, -1088.7495146830272, -999.9133580450809, -609.8287094645365, -630.2428435918678, -777.3073105611179, -283.60637442831626, -89.11124903901967, -868.6082812004136, -670.041589346384, -738.1641612933244, -110.66297987777538, -621.9828349823191, -831.4665086009267, -774.2006809594149, -242.17738766943233, -592.6365779436036, -972.7700339439888, -497.8024570938724, -519.630939321661, -239.40651037957014, -76.71587731845405, -629.3574946022707, -761.4728482589081, -372.3851221978041, -907.6655666944952, -248.21877173799373, -209.17867492305368, -887.7889007153038, -65.23360238647525, -79.92328348057448, -94.8399938202569, -940.6848468395556, -684.7592929390352, -695.2214284247813, -848.1774515445636, -99.56874629025985, -385.09365029734204, -169.90588334689667, -727.1177301698064, -327.3946239691054, -33.94738093135071, -941.9019467930176, -33.04106668314312, -151.3838527492528, -472.3028315499933, -392.4596655788688, -1012.6187689559598, -441.0213062046571, -403.3118218368029, -514.8178162190437, -641.7499150290936, -646.4171094822951, -27.651133037214322, -807.3834820219054, -345.21474309683, -107.76013643498241, -94.80307740423494, -524.2090362176261, -391.81280497439934, -1024.0354833476797, -137.60081145105977, -192.72779595956786, -632.1509341665027, -483.830229770878, -536.3899914653219, -481.60059460234527, -155.43719359144765, -832.7487509448159, -673.973013363623, -1299.987612639569, -91.33357696715457, -660.5411314266452, -421.5799483385213, -757.6756017381527, -701.6840566250098, -1020.8676352745763, -949.3371465614823, -140.42210146265614, -792.6575850272644, -761.6859565296306, -210.12819676981033, -121.52844670489657, -735.081515637158, -681.2640389031708, -964.6291080825478, -867.1328206869564, -732.7010401028565, -462.3167883278424, -741.8071286530409, -1119.6664159451896, -161.43716044365664, -660.0176460393031, -301.78387137625214, -17.128588972011368, -1221.410403410242, -399.39936768270326, -47.61448500141186, -198.46948539815898, -655.258273145006, -153.22230164012396, -440.4394757634828, -668.579381596563, -196.4691730409138, -918.3568962718238, -699.1617740964264, -376.2858991214266, -1004.8247709722554, -127.07467391029624, -609.6817094773676, -936.5981854759613, -749.7618304556854, -450.61266362070273, -244.49791821247547, -821.9603531180306, -446.270094561792, -920.0172629359722, -535.1224746494656, -843.727592115524, -121.69880294967169, -790.5639261454759, -270.8841831838607, -860.7853528773901, -552.1549374584341, -12.076636473864816, -66.18675319008292, -875.6265675653045, -986.7246434762991, -952.4903012675549, -832.4708251307848, -85.01464334344453, -895.4046212261236, -607.4454327387101, -814.7181261770895, -34.06661500179466, -20.27255736460029, -498.77654787570646, -678.5051306817288, -973.4872561330632, -58.82141167812199, -833.1829631330407, -767.0240716239143, -903.2563963753296, -582.0168778738711, -1122.718262304971, -175.91450014458837, -46.102330703862926, -690.1560269596996, -771.4314883033327, -1238.358052752832, -309.0835024777506, -313.1344773236724, -1459.345166252031, -877.4001128542351, -790.6777557094113, -826.872791460135, -826.2309189981028, -847.290324969794, -367.9013169676145, -595.9889745672682, -764.0122925451371, -699.3831064376952, -525.5830655176704, -916.4508866285837, -936.4632521329182, -303.8639279033392, -17.91662823134219, -563.1592520495174, -943.707342355008, -954.0857092396785, -241.80086879509008, -24.710338484327522, -1115.1080820707105, -888.0946729150402, -850.551182707926, -689.7974878077398, -111.0297483831393, -828.8617424108921, -827.0748555745874, -301.77677225842126, -32.094651919653515, -186.88301499671786, -1029.932317566556, -1126.3388995872133, -587.8315695171217, -458.98770288944434, -184.87868802081658, -1027.5055605279986, -966.9181355286635, -14.720993614430272, -895.6517661769897, -411.72441775041597, -520.4352675814307, -838.5068646335384, -120.24127033918549, -875.7158557152474, -241.42801501501862, -424.46000326458676, -762.1209645627987, -865.1716215772183, -993.2260784035968, -1154.9334559824122, -634.9603847701907, -312.02396242447213, -444.2779942280937, -828.3776057569272, -599.5930502255019, -741.2822128874766, -594.0782593755829, -478.06527669523194, -565.9046214512073, -509.2653567440457, -926.2776453448046, -415.7227577043645, -943.528960518438, -872.6603774593613, -878.9508893206321, -1227.8227892637842, -798.4499472129168, -365.2691272863671, -781.6373219508655, -977.1952653905413, -526.7625401099491, -1251.3401167884372, -1142.2264352745556, -492.16723190185525, -451.6803844363882, -150.83347188635872, -859.184110791249, -70.72755955307564, -1018.2297277701898, -391.6299857303895, -392.54070676221465, -394.52713816030183, -1237.5755566953005, -440.3201038953612, -509.01202046288313, -616.2912099828275, -1362.3912528401363, -75.261122179, -873.5184824756568, -924.69758028535, -994.1402799039081, -694.0782415853848, -516.6297236095787, -810.7345047381868, -111.87507593883173, -656.091665960895, -22.930583303714197, -711.8205384754287, -376.6706408255726, -928.1148957795137, -705.8238604490765, -1060.539428405163, -994.5198900034211, -1073.9182227600556, -847.130685415207, -270.7176507307474, -1130.649775231752, -772.4031561129419, -1009.2637354683812, -641.5845661440229, -1001.8155264530749, -782.5658745269992, -856.044433660561, -442.1354496883296, -383.03766787357597, -771.2744834852409, -1022.2871707233276, -1100.8107887849435, -455.5081694379493, -122.14279416918959, -375.10583596141424, -535.5590482359978, -390.320919851913, -1182.521473379478, -346.8832031985665, -315.5884990938304, -920.7615202459766, -728.9680355742281, -917.1126736694931, -41.23893451975429, -86.6751698422646, -990.0600873456974, -901.6521117773226, -969.9974502677185, -1059.8886037087082, -962.0465242463035, -504.4643920521811, -187.30730898687898, -646.4088446573105, -86.17836119685147, -84.65981199079343, -605.425541409161, -1035.5782900619174, -323.8476792953296, -148.32378922999268, -987.2755716550976, -293.5211516302879, 0.5440268829059814, -28.793502950192835, -107.53151109675498, -850.8893076444471, -882.4842010311462, -27.232812788894197, -860.8043040831326, -21.057619640123963, -773.6223351506223, -602.7478180097347, -795.8277428918544, -235.78547805822865, -112.08101772691896, -168.27103873579432, -652.7740579495872, -975.5075334926345, -525.4550176132885, -694.3670370205448, -387.60143493589584, -565.7288549635446, -742.1251284580864, -557.24906191183, -542.7055259003657, -420.4692439306744, -1023.6791819723101, -151.0823415149695, -1191.0445620078629, -52.56203891484496, -795.6886175750308, -725.2387675451471, -642.1008548347098, -228.81398883721263, -567.9491311534359, -971.9315155155912, -1128.501443560192, -714.127547146322, -234.02959393188888, -271.8402505218787, -554.8021079956538, -59.784418864803925, -317.15719467507154, -256.14622572061177, -269.2576368301307, -790.838002911878, -964.4661782023225, -175.92675460082413, -647.8294806430833, -1140.3455408754344, -424.3464937478547, -935.9415557253712, -829.2000495357885, -579.6661902089277, -762.5627621434564, -824.0505645513604, -231.7151339955982, -783.0789729911985, -806.2758067236119, -602.6935001186296, -433.7203195449837, -883.1839372183007, -190.70403112719956, -619.073956781584, -302.83787634272693, -692.4732659444636, -742.3674420667598, -740.281728960006, -884.1066985290701, -585.8954985538409, -1166.647812928698, -415.3352830569182, -791.5286993735128, -762.5057984699788, -212.7585695424701, -1138.050066512062, -430.6663848402099, -390.89267809240545, -957.2621691010226, -237.95941977387622, -807.910961909643, -92.73149492708616, -192.08446064185287, -785.9193858119187, -445.62635022695713, -7.865231519281229, -1099.7846637036228, -141.2934138195504, -686.9756715993144, -120.83474607854967, -1285.892164808214, -669.3257889808283, -28.18222752410904, -943.0873965918236, -541.5001782605345, -445.73189999345027, -945.2135093613647, -809.679744811362, -613.4546752454014, -814.2172437107919, -278.3064494453752, -664.3390925816657, -1008.3491330375791, -920.3005662737311, -754.5891598722745, -1147.3335795808218, -495.9816979156125, -313.59931126203907, -81.76839125228781, -891.0483074556463, -578.8580983634498, -796.413431158597, -816.8086083131784, -745.8672301833367, -1060.0871941829535, -1143.6756456282353, -967.2680956488126, -109.36063722858543, -671.911392221492, -39.794700438271654, -903.4785791220842, -743.8427666436531, -93.46021472232574, -714.5900987420927, -494.0882654762601, -973.5457259682541, -1422.5361019123216, -486.72069999207764, -569.0480382384603]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5907064789838115, "mean_inference_ms": 1.7191533075581382, "mean_action_processing_ms": 0.9010310444268091, "mean_env_wait_ms": 10.616713732037057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01539921760559082, "StateBufferConnector_ms": 0.011395692825317383, "ViewRequirementAgentConnector_ms": 0.42430663108825684}, "num_episodes": 20, "episode_return_max": -1453.9639128674035, "episode_return_min": -4762.91629739723, "episode_return_mean": -2993.106606002317, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 367146, "num_agent_steps_trained": 367146, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 94.07929449501229, "num_env_steps_trained_throughput_per_sec": 94.07929449501229, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 367146, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 367146, "timers": {"training_iteration_time_ms": 56328.338, "restore_workers_time_ms": 0.028, "training_step_time_ms": 56328.264, "sample_time_ms": 3393.447, "learn_time_ms": 52877.516, "learn_throughput": 75.647, "synch_weights_time_ms": 54.156}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 367146, "num_agent_steps_trained": 367146}, "done": false, "training_iteration": 20, "trial_id": "efc54_00000", "date": "2024-07-24_18-59-09", "timestamp": 1721827749, "time_this_iter_s": 42.528414487838745, "time_total_s": 1148.8473906517029, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7ac790>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1148.8473906517029, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 11.261666666666667, "ram_util_percent": 23.59999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 142.52481208969564, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 5.148553246084382, "policy_loss": -0.003276491644290075, "vf_loss": 5.166392693098854, "vf_explained_var": 0.9725195080772334, "kl": 0.02073214771870898, "entropy": 1.7672771015295796, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.63970588235294, "num_grad_updates_lifetime": 88380.5, "diff_num_grad_updates_vs_sampler_policy": 2039.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 384505, "num_agent_steps_trained": 384505}, "env_runners": {"episode_reward_max": -1117.0047577672674, "episode_reward_min": -4762.91629739723, "episode_reward_mean": -2937.195928885243, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1459.345166252031}, "policy_reward_max": {"policy_0": 0.5440268829059814}, "policy_reward_mean": {"policy_0": -587.4391857770486}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3732.3269807833885, -2371.907352508321, -3042.7733095016615, -3550.9301083226724, -3055.131401197477, -4267.430303599486, -3401.423828047915, -3381.7442386202097, -2720.669800670639, -3568.2617639857435, -2100.8377705466937, -3389.9735045570537, -3089.6751438688952, -2766.623676019817, -3286.406682823219, -3374.573403162093, -2978.9234206349984, -3667.455097771012, -4052.1300750345663, -4389.691589465339, -2550.6552544372576, -2856.5934912435664, -3436.474087940505, -3940.2803301224085, -1879.3885045044417, -4762.91629739723, -4030.1650029590282, -3724.145850472983, -3732.918280305035, -2605.6500715979923, -3229.3139317820987, -2989.6237537527586, -3360.1156736513803, -2135.6896839540495, -1457.3699885826657, -2728.942136644375, -2429.0409937505647, -2434.0886655182235, -2947.071517289903, -3328.9808553261814, -2444.4042677069456, -3616.539231307428, -1459.7301977780194, -2848.31805318824, -3909.499830093373, -3407.6832404052316, -2729.3757447906964, -3362.0670118430235, -3721.91309238295, -3129.6298680881714, -2116.6057230643787, -2381.545330868726, -3047.322323983527, -3355.5800076721134, -3685.5124850491443, -2793.272139883034, -3828.995675474207, -3952.3029649100777, -2495.1663596684293, -3945.9388315873766, -1118.9546913418703, -3567.3242329082614, -3447.186424509443, -2600.4958400665646, -2475.0525577637814, -1840.8773621007083, -2917.5575860604336, -3693.8378263224895, -3572.0567209479923, -2624.3061009436806, -3704.1666268307554, -3016.6848898440653, -2373.4801543482495, -2937.79478465054, -2408.215102367289, -1774.0535320896893, -1688.8959733626962, -2651.3790727612054, -3092.837133143633, -2358.523343451893, -2081.641179007399, -2415.0083757244647, -3158.0934820308426, -2548.751925887327, -4170.725019213773, -3051.3989804663142, -1803.7044797634799, -1368.255921434682, -1186.604558199487, -2107.374984553593, -3625.008111272198, -1373.4761413886295, -3208.4217091640026, -3947.822427508922, -3179.770085674026, -3954.28613185881, -2295.476827283442, -1766.6813119154785, -1117.0047577672674, -2516.690320495964], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-875.6265675653045, -986.7246434762991, -952.4903012675549, -832.4708251307848, -85.01464334344453, -895.4046212261236, -607.4454327387101, -814.7181261770895, -34.06661500179466, -20.27255736460029, -498.77654787570646, -678.5051306817288, -973.4872561330632, -58.82141167812199, -833.1829631330407, -767.0240716239143, -903.2563963753296, -582.0168778738711, -1122.718262304971, -175.91450014458837, -46.102330703862926, -690.1560269596996, -771.4314883033327, -1238.358052752832, -309.0835024777506, -313.1344773236724, -1459.345166252031, -877.4001128542351, -790.6777557094113, -826.872791460135, -826.2309189981028, -847.290324969794, -367.9013169676145, -595.9889745672682, -764.0122925451371, -699.3831064376952, -525.5830655176704, -916.4508866285837, -936.4632521329182, -303.8639279033392, -17.91662823134219, -563.1592520495174, -943.707342355008, -954.0857092396785, -241.80086879509008, -24.710338484327522, -1115.1080820707105, -888.0946729150402, -850.551182707926, -689.7974878077398, -111.0297483831393, -828.8617424108921, -827.0748555745874, -301.77677225842126, -32.094651919653515, -186.88301499671786, -1029.932317566556, -1126.3388995872133, -587.8315695171217, -458.98770288944434, -184.87868802081658, -1027.5055605279986, -966.9181355286635, -14.720993614430272, -895.6517661769897, -411.72441775041597, -520.4352675814307, -838.5068646335384, -120.24127033918549, -875.7158557152474, -241.42801501501862, -424.46000326458676, -762.1209645627987, -865.1716215772183, -993.2260784035968, -1154.9334559824122, -634.9603847701907, -312.02396242447213, -444.2779942280937, -828.3776057569272, -599.5930502255019, -741.2822128874766, -594.0782593755829, -478.06527669523194, -565.9046214512073, -509.2653567440457, -926.2776453448046, -415.7227577043645, -943.528960518438, -872.6603774593613, -878.9508893206321, -1227.8227892637842, -798.4499472129168, -365.2691272863671, -781.6373219508655, -977.1952653905413, -526.7625401099491, -1251.3401167884372, -1142.2264352745556, -492.16723190185525, -451.6803844363882, -150.83347188635872, -859.184110791249, -70.72755955307564, -1018.2297277701898, -391.6299857303895, -392.54070676221465, -394.52713816030183, -1237.5755566953005, -440.3201038953612, -509.01202046288313, -616.2912099828275, -1362.3912528401363, -75.261122179, -873.5184824756568, -924.69758028535, -994.1402799039081, -694.0782415853848, -516.6297236095787, -810.7345047381868, -111.87507593883173, -656.091665960895, -22.930583303714197, -711.8205384754287, -376.6706408255726, -928.1148957795137, -705.8238604490765, -1060.539428405163, -994.5198900034211, -1073.9182227600556, -847.130685415207, -270.7176507307474, -1130.649775231752, -772.4031561129419, -1009.2637354683812, -641.5845661440229, -1001.8155264530749, -782.5658745269992, -856.044433660561, -442.1354496883296, -383.03766787357597, -771.2744834852409, -1022.2871707233276, -1100.8107887849435, -455.5081694379493, -122.14279416918959, -375.10583596141424, -535.5590482359978, -390.320919851913, -1182.521473379478, -346.8832031985665, -315.5884990938304, -920.7615202459766, -728.9680355742281, -917.1126736694931, -41.23893451975429, -86.6751698422646, -990.0600873456974, -901.6521117773226, -969.9974502677185, -1059.8886037087082, -962.0465242463035, -504.4643920521811, -187.30730898687898, -646.4088446573105, -86.17836119685147, -84.65981199079343, -605.425541409161, -1035.5782900619174, -323.8476792953296, -148.32378922999268, -987.2755716550976, -293.5211516302879, 0.5440268829059814, -28.793502950192835, -107.53151109675498, -850.8893076444471, -882.4842010311462, -27.232812788894197, -860.8043040831326, -21.057619640123963, -773.6223351506223, -602.7478180097347, -795.8277428918544, -235.78547805822865, -112.08101772691896, -168.27103873579432, -652.7740579495872, -975.5075334926345, -525.4550176132885, -694.3670370205448, -387.60143493589584, -565.7288549635446, -742.1251284580864, -557.24906191183, -542.7055259003657, -420.4692439306744, -1023.6791819723101, -151.0823415149695, -1191.0445620078629, -52.56203891484496, -795.6886175750308, -725.2387675451471, -642.1008548347098, -228.81398883721263, -567.9491311534359, -971.9315155155912, -1128.501443560192, -714.127547146322, -234.02959393188888, -271.8402505218787, -554.8021079956538, -59.784418864803925, -317.15719467507154, -256.14622572061177, -269.2576368301307, -790.838002911878, -964.4661782023225, -175.92675460082413, -647.8294806430833, -1140.3455408754344, -424.3464937478547, -935.9415557253712, -829.2000495357885, -579.6661902089277, -762.5627621434564, -824.0505645513604, -231.7151339955982, -783.0789729911985, -806.2758067236119, -602.6935001186296, -433.7203195449837, -883.1839372183007, -190.70403112719956, -619.073956781584, -302.83787634272693, -692.4732659444636, -742.3674420667598, -740.281728960006, -884.1066985290701, -585.8954985538409, -1166.647812928698, -415.3352830569182, -791.5286993735128, -762.5057984699788, -212.7585695424701, -1138.050066512062, -430.6663848402099, -390.89267809240545, -957.2621691010226, -237.95941977387622, -807.910961909643, -92.73149492708616, -192.08446064185287, -785.9193858119187, -445.62635022695713, -7.865231519281229, -1099.7846637036228, -141.2934138195504, -686.9756715993144, -120.83474607854967, -1285.892164808214, -669.3257889808283, -28.18222752410904, -943.0873965918236, -541.5001782605345, -445.73189999345027, -945.2135093613647, -809.679744811362, -613.4546752454014, -814.2172437107919, -278.3064494453752, -664.3390925816657, -1008.3491330375791, -920.3005662737311, -754.5891598722745, -1147.3335795808218, -495.9816979156125, -313.59931126203907, -81.76839125228781, -891.0483074556463, -578.8580983634498, -796.413431158597, -816.8086083131784, -745.8672301833367, -1060.0871941829535, -1143.6756456282353, -967.2680956488126, -109.36063722858543, -671.911392221492, -39.794700438271654, -903.4785791220842, -743.8427666436531, -93.46021472232574, -714.5900987420927, -494.0882654762601, -973.5457259682541, -1422.5361019123216, -486.72069999207764, -569.0480382384603, -182.2262021855834, -135.92288512769474, -701.3885333789207, -14.675283043589523, -84.74178760608113, -831.2173330278165, -393.79178631867654, -904.6813805593756, -457.29267647379544, -980.3410565286001, -1079.485298848516, -1032.1413604934696, -558.2762990203805, -314.49974863010027, -462.78371751697597, -863.5862673412518, -326.37235460305953, -253.78549461188766, -452.558840236201, -704.1928832741633, -822.8557064560214, -469.70755966303767, -181.01710824231918, -94.1797908509101, -907.2923925514947, -734.0567633539739, -736.273862492883, -25.498616010884387, -172.28278476131933, -172.76533548164855, -64.62466619364818, -246.6752006344929, -446.48541239726427, -1066.4634415668156, -1093.308865268215, -436.82301110377483, -1014.5883126533137, -788.4437331334843, -440.86973392060236, -1013.1130355113166, -1193.4764657192338, -359.75506905930774, -524.6725915633085, -914.0473769184234, -580.1052176877182, -1180.198161682483, -874.6240414098153, -185.3337048602117, -134.63571017219869, -249.51448281896913, -843.1944981714845, -469.3825105121921, -1131.5387872240378, -90.79553588187713, -1169.2552950411648, -869.387997360714, -678.0062029768536, -1032.3595030866966, -92.75907826293857, -344.1721081568647, -499.840748211545, -61.87517197979774, -658.0458117415998, -255.88349201417049, -897.8349304011358, -982.539700508546, -527.0619505749121, -147.31926962179185, -191.83631820607533, -1089.0375457392147, -768.4155754721199, -355.4846134626788, -471.21922412245397, -76.56253313360467, -736.5331561764282, -887.8756813391826, -31.59156564631455, -842.1757851501178, -10.816092794057438, -1.5944071600187715, -199.1804693831007, -159.86748741156822, -17.17941378396018, -193.26183204629424, -1119.406770737774, -605.8169983412076, -323.87306840814995, -987.4649808262903, -635.8725225611951, -98.35150262436092, -874.036803646461, -1231.146628177073, -21.68052490112225, -882.3646823067576, -83.60849411221979, -243.32358732476771, -310.9755724484619, -530.6194359909471, -1034.0690310741875, -239.53571661353016, -582.0743230516223, -258.15680581011736, -765.2558121281837, -348.7061410992539, -127.44809691822194, -393.447356728043, -271.7314153543231, -803.399234703586, -164.01797809748638, -782.4123908410243, -938.0087699798725, -977.9478287837995, -254.9177410385549, -859.7669417197184, -127.45220050889824, -330.1990481670232, -1037.662332462262, -871.3743624512078, -212.29963164214084, -97.21655116469677, -1233.5258427764666, -826.2384569900679, -321.72333137439176, -873.4921556446421, -915.7452324282037, -871.2641098235416, -785.5098054901705, -761.5388926510911, -309.53124137974953, -323.55493112176174, -759.4481185820893, -557.5313698667659, -97.8381090224161, -309.4475475317921, -79.43933476041533, -24.330563762066486, -930.1215393720094, -114.95267857571044, -95.7149249180126, -203.1362148068827, -159.15050880427276, -37.784856244934495, -61.46968604278981, -888.6071502227043, -39.59235688478542, -1198.1318747065795, -251.78811383101416, -519.2533284404994, -109.03337023086227, -29.1682973446391, -781.2751788509755, -709.1133923179005, -287.0675167997461, -989.596458672638, -857.9555646309376, -462.19550747163896, -514.7247101507306, -95.57630213779781, -193.9642687570329, -107.01535287142931, -1090.7290014397306, -219.2509266862893, -1029.0807930978283, -621.2888345821711, -248.0721533579804, -684.0674951039324, -750.7324981433061, -486.5530260278289, -953.1928642015046, -1073.2765440323492, -1361.2791118827806, -509.68718190393116, -771.5664500388039, -475.08428455312685, -62.15305729538276, -823.2123333952023, -812.1820177204662, -846.9958385367861, -758.9236894643506, -712.9722527420015, -737.1089961705052, -460.59339833476264, -116.67662945790349, -211.0998725241528, -769.9979307961162, -389.6485053903753, -128.05926197905524, -949.5840814134416, -68.8663896320949, -230.52307350051288, -280.64715669261585, -188.96613972910268, -470.8811809328469, -125.8297117282861, -50.68056868441639, -1139.7665363926396, -483.2463688409591, -295.51262666608307, -155.52628925497677, -442.63849934130747]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5882570216585483, "mean_inference_ms": 1.7213004217520784, "mean_action_processing_ms": 0.8931407342527823, "mean_env_wait_ms": 10.618047409211501, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014536857604980469, "StateBufferConnector_ms": 0.010606527328491211, "ViewRequirementAgentConnector_ms": 0.3872542381286621}, "num_episodes": 40, "episode_return_max": -1117.0047577672674, "episode_return_min": -4762.91629739723, "episode_return_mean": -2937.195928885243, "episodes_this_iter": 40}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384505, "num_agent_steps_trained": 384505, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 116.42142347280905, "num_env_steps_trained_throughput_per_sec": 116.42142347280905, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 384505, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384505, "timers": {"training_iteration_time_ms": 54027.353, "restore_workers_time_ms": 0.028, "training_step_time_ms": 54027.28, "sample_time_ms": 3372.48, "learn_time_ms": 50597.632, "learn_throughput": 79.055, "synch_weights_time_ms": 53.982}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 384505, "num_agent_steps_trained": 384505}, "done": false, "training_iteration": 21, "trial_id": "efc54_00000", "date": "2024-07-24_18-59-43", "timestamp": 1721827783, "time_this_iter_s": 34.37008571624756, "time_total_s": 1183.2174763679504, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7175140883a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1183.2174763679504, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 12.048979591836734, "ram_util_percent": 23.599999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 118.54879655959346, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.0010000000000000005, "total_loss": 5.433772885769075, "policy_loss": -0.00033617386293452965, "vf_loss": 5.448163109820611, "vf_explained_var": 0.9709802873565344, "kl": 0.013566113797612737, "entropy": 1.7106414059039594, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.7557251908397, "num_grad_updates_lifetime": 92385.5, "diff_num_grad_updates_vs_sampler_policy": 1964.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 401241, "num_agent_steps_trained": 401241}, "env_runners": {"episode_reward_max": -772.9306460642889, "episode_reward_min": -4762.91629739723, "episode_reward_mean": -2729.2275829894243, "episode_len_mean": 149.47, "episode_media": {}, "episodes_timesteps_total": 14947, "policy_reward_min": {"policy_0": -1422.5361019123216}, "policy_reward_max": {"policy_0": 5.379312047864783}, "policy_reward_mean": {"policy_0": -545.8455165978847}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2550.6552544372576, -2856.5934912435664, -3436.474087940505, -3940.2803301224085, -1879.3885045044417, -4762.91629739723, -4030.1650029590282, -3724.145850472983, -3732.918280305035, -2605.6500715979923, -3229.3139317820987, -2989.6237537527586, -3360.1156736513803, -2135.6896839540495, -1457.3699885826657, -2728.942136644375, -2429.0409937505647, -2434.0886655182235, -2947.071517289903, -3328.9808553261814, -2444.4042677069456, -3616.539231307428, -1459.7301977780194, -2848.31805318824, -3909.499830093373, -3407.6832404052316, -2729.3757447906964, -3362.0670118430235, -3721.91309238295, -3129.6298680881714, -2116.6057230643787, -2381.545330868726, -3047.322323983527, -3355.5800076721134, -3685.5124850491443, -2793.272139883034, -3828.995675474207, -3952.3029649100777, -2495.1663596684293, -3945.9388315873766, -1118.9546913418703, -3567.3242329082614, -3447.186424509443, -2600.4958400665646, -2475.0525577637814, -1840.8773621007083, -2917.5575860604336, -3693.8378263224895, -3572.0567209479923, -2624.3061009436806, -3704.1666268307554, -3016.6848898440653, -2373.4801543482495, -2937.79478465054, -2408.215102367289, -1774.0535320896893, -1688.8959733626962, -2651.3790727612054, -3092.837133143633, -2358.523343451893, -2081.641179007399, -2415.0083757244647, -3158.0934820308426, -2548.751925887327, -4170.725019213773, -3051.3989804663142, -1803.7044797634799, -1368.255921434682, -1186.604558199487, -2107.374984553593, -3625.008111272198, -1373.4761413886295, -3208.4217091640026, -3947.822427508922, -3179.770085674026, -3954.28613185881, -2295.476827283442, -1766.6813119154785, -1117.0047577672674, -2516.690320495964, -2261.323426519077, -2286.785407326357, -2808.517288132905, -2972.8432355907566, -2360.341085798478, -1986.4447784041722, -1203.6242964668716, -1994.0377198705903, -3290.095776477528, -1292.5581554531227, -2497.1379893249305, -772.9306460642889, -1928.0104471347688, -2563.5948679510957, -2146.207481088808, -3014.8002616803174, -3050.99219071951, -2869.4341477287585, -2881.070477029294, -1211.30518277761], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-451.6803844363882, -150.83347188635872, -859.184110791249, -70.72755955307564, -1018.2297277701898, -391.6299857303895, -392.54070676221465, -394.52713816030183, -1237.5755566953005, -440.3201038953612, -509.01202046288313, -616.2912099828275, -1362.3912528401363, -75.261122179, -873.5184824756568, -924.69758028535, -994.1402799039081, -694.0782415853848, -516.6297236095787, -810.7345047381868, -111.87507593883173, -656.091665960895, -22.930583303714197, -711.8205384754287, -376.6706408255726, -928.1148957795137, -705.8238604490765, -1060.539428405163, -994.5198900034211, -1073.9182227600556, -847.130685415207, -270.7176507307474, -1130.649775231752, -772.4031561129419, -1009.2637354683812, -641.5845661440229, -1001.8155264530749, -782.5658745269992, -856.044433660561, -442.1354496883296, -383.03766787357597, -771.2744834852409, -1022.2871707233276, -1100.8107887849435, -455.5081694379493, -122.14279416918959, -375.10583596141424, -535.5590482359978, -390.320919851913, -1182.521473379478, -346.8832031985665, -315.5884990938304, -920.7615202459766, -728.9680355742281, -917.1126736694931, -41.23893451975429, -86.6751698422646, -990.0600873456974, -901.6521117773226, -969.9974502677185, -1059.8886037087082, -962.0465242463035, -504.4643920521811, -187.30730898687898, -646.4088446573105, -86.17836119685147, -84.65981199079343, -605.425541409161, -1035.5782900619174, -323.8476792953296, -148.32378922999268, -987.2755716550976, -293.5211516302879, 0.5440268829059814, -28.793502950192835, -107.53151109675498, -850.8893076444471, -882.4842010311462, -27.232812788894197, -860.8043040831326, -21.057619640123963, -773.6223351506223, -602.7478180097347, -795.8277428918544, -235.78547805822865, -112.08101772691896, -168.27103873579432, -652.7740579495872, -975.5075334926345, -525.4550176132885, -694.3670370205448, -387.60143493589584, -565.7288549635446, -742.1251284580864, -557.24906191183, -542.7055259003657, -420.4692439306744, -1023.6791819723101, -151.0823415149695, -1191.0445620078629, -52.56203891484496, -795.6886175750308, -725.2387675451471, -642.1008548347098, -228.81398883721263, -567.9491311534359, -971.9315155155912, -1128.501443560192, -714.127547146322, -234.02959393188888, -271.8402505218787, -554.8021079956538, -59.784418864803925, -317.15719467507154, -256.14622572061177, -269.2576368301307, -790.838002911878, -964.4661782023225, -175.92675460082413, -647.8294806430833, -1140.3455408754344, -424.3464937478547, -935.9415557253712, -829.2000495357885, -579.6661902089277, -762.5627621434564, -824.0505645513604, -231.7151339955982, -783.0789729911985, -806.2758067236119, -602.6935001186296, -433.7203195449837, -883.1839372183007, -190.70403112719956, -619.073956781584, -302.83787634272693, -692.4732659444636, -742.3674420667598, -740.281728960006, -884.1066985290701, -585.8954985538409, -1166.647812928698, -415.3352830569182, -791.5286993735128, -762.5057984699788, -212.7585695424701, -1138.050066512062, -430.6663848402099, -390.89267809240545, -957.2621691010226, -237.95941977387622, -807.910961909643, -92.73149492708616, -192.08446064185287, -785.9193858119187, -445.62635022695713, -7.865231519281229, -1099.7846637036228, -141.2934138195504, -686.9756715993144, -120.83474607854967, -1285.892164808214, -669.3257889808283, -28.18222752410904, -943.0873965918236, -541.5001782605345, -445.73189999345027, -945.2135093613647, -809.679744811362, -613.4546752454014, -814.2172437107919, -278.3064494453752, -664.3390925816657, -1008.3491330375791, -920.3005662737311, -754.5891598722745, -1147.3335795808218, -495.9816979156125, -313.59931126203907, -81.76839125228781, -891.0483074556463, -578.8580983634498, -796.413431158597, -816.8086083131784, -745.8672301833367, -1060.0871941829535, -1143.6756456282353, -967.2680956488126, -109.36063722858543, -671.911392221492, -39.794700438271654, -903.4785791220842, -743.8427666436531, -93.46021472232574, -714.5900987420927, -494.0882654762601, -973.5457259682541, -1422.5361019123216, -486.72069999207764, -569.0480382384603, -182.2262021855834, -135.92288512769474, -701.3885333789207, -14.675283043589523, -84.74178760608113, -831.2173330278165, -393.79178631867654, -904.6813805593756, -457.29267647379544, -980.3410565286001, -1079.485298848516, -1032.1413604934696, -558.2762990203805, -314.49974863010027, -462.78371751697597, -863.5862673412518, -326.37235460305953, -253.78549461188766, -452.558840236201, -704.1928832741633, -822.8557064560214, -469.70755966303767, -181.01710824231918, -94.1797908509101, -907.2923925514947, -734.0567633539739, -736.273862492883, -25.498616010884387, -172.28278476131933, -172.76533548164855, -64.62466619364818, -246.6752006344929, -446.48541239726427, -1066.4634415668156, -1093.308865268215, -436.82301110377483, -1014.5883126533137, -788.4437331334843, -440.86973392060236, -1013.1130355113166, -1193.4764657192338, -359.75506905930774, -524.6725915633085, -914.0473769184234, -580.1052176877182, -1180.198161682483, -874.6240414098153, -185.3337048602117, -134.63571017219869, -249.51448281896913, -843.1944981714845, -469.3825105121921, -1131.5387872240378, -90.79553588187713, -1169.2552950411648, -869.387997360714, -678.0062029768536, -1032.3595030866966, -92.75907826293857, -344.1721081568647, -499.840748211545, -61.87517197979774, -658.0458117415998, -255.88349201417049, -897.8349304011358, -982.539700508546, -527.0619505749121, -147.31926962179185, -191.83631820607533, -1089.0375457392147, -768.4155754721199, -355.4846134626788, -471.21922412245397, -76.56253313360467, -736.5331561764282, -887.8756813391826, -31.59156564631455, -842.1757851501178, -10.816092794057438, -1.5944071600187715, -199.1804693831007, -159.86748741156822, -17.17941378396018, -193.26183204629424, -1119.406770737774, -605.8169983412076, -323.87306840814995, -987.4649808262903, -635.8725225611951, -98.35150262436092, -874.036803646461, -1231.146628177073, -21.68052490112225, -882.3646823067576, -83.60849411221979, -243.32358732476771, -310.9755724484619, -530.6194359909471, -1034.0690310741875, -239.53571661353016, -582.0743230516223, -258.15680581011736, -765.2558121281837, -348.7061410992539, -127.44809691822194, -393.447356728043, -271.7314153543231, -803.399234703586, -164.01797809748638, -782.4123908410243, -938.0087699798725, -977.9478287837995, -254.9177410385549, -859.7669417197184, -127.45220050889824, -330.1990481670232, -1037.662332462262, -871.3743624512078, -212.29963164214084, -97.21655116469677, -1233.5258427764666, -826.2384569900679, -321.72333137439176, -873.4921556446421, -915.7452324282037, -871.2641098235416, -785.5098054901705, -761.5388926510911, -309.53124137974953, -323.55493112176174, -759.4481185820893, -557.5313698667659, -97.8381090224161, -309.4475475317921, -79.43933476041533, -24.330563762066486, -930.1215393720094, -114.95267857571044, -95.7149249180126, -203.1362148068827, -159.15050880427276, -37.784856244934495, -61.46968604278981, -888.6071502227043, -39.59235688478542, -1198.1318747065795, -251.78811383101416, -519.2533284404994, -109.03337023086227, -29.1682973446391, -781.2751788509755, -709.1133923179005, -287.0675167997461, -989.596458672638, -857.9555646309376, -462.19550747163896, -514.7247101507306, -95.57630213779781, -193.9642687570329, -107.01535287142931, -1090.7290014397306, -219.2509266862893, -1029.0807930978283, -621.2888345821711, -248.0721533579804, -684.0674951039324, -750.7324981433061, -486.5530260278289, -953.1928642015046, -1073.2765440323492, -1361.2791118827806, -509.68718190393116, -771.5664500388039, -475.08428455312685, -62.15305729538276, -823.2123333952023, -812.1820177204662, -846.9958385367861, -758.9236894643506, -712.9722527420015, -737.1089961705052, -460.59339833476264, -116.67662945790349, -211.0998725241528, -769.9979307961162, -389.6485053903753, -128.05926197905524, -949.5840814134416, -68.8663896320949, -230.52307350051288, -280.64715669261585, -188.96613972910268, -470.8811809328469, -125.8297117282861, -50.68056868441639, -1139.7665363926396, -483.2463688409591, -295.51262666608307, -155.52628925497677, -442.63849934130747, -54.96835539619453, -194.8880632235772, -951.843953663807, -898.0130580853845, -161.609996150115, -119.80343848616785, -885.1980874683396, -746.7714516396218, -290.8725581597054, -244.1398715725225, -610.2297273645397, -341.1460513680077, -1012.5280556654959, -321.471927178303, -523.1415265565645, -451.38591965991725, -692.3603740270321, -751.052482815825, -39.611356646215995, -1038.4331024417638, -871.6843599100722, -594.0631145946727, -17.641163697356316, -405.7330345953591, -471.219413001016, -38.63777976401269, -42.15968424545377, -463.453880878325, -743.2111359701703, -698.9822975462107, -320.0611621636733, -770.3474971147892, -33.67843563221601, -70.1656772132163, -9.37152434297773, -1046.402432359364, -13.72484804168927, -396.85660564251845, -389.45977883043815, -147.59405499658098, -352.507390845349, -1022.3289315144932, -687.2269389879062, -912.4167948975976, -315.6157202321821, -503.1143314895276, -638.0225254052244, -105.10567581934637, -51.69493478688891, 5.379312047864783, -288.1484180412348, -197.10070026090327, -566.259295004641, -847.5760651842369, -598.0535108339134, -30.654702567658937, -398.02637247461945, -147.74575223465152, -142.93731079887687, -53.56650798848171, -132.68910833967598, -594.7516402994513, -535.2587695972619, -436.58009572540396, -228.73083317297497, -601.9768717628398, -92.51575258353255, -1035.4744281312794, -776.9101383984479, -56.717677074994675, -657.0937440131648, -836.0514897897732, -291.0678100339183, -318.6358810267456, -43.35855622520615, -699.7042337513644, -697.7629567360096, -476.9292472066644, -979.5417308332978, -160.86209315297964, -925.68671265733, -790.2757970980915, -864.0957502349801, -226.3112518566187, -244.62267887249027, -1057.624079961056, -590.3549205474443, -399.5385294716812, -403.2191484200529, -418.69746932852394, -583.9730307218621, -45.23422327913334, -1018.02446687407, -482.6395311963695, -751.1992249578574, -14.59666238674733, -156.00978278049172, -18.589926972294077, -556.4704905614055, -465.63832007666963]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.583584228350173, "mean_inference_ms": 1.7181409930184335, "mean_action_processing_ms": 0.890235310292737, "mean_env_wait_ms": 10.564416279505354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014107227325439453, "StateBufferConnector_ms": 0.010486125946044922, "ViewRequirementAgentConnector_ms": 0.37728285789489746}, "num_episodes": 20, "episode_return_max": -772.9306460642889, "episode_return_min": -4762.91629739723, "episode_return_mean": -2729.2275829894243, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 401241, "num_agent_steps_trained": 401241, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.07817974527828, "num_env_steps_trained_throughput_per_sec": 74.07817974527828, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 401241, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 401241, "timers": {"training_iteration_time_ms": 53450.759, "restore_workers_time_ms": 0.027, "training_step_time_ms": 53450.686, "sample_time_ms": 3377.83, "learn_time_ms": 50015.424, "learn_throughput": 79.975, "synch_weights_time_ms": 54.24}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 401241, "num_agent_steps_trained": 401241}, "done": false, "training_iteration": 22, "trial_id": "efc54_00000", "date": "2024-07-24_19-00-37", "timestamp": 1721827837, "time_this_iter_s": 54.00956392288208, "time_total_s": 1237.2270402908325, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7adbd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1237.2270402908325, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 9.93896103896104, "ram_util_percent": 23.59999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 148.95815967510907, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.0010000000000000005, "total_loss": 4.977604445494138, "policy_loss": -0.0037486702393895637, "vf_loss": 4.996164144308139, "vf_explained_var": 0.9802547061443329, "kl": 0.01466364333471761, "entropy": 1.8110348050716596, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.56923076923077, "num_grad_updates_lifetime": 96300.5, "diff_num_grad_updates_vs_sampler_policy": 1949.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 417825, "num_agent_steps_trained": 417825}, "env_runners": {"episode_reward_max": -772.9306460642889, "episode_reward_min": -4170.725019213773, "episode_reward_mean": -2675.508690330921, "episode_len_mean": 149.47, "episode_media": {}, "episodes_timesteps_total": 14947, "policy_reward_min": {"policy_0": -1422.5361019123216}, "policy_reward_max": {"policy_0": 5.379312047864783}, "policy_reward_mean": {"policy_0": -535.1017380661843}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3616.539231307428, -1459.7301977780194, -2848.31805318824, -3909.499830093373, -3407.6832404052316, -2729.3757447906964, -3362.0670118430235, -3721.91309238295, -3129.6298680881714, -2116.6057230643787, -2381.545330868726, -3047.322323983527, -3355.5800076721134, -3685.5124850491443, -2793.272139883034, -3828.995675474207, -3952.3029649100777, -2495.1663596684293, -3945.9388315873766, -1118.9546913418703, -3567.3242329082614, -3447.186424509443, -2600.4958400665646, -2475.0525577637814, -1840.8773621007083, -2917.5575860604336, -3693.8378263224895, -3572.0567209479923, -2624.3061009436806, -3704.1666268307554, -3016.6848898440653, -2373.4801543482495, -2937.79478465054, -2408.215102367289, -1774.0535320896893, -1688.8959733626962, -2651.3790727612054, -3092.837133143633, -2358.523343451893, -2081.641179007399, -2415.0083757244647, -3158.0934820308426, -2548.751925887327, -4170.725019213773, -3051.3989804663142, -1803.7044797634799, -1368.255921434682, -1186.604558199487, -2107.374984553593, -3625.008111272198, -1373.4761413886295, -3208.4217091640026, -3947.822427508922, -3179.770085674026, -3954.28613185881, -2295.476827283442, -1766.6813119154785, -1117.0047577672674, -2516.690320495964, -2261.323426519077, -2286.785407326357, -2808.517288132905, -2972.8432355907566, -2360.341085798478, -1986.4447784041722, -1203.6242964668716, -1994.0377198705903, -3290.095776477528, -1292.5581554531227, -2497.1379893249305, -772.9306460642889, -1928.0104471347688, -2563.5948679510957, -2146.207481088808, -3014.8002616803174, -3050.99219071951, -2869.4341477287585, -2881.070477029294, -1211.30518277761, -2923.4704952833777, -2758.469352974936, -3908.7728601853587, -2522.4163226678743, -2864.5308701413187, -2845.420028285473, -2981.571569481076, -3336.9721232507686, -2597.939462225537, -1426.1014641448423, -2946.9062716996864, -2790.132901314364, -3219.4368990322246, -2654.047788670256, -2654.554295082495, -1806.130724810589, -2645.0495290637778, -2825.5295909279257, -2632.119574053736, -3300.2007408804657, -1992.1665089133553], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-567.9491311534359, -971.9315155155912, -1128.501443560192, -714.127547146322, -234.02959393188888, -271.8402505218787, -554.8021079956538, -59.784418864803925, -317.15719467507154, -256.14622572061177, -269.2576368301307, -790.838002911878, -964.4661782023225, -175.92675460082413, -647.8294806430833, -1140.3455408754344, -424.3464937478547, -935.9415557253712, -829.2000495357885, -579.6661902089277, -762.5627621434564, -824.0505645513604, -231.7151339955982, -783.0789729911985, -806.2758067236119, -602.6935001186296, -433.7203195449837, -883.1839372183007, -190.70403112719956, -619.073956781584, -302.83787634272693, -692.4732659444636, -742.3674420667598, -740.281728960006, -884.1066985290701, -585.8954985538409, -1166.647812928698, -415.3352830569182, -791.5286993735128, -762.5057984699788, -212.7585695424701, -1138.050066512062, -430.6663848402099, -390.89267809240545, -957.2621691010226, -237.95941977387622, -807.910961909643, -92.73149492708616, -192.08446064185287, -785.9193858119187, -445.62635022695713, -7.865231519281229, -1099.7846637036228, -141.2934138195504, -686.9756715993144, -120.83474607854967, -1285.892164808214, -669.3257889808283, -28.18222752410904, -943.0873965918236, -541.5001782605345, -445.73189999345027, -945.2135093613647, -809.679744811362, -613.4546752454014, -814.2172437107919, -278.3064494453752, -664.3390925816657, -1008.3491330375791, -920.3005662737311, -754.5891598722745, -1147.3335795808218, -495.9816979156125, -313.59931126203907, -81.76839125228781, -891.0483074556463, -578.8580983634498, -796.413431158597, -816.8086083131784, -745.8672301833367, -1060.0871941829535, -1143.6756456282353, -967.2680956488126, -109.36063722858543, -671.911392221492, -39.794700438271654, -903.4785791220842, -743.8427666436531, -93.46021472232574, -714.5900987420927, -494.0882654762601, -973.5457259682541, -1422.5361019123216, -486.72069999207764, -569.0480382384603, -182.2262021855834, -135.92288512769474, -701.3885333789207, -14.675283043589523, -84.74178760608113, -831.2173330278165, -393.79178631867654, -904.6813805593756, -457.29267647379544, -980.3410565286001, -1079.485298848516, -1032.1413604934696, -558.2762990203805, -314.49974863010027, -462.78371751697597, -863.5862673412518, -326.37235460305953, -253.78549461188766, -452.558840236201, -704.1928832741633, -822.8557064560214, -469.70755966303767, -181.01710824231918, -94.1797908509101, -907.2923925514947, -734.0567633539739, -736.273862492883, -25.498616010884387, -172.28278476131933, -172.76533548164855, -64.62466619364818, -246.6752006344929, -446.48541239726427, -1066.4634415668156, -1093.308865268215, -436.82301110377483, -1014.5883126533137, -788.4437331334843, -440.86973392060236, -1013.1130355113166, -1193.4764657192338, -359.75506905930774, -524.6725915633085, -914.0473769184234, -580.1052176877182, -1180.198161682483, -874.6240414098153, -185.3337048602117, -134.63571017219869, -249.51448281896913, -843.1944981714845, -469.3825105121921, -1131.5387872240378, -90.79553588187713, -1169.2552950411648, -869.387997360714, -678.0062029768536, -1032.3595030866966, -92.75907826293857, -344.1721081568647, -499.840748211545, -61.87517197979774, -658.0458117415998, -255.88349201417049, -897.8349304011358, -982.539700508546, -527.0619505749121, -147.31926962179185, -191.83631820607533, -1089.0375457392147, -768.4155754721199, -355.4846134626788, -471.21922412245397, -76.56253313360467, -736.5331561764282, -887.8756813391826, -31.59156564631455, -842.1757851501178, -10.816092794057438, -1.5944071600187715, -199.1804693831007, -159.86748741156822, -17.17941378396018, -193.26183204629424, -1119.406770737774, -605.8169983412076, -323.87306840814995, -987.4649808262903, -635.8725225611951, -98.35150262436092, -874.036803646461, -1231.146628177073, -21.68052490112225, -882.3646823067576, -83.60849411221979, -243.32358732476771, -310.9755724484619, -530.6194359909471, -1034.0690310741875, -239.53571661353016, -582.0743230516223, -258.15680581011736, -765.2558121281837, -348.7061410992539, -127.44809691822194, -393.447356728043, -271.7314153543231, -803.399234703586, -164.01797809748638, -782.4123908410243, -938.0087699798725, -977.9478287837995, -254.9177410385549, -859.7669417197184, -127.45220050889824, -330.1990481670232, -1037.662332462262, -871.3743624512078, -212.29963164214084, -97.21655116469677, -1233.5258427764666, -826.2384569900679, -321.72333137439176, -873.4921556446421, -915.7452324282037, -871.2641098235416, -785.5098054901705, -761.5388926510911, -309.53124137974953, -323.55493112176174, -759.4481185820893, -557.5313698667659, -97.8381090224161, -309.4475475317921, -79.43933476041533, -24.330563762066486, -930.1215393720094, -114.95267857571044, -95.7149249180126, -203.1362148068827, -159.15050880427276, -37.784856244934495, -61.46968604278981, -888.6071502227043, -39.59235688478542, -1198.1318747065795, -251.78811383101416, -519.2533284404994, -109.03337023086227, -29.1682973446391, -781.2751788509755, -709.1133923179005, -287.0675167997461, -989.596458672638, -857.9555646309376, -462.19550747163896, -514.7247101507306, -95.57630213779781, -193.9642687570329, -107.01535287142931, -1090.7290014397306, -219.2509266862893, -1029.0807930978283, -621.2888345821711, -248.0721533579804, -684.0674951039324, -750.7324981433061, -486.5530260278289, -953.1928642015046, -1073.2765440323492, -1361.2791118827806, -509.68718190393116, -771.5664500388039, -475.08428455312685, -62.15305729538276, -823.2123333952023, -812.1820177204662, -846.9958385367861, -758.9236894643506, -712.9722527420015, -737.1089961705052, -460.59339833476264, -116.67662945790349, -211.0998725241528, -769.9979307961162, -389.6485053903753, -128.05926197905524, -949.5840814134416, -68.8663896320949, -230.52307350051288, -280.64715669261585, -188.96613972910268, -470.8811809328469, -125.8297117282861, -50.68056868441639, -1139.7665363926396, -483.2463688409591, -295.51262666608307, -155.52628925497677, -442.63849934130747, -54.96835539619453, -194.8880632235772, -951.843953663807, -898.0130580853845, -161.609996150115, -119.80343848616785, -885.1980874683396, -746.7714516396218, -290.8725581597054, -244.1398715725225, -610.2297273645397, -341.1460513680077, -1012.5280556654959, -321.471927178303, -523.1415265565645, -451.38591965991725, -692.3603740270321, -751.052482815825, -39.611356646215995, -1038.4331024417638, -871.6843599100722, -594.0631145946727, -17.641163697356316, -405.7330345953591, -471.219413001016, -38.63777976401269, -42.15968424545377, -463.453880878325, -743.2111359701703, -698.9822975462107, -320.0611621636733, -770.3474971147892, -33.67843563221601, -70.1656772132163, -9.37152434297773, -1046.402432359364, -13.72484804168927, -396.85660564251845, -389.45977883043815, -147.59405499658098, -352.507390845349, -1022.3289315144932, -687.2269389879062, -912.4167948975976, -315.6157202321821, -503.1143314895276, -638.0225254052244, -105.10567581934637, -51.69493478688891, 5.379312047864783, -288.1484180412348, -197.10070026090327, -566.259295004641, -847.5760651842369, -598.0535108339134, -30.654702567658937, -398.02637247461945, -147.74575223465152, -142.93731079887687, -53.56650798848171, -132.68910833967598, -594.7516402994513, -535.2587695972619, -436.58009572540396, -228.73083317297497, -601.9768717628398, -92.51575258353255, -1035.4744281312794, -776.9101383984479, -56.717677074994675, -657.0937440131648, -836.0514897897732, -291.0678100339183, -318.6358810267456, -43.35855622520615, -699.7042337513644, -697.7629567360096, -476.9292472066644, -979.5417308332978, -160.86209315297964, -925.68671265733, -790.2757970980915, -864.0957502349801, -226.3112518566187, -244.62267887249027, -1057.624079961056, -590.3549205474443, -399.5385294716812, -403.2191484200529, -418.69746932852394, -583.9730307218621, -45.23422327913334, -1018.02446687407, -482.6395311963695, -751.1992249578574, -14.59666238674733, -156.00978278049172, -18.589926972294077, -556.4704905614055, -465.63832007666963, -569.172670402347, -504.7566062944698, -102.3456423484775, -862.0158862063428, -885.1796900317398, -186.38821572149706, -629.3201036114931, -676.400630809464, -949.5207178616977, -316.83968497077973, -899.7592040333798, -158.09626298660325, -629.7102234211649, -1154.9690001204806, -1066.2381696237321, -428.0079740614299, -1049.590191691019, -169.67955245613655, -142.73608952920588, -732.4025149300812, -77.88351882276581, -882.8207132219238, -786.2604471981897, -900.900217537186, -216.66597336125278, -774.7744708955286, -900.3767915569218, -224.9100567220344, -30.030931085168934, -915.32777802582, -779.8986316583821, -533.5630349533975, -864.8672934222776, -132.69209030705042, -670.5505191399708, -925.4966320189249, -660.312211055438, -847.0050254848358, -558.5815316896404, -345.5767230019263, -276.7695521539014, -995.5314849679306, -1048.4384820436374, -43.182012820300976, -234.01793023976742, -68.00254020572628, -698.3413661498981, -351.8427561792862, -121.70669665495419, -186.2081049549766, -83.86558637057021, -918.7005919022172, -86.1789159564344, -1145.0018307496084, -713.1593467208571, -1058.8844955390468, -106.9258719364616, -463.9023492276681, -995.3735097382578, -165.0466748729301, -388.35393036006616, -858.8383826820591, -1196.3224289914085, -407.50240697065453, -368.4197500280337, -148.34837743524128, -574.9460697935779, -385.4429440018038, -816.6911991996637, -728.619198239971, -820.9278250509125, -325.0352805832482, -787.3883755818025, -141.5662996350664, -579.636514231466, -55.39197993333937, -449.7819319537875, -313.79780225203143, -796.0079050659887, -191.15110560544062, -380.87214621722717, -144.18796058991296, -184.54921704128253, -1141.906834716085, -793.5333704992665, -604.0283658504006, -910.8767288114677, -381.66087077539606, -492.2767512983169, -436.6868741923406, -12.36544603426703, -1044.451904583201, -616.0033816451629, -139.45752706610634, -819.8413147249994, -56.85348888706791, -1175.4228903218468, -673.6286775638913, -1098.6293813899015, -295.66630271776097, -318.6889801778328, -820.5454864236201, -222.08621602619854, -513.7273003694594, -117.1185259162447]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.579278344460598, "mean_inference_ms": 1.7169055152102706, "mean_action_processing_ms": 0.8856820426208639, "mean_env_wait_ms": 10.541185756445664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01393270492553711, "StateBufferConnector_ms": 0.010416746139526367, "ViewRequirementAgentConnector_ms": 0.3671739101409912}, "num_episodes": 21, "episode_return_max": -772.9306460642889, "episode_return_min": -4170.725019213773, "episode_return_mean": -2675.508690330921, "episodes_this_iter": 21}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 417825, "num_agent_steps_trained": 417825, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.82800594017453, "num_env_steps_trained_throughput_per_sec": 72.82800594017453, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 417825, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 417825, "timers": {"training_iteration_time_ms": 53280.152, "restore_workers_time_ms": 0.028, "training_step_time_ms": 53280.078, "sample_time_ms": 3355.757, "learn_time_ms": 49866.442, "learn_throughput": 80.214, "synch_weights_time_ms": 54.738}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 417825, "num_agent_steps_trained": 417825}, "done": false, "training_iteration": 23, "trial_id": "efc54_00000", "date": "2024-07-24_19-01-32", "timestamp": 1721827892, "time_this_iter_s": 54.93603491783142, "time_total_s": 1292.163075208664, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d71e440>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1292.163075208664, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 9.987179487179487, "ram_util_percent": 23.59999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 131.7272580547609, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.0010000000000000007, "total_loss": 4.854490108248116, "policy_loss": -0.002403358784661705, "vf_loss": 4.872340245005013, "vf_explained_var": 0.9794708711225629, "kl": 0.014881793154400193, "entropy": 1.8795179304005443, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.6376811594203, "num_grad_updates_lifetime": 100320.5, "diff_num_grad_updates_vs_sampler_policy": 2069.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 435439, "num_agent_steps_trained": 435439}, "env_runners": {"episode_reward_max": -772.9306460642889, "episode_reward_min": -4361.766167577861, "episode_reward_mean": -2562.5795569448164, "episode_len_mean": 149.03, "episode_media": {}, "episodes_timesteps_total": 14903, "policy_reward_min": {"policy_0": -1361.2791118827806}, "policy_reward_max": {"policy_0": 5.379312047864783}, "policy_reward_mean": {"policy_0": -512.5159113889633}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2081.641179007399, -2415.0083757244647, -3158.0934820308426, -2548.751925887327, -4170.725019213773, -3051.3989804663142, -1803.7044797634799, -1368.255921434682, -1186.604558199487, -2107.374984553593, -3625.008111272198, -1373.4761413886295, -3208.4217091640026, -3947.822427508922, -3179.770085674026, -3954.28613185881, -2295.476827283442, -1766.6813119154785, -1117.0047577672674, -2516.690320495964, -2261.323426519077, -2286.785407326357, -2808.517288132905, -2972.8432355907566, -2360.341085798478, -1986.4447784041722, -1203.6242964668716, -1994.0377198705903, -3290.095776477528, -1292.5581554531227, -2497.1379893249305, -772.9306460642889, -1928.0104471347688, -2563.5948679510957, -2146.207481088808, -3014.8002616803174, -3050.99219071951, -2869.4341477287585, -2881.070477029294, -1211.30518277761, -2923.4704952833777, -2758.469352974936, -3908.7728601853587, -2522.4163226678743, -2864.5308701413187, -2845.420028285473, -2981.571569481076, -3336.9721232507686, -2597.939462225537, -1426.1014641448423, -2946.9062716996864, -2790.132901314364, -3219.4368990322246, -2654.047788670256, -2654.554295082495, -1806.130724810589, -2645.0495290637778, -2825.5295909279257, -2632.119574053736, -3300.2007408804657, -1992.1665089133553, -2647.255894862398, -3048.8616799370943, -2720.1381248264142, -2603.720926526033, -3158.9255798915906, -3593.4280733690052, -2537.5123273088375, -3255.7689230281826, -3220.7559427065867, -2820.9109949763065, -2860.932387994629, -1191.0853903667498, -2375.271331595425, -2420.5406717317633, -2060.1694365830394, -2401.1677834182506, -3487.4927690344985, -2296.4313102372485, -1988.050241133116, -3054.5015447682995, -2265.7753156558383, -1736.575974268263, -3010.994977594892, -1148.6459843828748, -2456.011962373327, -1683.8932553409218, -825.2288594752433, -4361.766167577861, -3149.14272087479, -2430.0585186319568, -3122.6421429951333, -2704.9669546467703, -2509.3724659526592, -4015.2592506660176, -1717.1222817204375, -2514.977762029829, -4102.284392087525, -3076.424447326173, -1783.699961346889], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 140, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-582.0743230516223, -258.15680581011736, -765.2558121281837, -348.7061410992539, -127.44809691822194, -393.447356728043, -271.7314153543231, -803.399234703586, -164.01797809748638, -782.4123908410243, -938.0087699798725, -977.9478287837995, -254.9177410385549, -859.7669417197184, -127.45220050889824, -330.1990481670232, -1037.662332462262, -871.3743624512078, -212.29963164214084, -97.21655116469677, -1233.5258427764666, -826.2384569900679, -321.72333137439176, -873.4921556446421, -915.7452324282037, -871.2641098235416, -785.5098054901705, -761.5388926510911, -309.53124137974953, -323.55493112176174, -759.4481185820893, -557.5313698667659, -97.8381090224161, -309.4475475317921, -79.43933476041533, -24.330563762066486, -930.1215393720094, -114.95267857571044, -95.7149249180126, -203.1362148068827, -159.15050880427276, -37.784856244934495, -61.46968604278981, -888.6071502227043, -39.59235688478542, -1198.1318747065795, -251.78811383101416, -519.2533284404994, -109.03337023086227, -29.1682973446391, -781.2751788509755, -709.1133923179005, -287.0675167997461, -989.596458672638, -857.9555646309376, -462.19550747163896, -514.7247101507306, -95.57630213779781, -193.9642687570329, -107.01535287142931, -1090.7290014397306, -219.2509266862893, -1029.0807930978283, -621.2888345821711, -248.0721533579804, -684.0674951039324, -750.7324981433061, -486.5530260278289, -953.1928642015046, -1073.2765440323492, -1361.2791118827806, -509.68718190393116, -771.5664500388039, -475.08428455312685, -62.15305729538276, -823.2123333952023, -812.1820177204662, -846.9958385367861, -758.9236894643506, -712.9722527420015, -737.1089961705052, -460.59339833476264, -116.67662945790349, -211.0998725241528, -769.9979307961162, -389.6485053903753, -128.05926197905524, -949.5840814134416, -68.8663896320949, -230.52307350051288, -280.64715669261585, -188.96613972910268, -470.8811809328469, -125.8297117282861, -50.68056868441639, -1139.7665363926396, -483.2463688409591, -295.51262666608307, -155.52628925497677, -442.63849934130747, -54.96835539619453, -194.8880632235772, -951.843953663807, -898.0130580853845, -161.609996150115, -119.80343848616785, -885.1980874683396, -746.7714516396218, -290.8725581597054, -244.1398715725225, -610.2297273645397, -341.1460513680077, -1012.5280556654959, -321.471927178303, -523.1415265565645, -451.38591965991725, -692.3603740270321, -751.052482815825, -39.611356646215995, -1038.4331024417638, -871.6843599100722, -594.0631145946727, -17.641163697356316, -405.7330345953591, -471.219413001016, -38.63777976401269, -42.15968424545377, -463.453880878325, -743.2111359701703, -698.9822975462107, -320.0611621636733, -770.3474971147892, -33.67843563221601, -70.1656772132163, -9.37152434297773, -1046.402432359364, -13.72484804168927, -396.85660564251845, -389.45977883043815, -147.59405499658098, -352.507390845349, -1022.3289315144932, -687.2269389879062, -912.4167948975976, -315.6157202321821, -503.1143314895276, -638.0225254052244, -105.10567581934637, -51.69493478688891, 5.379312047864783, -288.1484180412348, -197.10070026090327, -566.259295004641, -847.5760651842369, -598.0535108339134, -30.654702567658937, -398.02637247461945, -147.74575223465152, -142.93731079887687, -53.56650798848171, -132.68910833967598, -594.7516402994513, -535.2587695972619, -436.58009572540396, -228.73083317297497, -601.9768717628398, -92.51575258353255, -1035.4744281312794, -776.9101383984479, -56.717677074994675, -657.0937440131648, -836.0514897897732, -291.0678100339183, -318.6358810267456, -43.35855622520615, -699.7042337513644, -697.7629567360096, -476.9292472066644, -979.5417308332978, -160.86209315297964, -925.68671265733, -790.2757970980915, -864.0957502349801, -226.3112518566187, -244.62267887249027, -1057.624079961056, -590.3549205474443, -399.5385294716812, -403.2191484200529, -418.69746932852394, -583.9730307218621, -45.23422327913334, -1018.02446687407, -482.6395311963695, -751.1992249578574, -14.59666238674733, -156.00978278049172, -18.589926972294077, -556.4704905614055, -465.63832007666963, -569.172670402347, -504.7566062944698, -102.3456423484775, -862.0158862063428, -885.1796900317398, -186.38821572149706, -629.3201036114931, -676.400630809464, -949.5207178616977, -316.83968497077973, -899.7592040333798, -158.09626298660325, -629.7102234211649, -1154.9690001204806, -1066.2381696237321, -428.0079740614299, -1049.590191691019, -169.67955245613655, -142.73608952920588, -732.4025149300812, -77.88351882276581, -882.8207132219238, -786.2604471981897, -900.900217537186, -216.66597336125278, -774.7744708955286, -900.3767915569218, -224.9100567220344, -30.030931085168934, -915.32777802582, -779.8986316583821, -533.5630349533975, -864.8672934222776, -132.69209030705042, -670.5505191399708, -925.4966320189249, -660.312211055438, -847.0050254848358, -558.5815316896404, -345.5767230019263, -276.7695521539014, -995.5314849679306, -1048.4384820436374, -43.182012820300976, -234.01793023976742, -68.00254020572628, -698.3413661498981, -351.8427561792862, -121.70669665495419, -186.2081049549766, -83.86558637057021, -918.7005919022172, -86.1789159564344, -1145.0018307496084, -713.1593467208571, -1058.8844955390468, -106.9258719364616, -463.9023492276681, -995.3735097382578, -165.0466748729301, -388.35393036006616, -858.8383826820591, -1196.3224289914085, -407.50240697065453, -368.4197500280337, -148.34837743524128, -574.9460697935779, -385.4429440018038, -816.6911991996637, -728.619198239971, -820.9278250509125, -325.0352805832482, -787.3883755818025, -141.5662996350664, -579.636514231466, -55.39197993333937, -449.7819319537875, -313.79780225203143, -796.0079050659887, -191.15110560544062, -380.87214621722717, -144.18796058991296, -184.54921704128253, -1141.906834716085, -793.5333704992665, -604.0283658504006, -910.8767288114677, -381.66087077539606, -492.2767512983169, -436.6868741923406, -12.36544603426703, -1044.451904583201, -616.0033816451629, -139.45752706610634, -819.8413147249994, -56.85348888706791, -1175.4228903218468, -673.6286775638913, -1098.6293813899015, -295.66630271776097, -318.6889801778328, -820.5454864236201, -222.08621602619854, -513.7273003694594, -117.1185259162447, -315.3453965110993, -533.257251639237, -703.4897622543338, -858.8522923552894, -236.3111921024395, -1199.4421553513487, -87.62473247785613, -1084.1221155685625, -299.77602144814466, -377.89665509118015, -312.09536340353833, -818.3485500606116, -910.5242002621933, -543.6975642608985, -135.47244683917103, -15.720142242314934, -448.0799547674751, -603.5599741060969, -983.4478773724317, -552.9129780377096, -608.0159727815997, -791.8954387234941, -53.1818712945539, -492.34866589659424, -1213.4836311953538, -905.7865324885017, -723.5398802234096, -749.661956160288, -353.2050830589211, -861.2346214378845, -502.56674000910374, -163.61749717945352, -537.2152915909137, -855.9329947137742, -478.17980381559164, -813.5634521252895, -856.09583341647, -40.41423258129943, -378.6423855213353, -1167.0530193837897, -937.2925463745662, -908.257221335477, -454.3340486227491, -654.8742866517006, -265.9978397220931, -921.0307039799712, -827.1444861454577, -231.79922491946908, -526.2502211193168, -314.68635881209, -22.84583226909069, -1083.230369847043, -1154.2507843896706, -67.07647179172035, -533.528929697105, -241.96943321512708, -67.37988695587703, -112.88138850979449, -91.46634445479563, -677.3883372311543, -194.9124851281318, -1009.8267990792282, -106.23820231882202, -659.4489485534755, -404.84489651576774, -959.0799144545873, -581.7115310649157, -382.48592339045837, -41.31459632603959, -455.94870649576285, -10.62248964993005, -256.186139250025, -673.03362982546, -160.31152010751333, -960.0156577501128, -143.9509231354248, -327.35133152262995, -760.7250433772113, -645.7437251453165, -523.3967602376676, -775.1909304115786, -1028.6026616584418, -800.2390553448622, -45.06717366359021, -838.3929479560243, -255.20257522498696, -546.9904964830487, -800.3508726566135, -587.0734429321665, -106.81392294043492, -264.462832947495, -122.95219381725849, -675.0985942635918, -510.46005396323704, -415.0765661415326, -943.3619757926809, -775.0644472733821, -1195.2049904022222, -57.152786448567106, -83.71734485144479, -14.703204793624218, -115.25381181097838, -1170.611525111379, -743.668991228996, -221.5377827108591, -595.3634881527515, -214.125859890115, -231.29984835219983, -345.24402059191186, -350.54275728128454, -308.3162315919358, -460.15412786771714, -758.5140588316875, -798.0504067260669, -685.9601525774893, -179.50072483360162, -31.414212543608876, -98.61596260276895, -763.8282224548194, -75.2868619480764, -184.61440627804205, -600.8585928466464, -371.8573774185287, -841.3360766670617, -457.34550916304903, -426.565534502552, -716.4624659423137, -345.6672065400443, -144.794499302517, -50.403549053492654, -179.36262088534286, -113.19094587452133, -292.31615937102185, -121.20357556017308, -119.15555778418451, -983.3639038233258, -552.381650901672, -944.2139458247301, -1145.2034078437962, -736.6032591843398, -722.1013242438084, -890.1001442346139, -539.0689450314278, -642.0371919367232, -355.8351154282221, -905.7676724454748, -369.25376936478136, -86.79552871934465, -572.6430794155877, -495.59846868676937, -1023.3459965842732, -824.9931860140916, -806.8956038652461, -282.58668159084, -184.8206749406842, -1029.2758594680543, -115.52481787363375, -228.40127004304827, -1049.5016285383867, -282.2633787236467, -849.4043851087441, -223.0369963041667, -300.61651313227935, -829.8403779727821, -306.47419343468965, -741.8642041240715, -861.8705085248644, -1188.1163632525256, -957.3003045617785, -266.10787020277627, -846.2535141189303, -265.45980162347604, -70.18234349742623, -421.47442347122075, -113.75219900938369, -36.972029521967535, -823.2251940562813, -799.2505034572731, -231.5244098710795, -624.0056251232278, -1027.5725193421554, -1174.3757943929581, -39.01142093583509, -857.1870212880655, -1004.137636128512, -364.2159135521286, -830.9339968957939, -552.3981464469501, -766.3816484896819, -562.4947419416239, -141.8684682783829, -530.5662750228988, -294.2237807710689, -717.0107677537092, -100.03066952083044]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5753550940384402, "mean_inference_ms": 1.7190845061377602, "mean_action_processing_ms": 0.8785816543273546, "mean_env_wait_ms": 10.52536147014984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013242006301879883, "StateBufferConnector_ms": 0.009877920150756836, "ViewRequirementAgentConnector_ms": 0.34196949005126953}, "num_episodes": 39, "episode_return_max": -772.9306460642889, "episode_return_min": -4361.766167577861, "episode_return_mean": -2562.5795569448164, "episodes_this_iter": 39}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 435439, "num_agent_steps_trained": 435439, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.00240248808784, "num_env_steps_trained_throughput_per_sec": 77.00240248808784, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 435439, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 435439, "timers": {"training_iteration_time_ms": 52544.783, "restore_workers_time_ms": 0.027, "training_step_time_ms": 52544.711, "sample_time_ms": 3331.158, "learn_time_ms": 49156.753, "learn_throughput": 81.372, "synch_weights_time_ms": 53.68}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 435439, "num_agent_steps_trained": 435439}, "done": false, "training_iteration": 24, "trial_id": "efc54_00000", "date": "2024-07-24_19-02-24", "timestamp": 1721827944, "time_this_iter_s": 51.95959448814392, "time_total_s": 1344.1226696968079, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d71ed40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1344.1226696968079, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 9.9, "ram_util_percent": 23.599999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 128.33424103536723, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.0010000000000000005, "total_loss": 5.275170043132923, "policy_loss": -0.0009821159567936888, "vf_loss": 5.290672901412587, "vf_explained_var": 0.9718448264657715, "kl": 0.014361330422112071, "entropy": 1.7752043064140979, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.91111111111111, "num_grad_updates_lifetime": 104415.5, "diff_num_grad_updates_vs_sampler_policy": 2024.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 452707, "num_agent_steps_trained": 452707}, "env_runners": {"episode_reward_max": -772.9306460642889, "episode_reward_min": -4361.766167577861, "episode_reward_mean": -2579.761097009377, "episode_len_mean": 148.38, "episode_media": {}, "episodes_timesteps_total": 14838, "policy_reward_min": {"policy_0": -1293.94140451927}, "policy_reward_max": {"policy_0": 5.379312047864783}, "policy_reward_mean": {"policy_0": -515.9522194018754}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2261.323426519077, -2286.785407326357, -2808.517288132905, -2972.8432355907566, -2360.341085798478, -1986.4447784041722, -1203.6242964668716, -1994.0377198705903, -3290.095776477528, -1292.5581554531227, -2497.1379893249305, -772.9306460642889, -1928.0104471347688, -2563.5948679510957, -2146.207481088808, -3014.8002616803174, -3050.99219071951, -2869.4341477287585, -2881.070477029294, -1211.30518277761, -2923.4704952833777, -2758.469352974936, -3908.7728601853587, -2522.4163226678743, -2864.5308701413187, -2845.420028285473, -2981.571569481076, -3336.9721232507686, -2597.939462225537, -1426.1014641448423, -2946.9062716996864, -2790.132901314364, -3219.4368990322246, -2654.047788670256, -2654.554295082495, -1806.130724810589, -2645.0495290637778, -2825.5295909279257, -2632.119574053736, -3300.2007408804657, -1992.1665089133553, -2647.255894862398, -3048.8616799370943, -2720.1381248264142, -2603.720926526033, -3158.9255798915906, -3593.4280733690052, -2537.5123273088375, -3255.7689230281826, -3220.7559427065867, -2820.9109949763065, -2860.932387994629, -1191.0853903667498, -2375.271331595425, -2420.5406717317633, -2060.1694365830394, -2401.1677834182506, -3487.4927690344985, -2296.4313102372485, -1988.050241133116, -3054.5015447682995, -2265.7753156558383, -1736.575974268263, -3010.994977594892, -1148.6459843828748, -2456.011962373327, -1683.8932553409218, -825.2288594752433, -4361.766167577861, -3149.14272087479, -2430.0585186319568, -3122.6421429951333, -2704.9669546467703, -2509.3724659526592, -4015.2592506660176, -1717.1222817204375, -2514.977762029829, -4102.284392087525, -3076.424447326173, -1783.699961346889, -2162.6133715053147, -3186.1326107472673, -2006.9939055328978, -2022.8016770990225, -2827.4656213914664, -3378.8213097389416, -1906.2529612479377, -3590.975496974892, -2319.8400382779837, -2725.3129407143556, -2213.4227190114666, -2683.4294264210434, -4161.647944060287, -2603.1662010083623, -857.1408067480692, -3319.5793539817932, -3495.6647392864393, -2968.093288931807, -1684.8262131051374, -2480.170111281614], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 140, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-54.96835539619453, -194.8880632235772, -951.843953663807, -898.0130580853845, -161.609996150115, -119.80343848616785, -885.1980874683396, -746.7714516396218, -290.8725581597054, -244.1398715725225, -610.2297273645397, -341.1460513680077, -1012.5280556654959, -321.471927178303, -523.1415265565645, -451.38591965991725, -692.3603740270321, -751.052482815825, -39.611356646215995, -1038.4331024417638, -871.6843599100722, -594.0631145946727, -17.641163697356316, -405.7330345953591, -471.219413001016, -38.63777976401269, -42.15968424545377, -463.453880878325, -743.2111359701703, -698.9822975462107, -320.0611621636733, -770.3474971147892, -33.67843563221601, -70.1656772132163, -9.37152434297773, -1046.402432359364, -13.72484804168927, -396.85660564251845, -389.45977883043815, -147.59405499658098, -352.507390845349, -1022.3289315144932, -687.2269389879062, -912.4167948975976, -315.6157202321821, -503.1143314895276, -638.0225254052244, -105.10567581934637, -51.69493478688891, 5.379312047864783, -288.1484180412348, -197.10070026090327, -566.259295004641, -847.5760651842369, -598.0535108339134, -30.654702567658937, -398.02637247461945, -147.74575223465152, -142.93731079887687, -53.56650798848171, -132.68910833967598, -594.7516402994513, -535.2587695972619, -436.58009572540396, -228.73083317297497, -601.9768717628398, -92.51575258353255, -1035.4744281312794, -776.9101383984479, -56.717677074994675, -657.0937440131648, -836.0514897897732, -291.0678100339183, -318.6358810267456, -43.35855622520615, -699.7042337513644, -697.7629567360096, -476.9292472066644, -979.5417308332978, -160.86209315297964, -925.68671265733, -790.2757970980915, -864.0957502349801, -226.3112518566187, -244.62267887249027, -1057.624079961056, -590.3549205474443, -399.5385294716812, -403.2191484200529, -418.69746932852394, -583.9730307218621, -45.23422327913334, -1018.02446687407, -482.6395311963695, -751.1992249578574, -14.59666238674733, -156.00978278049172, -18.589926972294077, -556.4704905614055, -465.63832007666963, -569.172670402347, -504.7566062944698, -102.3456423484775, -862.0158862063428, -885.1796900317398, -186.38821572149706, -629.3201036114931, -676.400630809464, -949.5207178616977, -316.83968497077973, -899.7592040333798, -158.09626298660325, -629.7102234211649, -1154.9690001204806, -1066.2381696237321, -428.0079740614299, -1049.590191691019, -169.67955245613655, -142.73608952920588, -732.4025149300812, -77.88351882276581, -882.8207132219238, -786.2604471981897, -900.900217537186, -216.66597336125278, -774.7744708955286, -900.3767915569218, -224.9100567220344, -30.030931085168934, -915.32777802582, -779.8986316583821, -533.5630349533975, -864.8672934222776, -132.69209030705042, -670.5505191399708, -925.4966320189249, -660.312211055438, -847.0050254848358, -558.5815316896404, -345.5767230019263, -276.7695521539014, -995.5314849679306, -1048.4384820436374, -43.182012820300976, -234.01793023976742, -68.00254020572628, -698.3413661498981, -351.8427561792862, -121.70669665495419, -186.2081049549766, -83.86558637057021, -918.7005919022172, -86.1789159564344, -1145.0018307496084, -713.1593467208571, -1058.8844955390468, -106.9258719364616, -463.9023492276681, -995.3735097382578, -165.0466748729301, -388.35393036006616, -858.8383826820591, -1196.3224289914085, -407.50240697065453, -368.4197500280337, -148.34837743524128, -574.9460697935779, -385.4429440018038, -816.6911991996637, -728.619198239971, -820.9278250509125, -325.0352805832482, -787.3883755818025, -141.5662996350664, -579.636514231466, -55.39197993333937, -449.7819319537875, -313.79780225203143, -796.0079050659887, -191.15110560544062, -380.87214621722717, -144.18796058991296, -184.54921704128253, -1141.906834716085, -793.5333704992665, -604.0283658504006, -910.8767288114677, -381.66087077539606, -492.2767512983169, -436.6868741923406, -12.36544603426703, -1044.451904583201, -616.0033816451629, -139.45752706610634, -819.8413147249994, -56.85348888706791, -1175.4228903218468, -673.6286775638913, -1098.6293813899015, -295.66630271776097, -318.6889801778328, -820.5454864236201, -222.08621602619854, -513.7273003694594, -117.1185259162447, -315.3453965110993, -533.257251639237, -703.4897622543338, -858.8522923552894, -236.3111921024395, -1199.4421553513487, -87.62473247785613, -1084.1221155685625, -299.77602144814466, -377.89665509118015, -312.09536340353833, -818.3485500606116, -910.5242002621933, -543.6975642608985, -135.47244683917103, -15.720142242314934, -448.0799547674751, -603.5599741060969, -983.4478773724317, -552.9129780377096, -608.0159727815997, -791.8954387234941, -53.1818712945539, -492.34866589659424, -1213.4836311953538, -905.7865324885017, -723.5398802234096, -749.661956160288, -353.2050830589211, -861.2346214378845, -502.56674000910374, -163.61749717945352, -537.2152915909137, -855.9329947137742, -478.17980381559164, -813.5634521252895, -856.09583341647, -40.41423258129943, -378.6423855213353, -1167.0530193837897, -937.2925463745662, -908.257221335477, -454.3340486227491, -654.8742866517006, -265.9978397220931, -921.0307039799712, -827.1444861454577, -231.79922491946908, -526.2502211193168, -314.68635881209, -22.84583226909069, -1083.230369847043, -1154.2507843896706, -67.07647179172035, -533.528929697105, -241.96943321512708, -67.37988695587703, -112.88138850979449, -91.46634445479563, -677.3883372311543, -194.9124851281318, -1009.8267990792282, -106.23820231882202, -659.4489485534755, -404.84489651576774, -959.0799144545873, -581.7115310649157, -382.48592339045837, -41.31459632603959, -455.94870649576285, -10.62248964993005, -256.186139250025, -673.03362982546, -160.31152010751333, -960.0156577501128, -143.9509231354248, -327.35133152262995, -760.7250433772113, -645.7437251453165, -523.3967602376676, -775.1909304115786, -1028.6026616584418, -800.2390553448622, -45.06717366359021, -838.3929479560243, -255.20257522498696, -546.9904964830487, -800.3508726566135, -587.0734429321665, -106.81392294043492, -264.462832947495, -122.95219381725849, -675.0985942635918, -510.46005396323704, -415.0765661415326, -943.3619757926809, -775.0644472733821, -1195.2049904022222, -57.152786448567106, -83.71734485144479, -14.703204793624218, -115.25381181097838, -1170.611525111379, -743.668991228996, -221.5377827108591, -595.3634881527515, -214.125859890115, -231.29984835219983, -345.24402059191186, -350.54275728128454, -308.3162315919358, -460.15412786771714, -758.5140588316875, -798.0504067260669, -685.9601525774893, -179.50072483360162, -31.414212543608876, -98.61596260276895, -763.8282224548194, -75.2868619480764, -184.61440627804205, -600.8585928466464, -371.8573774185287, -841.3360766670617, -457.34550916304903, -426.565534502552, -716.4624659423137, -345.6672065400443, -144.794499302517, -50.403549053492654, -179.36262088534286, -113.19094587452133, -292.31615937102185, -121.20357556017308, -119.15555778418451, -983.3639038233258, -552.381650901672, -944.2139458247301, -1145.2034078437962, -736.6032591843398, -722.1013242438084, -890.1001442346139, -539.0689450314278, -642.0371919367232, -355.8351154282221, -905.7676724454748, -369.25376936478136, -86.79552871934465, -572.6430794155877, -495.59846868676937, -1023.3459965842732, -824.9931860140916, -806.8956038652461, -282.58668159084, -184.8206749406842, -1029.2758594680543, -115.52481787363375, -228.40127004304827, -1049.5016285383867, -282.2633787236467, -849.4043851087441, -223.0369963041667, -300.61651313227935, -829.8403779727821, -306.47419343468965, -741.8642041240715, -861.8705085248644, -1188.1163632525256, -957.3003045617785, -266.10787020277627, -846.2535141189303, -265.45980162347604, -70.18234349742623, -421.47442347122075, -113.75219900938369, -36.972029521967535, -823.2251940562813, -799.2505034572731, -231.5244098710795, -624.0056251232278, -1027.5725193421554, -1174.3757943929581, -39.01142093583509, -857.1870212880655, -1004.137636128512, -364.2159135521286, -830.9339968957939, -552.3981464469501, -766.3816484896819, -562.4947419416239, -141.8684682783829, -530.5662750228988, -294.2237807710689, -717.0107677537092, -100.03066952083044, -742.0149865501024, -927.1588820443519, -126.2227650672304, -77.37629471557437, -289.84044312805474, -406.37930279183826, -582.1497138297982, -734.8290474357452, -788.9822948753757, -673.7922518145162, -166.28718276025594, -588.4765321828991, -277.3153632131234, -444.4541401896938, -530.4606871869253, -652.6543841727552, -154.32728766353802, -835.1974959892606, -153.06678907251754, -227.5557202009523, -707.6200674289154, -834.3954112366383, -118.89743379561506, -658.5778713462611, -507.974837584039, -296.9594946555607, -1034.9628424611772, -383.3953933833849, -647.4141678913, -1016.0894113475182, -35.892629715815076, -1027.7775473030358, -503.710849941559, -195.03830619124275, -143.83362809628557, -518.2207641744492, -521.6419054342298, -292.29215220351995, -1293.94140451927, -964.8792706434226, -471.9660363852449, -316.34922435304776, -480.6670944796238, -541.0912652348028, -509.7664178252658, -607.6484053004365, -752.5859813987572, -212.88971503728206, -587.9992045183897, -564.1896344594888, -493.66662573277375, -876.9972053276194, -629.6296034435439, -127.02043422543025, -86.10885028209992, -474.3332869483571, -597.0087394292972, -1001.7789068660369, -561.0198558473282, -49.288637330025104, -187.0587460958816, -675.3423435849304, -1003.8679294023176, -1219.1353928671367, -1076.2435321100204, -415.03158739158846, -531.4253328610272, -484.6110722687456, -190.92135605179155, -981.1768524352109, -199.67341094741465, -296.58009531480695, -215.7081924848879, -135.8476364814287, -9.331471519531197, -81.96296639105486, -819.7938962557852, -856.5108002691652, -356.89553964902944, -1204.4161514167565, -814.4067588668041, -871.4601641657327, -395.29286041393686, -687.651326542646, -726.853629297319, -1144.2573711540188, -200.61536251232448, -882.9335464433932, -255.82898267241666, -484.45802614965305, -112.3794532707898, -1070.763504493416, -189.82965292112834, -241.50611560266177, -70.34748681714163, -824.6470982730893, -672.8423091439115, -288.6195128741792, -107.13919392851402, -586.9219970619197]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5691403440540757, "mean_inference_ms": 1.7143981604618985, "mean_action_processing_ms": 0.8757944151740961, "mean_env_wait_ms": 10.469093950531315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013313770294189453, "StateBufferConnector_ms": 0.009923696517944336, "ViewRequirementAgentConnector_ms": 0.34384989738464355}, "num_episodes": 20, "episode_return_max": -772.9306460642889, "episode_return_min": -4361.766167577861, "episode_return_mean": -2579.761097009377, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 452707, "num_agent_steps_trained": 452707, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.7176853967765, "num_env_steps_trained_throughput_per_sec": 74.7176853967765, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 452707, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 452707, "timers": {"training_iteration_time_ms": 52292.562, "restore_workers_time_ms": 0.027, "training_step_time_ms": 52292.49, "sample_time_ms": 3344.146, "learn_time_ms": 48891.671, "learn_throughput": 81.814, "synch_weights_time_ms": 53.584}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 452707, "num_agent_steps_trained": 452707}, "done": false, "training_iteration": 25, "trial_id": "efc54_00000", "date": "2024-07-24_19-03-18", "timestamp": 1721827998, "time_this_iter_s": 53.54598927497864, "time_total_s": 1397.6686589717865, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7afeb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1397.6686589717865, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 10.198684210526316, "ram_util_percent": 23.599999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 142.8926868072664, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.0010000000000000005, "total_loss": 5.120555934701303, "policy_loss": -0.0016773115181495822, "vf_loss": 5.137149260260842, "vf_explained_var": 0.9781812436050838, "kl": 0.01639343620862737, "entropy": 1.8604543215096598, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.13636363636364, "num_grad_updates_lifetime": 108420.5, "diff_num_grad_updates_vs_sampler_policy": 1979.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 469489, "num_agent_steps_trained": 469489}, "env_runners": {"episode_reward_max": -825.2288594752433, "episode_reward_min": -4361.766167577861, "episode_reward_mean": -2677.573748177543, "episode_len_mean": 148.91, "episode_media": {}, "episodes_timesteps_total": 14891, "policy_reward_min": {"policy_0": -1320.3483105148823}, "policy_reward_max": {"policy_0": 1.565038922823357}, "policy_reward_mean": {"policy_0": -535.5147496355088}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3908.7728601853587, -2522.4163226678743, -2864.5308701413187, -2845.420028285473, -2981.571569481076, -3336.9721232507686, -2597.939462225537, -1426.1014641448423, -2946.9062716996864, -2790.132901314364, -3219.4368990322246, -2654.047788670256, -2654.554295082495, -1806.130724810589, -2645.0495290637778, -2825.5295909279257, -2632.119574053736, -3300.2007408804657, -1992.1665089133553, -2647.255894862398, -3048.8616799370943, -2720.1381248264142, -2603.720926526033, -3158.9255798915906, -3593.4280733690052, -2537.5123273088375, -3255.7689230281826, -3220.7559427065867, -2820.9109949763065, -2860.932387994629, -1191.0853903667498, -2375.271331595425, -2420.5406717317633, -2060.1694365830394, -2401.1677834182506, -3487.4927690344985, -2296.4313102372485, -1988.050241133116, -3054.5015447682995, -2265.7753156558383, -1736.575974268263, -3010.994977594892, -1148.6459843828748, -2456.011962373327, -1683.8932553409218, -825.2288594752433, -4361.766167577861, -3149.14272087479, -2430.0585186319568, -3122.6421429951333, -2704.9669546467703, -2509.3724659526592, -4015.2592506660176, -1717.1222817204375, -2514.977762029829, -4102.284392087525, -3076.424447326173, -1783.699961346889, -2162.6133715053147, -3186.1326107472673, -2006.9939055328978, -2022.8016770990225, -2827.4656213914664, -3378.8213097389416, -1906.2529612479377, -3590.975496974892, -2319.8400382779837, -2725.3129407143556, -2213.4227190114666, -2683.4294264210434, -4161.647944060287, -2603.1662010083623, -857.1408067480692, -3319.5793539817932, -3495.6647392864393, -2968.093288931807, -1684.8262131051374, -2480.170111281614, -2787.9612994336308, -2704.051515845243, -4010.6295003296655, -1738.994572748508, -1907.9303234340925, -3740.1314041534365, -2587.557593600523, -3176.2928623670236, -2830.2710609046603, -2197.456344796715, -1819.5194851675615, -2863.891972463407, -2008.8576818600886, -3255.791211974684, -3265.3026298832774, -2452.0512797727174, -2584.62755790925, -2691.7791427010743, -3677.4044364371894, -3135.061611266008, -3162.986828805079, -2256.709510760449], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 140, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-899.7592040333798, -158.09626298660325, -629.7102234211649, -1154.9690001204806, -1066.2381696237321, -428.0079740614299, -1049.590191691019, -169.67955245613655, -142.73608952920588, -732.4025149300812, -77.88351882276581, -882.8207132219238, -786.2604471981897, -900.900217537186, -216.66597336125278, -774.7744708955286, -900.3767915569218, -224.9100567220344, -30.030931085168934, -915.32777802582, -779.8986316583821, -533.5630349533975, -864.8672934222776, -132.69209030705042, -670.5505191399708, -925.4966320189249, -660.312211055438, -847.0050254848358, -558.5815316896404, -345.5767230019263, -276.7695521539014, -995.5314849679306, -1048.4384820436374, -43.182012820300976, -234.01793023976742, -68.00254020572628, -698.3413661498981, -351.8427561792862, -121.70669665495419, -186.2081049549766, -83.86558637057021, -918.7005919022172, -86.1789159564344, -1145.0018307496084, -713.1593467208571, -1058.8844955390468, -106.9258719364616, -463.9023492276681, -995.3735097382578, -165.0466748729301, -388.35393036006616, -858.8383826820591, -1196.3224289914085, -407.50240697065453, -368.4197500280337, -148.34837743524128, -574.9460697935779, -385.4429440018038, -816.6911991996637, -728.619198239971, -820.9278250509125, -325.0352805832482, -787.3883755818025, -141.5662996350664, -579.636514231466, -55.39197993333937, -449.7819319537875, -313.79780225203143, -796.0079050659887, -191.15110560544062, -380.87214621722717, -144.18796058991296, -184.54921704128253, -1141.906834716085, -793.5333704992665, -604.0283658504006, -910.8767288114677, -381.66087077539606, -492.2767512983169, -436.6868741923406, -12.36544603426703, -1044.451904583201, -616.0033816451629, -139.45752706610634, -819.8413147249994, -56.85348888706791, -1175.4228903218468, -673.6286775638913, -1098.6293813899015, -295.66630271776097, -318.6889801778328, -820.5454864236201, -222.08621602619854, -513.7273003694594, -117.1185259162447, -315.3453965110993, -533.257251639237, -703.4897622543338, -858.8522923552894, -236.3111921024395, -1199.4421553513487, -87.62473247785613, -1084.1221155685625, -299.77602144814466, -377.89665509118015, -312.09536340353833, -818.3485500606116, -910.5242002621933, -543.6975642608985, -135.47244683917103, -15.720142242314934, -448.0799547674751, -603.5599741060969, -983.4478773724317, -552.9129780377096, -608.0159727815997, -791.8954387234941, -53.1818712945539, -492.34866589659424, -1213.4836311953538, -905.7865324885017, -723.5398802234096, -749.661956160288, -353.2050830589211, -861.2346214378845, -502.56674000910374, -163.61749717945352, -537.2152915909137, -855.9329947137742, -478.17980381559164, -813.5634521252895, -856.09583341647, -40.41423258129943, -378.6423855213353, -1167.0530193837897, -937.2925463745662, -908.257221335477, -454.3340486227491, -654.8742866517006, -265.9978397220931, -921.0307039799712, -827.1444861454577, -231.79922491946908, -526.2502211193168, -314.68635881209, -22.84583226909069, -1083.230369847043, -1154.2507843896706, -67.07647179172035, -533.528929697105, -241.96943321512708, -67.37988695587703, -112.88138850979449, -91.46634445479563, -677.3883372311543, -194.9124851281318, -1009.8267990792282, -106.23820231882202, -659.4489485534755, -404.84489651576774, -959.0799144545873, -581.7115310649157, -382.48592339045837, -41.31459632603959, -455.94870649576285, -10.62248964993005, -256.186139250025, -673.03362982546, -160.31152010751333, -960.0156577501128, -143.9509231354248, -327.35133152262995, -760.7250433772113, -645.7437251453165, -523.3967602376676, -775.1909304115786, -1028.6026616584418, -800.2390553448622, -45.06717366359021, -838.3929479560243, -255.20257522498696, -546.9904964830487, -800.3508726566135, -587.0734429321665, -106.81392294043492, -264.462832947495, -122.95219381725849, -675.0985942635918, -510.46005396323704, -415.0765661415326, -943.3619757926809, -775.0644472733821, -1195.2049904022222, -57.152786448567106, -83.71734485144479, -14.703204793624218, -115.25381181097838, -1170.611525111379, -743.668991228996, -221.5377827108591, -595.3634881527515, -214.125859890115, -231.29984835219983, -345.24402059191186, -350.54275728128454, -308.3162315919358, -460.15412786771714, -758.5140588316875, -798.0504067260669, -685.9601525774893, -179.50072483360162, -31.414212543608876, -98.61596260276895, -763.8282224548194, -75.2868619480764, -184.61440627804205, -600.8585928466464, -371.8573774185287, -841.3360766670617, -457.34550916304903, -426.565534502552, -716.4624659423137, -345.6672065400443, -144.794499302517, -50.403549053492654, -179.36262088534286, -113.19094587452133, -292.31615937102185, -121.20357556017308, -119.15555778418451, -983.3639038233258, -552.381650901672, -944.2139458247301, -1145.2034078437962, -736.6032591843398, -722.1013242438084, -890.1001442346139, -539.0689450314278, -642.0371919367232, -355.8351154282221, -905.7676724454748, -369.25376936478136, -86.79552871934465, -572.6430794155877, -495.59846868676937, -1023.3459965842732, -824.9931860140916, -806.8956038652461, -282.58668159084, -184.8206749406842, -1029.2758594680543, -115.52481787363375, -228.40127004304827, -1049.5016285383867, -282.2633787236467, -849.4043851087441, -223.0369963041667, -300.61651313227935, -829.8403779727821, -306.47419343468965, -741.8642041240715, -861.8705085248644, -1188.1163632525256, -957.3003045617785, -266.10787020277627, -846.2535141189303, -265.45980162347604, -70.18234349742623, -421.47442347122075, -113.75219900938369, -36.972029521967535, -823.2251940562813, -799.2505034572731, -231.5244098710795, -624.0056251232278, -1027.5725193421554, -1174.3757943929581, -39.01142093583509, -857.1870212880655, -1004.137636128512, -364.2159135521286, -830.9339968957939, -552.3981464469501, -766.3816484896819, -562.4947419416239, -141.8684682783829, -530.5662750228988, -294.2237807710689, -717.0107677537092, -100.03066952083044, -742.0149865501024, -927.1588820443519, -126.2227650672304, -77.37629471557437, -289.84044312805474, -406.37930279183826, -582.1497138297982, -734.8290474357452, -788.9822948753757, -673.7922518145162, -166.28718276025594, -588.4765321828991, -277.3153632131234, -444.4541401896938, -530.4606871869253, -652.6543841727552, -154.32728766353802, -835.1974959892606, -153.06678907251754, -227.5557202009523, -707.6200674289154, -834.3954112366383, -118.89743379561506, -658.5778713462611, -507.974837584039, -296.9594946555607, -1034.9628424611772, -383.3953933833849, -647.4141678913, -1016.0894113475182, -35.892629715815076, -1027.7775473030358, -503.710849941559, -195.03830619124275, -143.83362809628557, -518.2207641744492, -521.6419054342298, -292.29215220351995, -1293.94140451927, -964.8792706434226, -471.9660363852449, -316.34922435304776, -480.6670944796238, -541.0912652348028, -509.7664178252658, -607.6484053004365, -752.5859813987572, -212.88971503728206, -587.9992045183897, -564.1896344594888, -493.66662573277375, -876.9972053276194, -629.6296034435439, -127.02043422543025, -86.10885028209992, -474.3332869483571, -597.0087394292972, -1001.7789068660369, -561.0198558473282, -49.288637330025104, -187.0587460958816, -675.3423435849304, -1003.8679294023176, -1219.1353928671367, -1076.2435321100204, -415.03158739158846, -531.4253328610272, -484.6110722687456, -190.92135605179155, -981.1768524352109, -199.67341094741465, -296.58009531480695, -215.7081924848879, -135.8476364814287, -9.331471519531197, -81.96296639105486, -819.7938962557852, -856.5108002691652, -356.89553964902944, -1204.4161514167565, -814.4067588668041, -871.4601641657327, -395.29286041393686, -687.651326542646, -726.853629297319, -1144.2573711540188, -200.61536251232448, -882.9335464433932, -255.82898267241666, -484.45802614965305, -112.3794532707898, -1070.763504493416, -189.82965292112834, -241.50611560266177, -70.34748681714163, -824.6470982730893, -672.8423091439115, -288.6195128741792, -107.13919392851402, -586.9219970619197, -585.1102585590326, -40.01544752828013, -929.7773595721031, -668.212862357641, -564.8453714165719, -227.06484867064265, -721.6064588966141, -409.09247388444453, -138.16882236848016, -1208.1189120250624, -823.5033613414071, -629.6401106883918, -416.2975631434443, -1152.5899144382925, -988.5985507181305, -723.6210213328686, -189.59535270793393, -736.4116581976627, -45.81702003872848, -43.549520471314665, -1140.81445522862, -27.22998296258175, -211.95997914018872, -387.1610051418134, -140.76490096088983, -1288.0577016817508, -869.5654802297956, -51.71019684577195, -440.026986276574, -1090.7710391195412, -754.1434760428514, -281.2077286643724, -249.62065448090135, -793.2004627031243, -509.38527170927176, -942.9997791826094, -326.4452072053233, -666.2583715246949, -256.6056881462926, -983.9838163081051, -602.6565290144372, -377.0059929822424, -934.0970414467055, -872.9812287873981, -43.53026867387695, -274.94384828450364, -357.4859863785688, -1214.8567869351643, -218.2448589240663, -131.92486427441202, -874.9431291778424, -707.4264968996828, -48.16173629906497, -41.61154719959358, -147.376575591378, -67.5048692081317, -724.8972901507129, -40.90182916995488, -945.705683100101, -1084.8823008345107, -1013.6824566792982, -597.6353109046994, -227.5842540186851, -71.85737662503395, -98.09828363237328, -531.110741071204, -704.280834235792, -922.2745902268466, -410.76541396424545, -687.3596324765921, -1082.0384170944067, -826.0801794505802, -295.11690211299805, -565.06909243323, -496.99803879206326, -47.82984811436782, -712.5087186198303, -143.1319728273852, -921.3209022677476, -627.2598379433855, -46.95372787787822, -1320.3483105148823, -898.0937730188257, -160.24161042828308, -158.99013606938124, -554.5813249916533, -85.61966405210579, -912.8408607367978, -784.110373155341, -354.62691976518005, -842.5598490550668, -688.8195373078092, -854.0757903395993, -619.1484995793153, -672.8007601553967, -967.3942023271223, -226.33474872443892, -704.6839929331184, -574.462907917756, -662.1857593635726, -243.06280220282986, -1294.0468690656155, -289.490703806863, -1228.8867700901073, -107.49968363966397, -815.2590071412293, -132.91457119035846, -899.7277948153375, -410.37317653634767, 1.565038922823357]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5649261955397247, "mean_inference_ms": 1.7135185701238396, "mean_action_processing_ms": 0.8718451577621077, "mean_env_wait_ms": 10.44904116615624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013531923294067383, "StateBufferConnector_ms": 0.010082483291625977, "ViewRequirementAgentConnector_ms": 0.3505251407623291}, "num_episodes": 22, "episode_return_max": -825.2288594752433, "episode_return_min": -4361.766167577861, "episode_return_mean": -2677.573748177543, "episodes_this_iter": 22}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 469489, "num_agent_steps_trained": 469489, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.97402358723042, "num_env_steps_trained_throughput_per_sec": 72.97402358723042, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 469489, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 469489, "timers": {"training_iteration_time_ms": 52024.058, "restore_workers_time_ms": 0.028, "training_step_time_ms": 52023.985, "sample_time_ms": 3325.849, "learn_time_ms": 48640.526, "learn_throughput": 82.236, "synch_weights_time_ms": 54.528}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 469489, "num_agent_steps_trained": 469489}, "done": false, "training_iteration": 26, "trial_id": "efc54_00000", "date": "2024-07-24_19-04-13", "timestamp": 1721828053, "time_this_iter_s": 54.82519459724426, "time_total_s": 1452.4938535690308, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7e8700>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1452.4938535690308, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 9.938461538461539, "ram_util_percent": 23.626923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 141.49765318756846, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.0010000000000000005, "total_loss": 4.824143907449542, "policy_loss": -0.0028372828059528396, "vf_loss": 4.842063628612063, "vf_explained_var": 0.9731792735212331, "kl": 0.016679771518371002, "entropy": 1.8835381980359989, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.48175182481752, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 2054.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 486954, "num_agent_steps_trained": 486954}, "env_runners": {"episode_reward_max": -769.3776071687564, "episode_reward_min": -4412.314230016656, "episode_reward_mean": -2668.4476297898814, "episode_len_mean": 149.01, "episode_media": {}, "episodes_timesteps_total": 14901, "policy_reward_min": {"policy_0": -1320.3483105148823}, "policy_reward_max": {"policy_0": 1.565038922823357}, "policy_reward_mean": {"policy_0": -533.6895259579762}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3054.5015447682995, -2265.7753156558383, -1736.575974268263, -3010.994977594892, -1148.6459843828748, -2456.011962373327, -1683.8932553409218, -825.2288594752433, -4361.766167577861, -3149.14272087479, -2430.0585186319568, -3122.6421429951333, -2704.9669546467703, -2509.3724659526592, -4015.2592506660176, -1717.1222817204375, -2514.977762029829, -4102.284392087525, -3076.424447326173, -1783.699961346889, -2162.6133715053147, -3186.1326107472673, -2006.9939055328978, -2022.8016770990225, -2827.4656213914664, -3378.8213097389416, -1906.2529612479377, -3590.975496974892, -2319.8400382779837, -2725.3129407143556, -2213.4227190114666, -2683.4294264210434, -4161.647944060287, -2603.1662010083623, -857.1408067480692, -3319.5793539817932, -3495.6647392864393, -2968.093288931807, -1684.8262131051374, -2480.170111281614, -2787.9612994336308, -2704.051515845243, -4010.6295003296655, -1738.994572748508, -1907.9303234340925, -3740.1314041534365, -2587.557593600523, -3176.2928623670236, -2830.2710609046603, -2197.456344796715, -1819.5194851675615, -2863.891972463407, -2008.8576818600886, -3255.791211974684, -3265.3026298832774, -2452.0512797727174, -2584.62755790925, -2691.7791427010743, -3677.4044364371894, -3135.061611266008, -3162.986828805079, -2256.709510760449, -3405.7022750515994, -2097.8466413063065, -2663.058230321898, -2219.9580970543702, -3524.2591402324797, -3114.70541293483, -2612.0924447966745, -2574.107118956374, -3436.46276972718, -2389.976442357381, -1847.7867072348085, -2849.9589359396014, -2701.5914059088764, -1442.8011517085336, -1680.1984634162657, -2505.4913225584014, -2986.180581934066, -1561.008989568508, -2446.8325497423393, -3872.1935838307154, -2696.1067176039687, -769.3776071687564, -3237.047876127133, -2600.4517581882114, -1616.616546154059, -2708.0727851621295, -1260.2686869127756, -2616.9954228624993, -3230.296770562573, -4412.314230016656, -3995.242383019759, -2107.1201352167336, -2526.748207828143, -3559.4706634285503, -3490.661582218444, -2840.4304967342036, -2197.767562112815, -3928.6057796934], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-943.3619757926809, -775.0644472733821, -1195.2049904022222, -57.152786448567106, -83.71734485144479, -14.703204793624218, -115.25381181097838, -1170.611525111379, -743.668991228996, -221.5377827108591, -595.3634881527515, -214.125859890115, -231.29984835219983, -345.24402059191186, -350.54275728128454, -308.3162315919358, -460.15412786771714, -758.5140588316875, -798.0504067260669, -685.9601525774893, -179.50072483360162, -31.414212543608876, -98.61596260276895, -763.8282224548194, -75.2868619480764, -184.61440627804205, -600.8585928466464, -371.8573774185287, -841.3360766670617, -457.34550916304903, -426.565534502552, -716.4624659423137, -345.6672065400443, -144.794499302517, -50.403549053492654, -179.36262088534286, -113.19094587452133, -292.31615937102185, -121.20357556017308, -119.15555778418451, -983.3639038233258, -552.381650901672, -944.2139458247301, -1145.2034078437962, -736.6032591843398, -722.1013242438084, -890.1001442346139, -539.0689450314278, -642.0371919367232, -355.8351154282221, -905.7676724454748, -369.25376936478136, -86.79552871934465, -572.6430794155877, -495.59846868676937, -1023.3459965842732, -824.9931860140916, -806.8956038652461, -282.58668159084, -184.8206749406842, -1029.2758594680543, -115.52481787363375, -228.40127004304827, -1049.5016285383867, -282.2633787236467, -849.4043851087441, -223.0369963041667, -300.61651313227935, -829.8403779727821, -306.47419343468965, -741.8642041240715, -861.8705085248644, -1188.1163632525256, -957.3003045617785, -266.10787020277627, -846.2535141189303, -265.45980162347604, -70.18234349742623, -421.47442347122075, -113.75219900938369, -36.972029521967535, -823.2251940562813, -799.2505034572731, -231.5244098710795, -624.0056251232278, -1027.5725193421554, -1174.3757943929581, -39.01142093583509, -857.1870212880655, -1004.137636128512, -364.2159135521286, -830.9339968957939, -552.3981464469501, -766.3816484896819, -562.4947419416239, -141.8684682783829, -530.5662750228988, -294.2237807710689, -717.0107677537092, -100.03066952083044, -742.0149865501024, -927.1588820443519, -126.2227650672304, -77.37629471557437, -289.84044312805474, -406.37930279183826, -582.1497138297982, -734.8290474357452, -788.9822948753757, -673.7922518145162, -166.28718276025594, -588.4765321828991, -277.3153632131234, -444.4541401896938, -530.4606871869253, -652.6543841727552, -154.32728766353802, -835.1974959892606, -153.06678907251754, -227.5557202009523, -707.6200674289154, -834.3954112366383, -118.89743379561506, -658.5778713462611, -507.974837584039, -296.9594946555607, -1034.9628424611772, -383.3953933833849, -647.4141678913, -1016.0894113475182, -35.892629715815076, -1027.7775473030358, -503.710849941559, -195.03830619124275, -143.83362809628557, -518.2207641744492, -521.6419054342298, -292.29215220351995, -1293.94140451927, -964.8792706434226, -471.9660363852449, -316.34922435304776, -480.6670944796238, -541.0912652348028, -509.7664178252658, -607.6484053004365, -752.5859813987572, -212.88971503728206, -587.9992045183897, -564.1896344594888, -493.66662573277375, -876.9972053276194, -629.6296034435439, -127.02043422543025, -86.10885028209992, -474.3332869483571, -597.0087394292972, -1001.7789068660369, -561.0198558473282, -49.288637330025104, -187.0587460958816, -675.3423435849304, -1003.8679294023176, -1219.1353928671367, -1076.2435321100204, -415.03158739158846, -531.4253328610272, -484.6110722687456, -190.92135605179155, -981.1768524352109, -199.67341094741465, -296.58009531480695, -215.7081924848879, -135.8476364814287, -9.331471519531197, -81.96296639105486, -819.7938962557852, -856.5108002691652, -356.89553964902944, -1204.4161514167565, -814.4067588668041, -871.4601641657327, -395.29286041393686, -687.651326542646, -726.853629297319, -1144.2573711540188, -200.61536251232448, -882.9335464433932, -255.82898267241666, -484.45802614965305, -112.3794532707898, -1070.763504493416, -189.82965292112834, -241.50611560266177, -70.34748681714163, -824.6470982730893, -672.8423091439115, -288.6195128741792, -107.13919392851402, -586.9219970619197, -585.1102585590326, -40.01544752828013, -929.7773595721031, -668.212862357641, -564.8453714165719, -227.06484867064265, -721.6064588966141, -409.09247388444453, -138.16882236848016, -1208.1189120250624, -823.5033613414071, -629.6401106883918, -416.2975631434443, -1152.5899144382925, -988.5985507181305, -723.6210213328686, -189.59535270793393, -736.4116581976627, -45.81702003872848, -43.549520471314665, -1140.81445522862, -27.22998296258175, -211.95997914018872, -387.1610051418134, -140.76490096088983, -1288.0577016817508, -869.5654802297956, -51.71019684577195, -440.026986276574, -1090.7710391195412, -754.1434760428514, -281.2077286643724, -249.62065448090135, -793.2004627031243, -509.38527170927176, -942.9997791826094, -326.4452072053233, -666.2583715246949, -256.6056881462926, -983.9838163081051, -602.6565290144372, -377.0059929822424, -934.0970414467055, -872.9812287873981, -43.53026867387695, -274.94384828450364, -357.4859863785688, -1214.8567869351643, -218.2448589240663, -131.92486427441202, -874.9431291778424, -707.4264968996828, -48.16173629906497, -41.61154719959358, -147.376575591378, -67.5048692081317, -724.8972901507129, -40.90182916995488, -945.705683100101, -1084.8823008345107, -1013.6824566792982, -597.6353109046994, -227.5842540186851, -71.85737662503395, -98.09828363237328, -531.110741071204, -704.280834235792, -922.2745902268466, -410.76541396424545, -687.3596324765921, -1082.0384170944067, -826.0801794505802, -295.11690211299805, -565.06909243323, -496.99803879206326, -47.82984811436782, -712.5087186198303, -143.1319728273852, -921.3209022677476, -627.2598379433855, -46.95372787787822, -1320.3483105148823, -898.0937730188257, -160.24161042828308, -158.99013606938124, -554.5813249916533, -85.61966405210579, -912.8408607367978, -784.110373155341, -354.62691976518005, -842.5598490550668, -688.8195373078092, -854.0757903395993, -619.1484995793153, -672.8007601553967, -967.3942023271223, -226.33474872443892, -704.6839929331184, -574.462907917756, -662.1857593635726, -243.06280220282986, -1294.0468690656155, -289.490703806863, -1228.8867700901073, -107.49968363966397, -815.2590071412293, -132.91457119035846, -899.7277948153375, -410.37317653634767, 1.565038922823357, -906.8718804654577, -808.6904160486646, -783.5033238927979, -401.78970067502905, -504.8469539696478, -586.5533673037585, -35.354097085765034, -425.47853793448076, -701.8334170027666, -348.62722197953633, -847.05896572896, -47.077779122550254, -965.8763034290766, -646.6562750556357, -156.3889069856746, -1012.7214713508998, -104.43023088368776, -636.350306908512, -341.8955668300498, -124.56052108121817, -974.9981316657278, -530.8123226957717, -941.0090975461427, -466.1154785850729, -611.3241097397674, -855.2938814071789, -355.08691331739163, -282.2715261386414, -810.4500035885388, -811.6030884830808, -984.9210770160025, -876.3777720473041, -111.7726329268824, -586.378178147275, -52.642784659207656, -465.3316026562152, -189.04990052284924, -1064.7534307163864, -717.3035002261349, -137.66868483478848, -421.0994445673818, -717.4915799552489, -635.5034385644259, -829.3646402446301, -833.0036663954925, -788.5440582637937, -249.1948562898144, -857.2319261024472, -75.00564319265358, -419.9999585086727, -91.64755752044356, -172.5271318714734, -504.96891757580295, -1023.2917640061617, -55.35133626092452, -69.09410663998285, -1053.9273340091631, -411.12782026281207, -287.5527365504587, -1028.256938477186, -1151.220856356692, -440.4013537692743, -531.3665823233536, -208.29706568049247, -370.3055477790593, -729.1206750826673, -293.6761146358582, -81.09430622105599, -96.36824624497741, -242.5418095239749, -19.98604828392747, -274.2841789836377, -228.52236679930436, -199.78648592261692, -957.61938342678, -388.29902230515336, -526.4111195313935, -712.3082599927527, -54.49203087592077, -823.98088985318, -360.1653066780172, -853.5436129289051, -667.4545683426218, -49.65437527114185, -1055.3627187133814, -99.45891694835699, -97.78630830411144, -59.99762768538696, -607.7179165966675, -696.048220033987, -701.5972136177987, -595.839962895878, -69.17456826531665, -265.0182089125127, -815.2025960508364, -1050.4333868008741, -46.59070922336609, -920.110668630409, -971.3441643366324, -883.7146548394336, -300.6406139636563, -1040.2833233589492, -852.3216349882329, -299.8431779929939, -203.01796730013538, -54.008451144167246, -10.98693447227429, -436.77730951516264, -238.2839817101648, -29.32093032698637, -855.5177265318127, -151.75165090150176, -871.9324527054077, -290.1941136869506, -1067.6519323014597, -859.5538057098304, -373.70939668764936, -31.42872746275392, -319.66788692445533, -1016.0919414035228, -769.1740915702668, -271.0994898362293, -118.20886225319974, -107.65766654995909, -350.4764359444039, -1044.771153842403, -383.958666174805, -243.53840683267578, -679.1335590959753, -356.67099921626794, -231.74252591937662, -194.09509105945207, -457.5107994886637, -7.7323598382502805, -369.18791060703376, -34.26939674635976, -683.1862574198419, -1224.3057662979663, -56.09295090443638, -619.141051493896, -261.9352078948185, -1147.2153417254383, -440.57523963090614, -493.57117796602205, -886.9998033453869, -714.8623563184398, -1080.5771236641742, -672.4758507706215, -822.2827404537753, -1122.1161588096431, -861.9151072447434, -723.8793883798879, -820.2016847630066, -632.0757086721409, -957.1704939599813, -830.7936175727147, -916.4544793225086, -221.51947085447753, -101.88822882541675, -36.46433864161616, -1042.0202302801702, -199.28209358254603, -207.10320380246512, -786.2247421703976, -292.11793799256407, -1054.703979831522, -518.975468345637, -865.5588848672975, -619.7744093950641, -500.45792098903047, -1006.6999929182937, -946.1798661777331, -794.2759887465711, -433.22551246353976, -310.2802219123074, -30.474658073399006, -1169.6800743447025, -767.9112461471873, -12.259155498044716, -860.1053626708692, -783.9655678378383, -506.0767484740293, -17.314367608942824, -664.045871831834, -226.36500636017067, -464.96596307300206, -1203.4129277119534, -727.7366346605318, -852.4906251704426, -679.9996290774707]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5630380086211475, "mean_inference_ms": 1.715310306276794, "mean_action_processing_ms": 0.8672778654257847, "mean_env_wait_ms": 10.443092993920336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013123750686645508, "StateBufferConnector_ms": 0.009774208068847656, "ViewRequirementAgentConnector_ms": 0.3392751216888428}, "num_episodes": 38, "episode_return_max": -769.3776071687564, "episode_return_min": -4412.314230016656, "episode_return_mean": -2668.4476297898814, "episodes_this_iter": 38}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 486954, "num_agent_steps_trained": 486954, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 70.2395815029146, "num_env_steps_trained_throughput_per_sec": 70.2395815029146, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 486954, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 486954, "timers": {"training_iteration_time_ms": 52027.373, "restore_workers_time_ms": 0.028, "training_step_time_ms": 52027.3, "sample_time_ms": 3296.366, "learn_time_ms": 48672.64, "learn_throughput": 82.182, "synch_weights_time_ms": 55.206}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 486954, "num_agent_steps_trained": 486954}, "done": false, "training_iteration": 27, "trial_id": "efc54_00000", "date": "2024-07-24_19-05-10", "timestamp": 1721828110, "time_this_iter_s": 56.960097312927246, "time_total_s": 1509.453950881958, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7afe20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1509.453950881958, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 9.716049382716049, "ram_util_percent": 23.645679012345674}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 124.38008520964421, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.0010000000000000005, "total_loss": 5.287142391006152, "policy_loss": -0.0023639659345563915, "vf_loss": 5.304009914217573, "vf_explained_var": 0.9775651372442342, "kl": 0.016867836993994637, "entropy": 1.8298828544640782, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.11363636363636, "num_grad_updates_lifetime": 116490.5, "diff_num_grad_updates_vs_sampler_policy": 1979.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 503733, "num_agent_steps_trained": 503733}, "env_runners": {"episode_reward_max": -769.3776071687564, "episode_reward_min": -4412.314230016656, "episode_reward_mean": -2639.462009328235, "episode_len_mean": 149.35, "episode_media": {}, "episodes_timesteps_total": 14935, "policy_reward_min": {"policy_0": -1439.7621403655246}, "policy_reward_max": {"policy_0": 1.565038922823357}, "policy_reward_mean": {"policy_0": -527.8924018656472}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2162.6133715053147, -3186.1326107472673, -2006.9939055328978, -2022.8016770990225, -2827.4656213914664, -3378.8213097389416, -1906.2529612479377, -3590.975496974892, -2319.8400382779837, -2725.3129407143556, -2213.4227190114666, -2683.4294264210434, -4161.647944060287, -2603.1662010083623, -857.1408067480692, -3319.5793539817932, -3495.6647392864393, -2968.093288931807, -1684.8262131051374, -2480.170111281614, -2787.9612994336308, -2704.051515845243, -4010.6295003296655, -1738.994572748508, -1907.9303234340925, -3740.1314041534365, -2587.557593600523, -3176.2928623670236, -2830.2710609046603, -2197.456344796715, -1819.5194851675615, -2863.891972463407, -2008.8576818600886, -3255.791211974684, -3265.3026298832774, -2452.0512797727174, -2584.62755790925, -2691.7791427010743, -3677.4044364371894, -3135.061611266008, -3162.986828805079, -2256.709510760449, -3405.7022750515994, -2097.8466413063065, -2663.058230321898, -2219.9580970543702, -3524.2591402324797, -3114.70541293483, -2612.0924447966745, -2574.107118956374, -3436.46276972718, -2389.976442357381, -1847.7867072348085, -2849.9589359396014, -2701.5914059088764, -1442.8011517085336, -1680.1984634162657, -2505.4913225584014, -2986.180581934066, -1561.008989568508, -2446.8325497423393, -3872.1935838307154, -2696.1067176039687, -769.3776071687564, -3237.047876127133, -2600.4517581882114, -1616.616546154059, -2708.0727851621295, -1260.2686869127756, -2616.9954228624993, -3230.296770562573, -4412.314230016656, -3995.242383019759, -2107.1201352167336, -2526.748207828143, -3559.4706634285503, -3490.661582218444, -2840.4304967342036, -2197.767562112815, -3928.6057796934, -2561.1428638309767, -2585.1072008369624, -2750.5599687290114, -3023.46114973507, -2772.428879760893, -1434.2678422859424, -3038.860519567817, -3788.6755584202865, -2031.633060552646, -1806.1450061488442, -2339.3373583498387, -2291.0103444991873, -1797.364411803107, -1636.5189415142634, -3014.734310638269, -2085.3263730932827, -2659.6020707011535, -2917.591794266028, -1568.257270214743, -2668.757968602871], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-742.0149865501024, -927.1588820443519, -126.2227650672304, -77.37629471557437, -289.84044312805474, -406.37930279183826, -582.1497138297982, -734.8290474357452, -788.9822948753757, -673.7922518145162, -166.28718276025594, -588.4765321828991, -277.3153632131234, -444.4541401896938, -530.4606871869253, -652.6543841727552, -154.32728766353802, -835.1974959892606, -153.06678907251754, -227.5557202009523, -707.6200674289154, -834.3954112366383, -118.89743379561506, -658.5778713462611, -507.974837584039, -296.9594946555607, -1034.9628424611772, -383.3953933833849, -647.4141678913, -1016.0894113475182, -35.892629715815076, -1027.7775473030358, -503.710849941559, -195.03830619124275, -143.83362809628557, -518.2207641744492, -521.6419054342298, -292.29215220351995, -1293.94140451927, -964.8792706434226, -471.9660363852449, -316.34922435304776, -480.6670944796238, -541.0912652348028, -509.7664178252658, -607.6484053004365, -752.5859813987572, -212.88971503728206, -587.9992045183897, -564.1896344594888, -493.66662573277375, -876.9972053276194, -629.6296034435439, -127.02043422543025, -86.10885028209992, -474.3332869483571, -597.0087394292972, -1001.7789068660369, -561.0198558473282, -49.288637330025104, -187.0587460958816, -675.3423435849304, -1003.8679294023176, -1219.1353928671367, -1076.2435321100204, -415.03158739158846, -531.4253328610272, -484.6110722687456, -190.92135605179155, -981.1768524352109, -199.67341094741465, -296.58009531480695, -215.7081924848879, -135.8476364814287, -9.331471519531197, -81.96296639105486, -819.7938962557852, -856.5108002691652, -356.89553964902944, -1204.4161514167565, -814.4067588668041, -871.4601641657327, -395.29286041393686, -687.651326542646, -726.853629297319, -1144.2573711540188, -200.61536251232448, -882.9335464433932, -255.82898267241666, -484.45802614965305, -112.3794532707898, -1070.763504493416, -189.82965292112834, -241.50611560266177, -70.34748681714163, -824.6470982730893, -672.8423091439115, -288.6195128741792, -107.13919392851402, -586.9219970619197, -585.1102585590326, -40.01544752828013, -929.7773595721031, -668.212862357641, -564.8453714165719, -227.06484867064265, -721.6064588966141, -409.09247388444453, -138.16882236848016, -1208.1189120250624, -823.5033613414071, -629.6401106883918, -416.2975631434443, -1152.5899144382925, -988.5985507181305, -723.6210213328686, -189.59535270793393, -736.4116581976627, -45.81702003872848, -43.549520471314665, -1140.81445522862, -27.22998296258175, -211.95997914018872, -387.1610051418134, -140.76490096088983, -1288.0577016817508, -869.5654802297956, -51.71019684577195, -440.026986276574, -1090.7710391195412, -754.1434760428514, -281.2077286643724, -249.62065448090135, -793.2004627031243, -509.38527170927176, -942.9997791826094, -326.4452072053233, -666.2583715246949, -256.6056881462926, -983.9838163081051, -602.6565290144372, -377.0059929822424, -934.0970414467055, -872.9812287873981, -43.53026867387695, -274.94384828450364, -357.4859863785688, -1214.8567869351643, -218.2448589240663, -131.92486427441202, -874.9431291778424, -707.4264968996828, -48.16173629906497, -41.61154719959358, -147.376575591378, -67.5048692081317, -724.8972901507129, -40.90182916995488, -945.705683100101, -1084.8823008345107, -1013.6824566792982, -597.6353109046994, -227.5842540186851, -71.85737662503395, -98.09828363237328, -531.110741071204, -704.280834235792, -922.2745902268466, -410.76541396424545, -687.3596324765921, -1082.0384170944067, -826.0801794505802, -295.11690211299805, -565.06909243323, -496.99803879206326, -47.82984811436782, -712.5087186198303, -143.1319728273852, -921.3209022677476, -627.2598379433855, -46.95372787787822, -1320.3483105148823, -898.0937730188257, -160.24161042828308, -158.99013606938124, -554.5813249916533, -85.61966405210579, -912.8408607367978, -784.110373155341, -354.62691976518005, -842.5598490550668, -688.8195373078092, -854.0757903395993, -619.1484995793153, -672.8007601553967, -967.3942023271223, -226.33474872443892, -704.6839929331184, -574.462907917756, -662.1857593635726, -243.06280220282986, -1294.0468690656155, -289.490703806863, -1228.8867700901073, -107.49968363966397, -815.2590071412293, -132.91457119035846, -899.7277948153375, -410.37317653634767, 1.565038922823357, -906.8718804654577, -808.6904160486646, -783.5033238927979, -401.78970067502905, -504.8469539696478, -586.5533673037585, -35.354097085765034, -425.47853793448076, -701.8334170027666, -348.62722197953633, -847.05896572896, -47.077779122550254, -965.8763034290766, -646.6562750556357, -156.3889069856746, -1012.7214713508998, -104.43023088368776, -636.350306908512, -341.8955668300498, -124.56052108121817, -974.9981316657278, -530.8123226957717, -941.0090975461427, -466.1154785850729, -611.3241097397674, -855.2938814071789, -355.08691331739163, -282.2715261386414, -810.4500035885388, -811.6030884830808, -984.9210770160025, -876.3777720473041, -111.7726329268824, -586.378178147275, -52.642784659207656, -465.3316026562152, -189.04990052284924, -1064.7534307163864, -717.3035002261349, -137.66868483478848, -421.0994445673818, -717.4915799552489, -635.5034385644259, -829.3646402446301, -833.0036663954925, -788.5440582637937, -249.1948562898144, -857.2319261024472, -75.00564319265358, -419.9999585086727, -91.64755752044356, -172.5271318714734, -504.96891757580295, -1023.2917640061617, -55.35133626092452, -69.09410663998285, -1053.9273340091631, -411.12782026281207, -287.5527365504587, -1028.256938477186, -1151.220856356692, -440.4013537692743, -531.3665823233536, -208.29706568049247, -370.3055477790593, -729.1206750826673, -293.6761146358582, -81.09430622105599, -96.36824624497741, -242.5418095239749, -19.98604828392747, -274.2841789836377, -228.52236679930436, -199.78648592261692, -957.61938342678, -388.29902230515336, -526.4111195313935, -712.3082599927527, -54.49203087592077, -823.98088985318, -360.1653066780172, -853.5436129289051, -667.4545683426218, -49.65437527114185, -1055.3627187133814, -99.45891694835699, -97.78630830411144, -59.99762768538696, -607.7179165966675, -696.048220033987, -701.5972136177987, -595.839962895878, -69.17456826531665, -265.0182089125127, -815.2025960508364, -1050.4333868008741, -46.59070922336609, -920.110668630409, -971.3441643366324, -883.7146548394336, -300.6406139636563, -1040.2833233589492, -852.3216349882329, -299.8431779929939, -203.01796730013538, -54.008451144167246, -10.98693447227429, -436.77730951516264, -238.2839817101648, -29.32093032698637, -855.5177265318127, -151.75165090150176, -871.9324527054077, -290.1941136869506, -1067.6519323014597, -859.5538057098304, -373.70939668764936, -31.42872746275392, -319.66788692445533, -1016.0919414035228, -769.1740915702668, -271.0994898362293, -118.20886225319974, -107.65766654995909, -350.4764359444039, -1044.771153842403, -383.958666174805, -243.53840683267578, -679.1335590959753, -356.67099921626794, -231.74252591937662, -194.09509105945207, -457.5107994886637, -7.7323598382502805, -369.18791060703376, -34.26939674635976, -683.1862574198419, -1224.3057662979663, -56.09295090443638, -619.141051493896, -261.9352078948185, -1147.2153417254383, -440.57523963090614, -493.57117796602205, -886.9998033453869, -714.8623563184398, -1080.5771236641742, -672.4758507706215, -822.2827404537753, -1122.1161588096431, -861.9151072447434, -723.8793883798879, -820.2016847630066, -632.0757086721409, -957.1704939599813, -830.7936175727147, -916.4544793225086, -221.51947085447753, -101.88822882541675, -36.46433864161616, -1042.0202302801702, -199.28209358254603, -207.10320380246512, -786.2247421703976, -292.11793799256407, -1054.703979831522, -518.975468345637, -865.5588848672975, -619.7744093950641, -500.45792098903047, -1006.6999929182937, -946.1798661777331, -794.2759887465711, -433.22551246353976, -310.2802219123074, -30.474658073399006, -1169.6800743447025, -767.9112461471873, -12.259155498044716, -860.1053626708692, -783.9655678378383, -506.0767484740293, -17.314367608942824, -664.045871831834, -226.36500636017067, -464.96596307300206, -1203.4129277119534, -727.7366346605318, -852.4906251704426, -679.9996290774707, -394.55587074371647, -463.3878360066665, -881.4671049070461, -779.16876380361, -42.56328836993762, -1114.409764424165, -344.4933066577699, -403.2177910462553, -560.3931282157737, -162.5932104930011, -429.41653173504244, -837.1372267672496, -531.9049312488546, -866.0406897041034, -86.06058927375936, -301.9908222399271, -525.9633935649741, -1281.416274747075, -529.0309829926899, -385.05967619040445, -220.13408072499786, -653.416315035491, -628.3515488842284, -866.3571768424255, -404.16975827375035, -821.8421347832115, -118.80217390196172, -182.12059301413697, -133.24419080694594, -178.2587497796855, -22.22692062532909, -747.0426042936955, -774.1064290049565, -488.95133092522576, -1006.5332347186094, -1025.022172712535, -352.2214314628143, -1439.7621403655246, -160.627172718361, -811.0426411610543, -182.22347201893282, -882.0754602824514, -319.5302476709394, -446.4432644764516, -201.3606161038698, -576.7669284771434, -408.8183195583334, -452.4982727422071, -198.53551982280396, -169.52596554835566, -99.31011938518286, -106.61107719300351, -1380.495787051775, -7.287922279086771, -745.6324524407879, -701.9124790263882, -903.9909526593391, -612.1932541993581, -27.242001623044267, -45.671656991058036, -76.8929046225875, -751.1072965481524, -198.48122539395453, -516.9467340217002, -253.93625121671295, -9.996812576751257, -175.98617059080948, -19.66959361051807, -930.1228430194172, -500.74352171676884, -111.05859391572187, -915.9324222470574, -444.2488664177296, -790.7651264603642, -752.7293015973968, -814.8074270065603, -261.17479924117697, -166.54374565871683, -178.43970367976303, -664.3606975070654, -933.784994726302, -538.7234679285328, -530.2798399336317, -247.9719929697973, -408.84177514288916, -784.0730473652799, -87.15925521691041, -943.1668218516121, -754.017314843638, -349.17535498858916, -670.5695963588048, -371.24773617759837, -31.58111669671191, -38.52609514810543, -456.3327258335227, -291.9631821549583, -1222.4553648400763, -194.2826826827521, -104.65527690444374, -855.4014620206408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5578573962577464, "mean_inference_ms": 1.7106477472848918, "mean_action_processing_ms": 0.8647905871949695, "mean_env_wait_ms": 10.398643533801842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013736486434936523, "StateBufferConnector_ms": 0.009958744049072266, "ViewRequirementAgentConnector_ms": 0.3469674587249756}, "num_episodes": 20, "episode_return_max": -769.3776071687564, "episode_return_min": -4412.314230016656, "episode_return_mean": -2639.462009328235, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 503733, "num_agent_steps_trained": 503733, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.58782227707827, "num_env_steps_trained_throughput_per_sec": 73.58782227707827, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 503733, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 503733, "timers": {"training_iteration_time_ms": 51525.42, "restore_workers_time_ms": 0.027, "training_step_time_ms": 51525.348, "sample_time_ms": 3295.195, "learn_time_ms": 48173.06, "learn_throughput": 83.034, "synch_weights_time_ms": 54.046}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 503733, "num_agent_steps_trained": 503733}, "done": false, "training_iteration": 28, "trial_id": "efc54_00000", "date": "2024-07-24_19-06-04", "timestamp": 1721828164, "time_this_iter_s": 54.36932945251465, "time_total_s": 1563.8232803344727, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d71e320>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1563.8232803344727, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 10.219480519480522, "ram_util_percent": 23.59999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 132.71858273098124, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.0010000000000000002, "total_loss": 4.847917859886416, "policy_loss": -0.0036183364566563818, "vf_loss": 4.867320575287093, "vf_explained_var": 0.9826709767182668, "kl": 0.01584797547096679, "entropy": 1.9350171396091802, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.7910447761194, "num_grad_updates_lifetime": 120480.5, "diff_num_grad_updates_vs_sampler_policy": 2009.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 520857, "num_agent_steps_trained": 520857}, "env_runners": {"episode_reward_max": -769.3776071687564, "episode_reward_min": -4412.314230016656, "episode_reward_mean": -2668.8897698470473, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1439.7621403655246}, "policy_reward_max": {"policy_0": 1.565038922823357}, "policy_reward_mean": {"policy_0": -533.7779539694095}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4010.6295003296655, -1738.994572748508, -1907.9303234340925, -3740.1314041534365, -2587.557593600523, -3176.2928623670236, -2830.2710609046603, -2197.456344796715, -1819.5194851675615, -2863.891972463407, -2008.8576818600886, -3255.791211974684, -3265.3026298832774, -2452.0512797727174, -2584.62755790925, -2691.7791427010743, -3677.4044364371894, -3135.061611266008, -3162.986828805079, -2256.709510760449, -3405.7022750515994, -2097.8466413063065, -2663.058230321898, -2219.9580970543702, -3524.2591402324797, -3114.70541293483, -2612.0924447966745, -2574.107118956374, -3436.46276972718, -2389.976442357381, -1847.7867072348085, -2849.9589359396014, -2701.5914059088764, -1442.8011517085336, -1680.1984634162657, -2505.4913225584014, -2986.180581934066, -1561.008989568508, -2446.8325497423393, -3872.1935838307154, -2696.1067176039687, -769.3776071687564, -3237.047876127133, -2600.4517581882114, -1616.616546154059, -2708.0727851621295, -1260.2686869127756, -2616.9954228624993, -3230.296770562573, -4412.314230016656, -3995.242383019759, -2107.1201352167336, -2526.748207828143, -3559.4706634285503, -3490.661582218444, -2840.4304967342036, -2197.767562112815, -3928.6057796934, -2561.1428638309767, -2585.1072008369624, -2750.5599687290114, -3023.46114973507, -2772.428879760893, -1434.2678422859424, -3038.860519567817, -3788.6755584202865, -2031.633060552646, -1806.1450061488442, -2339.3373583498387, -2291.0103444991873, -1797.364411803107, -1636.5189415142634, -3014.734310638269, -2085.3263730932827, -2659.6020707011535, -2917.591794266028, -1568.257270214743, -2668.757968602871, -2717.370478228429, -2981.176321444984, -2736.69487472252, -2240.9292835289225, -2828.5625328149013, -2493.2449415182805, -3485.714293938282, -1991.8401866232919, -2798.4730386216415, -3221.620408428176, -3914.737041445747, -4049.431488285655, -1527.6951877852698, -2211.432977795493, -2919.443745267407, -3717.4531772972296, -2283.068797843979, -3213.4110605978067, -2070.203881725101, -2347.947523935617, -2481.5522441557123, -2797.136118221652], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-823.5033613414071, -629.6401106883918, -416.2975631434443, -1152.5899144382925, -988.5985507181305, -723.6210213328686, -189.59535270793393, -736.4116581976627, -45.81702003872848, -43.549520471314665, -1140.81445522862, -27.22998296258175, -211.95997914018872, -387.1610051418134, -140.76490096088983, -1288.0577016817508, -869.5654802297956, -51.71019684577195, -440.026986276574, -1090.7710391195412, -754.1434760428514, -281.2077286643724, -249.62065448090135, -793.2004627031243, -509.38527170927176, -942.9997791826094, -326.4452072053233, -666.2583715246949, -256.6056881462926, -983.9838163081051, -602.6565290144372, -377.0059929822424, -934.0970414467055, -872.9812287873981, -43.53026867387695, -274.94384828450364, -357.4859863785688, -1214.8567869351643, -218.2448589240663, -131.92486427441202, -874.9431291778424, -707.4264968996828, -48.16173629906497, -41.61154719959358, -147.376575591378, -67.5048692081317, -724.8972901507129, -40.90182916995488, -945.705683100101, -1084.8823008345107, -1013.6824566792982, -597.6353109046994, -227.5842540186851, -71.85737662503395, -98.09828363237328, -531.110741071204, -704.280834235792, -922.2745902268466, -410.76541396424545, -687.3596324765921, -1082.0384170944067, -826.0801794505802, -295.11690211299805, -565.06909243323, -496.99803879206326, -47.82984811436782, -712.5087186198303, -143.1319728273852, -921.3209022677476, -627.2598379433855, -46.95372787787822, -1320.3483105148823, -898.0937730188257, -160.24161042828308, -158.99013606938124, -554.5813249916533, -85.61966405210579, -912.8408607367978, -784.110373155341, -354.62691976518005, -842.5598490550668, -688.8195373078092, -854.0757903395993, -619.1484995793153, -672.8007601553967, -967.3942023271223, -226.33474872443892, -704.6839929331184, -574.462907917756, -662.1857593635726, -243.06280220282986, -1294.0468690656155, -289.490703806863, -1228.8867700901073, -107.49968363966397, -815.2590071412293, -132.91457119035846, -899.7277948153375, -410.37317653634767, 1.565038922823357, -906.8718804654577, -808.6904160486646, -783.5033238927979, -401.78970067502905, -504.8469539696478, -586.5533673037585, -35.354097085765034, -425.47853793448076, -701.8334170027666, -348.62722197953633, -847.05896572896, -47.077779122550254, -965.8763034290766, -646.6562750556357, -156.3889069856746, -1012.7214713508998, -104.43023088368776, -636.350306908512, -341.8955668300498, -124.56052108121817, -974.9981316657278, -530.8123226957717, -941.0090975461427, -466.1154785850729, -611.3241097397674, -855.2938814071789, -355.08691331739163, -282.2715261386414, -810.4500035885388, -811.6030884830808, -984.9210770160025, -876.3777720473041, -111.7726329268824, -586.378178147275, -52.642784659207656, -465.3316026562152, -189.04990052284924, -1064.7534307163864, -717.3035002261349, -137.66868483478848, -421.0994445673818, -717.4915799552489, -635.5034385644259, -829.3646402446301, -833.0036663954925, -788.5440582637937, -249.1948562898144, -857.2319261024472, -75.00564319265358, -419.9999585086727, -91.64755752044356, -172.5271318714734, -504.96891757580295, -1023.2917640061617, -55.35133626092452, -69.09410663998285, -1053.9273340091631, -411.12782026281207, -287.5527365504587, -1028.256938477186, -1151.220856356692, -440.4013537692743, -531.3665823233536, -208.29706568049247, -370.3055477790593, -729.1206750826673, -293.6761146358582, -81.09430622105599, -96.36824624497741, -242.5418095239749, -19.98604828392747, -274.2841789836377, -228.52236679930436, -199.78648592261692, -957.61938342678, -388.29902230515336, -526.4111195313935, -712.3082599927527, -54.49203087592077, -823.98088985318, -360.1653066780172, -853.5436129289051, -667.4545683426218, -49.65437527114185, -1055.3627187133814, -99.45891694835699, -97.78630830411144, -59.99762768538696, -607.7179165966675, -696.048220033987, -701.5972136177987, -595.839962895878, -69.17456826531665, -265.0182089125127, -815.2025960508364, -1050.4333868008741, -46.59070922336609, -920.110668630409, -971.3441643366324, -883.7146548394336, -300.6406139636563, -1040.2833233589492, -852.3216349882329, -299.8431779929939, -203.01796730013538, -54.008451144167246, -10.98693447227429, -436.77730951516264, -238.2839817101648, -29.32093032698637, -855.5177265318127, -151.75165090150176, -871.9324527054077, -290.1941136869506, -1067.6519323014597, -859.5538057098304, -373.70939668764936, -31.42872746275392, -319.66788692445533, -1016.0919414035228, -769.1740915702668, -271.0994898362293, -118.20886225319974, -107.65766654995909, -350.4764359444039, -1044.771153842403, -383.958666174805, -243.53840683267578, -679.1335590959753, -356.67099921626794, -231.74252591937662, -194.09509105945207, -457.5107994886637, -7.7323598382502805, -369.18791060703376, -34.26939674635976, -683.1862574198419, -1224.3057662979663, -56.09295090443638, -619.141051493896, -261.9352078948185, -1147.2153417254383, -440.57523963090614, -493.57117796602205, -886.9998033453869, -714.8623563184398, -1080.5771236641742, -672.4758507706215, -822.2827404537753, -1122.1161588096431, -861.9151072447434, -723.8793883798879, -820.2016847630066, -632.0757086721409, -957.1704939599813, -830.7936175727147, -916.4544793225086, -221.51947085447753, -101.88822882541675, -36.46433864161616, -1042.0202302801702, -199.28209358254603, -207.10320380246512, -786.2247421703976, -292.11793799256407, -1054.703979831522, -518.975468345637, -865.5588848672975, -619.7744093950641, -500.45792098903047, -1006.6999929182937, -946.1798661777331, -794.2759887465711, -433.22551246353976, -310.2802219123074, -30.474658073399006, -1169.6800743447025, -767.9112461471873, -12.259155498044716, -860.1053626708692, -783.9655678378383, -506.0767484740293, -17.314367608942824, -664.045871831834, -226.36500636017067, -464.96596307300206, -1203.4129277119534, -727.7366346605318, -852.4906251704426, -679.9996290774707, -394.55587074371647, -463.3878360066665, -881.4671049070461, -779.16876380361, -42.56328836993762, -1114.409764424165, -344.4933066577699, -403.2177910462553, -560.3931282157737, -162.5932104930011, -429.41653173504244, -837.1372267672496, -531.9049312488546, -866.0406897041034, -86.06058927375936, -301.9908222399271, -525.9633935649741, -1281.416274747075, -529.0309829926899, -385.05967619040445, -220.13408072499786, -653.416315035491, -628.3515488842284, -866.3571768424255, -404.16975827375035, -821.8421347832115, -118.80217390196172, -182.12059301413697, -133.24419080694594, -178.2587497796855, -22.22692062532909, -747.0426042936955, -774.1064290049565, -488.95133092522576, -1006.5332347186094, -1025.022172712535, -352.2214314628143, -1439.7621403655246, -160.627172718361, -811.0426411610543, -182.22347201893282, -882.0754602824514, -319.5302476709394, -446.4432644764516, -201.3606161038698, -576.7669284771434, -408.8183195583334, -452.4982727422071, -198.53551982280396, -169.52596554835566, -99.31011938518286, -106.61107719300351, -1380.495787051775, -7.287922279086771, -745.6324524407879, -701.9124790263882, -903.9909526593391, -612.1932541993581, -27.242001623044267, -45.671656991058036, -76.8929046225875, -751.1072965481524, -198.48122539395453, -516.9467340217002, -253.93625121671295, -9.996812576751257, -175.98617059080948, -19.66959361051807, -930.1228430194172, -500.74352171676884, -111.05859391572187, -915.9324222470574, -444.2488664177296, -790.7651264603642, -752.7293015973968, -814.8074270065603, -261.17479924117697, -166.54374565871683, -178.43970367976303, -664.3606975070654, -933.784994726302, -538.7234679285328, -530.2798399336317, -247.9719929697973, -408.84177514288916, -784.0730473652799, -87.15925521691041, -943.1668218516121, -754.017314843638, -349.17535498858916, -670.5695963588048, -371.24773617759837, -31.58111669671191, -38.52609514810543, -456.3327258335227, -291.9631821549583, -1222.4553648400763, -194.2826826827521, -104.65527690444374, -855.4014620206408, -653.5279029086053, -838.8482868852453, -982.8368507755526, -12.761514716189875, -229.39592294283614, -811.2356277170489, -747.0853973505183, -710.133894737033, -91.6272787079425, -621.0941229324409, -413.4841726857599, -875.8714599486862, -493.1213288685375, -215.70192573111507, -738.5159874884212, -634.6778724710209, -654.6330042669009, -32.518157808092596, -52.15818772816767, -866.9420612547405, -934.4835398690574, -877.1738050765589, -76.03268371054098, -17.06826997884139, -923.8042341799035, -962.0661103955312, -12.676046196215287, -107.21463891499307, -151.2854070848048, -1260.0027389267354, -824.1705770627149, -618.5003383582863, -792.5088471595138, -275.8191844230839, -974.7153469346829, -37.106207198058, -466.1450952637268, -774.9671069200926, -509.64643712731566, -203.97534011409687, -765.6839225905946, -161.30180576254477, -1033.480927711406, -738.4418931556141, -99.5644894014803, -192.45889772288297, -1074.6519266555474, -347.5885835904456, -368.1592290275088, -1238.7617714317917, -1137.7571011268637, -820.0598206573148, -658.3814844357969, -550.9192635792541, -747.6193716465123, -283.471022634451, -1151.1383241901633, -838.580539266956, -709.7616497031412, -1066.4799524909472, -514.1734377843411, -53.20235507011518, -15.540117001717695, -847.5637572224924, -97.21552070660434, -545.6274405040618, -554.9614814390252, -976.6777028298951, -40.204278591867926, -93.96207443064435, -284.8678627995797, -1045.3557421669527, -100.18073835737812, -761.312039945537, -727.7273619979577, -884.2356547206107, -1087.726261593899, -354.98703060226507, -330.37016518231053, -1060.134065198146, -131.45485740721986, -721.3549391721863, -322.6892733224217, -475.1810947177414, -632.3886332244101, -644.2307805636902, -17.47377098063674, -828.5290474272454, -645.6882473418567, -1077.4892142843817, -344.872589458091, -493.60148417495736, -726.9224524310823, -311.125077313338, -193.68227834763434, -495.43691374006704, -991.7948462032566, -269.9132736188502, -369.3794104819, -221.4230798915436, -791.4813074606916, -54.18803017011144, -531.2276194037279, -219.03983842232194, -885.6154486988585, -389.1268144153137, -508.26194402305174, -758.403334367035, -568.211320041324, -573.132705374928]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.555215187834805, "mean_inference_ms": 1.7101958976527325, "mean_action_processing_ms": 0.861468762763762, "mean_env_wait_ms": 10.383114278278258, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014024496078491211, "StateBufferConnector_ms": 0.010397911071777344, "ViewRequirementAgentConnector_ms": 0.3671131134033203}, "num_episodes": 22, "episode_return_max": -769.3776071687564, "episode_return_min": -4412.314230016656, "episode_return_mean": -2668.8897698470473, "episodes_this_iter": 22}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 520857, "num_agent_steps_trained": 520857, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.25052740978623, "num_env_steps_trained_throughput_per_sec": 72.25052740978623, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 520857, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 520857, "timers": {"training_iteration_time_ms": 51275.932, "restore_workers_time_ms": 0.027, "training_step_time_ms": 51275.859, "sample_time_ms": 3276.809, "learn_time_ms": 47943.516, "learn_throughput": 83.432, "synch_weights_time_ms": 52.586}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 520857, "num_agent_steps_trained": 520857}, "done": false, "training_iteration": 29, "trial_id": "efc54_00000", "date": "2024-07-24_19-07-00", "timestamp": 1721828220, "time_this_iter_s": 55.373427629470825, "time_total_s": 1619.1967079639435, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7e8a60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1619.1967079639435, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 10.091025641025642, "ram_util_percent": 23.59999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 116.52253289222718, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.0010000000000000005, "total_loss": 4.893213010616977, "policy_loss": -0.0034224617399476382, "vf_loss": 4.912011756499608, "vf_explained_var": 0.9658742724193468, "kl": 0.016164087201027678, "entropy": 1.9013212834042732, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.96969696969697, "num_grad_updates_lifetime": 124470.5, "diff_num_grad_updates_vs_sampler_policy": 1979.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 537749, "num_agent_steps_trained": 537749}, "env_runners": {"episode_reward_max": -769.3776071687564, "episode_reward_min": -4412.314230016656, "episode_reward_mean": -2618.458133847929, "episode_len_mean": 149.95, "episode_media": {}, "episodes_timesteps_total": 14995, "policy_reward_min": {"policy_0": -1439.7621403655246}, "policy_reward_max": {"policy_0": 3.2978874995199328}, "policy_reward_mean": {"policy_0": -523.6916267695858}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2446.8325497423393, -3872.1935838307154, -2696.1067176039687, -769.3776071687564, -3237.047876127133, -2600.4517581882114, -1616.616546154059, -2708.0727851621295, -1260.2686869127756, -2616.9954228624993, -3230.296770562573, -4412.314230016656, -3995.242383019759, -2107.1201352167336, -2526.748207828143, -3559.4706634285503, -3490.661582218444, -2840.4304967342036, -2197.767562112815, -3928.6057796934, -2561.1428638309767, -2585.1072008369624, -2750.5599687290114, -3023.46114973507, -2772.428879760893, -1434.2678422859424, -3038.860519567817, -3788.6755584202865, -2031.633060552646, -1806.1450061488442, -2339.3373583498387, -2291.0103444991873, -1797.364411803107, -1636.5189415142634, -3014.734310638269, -2085.3263730932827, -2659.6020707011535, -2917.591794266028, -1568.257270214743, -2668.757968602871, -2717.370478228429, -2981.176321444984, -2736.69487472252, -2240.9292835289225, -2828.5625328149013, -2493.2449415182805, -3485.714293938282, -1991.8401866232919, -2798.4730386216415, -3221.620408428176, -3914.737041445747, -4049.431488285655, -1527.6951877852698, -2211.432977795493, -2919.443745267407, -3717.4531772972296, -2283.068797843979, -3213.4110605978067, -2070.203881725101, -2347.947523935617, -2481.5522441557123, -2797.136118221652, -3326.5357650269257, -1898.3197259281121, -2058.8560246931493, -2319.756145992094, -2580.0519807517694, -2453.456023268396, -2420.3010379040934, -2167.6731074670515, -3002.422820910695, -2183.5604907768607, -2974.4741859947994, -2513.052226840253, -2663.041402571392, -2638.165344885739, -3115.384202232974, -2632.965487329654, -2112.882821478851, -2122.792500528402, -3776.1103551952438, -2311.149800911208, -2561.910161269672, -3225.653726028612, -2263.192109349101, -3291.1789118992438, -2583.8456378818096, -2885.035862048048, -2607.4478237032913, -2261.977197407202, -1203.6848897856985, -2941.220055975897, -2352.493012958325, -1801.6759759221618, -3047.128746233781, -1281.0664228509784, -2764.5121625627626, -1901.3591244643503, -3479.40662271087, -2209.5296486922616], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-701.5972136177987, -595.839962895878, -69.17456826531665, -265.0182089125127, -815.2025960508364, -1050.4333868008741, -46.59070922336609, -920.110668630409, -971.3441643366324, -883.7146548394336, -300.6406139636563, -1040.2833233589492, -852.3216349882329, -299.8431779929939, -203.01796730013538, -54.008451144167246, -10.98693447227429, -436.77730951516264, -238.2839817101648, -29.32093032698637, -855.5177265318127, -151.75165090150176, -871.9324527054077, -290.1941136869506, -1067.6519323014597, -859.5538057098304, -373.70939668764936, -31.42872746275392, -319.66788692445533, -1016.0919414035228, -769.1740915702668, -271.0994898362293, -118.20886225319974, -107.65766654995909, -350.4764359444039, -1044.771153842403, -383.958666174805, -243.53840683267578, -679.1335590959753, -356.67099921626794, -231.74252591937662, -194.09509105945207, -457.5107994886637, -7.7323598382502805, -369.18791060703376, -34.26939674635976, -683.1862574198419, -1224.3057662979663, -56.09295090443638, -619.141051493896, -261.9352078948185, -1147.2153417254383, -440.57523963090614, -493.57117796602205, -886.9998033453869, -714.8623563184398, -1080.5771236641742, -672.4758507706215, -822.2827404537753, -1122.1161588096431, -861.9151072447434, -723.8793883798879, -820.2016847630066, -632.0757086721409, -957.1704939599813, -830.7936175727147, -916.4544793225086, -221.51947085447753, -101.88822882541675, -36.46433864161616, -1042.0202302801702, -199.28209358254603, -207.10320380246512, -786.2247421703976, -292.11793799256407, -1054.703979831522, -518.975468345637, -865.5588848672975, -619.7744093950641, -500.45792098903047, -1006.6999929182937, -946.1798661777331, -794.2759887465711, -433.22551246353976, -310.2802219123074, -30.474658073399006, -1169.6800743447025, -767.9112461471873, -12.259155498044716, -860.1053626708692, -783.9655678378383, -506.0767484740293, -17.314367608942824, -664.045871831834, -226.36500636017067, -464.96596307300206, -1203.4129277119534, -727.7366346605318, -852.4906251704426, -679.9996290774707, -394.55587074371647, -463.3878360066665, -881.4671049070461, -779.16876380361, -42.56328836993762, -1114.409764424165, -344.4933066577699, -403.2177910462553, -560.3931282157737, -162.5932104930011, -429.41653173504244, -837.1372267672496, -531.9049312488546, -866.0406897041034, -86.06058927375936, -301.9908222399271, -525.9633935649741, -1281.416274747075, -529.0309829926899, -385.05967619040445, -220.13408072499786, -653.416315035491, -628.3515488842284, -866.3571768424255, -404.16975827375035, -821.8421347832115, -118.80217390196172, -182.12059301413697, -133.24419080694594, -178.2587497796855, -22.22692062532909, -747.0426042936955, -774.1064290049565, -488.95133092522576, -1006.5332347186094, -1025.022172712535, -352.2214314628143, -1439.7621403655246, -160.627172718361, -811.0426411610543, -182.22347201893282, -882.0754602824514, -319.5302476709394, -446.4432644764516, -201.3606161038698, -576.7669284771434, -408.8183195583334, -452.4982727422071, -198.53551982280396, -169.52596554835566, -99.31011938518286, -106.61107719300351, -1380.495787051775, -7.287922279086771, -745.6324524407879, -701.9124790263882, -903.9909526593391, -612.1932541993581, -27.242001623044267, -45.671656991058036, -76.8929046225875, -751.1072965481524, -198.48122539395453, -516.9467340217002, -253.93625121671295, -9.996812576751257, -175.98617059080948, -19.66959361051807, -930.1228430194172, -500.74352171676884, -111.05859391572187, -915.9324222470574, -444.2488664177296, -790.7651264603642, -752.7293015973968, -814.8074270065603, -261.17479924117697, -166.54374565871683, -178.43970367976303, -664.3606975070654, -933.784994726302, -538.7234679285328, -530.2798399336317, -247.9719929697973, -408.84177514288916, -784.0730473652799, -87.15925521691041, -943.1668218516121, -754.017314843638, -349.17535498858916, -670.5695963588048, -371.24773617759837, -31.58111669671191, -38.52609514810543, -456.3327258335227, -291.9631821549583, -1222.4553648400763, -194.2826826827521, -104.65527690444374, -855.4014620206408, -653.5279029086053, -838.8482868852453, -982.8368507755526, -12.761514716189875, -229.39592294283614, -811.2356277170489, -747.0853973505183, -710.133894737033, -91.6272787079425, -621.0941229324409, -413.4841726857599, -875.8714599486862, -493.1213288685375, -215.70192573111507, -738.5159874884212, -634.6778724710209, -654.6330042669009, -32.518157808092596, -52.15818772816767, -866.9420612547405, -934.4835398690574, -877.1738050765589, -76.03268371054098, -17.06826997884139, -923.8042341799035, -962.0661103955312, -12.676046196215287, -107.21463891499307, -151.2854070848048, -1260.0027389267354, -824.1705770627149, -618.5003383582863, -792.5088471595138, -275.8191844230839, -974.7153469346829, -37.106207198058, -466.1450952637268, -774.9671069200926, -509.64643712731566, -203.97534011409687, -765.6839225905946, -161.30180576254477, -1033.480927711406, -738.4418931556141, -99.5644894014803, -192.45889772288297, -1074.6519266555474, -347.5885835904456, -368.1592290275088, -1238.7617714317917, -1137.7571011268637, -820.0598206573148, -658.3814844357969, -550.9192635792541, -747.6193716465123, -283.471022634451, -1151.1383241901633, -838.580539266956, -709.7616497031412, -1066.4799524909472, -514.1734377843411, -53.20235507011518, -15.540117001717695, -847.5637572224924, -97.21552070660434, -545.6274405040618, -554.9614814390252, -976.6777028298951, -40.204278591867926, -93.96207443064435, -284.8678627995797, -1045.3557421669527, -100.18073835737812, -761.312039945537, -727.7273619979577, -884.2356547206107, -1087.726261593899, -354.98703060226507, -330.37016518231053, -1060.134065198146, -131.45485740721986, -721.3549391721863, -322.6892733224217, -475.1810947177414, -632.3886332244101, -644.2307805636902, -17.47377098063674, -828.5290474272454, -645.6882473418567, -1077.4892142843817, -344.872589458091, -493.60148417495736, -726.9224524310823, -311.125077313338, -193.68227834763434, -495.43691374006704, -991.7948462032566, -269.9132736188502, -369.3794104819, -221.4230798915436, -791.4813074606916, -54.18803017011144, -531.2276194037279, -219.03983842232194, -885.6154486988585, -389.1268144153137, -508.26194402305174, -758.403334367035, -568.211320041324, -573.132705374928, -58.07325130692988, -724.1941503757168, -874.7756745026984, -802.9120770016425, -866.5806118399363, -25.934918102041177, -187.78338411376745, -183.07017592172033, -814.2312707239679, -687.2999770666145, -793.2094020003592, -73.71367689509034, -44.37799095984055, -342.3016175840526, -805.2533372538069, -133.5964978196197, -590.6736741132695, -390.1317491528835, -389.05378816150085, -816.3004367448206, -770.7613516352519, -921.396668854153, -98.76414769397815, -666.5567904046738, -122.57302216371085, -129.99790178535056, -270.1016553364755, -652.4605494049403, -488.9738536802185, -911.922063061409, -214.5749066212567, -602.3771068843914, -74.32713051208863, -769.2224140293107, -759.7994798570478, -176.03906077486374, -647.0388772636375, -226.66508791880082, -1058.518108144994, -59.41197336475524, -743.1728919551425, -498.1784456548976, -378.2918536845157, -856.6245998775661, -526.1550297385753, -285.5342812564337, -692.3991971728145, -121.7125284305122, -1010.8197439881593, -73.09473992894219, -778.5052067200725, -746.3107488449074, -597.6507637516402, -719.3443892752854, -132.6630774028933, -1102.9871324382543, -27.981820983994634, -625.3713393631879, -223.13820360536326, -533.5737304494538, -515.974838285127, -639.7973936430077, -613.5174339896329, -531.7635031757981, -361.98823347782496, -634.0042512937757, -746.7898502467867, -327.81654246916645, -575.9499496580833, -353.6047512179221, -393.8576547231346, -1224.3593960311514, -401.7932890836232, -129.0817751877126, -966.2920872073541, -194.21651793070174, -392.228044162163, -717.765809786446, -811.5355652991353, -517.2195501512073, -354.3570011710231, -121.98174355325465, -347.44715035771503, -1238.3437571716124, -50.7531692252462, -410.4790255795221, -433.06654132949836, -356.00560679807404, -589.1821059766229, -334.0592208446847, -538.6974837603359, -573.5110132711784, -687.8009354983066, -974.4315444175813, -1001.6693782478358, -465.5852749958119, -279.61282220492984, -890.4919834339917, -565.3683548974271, -110.09136537904796, -738.0343334207423, -255.65436175285612, -651.7760830277351, -764.5993390858082, -151.84604398252586, -980.6383144570658, -381.5427553349632, -259.96934915543653, -563.1957369142856, -1040.307570166859, -602.3940354020441, -860.4650083121224, -166.61940582645462, -102.9493584374138, -530.7643013710657, -743.6986149997193, -367.6639845353963, -990.5734676415177, -952.1738914524883, -237.06895327012296, -235.63599029345363, -684.5344309085584, -1176.5914556704972, -69.90696063592166, -417.1768003733776, -704.0710929823699, 3.2978874995199328, -735.6450118872831, -759.4005663843648, -689.2170782935542, -1015.5306316605927, -703.3981131294081, -49.1394075459438, -819.4820487239465, -19.897622643400112, -614.8425117494642, -733.9317278788417, -30.333569538465607, -17.094119655103643, -865.7752685853255, -187.56438745111416, -334.4695321766401, -173.51802096528212, -148.21512651954328, -359.91782267311925, -437.9552172735014, -429.3054010123601, -303.9984276098996, -856.2701686046239, -913.6908414755114, -764.8920265652986, -214.0014602472991, -186.5930228347887, -355.2237888406398, -831.7827144703003, -694.8667792901122, 0.9421473377223205, -657.0736349810575, -343.32279860159207, -107.35491038712226, -1182.0648355769076, -209.93779627324528, -65.8288494231692, -410.62346479883684, -1178.6738001616206, -17.194557173091475, -423.693563558247, -13.97224567414176, -39.97006774428383, -786.2359887012138, -842.627969217346, -200.78824722407958, -654.65692671677, -476.3843486800624, -590.0546707245036, -564.9296738465948, -2.4068928423250187, -268.2511134414414, -784.0981116785662, -281.6733326554227, -539.7948124735359, -990.4755546756431, -42.219929594801876, -1308.318321703205, -598.5980042636854, -591.8062308294881, -755.4814040561547, -221.08483991238344, -487.43798026993255, -153.71919362430177]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5559011311535489, "mean_inference_ms": 1.7133998472944723, "mean_action_processing_ms": 0.8580225381779065, "mean_env_wait_ms": 10.386635725248249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013883352279663086, "StateBufferConnector_ms": 0.009959220886230469, "ViewRequirementAgentConnector_ms": 0.3490724563598633}, "num_episodes": 38, "episode_return_max": -769.3776071687564, "episode_return_min": -4412.314230016656, "episode_return_mean": -2618.458133847929, "episodes_this_iter": 38}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 537749, "num_agent_steps_trained": 537749, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.96103791574156, "num_env_steps_trained_throughput_per_sec": 72.96103791574156, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 537749, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 537749, "timers": {"training_iteration_time_ms": 52506.577, "restore_workers_time_ms": 0.027, "training_step_time_ms": 52506.506, "sample_time_ms": 3240.917, "learn_time_ms": 49208.512, "learn_throughput": 81.287, "synch_weights_time_ms": 54.154}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 537749, "num_agent_steps_trained": 537749}, "done": false, "training_iteration": 30, "trial_id": "efc54_00000", "date": "2024-07-24_19-07-55", "timestamp": 1721828275, "time_this_iter_s": 54.83482885360718, "time_total_s": 1674.0315368175507, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x717b99524f70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1674.0315368175507, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 9.752564102564103, "ram_util_percent": 23.59999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 129.4650743101086, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.0010000000000000005, "total_loss": 4.941972914603527, "policy_loss": -0.003515296886155486, "vf_loss": 4.960762833092959, "vf_explained_var": 0.979642892065849, "kl": 0.01698679985314414, "entropy": 1.909665467660239, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.33587786259542, "num_grad_updates_lifetime": 128415.5, "diff_num_grad_updates_vs_sampler_policy": 1964.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 554430, "num_agent_steps_trained": 554430}, "env_runners": {"episode_reward_max": -785.0656218300188, "episode_reward_min": -4176.303776367118, "episode_reward_mean": -2543.8277851255966, "episode_len_mean": 149.21, "episode_media": {}, "episodes_timesteps_total": 14921, "policy_reward_min": {"policy_0": -1439.7621403655246}, "policy_reward_max": {"policy_0": 3.2978874995199328}, "policy_reward_mean": {"policy_0": -508.76555702511934}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2561.1428638309767, -2585.1072008369624, -2750.5599687290114, -3023.46114973507, -2772.428879760893, -1434.2678422859424, -3038.860519567817, -3788.6755584202865, -2031.633060552646, -1806.1450061488442, -2339.3373583498387, -2291.0103444991873, -1797.364411803107, -1636.5189415142634, -3014.734310638269, -2085.3263730932827, -2659.6020707011535, -2917.591794266028, -1568.257270214743, -2668.757968602871, -2717.370478228429, -2981.176321444984, -2736.69487472252, -2240.9292835289225, -2828.5625328149013, -2493.2449415182805, -3485.714293938282, -1991.8401866232919, -2798.4730386216415, -3221.620408428176, -3914.737041445747, -4049.431488285655, -1527.6951877852698, -2211.432977795493, -2919.443745267407, -3717.4531772972296, -2283.068797843979, -3213.4110605978067, -2070.203881725101, -2347.947523935617, -2481.5522441557123, -2797.136118221652, -3326.5357650269257, -1898.3197259281121, -2058.8560246931493, -2319.756145992094, -2580.0519807517694, -2453.456023268396, -2420.3010379040934, -2167.6731074670515, -3002.422820910695, -2183.5604907768607, -2974.4741859947994, -2513.052226840253, -2663.041402571392, -2638.165344885739, -3115.384202232974, -2632.965487329654, -2112.882821478851, -2122.792500528402, -3776.1103551952438, -2311.149800911208, -2561.910161269672, -3225.653726028612, -2263.192109349101, -3291.1789118992438, -2583.8456378818096, -2885.035862048048, -2607.4478237032913, -2261.977197407202, -1203.6848897856985, -2941.220055975897, -2352.493012958325, -1801.6759759221618, -3047.128746233781, -1281.0664228509784, -2764.5121625627626, -1901.3591244643503, -3479.40662271087, -2209.5296486922616, -4176.303776367118, -2168.444557773003, -2843.855945499369, -3804.7354077896625, -3427.484842952721, -1087.746160068749, -1538.7551947551435, -2693.99521168944, -2870.546047212647, -4011.279772659266, -1829.3520024347968, -1413.2667738163973, -785.0656218300188, -2409.900163792903, -3069.4202375507066, -1389.0377673214641, -1683.1341446407691, -2122.506319830712, -1506.0505483390994, -3818.7059760266643], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 150, 116, 150, 150, 150, 150], "policy_policy_0_reward": [-394.55587074371647, -463.3878360066665, -881.4671049070461, -779.16876380361, -42.56328836993762, -1114.409764424165, -344.4933066577699, -403.2177910462553, -560.3931282157737, -162.5932104930011, -429.41653173504244, -837.1372267672496, -531.9049312488546, -866.0406897041034, -86.06058927375936, -301.9908222399271, -525.9633935649741, -1281.416274747075, -529.0309829926899, -385.05967619040445, -220.13408072499786, -653.416315035491, -628.3515488842284, -866.3571768424255, -404.16975827375035, -821.8421347832115, -118.80217390196172, -182.12059301413697, -133.24419080694594, -178.2587497796855, -22.22692062532909, -747.0426042936955, -774.1064290049565, -488.95133092522576, -1006.5332347186094, -1025.022172712535, -352.2214314628143, -1439.7621403655246, -160.627172718361, -811.0426411610543, -182.22347201893282, -882.0754602824514, -319.5302476709394, -446.4432644764516, -201.3606161038698, -576.7669284771434, -408.8183195583334, -452.4982727422071, -198.53551982280396, -169.52596554835566, -99.31011938518286, -106.61107719300351, -1380.495787051775, -7.287922279086771, -745.6324524407879, -701.9124790263882, -903.9909526593391, -612.1932541993581, -27.242001623044267, -45.671656991058036, -76.8929046225875, -751.1072965481524, -198.48122539395453, -516.9467340217002, -253.93625121671295, -9.996812576751257, -175.98617059080948, -19.66959361051807, -930.1228430194172, -500.74352171676884, -111.05859391572187, -915.9324222470574, -444.2488664177296, -790.7651264603642, -752.7293015973968, -814.8074270065603, -261.17479924117697, -166.54374565871683, -178.43970367976303, -664.3606975070654, -933.784994726302, -538.7234679285328, -530.2798399336317, -247.9719929697973, -408.84177514288916, -784.0730473652799, -87.15925521691041, -943.1668218516121, -754.017314843638, -349.17535498858916, -670.5695963588048, -371.24773617759837, -31.58111669671191, -38.52609514810543, -456.3327258335227, -291.9631821549583, -1222.4553648400763, -194.2826826827521, -104.65527690444374, -855.4014620206408, -653.5279029086053, -838.8482868852453, -982.8368507755526, -12.761514716189875, -229.39592294283614, -811.2356277170489, -747.0853973505183, -710.133894737033, -91.6272787079425, -621.0941229324409, -413.4841726857599, -875.8714599486862, -493.1213288685375, -215.70192573111507, -738.5159874884212, -634.6778724710209, -654.6330042669009, -32.518157808092596, -52.15818772816767, -866.9420612547405, -934.4835398690574, -877.1738050765589, -76.03268371054098, -17.06826997884139, -923.8042341799035, -962.0661103955312, -12.676046196215287, -107.21463891499307, -151.2854070848048, -1260.0027389267354, -824.1705770627149, -618.5003383582863, -792.5088471595138, -275.8191844230839, -974.7153469346829, -37.106207198058, -466.1450952637268, -774.9671069200926, -509.64643712731566, -203.97534011409687, -765.6839225905946, -161.30180576254477, -1033.480927711406, -738.4418931556141, -99.5644894014803, -192.45889772288297, -1074.6519266555474, -347.5885835904456, -368.1592290275088, -1238.7617714317917, -1137.7571011268637, -820.0598206573148, -658.3814844357969, -550.9192635792541, -747.6193716465123, -283.471022634451, -1151.1383241901633, -838.580539266956, -709.7616497031412, -1066.4799524909472, -514.1734377843411, -53.20235507011518, -15.540117001717695, -847.5637572224924, -97.21552070660434, -545.6274405040618, -554.9614814390252, -976.6777028298951, -40.204278591867926, -93.96207443064435, -284.8678627995797, -1045.3557421669527, -100.18073835737812, -761.312039945537, -727.7273619979577, -884.2356547206107, -1087.726261593899, -354.98703060226507, -330.37016518231053, -1060.134065198146, -131.45485740721986, -721.3549391721863, -322.6892733224217, -475.1810947177414, -632.3886332244101, -644.2307805636902, -17.47377098063674, -828.5290474272454, -645.6882473418567, -1077.4892142843817, -344.872589458091, -493.60148417495736, -726.9224524310823, -311.125077313338, -193.68227834763434, -495.43691374006704, -991.7948462032566, -269.9132736188502, -369.3794104819, -221.4230798915436, -791.4813074606916, -54.18803017011144, -531.2276194037279, -219.03983842232194, -885.6154486988585, -389.1268144153137, -508.26194402305174, -758.403334367035, -568.211320041324, -573.132705374928, -58.07325130692988, -724.1941503757168, -874.7756745026984, -802.9120770016425, -866.5806118399363, -25.934918102041177, -187.78338411376745, -183.07017592172033, -814.2312707239679, -687.2999770666145, -793.2094020003592, -73.71367689509034, -44.37799095984055, -342.3016175840526, -805.2533372538069, -133.5964978196197, -590.6736741132695, -390.1317491528835, -389.05378816150085, -816.3004367448206, -770.7613516352519, -921.396668854153, -98.76414769397815, -666.5567904046738, -122.57302216371085, -129.99790178535056, -270.1016553364755, -652.4605494049403, -488.9738536802185, -911.922063061409, -214.5749066212567, -602.3771068843914, -74.32713051208863, -769.2224140293107, -759.7994798570478, -176.03906077486374, -647.0388772636375, -226.66508791880082, -1058.518108144994, -59.41197336475524, -743.1728919551425, -498.1784456548976, -378.2918536845157, -856.6245998775661, -526.1550297385753, -285.5342812564337, -692.3991971728145, -121.7125284305122, -1010.8197439881593, -73.09473992894219, -778.5052067200725, -746.3107488449074, -597.6507637516402, -719.3443892752854, -132.6630774028933, -1102.9871324382543, -27.981820983994634, -625.3713393631879, -223.13820360536326, -533.5737304494538, -515.974838285127, -639.7973936430077, -613.5174339896329, -531.7635031757981, -361.98823347782496, -634.0042512937757, -746.7898502467867, -327.81654246916645, -575.9499496580833, -353.6047512179221, -393.8576547231346, -1224.3593960311514, -401.7932890836232, -129.0817751877126, -966.2920872073541, -194.21651793070174, -392.228044162163, -717.765809786446, -811.5355652991353, -517.2195501512073, -354.3570011710231, -121.98174355325465, -347.44715035771503, -1238.3437571716124, -50.7531692252462, -410.4790255795221, -433.06654132949836, -356.00560679807404, -589.1821059766229, -334.0592208446847, -538.6974837603359, -573.5110132711784, -687.8009354983066, -974.4315444175813, -1001.6693782478358, -465.5852749958119, -279.61282220492984, -890.4919834339917, -565.3683548974271, -110.09136537904796, -738.0343334207423, -255.65436175285612, -651.7760830277351, -764.5993390858082, -151.84604398252586, -980.6383144570658, -381.5427553349632, -259.96934915543653, -563.1957369142856, -1040.307570166859, -602.3940354020441, -860.4650083121224, -166.61940582645462, -102.9493584374138, -530.7643013710657, -743.6986149997193, -367.6639845353963, -990.5734676415177, -952.1738914524883, -237.06895327012296, -235.63599029345363, -684.5344309085584, -1176.5914556704972, -69.90696063592166, -417.1768003733776, -704.0710929823699, 3.2978874995199328, -735.6450118872831, -759.4005663843648, -689.2170782935542, -1015.5306316605927, -703.3981131294081, -49.1394075459438, -819.4820487239465, -19.897622643400112, -614.8425117494642, -733.9317278788417, -30.333569538465607, -17.094119655103643, -865.7752685853255, -187.56438745111416, -334.4695321766401, -173.51802096528212, -148.21512651954328, -359.91782267311925, -437.9552172735014, -429.3054010123601, -303.9984276098996, -856.2701686046239, -913.6908414755114, -764.8920265652986, -214.0014602472991, -186.5930228347887, -355.2237888406398, -831.7827144703003, -694.8667792901122, 0.9421473377223205, -657.0736349810575, -343.32279860159207, -107.35491038712226, -1182.0648355769076, -209.93779627324528, -65.8288494231692, -410.62346479883684, -1178.6738001616206, -17.194557173091475, -423.693563558247, -13.97224567414176, -39.97006774428383, -786.2359887012138, -842.627969217346, -200.78824722407958, -654.65692671677, -476.3843486800624, -590.0546707245036, -564.9296738465948, -2.4068928423250187, -268.2511134414414, -784.0981116785662, -281.6733326554227, -539.7948124735359, -990.4755546756431, -42.219929594801876, -1308.318321703205, -598.5980042636854, -591.8062308294881, -755.4814040561547, -221.08483991238344, -487.43798026993255, -153.71919362430177, -1109.7270295567453, -1016.3647817113039, -60.80239301766095, -958.6686449345657, -1030.7409271468441, -251.32349497109288, -566.5739280121993, -86.0901645884151, -209.78766506814537, -1054.6693051331504, -458.916237790777, -843.0322686760105, -899.9404834548849, -65.49163923885922, -576.4753163388382, -879.0190060206373, -796.625155547926, -764.9602213105866, -118.18763833195038, -1245.9433865785652, -1088.464879614006, -542.0824951476696, -400.64712788462606, -871.8344165312884, -524.4559237751314, -60.65242790886258, -453.4052144308158, -292.4006193376379, -238.53359760416348, -42.75430078727042, -976.1053428004201, -187.11758690172218, -93.05884041116519, -276.817966559899, -5.655458081936848, -647.7941029057549, -629.5265237899258, -89.15341143323994, -418.47578760471447, -909.0453859558014, -5.8725199943496, -965.5841322136702, -605.8646844547109, -497.11881776411957, -796.1058927857956, -804.5140010954476, -571.8251028303182, -922.0431367477497, -842.0949711235245, -870.8025608622272, -645.8408603123951, -94.84715660762176, -105.19693667070914, -512.7557585106988, -470.71129033337326, -434.5235383085884, -62.63737276524063, -539.3980359608754, -113.04931550020058, -263.65851128149274, -54.075953861446294, -312.6071913799794, -244.2640829090556, -81.32521730150007, -92.79317637803648, -750.5567628696643, -969.0337677990085, -60.65705953496726, -585.768329084943, -43.88424450432177, -109.95632242379882, -770.3090215880853, -626.9473236485142, -811.3013194295899, -750.9062504607173, -435.28773991588315, -157.4454543720104, -118.56072082329713, -454.7156773330893, -223.02817487718406, -91.4372319966256, -612.8013798753498, -663.421100688295, -192.07043791152077, -123.40399416897779, -8.678907235995709, -205.20463242210158, -807.7651453875758, -697.3009909171537, -403.5566438678835, -24.34127274685499, -76.80438745010078, -348.8301520567465, -716.9280854573973, -339.1466506279999, -982.6792814817774, -778.6146516715254, -1099.172640138833, -323.74367979112964, -634.4957229433974]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5501524714203805, "mean_inference_ms": 1.7087350917896151, "mean_action_processing_ms": 0.8556823256373361, "mean_env_wait_ms": 10.342434635423592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013859748840332031, "StateBufferConnector_ms": 0.009848833084106445, "ViewRequirementAgentConnector_ms": 0.3450808525085449}, "num_episodes": 20, "episode_return_max": -785.0656218300188, "episode_return_min": -4176.303776367118, "episode_return_mean": -2543.8277851255966, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 554430, "num_agent_steps_trained": 554430, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.44072787654781, "num_env_steps_trained_throughput_per_sec": 72.44072787654781, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 554430, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 554430, "timers": {"training_iteration_time_ms": 54592.539, "restore_workers_time_ms": 0.027, "training_step_time_ms": 54592.468, "sample_time_ms": 3259.766, "learn_time_ms": 51275.968, "learn_throughput": 78.009, "synch_weights_time_ms": 53.838}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 554430, "num_agent_steps_trained": 554430}, "done": false, "training_iteration": 31, "trial_id": "efc54_00000", "date": "2024-07-24_19-08-50", "timestamp": 1721828330, "time_this_iter_s": 55.2300865650177, "time_total_s": 1729.2616233825684, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7ac700>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1729.2616233825684, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 9.849367088607597, "ram_util_percent": 23.59999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 137.5844113952637, "cur_kl_coeff": 0.2250000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.908417946434021, "policy_loss": -0.002430047676281538, "vf_loss": 4.925908871650696, "vf_explained_var": 0.981611678202947, "kl": 0.02022969819205658, "entropy": 1.9612565681775411, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.848, "num_grad_updates_lifetime": 132255.5, "diff_num_grad_updates_vs_sampler_policy": 1874.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 570411, "num_agent_steps_trained": 570411}, "env_runners": {"episode_reward_max": -785.0656218300188, "episode_reward_min": -4405.322865757155, "episode_reward_mean": -2583.5753997160864, "episode_len_mean": 149.21, "episode_media": {}, "episodes_timesteps_total": 14921, "policy_reward_min": {"policy_0": -1308.318321703205}, "policy_reward_max": {"policy_0": 3.2978874995199328}, "policy_reward_mean": {"policy_0": -516.7150799432172}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2736.69487472252, -2240.9292835289225, -2828.5625328149013, -2493.2449415182805, -3485.714293938282, -1991.8401866232919, -2798.4730386216415, -3221.620408428176, -3914.737041445747, -4049.431488285655, -1527.6951877852698, -2211.432977795493, -2919.443745267407, -3717.4531772972296, -2283.068797843979, -3213.4110605978067, -2070.203881725101, -2347.947523935617, -2481.5522441557123, -2797.136118221652, -3326.5357650269257, -1898.3197259281121, -2058.8560246931493, -2319.756145992094, -2580.0519807517694, -2453.456023268396, -2420.3010379040934, -2167.6731074670515, -3002.422820910695, -2183.5604907768607, -2974.4741859947994, -2513.052226840253, -2663.041402571392, -2638.165344885739, -3115.384202232974, -2632.965487329654, -2112.882821478851, -2122.792500528402, -3776.1103551952438, -2311.149800911208, -2561.910161269672, -3225.653726028612, -2263.192109349101, -3291.1789118992438, -2583.8456378818096, -2885.035862048048, -2607.4478237032913, -2261.977197407202, -1203.6848897856985, -2941.220055975897, -2352.493012958325, -1801.6759759221618, -3047.128746233781, -1281.0664228509784, -2764.5121625627626, -1901.3591244643503, -3479.40662271087, -2209.5296486922616, -4176.303776367118, -2168.444557773003, -2843.855945499369, -3804.7354077896625, -3427.484842952721, -1087.746160068749, -1538.7551947551435, -2693.99521168944, -2870.546047212647, -4011.279772659266, -1829.3520024347968, -1413.2667738163973, -785.0656218300188, -2409.900163792903, -3069.4202375507066, -1389.0377673214641, -1683.1341446407691, -2122.506319830712, -1506.0505483390994, -3818.7059760266643, -4201.221660599762, -4044.4096138757945, -2485.675170745976, -2230.081041215329, -1555.7713463721475, -4023.78880638588, -2406.2262692324343, -1869.1455847743152, -1966.0210384658958, -2221.3878415861636, -1682.5566664893604, -3159.8221355153155, -1829.3079776154914, -2398.4007689492973, -2808.255217809435, -1785.566167284869, -2074.840870665873, -2690.963789620093, -3255.23287340806, -2160.797401163843, -4405.322865757155, -3189.2960447410983], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-413.4841726857599, -875.8714599486862, -493.1213288685375, -215.70192573111507, -738.5159874884212, -634.6778724710209, -654.6330042669009, -32.518157808092596, -52.15818772816767, -866.9420612547405, -934.4835398690574, -877.1738050765589, -76.03268371054098, -17.06826997884139, -923.8042341799035, -962.0661103955312, -12.676046196215287, -107.21463891499307, -151.2854070848048, -1260.0027389267354, -824.1705770627149, -618.5003383582863, -792.5088471595138, -275.8191844230839, -974.7153469346829, -37.106207198058, -466.1450952637268, -774.9671069200926, -509.64643712731566, -203.97534011409687, -765.6839225905946, -161.30180576254477, -1033.480927711406, -738.4418931556141, -99.5644894014803, -192.45889772288297, -1074.6519266555474, -347.5885835904456, -368.1592290275088, -1238.7617714317917, -1137.7571011268637, -820.0598206573148, -658.3814844357969, -550.9192635792541, -747.6193716465123, -283.471022634451, -1151.1383241901633, -838.580539266956, -709.7616497031412, -1066.4799524909472, -514.1734377843411, -53.20235507011518, -15.540117001717695, -847.5637572224924, -97.21552070660434, -545.6274405040618, -554.9614814390252, -976.6777028298951, -40.204278591867926, -93.96207443064435, -284.8678627995797, -1045.3557421669527, -100.18073835737812, -761.312039945537, -727.7273619979577, -884.2356547206107, -1087.726261593899, -354.98703060226507, -330.37016518231053, -1060.134065198146, -131.45485740721986, -721.3549391721863, -322.6892733224217, -475.1810947177414, -632.3886332244101, -644.2307805636902, -17.47377098063674, -828.5290474272454, -645.6882473418567, -1077.4892142843817, -344.872589458091, -493.60148417495736, -726.9224524310823, -311.125077313338, -193.68227834763434, -495.43691374006704, -991.7948462032566, -269.9132736188502, -369.3794104819, -221.4230798915436, -791.4813074606916, -54.18803017011144, -531.2276194037279, -219.03983842232194, -885.6154486988585, -389.1268144153137, -508.26194402305174, -758.403334367035, -568.211320041324, -573.132705374928, -58.07325130692988, -724.1941503757168, -874.7756745026984, -802.9120770016425, -866.5806118399363, -25.934918102041177, -187.78338411376745, -183.07017592172033, -814.2312707239679, -687.2999770666145, -793.2094020003592, -73.71367689509034, -44.37799095984055, -342.3016175840526, -805.2533372538069, -133.5964978196197, -590.6736741132695, -390.1317491528835, -389.05378816150085, -816.3004367448206, -770.7613516352519, -921.396668854153, -98.76414769397815, -666.5567904046738, -122.57302216371085, -129.99790178535056, -270.1016553364755, -652.4605494049403, -488.9738536802185, -911.922063061409, -214.5749066212567, -602.3771068843914, -74.32713051208863, -769.2224140293107, -759.7994798570478, -176.03906077486374, -647.0388772636375, -226.66508791880082, -1058.518108144994, -59.41197336475524, -743.1728919551425, -498.1784456548976, -378.2918536845157, -856.6245998775661, -526.1550297385753, -285.5342812564337, -692.3991971728145, -121.7125284305122, -1010.8197439881593, -73.09473992894219, -778.5052067200725, -746.3107488449074, -597.6507637516402, -719.3443892752854, -132.6630774028933, -1102.9871324382543, -27.981820983994634, -625.3713393631879, -223.13820360536326, -533.5737304494538, -515.974838285127, -639.7973936430077, -613.5174339896329, -531.7635031757981, -361.98823347782496, -634.0042512937757, -746.7898502467867, -327.81654246916645, -575.9499496580833, -353.6047512179221, -393.8576547231346, -1224.3593960311514, -401.7932890836232, -129.0817751877126, -966.2920872073541, -194.21651793070174, -392.228044162163, -717.765809786446, -811.5355652991353, -517.2195501512073, -354.3570011710231, -121.98174355325465, -347.44715035771503, -1238.3437571716124, -50.7531692252462, -410.4790255795221, -433.06654132949836, -356.00560679807404, -589.1821059766229, -334.0592208446847, -538.6974837603359, -573.5110132711784, -687.8009354983066, -974.4315444175813, -1001.6693782478358, -465.5852749958119, -279.61282220492984, -890.4919834339917, -565.3683548974271, -110.09136537904796, -738.0343334207423, -255.65436175285612, -651.7760830277351, -764.5993390858082, -151.84604398252586, -980.6383144570658, -381.5427553349632, -259.96934915543653, -563.1957369142856, -1040.307570166859, -602.3940354020441, -860.4650083121224, -166.61940582645462, -102.9493584374138, -530.7643013710657, -743.6986149997193, -367.6639845353963, -990.5734676415177, -952.1738914524883, -237.06895327012296, -235.63599029345363, -684.5344309085584, -1176.5914556704972, -69.90696063592166, -417.1768003733776, -704.0710929823699, 3.2978874995199328, -735.6450118872831, -759.4005663843648, -689.2170782935542, -1015.5306316605927, -703.3981131294081, -49.1394075459438, -819.4820487239465, -19.897622643400112, -614.8425117494642, -733.9317278788417, -30.333569538465607, -17.094119655103643, -865.7752685853255, -187.56438745111416, -334.4695321766401, -173.51802096528212, -148.21512651954328, -359.91782267311925, -437.9552172735014, -429.3054010123601, -303.9984276098996, -856.2701686046239, -913.6908414755114, -764.8920265652986, -214.0014602472991, -186.5930228347887, -355.2237888406398, -831.7827144703003, -694.8667792901122, 0.9421473377223205, -657.0736349810575, -343.32279860159207, -107.35491038712226, -1182.0648355769076, -209.93779627324528, -65.8288494231692, -410.62346479883684, -1178.6738001616206, -17.194557173091475, -423.693563558247, -13.97224567414176, -39.97006774428383, -786.2359887012138, -842.627969217346, -200.78824722407958, -654.65692671677, -476.3843486800624, -590.0546707245036, -564.9296738465948, -2.4068928423250187, -268.2511134414414, -784.0981116785662, -281.6733326554227, -539.7948124735359, -990.4755546756431, -42.219929594801876, -1308.318321703205, -598.5980042636854, -591.8062308294881, -755.4814040561547, -221.08483991238344, -487.43798026993255, -153.71919362430177, -1109.7270295567453, -1016.3647817113039, -60.80239301766095, -958.6686449345657, -1030.7409271468441, -251.32349497109288, -566.5739280121993, -86.0901645884151, -209.78766506814537, -1054.6693051331504, -458.916237790777, -843.0322686760105, -899.9404834548849, -65.49163923885922, -576.4753163388382, -879.0190060206373, -796.625155547926, -764.9602213105866, -118.18763833195038, -1245.9433865785652, -1088.464879614006, -542.0824951476696, -400.64712788462606, -871.8344165312884, -524.4559237751314, -60.65242790886258, -453.4052144308158, -292.4006193376379, -238.53359760416348, -42.75430078727042, -976.1053428004201, -187.11758690172218, -93.05884041116519, -276.817966559899, -5.655458081936848, -647.7941029057549, -629.5265237899258, -89.15341143323994, -418.47578760471447, -909.0453859558014, -5.8725199943496, -965.5841322136702, -605.8646844547109, -497.11881776411957, -796.1058927857956, -804.5140010954476, -571.8251028303182, -922.0431367477497, -842.0949711235245, -870.8025608622272, -645.8408603123951, -94.84715660762176, -105.19693667070914, -512.7557585106988, -470.71129033337326, -434.5235383085884, -62.63737276524063, -539.3980359608754, -113.04931550020058, -263.65851128149274, -54.075953861446294, -312.6071913799794, -244.2640829090556, -81.32521730150007, -92.79317637803648, -750.5567628696643, -969.0337677990085, -60.65705953496726, -585.768329084943, -43.88424450432177, -109.95632242379882, -770.3090215880853, -626.9473236485142, -811.3013194295899, -750.9062504607173, -435.28773991588315, -157.4454543720104, -118.56072082329713, -454.7156773330893, -223.02817487718406, -91.4372319966256, -612.8013798753498, -663.421100688295, -192.07043791152077, -123.40399416897779, -8.678907235995709, -205.20463242210158, -807.7651453875758, -697.3009909171537, -403.5566438678835, -24.34127274685499, -76.80438745010078, -348.8301520567465, -716.9280854573973, -339.1466506279999, -982.6792814817774, -778.6146516715254, -1099.172640138833, -323.74367979112964, -634.4957229433974, -464.1860870917403, -1071.3220239950883, -965.4086120425309, -517.2717543201461, -1183.033183150256, -895.7544939100967, -885.8569097591212, -547.8077392696287, -1127.5812399311799, -587.4092310057663, -33.750227497161035, -186.1971960636101, -493.92084518611443, -799.4751649665782, -972.3317370325127, -355.1137793047981, -136.53563856293383, -797.1289245630456, -856.7844392651368, -84.5182595194149, -262.9771325432715, -461.20741832485163, -180.35562837642345, -596.7429737823464, -54.48819334525617, -657.2883763241409, -691.5615655626123, -833.7592652821633, -1003.87495818032, -837.3046410366417, -132.6098288770117, -665.5706723594176, -28.973544292553402, -880.8481994391144, -698.2240242643371, -300.6180793142307, -860.2208534007966, -253.42256057075073, -196.14553343588406, -258.7385580526536, -498.3381802827156, -152.2579609473507, -341.93487878574354, -209.93229897044716, -763.5577194796397, -1249.8222196008917, -91.91900562729394, -110.27389211965114, -32.92367297849106, -736.4490512598375, -678.8324942426763, -41.55208349235472, -81.75160411347905, -686.1626641316257, -194.25782050922473, -897.7054291956302, -316.3353999491197, -973.2041073163034, -426.08801011325284, -546.4891889410118, -94.18945689618711, -207.63105507790738, -29.408539439857922, -482.8495911949875, -1015.2293350065534, -1013.8960960974024, -315.93693059874556, -66.83406008980698, -709.7269989566707, -292.0066832066711, -986.6180693308207, -410.8461757985341, -206.39185900146364, -417.9886738932094, -786.4104397854072, -21.22581058879164, -595.0153317477684, -763.7440359628132, -318.53824612428866, -87.0427428612075, -373.11097181805775, -432.2401089631102, -458.02270375117115, -22.033361366412386, -789.4337247671226, -634.1765172476638, -991.9421468211904, -69.73779640047636, -40.07955575439032, -955.0277733963736, -844.4895697865527, -786.5578830596123, -808.459644584708, -576.653936387252, -239.07183958993429, -260.52422885854025, -422.20454688400935, -705.8352454065121, -731.8546223835735, -40.37875763120883, -850.6632018614149, -602.8261115972763, -1102.0087640179574, -909.6359101245044, -940.1888781560025, -1048.2943422830467, -865.2628302592085, -154.1007385179893, -862.7927532400198, -258.845380440834]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5465006682349831, "mean_inference_ms": 1.7076892866075317, "mean_action_processing_ms": 0.852290232420989, "mean_env_wait_ms": 10.320494337456042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013471364974975586, "StateBufferConnector_ms": 0.009892702102661133, "ViewRequirementAgentConnector_ms": 0.34746742248535156}, "num_episodes": 22, "episode_return_max": -785.0656218300188, "episode_return_min": -4405.322865757155, "episode_return_mean": -2583.5753997160864, "episodes_this_iter": 22}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 570411, "num_agent_steps_trained": 570411, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 78.85919916625885, "num_env_steps_trained_throughput_per_sec": 78.85919916625885, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 570411, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 570411, "timers": {"training_iteration_time_ms": 54265.17, "restore_workers_time_ms": 0.028, "training_step_time_ms": 54265.098, "sample_time_ms": 3255.321, "learn_time_ms": 50953.934, "learn_throughput": 78.502, "synch_weights_time_ms": 53.033}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 570411, "num_agent_steps_trained": 570411}, "done": false, "training_iteration": 32, "trial_id": "efc54_00000", "date": "2024-07-24_19-09-41", "timestamp": 1721828381, "time_this_iter_s": 50.735595703125, "time_total_s": 1779.9972190856934, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7e9510>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1779.9972190856934, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 10.083333333333334, "ram_util_percent": 23.599999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 122.81104179623644, "cur_kl_coeff": 0.33750000000000013, "cur_lr": 0.0010000000000000005, "total_loss": 5.041562854982641, "policy_loss": -0.002076760043646152, "vf_loss": 5.058114440075673, "vf_explained_var": 0.9776496237646924, "kl": 0.01622644144845696, "entropy": 1.9951255369650476, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.61313868613139, "num_grad_updates_lifetime": 136185.5, "diff_num_grad_updates_vs_sampler_policy": 2054.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 587894, "num_agent_steps_trained": 587894}, "env_runners": {"episode_reward_max": -785.0656218300188, "episode_reward_min": -4405.322865757155, "episode_reward_mean": -2520.98251974332, "episode_len_mean": 149.04, "episode_media": {}, "episodes_timesteps_total": 14904, "policy_reward_min": {"policy_0": -1372.5036860762696}, "policy_reward_max": {"policy_0": 3.2978874995199328}, "policy_reward_mean": {"policy_0": -504.1965039486642}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3776.1103551952438, -2311.149800911208, -2561.910161269672, -3225.653726028612, -2263.192109349101, -3291.1789118992438, -2583.8456378818096, -2885.035862048048, -2607.4478237032913, -2261.977197407202, -1203.6848897856985, -2941.220055975897, -2352.493012958325, -1801.6759759221618, -3047.128746233781, -1281.0664228509784, -2764.5121625627626, -1901.3591244643503, -3479.40662271087, -2209.5296486922616, -4176.303776367118, -2168.444557773003, -2843.855945499369, -3804.7354077896625, -3427.484842952721, -1087.746160068749, -1538.7551947551435, -2693.99521168944, -2870.546047212647, -4011.279772659266, -1829.3520024347968, -1413.2667738163973, -785.0656218300188, -2409.900163792903, -3069.4202375507066, -1389.0377673214641, -1683.1341446407691, -2122.506319830712, -1506.0505483390994, -3818.7059760266643, -4201.221660599762, -4044.4096138757945, -2485.675170745976, -2230.081041215329, -1555.7713463721475, -4023.78880638588, -2406.2262692324343, -1869.1455847743152, -1966.0210384658958, -2221.3878415861636, -1682.5566664893604, -3159.8221355153155, -1829.3079776154914, -2398.4007689492973, -2808.255217809435, -1785.566167284869, -2074.840870665873, -2690.963789620093, -3255.23287340806, -2160.797401163843, -4405.322865757155, -3189.2960447410983, -1738.9119410001986, -2036.327636107588, -3344.425914128675, -1844.5897029230662, -1214.3871127154573, -2179.308320341312, -2463.8123573664507, -3093.78965651564, -3254.4462179972206, -2157.3756611532276, -3598.084781031047, -2363.7172872792585, -2637.2701515653876, -1292.4247603954068, -1624.3548800835708, -2951.0503194211333, -2777.764848537307, -2633.9316231174143, -2209.1122854239698, -2204.8303266733483, -2950.4241064756875, -3039.637747403801, -2584.3171777026137, -1840.2797875066171, -1732.6056920591898, -1839.2431302320726, -2332.666314943873, -3377.955757940212, -2975.6405032282455, -2371.6248779550706, -2946.0779544821976, -3215.3533316657627, -2611.995559077799, -1421.1513510083341, -2852.813194036584, -2289.5420955167265, -3076.923785982854, -3176.827950862969], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 141, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-538.6974837603359, -573.5110132711784, -687.8009354983066, -974.4315444175813, -1001.6693782478358, -465.5852749958119, -279.61282220492984, -890.4919834339917, -565.3683548974271, -110.09136537904796, -738.0343334207423, -255.65436175285612, -651.7760830277351, -764.5993390858082, -151.84604398252586, -980.6383144570658, -381.5427553349632, -259.96934915543653, -563.1957369142856, -1040.307570166859, -602.3940354020441, -860.4650083121224, -166.61940582645462, -102.9493584374138, -530.7643013710657, -743.6986149997193, -367.6639845353963, -990.5734676415177, -952.1738914524883, -237.06895327012296, -235.63599029345363, -684.5344309085584, -1176.5914556704972, -69.90696063592166, -417.1768003733776, -704.0710929823699, 3.2978874995199328, -735.6450118872831, -759.4005663843648, -689.2170782935542, -1015.5306316605927, -703.3981131294081, -49.1394075459438, -819.4820487239465, -19.897622643400112, -614.8425117494642, -733.9317278788417, -30.333569538465607, -17.094119655103643, -865.7752685853255, -187.56438745111416, -334.4695321766401, -173.51802096528212, -148.21512651954328, -359.91782267311925, -437.9552172735014, -429.3054010123601, -303.9984276098996, -856.2701686046239, -913.6908414755114, -764.8920265652986, -214.0014602472991, -186.5930228347887, -355.2237888406398, -831.7827144703003, -694.8667792901122, 0.9421473377223205, -657.0736349810575, -343.32279860159207, -107.35491038712226, -1182.0648355769076, -209.93779627324528, -65.8288494231692, -410.62346479883684, -1178.6738001616206, -17.194557173091475, -423.693563558247, -13.97224567414176, -39.97006774428383, -786.2359887012138, -842.627969217346, -200.78824722407958, -654.65692671677, -476.3843486800624, -590.0546707245036, -564.9296738465948, -2.4068928423250187, -268.2511134414414, -784.0981116785662, -281.6733326554227, -539.7948124735359, -990.4755546756431, -42.219929594801876, -1308.318321703205, -598.5980042636854, -591.8062308294881, -755.4814040561547, -221.08483991238344, -487.43798026993255, -153.71919362430177, -1109.7270295567453, -1016.3647817113039, -60.80239301766095, -958.6686449345657, -1030.7409271468441, -251.32349497109288, -566.5739280121993, -86.0901645884151, -209.78766506814537, -1054.6693051331504, -458.916237790777, -843.0322686760105, -899.9404834548849, -65.49163923885922, -576.4753163388382, -879.0190060206373, -796.625155547926, -764.9602213105866, -118.18763833195038, -1245.9433865785652, -1088.464879614006, -542.0824951476696, -400.64712788462606, -871.8344165312884, -524.4559237751314, -60.65242790886258, -453.4052144308158, -292.4006193376379, -238.53359760416348, -42.75430078727042, -976.1053428004201, -187.11758690172218, -93.05884041116519, -276.817966559899, -5.655458081936848, -647.7941029057549, -629.5265237899258, -89.15341143323994, -418.47578760471447, -909.0453859558014, -5.8725199943496, -965.5841322136702, -605.8646844547109, -497.11881776411957, -796.1058927857956, -804.5140010954476, -571.8251028303182, -922.0431367477497, -842.0949711235245, -870.8025608622272, -645.8408603123951, -94.84715660762176, -105.19693667070914, -512.7557585106988, -470.71129033337326, -434.5235383085884, -62.63737276524063, -539.3980359608754, -113.04931550020058, -263.65851128149274, -54.075953861446294, -312.6071913799794, -244.2640829090556, -81.32521730150007, -92.79317637803648, -750.5567628696643, -969.0337677990085, -60.65705953496726, -585.768329084943, -43.88424450432177, -109.95632242379882, -770.3090215880853, -626.9473236485142, -811.3013194295899, -750.9062504607173, -435.28773991588315, -157.4454543720104, -118.56072082329713, -454.7156773330893, -223.02817487718406, -91.4372319966256, -612.8013798753498, -663.421100688295, -192.07043791152077, -123.40399416897779, -8.678907235995709, -205.20463242210158, -807.7651453875758, -697.3009909171537, -403.5566438678835, -24.34127274685499, -76.80438745010078, -348.8301520567465, -716.9280854573973, -339.1466506279999, -982.6792814817774, -778.6146516715254, -1099.172640138833, -323.74367979112964, -634.4957229433974, -464.1860870917403, -1071.3220239950883, -965.4086120425309, -517.2717543201461, -1183.033183150256, -895.7544939100967, -885.8569097591212, -547.8077392696287, -1127.5812399311799, -587.4092310057663, -33.750227497161035, -186.1971960636101, -493.92084518611443, -799.4751649665782, -972.3317370325127, -355.1137793047981, -136.53563856293383, -797.1289245630456, -856.7844392651368, -84.5182595194149, -262.9771325432715, -461.20741832485163, -180.35562837642345, -596.7429737823464, -54.48819334525617, -657.2883763241409, -691.5615655626123, -833.7592652821633, -1003.87495818032, -837.3046410366417, -132.6098288770117, -665.5706723594176, -28.973544292553402, -880.8481994391144, -698.2240242643371, -300.6180793142307, -860.2208534007966, -253.42256057075073, -196.14553343588406, -258.7385580526536, -498.3381802827156, -152.2579609473507, -341.93487878574354, -209.93229897044716, -763.5577194796397, -1249.8222196008917, -91.91900562729394, -110.27389211965114, -32.92367297849106, -736.4490512598375, -678.8324942426763, -41.55208349235472, -81.75160411347905, -686.1626641316257, -194.25782050922473, -897.7054291956302, -316.3353999491197, -973.2041073163034, -426.08801011325284, -546.4891889410118, -94.18945689618711, -207.63105507790738, -29.408539439857922, -482.8495911949875, -1015.2293350065534, -1013.8960960974024, -315.93693059874556, -66.83406008980698, -709.7269989566707, -292.0066832066711, -986.6180693308207, -410.8461757985341, -206.39185900146364, -417.9886738932094, -786.4104397854072, -21.22581058879164, -595.0153317477684, -763.7440359628132, -318.53824612428866, -87.0427428612075, -373.11097181805775, -432.2401089631102, -458.02270375117115, -22.033361366412386, -789.4337247671226, -634.1765172476638, -991.9421468211904, -69.73779640047636, -40.07955575439032, -955.0277733963736, -844.4895697865527, -786.5578830596123, -808.459644584708, -576.653936387252, -239.07183958993429, -260.52422885854025, -422.20454688400935, -705.8352454065121, -731.8546223835735, -40.37875763120883, -850.6632018614149, -602.8261115972763, -1102.0087640179574, -909.6359101245044, -940.1888781560025, -1048.2943422830467, -865.2628302592085, -154.1007385179893, -862.7927532400198, -258.845380440834, -17.21383862106011, -296.3241672437104, -1011.6387682752526, -276.26446440066803, -137.47070245950857, -634.5155384423624, -130.5910116126026, -76.10793260984906, -975.7287924488767, -219.38436099389597, -145.20691373155177, -311.72817490536346, -950.9409444583948, -984.2127167785819, -952.3371642547863, -178.68473393185783, -464.22389862586436, -859.3496727512717, -103.96989152632703, -238.36150608774489, -232.56883560364997, -159.98561992529548, -116.54964405710328, -658.8903200236338, -46.392693105774235, -849.1322361762944, -73.53765306375992, -735.8066024014506, -12.079845722552102, -508.75198297725643, -378.35778315140664, -959.0585699732828, -61.129973478170236, -114.08833126468237, -951.1776994989098, -975.6946809981093, -319.60373323970015, -104.55911207847393, -774.5782703752517, -919.353859824105, -510.5128115410824, -671.4616535422977, -1372.5036860762696, -657.9998374021693, -41.96822943540408, -358.0575015200785, -860.8736362651176, -218.84144814552, -74.50955236434878, -645.0935228581624, -108.33106932457001, -933.5449533171383, -689.9540437754943, -918.1280229493508, -948.1266916644955, -386.0309339000481, -529.3297042463889, -573.2769098952281, -476.5711896886923, -398.5085495489012, -669.9587237633946, -173.1012568877739, -982.8720664980078, -72.07738386894938, -739.2607205472598, -317.67307011842223, -316.26398501480526, -494.2200232068073, -73.31331510653081, -90.95436694884215, -81.74332928548503, -7.718804505572502, -599.8651691531101, -40.94192182893124, -894.0856553104719, -361.5024762491516, -496.79905447061475, -108.90963118795383, -831.4217860399555, -1152.4173714734563, -457.63019402500987, -92.48642433838177, -862.1229380522169, -745.3635633044887, -620.1617288172125, -362.7630407948526, -1186.073057061152, -801.006163503392, -19.628201945560722, -264.46115981245777, -1153.5983842365263, -114.71049482439035, -417.85865859076404, -451.75392749490834, -71.19082027737947, -714.7530082306914, -73.01541650235012, -938.3428627527616, -445.2195486315495, -33.499490555998335, -924.0282107219272, -536.3158770072515, -124.98787304237058, -209.35553539505256, -1155.7366103090865, -898.9456832271509, -619.7849658096923, -518.3645835446722, -25.394356265393476, -977.148158556892, -281.37603278859314, -434.06270790303523, -823.617665318433, -605.5281408256569, -439.732630866894, -469.82067893735507, -54.944027739963225, -387.7585139700722, -191.12805235517635, -736.6285145040505, -482.97217475369973, -73.95780499850814, -575.9042405556277, -295.1491597221918, -304.62231202916234, -753.3273112981797, -405.4646707184119, -221.9020383808417, -207.73318853240784, -250.81592130223356, -237.02488787002144, -655.1311719597148, -17.712205893615607, -171.11735208286265, -1251.6806971376589, -453.7483938758054, -548.3761888448357, -914.3932526713933, -351.5392609008977, -1109.8986616472814, -972.3389402083922, -157.60478396513253, -7.9078469587342255, -928.9991358786748, -908.7897962173126, -562.2696371545749, -864.0212851185381, -2.3791939766054813, -35.167106770188646, -907.7876549351632, -1019.6292595602949, -1004.1705948444113, -203.37896469266107, -622.3347253444111, -96.56441004041739, -171.3336692977857, -833.0166784780218, -78.56563288667255, -1230.5064809142586, -901.930870089025, -211.0418778551332, -747.9462541944338, -707.8642343983114, -610.9104596316843, -334.2327329982404, -326.22261277384877, -297.78044164677164, -154.24454991717275, -167.86861645453087, -475.03513021601003, -211.9681366156199, -309.6758888290213, -108.46881245743401, -1253.7091817150958, -968.9911744194119, -877.5529878895928, -899.4245822988538, -90.88212469249783, -186.8970079086261, -234.78539272715756, -1104.7599608039877, -761.6512127074797, -768.0686954433173, -220.4556442231238, -221.98827280494507, -66.03961210863652, -862.2202189857182, -176.51505385997038, -1234.7751836445877, -837.277882264055]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5457322361282104, "mean_inference_ms": 1.7102249521237582, "mean_action_processing_ms": 0.8486887360156998, "mean_env_wait_ms": 10.314254457579718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013044118881225586, "StateBufferConnector_ms": 0.00957179069519043, "ViewRequirementAgentConnector_ms": 0.3317070007324219}, "num_episodes": 38, "episode_return_max": -785.0656218300188, "episode_return_min": -4405.322865757155, "episode_return_mean": -2520.98251974332, "episodes_this_iter": 38}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 587894, "num_agent_steps_trained": 587894, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.46613726072539, "num_env_steps_trained_throughput_per_sec": 84.46613726072539, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 587894, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 587894, "timers": {"training_iteration_time_ms": 53508.402, "restore_workers_time_ms": 0.026, "training_step_time_ms": 53508.333, "sample_time_ms": 3237.619, "learn_time_ms": 50215.573, "learn_throughput": 79.657, "synch_weights_time_ms": 52.283}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 587894, "num_agent_steps_trained": 587894}, "done": false, "training_iteration": 33, "trial_id": "efc54_00000", "date": "2024-07-24_19-10-28", "timestamp": 1721828428, "time_this_iter_s": 47.367409467697144, "time_total_s": 1827.3646285533905, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7afc70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1827.3646285533905, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 10.367164179104478, "ram_util_percent": 23.60298507462686}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 113.14804280999452, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.159125012550454, "policy_loss": -0.003119040974916944, "vf_loss": 5.177032401805787, "vf_explained_var": 0.9718500410165061, "kl": 0.013436388785692964, "entropy": 1.932313492729908, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.80314960629921, "num_grad_updates_lifetime": 140145.5, "diff_num_grad_updates_vs_sampler_policy": 1904.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 604125, "num_agent_steps_trained": 604125}, "env_runners": {"episode_reward_max": -785.0656218300188, "episode_reward_min": -4405.322865757155, "episode_reward_mean": -2498.62567942236, "episode_len_mean": 148.67, "episode_media": {}, "episodes_timesteps_total": 14867, "policy_reward_min": {"policy_0": -1372.5036860762696}, "policy_reward_max": {"policy_0": 6.449749176192213}, "policy_reward_mean": {"policy_0": -499.725135884472}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4176.303776367118, -2168.444557773003, -2843.855945499369, -3804.7354077896625, -3427.484842952721, -1087.746160068749, -1538.7551947551435, -2693.99521168944, -2870.546047212647, -4011.279772659266, -1829.3520024347968, -1413.2667738163973, -785.0656218300188, -2409.900163792903, -3069.4202375507066, -1389.0377673214641, -1683.1341446407691, -2122.506319830712, -1506.0505483390994, -3818.7059760266643, -4201.221660599762, -4044.4096138757945, -2485.675170745976, -2230.081041215329, -1555.7713463721475, -4023.78880638588, -2406.2262692324343, -1869.1455847743152, -1966.0210384658958, -2221.3878415861636, -1682.5566664893604, -3159.8221355153155, -1829.3079776154914, -2398.4007689492973, -2808.255217809435, -1785.566167284869, -2074.840870665873, -2690.963789620093, -3255.23287340806, -2160.797401163843, -4405.322865757155, -3189.2960447410983, -1738.9119410001986, -2036.327636107588, -3344.425914128675, -1844.5897029230662, -1214.3871127154573, -2179.308320341312, -2463.8123573664507, -3093.78965651564, -3254.4462179972206, -2157.3756611532276, -3598.084781031047, -2363.7172872792585, -2637.2701515653876, -1292.4247603954068, -1624.3548800835708, -2951.0503194211333, -2777.764848537307, -2633.9316231174143, -2209.1122854239698, -2204.8303266733483, -2950.4241064756875, -3039.637747403801, -2584.3171777026137, -1840.2797875066171, -1732.6056920591898, -1839.2431302320726, -2332.666314943873, -3377.955757940212, -2975.6405032282455, -2371.6248779550706, -2946.0779544821976, -3215.3533316657627, -2611.995559077799, -1421.1513510083341, -2852.813194036584, -2289.5420955167265, -3076.923785982854, -3176.827950862969, -2678.3065364395775, -2122.1263391332245, -4008.5008414654003, -2628.806570995739, -1313.8779990040307, -2151.5751338256187, -1441.5136151510533, -3340.290972210051, -2327.641218121826, -1893.8205523391393, -2607.834921914518, -2716.9729083985544, -1325.62092478802, -2916.460965735644, -4043.1433827638125, -2280.891005928701, -1877.4144243995383, -2069.8106153011067, -1816.3317675471199, -2952.9535202918], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 141, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1109.7270295567453, -1016.3647817113039, -60.80239301766095, -958.6686449345657, -1030.7409271468441, -251.32349497109288, -566.5739280121993, -86.0901645884151, -209.78766506814537, -1054.6693051331504, -458.916237790777, -843.0322686760105, -899.9404834548849, -65.49163923885922, -576.4753163388382, -879.0190060206373, -796.625155547926, -764.9602213105866, -118.18763833195038, -1245.9433865785652, -1088.464879614006, -542.0824951476696, -400.64712788462606, -871.8344165312884, -524.4559237751314, -60.65242790886258, -453.4052144308158, -292.4006193376379, -238.53359760416348, -42.75430078727042, -976.1053428004201, -187.11758690172218, -93.05884041116519, -276.817966559899, -5.655458081936848, -647.7941029057549, -629.5265237899258, -89.15341143323994, -418.47578760471447, -909.0453859558014, -5.8725199943496, -965.5841322136702, -605.8646844547109, -497.11881776411957, -796.1058927857956, -804.5140010954476, -571.8251028303182, -922.0431367477497, -842.0949711235245, -870.8025608622272, -645.8408603123951, -94.84715660762176, -105.19693667070914, -512.7557585106988, -470.71129033337326, -434.5235383085884, -62.63737276524063, -539.3980359608754, -113.04931550020058, -263.65851128149274, -54.075953861446294, -312.6071913799794, -244.2640829090556, -81.32521730150007, -92.79317637803648, -750.5567628696643, -969.0337677990085, -60.65705953496726, -585.768329084943, -43.88424450432177, -109.95632242379882, -770.3090215880853, -626.9473236485142, -811.3013194295899, -750.9062504607173, -435.28773991588315, -157.4454543720104, -118.56072082329713, -454.7156773330893, -223.02817487718406, -91.4372319966256, -612.8013798753498, -663.421100688295, -192.07043791152077, -123.40399416897779, -8.678907235995709, -205.20463242210158, -807.7651453875758, -697.3009909171537, -403.5566438678835, -24.34127274685499, -76.80438745010078, -348.8301520567465, -716.9280854573973, -339.1466506279999, -982.6792814817774, -778.6146516715254, -1099.172640138833, -323.74367979112964, -634.4957229433974, -464.1860870917403, -1071.3220239950883, -965.4086120425309, -517.2717543201461, -1183.033183150256, -895.7544939100967, -885.8569097591212, -547.8077392696287, -1127.5812399311799, -587.4092310057663, -33.750227497161035, -186.1971960636101, -493.92084518611443, -799.4751649665782, -972.3317370325127, -355.1137793047981, -136.53563856293383, -797.1289245630456, -856.7844392651368, -84.5182595194149, -262.9771325432715, -461.20741832485163, -180.35562837642345, -596.7429737823464, -54.48819334525617, -657.2883763241409, -691.5615655626123, -833.7592652821633, -1003.87495818032, -837.3046410366417, -132.6098288770117, -665.5706723594176, -28.973544292553402, -880.8481994391144, -698.2240242643371, -300.6180793142307, -860.2208534007966, -253.42256057075073, -196.14553343588406, -258.7385580526536, -498.3381802827156, -152.2579609473507, -341.93487878574354, -209.93229897044716, -763.5577194796397, -1249.8222196008917, -91.91900562729394, -110.27389211965114, -32.92367297849106, -736.4490512598375, -678.8324942426763, -41.55208349235472, -81.75160411347905, -686.1626641316257, -194.25782050922473, -897.7054291956302, -316.3353999491197, -973.2041073163034, -426.08801011325284, -546.4891889410118, -94.18945689618711, -207.63105507790738, -29.408539439857922, -482.8495911949875, -1015.2293350065534, -1013.8960960974024, -315.93693059874556, -66.83406008980698, -709.7269989566707, -292.0066832066711, -986.6180693308207, -410.8461757985341, -206.39185900146364, -417.9886738932094, -786.4104397854072, -21.22581058879164, -595.0153317477684, -763.7440359628132, -318.53824612428866, -87.0427428612075, -373.11097181805775, -432.2401089631102, -458.02270375117115, -22.033361366412386, -789.4337247671226, -634.1765172476638, -991.9421468211904, -69.73779640047636, -40.07955575439032, -955.0277733963736, -844.4895697865527, -786.5578830596123, -808.459644584708, -576.653936387252, -239.07183958993429, -260.52422885854025, -422.20454688400935, -705.8352454065121, -731.8546223835735, -40.37875763120883, -850.6632018614149, -602.8261115972763, -1102.0087640179574, -909.6359101245044, -940.1888781560025, -1048.2943422830467, -865.2628302592085, -154.1007385179893, -862.7927532400198, -258.845380440834, -17.21383862106011, -296.3241672437104, -1011.6387682752526, -276.26446440066803, -137.47070245950857, -634.5155384423624, -130.5910116126026, -76.10793260984906, -975.7287924488767, -219.38436099389597, -145.20691373155177, -311.72817490536346, -950.9409444583948, -984.2127167785819, -952.3371642547863, -178.68473393185783, -464.22389862586436, -859.3496727512717, -103.96989152632703, -238.36150608774489, -232.56883560364997, -159.98561992529548, -116.54964405710328, -658.8903200236338, -46.392693105774235, -849.1322361762944, -73.53765306375992, -735.8066024014506, -12.079845722552102, -508.75198297725643, -378.35778315140664, -959.0585699732828, -61.129973478170236, -114.08833126468237, -951.1776994989098, -975.6946809981093, -319.60373323970015, -104.55911207847393, -774.5782703752517, -919.353859824105, -510.5128115410824, -671.4616535422977, -1372.5036860762696, -657.9998374021693, -41.96822943540408, -358.0575015200785, -860.8736362651176, -218.84144814552, -74.50955236434878, -645.0935228581624, -108.33106932457001, -933.5449533171383, -689.9540437754943, -918.1280229493508, -948.1266916644955, -386.0309339000481, -529.3297042463889, -573.2769098952281, -476.5711896886923, -398.5085495489012, -669.9587237633946, -173.1012568877739, -982.8720664980078, -72.07738386894938, -739.2607205472598, -317.67307011842223, -316.26398501480526, -494.2200232068073, -73.31331510653081, -90.95436694884215, -81.74332928548503, -7.718804505572502, -599.8651691531101, -40.94192182893124, -894.0856553104719, -361.5024762491516, -496.79905447061475, -108.90963118795383, -831.4217860399555, -1152.4173714734563, -457.63019402500987, -92.48642433838177, -862.1229380522169, -745.3635633044887, -620.1617288172125, -362.7630407948526, -1186.073057061152, -801.006163503392, -19.628201945560722, -264.46115981245777, -1153.5983842365263, -114.71049482439035, -417.85865859076404, -451.75392749490834, -71.19082027737947, -714.7530082306914, -73.01541650235012, -938.3428627527616, -445.2195486315495, -33.499490555998335, -924.0282107219272, -536.3158770072515, -124.98787304237058, -209.35553539505256, -1155.7366103090865, -898.9456832271509, -619.7849658096923, -518.3645835446722, -25.394356265393476, -977.148158556892, -281.37603278859314, -434.06270790303523, -823.617665318433, -605.5281408256569, -439.732630866894, -469.82067893735507, -54.944027739963225, -387.7585139700722, -191.12805235517635, -736.6285145040505, -482.97217475369973, -73.95780499850814, -575.9042405556277, -295.1491597221918, -304.62231202916234, -753.3273112981797, -405.4646707184119, -221.9020383808417, -207.73318853240784, -250.81592130223356, -237.02488787002144, -655.1311719597148, -17.712205893615607, -171.11735208286265, -1251.6806971376589, -453.7483938758054, -548.3761888448357, -914.3932526713933, -351.5392609008977, -1109.8986616472814, -972.3389402083922, -157.60478396513253, -7.9078469587342255, -928.9991358786748, -908.7897962173126, -562.2696371545749, -864.0212851185381, -2.3791939766054813, -35.167106770188646, -907.7876549351632, -1019.6292595602949, -1004.1705948444113, -203.37896469266107, -622.3347253444111, -96.56441004041739, -171.3336692977857, -833.0166784780218, -78.56563288667255, -1230.5064809142586, -901.930870089025, -211.0418778551332, -747.9462541944338, -707.8642343983114, -610.9104596316843, -334.2327329982404, -326.22261277384877, -297.78044164677164, -154.24454991717275, -167.86861645453087, -475.03513021601003, -211.9681366156199, -309.6758888290213, -108.46881245743401, -1253.7091817150958, -968.9911744194119, -877.5529878895928, -899.4245822988538, -90.88212469249783, -186.8970079086261, -234.78539272715756, -1104.7599608039877, -761.6512127074797, -768.0686954433173, -220.4556442231238, -221.98827280494507, -66.03961210863652, -862.2202189857182, -176.51505385997038, -1234.7751836445877, -837.277882264055, -246.58561545061966, -1010.4858342731721, -567.1702118303328, -473.0570511104959, -381.00782377495307, -315.3166773798164, -83.29636338016378, -866.1605785816413, -661.913022837306, -195.43969695429627, -783.9702985861718, -1008.0036060911905, -759.7889187155175, -585.6332768751214, -871.1047411974045, 6.449749176192213, -855.8571926143591, -72.53142356624906, -545.9317473637998, -1160.9359566275257, -333.4142575480326, -306.01045074739415, -168.2944237065393, -407.0370259311578, -99.12184107090546, -417.0929366603025, -217.96880047383263, -196.79253799482234, -141.02089255065258, -1178.699966146011, -30.207359649504827, -113.26037289446616, -230.71479793222255, -788.2588104333104, -279.07227424154985, -798.2394987714451, -752.779320428324, -834.737301028888, -939.1150836414989, -15.419768339894183, -656.5921913192984, -267.2111967972702, -212.09729990000642, -590.4634949872603, -601.2770351179921, -994.0632735094148, -645.5613008560739, -35.92331481462301, -63.29158752916674, -154.9810756298607, -75.74219417497999, -835.8911147522438, -998.8549440627562, -54.18349361332283, -643.1631753112141, -411.4845850385079, -709.2141519142486, -337.92555549675626, -662.6236163280508, -595.7249996209897, -364.2776797714405, -287.67153368592193, -467.0672801890712, -37.38716642749851, -169.2172647140873, -490.3118271979534, -936.8002688944403, -613.6002386467233, -863.3744975421855, -12.3741334543401, -1043.7847431492964, -744.9084597517842, -958.3144955903549, -367.9141796963411, -928.2215045760329, -304.5117255276739, -638.6814410599856, -253.67797947976692, -9.585133401690161, -1074.4347264595829, -564.5406313537384, -381.38532676129313, -479.69763704442346, -436.9759133151371, -14.814915924945748, -119.02382617067909, -239.19791661080865, -152.74595654911295, -891.6052692973875, -667.2376466731204, -554.163041344854, -65.41153271996603, -350.4599490331722, -550.4153313274808, -295.88191312164554, -940.1089311756134, -357.5313996020249, -633.3846046263235, -141.29933913184817, -880.6292457559864]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5393800062359304, "mean_inference_ms": 1.705753050464989, "mean_action_processing_ms": 0.8462512474199159, "mean_env_wait_ms": 10.270427052332614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012842416763305664, "StateBufferConnector_ms": 0.009569406509399414, "ViewRequirementAgentConnector_ms": 0.329998254776001}, "num_episodes": 20, "episode_return_max": -785.0656218300188, "episode_return_min": -4405.322865757155, "episode_return_mean": -2498.62567942236, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 604125, "num_agent_steps_trained": 604125, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 75.35834064624427, "num_env_steps_trained_throughput_per_sec": 75.35834064624427, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 604125, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 604125, "timers": {"training_iteration_time_ms": 53621.732, "restore_workers_time_ms": 0.027, "training_step_time_ms": 53621.662, "sample_time_ms": 3253.168, "learn_time_ms": 50311.612, "learn_throughput": 79.505, "synch_weights_time_ms": 54.001}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 604125, "num_agent_steps_trained": 604125}, "done": false, "training_iteration": 34, "trial_id": "efc54_00000", "date": "2024-07-24_19-11-21", "timestamp": 1721828481, "time_this_iter_s": 53.091041803359985, "time_total_s": 1880.4556703567505, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7ea0e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1880.4556703567505, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 9.873333333333333, "ram_util_percent": 23.599999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 123.88570133179657, "cur_kl_coeff": 0.3375, "cur_lr": 0.0010000000000000005, "total_loss": 4.944012354633913, "policy_loss": -0.0013158906484624366, "vf_loss": 4.960993736042841, "vf_explained_var": 0.9735998531644658, "kl": 0.014794918713286202, "entropy": 2.065879030252304, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.96899224806202, "num_grad_updates_lifetime": 143985.5, "diff_num_grad_updates_vs_sampler_policy": 1934.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 620633, "num_agent_steps_trained": 620633}, "env_runners": {"episode_reward_max": -1154.303600134032, "episode_reward_min": -4405.322865757155, "episode_reward_mean": -2457.2233603948407, "episode_len_mean": 149.12, "episode_media": {}, "episodes_timesteps_total": 14912, "policy_reward_min": {"policy_0": -1372.5036860762696}, "policy_reward_max": {"policy_0": 6.449749176192213}, "policy_reward_mean": {"policy_0": -491.44467207896815}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2485.675170745976, -2230.081041215329, -1555.7713463721475, -4023.78880638588, -2406.2262692324343, -1869.1455847743152, -1966.0210384658958, -2221.3878415861636, -1682.5566664893604, -3159.8221355153155, -1829.3079776154914, -2398.4007689492973, -2808.255217809435, -1785.566167284869, -2074.840870665873, -2690.963789620093, -3255.23287340806, -2160.797401163843, -4405.322865757155, -3189.2960447410983, -1738.9119410001986, -2036.327636107588, -3344.425914128675, -1844.5897029230662, -1214.3871127154573, -2179.308320341312, -2463.8123573664507, -3093.78965651564, -3254.4462179972206, -2157.3756611532276, -3598.084781031047, -2363.7172872792585, -2637.2701515653876, -1292.4247603954068, -1624.3548800835708, -2951.0503194211333, -2777.764848537307, -2633.9316231174143, -2209.1122854239698, -2204.8303266733483, -2950.4241064756875, -3039.637747403801, -2584.3171777026137, -1840.2797875066171, -1732.6056920591898, -1839.2431302320726, -2332.666314943873, -3377.955757940212, -2975.6405032282455, -2371.6248779550706, -2946.0779544821976, -3215.3533316657627, -2611.995559077799, -1421.1513510083341, -2852.813194036584, -2289.5420955167265, -3076.923785982854, -3176.827950862969, -2678.3065364395775, -2122.1263391332245, -4008.5008414654003, -2628.806570995739, -1313.8779990040307, -2151.5751338256187, -1441.5136151510533, -3340.290972210051, -2327.641218121826, -1893.8205523391393, -2607.834921914518, -2716.9729083985544, -1325.62092478802, -2916.460965735644, -4043.1433827638125, -2280.891005928701, -1877.4144243995383, -2069.8106153011067, -1816.3317675471199, -2952.9535202918, -2702.3177659908997, -2472.559900061425, -3835.924960004149, -1544.5362184220933, -2552.5633565506696, -1909.4670876750706, -2538.108093236563, -3209.5776598401767, -1771.3125013100323, -1640.5380567698096, -2861.604899661325, -2794.7707704280388, -1521.5120460415587, -1286.8292369376431, -2801.558245234789, -3046.0615045631657, -3093.618361864553, -2206.2349345219022, -2359.1387480384446, -3329.4672603667736, -2122.9806364211504, -1154.303600134032], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 141, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 121], "policy_policy_0_reward": [-33.750227497161035, -186.1971960636101, -493.92084518611443, -799.4751649665782, -972.3317370325127, -355.1137793047981, -136.53563856293383, -797.1289245630456, -856.7844392651368, -84.5182595194149, -262.9771325432715, -461.20741832485163, -180.35562837642345, -596.7429737823464, -54.48819334525617, -657.2883763241409, -691.5615655626123, -833.7592652821633, -1003.87495818032, -837.3046410366417, -132.6098288770117, -665.5706723594176, -28.973544292553402, -880.8481994391144, -698.2240242643371, -300.6180793142307, -860.2208534007966, -253.42256057075073, -196.14553343588406, -258.7385580526536, -498.3381802827156, -152.2579609473507, -341.93487878574354, -209.93229897044716, -763.5577194796397, -1249.8222196008917, -91.91900562729394, -110.27389211965114, -32.92367297849106, -736.4490512598375, -678.8324942426763, -41.55208349235472, -81.75160411347905, -686.1626641316257, -194.25782050922473, -897.7054291956302, -316.3353999491197, -973.2041073163034, -426.08801011325284, -546.4891889410118, -94.18945689618711, -207.63105507790738, -29.408539439857922, -482.8495911949875, -1015.2293350065534, -1013.8960960974024, -315.93693059874556, -66.83406008980698, -709.7269989566707, -292.0066832066711, -986.6180693308207, -410.8461757985341, -206.39185900146364, -417.9886738932094, -786.4104397854072, -21.22581058879164, -595.0153317477684, -763.7440359628132, -318.53824612428866, -87.0427428612075, -373.11097181805775, -432.2401089631102, -458.02270375117115, -22.033361366412386, -789.4337247671226, -634.1765172476638, -991.9421468211904, -69.73779640047636, -40.07955575439032, -955.0277733963736, -844.4895697865527, -786.5578830596123, -808.459644584708, -576.653936387252, -239.07183958993429, -260.52422885854025, -422.20454688400935, -705.8352454065121, -731.8546223835735, -40.37875763120883, -850.6632018614149, -602.8261115972763, -1102.0087640179574, -909.6359101245044, -940.1888781560025, -1048.2943422830467, -865.2628302592085, -154.1007385179893, -862.7927532400198, -258.845380440834, -17.21383862106011, -296.3241672437104, -1011.6387682752526, -276.26446440066803, -137.47070245950857, -634.5155384423624, -130.5910116126026, -76.10793260984906, -975.7287924488767, -219.38436099389597, -145.20691373155177, -311.72817490536346, -950.9409444583948, -984.2127167785819, -952.3371642547863, -178.68473393185783, -464.22389862586436, -859.3496727512717, -103.96989152632703, -238.36150608774489, -232.56883560364997, -159.98561992529548, -116.54964405710328, -658.8903200236338, -46.392693105774235, -849.1322361762944, -73.53765306375992, -735.8066024014506, -12.079845722552102, -508.75198297725643, -378.35778315140664, -959.0585699732828, -61.129973478170236, -114.08833126468237, -951.1776994989098, -975.6946809981093, -319.60373323970015, -104.55911207847393, -774.5782703752517, -919.353859824105, -510.5128115410824, -671.4616535422977, -1372.5036860762696, -657.9998374021693, -41.96822943540408, -358.0575015200785, -860.8736362651176, -218.84144814552, -74.50955236434878, -645.0935228581624, -108.33106932457001, -933.5449533171383, -689.9540437754943, -918.1280229493508, -948.1266916644955, -386.0309339000481, -529.3297042463889, -573.2769098952281, -476.5711896886923, -398.5085495489012, -669.9587237633946, -173.1012568877739, -982.8720664980078, -72.07738386894938, -739.2607205472598, -317.67307011842223, -316.26398501480526, -494.2200232068073, -73.31331510653081, -90.95436694884215, -81.74332928548503, -7.718804505572502, -599.8651691531101, -40.94192182893124, -894.0856553104719, -361.5024762491516, -496.79905447061475, -108.90963118795383, -831.4217860399555, -1152.4173714734563, -457.63019402500987, -92.48642433838177, -862.1229380522169, -745.3635633044887, -620.1617288172125, -362.7630407948526, -1186.073057061152, -801.006163503392, -19.628201945560722, -264.46115981245777, -1153.5983842365263, -114.71049482439035, -417.85865859076404, -451.75392749490834, -71.19082027737947, -714.7530082306914, -73.01541650235012, -938.3428627527616, -445.2195486315495, -33.499490555998335, -924.0282107219272, -536.3158770072515, -124.98787304237058, -209.35553539505256, -1155.7366103090865, -898.9456832271509, -619.7849658096923, -518.3645835446722, -25.394356265393476, -977.148158556892, -281.37603278859314, -434.06270790303523, -823.617665318433, -605.5281408256569, -439.732630866894, -469.82067893735507, -54.944027739963225, -387.7585139700722, -191.12805235517635, -736.6285145040505, -482.97217475369973, -73.95780499850814, -575.9042405556277, -295.1491597221918, -304.62231202916234, -753.3273112981797, -405.4646707184119, -221.9020383808417, -207.73318853240784, -250.81592130223356, -237.02488787002144, -655.1311719597148, -17.712205893615607, -171.11735208286265, -1251.6806971376589, -453.7483938758054, -548.3761888448357, -914.3932526713933, -351.5392609008977, -1109.8986616472814, -972.3389402083922, -157.60478396513253, -7.9078469587342255, -928.9991358786748, -908.7897962173126, -562.2696371545749, -864.0212851185381, -2.3791939766054813, -35.167106770188646, -907.7876549351632, -1019.6292595602949, -1004.1705948444113, -203.37896469266107, -622.3347253444111, -96.56441004041739, -171.3336692977857, -833.0166784780218, -78.56563288667255, -1230.5064809142586, -901.930870089025, -211.0418778551332, -747.9462541944338, -707.8642343983114, -610.9104596316843, -334.2327329982404, -326.22261277384877, -297.78044164677164, -154.24454991717275, -167.86861645453087, -475.03513021601003, -211.9681366156199, -309.6758888290213, -108.46881245743401, -1253.7091817150958, -968.9911744194119, -877.5529878895928, -899.4245822988538, -90.88212469249783, -186.8970079086261, -234.78539272715756, -1104.7599608039877, -761.6512127074797, -768.0686954433173, -220.4556442231238, -221.98827280494507, -66.03961210863652, -862.2202189857182, -176.51505385997038, -1234.7751836445877, -837.277882264055, -246.58561545061966, -1010.4858342731721, -567.1702118303328, -473.0570511104959, -381.00782377495307, -315.3166773798164, -83.29636338016378, -866.1605785816413, -661.913022837306, -195.43969695429627, -783.9702985861718, -1008.0036060911905, -759.7889187155175, -585.6332768751214, -871.1047411974045, 6.449749176192213, -855.8571926143591, -72.53142356624906, -545.9317473637998, -1160.9359566275257, -333.4142575480326, -306.01045074739415, -168.2944237065393, -407.0370259311578, -99.12184107090546, -417.0929366603025, -217.96880047383263, -196.79253799482234, -141.02089255065258, -1178.699966146011, -30.207359649504827, -113.26037289446616, -230.71479793222255, -788.2588104333104, -279.07227424154985, -798.2394987714451, -752.779320428324, -834.737301028888, -939.1150836414989, -15.419768339894183, -656.5921913192984, -267.2111967972702, -212.09729990000642, -590.4634949872603, -601.2770351179921, -994.0632735094148, -645.5613008560739, -35.92331481462301, -63.29158752916674, -154.9810756298607, -75.74219417497999, -835.8911147522438, -998.8549440627562, -54.18349361332283, -643.1631753112141, -411.4845850385079, -709.2141519142486, -337.92555549675626, -662.6236163280508, -595.7249996209897, -364.2776797714405, -287.67153368592193, -467.0672801890712, -37.38716642749851, -169.2172647140873, -490.3118271979534, -936.8002688944403, -613.6002386467233, -863.3744975421855, -12.3741334543401, -1043.7847431492964, -744.9084597517842, -958.3144955903549, -367.9141796963411, -928.2215045760329, -304.5117255276739, -638.6814410599856, -253.67797947976692, -9.585133401690161, -1074.4347264595829, -564.5406313537384, -381.38532676129313, -479.69763704442346, -436.9759133151371, -14.814915924945748, -119.02382617067909, -239.19791661080865, -152.74595654911295, -891.6052692973875, -667.2376466731204, -554.163041344854, -65.41153271996603, -350.4599490331722, -550.4153313274808, -295.88191312164554, -940.1089311756134, -357.5313996020249, -633.3846046263235, -141.29933913184817, -880.6292457559864, -125.6302173236038, -423.439515375025, -729.2518554848034, -849.7463901942616, -574.2497876132062, -1074.8576431679614, -758.3819058596131, -36.728456290552685, -376.5594262792057, -226.03246846409246, -740.054998093265, -1226.1647004229874, -556.944840933539, -702.0405247262414, -610.7198958281167, -530.4885686979325, -5.532545976440527, -233.07619919137872, -321.7721282816237, -453.66677627471586, -738.4627516537594, -500.57199433457237, -671.2681968168852, -614.1993172630708, -28.061096482376843, -678.4562713848927, -139.40143512984983, -877.3601992801581, -58.17365756596707, -156.07552431420208, -195.16813497233179, -552.2971227636197, -642.8759799731835, -1050.567789033788, -97.19906649363986, -1237.511898795859, -219.67153684947223, -862.1673694059107, -612.9385113567703, -277.28834343216494, -1021.1697570467919, -290.3438552754327, -243.9924310866823, -171.93247127440702, -43.87398662671851, -217.90315638861554, -416.00240017058616, -767.4862209024287, -181.70335114443722, -57.44292816374386, -743.5119477851197, -725.0561213978567, -516.4891124542244, -608.7868588672987, -267.7608591568251, -1204.8890113355951, -514.8098032451429, -670.6472839382669, -195.15948778116342, -209.2651841278719, -459.6448352607622, -614.3712266643751, -237.29445141466644, -67.66360700688409, -142.53792569487118, -258.5233448380947, -139.10764768550482, -70.44379952147378, -806.8190760252744, -11.935368867294496, -881.4443375990221, -661.5027158218122, -300.0146608041795, -189.5357623832762, -769.0607686264972, -719.6779329824566, -449.58634619156857, -210.388277968098, -586.76022225608, -1079.648725164961, -772.8569471273358, -6.490947227553409, -198.32807375727984, -821.1242701058176, -1294.818123646567, -253.39269709838837, -96.92192287915323, -208.24959696325482, -790.9814411689681, -856.6892764121383, -1033.2532570159422, -514.8306785154602, -104.6915402004599, -46.31669890402059, -660.0465734025605, -289.0507488030354, -842.8189875688262, -893.4446770846885, -564.8377252850073, -739.3151216252132, -215.16418377123216, -144.9976722513826, -398.6887987063702, -948.6055476772575, -415.5244340149095, -55.30606012750236, -340.19878596910195, -249.7300043161019, -481.0849770407464, -27.983772680578735]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5361897789130972, "mean_inference_ms": 1.7051906056002393, "mean_action_processing_ms": 0.8430116134162247, "mean_env_wait_ms": 10.250056124511804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012942314147949219, "StateBufferConnector_ms": 0.009672880172729492, "ViewRequirementAgentConnector_ms": 0.3282325267791748}, "num_episodes": 22, "episode_return_max": -1154.303600134032, "episode_return_min": -4405.322865757155, "episode_return_mean": -2457.2233603948407, "episodes_this_iter": 22}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 620633, "num_agent_steps_trained": 620633, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 91.88033882614278, "num_env_steps_trained_throughput_per_sec": 91.88033882614278, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 620633, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 620633, "timers": {"training_iteration_time_ms": 52621.736, "restore_workers_time_ms": 0.027, "training_step_time_ms": 52621.665, "sample_time_ms": 3247.571, "learn_time_ms": 49318.032, "learn_throughput": 81.106, "synch_weights_time_ms": 53.207}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 620633, "num_agent_steps_trained": 620633}, "done": false, "training_iteration": 35, "trial_id": "efc54_00000", "date": "2024-07-24_19-12-05", "timestamp": 1721828525, "time_this_iter_s": 43.546191692352295, "time_total_s": 1924.0018620491028, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7e8a60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1924.0018620491028, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 10.801612903225806, "ram_util_percent": 23.630645161290325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 123.05893554051717, "cur_kl_coeff": 0.3375, "cur_lr": 0.0010000000000000005, "total_loss": 5.172668270213263, "policy_loss": 0.000488977694490348, "vf_loss": 5.188263357650666, "vf_explained_var": 0.9685515313205265, "kl": 0.01443661130334173, "entropy": 2.095642391358103, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.22142857142858, "num_grad_updates_lifetime": 148020.5, "diff_num_grad_updates_vs_sampler_policy": 2099.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 638444, "num_agent_steps_trained": 638444}, "env_runners": {"episode_reward_max": -1154.303600134032, "episode_reward_min": -4478.908993900307, "episode_reward_mean": -2516.098030961076, "episode_len_mean": 148.86, "episode_media": {}, "episodes_timesteps_total": 14886, "policy_reward_min": {"policy_0": -1384.0936736209478}, "policy_reward_max": {"policy_0": 6.449749176192213}, "policy_reward_mean": {"policy_0": -503.21960619221517}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2209.1122854239698, -2204.8303266733483, -2950.4241064756875, -3039.637747403801, -2584.3171777026137, -1840.2797875066171, -1732.6056920591898, -1839.2431302320726, -2332.666314943873, -3377.955757940212, -2975.6405032282455, -2371.6248779550706, -2946.0779544821976, -3215.3533316657627, -2611.995559077799, -1421.1513510083341, -2852.813194036584, -2289.5420955167265, -3076.923785982854, -3176.827950862969, -2678.3065364395775, -2122.1263391332245, -4008.5008414654003, -2628.806570995739, -1313.8779990040307, -2151.5751338256187, -1441.5136151510533, -3340.290972210051, -2327.641218121826, -1893.8205523391393, -2607.834921914518, -2716.9729083985544, -1325.62092478802, -2916.460965735644, -4043.1433827638125, -2280.891005928701, -1877.4144243995383, -2069.8106153011067, -1816.3317675471199, -2952.9535202918, -2702.3177659908997, -2472.559900061425, -3835.924960004149, -1544.5362184220933, -2552.5633565506696, -1909.4670876750706, -2538.108093236563, -3209.5776598401767, -1771.3125013100323, -1640.5380567698096, -2861.604899661325, -2794.7707704280388, -1521.5120460415587, -1286.8292369376431, -2801.558245234789, -3046.0615045631657, -3093.618361864553, -2206.2349345219022, -2359.1387480384446, -3329.4672603667736, -2122.9806364211504, -1154.303600134032, -3685.3591864713303, -1673.1331350160067, -1674.3966450661899, -2155.145547703199, -2888.8312715799775, -1979.5436251250208, -2791.265303487414, -2780.200223327545, -4478.908993900307, -1822.680744064319, -2288.8744532630044, -2578.527245481327, -1654.3570073626497, -1221.3857104083672, -2178.8904129607117, -3292.89964369854, -3813.5883302792267, -3629.7533666780996, -3188.7188641738285, -4209.852445165119, -3215.334217111746, -1359.7004884683279, -3215.525790783476, -1408.7350641122864, -1587.7607021510303, -2050.7610026314574, -3780.3305802156115, -1396.0331518356923, -3435.1290412959047, -3789.284932964207, -3066.8402471165123, -2652.8075460912432, -2825.928509181607, -2467.187909815867, -3199.0225914513007, -2242.974786466596, -1217.5992671377103, -2394.6321220581617], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 121, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1153.5983842365263, -114.71049482439035, -417.85865859076404, -451.75392749490834, -71.19082027737947, -714.7530082306914, -73.01541650235012, -938.3428627527616, -445.2195486315495, -33.499490555998335, -924.0282107219272, -536.3158770072515, -124.98787304237058, -209.35553539505256, -1155.7366103090865, -898.9456832271509, -619.7849658096923, -518.3645835446722, -25.394356265393476, -977.148158556892, -281.37603278859314, -434.06270790303523, -823.617665318433, -605.5281408256569, -439.732630866894, -469.82067893735507, -54.944027739963225, -387.7585139700722, -191.12805235517635, -736.6285145040505, -482.97217475369973, -73.95780499850814, -575.9042405556277, -295.1491597221918, -304.62231202916234, -753.3273112981797, -405.4646707184119, -221.9020383808417, -207.73318853240784, -250.81592130223356, -237.02488787002144, -655.1311719597148, -17.712205893615607, -171.11735208286265, -1251.6806971376589, -453.7483938758054, -548.3761888448357, -914.3932526713933, -351.5392609008977, -1109.8986616472814, -972.3389402083922, -157.60478396513253, -7.9078469587342255, -928.9991358786748, -908.7897962173126, -562.2696371545749, -864.0212851185381, -2.3791939766054813, -35.167106770188646, -907.7876549351632, -1019.6292595602949, -1004.1705948444113, -203.37896469266107, -622.3347253444111, -96.56441004041739, -171.3336692977857, -833.0166784780218, -78.56563288667255, -1230.5064809142586, -901.930870089025, -211.0418778551332, -747.9462541944338, -707.8642343983114, -610.9104596316843, -334.2327329982404, -326.22261277384877, -297.78044164677164, -154.24454991717275, -167.86861645453087, -475.03513021601003, -211.9681366156199, -309.6758888290213, -108.46881245743401, -1253.7091817150958, -968.9911744194119, -877.5529878895928, -899.4245822988538, -90.88212469249783, -186.8970079086261, -234.78539272715756, -1104.7599608039877, -761.6512127074797, -768.0686954433173, -220.4556442231238, -221.98827280494507, -66.03961210863652, -862.2202189857182, -176.51505385997038, -1234.7751836445877, -837.277882264055, -246.58561545061966, -1010.4858342731721, -567.1702118303328, -473.0570511104959, -381.00782377495307, -315.3166773798164, -83.29636338016378, -866.1605785816413, -661.913022837306, -195.43969695429627, -783.9702985861718, -1008.0036060911905, -759.7889187155175, -585.6332768751214, -871.1047411974045, 6.449749176192213, -855.8571926143591, -72.53142356624906, -545.9317473637998, -1160.9359566275257, -333.4142575480326, -306.01045074739415, -168.2944237065393, -407.0370259311578, -99.12184107090546, -417.0929366603025, -217.96880047383263, -196.79253799482234, -141.02089255065258, -1178.699966146011, -30.207359649504827, -113.26037289446616, -230.71479793222255, -788.2588104333104, -279.07227424154985, -798.2394987714451, -752.779320428324, -834.737301028888, -939.1150836414989, -15.419768339894183, -656.5921913192984, -267.2111967972702, -212.09729990000642, -590.4634949872603, -601.2770351179921, -994.0632735094148, -645.5613008560739, -35.92331481462301, -63.29158752916674, -154.9810756298607, -75.74219417497999, -835.8911147522438, -998.8549440627562, -54.18349361332283, -643.1631753112141, -411.4845850385079, -709.2141519142486, -337.92555549675626, -662.6236163280508, -595.7249996209897, -364.2776797714405, -287.67153368592193, -467.0672801890712, -37.38716642749851, -169.2172647140873, -490.3118271979534, -936.8002688944403, -613.6002386467233, -863.3744975421855, -12.3741334543401, -1043.7847431492964, -744.9084597517842, -958.3144955903549, -367.9141796963411, -928.2215045760329, -304.5117255276739, -638.6814410599856, -253.67797947976692, -9.585133401690161, -1074.4347264595829, -564.5406313537384, -381.38532676129313, -479.69763704442346, -436.9759133151371, -14.814915924945748, -119.02382617067909, -239.19791661080865, -152.74595654911295, -891.6052692973875, -667.2376466731204, -554.163041344854, -65.41153271996603, -350.4599490331722, -550.4153313274808, -295.88191312164554, -940.1089311756134, -357.5313996020249, -633.3846046263235, -141.29933913184817, -880.6292457559864, -125.6302173236038, -423.439515375025, -729.2518554848034, -849.7463901942616, -574.2497876132062, -1074.8576431679614, -758.3819058596131, -36.728456290552685, -376.5594262792057, -226.03246846409246, -740.054998093265, -1226.1647004229874, -556.944840933539, -702.0405247262414, -610.7198958281167, -530.4885686979325, -5.532545976440527, -233.07619919137872, -321.7721282816237, -453.66677627471586, -738.4627516537594, -500.57199433457237, -671.2681968168852, -614.1993172630708, -28.061096482376843, -678.4562713848927, -139.40143512984983, -877.3601992801581, -58.17365756596707, -156.07552431420208, -195.16813497233179, -552.2971227636197, -642.8759799731835, -1050.567789033788, -97.19906649363986, -1237.511898795859, -219.67153684947223, -862.1673694059107, -612.9385113567703, -277.28834343216494, -1021.1697570467919, -290.3438552754327, -243.9924310866823, -171.93247127440702, -43.87398662671851, -217.90315638861554, -416.00240017058616, -767.4862209024287, -181.70335114443722, -57.44292816374386, -743.5119477851197, -725.0561213978567, -516.4891124542244, -608.7868588672987, -267.7608591568251, -1204.8890113355951, -514.8098032451429, -670.6472839382669, -195.15948778116342, -209.2651841278719, -459.6448352607622, -614.3712266643751, -237.29445141466644, -67.66360700688409, -142.53792569487118, -258.5233448380947, -139.10764768550482, -70.44379952147378, -806.8190760252744, -11.935368867294496, -881.4443375990221, -661.5027158218122, -300.0146608041795, -189.5357623832762, -769.0607686264972, -719.6779329824566, -449.58634619156857, -210.388277968098, -586.76022225608, -1079.648725164961, -772.8569471273358, -6.490947227553409, -198.32807375727984, -821.1242701058176, -1294.818123646567, -253.39269709838837, -96.92192287915323, -208.24959696325482, -790.9814411689681, -856.6892764121383, -1033.2532570159422, -514.8306785154602, -104.6915402004599, -46.31669890402059, -660.0465734025605, -289.0507488030354, -842.8189875688262, -893.4446770846885, -564.8377252850073, -739.3151216252132, -215.16418377123216, -144.9976722513826, -398.6887987063702, -948.6055476772575, -415.5244340149095, -55.30606012750236, -340.19878596910195, -249.7300043161019, -481.0849770407464, -27.983772680578735, -830.3248205831748, -777.2142739496024, -193.6872066504521, -1048.132291260747, -836.0005940273542, -498.37433440026206, -113.31240698737358, -827.9420652918419, -183.7298648248424, -49.77446351168709, -638.5641749676364, -89.30787694532098, -16.93964885104458, -203.96510244270152, -725.6198418594851, -767.1290560612807, -266.90420601886393, -790.4284894732662, -40.92664227412579, -289.75715387566083, -1007.1494891784434, -500.6203639950993, -57.618599029683686, -549.0346071389426, -774.4082122378094, -285.2301547082814, -124.19455536182777, -552.4741099035766, -865.6991123160037, -151.94569283533275, -380.4283033062227, -862.7247744158216, -724.4499656586405, -495.8004682080613, -327.8617918986628, -679.2298608225117, -95.23061196066128, -243.98777541160646, -705.8452600080788, -1055.9067151246843, -848.245019827417, -594.7895160744107, -744.6582044471286, -1058.5908228292026, -1232.6254307221482, -890.7596861147542, -62.77924775358282, -143.05893612845495, -547.8010483844212, -178.28182568310385, -575.5394993493395, -490.41081875222267, -63.86855478546722, -770.0603579883144, -388.99522238765906, -971.7976064102161, -537.8905174581269, -44.79770693243142, -62.43593316740639, -961.6054815131467, -54.5717401396791, -705.8573046550936, -485.52536586574814, -190.00404507477504, -218.39855162735407, -184.6098637338152, -335.5155281620696, -86.81106642687185, -445.7690860744936, -168.6801660111175, -82.78654486644112, -557.6322927311048, -150.0337255192617, -565.6790300921865, -822.7588197517169, -926.547283111986, -534.5772594823018, -66.30392577867234, -836.2876422089876, -929.1835331165926, -1059.058982114448, -647.8154210184439, -172.19440355109873, -609.5172390140283, -1325.0022845812107, -919.4367925209701, -28.925684689880214, -852.907510977185, -911.3340886954335, -917.1492897946279, -595.4865428477393, -29.20766408129922, -305.67629568455624, -1233.3854480801174, -1024.9629134801178, -571.6621028406724, -536.0402457229668, -1347.1239363656173, -944.2786454349407, -810.7475148009171, -1105.0378755681497, -699.7760762417455, -480.9279681608222, -801.4620542341506, -128.13024290688045, -609.3633544273405, -219.08908366832844, -249.2583964725278, -238.77953360917857, -43.210120290953306, -516.4367497914676, -303.8271446766001, -458.12971188429407, -1384.0936736209478, -553.0385108101653, -62.45713151413553, -350.69400941128407, -279.12032075388333, -161.187711342393, -555.2758910905902, -888.6033377284531, -87.47797378667748, -148.138919036407, -322.6664817914624, -140.87398980803022, -791.8079531936569, -146.59024656936595, -288.1291057432885, -91.52250387638169, -732.7111932487646, -286.3055433796518, -582.9481857124379, -1017.1944590185947, -562.9824921975946, -1330.899899907334, -58.856682292603175, -11.597507720933816, -135.15545444801876, -325.97943938032535, -864.4440679938107, -335.6669559298093, -923.1585175792808, -957.3418106991514, -914.3916478234206, -304.5701092642409, -679.2429774310693, -797.3165725672036, -940.0092508050086, -410.57592371779407, -962.1402084431315, -310.0820050711687, -1343.114600018014, -491.1479074095252, -808.0025045129104, -114.49323010489225, 0.6572367858468204, -993.3874731151617, -504.43749633404445, -701.1519132419972, -454.4879001858868, -362.06591873582556, -435.26835809373176, -777.5593951665527, -648.0455575075573, -602.9892796779387, -1041.7649200232606, -445.555966951968, -139.6191757631915, -657.873048194175, -182.374798883272, -432.78751073797815, -168.49860782890607, -963.6104414715852, -579.4104818062884, -1054.7155496065448, -317.8553523152842, -673.8961362416184, -535.9963004535169, -659.1798889318912, -56.04710852428873, -62.43172615666989, -32.26156344105739, -632.4070319430186, -352.62186145067886, -137.87708414628665, -63.399396424354244, -357.61854876656366, -129.91212242170775, -896.3163361015426, -947.3857183439931]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.53746406302504, "mean_inference_ms": 1.7081353824338197, "mean_action_processing_ms": 0.8404152370836484, "mean_env_wait_ms": 10.255976803429526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01357579231262207, "StateBufferConnector_ms": 0.009814262390136719, "ViewRequirementAgentConnector_ms": 0.3323216438293457}, "num_episodes": 38, "episode_return_max": -1154.303600134032, "episode_return_min": -4478.908993900307, "episode_return_mean": -2516.098030961076, "episodes_this_iter": 38}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 638444, "num_agent_steps_trained": 638444, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 69.03357928315832, "num_env_steps_trained_throughput_per_sec": 69.03357928315832, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 638444, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 638444, "timers": {"training_iteration_time_ms": 52934.615, "restore_workers_time_ms": 0.027, "training_step_time_ms": 52934.545, "sample_time_ms": 3250.018, "learn_time_ms": 49630.446, "learn_throughput": 80.596, "synch_weights_time_ms": 51.241}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 638444, "num_agent_steps_trained": 638444}, "done": false, "training_iteration": 36, "trial_id": "efc54_00000", "date": "2024-07-24_19-13-03", "timestamp": 1721828583, "time_this_iter_s": 57.95480418205261, "time_total_s": 1981.9566662311554, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7afbe0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1981.9566662311554, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 9.769512195121951, "ram_util_percent": 23.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 126.0961578119718, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.197419318113572, "policy_loss": -0.0006058309173498016, "vf_loss": 5.2143813860722075, "vf_explained_var": 0.971521931886673, "kl": 0.015107725490995039, "entropy": 2.145509419685755, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.13076923076923, "num_grad_updates_lifetime": 152070.5, "diff_num_grad_updates_vs_sampler_policy": 1949.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 654971, "num_agent_steps_trained": 654971}, "env_runners": {"episode_reward_max": -1154.303600134032, "episode_reward_min": -4478.908993900307, "episode_reward_mean": -2542.8788231789827, "episode_len_mean": 148.86, "episode_media": {}, "episodes_timesteps_total": 14886, "policy_reward_min": {"policy_0": -1384.0936736209478}, "policy_reward_max": {"policy_0": 6.449749176192213}, "policy_reward_mean": {"policy_0": -508.5757646357965}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2678.3065364395775, -2122.1263391332245, -4008.5008414654003, -2628.806570995739, -1313.8779990040307, -2151.5751338256187, -1441.5136151510533, -3340.290972210051, -2327.641218121826, -1893.8205523391393, -2607.834921914518, -2716.9729083985544, -1325.62092478802, -2916.460965735644, -4043.1433827638125, -2280.891005928701, -1877.4144243995383, -2069.8106153011067, -1816.3317675471199, -2952.9535202918, -2702.3177659908997, -2472.559900061425, -3835.924960004149, -1544.5362184220933, -2552.5633565506696, -1909.4670876750706, -2538.108093236563, -3209.5776598401767, -1771.3125013100323, -1640.5380567698096, -2861.604899661325, -2794.7707704280388, -1521.5120460415587, -1286.8292369376431, -2801.558245234789, -3046.0615045631657, -3093.618361864553, -2206.2349345219022, -2359.1387480384446, -3329.4672603667736, -2122.9806364211504, -1154.303600134032, -3685.3591864713303, -1673.1331350160067, -1674.3966450661899, -2155.145547703199, -2888.8312715799775, -1979.5436251250208, -2791.265303487414, -2780.200223327545, -4478.908993900307, -1822.680744064319, -2288.8744532630044, -2578.527245481327, -1654.3570073626497, -1221.3857104083672, -2178.8904129607117, -3292.89964369854, -3813.5883302792267, -3629.7533666780996, -3188.7188641738285, -4209.852445165119, -3215.334217111746, -1359.7004884683279, -3215.525790783476, -1408.7350641122864, -1587.7607021510303, -2050.7610026314574, -3780.3305802156115, -1396.0331518356923, -3435.1290412959047, -3789.284932964207, -3066.8402471165123, -2652.8075460912432, -2825.928509181607, -2467.187909815867, -3199.0225914513007, -2242.974786466596, -1217.5992671377103, -2394.6321220581617, -2655.8758969541473, -1800.566277887937, -3827.038983437295, -2127.057498439807, -2073.6230474154286, -2523.3837158948522, -3025.009430533978, -3134.4649836623776, -3683.5143788086, -1671.617358284881, -3244.452801120105, -2496.175256955297, -2052.383783569037, -3308.6814003851455, -2456.961867806281, -2509.247814935382, -1681.6612885101179, -3459.6163484429762, -3495.57590263052, -2500.1941162944504], "episode_lengths": [150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 121, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-246.58561545061966, -1010.4858342731721, -567.1702118303328, -473.0570511104959, -381.00782377495307, -315.3166773798164, -83.29636338016378, -866.1605785816413, -661.913022837306, -195.43969695429627, -783.9702985861718, -1008.0036060911905, -759.7889187155175, -585.6332768751214, -871.1047411974045, 6.449749176192213, -855.8571926143591, -72.53142356624906, -545.9317473637998, -1160.9359566275257, -333.4142575480326, -306.01045074739415, -168.2944237065393, -407.0370259311578, -99.12184107090546, -417.0929366603025, -217.96880047383263, -196.79253799482234, -141.02089255065258, -1178.699966146011, -30.207359649504827, -113.26037289446616, -230.71479793222255, -788.2588104333104, -279.07227424154985, -798.2394987714451, -752.779320428324, -834.737301028888, -939.1150836414989, -15.419768339894183, -656.5921913192984, -267.2111967972702, -212.09729990000642, -590.4634949872603, -601.2770351179921, -994.0632735094148, -645.5613008560739, -35.92331481462301, -63.29158752916674, -154.9810756298607, -75.74219417497999, -835.8911147522438, -998.8549440627562, -54.18349361332283, -643.1631753112141, -411.4845850385079, -709.2141519142486, -337.92555549675626, -662.6236163280508, -595.7249996209897, -364.2776797714405, -287.67153368592193, -467.0672801890712, -37.38716642749851, -169.2172647140873, -490.3118271979534, -936.8002688944403, -613.6002386467233, -863.3744975421855, -12.3741334543401, -1043.7847431492964, -744.9084597517842, -958.3144955903549, -367.9141796963411, -928.2215045760329, -304.5117255276739, -638.6814410599856, -253.67797947976692, -9.585133401690161, -1074.4347264595829, -564.5406313537384, -381.38532676129313, -479.69763704442346, -436.9759133151371, -14.814915924945748, -119.02382617067909, -239.19791661080865, -152.74595654911295, -891.6052692973875, -667.2376466731204, -554.163041344854, -65.41153271996603, -350.4599490331722, -550.4153313274808, -295.88191312164554, -940.1089311756134, -357.5313996020249, -633.3846046263235, -141.29933913184817, -880.6292457559864, -125.6302173236038, -423.439515375025, -729.2518554848034, -849.7463901942616, -574.2497876132062, -1074.8576431679614, -758.3819058596131, -36.728456290552685, -376.5594262792057, -226.03246846409246, -740.054998093265, -1226.1647004229874, -556.944840933539, -702.0405247262414, -610.7198958281167, -530.4885686979325, -5.532545976440527, -233.07619919137872, -321.7721282816237, -453.66677627471586, -738.4627516537594, -500.57199433457237, -671.2681968168852, -614.1993172630708, -28.061096482376843, -678.4562713848927, -139.40143512984983, -877.3601992801581, -58.17365756596707, -156.07552431420208, -195.16813497233179, -552.2971227636197, -642.8759799731835, -1050.567789033788, -97.19906649363986, -1237.511898795859, -219.67153684947223, -862.1673694059107, -612.9385113567703, -277.28834343216494, -1021.1697570467919, -290.3438552754327, -243.9924310866823, -171.93247127440702, -43.87398662671851, -217.90315638861554, -416.00240017058616, -767.4862209024287, -181.70335114443722, -57.44292816374386, -743.5119477851197, -725.0561213978567, -516.4891124542244, -608.7868588672987, -267.7608591568251, -1204.8890113355951, -514.8098032451429, -670.6472839382669, -195.15948778116342, -209.2651841278719, -459.6448352607622, -614.3712266643751, -237.29445141466644, -67.66360700688409, -142.53792569487118, -258.5233448380947, -139.10764768550482, -70.44379952147378, -806.8190760252744, -11.935368867294496, -881.4443375990221, -661.5027158218122, -300.0146608041795, -189.5357623832762, -769.0607686264972, -719.6779329824566, -449.58634619156857, -210.388277968098, -586.76022225608, -1079.648725164961, -772.8569471273358, -6.490947227553409, -198.32807375727984, -821.1242701058176, -1294.818123646567, -253.39269709838837, -96.92192287915323, -208.24959696325482, -790.9814411689681, -856.6892764121383, -1033.2532570159422, -514.8306785154602, -104.6915402004599, -46.31669890402059, -660.0465734025605, -289.0507488030354, -842.8189875688262, -893.4446770846885, -564.8377252850073, -739.3151216252132, -215.16418377123216, -144.9976722513826, -398.6887987063702, -948.6055476772575, -415.5244340149095, -55.30606012750236, -340.19878596910195, -249.7300043161019, -481.0849770407464, -27.983772680578735, -830.3248205831748, -777.2142739496024, -193.6872066504521, -1048.132291260747, -836.0005940273542, -498.37433440026206, -113.31240698737358, -827.9420652918419, -183.7298648248424, -49.77446351168709, -638.5641749676364, -89.30787694532098, -16.93964885104458, -203.96510244270152, -725.6198418594851, -767.1290560612807, -266.90420601886393, -790.4284894732662, -40.92664227412579, -289.75715387566083, -1007.1494891784434, -500.6203639950993, -57.618599029683686, -549.0346071389426, -774.4082122378094, -285.2301547082814, -124.19455536182777, -552.4741099035766, -865.6991123160037, -151.94569283533275, -380.4283033062227, -862.7247744158216, -724.4499656586405, -495.8004682080613, -327.8617918986628, -679.2298608225117, -95.23061196066128, -243.98777541160646, -705.8452600080788, -1055.9067151246843, -848.245019827417, -594.7895160744107, -744.6582044471286, -1058.5908228292026, -1232.6254307221482, -890.7596861147542, -62.77924775358282, -143.05893612845495, -547.8010483844212, -178.28182568310385, -575.5394993493395, -490.41081875222267, -63.86855478546722, -770.0603579883144, -388.99522238765906, -971.7976064102161, -537.8905174581269, -44.79770693243142, -62.43593316740639, -961.6054815131467, -54.5717401396791, -705.8573046550936, -485.52536586574814, -190.00404507477504, -218.39855162735407, -184.6098637338152, -335.5155281620696, -86.81106642687185, -445.7690860744936, -168.6801660111175, -82.78654486644112, -557.6322927311048, -150.0337255192617, -565.6790300921865, -822.7588197517169, -926.547283111986, -534.5772594823018, -66.30392577867234, -836.2876422089876, -929.1835331165926, -1059.058982114448, -647.8154210184439, -172.19440355109873, -609.5172390140283, -1325.0022845812107, -919.4367925209701, -28.925684689880214, -852.907510977185, -911.3340886954335, -917.1492897946279, -595.4865428477393, -29.20766408129922, -305.67629568455624, -1233.3854480801174, -1024.9629134801178, -571.6621028406724, -536.0402457229668, -1347.1239363656173, -944.2786454349407, -810.7475148009171, -1105.0378755681497, -699.7760762417455, -480.9279681608222, -801.4620542341506, -128.13024290688045, -609.3633544273405, -219.08908366832844, -249.2583964725278, -238.77953360917857, -43.210120290953306, -516.4367497914676, -303.8271446766001, -458.12971188429407, -1384.0936736209478, -553.0385108101653, -62.45713151413553, -350.69400941128407, -279.12032075388333, -161.187711342393, -555.2758910905902, -888.6033377284531, -87.47797378667748, -148.138919036407, -322.6664817914624, -140.87398980803022, -791.8079531936569, -146.59024656936595, -288.1291057432885, -91.52250387638169, -732.7111932487646, -286.3055433796518, -582.9481857124379, -1017.1944590185947, -562.9824921975946, -1330.899899907334, -58.856682292603175, -11.597507720933816, -135.15545444801876, -325.97943938032535, -864.4440679938107, -335.6669559298093, -923.1585175792808, -957.3418106991514, -914.3916478234206, -304.5701092642409, -679.2429774310693, -797.3165725672036, -940.0092508050086, -410.57592371779407, -962.1402084431315, -310.0820050711687, -1343.114600018014, -491.1479074095252, -808.0025045129104, -114.49323010489225, 0.6572367858468204, -993.3874731151617, -504.43749633404445, -701.1519132419972, -454.4879001858868, -362.06591873582556, -435.26835809373176, -777.5593951665527, -648.0455575075573, -602.9892796779387, -1041.7649200232606, -445.555966951968, -139.6191757631915, -657.873048194175, -182.374798883272, -432.78751073797815, -168.49860782890607, -963.6104414715852, -579.4104818062884, -1054.7155496065448, -317.8553523152842, -673.8961362416184, -535.9963004535169, -659.1798889318912, -56.04710852428873, -62.43172615666989, -32.26156344105739, -632.4070319430186, -352.62186145067886, -137.87708414628665, -63.399396424354244, -357.61854876656366, -129.91212242170775, -896.3163361015426, -947.3857183439931, -307.04443478005226, -729.6777806177356, -756.20809255378, -241.85509389395304, -621.0904951086226, -97.76743076522507, -261.9756910486657, -1260.6282787908688, -165.80972197846728, -14.385155304710588, -1183.805458399072, -1353.3188511710803, -389.35991432271373, -804.5681125369274, -95.98664700750604, -534.5851327300143, -40.829515284550325, -164.71697918378118, -748.3868803698491, -638.5389908716138, -458.1335710439864, -215.395723149564, -530.4361727298514, -562.364133035649, -307.29344745637684, -270.7695999296719, -195.06566480217236, -235.3856669916427, -647.9800987271258, -1174.1826854442377, -326.93961922871875, -385.9231509562225, -630.6593886825478, -758.893274909597, -922.5939967568913, -1071.0907994325019, -68.05400531241277, -1061.2589597935946, -704.4006246016522, -229.6605945222182, -872.7747144984952, -747.8350705451845, -276.6753568696966, -707.3894264511586, -1078.839810444061, -578.4840968576545, -39.766528081312465, -9.386993591003119, -601.6146381897249, -442.3651015651843, -575.2974120780818, -1043.0127785844375, -77.33639815612614, -709.4938763387408, -839.3123359627193, -895.5933814473284, -324.90252197658884, -90.78353428519861, -162.68080072854377, -1022.2150185176349, -152.1525103409849, -724.5957687077945, -243.12105559570338, -365.3403283462341, -567.1741205783213, -1069.7298565225371, -817.9727348945745, -324.26983049980157, -903.7217143961237, -192.98726407210935, -404.6015904354243, -294.24893949424364, -271.15665996081646, -1018.0041113086187, -468.9505666071767, -336.00662885223915, -598.684397121654, -428.90294404126354, -589.0904399461258, -556.5634049741003, -362.97935663720114, -172.040969076647, -89.60219528353286, -565.367210040003, -491.67155747273557, -1090.2647400161593, -688.3059687365885, -479.85943545571, -551.6951371899039, -649.4910670446122, -1214.9234420653727, -787.3001009312134, -539.8090010154907, -914.9430272659972, -38.60033135244954, -857.0907601286956, -87.79299958040325, -155.72137244293688, -463.92824474920803, -935.6607393932059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5318182247673582, "mean_inference_ms": 1.7038578587165472, "mean_action_processing_ms": 0.8383462414729996, "mean_env_wait_ms": 10.218638806939886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013433694839477539, "StateBufferConnector_ms": 0.009830474853515625, "ViewRequirementAgentConnector_ms": 0.3329803943634033}, "num_episodes": 20, "episode_return_max": -1154.303600134032, "episode_return_min": -4478.908993900307, "episode_return_mean": -2542.8788231789827, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 654971, "num_agent_steps_trained": 654971, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.17875411743269, "num_env_steps_trained_throughput_per_sec": 74.17875411743269, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 654971, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 654971, "timers": {"training_iteration_time_ms": 52632.2, "restore_workers_time_ms": 0.026, "training_step_time_ms": 52632.13, "sample_time_ms": 3278.292, "learn_time_ms": 49299.416, "learn_throughput": 81.137, "synch_weights_time_ms": 51.64}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 654971, "num_agent_steps_trained": 654971}, "done": false, "training_iteration": 37, "trial_id": "efc54_00000", "date": "2024-07-24_19-13-57", "timestamp": 1721828637, "time_this_iter_s": 53.93553018569946, "time_total_s": 2035.8921964168549, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7e8790>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2035.8921964168549, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 10.010389610389613, "ram_util_percent": 23.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 130.62996106476166, "cur_kl_coeff": 0.3375, "cur_lr": 0.0010000000000000005, "total_loss": 4.9127534688996874, "policy_loss": -0.0037604747145095476, "vf_loss": 4.933111627436866, "vf_explained_var": 0.9773410100582217, "kl": 0.01495900914286579, "entropy": 2.164634936571778, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65289256198348, "num_grad_updates_lifetime": 155835.5, "diff_num_grad_updates_vs_sampler_policy": 1814.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 670417, "num_agent_steps_trained": 670417}, "env_runners": {"episode_reward_max": -1154.303600134032, "episode_reward_min": -4478.908993900307, "episode_reward_mean": -2480.812452629464, "episode_len_mean": 149.28, "episode_media": {}, "episodes_timesteps_total": 14928, "policy_reward_min": {"policy_0": -1384.0936736209478}, "policy_reward_max": {"policy_0": 0.6572367858468204}, "policy_reward_mean": {"policy_0": -496.16249052589274}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1544.5362184220933, -2552.5633565506696, -1909.4670876750706, -2538.108093236563, -3209.5776598401767, -1771.3125013100323, -1640.5380567698096, -2861.604899661325, -2794.7707704280388, -1521.5120460415587, -1286.8292369376431, -2801.558245234789, -3046.0615045631657, -3093.618361864553, -2206.2349345219022, -2359.1387480384446, -3329.4672603667736, -2122.9806364211504, -1154.303600134032, -3685.3591864713303, -1673.1331350160067, -1674.3966450661899, -2155.145547703199, -2888.8312715799775, -1979.5436251250208, -2791.265303487414, -2780.200223327545, -4478.908993900307, -1822.680744064319, -2288.8744532630044, -2578.527245481327, -1654.3570073626497, -1221.3857104083672, -2178.8904129607117, -3292.89964369854, -3813.5883302792267, -3629.7533666780996, -3188.7188641738285, -4209.852445165119, -3215.334217111746, -1359.7004884683279, -3215.525790783476, -1408.7350641122864, -1587.7607021510303, -2050.7610026314574, -3780.3305802156115, -1396.0331518356923, -3435.1290412959047, -3789.284932964207, -3066.8402471165123, -2652.8075460912432, -2825.928509181607, -2467.187909815867, -3199.0225914513007, -2242.974786466596, -1217.5992671377103, -2394.6321220581617, -2655.8758969541473, -1800.566277887937, -3827.038983437295, -2127.057498439807, -2073.6230474154286, -2523.3837158948522, -3025.009430533978, -3134.4649836623776, -3683.5143788086, -1671.617358284881, -3244.452801120105, -2496.175256955297, -2052.383783569037, -3308.6814003851455, -2456.961867806281, -2509.247814935382, -1681.6612885101179, -3459.6163484429762, -3495.57590263052, -2500.1941162944504, -1808.7581260312413, -1468.722775490867, -1513.5419178659142, -2263.9894223020738, -2604.803112346386, -2705.53684614442, -1879.64811035474, -2919.546896075055, -2570.779094907372, -3480.9641641154667, -1644.288364914774, -2425.617330975523, -2993.185965777692, -1305.9855307656578, -2035.2694325123648, -2375.993210052046, -2882.857507796229, -2301.7954353890295, -2227.546601898343, -2205.703356590671, -1938.476717496409, -2219.4399016912444, -1545.6099653655538], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 121, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-530.4885686979325, -5.532545976440527, -233.07619919137872, -321.7721282816237, -453.66677627471586, -738.4627516537594, -500.57199433457237, -671.2681968168852, -614.1993172630708, -28.061096482376843, -678.4562713848927, -139.40143512984983, -877.3601992801581, -58.17365756596707, -156.07552431420208, -195.16813497233179, -552.2971227636197, -642.8759799731835, -1050.567789033788, -97.19906649363986, -1237.511898795859, -219.67153684947223, -862.1673694059107, -612.9385113567703, -277.28834343216494, -1021.1697570467919, -290.3438552754327, -243.9924310866823, -171.93247127440702, -43.87398662671851, -217.90315638861554, -416.00240017058616, -767.4862209024287, -181.70335114443722, -57.44292816374386, -743.5119477851197, -725.0561213978567, -516.4891124542244, -608.7868588672987, -267.7608591568251, -1204.8890113355951, -514.8098032451429, -670.6472839382669, -195.15948778116342, -209.2651841278719, -459.6448352607622, -614.3712266643751, -237.29445141466644, -67.66360700688409, -142.53792569487118, -258.5233448380947, -139.10764768550482, -70.44379952147378, -806.8190760252744, -11.935368867294496, -881.4443375990221, -661.5027158218122, -300.0146608041795, -189.5357623832762, -769.0607686264972, -719.6779329824566, -449.58634619156857, -210.388277968098, -586.76022225608, -1079.648725164961, -772.8569471273358, -6.490947227553409, -198.32807375727984, -821.1242701058176, -1294.818123646567, -253.39269709838837, -96.92192287915323, -208.24959696325482, -790.9814411689681, -856.6892764121383, -1033.2532570159422, -514.8306785154602, -104.6915402004599, -46.31669890402059, -660.0465734025605, -289.0507488030354, -842.8189875688262, -893.4446770846885, -564.8377252850073, -739.3151216252132, -215.16418377123216, -144.9976722513826, -398.6887987063702, -948.6055476772575, -415.5244340149095, -55.30606012750236, -340.19878596910195, -249.7300043161019, -481.0849770407464, -27.983772680578735, -830.3248205831748, -777.2142739496024, -193.6872066504521, -1048.132291260747, -836.0005940273542, -498.37433440026206, -113.31240698737358, -827.9420652918419, -183.7298648248424, -49.77446351168709, -638.5641749676364, -89.30787694532098, -16.93964885104458, -203.96510244270152, -725.6198418594851, -767.1290560612807, -266.90420601886393, -790.4284894732662, -40.92664227412579, -289.75715387566083, -1007.1494891784434, -500.6203639950993, -57.618599029683686, -549.0346071389426, -774.4082122378094, -285.2301547082814, -124.19455536182777, -552.4741099035766, -865.6991123160037, -151.94569283533275, -380.4283033062227, -862.7247744158216, -724.4499656586405, -495.8004682080613, -327.8617918986628, -679.2298608225117, -95.23061196066128, -243.98777541160646, -705.8452600080788, -1055.9067151246843, -848.245019827417, -594.7895160744107, -744.6582044471286, -1058.5908228292026, -1232.6254307221482, -890.7596861147542, -62.77924775358282, -143.05893612845495, -547.8010483844212, -178.28182568310385, -575.5394993493395, -490.41081875222267, -63.86855478546722, -770.0603579883144, -388.99522238765906, -971.7976064102161, -537.8905174581269, -44.79770693243142, -62.43593316740639, -961.6054815131467, -54.5717401396791, -705.8573046550936, -485.52536586574814, -190.00404507477504, -218.39855162735407, -184.6098637338152, -335.5155281620696, -86.81106642687185, -445.7690860744936, -168.6801660111175, -82.78654486644112, -557.6322927311048, -150.0337255192617, -565.6790300921865, -822.7588197517169, -926.547283111986, -534.5772594823018, -66.30392577867234, -836.2876422089876, -929.1835331165926, -1059.058982114448, -647.8154210184439, -172.19440355109873, -609.5172390140283, -1325.0022845812107, -919.4367925209701, -28.925684689880214, -852.907510977185, -911.3340886954335, -917.1492897946279, -595.4865428477393, -29.20766408129922, -305.67629568455624, -1233.3854480801174, -1024.9629134801178, -571.6621028406724, -536.0402457229668, -1347.1239363656173, -944.2786454349407, -810.7475148009171, -1105.0378755681497, -699.7760762417455, -480.9279681608222, -801.4620542341506, -128.13024290688045, -609.3633544273405, -219.08908366832844, -249.2583964725278, -238.77953360917857, -43.210120290953306, -516.4367497914676, -303.8271446766001, -458.12971188429407, -1384.0936736209478, -553.0385108101653, -62.45713151413553, -350.69400941128407, -279.12032075388333, -161.187711342393, -555.2758910905902, -888.6033377284531, -87.47797378667748, -148.138919036407, -322.6664817914624, -140.87398980803022, -791.8079531936569, -146.59024656936595, -288.1291057432885, -91.52250387638169, -732.7111932487646, -286.3055433796518, -582.9481857124379, -1017.1944590185947, -562.9824921975946, -1330.899899907334, -58.856682292603175, -11.597507720933816, -135.15545444801876, -325.97943938032535, -864.4440679938107, -335.6669559298093, -923.1585175792808, -957.3418106991514, -914.3916478234206, -304.5701092642409, -679.2429774310693, -797.3165725672036, -940.0092508050086, -410.57592371779407, -962.1402084431315, -310.0820050711687, -1343.114600018014, -491.1479074095252, -808.0025045129104, -114.49323010489225, 0.6572367858468204, -993.3874731151617, -504.43749633404445, -701.1519132419972, -454.4879001858868, -362.06591873582556, -435.26835809373176, -777.5593951665527, -648.0455575075573, -602.9892796779387, -1041.7649200232606, -445.555966951968, -139.6191757631915, -657.873048194175, -182.374798883272, -432.78751073797815, -168.49860782890607, -963.6104414715852, -579.4104818062884, -1054.7155496065448, -317.8553523152842, -673.8961362416184, -535.9963004535169, -659.1798889318912, -56.04710852428873, -62.43172615666989, -32.26156344105739, -632.4070319430186, -352.62186145067886, -137.87708414628665, -63.399396424354244, -357.61854876656366, -129.91212242170775, -896.3163361015426, -947.3857183439931, -307.04443478005226, -729.6777806177356, -756.20809255378, -241.85509389395304, -621.0904951086226, -97.76743076522507, -261.9756910486657, -1260.6282787908688, -165.80972197846728, -14.385155304710588, -1183.805458399072, -1353.3188511710803, -389.35991432271373, -804.5681125369274, -95.98664700750604, -534.5851327300143, -40.829515284550325, -164.71697918378118, -748.3868803698491, -638.5389908716138, -458.1335710439864, -215.395723149564, -530.4361727298514, -562.364133035649, -307.29344745637684, -270.7695999296719, -195.06566480217236, -235.3856669916427, -647.9800987271258, -1174.1826854442377, -326.93961922871875, -385.9231509562225, -630.6593886825478, -758.893274909597, -922.5939967568913, -1071.0907994325019, -68.05400531241277, -1061.2589597935946, -704.4006246016522, -229.6605945222182, -872.7747144984952, -747.8350705451845, -276.6753568696966, -707.3894264511586, -1078.839810444061, -578.4840968576545, -39.766528081312465, -9.386993591003119, -601.6146381897249, -442.3651015651843, -575.2974120780818, -1043.0127785844375, -77.33639815612614, -709.4938763387408, -839.3123359627193, -895.5933814473284, -324.90252197658884, -90.78353428519861, -162.68080072854377, -1022.2150185176349, -152.1525103409849, -724.5957687077945, -243.12105559570338, -365.3403283462341, -567.1741205783213, -1069.7298565225371, -817.9727348945745, -324.26983049980157, -903.7217143961237, -192.98726407210935, -404.6015904354243, -294.24893949424364, -271.15665996081646, -1018.0041113086187, -468.9505666071767, -336.00662885223915, -598.684397121654, -428.90294404126354, -589.0904399461258, -556.5634049741003, -362.97935663720114, -172.040969076647, -89.60219528353286, -565.367210040003, -491.67155747273557, -1090.2647400161593, -688.3059687365885, -479.85943545571, -551.6951371899039, -649.4910670446122, -1214.9234420653727, -787.3001009312134, -539.8090010154907, -914.9430272659972, -38.60033135244954, -857.0907601286956, -87.79299958040325, -155.72137244293688, -463.92824474920803, -935.6607393932059, -870.9895259663263, -74.49500020604671, -156.010336022815, -132.60578188509194, -574.6574819509607, -68.23047991406865, -821.6767231548936, -96.194900509428, -154.24047105025613, -328.38020086221985, -208.97760693666146, -1067.3183593076633, -76.14705469702419, -6.0656067143355195, -155.03329021022907, -660.1763363342819, -632.8681917791705, -194.66196252623038, -340.8948271261723, -435.3881045362189, -419.49429152320613, -249.22249296125398, -704.4239855721341, -261.85051539920494, -969.8118268905847, -405.4797082982583, -39.494621748595755, -293.26340248850323, -1160.1921296730168, -807.106983936048, -400.417332506579, -430.38481495083664, -279.0476574885426, -717.67329814898, -52.1250072598005, -670.264374284439, -641.6288712234074, -104.61358241844518, -554.9174005970532, -948.1226675517107, -161.90065662486006, -73.70985018454385, -733.5638310133885, -930.1698974529544, -671.4348596316249, -684.1440780471349, -803.9084133328371, -1146.3081709787605, -156.56679390227535, -690.036707854458, -873.9547247643808, -295.71020637114214, -186.4993946226326, -243.52508412239757, -44.59895503422138, -1122.4891107659982, -166.22198924660884, -374.4197533500063, -305.06204066553124, -457.42443694737966, -344.77185223331946, -187.54482772376215, -648.2832626460092, -842.9028774327049, -969.6831457418928, -512.4208876365603, -572.0057770244713, -81.53510846809448, -90.16376852737989, -49.859989109153695, -267.0852217365232, -800.1234648625465, -127.79003173490223, -797.226993000814, -43.04372117757876, -195.00960439600027, -804.3638917822883, -383.00484113080057, -934.0895752534327, -59.5252974895256, -29.72126969380192, -340.90391945940416, -1229.6694348578023, -855.4301759042925, -427.1327078809276, -137.43675528246564, -83.02603003473001, -331.5402726981918, -752.0615201189688, -997.730857254674, -137.4623799066478, -330.90327580865227, -252.05801170546502, -808.4095456015898, -698.7133888759889, -905.5724856846945, -233.7924283146524, -249.31665464469975, -706.8124777408027, -110.209310205822, -864.5411021782805, -46.738783036811746, -533.7173393996666, -362.6601103962807, -130.81938248536994, -42.508144557069585, -715.6406673084107, -21.947252855854778, -286.0546011517454, -1153.2892358181616, -11.946165412651128, -102.29134192933745, -1227.9717203042312, -78.09535439370372, -125.30538332563084]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.528708903990615, "mean_inference_ms": 1.7039155940396833, "mean_action_processing_ms": 0.8355589085241318, "mean_env_wait_ms": 10.20273898842616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013482332229614258, "StateBufferConnector_ms": 0.009758234024047852, "ViewRequirementAgentConnector_ms": 0.32770442962646484}, "num_episodes": 23, "episode_return_max": -1154.303600134032, "episode_return_min": -4478.908993900307, "episode_return_mean": -2480.812452629464, "episodes_this_iter": 23}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 670417, "num_agent_steps_trained": 670417, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.73386305107833, "num_env_steps_trained_throughput_per_sec": 80.73386305107833, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 670417, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 670417, "timers": {"training_iteration_time_ms": 52151.068, "restore_workers_time_ms": 0.027, "training_step_time_ms": 52150.998, "sample_time_ms": 3250.203, "learn_time_ms": 48846.076, "learn_throughput": 81.89, "synch_weights_time_ms": 51.96}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 670417, "num_agent_steps_trained": 670417}, "done": false, "training_iteration": 38, "trial_id": "efc54_00000", "date": "2024-07-24_19-14-47", "timestamp": 1721828687, "time_this_iter_s": 49.557310581207275, "time_total_s": 2085.449506998062, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7adfc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2085.449506998062, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 9.86760563380282, "ram_util_percent": 23.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 129.01615867614746, "cur_kl_coeff": 0.3375, "cur_lr": 0.001, "total_loss": 4.9669735956080086, "policy_loss": -0.0003219580412252058, "vf_loss": 4.983739660043672, "vf_explained_var": 0.9814681831100177, "kl": 0.016059517984643595, "entropy": 2.186419187241317, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.7605633802817, "num_grad_updates_lifetime": 159780.5, "diff_num_grad_updates_vs_sampler_policy": 2129.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 688559, "num_agent_steps_trained": 688559}, "env_runners": {"episode_reward_max": -1000.2104800388605, "episode_reward_min": -4209.852445165119, "episode_reward_mean": -2510.4757378677086, "episode_len_mean": 149.71, "episode_media": {}, "episodes_timesteps_total": 14971, "policy_reward_min": {"policy_0": -1384.0936736209478}, "policy_reward_max": {"policy_0": 0.6572367858468204}, "policy_reward_mean": {"policy_0": -502.09514757354174}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3188.7188641738285, -4209.852445165119, -3215.334217111746, -1359.7004884683279, -3215.525790783476, -1408.7350641122864, -1587.7607021510303, -2050.7610026314574, -3780.3305802156115, -1396.0331518356923, -3435.1290412959047, -3789.284932964207, -3066.8402471165123, -2652.8075460912432, -2825.928509181607, -2467.187909815867, -3199.0225914513007, -2242.974786466596, -1217.5992671377103, -2394.6321220581617, -2655.8758969541473, -1800.566277887937, -3827.038983437295, -2127.057498439807, -2073.6230474154286, -2523.3837158948522, -3025.009430533978, -3134.4649836623776, -3683.5143788086, -1671.617358284881, -3244.452801120105, -2496.175256955297, -2052.383783569037, -3308.6814003851455, -2456.961867806281, -2509.247814935382, -1681.6612885101179, -3459.6163484429762, -3495.57590263052, -2500.1941162944504, -1808.7581260312413, -1468.722775490867, -1513.5419178659142, -2263.9894223020738, -2604.803112346386, -2705.53684614442, -1879.64811035474, -2919.546896075055, -2570.779094907372, -3480.9641641154667, -1644.288364914774, -2425.617330975523, -2993.185965777692, -1305.9855307656578, -2035.2694325123648, -2375.993210052046, -2882.857507796229, -2301.7954353890295, -2227.546601898343, -2205.703356590671, -1938.476717496409, -2219.4399016912444, -1545.6099653655538, -3227.117359381162, -3602.8123666532624, -2613.149989736599, -3195.4057712658155, -1900.0757717225672, -3640.1398353915383, -2791.2671847337515, -1352.644107921021, -1556.9804823714865, -2832.473176915525, -1610.2601395155073, -2223.0598802429554, -3128.078797703748, -2252.8703946694886, -2351.5784507246017, -3903.3792503803097, -2466.449890187691, -1386.4570895436523, -3395.1567210647545, -2694.5403090795116, -2125.4519502940143, -2249.446406950195, -3083.7810460686337, -2449.8631478666557, -2492.943930077441, -1505.9254509873592, -3604.5152041839515, -2917.1102238614667, -2763.706725755194, -3645.173835323491, -2796.970066397982, -2836.3854519564256, -2280.9251387252207, -1000.2104800388605, -1255.494858713005, -1771.732132994334, -2394.7195683163145], "episode_lengths": [150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-595.4865428477393, -29.20766408129922, -305.67629568455624, -1233.3854480801174, -1024.9629134801178, -571.6621028406724, -536.0402457229668, -1347.1239363656173, -944.2786454349407, -810.7475148009171, -1105.0378755681497, -699.7760762417455, -480.9279681608222, -801.4620542341506, -128.13024290688045, -609.3633544273405, -219.08908366832844, -249.2583964725278, -238.77953360917857, -43.210120290953306, -516.4367497914676, -303.8271446766001, -458.12971188429407, -1384.0936736209478, -553.0385108101653, -62.45713151413553, -350.69400941128407, -279.12032075388333, -161.187711342393, -555.2758910905902, -888.6033377284531, -87.47797378667748, -148.138919036407, -322.6664817914624, -140.87398980803022, -791.8079531936569, -146.59024656936595, -288.1291057432885, -91.52250387638169, -732.7111932487646, -286.3055433796518, -582.9481857124379, -1017.1944590185947, -562.9824921975946, -1330.899899907334, -58.856682292603175, -11.597507720933816, -135.15545444801876, -325.97943938032535, -864.4440679938107, -335.6669559298093, -923.1585175792808, -957.3418106991514, -914.3916478234206, -304.5701092642409, -679.2429774310693, -797.3165725672036, -940.0092508050086, -410.57592371779407, -962.1402084431315, -310.0820050711687, -1343.114600018014, -491.1479074095252, -808.0025045129104, -114.49323010489225, 0.6572367858468204, -993.3874731151617, -504.43749633404445, -701.1519132419972, -454.4879001858868, -362.06591873582556, -435.26835809373176, -777.5593951665527, -648.0455575075573, -602.9892796779387, -1041.7649200232606, -445.555966951968, -139.6191757631915, -657.873048194175, -182.374798883272, -432.78751073797815, -168.49860782890607, -963.6104414715852, -579.4104818062884, -1054.7155496065448, -317.8553523152842, -673.8961362416184, -535.9963004535169, -659.1798889318912, -56.04710852428873, -62.43172615666989, -32.26156344105739, -632.4070319430186, -352.62186145067886, -137.87708414628665, -63.399396424354244, -357.61854876656366, -129.91212242170775, -896.3163361015426, -947.3857183439931, -307.04443478005226, -729.6777806177356, -756.20809255378, -241.85509389395304, -621.0904951086226, -97.76743076522507, -261.9756910486657, -1260.6282787908688, -165.80972197846728, -14.385155304710588, -1183.805458399072, -1353.3188511710803, -389.35991432271373, -804.5681125369274, -95.98664700750604, -534.5851327300143, -40.829515284550325, -164.71697918378118, -748.3868803698491, -638.5389908716138, -458.1335710439864, -215.395723149564, -530.4361727298514, -562.364133035649, -307.29344745637684, -270.7695999296719, -195.06566480217236, -235.3856669916427, -647.9800987271258, -1174.1826854442377, -326.93961922871875, -385.9231509562225, -630.6593886825478, -758.893274909597, -922.5939967568913, -1071.0907994325019, -68.05400531241277, -1061.2589597935946, -704.4006246016522, -229.6605945222182, -872.7747144984952, -747.8350705451845, -276.6753568696966, -707.3894264511586, -1078.839810444061, -578.4840968576545, -39.766528081312465, -9.386993591003119, -601.6146381897249, -442.3651015651843, -575.2974120780818, -1043.0127785844375, -77.33639815612614, -709.4938763387408, -839.3123359627193, -895.5933814473284, -324.90252197658884, -90.78353428519861, -162.68080072854377, -1022.2150185176349, -152.1525103409849, -724.5957687077945, -243.12105559570338, -365.3403283462341, -567.1741205783213, -1069.7298565225371, -817.9727348945745, -324.26983049980157, -903.7217143961237, -192.98726407210935, -404.6015904354243, -294.24893949424364, -271.15665996081646, -1018.0041113086187, -468.9505666071767, -336.00662885223915, -598.684397121654, -428.90294404126354, -589.0904399461258, -556.5634049741003, -362.97935663720114, -172.040969076647, -89.60219528353286, -565.367210040003, -491.67155747273557, -1090.2647400161593, -688.3059687365885, -479.85943545571, -551.6951371899039, -649.4910670446122, -1214.9234420653727, -787.3001009312134, -539.8090010154907, -914.9430272659972, -38.60033135244954, -857.0907601286956, -87.79299958040325, -155.72137244293688, -463.92824474920803, -935.6607393932059, -870.9895259663263, -74.49500020604671, -156.010336022815, -132.60578188509194, -574.6574819509607, -68.23047991406865, -821.6767231548936, -96.194900509428, -154.24047105025613, -328.38020086221985, -208.97760693666146, -1067.3183593076633, -76.14705469702419, -6.0656067143355195, -155.03329021022907, -660.1763363342819, -632.8681917791705, -194.66196252623038, -340.8948271261723, -435.3881045362189, -419.49429152320613, -249.22249296125398, -704.4239855721341, -261.85051539920494, -969.8118268905847, -405.4797082982583, -39.494621748595755, -293.26340248850323, -1160.1921296730168, -807.106983936048, -400.417332506579, -430.38481495083664, -279.0476574885426, -717.67329814898, -52.1250072598005, -670.264374284439, -641.6288712234074, -104.61358241844518, -554.9174005970532, -948.1226675517107, -161.90065662486006, -73.70985018454385, -733.5638310133885, -930.1698974529544, -671.4348596316249, -684.1440780471349, -803.9084133328371, -1146.3081709787605, -156.56679390227535, -690.036707854458, -873.9547247643808, -295.71020637114214, -186.4993946226326, -243.52508412239757, -44.59895503422138, -1122.4891107659982, -166.22198924660884, -374.4197533500063, -305.06204066553124, -457.42443694737966, -344.77185223331946, -187.54482772376215, -648.2832626460092, -842.9028774327049, -969.6831457418928, -512.4208876365603, -572.0057770244713, -81.53510846809448, -90.16376852737989, -49.859989109153695, -267.0852217365232, -800.1234648625465, -127.79003173490223, -797.226993000814, -43.04372117757876, -195.00960439600027, -804.3638917822883, -383.00484113080057, -934.0895752534327, -59.5252974895256, -29.72126969380192, -340.90391945940416, -1229.6694348578023, -855.4301759042925, -427.1327078809276, -137.43675528246564, -83.02603003473001, -331.5402726981918, -752.0615201189688, -997.730857254674, -137.4623799066478, -330.90327580865227, -252.05801170546502, -808.4095456015898, -698.7133888759889, -905.5724856846945, -233.7924283146524, -249.31665464469975, -706.8124777408027, -110.209310205822, -864.5411021782805, -46.738783036811746, -533.7173393996666, -362.6601103962807, -130.81938248536994, -42.508144557069585, -715.6406673084107, -21.947252855854778, -286.0546011517454, -1153.2892358181616, -11.946165412651128, -102.29134192933745, -1227.9717203042312, -78.09535439370372, -125.30538332563084, -271.89330733942126, -501.3210874944914, -464.30720139569655, -910.438693705598, -1079.157069445952, -816.7151322701476, -362.28393748094726, -555.9073004080734, -1191.3094111963685, -676.5965852977214, -195.87463941287646, -164.83851828998894, -593.2563951051134, -562.7708647888103, -1096.409572139809, -799.0413111156498, -847.1296664686074, -214.55479932362996, -135.79633163045366, -1198.8836627274725, -40.686734349314534, -268.55786955091537, -251.32226486695367, -696.6507075402048, -642.8581954151786, -838.1260994552617, -91.59356118834653, -764.1928774212236, -1238.8881918676398, -707.3391054590666, -1085.034992697026, -600.9878687336567, -28.800345219030827, -721.7109581650768, -354.73301991896045, -316.5756559171251, -445.49576918109733, -155.64619243151913, -24.05929100325282, -410.8671993880274, -52.89599125177901, -789.4972472933654, -49.21831237894096, -430.51810031140707, -234.85083113599467, -39.24863190797161, -55.806707514104076, -882.8261272670542, -1028.3794294832953, -826.2122807431043, -723.7375847861495, -229.40833595348, -188.6282848834177, -103.887485765925, -364.59844812653466, -746.0541743975434, -19.407496156886896, -318.05662031937874, -592.3543590551357, -547.1872303140125, -1025.6698740217764, -54.16759365619834, -621.0574901352466, -519.0807763293296, -908.1030635612012, -71.60852076275626, -807.5522701791872, -594.7501108960646, -424.78765232605525, -354.1718405054249, -993.7311091920351, -80.14705021071784, -31.166648433925744, -1040.8865555730665, -205.64708731485487, -1149.3615637840992, -1309.1199913486241, -324.5160586526766, -41.07384820812423, -1079.3077883867907, -402.0698444696281, -308.82973041883764, -904.6708953719104, -600.5129353159615, -250.3664846113557, -635.2203080105196, -66.91207202944342, -175.42120324976506, -187.98371996226845, -320.91978629165465, -312.5388871720105, -1280.0924730000788, -413.53212342996494, -483.6318973898193, -905.3613400728854, -735.3022270923435, -197.32041754470617, -521.4082471550896, -70.30710459590772, -1170.2023126914623, -801.4679808654381, -265.68859258020416, -226.25902951561923, -555.1121847426701, -276.924162590082, -685.1222943752196, -387.12894376433553, -82.04739701321385, -265.37407021017907, -829.7737015872456, -905.3290072903961, -434.4767035721339, -402.29146746355786, -1131.5603285969717, -210.12353914557497, -126.35340175532029, -614.2663962984436, -1018.5075992181662, -645.1537009232165, -45.582049671510724, -236.51201548689312, -694.9495946074734, -295.8453339277413, -748.9610024157017, -516.6759836396312, -230.82570434580515, -93.44687630041189, -285.6397229495684, -540.4339389236562, -355.57920846791706, -1012.6081074264994, -264.5481731463095, -287.52142483452525, -937.718320160986, -1102.1191786156326, -191.83920113776549, -640.9371965205693, -795.9835731947273, -312.1977550038677, -976.1524980045375, -343.12434890833185, -719.3239730625033, -130.22829457593238, -1062.7655589356286, -508.2645502728025, -805.0895207776944, -100.84696136354229, -820.6668294634228, -973.7996549444274, -944.7708687744079, -9.096529685672078, -1054.0502386607586, -676.3031246377412, -311.562793407742, -745.9573800060643, -1025.014649697509, -139.8447350349461, -37.159432457841994, -561.4658942701805, -1072.9007404959498, -150.3570844464591, -849.2428697841083, -811.8262243736831, -102.42208643383573, -367.07687368713607, -750.827307173534, -65.74522961691788, -69.36550953395502, -36.83838093693246, -77.43405277752137, -63.74435261866131, -1009.8118016482424, -46.06193308908763, -106.68996787017667, -29.186803486837015, -506.0602787811967, -838.494681937898, -26.389185885905132, -227.3998817298871, -173.38810465944897, -678.8842945186153, -54.41901797946106, -112.21797452061782, -531.4146702118232, -1017.7836110857988]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5302266079641365, "mean_inference_ms": 1.7060039976929482, "mean_action_processing_ms": 0.8329907266725294, "mean_env_wait_ms": 10.205485571147134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013277053833007812, "StateBufferConnector_ms": 0.009815454483032227, "ViewRequirementAgentConnector_ms": 0.33361172676086426}, "num_episodes": 37, "episode_return_max": -1000.2104800388605, "episode_return_min": -4209.852445165119, "episode_return_mean": -2510.4757378677086, "episodes_this_iter": 37}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688559, "num_agent_steps_trained": 688559, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 69.42570301505859, "num_env_steps_trained_throughput_per_sec": 69.42570301505859, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 688559, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688559, "timers": {"training_iteration_time_ms": 52376.331, "restore_workers_time_ms": 0.027, "training_step_time_ms": 52376.261, "sample_time_ms": 3239.98, "learn_time_ms": 49079.213, "learn_throughput": 81.501, "synch_weights_time_ms": 54.203}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 688559, "num_agent_steps_trained": 688559}, "done": false, "training_iteration": 39, "trial_id": "efc54_00000", "date": "2024-07-24_19-15-44", "timestamp": 1721828744, "time_this_iter_s": 57.62770700454712, "time_total_s": 2143.0772140026093, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d71feb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2143.0772140026093, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 9.769135802469135, "ram_util_percent": 23.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 123.77627387034492, "cur_kl_coeff": 0.3375, "cur_lr": 0.0010000000000000005, "total_loss": 4.987140188106271, "policy_loss": -0.002789430212811868, "vf_loss": 5.005966640874089, "vf_explained_var": 0.9824558779866812, "kl": 0.015818303805204093, "entropy": 2.137569888740855, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.5813953488372, "num_grad_updates_lifetime": 163845.5, "diff_num_grad_updates_vs_sampler_policy": 1934.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 705017, "num_agent_steps_trained": 705017}, "env_runners": {"episode_reward_max": -1000.2104800388605, "episode_reward_min": -3988.9298356408794, "episode_reward_mean": -2508.802242612763, "episode_len_mean": 149.16, "episode_media": {}, "episodes_timesteps_total": 14916, "policy_reward_min": {"policy_0": -1438.9010242806596}, "policy_reward_max": {"policy_0": -6.0656067143355195}, "policy_reward_mean": {"policy_0": -501.76044852255274}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2655.8758969541473, -1800.566277887937, -3827.038983437295, -2127.057498439807, -2073.6230474154286, -2523.3837158948522, -3025.009430533978, -3134.4649836623776, -3683.5143788086, -1671.617358284881, -3244.452801120105, -2496.175256955297, -2052.383783569037, -3308.6814003851455, -2456.961867806281, -2509.247814935382, -1681.6612885101179, -3459.6163484429762, -3495.57590263052, -2500.1941162944504, -1808.7581260312413, -1468.722775490867, -1513.5419178659142, -2263.9894223020738, -2604.803112346386, -2705.53684614442, -1879.64811035474, -2919.546896075055, -2570.779094907372, -3480.9641641154667, -1644.288364914774, -2425.617330975523, -2993.185965777692, -1305.9855307656578, -2035.2694325123648, -2375.993210052046, -2882.857507796229, -2301.7954353890295, -2227.546601898343, -2205.703356590671, -1938.476717496409, -2219.4399016912444, -1545.6099653655538, -3227.117359381162, -3602.8123666532624, -2613.149989736599, -3195.4057712658155, -1900.0757717225672, -3640.1398353915383, -2791.2671847337515, -1352.644107921021, -1556.9804823714865, -2832.473176915525, -1610.2601395155073, -2223.0598802429554, -3128.078797703748, -2252.8703946694886, -2351.5784507246017, -3903.3792503803097, -2466.449890187691, -1386.4570895436523, -3395.1567210647545, -2694.5403090795116, -2125.4519502940143, -2249.446406950195, -3083.7810460686337, -2449.8631478666557, -2492.943930077441, -1505.9254509873592, -3604.5152041839515, -2917.1102238614667, -2763.706725755194, -3645.173835323491, -2796.970066397982, -2836.3854519564256, -2280.9251387252207, -1000.2104800388605, -1255.494858713005, -1771.732132994334, -2394.7195683163145, -2690.820462436146, -3021.1225691995296, -3692.5331975913705, -2639.9396931860415, -1817.1504189451073, -2905.5092322322425, -1836.3826702378112, -3451.870328435908, -3648.6305666876383, -3988.9298356408794, -2258.8613384009795, -1574.298391302847, -2658.1159776899585, -2964.0704198013727, -3059.586580969282, -1016.9324187196465, -2282.778578319416, -2659.098254846359, -1998.8992819763243, -2371.2795181143133], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150], "policy_policy_0_reward": [-307.04443478005226, -729.6777806177356, -756.20809255378, -241.85509389395304, -621.0904951086226, -97.76743076522507, -261.9756910486657, -1260.6282787908688, -165.80972197846728, -14.385155304710588, -1183.805458399072, -1353.3188511710803, -389.35991432271373, -804.5681125369274, -95.98664700750604, -534.5851327300143, -40.829515284550325, -164.71697918378118, -748.3868803698491, -638.5389908716138, -458.1335710439864, -215.395723149564, -530.4361727298514, -562.364133035649, -307.29344745637684, -270.7695999296719, -195.06566480217236, -235.3856669916427, -647.9800987271258, -1174.1826854442377, -326.93961922871875, -385.9231509562225, -630.6593886825478, -758.893274909597, -922.5939967568913, -1071.0907994325019, -68.05400531241277, -1061.2589597935946, -704.4006246016522, -229.6605945222182, -872.7747144984952, -747.8350705451845, -276.6753568696966, -707.3894264511586, -1078.839810444061, -578.4840968576545, -39.766528081312465, -9.386993591003119, -601.6146381897249, -442.3651015651843, -575.2974120780818, -1043.0127785844375, -77.33639815612614, -709.4938763387408, -839.3123359627193, -895.5933814473284, -324.90252197658884, -90.78353428519861, -162.68080072854377, -1022.2150185176349, -152.1525103409849, -724.5957687077945, -243.12105559570338, -365.3403283462341, -567.1741205783213, -1069.7298565225371, -817.9727348945745, -324.26983049980157, -903.7217143961237, -192.98726407210935, -404.6015904354243, -294.24893949424364, -271.15665996081646, -1018.0041113086187, -468.9505666071767, -336.00662885223915, -598.684397121654, -428.90294404126354, -589.0904399461258, -556.5634049741003, -362.97935663720114, -172.040969076647, -89.60219528353286, -565.367210040003, -491.67155747273557, -1090.2647400161593, -688.3059687365885, -479.85943545571, -551.6951371899039, -649.4910670446122, -1214.9234420653727, -787.3001009312134, -539.8090010154907, -914.9430272659972, -38.60033135244954, -857.0907601286956, -87.79299958040325, -155.72137244293688, -463.92824474920803, -935.6607393932059, -870.9895259663263, -74.49500020604671, -156.010336022815, -132.60578188509194, -574.6574819509607, -68.23047991406865, -821.6767231548936, -96.194900509428, -154.24047105025613, -328.38020086221985, -208.97760693666146, -1067.3183593076633, -76.14705469702419, -6.0656067143355195, -155.03329021022907, -660.1763363342819, -632.8681917791705, -194.66196252623038, -340.8948271261723, -435.3881045362189, -419.49429152320613, -249.22249296125398, -704.4239855721341, -261.85051539920494, -969.8118268905847, -405.4797082982583, -39.494621748595755, -293.26340248850323, -1160.1921296730168, -807.106983936048, -400.417332506579, -430.38481495083664, -279.0476574885426, -717.67329814898, -52.1250072598005, -670.264374284439, -641.6288712234074, -104.61358241844518, -554.9174005970532, -948.1226675517107, -161.90065662486006, -73.70985018454385, -733.5638310133885, -930.1698974529544, -671.4348596316249, -684.1440780471349, -803.9084133328371, -1146.3081709787605, -156.56679390227535, -690.036707854458, -873.9547247643808, -295.71020637114214, -186.4993946226326, -243.52508412239757, -44.59895503422138, -1122.4891107659982, -166.22198924660884, -374.4197533500063, -305.06204066553124, -457.42443694737966, -344.77185223331946, -187.54482772376215, -648.2832626460092, -842.9028774327049, -969.6831457418928, -512.4208876365603, -572.0057770244713, -81.53510846809448, -90.16376852737989, -49.859989109153695, -267.0852217365232, -800.1234648625465, -127.79003173490223, -797.226993000814, -43.04372117757876, -195.00960439600027, -804.3638917822883, -383.00484113080057, -934.0895752534327, -59.5252974895256, -29.72126969380192, -340.90391945940416, -1229.6694348578023, -855.4301759042925, -427.1327078809276, -137.43675528246564, -83.02603003473001, -331.5402726981918, -752.0615201189688, -997.730857254674, -137.4623799066478, -330.90327580865227, -252.05801170546502, -808.4095456015898, -698.7133888759889, -905.5724856846945, -233.7924283146524, -249.31665464469975, -706.8124777408027, -110.209310205822, -864.5411021782805, -46.738783036811746, -533.7173393996666, -362.6601103962807, -130.81938248536994, -42.508144557069585, -715.6406673084107, -21.947252855854778, -286.0546011517454, -1153.2892358181616, -11.946165412651128, -102.29134192933745, -1227.9717203042312, -78.09535439370372, -125.30538332563084, -271.89330733942126, -501.3210874944914, -464.30720139569655, -910.438693705598, -1079.157069445952, -816.7151322701476, -362.28393748094726, -555.9073004080734, -1191.3094111963685, -676.5965852977214, -195.87463941287646, -164.83851828998894, -593.2563951051134, -562.7708647888103, -1096.409572139809, -799.0413111156498, -847.1296664686074, -214.55479932362996, -135.79633163045366, -1198.8836627274725, -40.686734349314534, -268.55786955091537, -251.32226486695367, -696.6507075402048, -642.8581954151786, -838.1260994552617, -91.59356118834653, -764.1928774212236, -1238.8881918676398, -707.3391054590666, -1085.034992697026, -600.9878687336567, -28.800345219030827, -721.7109581650768, -354.73301991896045, -316.5756559171251, -445.49576918109733, -155.64619243151913, -24.05929100325282, -410.8671993880274, -52.89599125177901, -789.4972472933654, -49.21831237894096, -430.51810031140707, -234.85083113599467, -39.24863190797161, -55.806707514104076, -882.8261272670542, -1028.3794294832953, -826.2122807431043, -723.7375847861495, -229.40833595348, -188.6282848834177, -103.887485765925, -364.59844812653466, -746.0541743975434, -19.407496156886896, -318.05662031937874, -592.3543590551357, -547.1872303140125, -1025.6698740217764, -54.16759365619834, -621.0574901352466, -519.0807763293296, -908.1030635612012, -71.60852076275626, -807.5522701791872, -594.7501108960646, -424.78765232605525, -354.1718405054249, -993.7311091920351, -80.14705021071784, -31.166648433925744, -1040.8865555730665, -205.64708731485487, -1149.3615637840992, -1309.1199913486241, -324.5160586526766, -41.07384820812423, -1079.3077883867907, -402.0698444696281, -308.82973041883764, -904.6708953719104, -600.5129353159615, -250.3664846113557, -635.2203080105196, -66.91207202944342, -175.42120324976506, -187.98371996226845, -320.91978629165465, -312.5388871720105, -1280.0924730000788, -413.53212342996494, -483.6318973898193, -905.3613400728854, -735.3022270923435, -197.32041754470617, -521.4082471550896, -70.30710459590772, -1170.2023126914623, -801.4679808654381, -265.68859258020416, -226.25902951561923, -555.1121847426701, -276.924162590082, -685.1222943752196, -387.12894376433553, -82.04739701321385, -265.37407021017907, -829.7737015872456, -905.3290072903961, -434.4767035721339, -402.29146746355786, -1131.5603285969717, -210.12353914557497, -126.35340175532029, -614.2663962984436, -1018.5075992181662, -645.1537009232165, -45.582049671510724, -236.51201548689312, -694.9495946074734, -295.8453339277413, -748.9610024157017, -516.6759836396312, -230.82570434580515, -93.44687630041189, -285.6397229495684, -540.4339389236562, -355.57920846791706, -1012.6081074264994, -264.5481731463095, -287.52142483452525, -937.718320160986, -1102.1191786156326, -191.83920113776549, -640.9371965205693, -795.9835731947273, -312.1977550038677, -976.1524980045375, -343.12434890833185, -719.3239730625033, -130.22829457593238, -1062.7655589356286, -508.2645502728025, -805.0895207776944, -100.84696136354229, -820.6668294634228, -973.7996549444274, -944.7708687744079, -9.096529685672078, -1054.0502386607586, -676.3031246377412, -311.562793407742, -745.9573800060643, -1025.014649697509, -139.8447350349461, -37.159432457841994, -561.4658942701805, -1072.9007404959498, -150.3570844464591, -849.2428697841083, -811.8262243736831, -102.42208643383573, -367.07687368713607, -750.827307173534, -65.74522961691788, -69.36550953395502, -36.83838093693246, -77.43405277752137, -63.74435261866131, -1009.8118016482424, -46.06193308908763, -106.68996787017667, -29.186803486837015, -506.0602787811967, -838.494681937898, -26.389185885905132, -227.3998817298871, -173.38810465944897, -678.8842945186153, -54.41901797946106, -112.21797452061782, -531.4146702118232, -1017.7836110857988, -958.204504166696, -378.9997636166937, -46.38429155977287, -735.5678776870147, -571.6640254059686, -478.7689078239663, -75.34935808783932, -981.6900956636975, -676.9719538255255, -808.342253798503, -200.25014303876537, -1090.9961531027384, -762.4344042434509, -1159.6412574714157, -479.21123973499795, -169.96936198047194, -1309.6299877716883, -952.1857782577899, -107.20287478402442, -100.95169039206921, -374.9102547954518, -162.1144406365172, -187.5255037040626, -998.278801801256, -94.32141800781812, -595.1147356174207, -980.1050094753629, -642.3073447284186, -637.06140090175, -50.920741509289336, -592.9944515651256, -585.6508568540057, -91.99926860118123, -486.927854646897, -78.81023857060059, -804.3081301669833, -1057.0853839676745, -277.6766401198145, -474.08863884375614, -838.7115353376789, -1265.5875166389944, -1438.9010242806596, -21.68228235919976, -772.5244022094524, -149.9353411993321, -697.2921332376831, -1120.9653388938161, -778.993992276555, -252.08145567542843, -1139.5969155573948, -43.3485891918861, -979.7671182128321, -64.2355087993004, -741.2579549144343, -430.2521672825269, -329.9760138797948, -128.77316507558172, -557.342824180738, -536.7041557797156, -21.50223238701847, -1221.21524082462, -206.50181888173339, -169.21120580624637, -182.14495401032812, -879.0427581670319, -835.6438641281045, -481.3190865676224, -584.0657801085584, -724.7709201727672, -338.2707688243178, -584.1746963764245, -99.1575719939909, -703.8985730211971, -770.5515470026095, -901.804192575061, -77.8090503461811, -294.7375056253641, -88.8558699114218, -224.3284049800585, -331.201587856622, -339.66045762975966, -168.45922582934276, -1122.3073305635717, -68.78908016412817, -583.5624841326111, -867.8443956520034, -47.76133956566329, -920.2923485202111, -793.2429262414611, -29.957244867022162, -387.7040310192677, -306.1810300586163, -834.4132394042576, -164.738066091401, -305.8629154027821, -196.58745467605868, -235.00182772124654, -458.504862693794, -320.47365074551624, -1160.7117222776958]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5239798005750973, "mean_inference_ms": 1.7013644210961774, "mean_action_processing_ms": 0.8308542269136753, "mean_env_wait_ms": 10.167002637513818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012964010238647461, "StateBufferConnector_ms": 0.009783744812011719, "ViewRequirementAgentConnector_ms": 0.3334929943084717}, "num_episodes": 20, "episode_return_max": -1000.2104800388605, "episode_return_min": -3988.9298356408794, "episode_return_mean": -2508.802242612763, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 705017, "num_agent_steps_trained": 705017, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 75.40882025977031, "num_env_steps_trained_throughput_per_sec": 75.40882025977031, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 705017, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 705017, "timers": {"training_iteration_time_ms": 52198.373, "restore_workers_time_ms": 0.027, "training_step_time_ms": 52198.302, "sample_time_ms": 3263.842, "learn_time_ms": 48876.474, "learn_throughput": 81.839, "synch_weights_time_ms": 55.079}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 705017, "num_agent_steps_trained": 705017}, "done": false, "training_iteration": 40, "trial_id": "efc54_00000", "date": "2024-07-24_19-16-37", "timestamp": 1721828797, "time_this_iter_s": 53.056352615356445, "time_total_s": 2196.1335666179657, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7e8e50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2196.1335666179657, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 10.230263157894736, "ram_util_percent": 23.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 122.36054127910944, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.726594109485156, "policy_loss": -0.00278566531968985, "vf_loss": 4.745020726972364, "vf_explained_var": 0.9810740244513735, "kl": 0.017697944814153505, "entropy": 2.1614007208291, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.2755905511811, "num_grad_updates_lifetime": 167685.5, "diff_num_grad_updates_vs_sampler_policy": 1904.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 721181, "num_agent_steps_trained": 721181}, "env_runners": {"episode_reward_max": -469.6677668014972, "episode_reward_min": -3988.9298356408794, "episode_reward_mean": -2380.0513441323174, "episode_len_mean": 148.18, "episode_media": {}, "episodes_timesteps_total": 14818, "policy_reward_min": {"policy_0": -1438.9010242806596}, "policy_reward_max": {"policy_0": -9.096529685672078}, "policy_reward_mean": {"policy_0": -476.01026882646346}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2705.53684614442, -1879.64811035474, -2919.546896075055, -2570.779094907372, -3480.9641641154667, -1644.288364914774, -2425.617330975523, -2993.185965777692, -1305.9855307656578, -2035.2694325123648, -2375.993210052046, -2882.857507796229, -2301.7954353890295, -2227.546601898343, -2205.703356590671, -1938.476717496409, -2219.4399016912444, -1545.6099653655538, -3227.117359381162, -3602.8123666532624, -2613.149989736599, -3195.4057712658155, -1900.0757717225672, -3640.1398353915383, -2791.2671847337515, -1352.644107921021, -1556.9804823714865, -2832.473176915525, -1610.2601395155073, -2223.0598802429554, -3128.078797703748, -2252.8703946694886, -2351.5784507246017, -3903.3792503803097, -2466.449890187691, -1386.4570895436523, -3395.1567210647545, -2694.5403090795116, -2125.4519502940143, -2249.446406950195, -3083.7810460686337, -2449.8631478666557, -2492.943930077441, -1505.9254509873592, -3604.5152041839515, -2917.1102238614667, -2763.706725755194, -3645.173835323491, -2796.970066397982, -2836.3854519564256, -2280.9251387252207, -1000.2104800388605, -1255.494858713005, -1771.732132994334, -2394.7195683163145, -2690.820462436146, -3021.1225691995296, -3692.5331975913705, -2639.9396931860415, -1817.1504189451073, -2905.5092322322425, -1836.3826702378112, -3451.870328435908, -3648.6305666876383, -3988.9298356408794, -2258.8613384009795, -1574.298391302847, -2658.1159776899585, -2964.0704198013727, -3059.586580969282, -1016.9324187196465, -2282.778578319416, -2659.098254846359, -1998.8992819763243, -2371.2795181143133, -3421.9366610243233, -1663.3300906635354, -1619.8900405325342, -1519.5481518593367, -2602.7579513526894, -1944.430346424678, -3115.7688982444297, -1795.8058545627016, -2057.716346963361, -1176.0589745255531, -2740.100116494615, -2322.4481215500687, -1746.7474228680617, -2001.5644084614987, -3038.414420535731, -469.6677668014972, -1828.2800965799559, -2672.4709699144023, -1182.3782994723927, -1409.2237986064094, -1762.5214881895056, -1794.93428045501, -2251.6019810323355, -2276.4221393234175, -2097.8090315224185], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 81, 150, 150, 121, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-405.4797082982583, -39.494621748595755, -293.26340248850323, -1160.1921296730168, -807.106983936048, -400.417332506579, -430.38481495083664, -279.0476574885426, -717.67329814898, -52.1250072598005, -670.264374284439, -641.6288712234074, -104.61358241844518, -554.9174005970532, -948.1226675517107, -161.90065662486006, -73.70985018454385, -733.5638310133885, -930.1698974529544, -671.4348596316249, -684.1440780471349, -803.9084133328371, -1146.3081709787605, -156.56679390227535, -690.036707854458, -873.9547247643808, -295.71020637114214, -186.4993946226326, -243.52508412239757, -44.59895503422138, -1122.4891107659982, -166.22198924660884, -374.4197533500063, -305.06204066553124, -457.42443694737966, -344.77185223331946, -187.54482772376215, -648.2832626460092, -842.9028774327049, -969.6831457418928, -512.4208876365603, -572.0057770244713, -81.53510846809448, -90.16376852737989, -49.859989109153695, -267.0852217365232, -800.1234648625465, -127.79003173490223, -797.226993000814, -43.04372117757876, -195.00960439600027, -804.3638917822883, -383.00484113080057, -934.0895752534327, -59.5252974895256, -29.72126969380192, -340.90391945940416, -1229.6694348578023, -855.4301759042925, -427.1327078809276, -137.43675528246564, -83.02603003473001, -331.5402726981918, -752.0615201189688, -997.730857254674, -137.4623799066478, -330.90327580865227, -252.05801170546502, -808.4095456015898, -698.7133888759889, -905.5724856846945, -233.7924283146524, -249.31665464469975, -706.8124777408027, -110.209310205822, -864.5411021782805, -46.738783036811746, -533.7173393996666, -362.6601103962807, -130.81938248536994, -42.508144557069585, -715.6406673084107, -21.947252855854778, -286.0546011517454, -1153.2892358181616, -11.946165412651128, -102.29134192933745, -1227.9717203042312, -78.09535439370372, -125.30538332563084, -271.89330733942126, -501.3210874944914, -464.30720139569655, -910.438693705598, -1079.157069445952, -816.7151322701476, -362.28393748094726, -555.9073004080734, -1191.3094111963685, -676.5965852977214, -195.87463941287646, -164.83851828998894, -593.2563951051134, -562.7708647888103, -1096.409572139809, -799.0413111156498, -847.1296664686074, -214.55479932362996, -135.79633163045366, -1198.8836627274725, -40.686734349314534, -268.55786955091537, -251.32226486695367, -696.6507075402048, -642.8581954151786, -838.1260994552617, -91.59356118834653, -764.1928774212236, -1238.8881918676398, -707.3391054590666, -1085.034992697026, -600.9878687336567, -28.800345219030827, -721.7109581650768, -354.73301991896045, -316.5756559171251, -445.49576918109733, -155.64619243151913, -24.05929100325282, -410.8671993880274, -52.89599125177901, -789.4972472933654, -49.21831237894096, -430.51810031140707, -234.85083113599467, -39.24863190797161, -55.806707514104076, -882.8261272670542, -1028.3794294832953, -826.2122807431043, -723.7375847861495, -229.40833595348, -188.6282848834177, -103.887485765925, -364.59844812653466, -746.0541743975434, -19.407496156886896, -318.05662031937874, -592.3543590551357, -547.1872303140125, -1025.6698740217764, -54.16759365619834, -621.0574901352466, -519.0807763293296, -908.1030635612012, -71.60852076275626, -807.5522701791872, -594.7501108960646, -424.78765232605525, -354.1718405054249, -993.7311091920351, -80.14705021071784, -31.166648433925744, -1040.8865555730665, -205.64708731485487, -1149.3615637840992, -1309.1199913486241, -324.5160586526766, -41.07384820812423, -1079.3077883867907, -402.0698444696281, -308.82973041883764, -904.6708953719104, -600.5129353159615, -250.3664846113557, -635.2203080105196, -66.91207202944342, -175.42120324976506, -187.98371996226845, -320.91978629165465, -312.5388871720105, -1280.0924730000788, -413.53212342996494, -483.6318973898193, -905.3613400728854, -735.3022270923435, -197.32041754470617, -521.4082471550896, -70.30710459590772, -1170.2023126914623, -801.4679808654381, -265.68859258020416, -226.25902951561923, -555.1121847426701, -276.924162590082, -685.1222943752196, -387.12894376433553, -82.04739701321385, -265.37407021017907, -829.7737015872456, -905.3290072903961, -434.4767035721339, -402.29146746355786, -1131.5603285969717, -210.12353914557497, -126.35340175532029, -614.2663962984436, -1018.5075992181662, -645.1537009232165, -45.582049671510724, -236.51201548689312, -694.9495946074734, -295.8453339277413, -748.9610024157017, -516.6759836396312, -230.82570434580515, -93.44687630041189, -285.6397229495684, -540.4339389236562, -355.57920846791706, -1012.6081074264994, -264.5481731463095, -287.52142483452525, -937.718320160986, -1102.1191786156326, -191.83920113776549, -640.9371965205693, -795.9835731947273, -312.1977550038677, -976.1524980045375, -343.12434890833185, -719.3239730625033, -130.22829457593238, -1062.7655589356286, -508.2645502728025, -805.0895207776944, -100.84696136354229, -820.6668294634228, -973.7996549444274, -944.7708687744079, -9.096529685672078, -1054.0502386607586, -676.3031246377412, -311.562793407742, -745.9573800060643, -1025.014649697509, -139.8447350349461, -37.159432457841994, -561.4658942701805, -1072.9007404959498, -150.3570844464591, -849.2428697841083, -811.8262243736831, -102.42208643383573, -367.07687368713607, -750.827307173534, -65.74522961691788, -69.36550953395502, -36.83838093693246, -77.43405277752137, -63.74435261866131, -1009.8118016482424, -46.06193308908763, -106.68996787017667, -29.186803486837015, -506.0602787811967, -838.494681937898, -26.389185885905132, -227.3998817298871, -173.38810465944897, -678.8842945186153, -54.41901797946106, -112.21797452061782, -531.4146702118232, -1017.7836110857988, -958.204504166696, -378.9997636166937, -46.38429155977287, -735.5678776870147, -571.6640254059686, -478.7689078239663, -75.34935808783932, -981.6900956636975, -676.9719538255255, -808.342253798503, -200.25014303876537, -1090.9961531027384, -762.4344042434509, -1159.6412574714157, -479.21123973499795, -169.96936198047194, -1309.6299877716883, -952.1857782577899, -107.20287478402442, -100.95169039206921, -374.9102547954518, -162.1144406365172, -187.5255037040626, -998.278801801256, -94.32141800781812, -595.1147356174207, -980.1050094753629, -642.3073447284186, -637.06140090175, -50.920741509289336, -592.9944515651256, -585.6508568540057, -91.99926860118123, -486.927854646897, -78.81023857060059, -804.3081301669833, -1057.0853839676745, -277.6766401198145, -474.08863884375614, -838.7115353376789, -1265.5875166389944, -1438.9010242806596, -21.68228235919976, -772.5244022094524, -149.9353411993321, -697.2921332376831, -1120.9653388938161, -778.993992276555, -252.08145567542843, -1139.5969155573948, -43.3485891918861, -979.7671182128321, -64.2355087993004, -741.2579549144343, -430.2521672825269, -329.9760138797948, -128.77316507558172, -557.342824180738, -536.7041557797156, -21.50223238701847, -1221.21524082462, -206.50181888173339, -169.21120580624637, -182.14495401032812, -879.0427581670319, -835.6438641281045, -481.3190865676224, -584.0657801085584, -724.7709201727672, -338.2707688243178, -584.1746963764245, -99.1575719939909, -703.8985730211971, -770.5515470026095, -901.804192575061, -77.8090503461811, -294.7375056253641, -88.8558699114218, -224.3284049800585, -331.201587856622, -339.66045762975966, -168.45922582934276, -1122.3073305635717, -68.78908016412817, -583.5624841326111, -867.8443956520034, -47.76133956566329, -920.2923485202111, -793.2429262414611, -29.957244867022162, -387.7040310192677, -306.1810300586163, -834.4132394042576, -164.738066091401, -305.8629154027821, -196.58745467605868, -235.00182772124654, -458.504862693794, -320.47365074551624, -1160.7117222776958, -727.6006259907568, -413.94086059153, -132.1637326805156, -1252.1916432586524, -896.0397985028644, -172.2140163267814, -254.02737940319778, -110.31360564224579, -968.4940951441106, -158.2809941472014, -124.04112607869602, -77.46597968692798, -574.1543993272221, -651.2202161278551, -193.00831931183203, -805.3790083443096, -22.201943013345154, -124.98363673797485, -378.06723664542034, -188.91632711828686, -220.5961739171601, -771.7549624233814, -1395.3317841481721, -117.15166868857438, -97.92336217539834, -849.4671711168387, -469.3106787006018, -28.196209420178842, -110.91557263456542, -486.54071455249357, -424.9481897733273, -814.2306615630748, -488.2870587383199, -583.6707000931673, -804.6322880765448, -989.3996062134812, -21.68361036956251, -104.05621806839513, -426.3842626732036, -254.28215723805974, -698.2134295400413, -34.73670406018761, -661.3604605820268, -527.6518115314688, -135.75394124963609, -22.475687984623143, -172.87948417062424, -317.9452656430908, -307.1283385830926, -355.63019814412326, -82.28125076509441, -737.85557477884, -742.2991144108829, -787.5359002083708, -390.12827633142956, -839.643150707471, -264.98626090299115, -333.1189079080376, -366.61414617426476, -518.0856558573082, -168.7959414236083, -68.52005770075374, -582.1803483948777, -235.24216117966014, -692.0089141691615, -73.45145255690096, -285.8715226954451, -776.0594948919053, -279.9433971427035, -586.2385411745402, -812.7995770075315, -433.43965469827737, -1235.5324536958399, -349.37120432259917, -207.2715308114833, -38.95073962496271, -28.899424447234566, -142.76815891524478, -57.81130090024081, -201.2381429138144, -489.4625970439521, -193.74718388246694, -566.3753885003048, -85.48026240274845, -493.21466475048067, -647.0423111813192, -752.6641374812942, -478.88844309994454, -468.9889841490561, -324.88709400278424, -221.639933108325, -238.7078544702456, -243.23238474484, -305.46279341545494, -173.33533373352773, -31.266533973021705, -368.04077000844956, -72.79544216799992, -497.6086165626422, -439.51243589429527, -252.7102446520886, -652.6828874673075, -84.2991827617319, -714.1334183399111, -58.69575496846558, -434.4249123179025, -977.0927326753106, -151.237217416525, -60.8070214597266, -171.3723965855463, -941.8501802805253, -449.3751102756739, -176.47680520418982, -105.84889380553945, -578.0509914664074, -153.70971593611478, -804.2376382407342, -505.7804453574234, -65.3522132575394, -747.3421265316067, -479.4908642760421, -826.5311218409893, -149.22258893901548, -261.6337651625953, -380.9306913037761]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.521863644859525, "mean_inference_ms": 1.7020776426788728, "mean_action_processing_ms": 0.8281835824818299, "mean_env_wait_ms": 10.155197702622205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012820959091186523, "StateBufferConnector_ms": 0.009603023529052734, "ViewRequirementAgentConnector_ms": 0.32340192794799805}, "num_episodes": 25, "episode_return_max": -469.6677668014972, "episode_return_min": -3988.9298356408794, "episode_return_mean": -2380.0513441323174, "episodes_this_iter": 25}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 721181, "num_agent_steps_trained": 721181, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 96.41948327098102, "num_env_steps_trained_throughput_per_sec": 96.41948327098102, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 721181, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 721181, "timers": {"training_iteration_time_ms": 50825.157, "restore_workers_time_ms": 0.03, "training_step_time_ms": 50825.081, "sample_time_ms": 3222.211, "learn_time_ms": 47544.383, "learn_throughput": 84.132, "synch_weights_time_ms": 55.591}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 721181, "num_agent_steps_trained": 721181}, "done": false, "training_iteration": 41, "trial_id": "efc54_00000", "date": "2024-07-24_19-17-19", "timestamp": 1721828839, "time_this_iter_s": 41.496689558029175, "time_total_s": 2237.630256175995, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d71eef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2237.630256175995, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 10.754237288135593, "ram_util_percent": 23.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 123.20804627411557, "cur_kl_coeff": 0.33750000000000013, "cur_lr": 0.0010000000000000005, "total_loss": 4.978744155821139, "policy_loss": -0.0010900299923625885, "vf_loss": 4.996436382616233, "vf_explained_var": 0.9800293184544918, "kl": 0.015989496104205095, "entropy": 2.199865517506054, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.36496350364963, "num_grad_updates_lifetime": 171645.5, "diff_num_grad_updates_vs_sampler_policy": 2054.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 738630, "num_agent_steps_trained": 738630}, "env_runners": {"episode_reward_max": -469.6677668014972, "episode_reward_min": -5081.547942179091, "episode_reward_mean": -2376.450929312058, "episode_len_mean": 147.85, "episode_media": {}, "episodes_timesteps_total": 14785, "policy_reward_min": {"policy_0": -1438.9010242806596}, "policy_reward_max": {"policy_0": -3.193359769360341}, "policy_reward_mean": {"policy_0": -475.2901858624116}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1386.4570895436523, -3395.1567210647545, -2694.5403090795116, -2125.4519502940143, -2249.446406950195, -3083.7810460686337, -2449.8631478666557, -2492.943930077441, -1505.9254509873592, -3604.5152041839515, -2917.1102238614667, -2763.706725755194, -3645.173835323491, -2796.970066397982, -2836.3854519564256, -2280.9251387252207, -1000.2104800388605, -1255.494858713005, -1771.732132994334, -2394.7195683163145, -2690.820462436146, -3021.1225691995296, -3692.5331975913705, -2639.9396931860415, -1817.1504189451073, -2905.5092322322425, -1836.3826702378112, -3451.870328435908, -3648.6305666876383, -3988.9298356408794, -2258.8613384009795, -1574.298391302847, -2658.1159776899585, -2964.0704198013727, -3059.586580969282, -1016.9324187196465, -2282.778578319416, -2659.098254846359, -1998.8992819763243, -2371.2795181143133, -3421.9366610243233, -1663.3300906635354, -1619.8900405325342, -1519.5481518593367, -2602.7579513526894, -1944.430346424678, -3115.7688982444297, -1795.8058545627016, -2057.716346963361, -1176.0589745255531, -2740.100116494615, -2322.4481215500687, -1746.7474228680617, -2001.5644084614987, -3038.414420535731, -469.6677668014972, -1828.2800965799559, -2672.4709699144023, -1182.3782994723927, -1409.2237986064094, -1762.5214881895056, -1794.93428045501, -2251.6019810323355, -2276.4221393234175, -2097.8090315224185, -811.7836171162173, -1893.3484749541446, -2440.3272232049785, -1381.07996431623, -3420.137366123668, -2132.848071068883, -3529.277565283728, -2834.108215818932, -2032.6078760010114, -2442.932562139347, -1625.6710448111344, -2358.007164710403, -3021.9855696476807, -2962.1147094050243, -3503.559515573591, -1661.1056956215727, -1981.3924712469416, -5081.547942179091, -2810.5455012592793, -2448.7006564826247, -2279.18770922574, -2492.7046900180085, -3021.2220249989737, -3346.0641730017906, -2708.7391879903216, -907.8161176158593, -2501.461101006315, -2444.6217790836195, -2045.8932535818087, -1866.9612353350242, -1894.6633146341837, -1683.4856535681884, -3059.5519466073474, -2568.0820997863407, -2752.410306895692], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 81, 150, 150, 121, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-635.2203080105196, -66.91207202944342, -175.42120324976506, -187.98371996226845, -320.91978629165465, -312.5388871720105, -1280.0924730000788, -413.53212342996494, -483.6318973898193, -905.3613400728854, -735.3022270923435, -197.32041754470617, -521.4082471550896, -70.30710459590772, -1170.2023126914623, -801.4679808654381, -265.68859258020416, -226.25902951561923, -555.1121847426701, -276.924162590082, -685.1222943752196, -387.12894376433553, -82.04739701321385, -265.37407021017907, -829.7737015872456, -905.3290072903961, -434.4767035721339, -402.29146746355786, -1131.5603285969717, -210.12353914557497, -126.35340175532029, -614.2663962984436, -1018.5075992181662, -645.1537009232165, -45.582049671510724, -236.51201548689312, -694.9495946074734, -295.8453339277413, -748.9610024157017, -516.6759836396312, -230.82570434580515, -93.44687630041189, -285.6397229495684, -540.4339389236562, -355.57920846791706, -1012.6081074264994, -264.5481731463095, -287.52142483452525, -937.718320160986, -1102.1191786156326, -191.83920113776549, -640.9371965205693, -795.9835731947273, -312.1977550038677, -976.1524980045375, -343.12434890833185, -719.3239730625033, -130.22829457593238, -1062.7655589356286, -508.2645502728025, -805.0895207776944, -100.84696136354229, -820.6668294634228, -973.7996549444274, -944.7708687744079, -9.096529685672078, -1054.0502386607586, -676.3031246377412, -311.562793407742, -745.9573800060643, -1025.014649697509, -139.8447350349461, -37.159432457841994, -561.4658942701805, -1072.9007404959498, -150.3570844464591, -849.2428697841083, -811.8262243736831, -102.42208643383573, -367.07687368713607, -750.827307173534, -65.74522961691788, -69.36550953395502, -36.83838093693246, -77.43405277752137, -63.74435261866131, -1009.8118016482424, -46.06193308908763, -106.68996787017667, -29.186803486837015, -506.0602787811967, -838.494681937898, -26.389185885905132, -227.3998817298871, -173.38810465944897, -678.8842945186153, -54.41901797946106, -112.21797452061782, -531.4146702118232, -1017.7836110857988, -958.204504166696, -378.9997636166937, -46.38429155977287, -735.5678776870147, -571.6640254059686, -478.7689078239663, -75.34935808783932, -981.6900956636975, -676.9719538255255, -808.342253798503, -200.25014303876537, -1090.9961531027384, -762.4344042434509, -1159.6412574714157, -479.21123973499795, -169.96936198047194, -1309.6299877716883, -952.1857782577899, -107.20287478402442, -100.95169039206921, -374.9102547954518, -162.1144406365172, -187.5255037040626, -998.278801801256, -94.32141800781812, -595.1147356174207, -980.1050094753629, -642.3073447284186, -637.06140090175, -50.920741509289336, -592.9944515651256, -585.6508568540057, -91.99926860118123, -486.927854646897, -78.81023857060059, -804.3081301669833, -1057.0853839676745, -277.6766401198145, -474.08863884375614, -838.7115353376789, -1265.5875166389944, -1438.9010242806596, -21.68228235919976, -772.5244022094524, -149.9353411993321, -697.2921332376831, -1120.9653388938161, -778.993992276555, -252.08145567542843, -1139.5969155573948, -43.3485891918861, -979.7671182128321, -64.2355087993004, -741.2579549144343, -430.2521672825269, -329.9760138797948, -128.77316507558172, -557.342824180738, -536.7041557797156, -21.50223238701847, -1221.21524082462, -206.50181888173339, -169.21120580624637, -182.14495401032812, -879.0427581670319, -835.6438641281045, -481.3190865676224, -584.0657801085584, -724.7709201727672, -338.2707688243178, -584.1746963764245, -99.1575719939909, -703.8985730211971, -770.5515470026095, -901.804192575061, -77.8090503461811, -294.7375056253641, -88.8558699114218, -224.3284049800585, -331.201587856622, -339.66045762975966, -168.45922582934276, -1122.3073305635717, -68.78908016412817, -583.5624841326111, -867.8443956520034, -47.76133956566329, -920.2923485202111, -793.2429262414611, -29.957244867022162, -387.7040310192677, -306.1810300586163, -834.4132394042576, -164.738066091401, -305.8629154027821, -196.58745467605868, -235.00182772124654, -458.504862693794, -320.47365074551624, -1160.7117222776958, -727.6006259907568, -413.94086059153, -132.1637326805156, -1252.1916432586524, -896.0397985028644, -172.2140163267814, -254.02737940319778, -110.31360564224579, -968.4940951441106, -158.2809941472014, -124.04112607869602, -77.46597968692798, -574.1543993272221, -651.2202161278551, -193.00831931183203, -805.3790083443096, -22.201943013345154, -124.98363673797485, -378.06723664542034, -188.91632711828686, -220.5961739171601, -771.7549624233814, -1395.3317841481721, -117.15166868857438, -97.92336217539834, -849.4671711168387, -469.3106787006018, -28.196209420178842, -110.91557263456542, -486.54071455249357, -424.9481897733273, -814.2306615630748, -488.2870587383199, -583.6707000931673, -804.6322880765448, -989.3996062134812, -21.68361036956251, -104.05621806839513, -426.3842626732036, -254.28215723805974, -698.2134295400413, -34.73670406018761, -661.3604605820268, -527.6518115314688, -135.75394124963609, -22.475687984623143, -172.87948417062424, -317.9452656430908, -307.1283385830926, -355.63019814412326, -82.28125076509441, -737.85557477884, -742.2991144108829, -787.5359002083708, -390.12827633142956, -839.643150707471, -264.98626090299115, -333.1189079080376, -366.61414617426476, -518.0856558573082, -168.7959414236083, -68.52005770075374, -582.1803483948777, -235.24216117966014, -692.0089141691615, -73.45145255690096, -285.8715226954451, -776.0594948919053, -279.9433971427035, -586.2385411745402, -812.7995770075315, -433.43965469827737, -1235.5324536958399, -349.37120432259917, -207.2715308114833, -38.95073962496271, -28.899424447234566, -142.76815891524478, -57.81130090024081, -201.2381429138144, -489.4625970439521, -193.74718388246694, -566.3753885003048, -85.48026240274845, -493.21466475048067, -647.0423111813192, -752.6641374812942, -478.88844309994454, -468.9889841490561, -324.88709400278424, -221.639933108325, -238.7078544702456, -243.23238474484, -305.46279341545494, -173.33533373352773, -31.266533973021705, -368.04077000844956, -72.79544216799992, -497.6086165626422, -439.51243589429527, -252.7102446520886, -652.6828874673075, -84.2991827617319, -714.1334183399111, -58.69575496846558, -434.4249123179025, -977.0927326753106, -151.237217416525, -60.8070214597266, -171.3723965855463, -941.8501802805253, -449.3751102756739, -176.47680520418982, -105.84889380553945, -578.0509914664074, -153.70971593611478, -804.2376382407342, -505.7804453574234, -65.3522132575394, -747.3421265316067, -479.4908642760421, -826.5311218409893, -149.22258893901548, -261.6337651625953, -380.9306913037761, -77.79783140129015, -401.7070595381963, -46.85166012880972, -251.88511939632997, -33.5419466515919, -729.3986819012646, -248.52810040972682, -39.16303609033096, -819.3174425834675, -56.941213969353534, -45.85790073449012, -168.92343234103035, -1014.5492434960487, -432.7200267928408, -778.2766198405658, -749.6041686771334, -159.50141421661326, -137.71899228705635, -106.35853099178708, -227.89685814363938, -845.1059156134015, -1080.9264543492166, -449.3829280693102, -175.02200002060906, -869.7000680711286, -311.3090718975743, -663.0106671037476, -181.04592375228313, -792.8409732921965, -184.64143502308306, -925.9908964111036, -880.5408592312381, -556.451848130163, -174.109660091384, -992.1843014198361, -94.489634049628, -1116.6086912154924, -785.6006252821197, -564.3556985333215, -273.0535667383713, -158.65309520013724, -133.17254591630794, -1156.1435051427247, -295.7998954129538, -288.8388343288879, -126.3133679769384, -516.2578750535855, -340.9247096464789, -423.6247997089521, -1035.8118097533913, -341.14354699518327, -61.789880435539594, -193.64323974200062, -146.48422438167472, -882.6101532567372, -241.0683793300603, -387.2877466925057, -1170.735258038601, -143.42921118334573, -415.4865694658899, -381.77317771162035, -756.2540598879885, -502.6387700202026, -474.8236461986351, -906.495915829235, -683.5058486541268, -546.7026871116053, -362.5405129853019, -1024.2194969556986, -345.14616369829423, -1173.9956306944673, -38.342664409543495, -534.6407002320279, -815.261277353601, -941.3192428839501, -36.80910464730901, -75.40662063486701, -204.43515443882882, -1297.7436183208174, -46.71119757975043, -433.31217413558056, -3.193359769360341, -668.9333927718914, -308.34999479073775, -567.6035497793725, -614.3930856143719, -966.5552853934843, -1276.174772989487, -936.9667637900212, -1287.4580343917298, -61.15488298022149, -964.2000244962585, -150.56386772992957, -848.7534209128597, -785.8733051400106, -860.456121966401, -255.43590356519735, -986.9372671280934, -108.80828086629715, -237.06308295663518, -488.87657023463856, -503.28521841196965, -104.01151680510606, -748.7964988509124, -434.2179049231123, -855.2329694597225, -259.7595813910366, -92.13095904074929, -367.8867601140751, -917.6944200124257, -477.30756640077857, -1098.0254283203496, -298.2836192724102, -242.28110972665917, -905.3243012787776, -188.7533958557951, -449.51192017095485, -925.3039266965164, -617.9425290167515, -1164.5524012617748, -450.6538819659182, -785.1815232940745, -403.81894686784347, -330.02342978283195, -739.0614060796485, -116.60473227102887, -82.33304568484738, -330.10887846939534, -99.57869606500138, -279.19076512558496, -789.0990352112905, -110.08670081264555, -432.5360728497997, -385.1412393084053, -784.5980528241735, -945.8919993717063, -568.5399732604193, -103.96865877700388, -509.3247365412593, -316.8964111332315, -30.872542693734374, -52.1249802184736, -810.0152318894208, -192.22586656060582, -960.6546322195724, -92.92540640958124, -805.536057719825, -162.06074256991744, -559.3626005105295, -247.07642812517145, -747.6177330864664, -390.3327559625372, -64.12152260297489, -642.3217624356593, -50.26954054654625, -96.62404832824532, -101.78794791707662, -648.3820016592815, -24.913727122814148, -811.7779285407719, -422.0156000940483, -955.7971295946882, -122.60099477858353, -762.8563941066053, -796.2818280334252, -475.5046592148629, -504.007034692059, -849.3714844091894, -186.62155506055296, -552.577366409677, -763.4094401273164, -568.911843091814, -952.6594132405664, -221.23481107081832, -246.19479936517587]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5219655022672973, "mean_inference_ms": 1.7035429256214079, "mean_action_processing_ms": 0.8259556377685261, "mean_env_wait_ms": 10.153462396150065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012973785400390625, "StateBufferConnector_ms": 0.009415864944458008, "ViewRequirementAgentConnector_ms": 0.31404829025268555}, "num_episodes": 35, "episode_return_max": -469.6677668014972, "episode_return_min": -5081.547942179091, "episode_return_mean": -2376.450929312058, "episodes_this_iter": 35}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 738630, "num_agent_steps_trained": 738630, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 69.49939954029247, "num_env_steps_trained_throughput_per_sec": 69.49939954029247, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 738630, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 738630, "timers": {"training_iteration_time_ms": 51508.271, "restore_workers_time_ms": 0.029, "training_step_time_ms": 51508.195, "sample_time_ms": 3218.557, "learn_time_ms": 48230.824, "learn_throughput": 82.935, "synch_weights_time_ms": 55.856}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 738630, "num_agent_steps_trained": 738630}, "done": false, "training_iteration": 42, "trial_id": "efc54_00000", "date": "2024-07-24_19-18-17", "timestamp": 1721828897, "time_this_iter_s": 57.56615614891052, "time_total_s": 2295.1964123249054, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7add80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2295.1964123249054, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 9.662962962962963, "ram_util_percent": 23.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 131.74265913186517, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.118828931667452, "policy_loss": -0.0023685158726952987, "vf_loss": 5.136602013929744, "vf_explained_var": 0.9777114194287991, "kl": 0.016441841315550154, "entropy": 2.0953690582947027, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.51127819548873, "num_grad_updates_lifetime": 175695.5, "diff_num_grad_updates_vs_sampler_policy": 1994.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 755589, "num_agent_steps_trained": 755589}, "env_runners": {"episode_reward_max": -469.6677668014972, "episode_reward_min": -5081.547942179091, "episode_reward_mean": -2402.6447193694576, "episode_len_mean": 147.85, "episode_media": {}, "episodes_timesteps_total": 14785, "policy_reward_min": {"policy_0": -1438.9010242806596}, "policy_reward_max": {"policy_0": -3.193359769360341}, "policy_reward_mean": {"policy_0": -480.52894387389136}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3692.5331975913705, -2639.9396931860415, -1817.1504189451073, -2905.5092322322425, -1836.3826702378112, -3451.870328435908, -3648.6305666876383, -3988.9298356408794, -2258.8613384009795, -1574.298391302847, -2658.1159776899585, -2964.0704198013727, -3059.586580969282, -1016.9324187196465, -2282.778578319416, -2659.098254846359, -1998.8992819763243, -2371.2795181143133, -3421.9366610243233, -1663.3300906635354, -1619.8900405325342, -1519.5481518593367, -2602.7579513526894, -1944.430346424678, -3115.7688982444297, -1795.8058545627016, -2057.716346963361, -1176.0589745255531, -2740.100116494615, -2322.4481215500687, -1746.7474228680617, -2001.5644084614987, -3038.414420535731, -469.6677668014972, -1828.2800965799559, -2672.4709699144023, -1182.3782994723927, -1409.2237986064094, -1762.5214881895056, -1794.93428045501, -2251.6019810323355, -2276.4221393234175, -2097.8090315224185, -811.7836171162173, -1893.3484749541446, -2440.3272232049785, -1381.07996431623, -3420.137366123668, -2132.848071068883, -3529.277565283728, -2834.108215818932, -2032.6078760010114, -2442.932562139347, -1625.6710448111344, -2358.007164710403, -3021.9855696476807, -2962.1147094050243, -3503.559515573591, -1661.1056956215727, -1981.3924712469416, -5081.547942179091, -2810.5455012592793, -2448.7006564826247, -2279.18770922574, -2492.7046900180085, -3021.2220249989737, -3346.0641730017906, -2708.7391879903216, -907.8161176158593, -2501.461101006315, -2444.6217790836195, -2045.8932535818087, -1866.9612353350242, -1894.6633146341837, -1683.4856535681884, -3059.5519466073474, -2568.0820997863407, -2752.410306895692, -2692.9457713994116, -2817.5128872242085, -2869.288699797743, -2469.049260054385, -1835.413563983479, -3140.6814545976235, -1847.9619910986682, -2757.7674188361475, -1651.4593098707103, -3305.4411257643005, -1800.1349533269008, -3819.9846551477162, -1459.3159706353913, -2464.024690035863, -1715.0302343464289, -2174.806275149466, -4191.03787381513, -2970.6701790947063, -2879.738857296035, -2055.302969056811, -4382.107502563841, -1682.15613247911], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 81, 150, 150, 121, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-200.25014303876537, -1090.9961531027384, -762.4344042434509, -1159.6412574714157, -479.21123973499795, -169.96936198047194, -1309.6299877716883, -952.1857782577899, -107.20287478402442, -100.95169039206921, -374.9102547954518, -162.1144406365172, -187.5255037040626, -998.278801801256, -94.32141800781812, -595.1147356174207, -980.1050094753629, -642.3073447284186, -637.06140090175, -50.920741509289336, -592.9944515651256, -585.6508568540057, -91.99926860118123, -486.927854646897, -78.81023857060059, -804.3081301669833, -1057.0853839676745, -277.6766401198145, -474.08863884375614, -838.7115353376789, -1265.5875166389944, -1438.9010242806596, -21.68228235919976, -772.5244022094524, -149.9353411993321, -697.2921332376831, -1120.9653388938161, -778.993992276555, -252.08145567542843, -1139.5969155573948, -43.3485891918861, -979.7671182128321, -64.2355087993004, -741.2579549144343, -430.2521672825269, -329.9760138797948, -128.77316507558172, -557.342824180738, -536.7041557797156, -21.50223238701847, -1221.21524082462, -206.50181888173339, -169.21120580624637, -182.14495401032812, -879.0427581670319, -835.6438641281045, -481.3190865676224, -584.0657801085584, -724.7709201727672, -338.2707688243178, -584.1746963764245, -99.1575719939909, -703.8985730211971, -770.5515470026095, -901.804192575061, -77.8090503461811, -294.7375056253641, -88.8558699114218, -224.3284049800585, -331.201587856622, -339.66045762975966, -168.45922582934276, -1122.3073305635717, -68.78908016412817, -583.5624841326111, -867.8443956520034, -47.76133956566329, -920.2923485202111, -793.2429262414611, -29.957244867022162, -387.7040310192677, -306.1810300586163, -834.4132394042576, -164.738066091401, -305.8629154027821, -196.58745467605868, -235.00182772124654, -458.504862693794, -320.47365074551624, -1160.7117222776958, -727.6006259907568, -413.94086059153, -132.1637326805156, -1252.1916432586524, -896.0397985028644, -172.2140163267814, -254.02737940319778, -110.31360564224579, -968.4940951441106, -158.2809941472014, -124.04112607869602, -77.46597968692798, -574.1543993272221, -651.2202161278551, -193.00831931183203, -805.3790083443096, -22.201943013345154, -124.98363673797485, -378.06723664542034, -188.91632711828686, -220.5961739171601, -771.7549624233814, -1395.3317841481721, -117.15166868857438, -97.92336217539834, -849.4671711168387, -469.3106787006018, -28.196209420178842, -110.91557263456542, -486.54071455249357, -424.9481897733273, -814.2306615630748, -488.2870587383199, -583.6707000931673, -804.6322880765448, -989.3996062134812, -21.68361036956251, -104.05621806839513, -426.3842626732036, -254.28215723805974, -698.2134295400413, -34.73670406018761, -661.3604605820268, -527.6518115314688, -135.75394124963609, -22.475687984623143, -172.87948417062424, -317.9452656430908, -307.1283385830926, -355.63019814412326, -82.28125076509441, -737.85557477884, -742.2991144108829, -787.5359002083708, -390.12827633142956, -839.643150707471, -264.98626090299115, -333.1189079080376, -366.61414617426476, -518.0856558573082, -168.7959414236083, -68.52005770075374, -582.1803483948777, -235.24216117966014, -692.0089141691615, -73.45145255690096, -285.8715226954451, -776.0594948919053, -279.9433971427035, -586.2385411745402, -812.7995770075315, -433.43965469827737, -1235.5324536958399, -349.37120432259917, -207.2715308114833, -38.95073962496271, -28.899424447234566, -142.76815891524478, -57.81130090024081, -201.2381429138144, -489.4625970439521, -193.74718388246694, -566.3753885003048, -85.48026240274845, -493.21466475048067, -647.0423111813192, -752.6641374812942, -478.88844309994454, -468.9889841490561, -324.88709400278424, -221.639933108325, -238.7078544702456, -243.23238474484, -305.46279341545494, -173.33533373352773, -31.266533973021705, -368.04077000844956, -72.79544216799992, -497.6086165626422, -439.51243589429527, -252.7102446520886, -652.6828874673075, -84.2991827617319, -714.1334183399111, -58.69575496846558, -434.4249123179025, -977.0927326753106, -151.237217416525, -60.8070214597266, -171.3723965855463, -941.8501802805253, -449.3751102756739, -176.47680520418982, -105.84889380553945, -578.0509914664074, -153.70971593611478, -804.2376382407342, -505.7804453574234, -65.3522132575394, -747.3421265316067, -479.4908642760421, -826.5311218409893, -149.22258893901548, -261.6337651625953, -380.9306913037761, -77.79783140129015, -401.7070595381963, -46.85166012880972, -251.88511939632997, -33.5419466515919, -729.3986819012646, -248.52810040972682, -39.16303609033096, -819.3174425834675, -56.941213969353534, -45.85790073449012, -168.92343234103035, -1014.5492434960487, -432.7200267928408, -778.2766198405658, -749.6041686771334, -159.50141421661326, -137.71899228705635, -106.35853099178708, -227.89685814363938, -845.1059156134015, -1080.9264543492166, -449.3829280693102, -175.02200002060906, -869.7000680711286, -311.3090718975743, -663.0106671037476, -181.04592375228313, -792.8409732921965, -184.64143502308306, -925.9908964111036, -880.5408592312381, -556.451848130163, -174.109660091384, -992.1843014198361, -94.489634049628, -1116.6086912154924, -785.6006252821197, -564.3556985333215, -273.0535667383713, -158.65309520013724, -133.17254591630794, -1156.1435051427247, -295.7998954129538, -288.8388343288879, -126.3133679769384, -516.2578750535855, -340.9247096464789, -423.6247997089521, -1035.8118097533913, -341.14354699518327, -61.789880435539594, -193.64323974200062, -146.48422438167472, -882.6101532567372, -241.0683793300603, -387.2877466925057, -1170.735258038601, -143.42921118334573, -415.4865694658899, -381.77317771162035, -756.2540598879885, -502.6387700202026, -474.8236461986351, -906.495915829235, -683.5058486541268, -546.7026871116053, -362.5405129853019, -1024.2194969556986, -345.14616369829423, -1173.9956306944673, -38.342664409543495, -534.6407002320279, -815.261277353601, -941.3192428839501, -36.80910464730901, -75.40662063486701, -204.43515443882882, -1297.7436183208174, -46.71119757975043, -433.31217413558056, -3.193359769360341, -668.9333927718914, -308.34999479073775, -567.6035497793725, -614.3930856143719, -966.5552853934843, -1276.174772989487, -936.9667637900212, -1287.4580343917298, -61.15488298022149, -964.2000244962585, -150.56386772992957, -848.7534209128597, -785.8733051400106, -860.456121966401, -255.43590356519735, -986.9372671280934, -108.80828086629715, -237.06308295663518, -488.87657023463856, -503.28521841196965, -104.01151680510606, -748.7964988509124, -434.2179049231123, -855.2329694597225, -259.7595813910366, -92.13095904074929, -367.8867601140751, -917.6944200124257, -477.30756640077857, -1098.0254283203496, -298.2836192724102, -242.28110972665917, -905.3243012787776, -188.7533958557951, -449.51192017095485, -925.3039266965164, -617.9425290167515, -1164.5524012617748, -450.6538819659182, -785.1815232940745, -403.81894686784347, -330.02342978283195, -739.0614060796485, -116.60473227102887, -82.33304568484738, -330.10887846939534, -99.57869606500138, -279.19076512558496, -789.0990352112905, -110.08670081264555, -432.5360728497997, -385.1412393084053, -784.5980528241735, -945.8919993717063, -568.5399732604193, -103.96865877700388, -509.3247365412593, -316.8964111332315, -30.872542693734374, -52.1249802184736, -810.0152318894208, -192.22586656060582, -960.6546322195724, -92.92540640958124, -805.536057719825, -162.06074256991744, -559.3626005105295, -247.07642812517145, -747.6177330864664, -390.3327559625372, -64.12152260297489, -642.3217624356593, -50.26954054654625, -96.62404832824532, -101.78794791707662, -648.3820016592815, -24.913727122814148, -811.7779285407719, -422.0156000940483, -955.7971295946882, -122.60099477858353, -762.8563941066053, -796.2818280334252, -475.5046592148629, -504.007034692059, -849.3714844091894, -186.62155506055296, -552.577366409677, -763.4094401273164, -568.911843091814, -952.6594132405664, -221.23481107081832, -246.19479936517587, -969.7911292372842, -622.9910800629617, -49.461449002700114, -58.172175933732454, -992.5299371627318, -431.0530362560431, -973.6671165836899, -710.8250730575774, -129.55312272198978, -572.4145386049046, -183.87915609231533, -31.837971303513715, -869.5171575503423, -789.5749504491965, -994.4794644023755, -898.809612883646, -976.8510579887458, -65.27058707970552, -378.42270138887466, -149.69530071341288, -1217.5552100518544, -112.61471846650686, -60.067665019584844, -196.76730516187322, -248.40866528365984, -804.7532603371235, -1059.900010481583, -294.16020124321585, -402.97534837935837, -578.8926341563409, -625.1816069858589, -396.4252752969981, -238.53980290048057, -375.22896539478717, -212.58634052054347, -628.4157457920151, -405.6956100158944, -890.6195624481592, -116.08249853687805, -716.9540020432006, -269.805956138478, -536.9829768675487, -8.499456742204334, -294.2658660038337, -541.9050541186468, -423.73667976391556, -586.3797518958376, -734.5935515086887, -1183.8331000173314, -376.8980425785286, -60.46465877414058, -166.41390632477768, -464.6597793029737, -878.5243885687572, -230.07222035625028, -799.9894695307197, -839.7389134210148, -516.0842925793913, -938.9195620032959, -725.2524176132966, -447.3277097322646, -613.3591421847249, -166.57511656562934, -170.17198831279427, -61.88201383997833, -99.02641545205645, -246.06123259475552, -1050.2809573412496, -944.7696816012502, -123.88640304654882, -663.8248341861888, -265.47858424629777, -21.17216483281882, -166.52656384972212, -598.0280872314021, -72.80437348850468, -518.070304506524, -766.7612356899959, -730.9630447364623, -86.20731672797965, -748.3192779868068, -1241.094239426933, -809.7239188636586, -830.8181418446644, -561.0822956930652, -754.6559028548875, -714.0283837792491, -879.2147113837813, -112.00103037329443, -510.7701507034925, -431.02002271213655, -719.5398031988071, -445.2842121957501, -627.2956235134883, -656.5991956758489, -482.9397075694127, -306.9127566934515, -183.8236539048155, -428.6329837335121, -652.993867155619, -18.310897642396963, -1281.983037313589, -956.8467373689833, -943.1738241977482, -1181.793006041124, -170.80444937171652, -547.0393698677715, -107.70334652390808, -265.77384010583273, -590.8351266098817]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5165762991999074, "mean_inference_ms": 1.6995287450878278, "mean_action_processing_ms": 0.8240586571910103, "mean_env_wait_ms": 10.119874289441135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01288461685180664, "StateBufferConnector_ms": 0.009331703186035156, "ViewRequirementAgentConnector_ms": 0.31072378158569336}, "num_episodes": 22, "episode_return_max": -469.6677668014972, "episode_return_min": -5081.547942179091, "episode_return_mean": -2402.6447193694576, "episodes_this_iter": 22}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 755589, "num_agent_steps_trained": 755589, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.5980090469793, "num_env_steps_trained_throughput_per_sec": 72.5980090469793, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 755589, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 755589, "timers": {"training_iteration_time_ms": 52282.439, "restore_workers_time_ms": 0.031, "training_step_time_ms": 52282.36, "sample_time_ms": 3241.907, "learn_time_ms": 48980.848, "learn_throughput": 81.665, "synch_weights_time_ms": 56.676}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 755589, "num_agent_steps_trained": 755589}, "done": false, "training_iteration": 43, "trial_id": "efc54_00000", "date": "2024-07-24_19-19-12", "timestamp": 1721828952, "time_this_iter_s": 55.110546827316284, "time_total_s": 2350.3069591522217, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7e92d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2350.3069591522217, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 9.962025316455696, "ram_util_percent": 23.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 128.43930306203904, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.880283675655242, "policy_loss": -0.0034290024973151665, "vf_loss": 4.900103357081772, "vf_explained_var": 0.9797473689240794, "kl": 0.016157856617049035, "entropy": 2.184396639850832, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.61290322580645, "num_grad_updates_lifetime": 179550.5, "diff_num_grad_updates_vs_sampler_policy": 1859.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 771413, "num_agent_steps_trained": 771413}, "env_runners": {"episode_reward_max": -469.6677668014972, "episode_reward_min": -5081.547942179091, "episode_reward_mean": -2402.2467813813473, "episode_len_mean": 148.41, "episode_media": {}, "episodes_timesteps_total": 14841, "policy_reward_min": {"policy_0": -1302.0550013833501}, "policy_reward_max": {"policy_0": -3.193359769360341}, "policy_reward_mean": {"policy_0": -480.44935627626944}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1944.430346424678, -3115.7688982444297, -1795.8058545627016, -2057.716346963361, -1176.0589745255531, -2740.100116494615, -2322.4481215500687, -1746.7474228680617, -2001.5644084614987, -3038.414420535731, -469.6677668014972, -1828.2800965799559, -2672.4709699144023, -1182.3782994723927, -1409.2237986064094, -1762.5214881895056, -1794.93428045501, -2251.6019810323355, -2276.4221393234175, -2097.8090315224185, -811.7836171162173, -1893.3484749541446, -2440.3272232049785, -1381.07996431623, -3420.137366123668, -2132.848071068883, -3529.277565283728, -2834.108215818932, -2032.6078760010114, -2442.932562139347, -1625.6710448111344, -2358.007164710403, -3021.9855696476807, -2962.1147094050243, -3503.559515573591, -1661.1056956215727, -1981.3924712469416, -5081.547942179091, -2810.5455012592793, -2448.7006564826247, -2279.18770922574, -2492.7046900180085, -3021.2220249989737, -3346.0641730017906, -2708.7391879903216, -907.8161176158593, -2501.461101006315, -2444.6217790836195, -2045.8932535818087, -1866.9612353350242, -1894.6633146341837, -1683.4856535681884, -3059.5519466073474, -2568.0820997863407, -2752.410306895692, -2692.9457713994116, -2817.5128872242085, -2869.288699797743, -2469.049260054385, -1835.413563983479, -3140.6814545976235, -1847.9619910986682, -2757.7674188361475, -1651.4593098707103, -3305.4411257643005, -1800.1349533269008, -3819.9846551477162, -1459.3159706353913, -2464.024690035863, -1715.0302343464289, -2174.806275149466, -4191.03787381513, -2970.6701790947063, -2879.738857296035, -2055.302969056811, -4382.107502563841, -1682.15613247911, -2103.184901307312, -2115.5403816276244, -1924.901695892256, -2825.1041106530683, -2450.181269486534, -2293.158757201422, -2172.3069306325356, -3395.8159266265934, -2443.771778608084, -1126.2135685026724, -4065.9946438876523, -1931.3118470702127, -3166.4405814832744, -1965.5947813928428, -1931.1073354359505, -2314.529773785312, -2721.0276671315187, -2788.152391318011, -2544.90819818572, -2721.732817995627, -1879.4356789196863, -2933.8591108909377, -3798.2616516840785], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 81, 150, 150, 121, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-849.4671711168387, -469.3106787006018, -28.196209420178842, -110.91557263456542, -486.54071455249357, -424.9481897733273, -814.2306615630748, -488.2870587383199, -583.6707000931673, -804.6322880765448, -989.3996062134812, -21.68361036956251, -104.05621806839513, -426.3842626732036, -254.28215723805974, -698.2134295400413, -34.73670406018761, -661.3604605820268, -527.6518115314688, -135.75394124963609, -22.475687984623143, -172.87948417062424, -317.9452656430908, -307.1283385830926, -355.63019814412326, -82.28125076509441, -737.85557477884, -742.2991144108829, -787.5359002083708, -390.12827633142956, -839.643150707471, -264.98626090299115, -333.1189079080376, -366.61414617426476, -518.0856558573082, -168.7959414236083, -68.52005770075374, -582.1803483948777, -235.24216117966014, -692.0089141691615, -73.45145255690096, -285.8715226954451, -776.0594948919053, -279.9433971427035, -586.2385411745402, -812.7995770075315, -433.43965469827737, -1235.5324536958399, -349.37120432259917, -207.2715308114833, -38.95073962496271, -28.899424447234566, -142.76815891524478, -57.81130090024081, -201.2381429138144, -489.4625970439521, -193.74718388246694, -566.3753885003048, -85.48026240274845, -493.21466475048067, -647.0423111813192, -752.6641374812942, -478.88844309994454, -468.9889841490561, -324.88709400278424, -221.639933108325, -238.7078544702456, -243.23238474484, -305.46279341545494, -173.33533373352773, -31.266533973021705, -368.04077000844956, -72.79544216799992, -497.6086165626422, -439.51243589429527, -252.7102446520886, -652.6828874673075, -84.2991827617319, -714.1334183399111, -58.69575496846558, -434.4249123179025, -977.0927326753106, -151.237217416525, -60.8070214597266, -171.3723965855463, -941.8501802805253, -449.3751102756739, -176.47680520418982, -105.84889380553945, -578.0509914664074, -153.70971593611478, -804.2376382407342, -505.7804453574234, -65.3522132575394, -747.3421265316067, -479.4908642760421, -826.5311218409893, -149.22258893901548, -261.6337651625953, -380.9306913037761, -77.79783140129015, -401.7070595381963, -46.85166012880972, -251.88511939632997, -33.5419466515919, -729.3986819012646, -248.52810040972682, -39.16303609033096, -819.3174425834675, -56.941213969353534, -45.85790073449012, -168.92343234103035, -1014.5492434960487, -432.7200267928408, -778.2766198405658, -749.6041686771334, -159.50141421661326, -137.71899228705635, -106.35853099178708, -227.89685814363938, -845.1059156134015, -1080.9264543492166, -449.3829280693102, -175.02200002060906, -869.7000680711286, -311.3090718975743, -663.0106671037476, -181.04592375228313, -792.8409732921965, -184.64143502308306, -925.9908964111036, -880.5408592312381, -556.451848130163, -174.109660091384, -992.1843014198361, -94.489634049628, -1116.6086912154924, -785.6006252821197, -564.3556985333215, -273.0535667383713, -158.65309520013724, -133.17254591630794, -1156.1435051427247, -295.7998954129538, -288.8388343288879, -126.3133679769384, -516.2578750535855, -340.9247096464789, -423.6247997089521, -1035.8118097533913, -341.14354699518327, -61.789880435539594, -193.64323974200062, -146.48422438167472, -882.6101532567372, -241.0683793300603, -387.2877466925057, -1170.735258038601, -143.42921118334573, -415.4865694658899, -381.77317771162035, -756.2540598879885, -502.6387700202026, -474.8236461986351, -906.495915829235, -683.5058486541268, -546.7026871116053, -362.5405129853019, -1024.2194969556986, -345.14616369829423, -1173.9956306944673, -38.342664409543495, -534.6407002320279, -815.261277353601, -941.3192428839501, -36.80910464730901, -75.40662063486701, -204.43515443882882, -1297.7436183208174, -46.71119757975043, -433.31217413558056, -3.193359769360341, -668.9333927718914, -308.34999479073775, -567.6035497793725, -614.3930856143719, -966.5552853934843, -1276.174772989487, -936.9667637900212, -1287.4580343917298, -61.15488298022149, -964.2000244962585, -150.56386772992957, -848.7534209128597, -785.8733051400106, -860.456121966401, -255.43590356519735, -986.9372671280934, -108.80828086629715, -237.06308295663518, -488.87657023463856, -503.28521841196965, -104.01151680510606, -748.7964988509124, -434.2179049231123, -855.2329694597225, -259.7595813910366, -92.13095904074929, -367.8867601140751, -917.6944200124257, -477.30756640077857, -1098.0254283203496, -298.2836192724102, -242.28110972665917, -905.3243012787776, -188.7533958557951, -449.51192017095485, -925.3039266965164, -617.9425290167515, -1164.5524012617748, -450.6538819659182, -785.1815232940745, -403.81894686784347, -330.02342978283195, -739.0614060796485, -116.60473227102887, -82.33304568484738, -330.10887846939534, -99.57869606500138, -279.19076512558496, -789.0990352112905, -110.08670081264555, -432.5360728497997, -385.1412393084053, -784.5980528241735, -945.8919993717063, -568.5399732604193, -103.96865877700388, -509.3247365412593, -316.8964111332315, -30.872542693734374, -52.1249802184736, -810.0152318894208, -192.22586656060582, -960.6546322195724, -92.92540640958124, -805.536057719825, -162.06074256991744, -559.3626005105295, -247.07642812517145, -747.6177330864664, -390.3327559625372, -64.12152260297489, -642.3217624356593, -50.26954054654625, -96.62404832824532, -101.78794791707662, -648.3820016592815, -24.913727122814148, -811.7779285407719, -422.0156000940483, -955.7971295946882, -122.60099477858353, -762.8563941066053, -796.2818280334252, -475.5046592148629, -504.007034692059, -849.3714844091894, -186.62155506055296, -552.577366409677, -763.4094401273164, -568.911843091814, -952.6594132405664, -221.23481107081832, -246.19479936517587, -969.7911292372842, -622.9910800629617, -49.461449002700114, -58.172175933732454, -992.5299371627318, -431.0530362560431, -973.6671165836899, -710.8250730575774, -129.55312272198978, -572.4145386049046, -183.87915609231533, -31.837971303513715, -869.5171575503423, -789.5749504491965, -994.4794644023755, -898.809612883646, -976.8510579887458, -65.27058707970552, -378.42270138887466, -149.69530071341288, -1217.5552100518544, -112.61471846650686, -60.067665019584844, -196.76730516187322, -248.40866528365984, -804.7532603371235, -1059.900010481583, -294.16020124321585, -402.97534837935837, -578.8926341563409, -625.1816069858589, -396.4252752969981, -238.53980290048057, -375.22896539478717, -212.58634052054347, -628.4157457920151, -405.6956100158944, -890.6195624481592, -116.08249853687805, -716.9540020432006, -269.805956138478, -536.9829768675487, -8.499456742204334, -294.2658660038337, -541.9050541186468, -423.73667976391556, -586.3797518958376, -734.5935515086887, -1183.8331000173314, -376.8980425785286, -60.46465877414058, -166.41390632477768, -464.6597793029737, -878.5243885687572, -230.07222035625028, -799.9894695307197, -839.7389134210148, -516.0842925793913, -938.9195620032959, -725.2524176132966, -447.3277097322646, -613.3591421847249, -166.57511656562934, -170.17198831279427, -61.88201383997833, -99.02641545205645, -246.06123259475552, -1050.2809573412496, -944.7696816012502, -123.88640304654882, -663.8248341861888, -265.47858424629777, -21.17216483281882, -166.52656384972212, -598.0280872314021, -72.80437348850468, -518.070304506524, -766.7612356899959, -730.9630447364623, -86.20731672797965, -748.3192779868068, -1241.094239426933, -809.7239188636586, -830.8181418446644, -561.0822956930652, -754.6559028548875, -714.0283837792491, -879.2147113837813, -112.00103037329443, -510.7701507034925, -431.02002271213655, -719.5398031988071, -445.2842121957501, -627.2956235134883, -656.5991956758489, -482.9397075694127, -306.9127566934515, -183.8236539048155, -428.6329837335121, -652.993867155619, -18.310897642396963, -1281.983037313589, -956.8467373689833, -943.1738241977482, -1181.793006041124, -170.80444937171652, -547.0393698677715, -107.70334652390808, -265.77384010583273, -590.8351266098817, -112.74952162068573, -25.570284102910602, -934.4112153514699, -182.55760773036044, -847.8962725018855, -111.51559799222383, -810.4668602681235, -306.8864877050964, -546.9540732926808, -339.7173623694999, -672.7346655987566, -909.3370874663166, -121.42640826859162, -169.22497155665644, -52.17856300193635, -835.7223789547932, -843.9726036607578, -36.98877931806298, -689.1520423995022, -419.268306319953, -393.18222530327006, -459.1173315320839, -23.626461276502706, -811.866449273214, -762.3888021014625, -968.1373221268726, -209.83551048028983, -43.316223677690935, -517.2945328908821, -554.5751680256868, -904.7757340343107, -17.006099736380083, -48.55270450976144, -708.8277926846968, -493.14459966738804, -689.8712985012858, -875.5976488747789, -581.1452673295339, -866.6831523321852, -382.5185595888104, -236.89353244516107, -635.9372017568804, -632.8224177826652, -282.00710028599866, -656.1115263373771, -722.3064180585908, -165.24457146029286, -94.892500457508, -57.83027290807297, -85.93980561820729, -1209.1087575152096, -858.0184507663164, -1013.3841823489985, -605.5701693132658, -379.9130839438597, -69.25292362828586, -68.23419904992392, -1134.4609252653445, -408.5201052369579, -250.84369388970126, -644.763667548605, -790.3048720275468, -493.494199609799, -412.5022138762631, -825.3756284210555, -786.1461203694214, -35.964719217219624, -170.91296392113975, -226.8132787458858, -745.7576991391749, -172.19234316063083, -289.6886042487294, -246.60920207764843, -976.4643901079015, -246.1527958410391, -431.6451402464661, -447.8404615019359, -656.9793828316523, -355.1151937244232, -422.9495954808353, -174.22050438669638, -1169.566816035702, -398.93080938472536, -942.5912645355721, -35.71827278882446, -46.190246135803505, -475.2416169230813, -142.99382634708155, -1018.2898400330254, -1105.436861879019, -804.2298273695536, -130.60882653377652, -303.5255508662762, -1058.8653053378866, -247.67868807822498, -9.521235427832732, -949.8468390367044, -562.6685500622248, -190.70085661667073, -1008.9953368521946, -84.76234830217126, -797.9892181190708, -143.37405106179858, -44.716323469166625, -808.5937379674799, -13.731618149478631, -1025.1195651823234, -645.537517773679, -100.10701261911163, -1149.3633971663476, -1042.8687585134085, -321.86631531584175, -259.9303642546414, -871.5412122168339, -1302.0550013833501]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5152756890654868, "mean_inference_ms": 1.7004089539609402, "mean_action_processing_ms": 0.822328580734096, "mean_env_wait_ms": 10.116019749233562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012955427169799805, "StateBufferConnector_ms": 0.009409427642822266, "ViewRequirementAgentConnector_ms": 0.31286168098449707}, "num_episodes": 23, "episode_return_max": -469.6677668014972, "episode_return_min": -5081.547942179091, "episode_return_mean": -2402.2467813813473, "episodes_this_iter": 23}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 771413, "num_agent_steps_trained": 771413, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 87.10235311580709, "num_env_steps_trained_throughput_per_sec": 87.10235311580709, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 771413, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 771413, "timers": {"training_iteration_time_ms": 51566.764, "restore_workers_time_ms": 0.031, "training_step_time_ms": 51566.687, "sample_time_ms": 3221.315, "learn_time_ms": 48285.89, "learn_throughput": 82.84, "synch_weights_time_ms": 56.538}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 771413, "num_agent_steps_trained": 771413}, "done": false, "training_iteration": 44, "trial_id": "efc54_00000", "date": "2024-07-24_19-19-58", "timestamp": 1721828998, "time_this_iter_s": 45.93488049507141, "time_total_s": 2396.241839647293, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x717b99570670>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2396.241839647293, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 10.289230769230768, "ram_util_percent": 23.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 124.46373978029703, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 0.0010000000000000007, "total_loss": 4.870682670586351, "policy_loss": -0.0048051331799639305, "vf_loss": 4.8927941847538605, "vf_explained_var": 0.987025986187124, "kl": 0.01636230896765834, "entropy": 2.2828652064581423, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.5072463768116, "num_grad_updates_lifetime": 183480.5, "diff_num_grad_updates_vs_sampler_policy": 2069.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 789009, "num_agent_steps_trained": 789009}, "env_runners": {"episode_reward_max": -907.8161176158593, "episode_reward_min": -5081.547942179091, "episode_reward_mean": -2463.1225208521155, "episode_len_mean": 149.51, "episode_media": {}, "episodes_timesteps_total": 14951, "policy_reward_min": {"policy_0": -1302.0550013833501}, "policy_reward_max": {"policy_0": -3.193359769360341}, "policy_reward_mean": {"policy_0": -492.6245041704231}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661.1056956215727, -1981.3924712469416, -5081.547942179091, -2810.5455012592793, -2448.7006564826247, -2279.18770922574, -2492.7046900180085, -3021.2220249989737, -3346.0641730017906, -2708.7391879903216, -907.8161176158593, -2501.461101006315, -2444.6217790836195, -2045.8932535818087, -1866.9612353350242, -1894.6633146341837, -1683.4856535681884, -3059.5519466073474, -2568.0820997863407, -2752.410306895692, -2692.9457713994116, -2817.5128872242085, -2869.288699797743, -2469.049260054385, -1835.413563983479, -3140.6814545976235, -1847.9619910986682, -2757.7674188361475, -1651.4593098707103, -3305.4411257643005, -1800.1349533269008, -3819.9846551477162, -1459.3159706353913, -2464.024690035863, -1715.0302343464289, -2174.806275149466, -4191.03787381513, -2970.6701790947063, -2879.738857296035, -2055.302969056811, -4382.107502563841, -1682.15613247911, -2103.184901307312, -2115.5403816276244, -1924.901695892256, -2825.1041106530683, -2450.181269486534, -2293.158757201422, -2172.3069306325356, -3395.8159266265934, -2443.771778608084, -1126.2135685026724, -4065.9946438876523, -1931.3118470702127, -3166.4405814832744, -1965.5947813928428, -1931.1073354359505, -2314.529773785312, -2721.0276671315187, -2788.152391318011, -2544.90819818572, -2721.732817995627, -1879.4356789196863, -2933.8591108909377, -3798.2616516840785, -2203.1256453126493, -3121.234011416481, -1879.2862010953484, -1647.748040158113, -2048.865550455275, -1658.1647171210532, -2636.6087642307184, -2435.7064391139825, -1699.7928131700344, -2941.438839450671, -1429.7670370540673, -2080.5705638386294, -3479.2597943795463, -3102.6421622171147, -2831.2115547276676, -3017.6451182994433, -1727.8017796302643, -2279.3207061952817, -2299.368225631762, -2517.8153509156928, -2553.43181319302, -1419.2145481827872, -3962.2095358685783, -2447.4350033842793, -2403.0963553862657, -2297.7776394303555, -1817.0321487466217, -2468.51495657611, -3477.415223571528, -1650.7615592751079, -1781.8073116993698, -2099.9370569972907, -3689.7887839551045, -1680.1511701206623, -1375.7812289789397], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-36.80910464730901, -75.40662063486701, -204.43515443882882, -1297.7436183208174, -46.71119757975043, -433.31217413558056, -3.193359769360341, -668.9333927718914, -308.34999479073775, -567.6035497793725, -614.3930856143719, -966.5552853934843, -1276.174772989487, -936.9667637900212, -1287.4580343917298, -61.15488298022149, -964.2000244962585, -150.56386772992957, -848.7534209128597, -785.8733051400106, -860.456121966401, -255.43590356519735, -986.9372671280934, -108.80828086629715, -237.06308295663518, -488.87657023463856, -503.28521841196965, -104.01151680510606, -748.7964988509124, -434.2179049231123, -855.2329694597225, -259.7595813910366, -92.13095904074929, -367.8867601140751, -917.6944200124257, -477.30756640077857, -1098.0254283203496, -298.2836192724102, -242.28110972665917, -905.3243012787776, -188.7533958557951, -449.51192017095485, -925.3039266965164, -617.9425290167515, -1164.5524012617748, -450.6538819659182, -785.1815232940745, -403.81894686784347, -330.02342978283195, -739.0614060796485, -116.60473227102887, -82.33304568484738, -330.10887846939534, -99.57869606500138, -279.19076512558496, -789.0990352112905, -110.08670081264555, -432.5360728497997, -385.1412393084053, -784.5980528241735, -945.8919993717063, -568.5399732604193, -103.96865877700388, -509.3247365412593, -316.8964111332315, -30.872542693734374, -52.1249802184736, -810.0152318894208, -192.22586656060582, -960.6546322195724, -92.92540640958124, -805.536057719825, -162.06074256991744, -559.3626005105295, -247.07642812517145, -747.6177330864664, -390.3327559625372, -64.12152260297489, -642.3217624356593, -50.26954054654625, -96.62404832824532, -101.78794791707662, -648.3820016592815, -24.913727122814148, -811.7779285407719, -422.0156000940483, -955.7971295946882, -122.60099477858353, -762.8563941066053, -796.2818280334252, -475.5046592148629, -504.007034692059, -849.3714844091894, -186.62155506055296, -552.577366409677, -763.4094401273164, -568.911843091814, -952.6594132405664, -221.23481107081832, -246.19479936517587, -969.7911292372842, -622.9910800629617, -49.461449002700114, -58.172175933732454, -992.5299371627318, -431.0530362560431, -973.6671165836899, -710.8250730575774, -129.55312272198978, -572.4145386049046, -183.87915609231533, -31.837971303513715, -869.5171575503423, -789.5749504491965, -994.4794644023755, -898.809612883646, -976.8510579887458, -65.27058707970552, -378.42270138887466, -149.69530071341288, -1217.5552100518544, -112.61471846650686, -60.067665019584844, -196.76730516187322, -248.40866528365984, -804.7532603371235, -1059.900010481583, -294.16020124321585, -402.97534837935837, -578.8926341563409, -625.1816069858589, -396.4252752969981, -238.53980290048057, -375.22896539478717, -212.58634052054347, -628.4157457920151, -405.6956100158944, -890.6195624481592, -116.08249853687805, -716.9540020432006, -269.805956138478, -536.9829768675487, -8.499456742204334, -294.2658660038337, -541.9050541186468, -423.73667976391556, -586.3797518958376, -734.5935515086887, -1183.8331000173314, -376.8980425785286, -60.46465877414058, -166.41390632477768, -464.6597793029737, -878.5243885687572, -230.07222035625028, -799.9894695307197, -839.7389134210148, -516.0842925793913, -938.9195620032959, -725.2524176132966, -447.3277097322646, -613.3591421847249, -166.57511656562934, -170.17198831279427, -61.88201383997833, -99.02641545205645, -246.06123259475552, -1050.2809573412496, -944.7696816012502, -123.88640304654882, -663.8248341861888, -265.47858424629777, -21.17216483281882, -166.52656384972212, -598.0280872314021, -72.80437348850468, -518.070304506524, -766.7612356899959, -730.9630447364623, -86.20731672797965, -748.3192779868068, -1241.094239426933, -809.7239188636586, -830.8181418446644, -561.0822956930652, -754.6559028548875, -714.0283837792491, -879.2147113837813, -112.00103037329443, -510.7701507034925, -431.02002271213655, -719.5398031988071, -445.2842121957501, -627.2956235134883, -656.5991956758489, -482.9397075694127, -306.9127566934515, -183.8236539048155, -428.6329837335121, -652.993867155619, -18.310897642396963, -1281.983037313589, -956.8467373689833, -943.1738241977482, -1181.793006041124, -170.80444937171652, -547.0393698677715, -107.70334652390808, -265.77384010583273, -590.8351266098817, -112.74952162068573, -25.570284102910602, -934.4112153514699, -182.55760773036044, -847.8962725018855, -111.51559799222383, -810.4668602681235, -306.8864877050964, -546.9540732926808, -339.7173623694999, -672.7346655987566, -909.3370874663166, -121.42640826859162, -169.22497155665644, -52.17856300193635, -835.7223789547932, -843.9726036607578, -36.98877931806298, -689.1520423995022, -419.268306319953, -393.18222530327006, -459.1173315320839, -23.626461276502706, -811.866449273214, -762.3888021014625, -968.1373221268726, -209.83551048028983, -43.316223677690935, -517.2945328908821, -554.5751680256868, -904.7757340343107, -17.006099736380083, -48.55270450976144, -708.8277926846968, -493.14459966738804, -689.8712985012858, -875.5976488747789, -581.1452673295339, -866.6831523321852, -382.5185595888104, -236.89353244516107, -635.9372017568804, -632.8224177826652, -282.00710028599866, -656.1115263373771, -722.3064180585908, -165.24457146029286, -94.892500457508, -57.83027290807297, -85.93980561820729, -1209.1087575152096, -858.0184507663164, -1013.3841823489985, -605.5701693132658, -379.9130839438597, -69.25292362828586, -68.23419904992392, -1134.4609252653445, -408.5201052369579, -250.84369388970126, -644.763667548605, -790.3048720275468, -493.494199609799, -412.5022138762631, -825.3756284210555, -786.1461203694214, -35.964719217219624, -170.91296392113975, -226.8132787458858, -745.7576991391749, -172.19234316063083, -289.6886042487294, -246.60920207764843, -976.4643901079015, -246.1527958410391, -431.6451402464661, -447.8404615019359, -656.9793828316523, -355.1151937244232, -422.9495954808353, -174.22050438669638, -1169.566816035702, -398.93080938472536, -942.5912645355721, -35.71827278882446, -46.190246135803505, -475.2416169230813, -142.99382634708155, -1018.2898400330254, -1105.436861879019, -804.2298273695536, -130.60882653377652, -303.5255508662762, -1058.8653053378866, -247.67868807822498, -9.521235427832732, -949.8468390367044, -562.6685500622248, -190.70085661667073, -1008.9953368521946, -84.76234830217126, -797.9892181190708, -143.37405106179858, -44.716323469166625, -808.5937379674799, -13.731618149478631, -1025.1195651823234, -645.537517773679, -100.10701261911163, -1149.3633971663476, -1042.8687585134085, -321.86631531584175, -259.9303642546414, -871.5412122168339, -1302.0550013833501, -429.04067746103203, -593.757787781496, -283.1744600049206, -20.398361637542298, -876.7543584276605, -242.86785565829442, -1153.6310385499128, -560.1537332150223, -877.2507278500229, -287.33065614323107, -455.65633466880536, -99.62001638252896, -8.50082746989892, -289.2044039663846, -1026.3046186077297, -102.56328426484662, -867.9465187874393, -174.31201049249577, -391.3551144989738, -111.5711121143581, -377.63122331878986, -891.3212871309765, -96.02369375080671, -462.5879253011268, -221.30142095357496, -216.06113685216872, -59.704000859609934, -734.2202835920217, -332.92891818843464, -315.25037762882016, -1164.1059636658367, -424.4576950580385, -56.75125703193974, -709.8631897677177, -281.43065870718397, -627.4064511976126, -976.8196792492012, -177.32824057901058, -202.60015058774698, -451.55191750041075, -165.77673480297327, -645.664896041306, -556.8436451574579, -208.09259410159763, -123.41494306670107, -264.0589566539862, -532.3112464079684, -989.355907143193, -655.1084563652993, -500.6042728802247, -223.46050133995624, -222.09574192524417, -143.0028795498638, -256.557715113027, -584.6501991259756, -518.7834940825501, -431.3148339372563, -986.2939214367399, -46.97180298880646, -97.20651139327786, -1165.5413058452436, -22.572723058460458, -896.9888068519808, -1292.6689121391069, -101.48804648475083, -1129.1637839073876, -1007.7610797082476, -593.2603529144498, -29.352124398766005, -343.1048212882637, -839.6875291030789, -813.7788016235193, -137.31482293562308, -657.1746592503154, -383.25574181513446, -656.3113075251833, -436.3737637551429, -1114.2916644685936, -411.5690970556096, -399.0992854949148, -136.80210605380486, -806.359513310356, -50.16286216852096, -38.2889806262733, -696.18831747131, -741.7045981401651, -225.67315965065762, -1111.612938691199, -153.76435947347616, -46.565650239786315, -641.4802958928276, -417.2061409516514, -7.423125930016626, -220.04277719356162, -1013.2158856637067, -215.63327658951232, -323.72073169352683, -497.9653312177006, -637.3613285509833, -843.1346828639684, -136.07745319256114, -466.33603548766047, -763.601848716035, -969.270630580892, -218.14584521587233, -828.8808626132242, -155.46316206257944, -16.81820150189092, -393.9690147577324, -24.083307247360015, -1010.8329852528099, -956.3685401116069, -1016.662438545905, -940.1585949446971, -38.18697701355639, -791.8511396620703, -220.63018881813124, -592.0141624847606, -285.3747693532757, -557.5647430660413, -228.47413324126254, -942.9184211749497, -83.57421215377879, -742.1264617855525, -406.00312703072285, -222.50927294747333, -629.6544171490536, -145.5725802921471, -737.474827099882, -562.5665419417998, -110.51769909745762, -67.06416784312367, -528.6331864550666, -69.17667874569405, -1041.6404166052805, -134.96161576750518, -917.0193757497649, -27.21374260990204, -1062.7046511131277, -326.6155713358106, -824.5965729232178, -107.03469164818412, -1214.9775930834471, -601.8337850599235, -728.9725808567558, -31.88601991926716, -120.8022473790519, -40.285241759828104, -301.48999521708834, -1156.298054999871, -245.65293696477033, -431.8539065154056, -139.03371587027388, -759.6527866872437, -205.61396566167795, -50.15838354761057, -72.28301743271727, -1002.0508563641039, -484.84306638060474, -490.60173327225215, -150.51510287115863, -928.6052077302455, -1042.9972833016188, -857.8706468539941, -709.8005431980896, -47.585510384202955, -297.21660491450723, -151.4121032879566, -728.471403902501, -455.4655476314949, -632.1021254509417, -182.23573139345038, -67.59070930829805, -321.4671490546667, -172.38551377158305]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5146526778133842, "mean_inference_ms": 1.702191383608794, "mean_action_processing_ms": 0.8206511111319919, "mean_env_wait_ms": 10.11732567952701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013025045394897461, "StateBufferConnector_ms": 0.009681940078735352, "ViewRequirementAgentConnector_ms": 0.32312774658203125}, "num_episodes": 35, "episode_return_max": -907.8161176158593, "episode_return_min": -5081.547942179091, "episode_return_mean": -2463.1225208521155, "episodes_this_iter": 35}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 789009, "num_agent_steps_trained": 789009, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 70.06058247694348, "num_env_steps_trained_throughput_per_sec": 70.06058247694348, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 789009, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 789009, "timers": {"training_iteration_time_ms": 52922.62, "restore_workers_time_ms": 0.031, "training_step_time_ms": 52922.542, "sample_time_ms": 3207.108, "learn_time_ms": 49654.992, "learn_throughput": 80.556, "synch_weights_time_ms": 57.483}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 789009, "num_agent_steps_trained": 789009}, "done": false, "training_iteration": 45, "trial_id": "efc54_00000", "date": "2024-07-24_19-20-55", "timestamp": 1721829055, "time_this_iter_s": 57.10564613342285, "time_total_s": 2453.347485780716, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7eaf80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2453.347485780716, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 9.635802469135804, "ram_util_percent": 23.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 137.7380973259608, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.695781062915922, "policy_loss": -0.0029319338168230995, "vf_loss": 4.7155924000466864, "vf_explained_var": 0.9860107944346964, "kl": 0.01648938205689774, "entropy": 2.244457514087359, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.8828125, "num_grad_updates_lifetime": 187470.5, "diff_num_grad_updates_vs_sampler_policy": 1919.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 805378, "num_agent_steps_trained": 805378}, "env_runners": {"episode_reward_max": -1088.1345661198598, "episode_reward_min": -4382.107502563841, "episode_reward_mean": -2485.439624634133, "episode_len_mean": 149.96, "episode_media": {}, "episodes_timesteps_total": 14996, "policy_reward_min": {"policy_0": -1418.3377149261405}, "policy_reward_max": {"policy_0": 6.852307650614107}, "policy_reward_mean": {"policy_0": -497.0879249268265}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2869.288699797743, -2469.049260054385, -1835.413563983479, -3140.6814545976235, -1847.9619910986682, -2757.7674188361475, -1651.4593098707103, -3305.4411257643005, -1800.1349533269008, -3819.9846551477162, -1459.3159706353913, -2464.024690035863, -1715.0302343464289, -2174.806275149466, -4191.03787381513, -2970.6701790947063, -2879.738857296035, -2055.302969056811, -4382.107502563841, -1682.15613247911, -2103.184901307312, -2115.5403816276244, -1924.901695892256, -2825.1041106530683, -2450.181269486534, -2293.158757201422, -2172.3069306325356, -3395.8159266265934, -2443.771778608084, -1126.2135685026724, -4065.9946438876523, -1931.3118470702127, -3166.4405814832744, -1965.5947813928428, -1931.1073354359505, -2314.529773785312, -2721.0276671315187, -2788.152391318011, -2544.90819818572, -2721.732817995627, -1879.4356789196863, -2933.8591108909377, -3798.2616516840785, -2203.1256453126493, -3121.234011416481, -1879.2862010953484, -1647.748040158113, -2048.865550455275, -1658.1647171210532, -2636.6087642307184, -2435.7064391139825, -1699.7928131700344, -2941.438839450671, -1429.7670370540673, -2080.5705638386294, -3479.2597943795463, -3102.6421622171147, -2831.2115547276676, -3017.6451182994433, -1727.8017796302643, -2279.3207061952817, -2299.368225631762, -2517.8153509156928, -2553.43181319302, -1419.2145481827872, -3962.2095358685783, -2447.4350033842793, -2403.0963553862657, -2297.7776394303555, -1817.0321487466217, -2468.51495657611, -3477.415223571528, -1650.7615592751079, -1781.8073116993698, -2099.9370569972907, -3689.7887839551045, -1680.1511701206623, -1375.7812289789397, -2127.0523529818483, -3073.4856730210745, -2320.3353604518393, -2892.37520334676, -2464.3827456419185, -1717.919173828718, -1914.434953471131, -2957.942198461935, -3659.282452632865, -2847.2914329021187, -2398.499397946723, -2017.9260099512649, -3699.2271957137255, -3668.401298741782, -3776.120883815609, -2644.7606135353376, -2915.217542643458, -1088.1345661198598, -3953.6426305645655, -1743.0615959811016, -1984.9000696096211, -1433.9325456008016], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 146, 150, 150, 150, 150], "policy_policy_0_reward": [-183.87915609231533, -31.837971303513715, -869.5171575503423, -789.5749504491965, -994.4794644023755, -898.809612883646, -976.8510579887458, -65.27058707970552, -378.42270138887466, -149.69530071341288, -1217.5552100518544, -112.61471846650686, -60.067665019584844, -196.76730516187322, -248.40866528365984, -804.7532603371235, -1059.900010481583, -294.16020124321585, -402.97534837935837, -578.8926341563409, -625.1816069858589, -396.4252752969981, -238.53980290048057, -375.22896539478717, -212.58634052054347, -628.4157457920151, -405.6956100158944, -890.6195624481592, -116.08249853687805, -716.9540020432006, -269.805956138478, -536.9829768675487, -8.499456742204334, -294.2658660038337, -541.9050541186468, -423.73667976391556, -586.3797518958376, -734.5935515086887, -1183.8331000173314, -376.8980425785286, -60.46465877414058, -166.41390632477768, -464.6597793029737, -878.5243885687572, -230.07222035625028, -799.9894695307197, -839.7389134210148, -516.0842925793913, -938.9195620032959, -725.2524176132966, -447.3277097322646, -613.3591421847249, -166.57511656562934, -170.17198831279427, -61.88201383997833, -99.02641545205645, -246.06123259475552, -1050.2809573412496, -944.7696816012502, -123.88640304654882, -663.8248341861888, -265.47858424629777, -21.17216483281882, -166.52656384972212, -598.0280872314021, -72.80437348850468, -518.070304506524, -766.7612356899959, -730.9630447364623, -86.20731672797965, -748.3192779868068, -1241.094239426933, -809.7239188636586, -830.8181418446644, -561.0822956930652, -754.6559028548875, -714.0283837792491, -879.2147113837813, -112.00103037329443, -510.7701507034925, -431.02002271213655, -719.5398031988071, -445.2842121957501, -627.2956235134883, -656.5991956758489, -482.9397075694127, -306.9127566934515, -183.8236539048155, -428.6329837335121, -652.993867155619, -18.310897642396963, -1281.983037313589, -956.8467373689833, -943.1738241977482, -1181.793006041124, -170.80444937171652, -547.0393698677715, -107.70334652390808, -265.77384010583273, -590.8351266098817, -112.74952162068573, -25.570284102910602, -934.4112153514699, -182.55760773036044, -847.8962725018855, -111.51559799222383, -810.4668602681235, -306.8864877050964, -546.9540732926808, -339.7173623694999, -672.7346655987566, -909.3370874663166, -121.42640826859162, -169.22497155665644, -52.17856300193635, -835.7223789547932, -843.9726036607578, -36.98877931806298, -689.1520423995022, -419.268306319953, -393.18222530327006, -459.1173315320839, -23.626461276502706, -811.866449273214, -762.3888021014625, -968.1373221268726, -209.83551048028983, -43.316223677690935, -517.2945328908821, -554.5751680256868, -904.7757340343107, -17.006099736380083, -48.55270450976144, -708.8277926846968, -493.14459966738804, -689.8712985012858, -875.5976488747789, -581.1452673295339, -866.6831523321852, -382.5185595888104, -236.89353244516107, -635.9372017568804, -632.8224177826652, -282.00710028599866, -656.1115263373771, -722.3064180585908, -165.24457146029286, -94.892500457508, -57.83027290807297, -85.93980561820729, -1209.1087575152096, -858.0184507663164, -1013.3841823489985, -605.5701693132658, -379.9130839438597, -69.25292362828586, -68.23419904992392, -1134.4609252653445, -408.5201052369579, -250.84369388970126, -644.763667548605, -790.3048720275468, -493.494199609799, -412.5022138762631, -825.3756284210555, -786.1461203694214, -35.964719217219624, -170.91296392113975, -226.8132787458858, -745.7576991391749, -172.19234316063083, -289.6886042487294, -246.60920207764843, -976.4643901079015, -246.1527958410391, -431.6451402464661, -447.8404615019359, -656.9793828316523, -355.1151937244232, -422.9495954808353, -174.22050438669638, -1169.566816035702, -398.93080938472536, -942.5912645355721, -35.71827278882446, -46.190246135803505, -475.2416169230813, -142.99382634708155, -1018.2898400330254, -1105.436861879019, -804.2298273695536, -130.60882653377652, -303.5255508662762, -1058.8653053378866, -247.67868807822498, -9.521235427832732, -949.8468390367044, -562.6685500622248, -190.70085661667073, -1008.9953368521946, -84.76234830217126, -797.9892181190708, -143.37405106179858, -44.716323469166625, -808.5937379674799, -13.731618149478631, -1025.1195651823234, -645.537517773679, -100.10701261911163, -1149.3633971663476, -1042.8687585134085, -321.86631531584175, -259.9303642546414, -871.5412122168339, -1302.0550013833501, -429.04067746103203, -593.757787781496, -283.1744600049206, -20.398361637542298, -876.7543584276605, -242.86785565829442, -1153.6310385499128, -560.1537332150223, -877.2507278500229, -287.33065614323107, -455.65633466880536, -99.62001638252896, -8.50082746989892, -289.2044039663846, -1026.3046186077297, -102.56328426484662, -867.9465187874393, -174.31201049249577, -391.3551144989738, -111.5711121143581, -377.63122331878986, -891.3212871309765, -96.02369375080671, -462.5879253011268, -221.30142095357496, -216.06113685216872, -59.704000859609934, -734.2202835920217, -332.92891818843464, -315.25037762882016, -1164.1059636658367, -424.4576950580385, -56.75125703193974, -709.8631897677177, -281.43065870718397, -627.4064511976126, -976.8196792492012, -177.32824057901058, -202.60015058774698, -451.55191750041075, -165.77673480297327, -645.664896041306, -556.8436451574579, -208.09259410159763, -123.41494306670107, -264.0589566539862, -532.3112464079684, -989.355907143193, -655.1084563652993, -500.6042728802247, -223.46050133995624, -222.09574192524417, -143.0028795498638, -256.557715113027, -584.6501991259756, -518.7834940825501, -431.3148339372563, -986.2939214367399, -46.97180298880646, -97.20651139327786, -1165.5413058452436, -22.572723058460458, -896.9888068519808, -1292.6689121391069, -101.48804648475083, -1129.1637839073876, -1007.7610797082476, -593.2603529144498, -29.352124398766005, -343.1048212882637, -839.6875291030789, -813.7788016235193, -137.31482293562308, -657.1746592503154, -383.25574181513446, -656.3113075251833, -436.3737637551429, -1114.2916644685936, -411.5690970556096, -399.0992854949148, -136.80210605380486, -806.359513310356, -50.16286216852096, -38.2889806262733, -696.18831747131, -741.7045981401651, -225.67315965065762, -1111.612938691199, -153.76435947347616, -46.565650239786315, -641.4802958928276, -417.2061409516514, -7.423125930016626, -220.04277719356162, -1013.2158856637067, -215.63327658951232, -323.72073169352683, -497.9653312177006, -637.3613285509833, -843.1346828639684, -136.07745319256114, -466.33603548766047, -763.601848716035, -969.270630580892, -218.14584521587233, -828.8808626132242, -155.46316206257944, -16.81820150189092, -393.9690147577324, -24.083307247360015, -1010.8329852528099, -956.3685401116069, -1016.662438545905, -940.1585949446971, -38.18697701355639, -791.8511396620703, -220.63018881813124, -592.0141624847606, -285.3747693532757, -557.5647430660413, -228.47413324126254, -942.9184211749497, -83.57421215377879, -742.1264617855525, -406.00312703072285, -222.50927294747333, -629.6544171490536, -145.5725802921471, -737.474827099882, -562.5665419417998, -110.51769909745762, -67.06416784312367, -528.6331864550666, -69.17667874569405, -1041.6404166052805, -134.96161576750518, -917.0193757497649, -27.21374260990204, -1062.7046511131277, -326.6155713358106, -824.5965729232178, -107.03469164818412, -1214.9775930834471, -601.8337850599235, -728.9725808567558, -31.88601991926716, -120.8022473790519, -40.285241759828104, -301.48999521708834, -1156.298054999871, -245.65293696477033, -431.8539065154056, -139.03371587027388, -759.6527866872437, -205.61396566167795, -50.15838354761057, -72.28301743271727, -1002.0508563641039, -484.84306638060474, -490.60173327225215, -150.51510287115863, -928.6052077302455, -1042.9972833016188, -857.8706468539941, -709.8005431980896, -47.585510384202955, -297.21660491450723, -151.4121032879566, -728.471403902501, -455.4655476314949, -632.1021254509417, -182.23573139345038, -67.59070930829805, -321.4671490546667, -172.38551377158305, -131.76507115803113, -522.9599737267544, -717.5610733047122, -705.0870125303037, -49.6792222620467, -1290.0212434653145, -726.4914104264171, -750.9601709092018, -132.13652425504264, -173.87632396509954, -195.28527866617023, -549.8387375697982, -240.90703326909613, -476.2558537148734, -858.0484572319023, -121.96191683071326, -319.74713261500216, -626.1636821792478, -951.4516669993681, -873.0508047224275, -970.00135725138, -507.6390017035285, -20.12207291559876, -74.6220094896381, -891.9983042817695, -931.4750415896815, -477.34384115685623, -131.15402699562327, -95.66292209240038, -82.2833419941545, -932.1909815630044, -598.6335807565118, -121.95431733904503, -103.020882277282, -158.63519153528773, -825.9074116746624, -917.5471695815208, 6.852307650614107, -449.3294243501886, -772.0105005061762, -941.3073868347981, -26.697659922502506, -997.8885361983059, -815.3960902296176, -877.9927794476367, -202.21775399533016, -1074.9463748653693, -1082.03552595639, -342.0676766757616, -146.02410140926693, -377.6792782159545, -527.2394901684023, -829.8108356187356, -251.19416780622785, -412.5756261374026, -1206.9607482841755, -80.7516498478893, -503.0683520765409, -20.97055608723176, -206.17470365542852, -88.98941236673069, -1034.164121289611, -230.5329704516078, -1399.7633683875772, -945.777323218199, -99.67215089971656, -758.8199552435914, -1018.4188646674406, -1418.3377149261405, -373.1526130048953, -946.1883272837165, -404.49234288598643, -255.36426873162722, -1038.2624972325261, -1131.8134476817554, -86.18433205470605, -937.629370891752, -82.77278736803991, -816.9194446245504, -721.2546785962896, -902.5660568303297, -39.930865588877516, -363.62542334301895, -485.10482019405407, -1123.9903766871805, -91.257682510838, -21.9266593198217, -479.97476273044805, -200.822541736058, -294.1529198226926, -1037.1135207267523, -1277.7942119764905, -1207.6306447996144, -75.83970564237842, -355.26454741933026, -215.8800027057454, -463.6469549591517, -245.33114400949097, -156.47989497770865, -661.7235993290043, -62.049578141123874, -1058.71293102116, -506.4983115551872, -88.4084634965542, -269.2307853955946, -202.35545405504396, -233.9597383130855, -141.69834603648724, -786.6589313030647, -69.26007589311936]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5098035899901994, "mean_inference_ms": 1.6974895276626611, "mean_action_processing_ms": 0.8183887959532286, "mean_env_wait_ms": 10.078847356452858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012771129608154297, "StateBufferConnector_ms": 0.009535074234008789, "ViewRequirementAgentConnector_ms": 0.3172769546508789}, "num_episodes": 22, "episode_return_max": -1088.1345661198598, "episode_return_min": -4382.107502563841, "episode_return_mean": -2485.439624634133, "episodes_this_iter": 22}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 805378, "num_agent_steps_trained": 805378, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 75.40359889278722, "num_env_steps_trained_throughput_per_sec": 75.40359889278722, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 805378, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 805378, "timers": {"training_iteration_time_ms": 52433.125, "restore_workers_time_ms": 0.033, "training_step_time_ms": 52433.045, "sample_time_ms": 3184.131, "learn_time_ms": 49186.915, "learn_throughput": 81.322, "synch_weights_time_ms": 59.023}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 805378, "num_agent_steps_trained": 805378}, "done": false, "training_iteration": 46, "trial_id": "efc54_00000", "date": "2024-07-24_19-21-48", "timestamp": 1721829108, "time_this_iter_s": 53.05923509597778, "time_total_s": 2506.4067208766937, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d71fb50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2506.4067208766937, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 9.957894736842105, "ram_util_percent": 23.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 127.36261988530556, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.584759734012186, "policy_loss": 0.000711511128914329, "vf_loss": 4.601643334391216, "vf_explained_var": 0.9858034563095619, "kl": 0.017499872727391143, "entropy": 2.3501322757142287, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.203125, "num_grad_updates_lifetime": 191310.5, "diff_num_grad_updates_vs_sampler_policy": 1919.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 821660, "num_agent_steps_trained": 821660}, "env_runners": {"episode_reward_max": -1088.1345661198598, "episode_reward_min": -4065.9946438876523, "episode_reward_mean": -2499.28877420244, "episode_len_mean": 149.96, "episode_media": {}, "episodes_timesteps_total": 14996, "policy_reward_min": {"policy_0": -1418.3377149261405}, "policy_reward_max": {"policy_0": 6.852307650614107}, "policy_reward_mean": {"policy_0": -499.857754840488}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2825.1041106530683, -2450.181269486534, -2293.158757201422, -2172.3069306325356, -3395.8159266265934, -2443.771778608084, -1126.2135685026724, -4065.9946438876523, -1931.3118470702127, -3166.4405814832744, -1965.5947813928428, -1931.1073354359505, -2314.529773785312, -2721.0276671315187, -2788.152391318011, -2544.90819818572, -2721.732817995627, -1879.4356789196863, -2933.8591108909377, -3798.2616516840785, -2203.1256453126493, -3121.234011416481, -1879.2862010953484, -1647.748040158113, -2048.865550455275, -1658.1647171210532, -2636.6087642307184, -2435.7064391139825, -1699.7928131700344, -2941.438839450671, -1429.7670370540673, -2080.5705638386294, -3479.2597943795463, -3102.6421622171147, -2831.2115547276676, -3017.6451182994433, -1727.8017796302643, -2279.3207061952817, -2299.368225631762, -2517.8153509156928, -2553.43181319302, -1419.2145481827872, -3962.2095358685783, -2447.4350033842793, -2403.0963553862657, -2297.7776394303555, -1817.0321487466217, -2468.51495657611, -3477.415223571528, -1650.7615592751079, -1781.8073116993698, -2099.9370569972907, -3689.7887839551045, -1680.1511701206623, -1375.7812289789397, -2127.0523529818483, -3073.4856730210745, -2320.3353604518393, -2892.37520334676, -2464.3827456419185, -1717.919173828718, -1914.434953471131, -2957.942198461935, -3659.282452632865, -2847.2914329021187, -2398.499397946723, -2017.9260099512649, -3699.2271957137255, -3668.401298741782, -3776.120883815609, -2644.7606135353376, -2915.217542643458, -1088.1345661198598, -3953.6426305645655, -1743.0615959811016, -1984.9000696096211, -1433.9325456008016, -2113.9083154654727, -2202.4805609116975, -2527.5405859613925, -3055.6339275250693, -3162.734819044881, -1279.0248215767667, -3928.6266690367943, -2768.230625026135, -2925.4890125734055, -2429.1870318283513, -2565.449744875464, -3787.3426986578193, -1942.0806170023693, -2208.469769800772, -2499.337873388071, -3472.894669088134, -2322.6785213514195, -1597.7949245208592, -2652.53864208874, -1639.779386814674, -1946.185395286203, -3104.0435259103942, -2868.4629148734944], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-835.7223789547932, -843.9726036607578, -36.98877931806298, -689.1520423995022, -419.268306319953, -393.18222530327006, -459.1173315320839, -23.626461276502706, -811.866449273214, -762.3888021014625, -968.1373221268726, -209.83551048028983, -43.316223677690935, -517.2945328908821, -554.5751680256868, -904.7757340343107, -17.006099736380083, -48.55270450976144, -708.8277926846968, -493.14459966738804, -689.8712985012858, -875.5976488747789, -581.1452673295339, -866.6831523321852, -382.5185595888104, -236.89353244516107, -635.9372017568804, -632.8224177826652, -282.00710028599866, -656.1115263373771, -722.3064180585908, -165.24457146029286, -94.892500457508, -57.83027290807297, -85.93980561820729, -1209.1087575152096, -858.0184507663164, -1013.3841823489985, -605.5701693132658, -379.9130839438597, -69.25292362828586, -68.23419904992392, -1134.4609252653445, -408.5201052369579, -250.84369388970126, -644.763667548605, -790.3048720275468, -493.494199609799, -412.5022138762631, -825.3756284210555, -786.1461203694214, -35.964719217219624, -170.91296392113975, -226.8132787458858, -745.7576991391749, -172.19234316063083, -289.6886042487294, -246.60920207764843, -976.4643901079015, -246.1527958410391, -431.6451402464661, -447.8404615019359, -656.9793828316523, -355.1151937244232, -422.9495954808353, -174.22050438669638, -1169.566816035702, -398.93080938472536, -942.5912645355721, -35.71827278882446, -46.190246135803505, -475.2416169230813, -142.99382634708155, -1018.2898400330254, -1105.436861879019, -804.2298273695536, -130.60882653377652, -303.5255508662762, -1058.8653053378866, -247.67868807822498, -9.521235427832732, -949.8468390367044, -562.6685500622248, -190.70085661667073, -1008.9953368521946, -84.76234830217126, -797.9892181190708, -143.37405106179858, -44.716323469166625, -808.5937379674799, -13.731618149478631, -1025.1195651823234, -645.537517773679, -100.10701261911163, -1149.3633971663476, -1042.8687585134085, -321.86631531584175, -259.9303642546414, -871.5412122168339, -1302.0550013833501, -429.04067746103203, -593.757787781496, -283.1744600049206, -20.398361637542298, -876.7543584276605, -242.86785565829442, -1153.6310385499128, -560.1537332150223, -877.2507278500229, -287.33065614323107, -455.65633466880536, -99.62001638252896, -8.50082746989892, -289.2044039663846, -1026.3046186077297, -102.56328426484662, -867.9465187874393, -174.31201049249577, -391.3551144989738, -111.5711121143581, -377.63122331878986, -891.3212871309765, -96.02369375080671, -462.5879253011268, -221.30142095357496, -216.06113685216872, -59.704000859609934, -734.2202835920217, -332.92891818843464, -315.25037762882016, -1164.1059636658367, -424.4576950580385, -56.75125703193974, -709.8631897677177, -281.43065870718397, -627.4064511976126, -976.8196792492012, -177.32824057901058, -202.60015058774698, -451.55191750041075, -165.77673480297327, -645.664896041306, -556.8436451574579, -208.09259410159763, -123.41494306670107, -264.0589566539862, -532.3112464079684, -989.355907143193, -655.1084563652993, -500.6042728802247, -223.46050133995624, -222.09574192524417, -143.0028795498638, -256.557715113027, -584.6501991259756, -518.7834940825501, -431.3148339372563, -986.2939214367399, -46.97180298880646, -97.20651139327786, -1165.5413058452436, -22.572723058460458, -896.9888068519808, -1292.6689121391069, -101.48804648475083, -1129.1637839073876, -1007.7610797082476, -593.2603529144498, -29.352124398766005, -343.1048212882637, -839.6875291030789, -813.7788016235193, -137.31482293562308, -657.1746592503154, -383.25574181513446, -656.3113075251833, -436.3737637551429, -1114.2916644685936, -411.5690970556096, -399.0992854949148, -136.80210605380486, -806.359513310356, -50.16286216852096, -38.2889806262733, -696.18831747131, -741.7045981401651, -225.67315965065762, -1111.612938691199, -153.76435947347616, -46.565650239786315, -641.4802958928276, -417.2061409516514, -7.423125930016626, -220.04277719356162, -1013.2158856637067, -215.63327658951232, -323.72073169352683, -497.9653312177006, -637.3613285509833, -843.1346828639684, -136.07745319256114, -466.33603548766047, -763.601848716035, -969.270630580892, -218.14584521587233, -828.8808626132242, -155.46316206257944, -16.81820150189092, -393.9690147577324, -24.083307247360015, -1010.8329852528099, -956.3685401116069, -1016.662438545905, -940.1585949446971, -38.18697701355639, -791.8511396620703, -220.63018881813124, -592.0141624847606, -285.3747693532757, -557.5647430660413, -228.47413324126254, -942.9184211749497, -83.57421215377879, -742.1264617855525, -406.00312703072285, -222.50927294747333, -629.6544171490536, -145.5725802921471, -737.474827099882, -562.5665419417998, -110.51769909745762, -67.06416784312367, -528.6331864550666, -69.17667874569405, -1041.6404166052805, -134.96161576750518, -917.0193757497649, -27.21374260990204, -1062.7046511131277, -326.6155713358106, -824.5965729232178, -107.03469164818412, -1214.9775930834471, -601.8337850599235, -728.9725808567558, -31.88601991926716, -120.8022473790519, -40.285241759828104, -301.48999521708834, -1156.298054999871, -245.65293696477033, -431.8539065154056, -139.03371587027388, -759.6527866872437, -205.61396566167795, -50.15838354761057, -72.28301743271727, -1002.0508563641039, -484.84306638060474, -490.60173327225215, -150.51510287115863, -928.6052077302455, -1042.9972833016188, -857.8706468539941, -709.8005431980896, -47.585510384202955, -297.21660491450723, -151.4121032879566, -728.471403902501, -455.4655476314949, -632.1021254509417, -182.23573139345038, -67.59070930829805, -321.4671490546667, -172.38551377158305, -131.76507115803113, -522.9599737267544, -717.5610733047122, -705.0870125303037, -49.6792222620467, -1290.0212434653145, -726.4914104264171, -750.9601709092018, -132.13652425504264, -173.87632396509954, -195.28527866617023, -549.8387375697982, -240.90703326909613, -476.2558537148734, -858.0484572319023, -121.96191683071326, -319.74713261500216, -626.1636821792478, -951.4516669993681, -873.0508047224275, -970.00135725138, -507.6390017035285, -20.12207291559876, -74.6220094896381, -891.9983042817695, -931.4750415896815, -477.34384115685623, -131.15402699562327, -95.66292209240038, -82.2833419941545, -932.1909815630044, -598.6335807565118, -121.95431733904503, -103.020882277282, -158.63519153528773, -825.9074116746624, -917.5471695815208, 6.852307650614107, -449.3294243501886, -772.0105005061762, -941.3073868347981, -26.697659922502506, -997.8885361983059, -815.3960902296176, -877.9927794476367, -202.21775399533016, -1074.9463748653693, -1082.03552595639, -342.0676766757616, -146.02410140926693, -377.6792782159545, -527.2394901684023, -829.8108356187356, -251.19416780622785, -412.5756261374026, -1206.9607482841755, -80.7516498478893, -503.0683520765409, -20.97055608723176, -206.17470365542852, -88.98941236673069, -1034.164121289611, -230.5329704516078, -1399.7633683875772, -945.777323218199, -99.67215089971656, -758.8199552435914, -1018.4188646674406, -1418.3377149261405, -373.1526130048953, -946.1883272837165, -404.49234288598643, -255.36426873162722, -1038.2624972325261, -1131.8134476817554, -86.18433205470605, -937.629370891752, -82.77278736803991, -816.9194446245504, -721.2546785962896, -902.5660568303297, -39.930865588877516, -363.62542334301895, -485.10482019405407, -1123.9903766871805, -91.257682510838, -21.9266593198217, -479.97476273044805, -200.822541736058, -294.1529198226926, -1037.1135207267523, -1277.7942119764905, -1207.6306447996144, -75.83970564237842, -355.26454741933026, -215.8800027057454, -463.6469549591517, -245.33114400949097, -156.47989497770865, -661.7235993290043, -62.049578141123874, -1058.71293102116, -506.4983115551872, -88.4084634965542, -269.2307853955946, -202.35545405504396, -233.9597383130855, -141.69834603648724, -786.6589313030647, -69.26007589311936, -223.95177486718035, -1279.9258838929952, -171.42754843313702, -189.36899879827476, -249.2341094738849, -416.9317020838424, -162.65709087345817, -322.53152970844167, -102.6741128801279, -1197.6861253658287, -339.9634317713771, -3.8791004807703797, -1105.004773657168, -790.4616573802185, -288.23162267186086, -670.7032485829279, -877.5718835484928, -205.00188917549238, -989.0532059413197, -313.30370027683534, -738.3237048419495, -73.18433192324491, -1206.3563952483844, -762.1245234353969, -382.7458635959056, -299.2511098690429, -316.4651799355558, -324.38739666568506, -240.75663491431666, -98.16450019216582, -61.25201755155288, -1013.6447919334232, -831.5305886873278, -624.3405037183564, -1397.8587671461344, -957.2675074237649, -1028.9461695182583, -108.42921235133555, -553.7471002502032, -119.84063548257089, -915.7208605115071, -452.8934986407149, -54.194480370169224, -892.4938500851465, -610.1863229658686, -187.11024923824976, -68.39403216718323, -145.95625989081998, -1100.768544434291, -926.9579460978091, -877.5061088341056, -722.6085139977395, -869.0960967577383, -64.74530144026023, -31.493723845622384, -692.9106910163412, -556.0885442979621, -887.1824616289465, -1242.6419936748916, -408.5190080396765, -537.2644395453423, -41.44650385870481, -430.9566521480134, -801.4451729375027, -130.9678485128053, -55.44308981198993, -415.2221022260305, -356.87749725565965, -707.2858251029872, -673.6412554041052, -1006.2573496330083, -53.219721710858316, -811.8729204903119, -489.3392068986019, -138.64867465528945, -1257.2322307719708, -245.42962539311182, -915.7239823616994, -818.8853755850197, -235.6234549763296, -217.26424403025013, -543.0475122307652, -288.4006259004279, -952.8810441651381, -321.0850950248402, -906.771245089851, -45.46972421884623, -115.56847391267719, -448.889153497223, -81.09632780226113, -63.38729474006817, -967.2107655820068, -290.28963961381845, -166.07938751154154, -1165.5715546413091, -26.81524926418162, -11.322940722471706, -749.551285988978, -493.3982090366454, -358.691701802396, -85.40106063232533, -161.84794418639922, -107.95408837212445, -895.587277495719, -695.3950245996341, -772.1108787785522, -109.6980495874958, -155.2075438560428, -691.9704994133043, -1375.0565542749969, -433.0774644580847, -1036.2403017481083, -1136.1121425328797, -64.86305674031671, -198.16994939410648]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5081462168769224, "mean_inference_ms": 1.6977270249044571, "mean_action_processing_ms": 0.8165013501360007, "mean_env_wait_ms": 10.071057467767753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012854576110839844, "StateBufferConnector_ms": 0.009491205215454102, "ViewRequirementAgentConnector_ms": 0.31496548652648926}, "num_episodes": 23, "episode_return_max": -1088.1345661198598, "episode_return_min": -4065.9946438876523, "episode_return_mean": -2499.28877420244, "episodes_this_iter": 23}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 821660, "num_agent_steps_trained": 821660, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 75.82201140104867, "num_env_steps_trained_throughput_per_sec": 75.82201140104867, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 821660, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 821660, "timers": {"training_iteration_time_ms": 52316.259, "restore_workers_time_ms": 0.033, "training_step_time_ms": 52316.177, "sample_time_ms": 3152.735, "learn_time_ms": 49102.436, "learn_throughput": 81.462, "synch_weights_time_ms": 58.039}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 821660, "num_agent_steps_trained": 821660}, "done": false, "training_iteration": 47, "trial_id": "efc54_00000", "date": "2024-07-24_19-22-41", "timestamp": 1721829161, "time_this_iter_s": 52.76547145843506, "time_total_s": 2559.172192335129, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d71feb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2559.172192335129, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 9.883999999999999, "ram_util_percent": 23.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 120.64810400264396, "cur_kl_coeff": 0.33750000000000013, "cur_lr": 0.0010000000000000005, "total_loss": 4.866644029489689, "policy_loss": -0.0001638291142495698, "vf_loss": 4.88403283424331, "vf_explained_var": 0.9836609692904201, "kl": 0.016062286703670603, "entropy": 2.2645999238728898, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.97080291970804, "num_grad_updates_lifetime": 195285.5, "diff_num_grad_updates_vs_sampler_policy": 2054.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 839192, "num_agent_steps_trained": 839192}, "env_runners": {"episode_reward_max": -452.6516939530289, "episode_reward_min": -3962.2095358685783, "episode_reward_mean": -2470.2297172828207, "episode_len_mean": 148.45, "episode_media": {}, "episodes_timesteps_total": 14845, "policy_reward_min": {"policy_0": -1431.8572966149363}, "policy_reward_max": {"policy_0": 6.852307650614107}, "policy_reward_mean": {"policy_0": -494.0459434565642}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3017.6451182994433, -1727.8017796302643, -2279.3207061952817, -2299.368225631762, -2517.8153509156928, -2553.43181319302, -1419.2145481827872, -3962.2095358685783, -2447.4350033842793, -2403.0963553862657, -2297.7776394303555, -1817.0321487466217, -2468.51495657611, -3477.415223571528, -1650.7615592751079, -1781.8073116993698, -2099.9370569972907, -3689.7887839551045, -1680.1511701206623, -1375.7812289789397, -2127.0523529818483, -3073.4856730210745, -2320.3353604518393, -2892.37520334676, -2464.3827456419185, -1717.919173828718, -1914.434953471131, -2957.942198461935, -3659.282452632865, -2847.2914329021187, -2398.499397946723, -2017.9260099512649, -3699.2271957137255, -3668.401298741782, -3776.120883815609, -2644.7606135353376, -2915.217542643458, -1088.1345661198598, -3953.6426305645655, -1743.0615959811016, -1984.9000696096211, -1433.9325456008016, -2113.9083154654727, -2202.4805609116975, -2527.5405859613925, -3055.6339275250693, -3162.734819044881, -1279.0248215767667, -3928.6266690367943, -2768.230625026135, -2925.4890125734055, -2429.1870318283513, -2565.449744875464, -3787.3426986578193, -1942.0806170023693, -2208.469769800772, -2499.337873388071, -3472.894669088134, -2322.6785213514195, -1597.7949245208592, -2652.53864208874, -1639.779386814674, -1946.185395286203, -3104.0435259103942, -2868.4629148734944, -2736.507980415328, -3630.3745628070355, -3084.9296490042475, -2223.76261414301, -1828.8647456037968, -2413.7457828821657, -2759.9192197858033, -2031.027166478159, -2943.3731481359, -2279.071693696994, -1451.2202387551567, -2881.0247291471233, -2921.761471185769, -1539.5711919796222, -606.7257253642605, -2198.697406136875, -3885.4535195718677, -2669.165162147779, -452.6516939530289, -1604.4216215730733, -2847.333415758281, -2767.538236442587, -3194.7394711586444, -2940.5907804964495, -1803.426762490439, -2388.3220059713385, -2415.363652394204, -1779.9763532151667, -2167.9859154092383, -3176.160877871979, -2255.3917026241625, -3053.939337256808, -1702.8588209468896, -2704.634746681958, -2417.8938611860817], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 134, 100, 150, 150, 150, 94, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 122, 150, 150], "policy_policy_0_reward": [-656.3113075251833, -436.3737637551429, -1114.2916644685936, -411.5690970556096, -399.0992854949148, -136.80210605380486, -806.359513310356, -50.16286216852096, -38.2889806262733, -696.18831747131, -741.7045981401651, -225.67315965065762, -1111.612938691199, -153.76435947347616, -46.565650239786315, -641.4802958928276, -417.2061409516514, -7.423125930016626, -220.04277719356162, -1013.2158856637067, -215.63327658951232, -323.72073169352683, -497.9653312177006, -637.3613285509833, -843.1346828639684, -136.07745319256114, -466.33603548766047, -763.601848716035, -969.270630580892, -218.14584521587233, -828.8808626132242, -155.46316206257944, -16.81820150189092, -393.9690147577324, -24.083307247360015, -1010.8329852528099, -956.3685401116069, -1016.662438545905, -940.1585949446971, -38.18697701355639, -791.8511396620703, -220.63018881813124, -592.0141624847606, -285.3747693532757, -557.5647430660413, -228.47413324126254, -942.9184211749497, -83.57421215377879, -742.1264617855525, -406.00312703072285, -222.50927294747333, -629.6544171490536, -145.5725802921471, -737.474827099882, -562.5665419417998, -110.51769909745762, -67.06416784312367, -528.6331864550666, -69.17667874569405, -1041.6404166052805, -134.96161576750518, -917.0193757497649, -27.21374260990204, -1062.7046511131277, -326.6155713358106, -824.5965729232178, -107.03469164818412, -1214.9775930834471, -601.8337850599235, -728.9725808567558, -31.88601991926716, -120.8022473790519, -40.285241759828104, -301.48999521708834, -1156.298054999871, -245.65293696477033, -431.8539065154056, -139.03371587027388, -759.6527866872437, -205.61396566167795, -50.15838354761057, -72.28301743271727, -1002.0508563641039, -484.84306638060474, -490.60173327225215, -150.51510287115863, -928.6052077302455, -1042.9972833016188, -857.8706468539941, -709.8005431980896, -47.585510384202955, -297.21660491450723, -151.4121032879566, -728.471403902501, -455.4655476314949, -632.1021254509417, -182.23573139345038, -67.59070930829805, -321.4671490546667, -172.38551377158305, -131.76507115803113, -522.9599737267544, -717.5610733047122, -705.0870125303037, -49.6792222620467, -1290.0212434653145, -726.4914104264171, -750.9601709092018, -132.13652425504264, -173.87632396509954, -195.28527866617023, -549.8387375697982, -240.90703326909613, -476.2558537148734, -858.0484572319023, -121.96191683071326, -319.74713261500216, -626.1636821792478, -951.4516669993681, -873.0508047224275, -970.00135725138, -507.6390017035285, -20.12207291559876, -74.6220094896381, -891.9983042817695, -931.4750415896815, -477.34384115685623, -131.15402699562327, -95.66292209240038, -82.2833419941545, -932.1909815630044, -598.6335807565118, -121.95431733904503, -103.020882277282, -158.63519153528773, -825.9074116746624, -917.5471695815208, 6.852307650614107, -449.3294243501886, -772.0105005061762, -941.3073868347981, -26.697659922502506, -997.8885361983059, -815.3960902296176, -877.9927794476367, -202.21775399533016, -1074.9463748653693, -1082.03552595639, -342.0676766757616, -146.02410140926693, -377.6792782159545, -527.2394901684023, -829.8108356187356, -251.19416780622785, -412.5756261374026, -1206.9607482841755, -80.7516498478893, -503.0683520765409, -20.97055608723176, -206.17470365542852, -88.98941236673069, -1034.164121289611, -230.5329704516078, -1399.7633683875772, -945.777323218199, -99.67215089971656, -758.8199552435914, -1018.4188646674406, -1418.3377149261405, -373.1526130048953, -946.1883272837165, -404.49234288598643, -255.36426873162722, -1038.2624972325261, -1131.8134476817554, -86.18433205470605, -937.629370891752, -82.77278736803991, -816.9194446245504, -721.2546785962896, -902.5660568303297, -39.930865588877516, -363.62542334301895, -485.10482019405407, -1123.9903766871805, -91.257682510838, -21.9266593198217, -479.97476273044805, -200.822541736058, -294.1529198226926, -1037.1135207267523, -1277.7942119764905, -1207.6306447996144, -75.83970564237842, -355.26454741933026, -215.8800027057454, -463.6469549591517, -245.33114400949097, -156.47989497770865, -661.7235993290043, -62.049578141123874, -1058.71293102116, -506.4983115551872, -88.4084634965542, -269.2307853955946, -202.35545405504396, -233.9597383130855, -141.69834603648724, -786.6589313030647, -69.26007589311936, -223.95177486718035, -1279.9258838929952, -171.42754843313702, -189.36899879827476, -249.2341094738849, -416.9317020838424, -162.65709087345817, -322.53152970844167, -102.6741128801279, -1197.6861253658287, -339.9634317713771, -3.8791004807703797, -1105.004773657168, -790.4616573802185, -288.23162267186086, -670.7032485829279, -877.5718835484928, -205.00188917549238, -989.0532059413197, -313.30370027683534, -738.3237048419495, -73.18433192324491, -1206.3563952483844, -762.1245234353969, -382.7458635959056, -299.2511098690429, -316.4651799355558, -324.38739666568506, -240.75663491431666, -98.16450019216582, -61.25201755155288, -1013.6447919334232, -831.5305886873278, -624.3405037183564, -1397.8587671461344, -957.2675074237649, -1028.9461695182583, -108.42921235133555, -553.7471002502032, -119.84063548257089, -915.7208605115071, -452.8934986407149, -54.194480370169224, -892.4938500851465, -610.1863229658686, -187.11024923824976, -68.39403216718323, -145.95625989081998, -1100.768544434291, -926.9579460978091, -877.5061088341056, -722.6085139977395, -869.0960967577383, -64.74530144026023, -31.493723845622384, -692.9106910163412, -556.0885442979621, -887.1824616289465, -1242.6419936748916, -408.5190080396765, -537.2644395453423, -41.44650385870481, -430.9566521480134, -801.4451729375027, -130.9678485128053, -55.44308981198993, -415.2221022260305, -356.87749725565965, -707.2858251029872, -673.6412554041052, -1006.2573496330083, -53.219721710858316, -811.8729204903119, -489.3392068986019, -138.64867465528945, -1257.2322307719708, -245.42962539311182, -915.7239823616994, -818.8853755850197, -235.6234549763296, -217.26424403025013, -543.0475122307652, -288.4006259004279, -952.8810441651381, -321.0850950248402, -906.771245089851, -45.46972421884623, -115.56847391267719, -448.889153497223, -81.09632780226113, -63.38729474006817, -967.2107655820068, -290.28963961381845, -166.07938751154154, -1165.5715546413091, -26.81524926418162, -11.322940722471706, -749.551285988978, -493.3982090366454, -358.691701802396, -85.40106063232533, -161.84794418639922, -107.95408837212445, -895.587277495719, -695.3950245996341, -772.1108787785522, -109.6980495874958, -155.2075438560428, -691.9704994133043, -1375.0565542749969, -433.0774644580847, -1036.2403017481083, -1136.1121425328797, -64.86305674031671, -198.16994939410648, -712.8272274154317, -20.55186975730823, -408.58052574231687, -162.69106088533843, -1431.8572966149363, -662.503792154152, -716.3841456471432, -665.89146532755, -358.4979141269976, -1227.0972455511928, -521.9707185791232, -998.1780199788157, -1137.6792387403502, -287.22302993577176, -139.87864177018807, -63.78034057634095, -86.10699175648078, -1030.3419408203872, -96.22046390921194, -947.31287708059, -647.6345843761958, -784.9391883570012, -153.86998018117353, -206.96463961684782, -35.456353072577514, -362.73362730362567, -199.25682061069645, -743.192686305966, -1001.4824995964009, -107.08014906547668, -1182.433167449326, -496.40530062224343, -723.2427927225839, -51.68364647297851, -306.1543125186685, -142.58097603593973, -611.3541662330163, -370.4667535653389, -778.8278073854119, -127.79746325845089, -744.929928155515, -886.0489857146524, -242.47102482824846, -224.27697875287717, -845.6462306846056, -147.29355650944717, -707.5687378700123, -430.59905655566035, -498.5544941922401, -495.05584856963594, -371.4121381710166, -355.4839875499824, -146.01486731039873, -110.76846168125225, -467.54078404250646, -434.1222171660936, -24.978324499067416, -1019.9353150546574, -820.4198545272914, -581.5690179000135, -660.6680641235133, -157.60677686583134, -865.089804229318, -772.4223298645788, -465.97449610252517, -439.2880701391267, -472.4021044705325, -292.66601163546164, -218.78365335006328, -116.43135238443624, -19.806403667470118, -30.801174113541993, -273.2907379605311, -4.9260026049806225, -277.9014070177366, -102.33650505078816, -343.7061523845573, -293.28944091476046, -639.2449467969318, -820.120360989836, -506.40846949812493, -1191.61168140131, -845.0006307355359, -183.08898704386786, -1159.3437508930278, -174.30625936737272, -1066.3264774551878, -111.43265448090021, -596.2856349871704, -720.8141358571476, -103.98407047785552, -212.94689038522282, -24.512716817421182, -53.856712771530624, -57.35130350099823, -222.8972549933805, -83.54995566956777, -77.02863615547297, -855.292087445144, -365.65368730950803, -961.2381677390091, -567.654678038579, -606.061327350821, -493.6613454633371, -218.71789716653677, -111.8386033296553, -929.4373153248947, -59.22856365881348, -501.1209960167319, -1165.9127581124912, -748.2491234593931, -421.159525057862, -7.9245151907991715, -1270.2235673515402, -747.1827400990502, -798.7450506847057, -792.9558576163141, -581.3698818959369, -493.23610115864585, -274.2838891408452, -115.10336709948183, -710.8242031173179, -432.48442535578715, -179.21097361708556, -365.803793300767, -542.0511543889035, -735.6995470523705, -41.528888783098274, -258.07201134333195, -810.9704044036328, -115.95773025479009, -1031.6752392008825, -259.78951626884475, -148.7859709319626, -859.1551957377219, -196.29222380252958, -345.2010849651111, -816.0909316131243, -114.79466921428526, -307.59744362011696, -603.8838663099747, -112.33471622289353, -318.2288037682721, -1039.2078595298715, -94.33066957822777, -1010.1377340080179, -263.17892908745085, -28.712504162165942, -1118.2340666495622, -755.8976439647811, -248.46099697907272, -1112.103857530745, -446.148475045412, -369.6573398268982, -79.02103324203424, -73.32363333882225, -1161.2864787998126, -730.5350528657773, -840.9229275114667, -247.87124474092923, -417.32638610635854, -372.7973585903704, -270.1939433755759, -215.06721318174664, -427.4739196928376, -733.5979191631706, -660.205860359115, -958.1279000847159, -79.25800496385114, -273.4450621111046, -35.286241975659415, -1016.8822373624697, -267.2290805032335, -894.9004819557153, -203.59581938900692]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5085032304976391, "mean_inference_ms": 1.7003127095025965, "mean_action_processing_ms": 0.8150088376168192, "mean_env_wait_ms": 10.074856447231365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01311492919921875, "StateBufferConnector_ms": 0.009509086608886719, "ViewRequirementAgentConnector_ms": 0.31557393074035645}, "num_episodes": 35, "episode_return_max": -452.6516939530289, "episode_return_min": -3962.2095358685783, "episode_return_mean": -2470.2297172828207, "episodes_this_iter": 35}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 839192, "num_agent_steps_trained": 839192, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 70.55528536181842, "num_env_steps_trained_throughput_per_sec": 70.55528536181842, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 839192, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 839192, "timers": {"training_iteration_time_ms": 53031.021, "restore_workers_time_ms": 0.032, "training_step_time_ms": 53030.941, "sample_time_ms": 3182.986, "learn_time_ms": 49787.498, "learn_throughput": 80.341, "synch_weights_time_ms": 57.45}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 839192, "num_agent_steps_trained": 839192}, "done": false, "training_iteration": 48, "trial_id": "efc54_00000", "date": "2024-07-24_19-23-38", "timestamp": 1721829218, "time_this_iter_s": 56.704912185668945, "time_total_s": 2615.8771045207977, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7ea680>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2615.8771045207977, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 9.69375, "ram_util_percent": 23.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 117.44217056682092, "cur_kl_coeff": 0.33750000000000013, "cur_lr": 0.0010000000000000005, "total_loss": 4.952019905558676, "policy_loss": 0.00019704974392718106, "vf_loss": 4.96946329833897, "vf_explained_var": 0.9802045431149218, "kl": 0.016405755257928322, "entropy": 2.3177383462587993, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.6793893129771, "num_grad_updates_lifetime": 199305.5, "diff_num_grad_updates_vs_sampler_policy": 1964.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 855918, "num_agent_steps_trained": 855918}, "env_runners": {"episode_reward_max": -452.6516939530289, "episode_reward_min": -4240.623974791808, "episode_reward_mean": -2511.38938005521, "episode_len_mean": 147.99, "episode_media": {}, "episodes_timesteps_total": 14799, "policy_reward_min": {"policy_0": -1431.8572966149363}, "policy_reward_max": {"policy_0": 6.852307650614107}, "policy_reward_mean": {"policy_0": -502.27787601104194}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2320.3353604518393, -2892.37520334676, -2464.3827456419185, -1717.919173828718, -1914.434953471131, -2957.942198461935, -3659.282452632865, -2847.2914329021187, -2398.499397946723, -2017.9260099512649, -3699.2271957137255, -3668.401298741782, -3776.120883815609, -2644.7606135353376, -2915.217542643458, -1088.1345661198598, -3953.6426305645655, -1743.0615959811016, -1984.9000696096211, -1433.9325456008016, -2113.9083154654727, -2202.4805609116975, -2527.5405859613925, -3055.6339275250693, -3162.734819044881, -1279.0248215767667, -3928.6266690367943, -2768.230625026135, -2925.4890125734055, -2429.1870318283513, -2565.449744875464, -3787.3426986578193, -1942.0806170023693, -2208.469769800772, -2499.337873388071, -3472.894669088134, -2322.6785213514195, -1597.7949245208592, -2652.53864208874, -1639.779386814674, -1946.185395286203, -3104.0435259103942, -2868.4629148734944, -2736.507980415328, -3630.3745628070355, -3084.9296490042475, -2223.76261414301, -1828.8647456037968, -2413.7457828821657, -2759.9192197858033, -2031.027166478159, -2943.3731481359, -2279.071693696994, -1451.2202387551567, -2881.0247291471233, -2921.761471185769, -1539.5711919796222, -606.7257253642605, -2198.697406136875, -3885.4535195718677, -2669.165162147779, -452.6516939530289, -1604.4216215730733, -2847.333415758281, -2767.538236442587, -3194.7394711586444, -2940.5907804964495, -1803.426762490439, -2388.3220059713385, -2415.363652394204, -1779.9763532151667, -2167.9859154092383, -3176.160877871979, -2255.3917026241625, -3053.939337256808, -1702.8588209468896, -2704.634746681958, -2417.8938611860817, -3031.8491123857466, -669.1803547541972, -1687.3899635693178, -3262.421091268354, -3127.6962402713243, -2528.651034328659, -2778.2830828993524, -2722.314584790601, -3510.742926769904, -1680.1542963635, -2538.7035309159055, -3516.1533871888646, -2841.7506832291806, -1893.0141321858803, -3524.2347902924594, -2305.330773411758, -1911.1032001659723, -2600.0374579815566, -2470.2075443377244, -4240.623974791808, -1827.419635776331, -1615.5480216018384], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 134, 100, 150, 150, 150, 94, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 122, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-195.28527866617023, -549.8387375697982, -240.90703326909613, -476.2558537148734, -858.0484572319023, -121.96191683071326, -319.74713261500216, -626.1636821792478, -951.4516669993681, -873.0508047224275, -970.00135725138, -507.6390017035285, -20.12207291559876, -74.6220094896381, -891.9983042817695, -931.4750415896815, -477.34384115685623, -131.15402699562327, -95.66292209240038, -82.2833419941545, -932.1909815630044, -598.6335807565118, -121.95431733904503, -103.020882277282, -158.63519153528773, -825.9074116746624, -917.5471695815208, 6.852307650614107, -449.3294243501886, -772.0105005061762, -941.3073868347981, -26.697659922502506, -997.8885361983059, -815.3960902296176, -877.9927794476367, -202.21775399533016, -1074.9463748653693, -1082.03552595639, -342.0676766757616, -146.02410140926693, -377.6792782159545, -527.2394901684023, -829.8108356187356, -251.19416780622785, -412.5756261374026, -1206.9607482841755, -80.7516498478893, -503.0683520765409, -20.97055608723176, -206.17470365542852, -88.98941236673069, -1034.164121289611, -230.5329704516078, -1399.7633683875772, -945.777323218199, -99.67215089971656, -758.8199552435914, -1018.4188646674406, -1418.3377149261405, -373.1526130048953, -946.1883272837165, -404.49234288598643, -255.36426873162722, -1038.2624972325261, -1131.8134476817554, -86.18433205470605, -937.629370891752, -82.77278736803991, -816.9194446245504, -721.2546785962896, -902.5660568303297, -39.930865588877516, -363.62542334301895, -485.10482019405407, -1123.9903766871805, -91.257682510838, -21.9266593198217, -479.97476273044805, -200.822541736058, -294.1529198226926, -1037.1135207267523, -1277.7942119764905, -1207.6306447996144, -75.83970564237842, -355.26454741933026, -215.8800027057454, -463.6469549591517, -245.33114400949097, -156.47989497770865, -661.7235993290043, -62.049578141123874, -1058.71293102116, -506.4983115551872, -88.4084634965542, -269.2307853955946, -202.35545405504396, -233.9597383130855, -141.69834603648724, -786.6589313030647, -69.26007589311936, -223.95177486718035, -1279.9258838929952, -171.42754843313702, -189.36899879827476, -249.2341094738849, -416.9317020838424, -162.65709087345817, -322.53152970844167, -102.6741128801279, -1197.6861253658287, -339.9634317713771, -3.8791004807703797, -1105.004773657168, -790.4616573802185, -288.23162267186086, -670.7032485829279, -877.5718835484928, -205.00188917549238, -989.0532059413197, -313.30370027683534, -738.3237048419495, -73.18433192324491, -1206.3563952483844, -762.1245234353969, -382.7458635959056, -299.2511098690429, -316.4651799355558, -324.38739666568506, -240.75663491431666, -98.16450019216582, -61.25201755155288, -1013.6447919334232, -831.5305886873278, -624.3405037183564, -1397.8587671461344, -957.2675074237649, -1028.9461695182583, -108.42921235133555, -553.7471002502032, -119.84063548257089, -915.7208605115071, -452.8934986407149, -54.194480370169224, -892.4938500851465, -610.1863229658686, -187.11024923824976, -68.39403216718323, -145.95625989081998, -1100.768544434291, -926.9579460978091, -877.5061088341056, -722.6085139977395, -869.0960967577383, -64.74530144026023, -31.493723845622384, -692.9106910163412, -556.0885442979621, -887.1824616289465, -1242.6419936748916, -408.5190080396765, -537.2644395453423, -41.44650385870481, -430.9566521480134, -801.4451729375027, -130.9678485128053, -55.44308981198993, -415.2221022260305, -356.87749725565965, -707.2858251029872, -673.6412554041052, -1006.2573496330083, -53.219721710858316, -811.8729204903119, -489.3392068986019, -138.64867465528945, -1257.2322307719708, -245.42962539311182, -915.7239823616994, -818.8853755850197, -235.6234549763296, -217.26424403025013, -543.0475122307652, -288.4006259004279, -952.8810441651381, -321.0850950248402, -906.771245089851, -45.46972421884623, -115.56847391267719, -448.889153497223, -81.09632780226113, -63.38729474006817, -967.2107655820068, -290.28963961381845, -166.07938751154154, -1165.5715546413091, -26.81524926418162, -11.322940722471706, -749.551285988978, -493.3982090366454, -358.691701802396, -85.40106063232533, -161.84794418639922, -107.95408837212445, -895.587277495719, -695.3950245996341, -772.1108787785522, -109.6980495874958, -155.2075438560428, -691.9704994133043, -1375.0565542749969, -433.0774644580847, -1036.2403017481083, -1136.1121425328797, -64.86305674031671, -198.16994939410648, -712.8272274154317, -20.55186975730823, -408.58052574231687, -162.69106088533843, -1431.8572966149363, -662.503792154152, -716.3841456471432, -665.89146532755, -358.4979141269976, -1227.0972455511928, -521.9707185791232, -998.1780199788157, -1137.6792387403502, -287.22302993577176, -139.87864177018807, -63.78034057634095, -86.10699175648078, -1030.3419408203872, -96.22046390921194, -947.31287708059, -647.6345843761958, -784.9391883570012, -153.86998018117353, -206.96463961684782, -35.456353072577514, -362.73362730362567, -199.25682061069645, -743.192686305966, -1001.4824995964009, -107.08014906547668, -1182.433167449326, -496.40530062224343, -723.2427927225839, -51.68364647297851, -306.1543125186685, -142.58097603593973, -611.3541662330163, -370.4667535653389, -778.8278073854119, -127.79746325845089, -744.929928155515, -886.0489857146524, -242.47102482824846, -224.27697875287717, -845.6462306846056, -147.29355650944717, -707.5687378700123, -430.59905655566035, -498.5544941922401, -495.05584856963594, -371.4121381710166, -355.4839875499824, -146.01486731039873, -110.76846168125225, -467.54078404250646, -434.1222171660936, -24.978324499067416, -1019.9353150546574, -820.4198545272914, -581.5690179000135, -660.6680641235133, -157.60677686583134, -865.089804229318, -772.4223298645788, -465.97449610252517, -439.2880701391267, -472.4021044705325, -292.66601163546164, -218.78365335006328, -116.43135238443624, -19.806403667470118, -30.801174113541993, -273.2907379605311, -4.9260026049806225, -277.9014070177366, -102.33650505078816, -343.7061523845573, -293.28944091476046, -639.2449467969318, -820.120360989836, -506.40846949812493, -1191.61168140131, -845.0006307355359, -183.08898704386786, -1159.3437508930278, -174.30625936737272, -1066.3264774551878, -111.43265448090021, -596.2856349871704, -720.8141358571476, -103.98407047785552, -212.94689038522282, -24.512716817421182, -53.856712771530624, -57.35130350099823, -222.8972549933805, -83.54995566956777, -77.02863615547297, -855.292087445144, -365.65368730950803, -961.2381677390091, -567.654678038579, -606.061327350821, -493.6613454633371, -218.71789716653677, -111.8386033296553, -929.4373153248947, -59.22856365881348, -501.1209960167319, -1165.9127581124912, -748.2491234593931, -421.159525057862, -7.9245151907991715, -1270.2235673515402, -747.1827400990502, -798.7450506847057, -792.9558576163141, -581.3698818959369, -493.23610115864585, -274.2838891408452, -115.10336709948183, -710.8242031173179, -432.48442535578715, -179.21097361708556, -365.803793300767, -542.0511543889035, -735.6995470523705, -41.528888783098274, -258.07201134333195, -810.9704044036328, -115.95773025479009, -1031.6752392008825, -259.78951626884475, -148.7859709319626, -859.1551957377219, -196.29222380252958, -345.2010849651111, -816.0909316131243, -114.79466921428526, -307.59744362011696, -603.8838663099747, -112.33471622289353, -318.2288037682721, -1039.2078595298715, -94.33066957822777, -1010.1377340080179, -263.17892908745085, -28.712504162165942, -1118.2340666495622, -755.8976439647811, -248.46099697907272, -1112.103857530745, -446.148475045412, -369.6573398268982, -79.02103324203424, -73.32363333882225, -1161.2864787998126, -730.5350528657773, -840.9229275114667, -247.87124474092923, -417.32638610635854, -372.7973585903704, -270.1939433755759, -215.06721318174664, -427.4739196928376, -733.5979191631706, -660.205860359115, -958.1279000847159, -79.25800496385114, -273.4450621111046, -35.286241975659415, -1016.8822373624697, -267.2290805032335, -894.9004819557153, -203.59581938900692, -168.23475083044968, -577.0031803698247, -395.0715984126377, -770.0951289520355, -1121.4444538207986, -145.88567877986128, -104.27964166319342, -73.09146405131878, -76.61099363437361, -269.3125766254499, -51.76205648161725, -108.71061496152797, -308.70730258532404, -149.41927382818443, -1068.7907157126635, -54.40022516390088, -947.9409012528229, -1383.968697918826, -106.47818323461604, -769.6330836981876, -321.506946159859, -587.7642103496478, -138.54552828156056, -929.4919740570032, -1150.3875814232538, -1054.1098504548534, -692.685297511259, -38.42684650048256, -215.94379210152488, -527.4852477605386, -593.8169435407964, -72.91773434843496, -576.0897871120053, -1039.4644108734453, -495.9942070246718, -929.7512577510548, -121.72259976504466, -266.99996445792374, -320.4895859584622, -1083.351176858117, -704.9241887732753, -764.6990781050913, -344.0595514037916, -496.5856918298271, -1200.474416657917, -272.4275063681786, -422.54725619593466, -31.00363834443673, -116.92724336480434, -837.2486520901447, -653.2284539915793, -235.37839218403448, -542.7455188279898, -481.11559772535514, -626.2355681869458, -849.3136230194212, -821.9157692944065, -908.0082797586913, -618.6642861561286, -318.25142896021714, -408.9981951026392, -936.3451023754875, -1013.9560341450243, -320.9114793104162, -161.53987229561105, -408.40064880246257, -803.6205134206756, -199.0953486358757, -263.6020236359819, -218.29559769088402, -437.14484433690563, -1327.4995329666253, -741.012786938257, -159.31111439628194, -859.2665116543935, -58.459431267697035, -605.1208342144887, -694.1785321129018, -746.1172884364402, -201.45468738023177, -592.7970274204906, -132.17872973683941, -139.84797091762286, -741.5891017344812, -304.69037035653747, -226.66921159941228, -386.7824248772154, -747.2828543449133, -458.54105641275737, -780.7619107472543, -502.30901778170505, -438.26410887890165, -299.1054690988479, -350.5066070760318, -880.0223415022393, -1101.651999876151, -959.4278748071232, -344.7180138460219, -767.3489564111, -1067.4771298514154, -194.44651716035952, -356.36729915882034, -213.9540123969708, -1057.474798388759, -5.1770086714229295, -204.0597053388899, -815.1921804819141, -44.666116298876226, -502.89140748705034, -48.738611995109274]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.504504086027373, "mean_inference_ms": 1.6960668741365408, "mean_action_processing_ms": 0.8132064983854161, "mean_env_wait_ms": 10.043122501260767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013462543487548828, "StateBufferConnector_ms": 0.009630918502807617, "ViewRequirementAgentConnector_ms": 0.32286882400512695}, "num_episodes": 22, "episode_return_max": -452.6516939530289, "episode_return_min": -4240.623974791808, "episode_return_mean": -2511.38938005521, "episodes_this_iter": 22}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 855918, "num_agent_steps_trained": 855918, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.803062110638, "num_env_steps_trained_throughput_per_sec": 73.803062110638, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 855918, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 855918, "timers": {"training_iteration_time_ms": 52689.295, "restore_workers_time_ms": 0.032, "training_step_time_ms": 52689.215, "sample_time_ms": 3200.3, "learn_time_ms": 49429.666, "learn_throughput": 80.923, "synch_weights_time_ms": 56.29}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 855918, "num_agent_steps_trained": 855918}, "done": false, "training_iteration": 49, "trial_id": "efc54_00000", "date": "2024-07-24_19-24-32", "timestamp": 1721829272, "time_this_iter_s": 54.20976448059082, "time_total_s": 2670.0868690013885, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x717514105240>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2670.0868690013885, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 10.089610389610387, "ram_util_percent": 23.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 130.12113588170487, "cur_kl_coeff": 0.3375, "cur_lr": 0.0010000000000000005, "total_loss": 4.864808578700674, "policy_loss": 0.00010823659748181902, "vf_loss": 4.882872120724168, "vf_explained_var": 0.9822995430431317, "kl": 0.016435467691657987, "entropy": 2.371874841239101, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.86046511627907, "num_grad_updates_lifetime": 203205.5, "diff_num_grad_updates_vs_sampler_policy": 1934.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 872412, "num_agent_steps_trained": 872412}, "env_runners": {"episode_reward_max": -452.6516939530289, "episode_reward_min": -4240.623974791808, "episode_reward_mean": -2515.5008401026025, "episode_len_mean": 147.84, "episode_media": {}, "episodes_timesteps_total": 14784, "policy_reward_min": {"policy_0": -1431.8572966149363}, "policy_reward_max": {"policy_0": -4.9260026049806225}, "policy_reward_mean": {"policy_0": -503.10016802052036}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3928.6266690367943, -2768.230625026135, -2925.4890125734055, -2429.1870318283513, -2565.449744875464, -3787.3426986578193, -1942.0806170023693, -2208.469769800772, -2499.337873388071, -3472.894669088134, -2322.6785213514195, -1597.7949245208592, -2652.53864208874, -1639.779386814674, -1946.185395286203, -3104.0435259103942, -2868.4629148734944, -2736.507980415328, -3630.3745628070355, -3084.9296490042475, -2223.76261414301, -1828.8647456037968, -2413.7457828821657, -2759.9192197858033, -2031.027166478159, -2943.3731481359, -2279.071693696994, -1451.2202387551567, -2881.0247291471233, -2921.761471185769, -1539.5711919796222, -606.7257253642605, -2198.697406136875, -3885.4535195718677, -2669.165162147779, -452.6516939530289, -1604.4216215730733, -2847.333415758281, -2767.538236442587, -3194.7394711586444, -2940.5907804964495, -1803.426762490439, -2388.3220059713385, -2415.363652394204, -1779.9763532151667, -2167.9859154092383, -3176.160877871979, -2255.3917026241625, -3053.939337256808, -1702.8588209468896, -2704.634746681958, -2417.8938611860817, -3031.8491123857466, -669.1803547541972, -1687.3899635693178, -3262.421091268354, -3127.6962402713243, -2528.651034328659, -2778.2830828993524, -2722.314584790601, -3510.742926769904, -1680.1542963635, -2538.7035309159055, -3516.1533871888646, -2841.7506832291806, -1893.0141321858803, -3524.2347902924594, -2305.330773411758, -1911.1032001659723, -2600.0374579815566, -2470.2075443377244, -4240.623974791808, -1827.419635776331, -1615.5480216018384, -3629.7455608090604, -1466.435465006139, -3294.465441932061, -3542.3078907930308, -3499.412604090837, -2344.6162407430625, -3511.1920748918556, -3121.395159072707, -2651.3236112153654, -1844.5422136387847, -2653.76265550843, -2095.8183893647515, -2408.265441963935, -2336.9097045725175, -2064.596508491298, -1988.7784152606482, -2539.6964832902995, -3499.3136685594254, -2190.2386996040473, -3489.613276227821, -2396.921241593644, -1771.1326260655171, -1621.1041544460381, -1001.5864132911811, -3186.020776847954, -2701.0621889052054], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 134, 100, 150, 150, 150, 94, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 122, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 131, 150, 150], "policy_policy_0_reward": [-61.25201755155288, -1013.6447919334232, -831.5305886873278, -624.3405037183564, -1397.8587671461344, -957.2675074237649, -1028.9461695182583, -108.42921235133555, -553.7471002502032, -119.84063548257089, -915.7208605115071, -452.8934986407149, -54.194480370169224, -892.4938500851465, -610.1863229658686, -187.11024923824976, -68.39403216718323, -145.95625989081998, -1100.768544434291, -926.9579460978091, -877.5061088341056, -722.6085139977395, -869.0960967577383, -64.74530144026023, -31.493723845622384, -692.9106910163412, -556.0885442979621, -887.1824616289465, -1242.6419936748916, -408.5190080396765, -537.2644395453423, -41.44650385870481, -430.9566521480134, -801.4451729375027, -130.9678485128053, -55.44308981198993, -415.2221022260305, -356.87749725565965, -707.2858251029872, -673.6412554041052, -1006.2573496330083, -53.219721710858316, -811.8729204903119, -489.3392068986019, -138.64867465528945, -1257.2322307719708, -245.42962539311182, -915.7239823616994, -818.8853755850197, -235.6234549763296, -217.26424403025013, -543.0475122307652, -288.4006259004279, -952.8810441651381, -321.0850950248402, -906.771245089851, -45.46972421884623, -115.56847391267719, -448.889153497223, -81.09632780226113, -63.38729474006817, -967.2107655820068, -290.28963961381845, -166.07938751154154, -1165.5715546413091, -26.81524926418162, -11.322940722471706, -749.551285988978, -493.3982090366454, -358.691701802396, -85.40106063232533, -161.84794418639922, -107.95408837212445, -895.587277495719, -695.3950245996341, -772.1108787785522, -109.6980495874958, -155.2075438560428, -691.9704994133043, -1375.0565542749969, -433.0774644580847, -1036.2403017481083, -1136.1121425328797, -64.86305674031671, -198.16994939410648, -712.8272274154317, -20.55186975730823, -408.58052574231687, -162.69106088533843, -1431.8572966149363, -662.503792154152, -716.3841456471432, -665.89146532755, -358.4979141269976, -1227.0972455511928, -521.9707185791232, -998.1780199788157, -1137.6792387403502, -287.22302993577176, -139.87864177018807, -63.78034057634095, -86.10699175648078, -1030.3419408203872, -96.22046390921194, -947.31287708059, -647.6345843761958, -784.9391883570012, -153.86998018117353, -206.96463961684782, -35.456353072577514, -362.73362730362567, -199.25682061069645, -743.192686305966, -1001.4824995964009, -107.08014906547668, -1182.433167449326, -496.40530062224343, -723.2427927225839, -51.68364647297851, -306.1543125186685, -142.58097603593973, -611.3541662330163, -370.4667535653389, -778.8278073854119, -127.79746325845089, -744.929928155515, -886.0489857146524, -242.47102482824846, -224.27697875287717, -845.6462306846056, -147.29355650944717, -707.5687378700123, -430.59905655566035, -498.5544941922401, -495.05584856963594, -371.4121381710166, -355.4839875499824, -146.01486731039873, -110.76846168125225, -467.54078404250646, -434.1222171660936, -24.978324499067416, -1019.9353150546574, -820.4198545272914, -581.5690179000135, -660.6680641235133, -157.60677686583134, -865.089804229318, -772.4223298645788, -465.97449610252517, -439.2880701391267, -472.4021044705325, -292.66601163546164, -218.78365335006328, -116.43135238443624, -19.806403667470118, -30.801174113541993, -273.2907379605311, -4.9260026049806225, -277.9014070177366, -102.33650505078816, -343.7061523845573, -293.28944091476046, -639.2449467969318, -820.120360989836, -506.40846949812493, -1191.61168140131, -845.0006307355359, -183.08898704386786, -1159.3437508930278, -174.30625936737272, -1066.3264774551878, -111.43265448090021, -596.2856349871704, -720.8141358571476, -103.98407047785552, -212.94689038522282, -24.512716817421182, -53.856712771530624, -57.35130350099823, -222.8972549933805, -83.54995566956777, -77.02863615547297, -855.292087445144, -365.65368730950803, -961.2381677390091, -567.654678038579, -606.061327350821, -493.6613454633371, -218.71789716653677, -111.8386033296553, -929.4373153248947, -59.22856365881348, -501.1209960167319, -1165.9127581124912, -748.2491234593931, -421.159525057862, -7.9245151907991715, -1270.2235673515402, -747.1827400990502, -798.7450506847057, -792.9558576163141, -581.3698818959369, -493.23610115864585, -274.2838891408452, -115.10336709948183, -710.8242031173179, -432.48442535578715, -179.21097361708556, -365.803793300767, -542.0511543889035, -735.6995470523705, -41.528888783098274, -258.07201134333195, -810.9704044036328, -115.95773025479009, -1031.6752392008825, -259.78951626884475, -148.7859709319626, -859.1551957377219, -196.29222380252958, -345.2010849651111, -816.0909316131243, -114.79466921428526, -307.59744362011696, -603.8838663099747, -112.33471622289353, -318.2288037682721, -1039.2078595298715, -94.33066957822777, -1010.1377340080179, -263.17892908745085, -28.712504162165942, -1118.2340666495622, -755.8976439647811, -248.46099697907272, -1112.103857530745, -446.148475045412, -369.6573398268982, -79.02103324203424, -73.32363333882225, -1161.2864787998126, -730.5350528657773, -840.9229275114667, -247.87124474092923, -417.32638610635854, -372.7973585903704, -270.1939433755759, -215.06721318174664, -427.4739196928376, -733.5979191631706, -660.205860359115, -958.1279000847159, -79.25800496385114, -273.4450621111046, -35.286241975659415, -1016.8822373624697, -267.2290805032335, -894.9004819557153, -203.59581938900692, -168.23475083044968, -577.0031803698247, -395.0715984126377, -770.0951289520355, -1121.4444538207986, -145.88567877986128, -104.27964166319342, -73.09146405131878, -76.61099363437361, -269.3125766254499, -51.76205648161725, -108.71061496152797, -308.70730258532404, -149.41927382818443, -1068.7907157126635, -54.40022516390088, -947.9409012528229, -1383.968697918826, -106.47818323461604, -769.6330836981876, -321.506946159859, -587.7642103496478, -138.54552828156056, -929.4919740570032, -1150.3875814232538, -1054.1098504548534, -692.685297511259, -38.42684650048256, -215.94379210152488, -527.4852477605386, -593.8169435407964, -72.91773434843496, -576.0897871120053, -1039.4644108734453, -495.9942070246718, -929.7512577510548, -121.72259976504466, -266.99996445792374, -320.4895859584622, -1083.351176858117, -704.9241887732753, -764.6990781050913, -344.0595514037916, -496.5856918298271, -1200.474416657917, -272.4275063681786, -422.54725619593466, -31.00363834443673, -116.92724336480434, -837.2486520901447, -653.2284539915793, -235.37839218403448, -542.7455188279898, -481.11559772535514, -626.2355681869458, -849.3136230194212, -821.9157692944065, -908.0082797586913, -618.6642861561286, -318.25142896021714, -408.9981951026392, -936.3451023754875, -1013.9560341450243, -320.9114793104162, -161.53987229561105, -408.40064880246257, -803.6205134206756, -199.0953486358757, -263.6020236359819, -218.29559769088402, -437.14484433690563, -1327.4995329666253, -741.012786938257, -159.31111439628194, -859.2665116543935, -58.459431267697035, -605.1208342144887, -694.1785321129018, -746.1172884364402, -201.45468738023177, -592.7970274204906, -132.17872973683941, -139.84797091762286, -741.5891017344812, -304.69037035653747, -226.66921159941228, -386.7824248772154, -747.2828543449133, -458.54105641275737, -780.7619107472543, -502.30901778170505, -438.26410887890165, -299.1054690988479, -350.5066070760318, -880.0223415022393, -1101.651999876151, -959.4278748071232, -344.7180138460219, -767.3489564111, -1067.4771298514154, -194.44651716035952, -356.36729915882034, -213.9540123969708, -1057.474798388759, -5.1770086714229295, -204.0597053388899, -815.1921804819141, -44.666116298876226, -502.89140748705034, -48.738611995109274, -589.1041884347804, -924.3939830789722, -349.8273397083765, -867.7206537520186, -898.6993958349104, -439.0382292495879, -164.17655335080318, -676.1045972193858, -115.00104202389109, -72.1150431624717, -1035.2998193379335, -861.6367202801734, -143.23299057447815, -868.9970117122084, -385.2989000272647, -933.834518743265, -726.1770183999843, -398.38070282607947, -772.5202763680163, -711.3953744556875, -891.1861225690262, -424.54633636385796, -589.4735304779143, -766.2293900837128, -827.9772245963266, -217.71862046250803, -1167.4376107206572, -151.70155570948353, -96.60915599841591, -711.1492978519973, -1044.1894766624732, -669.8180314346499, -871.1105272115004, -389.0969231632774, -536.9771164199547, -970.5730124890246, -12.401214626007462, -28.367297235196496, -1129.0713527172327, -980.9822820052436, -968.801976634821, -80.33962618476629, -512.9589893405314, -41.64848905574352, -1047.5745299995035, -617.4013899300203, -66.16638445047319, -575.230528286805, -41.965348346670645, -543.7785626248174, -77.39798252358474, -367.9334311671549, -120.78926195907799, -843.3467048899863, -1244.2952749686247, -232.40983553822457, -858.336705578127, -108.19684406351718, -310.6661367294302, -586.2088674554535, -197.83523403185112, -189.77442941982264, -100.13804482303497, -857.6154994932136, -1062.9022341960122, -207.82299630717438, -521.3413790027969, -740.8025148535002, -249.00249310947916, -617.9403212995674, -447.26626313891995, -354.11772277691983, -291.4138104820799, -807.9465930027075, -163.85211909066945, -908.450649429891, -190.22921364739588, -192.31184284157226, -66.57580327977702, -631.210906062015, -80.54844705290137, -1053.033138257933, -204.7437586733477, -751.5516221146263, -449.8195171914913, -803.7768784788889, -881.3024841299107, -760.223629300765, -190.60145479188736, -863.4092218579765, -205.5575341156998, -1071.558965371897, -669.5239653674436, -90.5501575425037, -153.04807720650354, -459.20829090259406, -1027.7363803712035, -356.2169999747437, -835.7268471733682, -810.7247578059114, -162.87467063543926, -932.8589002393353, -282.7803353278863, -742.1362502140535, -276.2710851769285, -437.9154747062936, -546.8342942786536, -657.9795233402282, -37.03854628106462, -91.36478745927488, -394.0190085450027, -37.29412601865002, -970.9547999650856, -24.06944306006276, -194.76677685723845, -456.5726029763228, -75.2175174799019, -216.24213144555742, -35.264219631859405, -218.28994175753948, -729.0394623213034, -262.49245305680756, -463.08905759054096, -738.1245937514262, -993.2752101278736, -548.682068137966, -872.7006990076366, -245.56273309531363, -651.6842123572223, -382.43247630706463]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5053259240667753, "mean_inference_ms": 1.6992023622763819, "mean_action_processing_ms": 0.812843046163621, "mean_env_wait_ms": 10.056487162706148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013775825500488281, "StateBufferConnector_ms": 0.009819746017456055, "ViewRequirementAgentConnector_ms": 0.33133816719055176}, "num_episodes": 26, "episode_return_max": -452.6516939530289, "episode_return_min": -4240.623974791808, "episode_return_mean": -2515.5008401026025, "episodes_this_iter": 26}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 872412, "num_agent_steps_trained": 872412, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 75.52394359537384, "num_env_steps_trained_throughput_per_sec": 75.52394359537384, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 872412, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 872412, "timers": {"training_iteration_time_ms": 52681.21, "restore_workers_time_ms": 0.032, "training_step_time_ms": 52681.129, "sample_time_ms": 3179.433, "learn_time_ms": 49442.723, "learn_throughput": 80.902, "synch_weights_time_ms": 56.001}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 872412, "num_agent_steps_trained": 872412}, "done": false, "training_iteration": 50, "trial_id": "efc54_00000", "date": "2024-07-24_19-25-25", "timestamp": 1721829325, "time_this_iter_s": 52.97564888000488, "time_total_s": 2723.0625178813934, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7add80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2723.0625178813934, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 9.977631578947365, "ram_util_percent": 23.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 135.91710746560943, "cur_kl_coeff": 0.33750000000000013, "cur_lr": 0.0010000000000000005, "total_loss": 4.51748267568811, "policy_loss": -0.0008236649883525795, "vf_loss": 4.537219783975551, "vf_explained_var": 0.9833296061142228, "kl": 0.01638534534650338, "entropy": 2.4443502887032036, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.13868613138686, "num_grad_updates_lifetime": 207195.5, "diff_num_grad_updates_vs_sampler_policy": 2054.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 889830, "num_agent_steps_trained": 889830}, "env_runners": {"episode_reward_max": -452.6516939530289, "episode_reward_min": -4240.623974791808, "episode_reward_mean": -2510.292983209324, "episode_len_mean": 146.92, "episode_media": {}, "episodes_timesteps_total": 14692, "policy_reward_min": {"policy_0": -1383.968697918826}, "policy_reward_max": {"policy_0": -5.1770086714229295}, "policy_reward_mean": {"policy_0": -502.05859664186494}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2198.697406136875, -3885.4535195718677, -2669.165162147779, -452.6516939530289, -1604.4216215730733, -2847.333415758281, -2767.538236442587, -3194.7394711586444, -2940.5907804964495, -1803.426762490439, -2388.3220059713385, -2415.363652394204, -1779.9763532151667, -2167.9859154092383, -3176.160877871979, -2255.3917026241625, -3053.939337256808, -1702.8588209468896, -2704.634746681958, -2417.8938611860817, -3031.8491123857466, -669.1803547541972, -1687.3899635693178, -3262.421091268354, -3127.6962402713243, -2528.651034328659, -2778.2830828993524, -2722.314584790601, -3510.742926769904, -1680.1542963635, -2538.7035309159055, -3516.1533871888646, -2841.7506832291806, -1893.0141321858803, -3524.2347902924594, -2305.330773411758, -1911.1032001659723, -2600.0374579815566, -2470.2075443377244, -4240.623974791808, -1827.419635776331, -1615.5480216018384, -3629.7455608090604, -1466.435465006139, -3294.465441932061, -3542.3078907930308, -3499.412604090837, -2344.6162407430625, -3511.1920748918556, -3121.395159072707, -2651.3236112153654, -1844.5422136387847, -2653.76265550843, -2095.8183893647515, -2408.265441963935, -2336.9097045725175, -2064.596508491298, -1988.7784152606482, -2539.6964832902995, -3499.3136685594254, -2190.2386996040473, -3489.613276227821, -2396.921241593644, -1771.1326260655171, -1621.1041544460381, -1001.5864132911811, -3186.020776847954, -2701.0621889052054, -2043.5539842629885, -4232.206882938098, -3649.768294399827, -1753.7980846810365, -1846.5434617526162, -2929.7590432733873, -2499.4022017684515, -1923.0273227664043, -2555.840585028322, -2642.374823883293, -3004.7664851542836, -3684.601578757761, -704.5795458929541, -2738.7707375938407, -3801.8698712262244, -3633.7813470816063, -2216.783670409274, -2739.0272156465044, -3175.211527761817, -2392.9261677649524, -2437.1280564011045, -2039.8803076918775, -1036.5824018630217, -2716.5106688576752, -3006.400967253183, -2627.5047252210916, -2693.6940809931534, -1185.8397795172348, -1928.0130026112645, -1284.661665702784, -2047.500258867617, -2297.3775051561074], "episode_lengths": [150, 150, 150, 94, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 122, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 122, 150, 108, 150, 150], "policy_policy_0_reward": [-102.33650505078816, -343.7061523845573, -293.28944091476046, -639.2449467969318, -820.120360989836, -506.40846949812493, -1191.61168140131, -845.0006307355359, -183.08898704386786, -1159.3437508930278, -174.30625936737272, -1066.3264774551878, -111.43265448090021, -596.2856349871704, -720.8141358571476, -103.98407047785552, -212.94689038522282, -24.512716817421182, -53.856712771530624, -57.35130350099823, -222.8972549933805, -83.54995566956777, -77.02863615547297, -855.292087445144, -365.65368730950803, -961.2381677390091, -567.654678038579, -606.061327350821, -493.6613454633371, -218.71789716653677, -111.8386033296553, -929.4373153248947, -59.22856365881348, -501.1209960167319, -1165.9127581124912, -748.2491234593931, -421.159525057862, -7.9245151907991715, -1270.2235673515402, -747.1827400990502, -798.7450506847057, -792.9558576163141, -581.3698818959369, -493.23610115864585, -274.2838891408452, -115.10336709948183, -710.8242031173179, -432.48442535578715, -179.21097361708556, -365.803793300767, -542.0511543889035, -735.6995470523705, -41.528888783098274, -258.07201134333195, -810.9704044036328, -115.95773025479009, -1031.6752392008825, -259.78951626884475, -148.7859709319626, -859.1551957377219, -196.29222380252958, -345.2010849651111, -816.0909316131243, -114.79466921428526, -307.59744362011696, -603.8838663099747, -112.33471622289353, -318.2288037682721, -1039.2078595298715, -94.33066957822777, -1010.1377340080179, -263.17892908745085, -28.712504162165942, -1118.2340666495622, -755.8976439647811, -248.46099697907272, -1112.103857530745, -446.148475045412, -369.6573398268982, -79.02103324203424, -73.32363333882225, -1161.2864787998126, -730.5350528657773, -840.9229275114667, -247.87124474092923, -417.32638610635854, -372.7973585903704, -270.1939433755759, -215.06721318174664, -427.4739196928376, -733.5979191631706, -660.205860359115, -958.1279000847159, -79.25800496385114, -273.4450621111046, -35.286241975659415, -1016.8822373624697, -267.2290805032335, -894.9004819557153, -203.59581938900692, -168.23475083044968, -577.0031803698247, -395.0715984126377, -770.0951289520355, -1121.4444538207986, -145.88567877986128, -104.27964166319342, -73.09146405131878, -76.61099363437361, -269.3125766254499, -51.76205648161725, -108.71061496152797, -308.70730258532404, -149.41927382818443, -1068.7907157126635, -54.40022516390088, -947.9409012528229, -1383.968697918826, -106.47818323461604, -769.6330836981876, -321.506946159859, -587.7642103496478, -138.54552828156056, -929.4919740570032, -1150.3875814232538, -1054.1098504548534, -692.685297511259, -38.42684650048256, -215.94379210152488, -527.4852477605386, -593.8169435407964, -72.91773434843496, -576.0897871120053, -1039.4644108734453, -495.9942070246718, -929.7512577510548, -121.72259976504466, -266.99996445792374, -320.4895859584622, -1083.351176858117, -704.9241887732753, -764.6990781050913, -344.0595514037916, -496.5856918298271, -1200.474416657917, -272.4275063681786, -422.54725619593466, -31.00363834443673, -116.92724336480434, -837.2486520901447, -653.2284539915793, -235.37839218403448, -542.7455188279898, -481.11559772535514, -626.2355681869458, -849.3136230194212, -821.9157692944065, -908.0082797586913, -618.6642861561286, -318.25142896021714, -408.9981951026392, -936.3451023754875, -1013.9560341450243, -320.9114793104162, -161.53987229561105, -408.40064880246257, -803.6205134206756, -199.0953486358757, -263.6020236359819, -218.29559769088402, -437.14484433690563, -1327.4995329666253, -741.012786938257, -159.31111439628194, -859.2665116543935, -58.459431267697035, -605.1208342144887, -694.1785321129018, -746.1172884364402, -201.45468738023177, -592.7970274204906, -132.17872973683941, -139.84797091762286, -741.5891017344812, -304.69037035653747, -226.66921159941228, -386.7824248772154, -747.2828543449133, -458.54105641275737, -780.7619107472543, -502.30901778170505, -438.26410887890165, -299.1054690988479, -350.5066070760318, -880.0223415022393, -1101.651999876151, -959.4278748071232, -344.7180138460219, -767.3489564111, -1067.4771298514154, -194.44651716035952, -356.36729915882034, -213.9540123969708, -1057.474798388759, -5.1770086714229295, -204.0597053388899, -815.1921804819141, -44.666116298876226, -502.89140748705034, -48.738611995109274, -589.1041884347804, -924.3939830789722, -349.8273397083765, -867.7206537520186, -898.6993958349104, -439.0382292495879, -164.17655335080318, -676.1045972193858, -115.00104202389109, -72.1150431624717, -1035.2998193379335, -861.6367202801734, -143.23299057447815, -868.9970117122084, -385.2989000272647, -933.834518743265, -726.1770183999843, -398.38070282607947, -772.5202763680163, -711.3953744556875, -891.1861225690262, -424.54633636385796, -589.4735304779143, -766.2293900837128, -827.9772245963266, -217.71862046250803, -1167.4376107206572, -151.70155570948353, -96.60915599841591, -711.1492978519973, -1044.1894766624732, -669.8180314346499, -871.1105272115004, -389.0969231632774, -536.9771164199547, -970.5730124890246, -12.401214626007462, -28.367297235196496, -1129.0713527172327, -980.9822820052436, -968.801976634821, -80.33962618476629, -512.9589893405314, -41.64848905574352, -1047.5745299995035, -617.4013899300203, -66.16638445047319, -575.230528286805, -41.965348346670645, -543.7785626248174, -77.39798252358474, -367.9334311671549, -120.78926195907799, -843.3467048899863, -1244.2952749686247, -232.40983553822457, -858.336705578127, -108.19684406351718, -310.6661367294302, -586.2088674554535, -197.83523403185112, -189.77442941982264, -100.13804482303497, -857.6154994932136, -1062.9022341960122, -207.82299630717438, -521.3413790027969, -740.8025148535002, -249.00249310947916, -617.9403212995674, -447.26626313891995, -354.11772277691983, -291.4138104820799, -807.9465930027075, -163.85211909066945, -908.450649429891, -190.22921364739588, -192.31184284157226, -66.57580327977702, -631.210906062015, -80.54844705290137, -1053.033138257933, -204.7437586733477, -751.5516221146263, -449.8195171914913, -803.7768784788889, -881.3024841299107, -760.223629300765, -190.60145479188736, -863.4092218579765, -205.5575341156998, -1071.558965371897, -669.5239653674436, -90.5501575425037, -153.04807720650354, -459.20829090259406, -1027.7363803712035, -356.2169999747437, -835.7268471733682, -810.7247578059114, -162.87467063543926, -932.8589002393353, -282.7803353278863, -742.1362502140535, -276.2710851769285, -437.9154747062936, -546.8342942786536, -657.9795233402282, -37.03854628106462, -91.36478745927488, -394.0190085450027, -37.29412601865002, -970.9547999650856, -24.06944306006276, -194.76677685723845, -456.5726029763228, -75.2175174799019, -216.24213144555742, -35.264219631859405, -218.28994175753948, -729.0394623213034, -262.49245305680756, -463.08905759054096, -738.1245937514262, -993.2752101278736, -548.682068137966, -872.7006990076366, -245.56273309531363, -651.6842123572223, -382.43247630706463, -384.98947749593805, -109.38727736816426, -934.0975461276754, -558.6305573034093, -56.449125967800335, -776.7108561642273, -866.4537868723207, -895.5793490097068, -1140.2787150859738, -553.184175805872, -111.65498765959202, -957.9169948669007, -1342.6098783686368, -881.4031435108359, -356.1832899938615, -123.30192739548639, -522.9207456039093, -144.21065869436302, -218.1771378606902, -745.187615126586, -483.05997925449907, -27.22894405720582, -772.5384050770765, -92.5085624756583, -471.20757088817805, -527.423930486258, -160.31771267234663, -1098.8295036201375, -877.4718059042821, -265.71609059036297, -750.8750743637845, -907.3197158476115, -437.57805126808233, -56.67174898482308, -346.9576113041513, -732.0103614877388, -27.644072365326103, -161.3837585694028, -487.79418944443324, -514.1949408995032, -679.2337617961591, -964.027766688683, -136.99718716015317, -406.09187814453145, -369.48999123879616, -76.70044542358316, -128.39433581348675, -456.52619543673575, -883.8509031299866, -1096.902944079503, -287.0324571382409, -948.1602555894436, -687.4307363443547, -47.51645842758788, -1034.626577654655, -1049.929151178462, -1304.2482655782328, -217.62340403071462, -11.625749229222965, -1101.1750087411272, -29.625322489151372, -241.0350692580962, -75.37741296711025, -295.7227894454602, -62.81895173313615, -970.2094881191863, -87.41265606475923, -967.1801479112281, -571.5568167107297, -142.41162878793708, -718.5460222232622, -591.8234527164593, -1128.7510611996015, -446.7967776187248, -915.9525574681788, -564.0952492090374, -375.1016570639487, -1027.1003252909425, -1197.4336883224667, -470.05042719521094, -70.92089092076816, -946.5976193970682, -154.82447487460954, -16.49465816494886, -1027.9460270518798, -206.48665972863552, -580.0998162293661, -964.551804125544, -48.233126302479796, -939.6558092604781, -443.2553328135475, -489.14612355853103, -1035.7087590066355, -983.1396966507075, -223.9616157323946, -262.64673341711966, -1004.8878425375254, -1056.7180492694881, -37.400777264161626, -31.272765276656408, -679.741251560624, -20.420329258064044, -435.5610918528602, -113.86656922262672, -1187.5388145069312, -147.97286014598757, -346.6984521254885, -63.75920832448681, -969.7955572301787, -511.654229865736, -249.56689691301693, -39.44346488307351, -332.72000321450435, -14.196987989856323, -400.65504886257145, -806.820565873527, -467.0342808145966, -127.38578989332467, -965.9317677023678, -349.3382645738598, -262.7884126819314, -747.2767238339325, -704.451925299799, -891.5262154507639, -400.35768998675553, -293.82398644348626, -789.1565970867672, -930.792733084196, -461.03668010191956, -152.69472850472405, -962.019496339461, -788.9934215620829, -91.03797447107242, -58.75729058740572, -792.8858980331329, -5.93102114516013, -435.60580054831854, -411.3914220357829, -133.8263064481779, -199.08522933979592, -1083.053895658801, -9.766215200138978, -234.64916573439163, -192.48879115868283, -408.05493485925166, -422.27178678503276, -116.59991763840122, -335.7395443090156, -181.48261997645338, -228.56779699388102, -671.9882085311573, -421.0671399706785, -150.7523356398285, -78.35478014435283, -725.3377945816, -1238.555127162113, -311.09617277532914, -271.5313405169883, -309.55234107935985, -166.64252362231625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5049724509649507, "mean_inference_ms": 1.6996297836979062, "mean_action_processing_ms": 0.8112553335106818, "mean_env_wait_ms": 10.057084612560807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013604879379272461, "StateBufferConnector_ms": 0.009682893753051758, "ViewRequirementAgentConnector_ms": 0.3254849910736084}, "num_episodes": 32, "episode_return_max": -452.6516939530289, "episode_return_min": -4240.623974791808, "episode_return_mean": -2510.292983209324, "episodes_this_iter": 32}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 889830, "num_agent_steps_trained": 889830, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.23210455415007, "num_env_steps_trained_throughput_per_sec": 76.23210455415007, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 889830, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 889830, "timers": {"training_iteration_time_ms": 53779.803, "restore_workers_time_ms": 0.03, "training_step_time_ms": 53779.726, "sample_time_ms": 3216.015, "learn_time_ms": 50503.464, "learn_throughput": 79.202, "synch_weights_time_ms": 57.166}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 889830, "num_agent_steps_trained": 889830}, "done": false, "training_iteration": 51, "trial_id": "efc54_00000", "date": "2024-07-24_19-26-17", "timestamp": 1721829377, "time_this_iter_s": 52.48333811759949, "time_total_s": 2775.545855998993, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x717514104ca0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2775.545855998993, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 10.235135135135135, "ram_util_percent": 23.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 118.39306896219574, "cur_kl_coeff": 0.3375, "cur_lr": 0.0010000000000000005, "total_loss": 4.802787452150685, "policy_loss": -0.0005811029946484461, "vf_loss": 4.821601027173282, "vf_explained_var": 0.9751588304837545, "kl": 0.017010266174702453, "entropy": 2.3973433689245573, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.10077519379846, "num_grad_updates_lifetime": 211185.5, "diff_num_grad_updates_vs_sampler_policy": 1934.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 906226, "num_agent_steps_trained": 906226}, "env_runners": {"episode_reward_max": -704.5795458929541, "episode_reward_min": -4240.623974791808, "episode_reward_mean": -2472.485335732738, "episode_len_mean": 146.86, "episode_media": {}, "episodes_timesteps_total": 14686, "policy_reward_min": {"policy_0": -1342.6098783686368}, "policy_reward_max": {"policy_0": -5.1770086714229295}, "policy_reward_mean": {"policy_0": -494.49706714654764}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3127.6962402713243, -2528.651034328659, -2778.2830828993524, -2722.314584790601, -3510.742926769904, -1680.1542963635, -2538.7035309159055, -3516.1533871888646, -2841.7506832291806, -1893.0141321858803, -3524.2347902924594, -2305.330773411758, -1911.1032001659723, -2600.0374579815566, -2470.2075443377244, -4240.623974791808, -1827.419635776331, -1615.5480216018384, -3629.7455608090604, -1466.435465006139, -3294.465441932061, -3542.3078907930308, -3499.412604090837, -2344.6162407430625, -3511.1920748918556, -3121.395159072707, -2651.3236112153654, -1844.5422136387847, -2653.76265550843, -2095.8183893647515, -2408.265441963935, -2336.9097045725175, -2064.596508491298, -1988.7784152606482, -2539.6964832902995, -3499.3136685594254, -2190.2386996040473, -3489.613276227821, -2396.921241593644, -1771.1326260655171, -1621.1041544460381, -1001.5864132911811, -3186.020776847954, -2701.0621889052054, -2043.5539842629885, -4232.206882938098, -3649.768294399827, -1753.7980846810365, -1846.5434617526162, -2929.7590432733873, -2499.4022017684515, -1923.0273227664043, -2555.840585028322, -2642.374823883293, -3004.7664851542836, -3684.601578757761, -704.5795458929541, -2738.7707375938407, -3801.8698712262244, -3633.7813470816063, -2216.783670409274, -2739.0272156465044, -3175.211527761817, -2392.9261677649524, -2437.1280564011045, -2039.8803076918775, -1036.5824018630217, -2716.5106688576752, -3006.400967253183, -2627.5047252210916, -2693.6940809931534, -1185.8397795172348, -1928.0130026112645, -1284.661665702784, -2047.500258867617, -2297.3775051561074, -2573.911889726816, -2168.1795291302756, -2859.167339250666, -1092.2336829654698, -2417.456257167315, -1438.1612949955534, -2494.138899923135, -3491.2500473199384, -1928.3348100195767, -770.7405080494301, -1145.3959831942964, -2641.5347564723993, -3135.0884140974235, -2223.9810310081925, -1856.5217890565903, -1284.0808419041416, -2343.271658135124, -1284.9426086689382, -2523.0687401839205, -3112.602703395416, -2540.556806767325, -2725.1578847134456, -2067.0342297020984, -3179.809411758333], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 122, 150, 108, 150, 150, 150, 150, 150, 99, 150, 117, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-321.506946159859, -587.7642103496478, -138.54552828156056, -929.4919740570032, -1150.3875814232538, -1054.1098504548534, -692.685297511259, -38.42684650048256, -215.94379210152488, -527.4852477605386, -593.8169435407964, -72.91773434843496, -576.0897871120053, -1039.4644108734453, -495.9942070246718, -929.7512577510548, -121.72259976504466, -266.99996445792374, -320.4895859584622, -1083.351176858117, -704.9241887732753, -764.6990781050913, -344.0595514037916, -496.5856918298271, -1200.474416657917, -272.4275063681786, -422.54725619593466, -31.00363834443673, -116.92724336480434, -837.2486520901447, -653.2284539915793, -235.37839218403448, -542.7455188279898, -481.11559772535514, -626.2355681869458, -849.3136230194212, -821.9157692944065, -908.0082797586913, -618.6642861561286, -318.25142896021714, -408.9981951026392, -936.3451023754875, -1013.9560341450243, -320.9114793104162, -161.53987229561105, -408.40064880246257, -803.6205134206756, -199.0953486358757, -263.6020236359819, -218.29559769088402, -437.14484433690563, -1327.4995329666253, -741.012786938257, -159.31111439628194, -859.2665116543935, -58.459431267697035, -605.1208342144887, -694.1785321129018, -746.1172884364402, -201.45468738023177, -592.7970274204906, -132.17872973683941, -139.84797091762286, -741.5891017344812, -304.69037035653747, -226.66921159941228, -386.7824248772154, -747.2828543449133, -458.54105641275737, -780.7619107472543, -502.30901778170505, -438.26410887890165, -299.1054690988479, -350.5066070760318, -880.0223415022393, -1101.651999876151, -959.4278748071232, -344.7180138460219, -767.3489564111, -1067.4771298514154, -194.44651716035952, -356.36729915882034, -213.9540123969708, -1057.474798388759, -5.1770086714229295, -204.0597053388899, -815.1921804819141, -44.666116298876226, -502.89140748705034, -48.738611995109274, -589.1041884347804, -924.3939830789722, -349.8273397083765, -867.7206537520186, -898.6993958349104, -439.0382292495879, -164.17655335080318, -676.1045972193858, -115.00104202389109, -72.1150431624717, -1035.2998193379335, -861.6367202801734, -143.23299057447815, -868.9970117122084, -385.2989000272647, -933.834518743265, -726.1770183999843, -398.38070282607947, -772.5202763680163, -711.3953744556875, -891.1861225690262, -424.54633636385796, -589.4735304779143, -766.2293900837128, -827.9772245963266, -217.71862046250803, -1167.4376107206572, -151.70155570948353, -96.60915599841591, -711.1492978519973, -1044.1894766624732, -669.8180314346499, -871.1105272115004, -389.0969231632774, -536.9771164199547, -970.5730124890246, -12.401214626007462, -28.367297235196496, -1129.0713527172327, -980.9822820052436, -968.801976634821, -80.33962618476629, -512.9589893405314, -41.64848905574352, -1047.5745299995035, -617.4013899300203, -66.16638445047319, -575.230528286805, -41.965348346670645, -543.7785626248174, -77.39798252358474, -367.9334311671549, -120.78926195907799, -843.3467048899863, -1244.2952749686247, -232.40983553822457, -858.336705578127, -108.19684406351718, -310.6661367294302, -586.2088674554535, -197.83523403185112, -189.77442941982264, -100.13804482303497, -857.6154994932136, -1062.9022341960122, -207.82299630717438, -521.3413790027969, -740.8025148535002, -249.00249310947916, -617.9403212995674, -447.26626313891995, -354.11772277691983, -291.4138104820799, -807.9465930027075, -163.85211909066945, -908.450649429891, -190.22921364739588, -192.31184284157226, -66.57580327977702, -631.210906062015, -80.54844705290137, -1053.033138257933, -204.7437586733477, -751.5516221146263, -449.8195171914913, -803.7768784788889, -881.3024841299107, -760.223629300765, -190.60145479188736, -863.4092218579765, -205.5575341156998, -1071.558965371897, -669.5239653674436, -90.5501575425037, -153.04807720650354, -459.20829090259406, -1027.7363803712035, -356.2169999747437, -835.7268471733682, -810.7247578059114, -162.87467063543926, -932.8589002393353, -282.7803353278863, -742.1362502140535, -276.2710851769285, -437.9154747062936, -546.8342942786536, -657.9795233402282, -37.03854628106462, -91.36478745927488, -394.0190085450027, -37.29412601865002, -970.9547999650856, -24.06944306006276, -194.76677685723845, -456.5726029763228, -75.2175174799019, -216.24213144555742, -35.264219631859405, -218.28994175753948, -729.0394623213034, -262.49245305680756, -463.08905759054096, -738.1245937514262, -993.2752101278736, -548.682068137966, -872.7006990076366, -245.56273309531363, -651.6842123572223, -382.43247630706463, -384.98947749593805, -109.38727736816426, -934.0975461276754, -558.6305573034093, -56.449125967800335, -776.7108561642273, -866.4537868723207, -895.5793490097068, -1140.2787150859738, -553.184175805872, -111.65498765959202, -957.9169948669007, -1342.6098783686368, -881.4031435108359, -356.1832899938615, -123.30192739548639, -522.9207456039093, -144.21065869436302, -218.1771378606902, -745.187615126586, -483.05997925449907, -27.22894405720582, -772.5384050770765, -92.5085624756583, -471.20757088817805, -527.423930486258, -160.31771267234663, -1098.8295036201375, -877.4718059042821, -265.71609059036297, -750.8750743637845, -907.3197158476115, -437.57805126808233, -56.67174898482308, -346.9576113041513, -732.0103614877388, -27.644072365326103, -161.3837585694028, -487.79418944443324, -514.1949408995032, -679.2337617961591, -964.027766688683, -136.99718716015317, -406.09187814453145, -369.48999123879616, -76.70044542358316, -128.39433581348675, -456.52619543673575, -883.8509031299866, -1096.902944079503, -287.0324571382409, -948.1602555894436, -687.4307363443547, -47.51645842758788, -1034.626577654655, -1049.929151178462, -1304.2482655782328, -217.62340403071462, -11.625749229222965, -1101.1750087411272, -29.625322489151372, -241.0350692580962, -75.37741296711025, -295.7227894454602, -62.81895173313615, -970.2094881191863, -87.41265606475923, -967.1801479112281, -571.5568167107297, -142.41162878793708, -718.5460222232622, -591.8234527164593, -1128.7510611996015, -446.7967776187248, -915.9525574681788, -564.0952492090374, -375.1016570639487, -1027.1003252909425, -1197.4336883224667, -470.05042719521094, -70.92089092076816, -946.5976193970682, -154.82447487460954, -16.49465816494886, -1027.9460270518798, -206.48665972863552, -580.0998162293661, -964.551804125544, -48.233126302479796, -939.6558092604781, -443.2553328135475, -489.14612355853103, -1035.7087590066355, -983.1396966507075, -223.9616157323946, -262.64673341711966, -1004.8878425375254, -1056.7180492694881, -37.400777264161626, -31.272765276656408, -679.741251560624, -20.420329258064044, -435.5610918528602, -113.86656922262672, -1187.5388145069312, -147.97286014598757, -346.6984521254885, -63.75920832448681, -969.7955572301787, -511.654229865736, -249.56689691301693, -39.44346488307351, -332.72000321450435, -14.196987989856323, -400.65504886257145, -806.820565873527, -467.0342808145966, -127.38578989332467, -965.9317677023678, -349.3382645738598, -262.7884126819314, -747.2767238339325, -704.451925299799, -891.5262154507639, -400.35768998675553, -293.82398644348626, -789.1565970867672, -930.792733084196, -461.03668010191956, -152.69472850472405, -962.019496339461, -788.9934215620829, -91.03797447107242, -58.75729058740572, -792.8858980331329, -5.93102114516013, -435.60580054831854, -411.3914220357829, -133.8263064481779, -199.08522933979592, -1083.053895658801, -9.766215200138978, -234.64916573439163, -192.48879115868283, -408.05493485925166, -422.27178678503276, -116.59991763840122, -335.7395443090156, -181.48261997645338, -228.56779699388102, -671.9882085311573, -421.0671399706785, -150.7523356398285, -78.35478014435283, -725.3377945816, -1238.555127162113, -311.09617277532914, -271.5313405169883, -309.55234107935985, -166.64252362231625, -593.3974035486258, -63.207643828433255, -246.42230965653044, -857.0570901194584, -813.8274425737708, -246.26163457907296, -551.5028637621458, -327.60282915937273, -987.8961503806361, -54.91605124904613, -556.2527576600759, -559.3707597530715, -121.83908560109359, -615.3663890760959, -1006.3383471603312, -211.24906788920796, -62.76220288536454, -304.46874248005986, -447.9976325339743, -65.75603717686353, -332.01907319554846, -321.20635894411186, -1023.1114440514376, -496.78601489780345, -244.33336607841355, -61.43528811621252, -368.5457554906716, -437.8178418031972, -147.24537833213023, -423.11703125334236, -712.2488105126885, -543.554855705483, -178.33894963754807, -601.9843776147618, -458.01190645265433, -56.921893867032026, -1001.3412029874913, -326.2510289579482, -1045.8435677910106, -1060.8923537164571, -955.8016524793547, -528.4970527849108, -201.3544684507435, -139.52223742597857, -103.15939887859037, -188.9325242065696, -251.90273460499174, -73.0962037530514, -249.46439719562431, -7.3446482891927705, -6.203006909970315, -26.607562441049897, -157.38751016491182, -882.4572739593007, -72.74062971906318, -603.9440047053884, -610.423599857953, -395.09838635551006, -36.48646852047123, -995.582297033078, -429.0544221784604, -206.2585095229251, -952.5659051227711, -937.3820062698616, -609.827571003406, -477.6285610362278, -282.6247817339835, -59.90346728951257, -1155.9727047781355, -247.85151617033526, -290.3258642340195, -171.01675944468664, -153.3924082950916, -789.6230665610341, -452.16369052175935, -112.93645638489262, -999.7280378500873, -40.302293656831374, -44.00938000063233, -87.10467401169821, -32.227578146936615, -910.9878646655029, -435.8790228638375, -839.1696928032817, -125.00749965556545, -591.6906308653299, -145.83913881444536, -203.4642196355129, -113.1973654977348, -230.75125385591528, -292.09439275584856, -94.51816892388297, -814.9561296194751, -944.4085159567874, -377.09153292792746, -945.4622128695149, -741.5228041464608, -150.42736696862372, -379.57185168551064, -895.6184677253065, -187.7500920478509, -884.8678286809189, -388.7483267552432, -79.90172944764018, -999.288829835672, -865.65995326232, -95.00085608057213, -847.3154865097637, -716.3208007356174, -200.86078812517232, -54.86362013129888, -651.8287462473867, -970.7356848307369, -59.95819240766986, -329.6479860850067, -495.9222948077283, -150.98407630453497, -490.30314078764064, -1278.5061152761293, -764.0937845822987]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.501517073899248, "mean_inference_ms": 1.6973660170635878, "mean_action_processing_ms": 0.8100098143238047, "mean_env_wait_ms": 10.034208443518462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013541460037231445, "StateBufferConnector_ms": 0.009532928466796875, "ViewRequirementAgentConnector_ms": 0.3189728260040283}, "num_episodes": 24, "episode_return_max": -704.5795458929541, "episode_return_min": -4240.623974791808, "episode_return_mean": -2472.485335732738, "episodes_this_iter": 24}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 906226, "num_agent_steps_trained": 906226, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.58777547306677, "num_env_steps_trained_throughput_per_sec": 74.58777547306677, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 906226, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 906226, "timers": {"training_iteration_time_ms": 53387.167, "restore_workers_time_ms": 0.03, "training_step_time_ms": 53387.091, "sample_time_ms": 3206.703, "learn_time_ms": 50120.299, "learn_throughput": 79.808, "synch_weights_time_ms": 57.054}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 906226, "num_agent_steps_trained": 906226}, "done": false, "training_iteration": 52, "trial_id": "efc54_00000", "date": "2024-07-24_19-27-11", "timestamp": 1721829431, "time_this_iter_s": 53.639256715774536, "time_total_s": 2829.1851127147675, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x717514105d80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2829.1851127147675, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 9.852631578947367, "ram_util_percent": 23.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 111.003253883706, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.7542051885361065, "policy_loss": -0.0005439139745037134, "vf_loss": 4.773974794492984, "vf_explained_var": 0.9743076603962365, "kl": 0.016532587338799733, "entropy": 2.4805441479933887, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.93233082706767, "num_grad_updates_lifetime": 215115.5, "diff_num_grad_updates_vs_sampler_policy": 1994.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 923241, "num_agent_steps_trained": 923241}, "env_runners": {"episode_reward_max": -704.5795458929541, "episode_reward_min": -4590.196094566742, "episode_reward_mean": -2420.266162586771, "episode_len_mean": 146.47, "episode_media": {}, "episodes_timesteps_total": 14647, "policy_reward_min": {"policy_0": -1454.1678089968773}, "policy_reward_max": {"policy_0": 3.8273552125683397}, "policy_reward_mean": {"policy_0": -484.0532325173543}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2653.76265550843, -2095.8183893647515, -2408.265441963935, -2336.9097045725175, -2064.596508491298, -1988.7784152606482, -2539.6964832902995, -3499.3136685594254, -2190.2386996040473, -3489.613276227821, -2396.921241593644, -1771.1326260655171, -1621.1041544460381, -1001.5864132911811, -3186.020776847954, -2701.0621889052054, -2043.5539842629885, -4232.206882938098, -3649.768294399827, -1753.7980846810365, -1846.5434617526162, -2929.7590432733873, -2499.4022017684515, -1923.0273227664043, -2555.840585028322, -2642.374823883293, -3004.7664851542836, -3684.601578757761, -704.5795458929541, -2738.7707375938407, -3801.8698712262244, -3633.7813470816063, -2216.783670409274, -2739.0272156465044, -3175.211527761817, -2392.9261677649524, -2437.1280564011045, -2039.8803076918775, -1036.5824018630217, -2716.5106688576752, -3006.400967253183, -2627.5047252210916, -2693.6940809931534, -1185.8397795172348, -1928.0130026112645, -1284.661665702784, -2047.500258867617, -2297.3775051561074, -2573.911889726816, -2168.1795291302756, -2859.167339250666, -1092.2336829654698, -2417.456257167315, -1438.1612949955534, -2494.138899923135, -3491.2500473199384, -1928.3348100195767, -770.7405080494301, -1145.3959831942964, -2641.5347564723993, -3135.0884140974235, -2223.9810310081925, -1856.5217890565903, -1284.0808419041416, -2343.271658135124, -1284.9426086689382, -2523.0687401839205, -3112.602703395416, -2540.556806767325, -2725.1578847134456, -2067.0342297020984, -3179.809411758333, -2462.739300102844, -1865.9232805041881, -1452.9612151024332, -3111.972357174149, -4590.196094566742, -3286.650017493124, -2901.210031623922, -2252.1050124042504, -2938.1854930260765, -2030.869895960236, -2199.7901825137906, -3272.917050909719, -2318.5199939850067, -1557.5917197719136, -2214.4583859586096, -2802.5511127032555, -2915.2425220295427, -3188.438892233093, -2716.4813806841503, -2086.0414474169143, -2788.3699618456058, -1067.4264561842215, -1804.5812515779137, -3715.284387144437, -1752.161607657369, -4089.6784918656617, -1580.9061649691855, -2352.2345374904594], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 122, 150, 108, 150, 150, 150, 150, 150, 99, 150, 117, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-77.39798252358474, -367.9334311671549, -120.78926195907799, -843.3467048899863, -1244.2952749686247, -232.40983553822457, -858.336705578127, -108.19684406351718, -310.6661367294302, -586.2088674554535, -197.83523403185112, -189.77442941982264, -100.13804482303497, -857.6154994932136, -1062.9022341960122, -207.82299630717438, -521.3413790027969, -740.8025148535002, -249.00249310947916, -617.9403212995674, -447.26626313891995, -354.11772277691983, -291.4138104820799, -807.9465930027075, -163.85211909066945, -908.450649429891, -190.22921364739588, -192.31184284157226, -66.57580327977702, -631.210906062015, -80.54844705290137, -1053.033138257933, -204.7437586733477, -751.5516221146263, -449.8195171914913, -803.7768784788889, -881.3024841299107, -760.223629300765, -190.60145479188736, -863.4092218579765, -205.5575341156998, -1071.558965371897, -669.5239653674436, -90.5501575425037, -153.04807720650354, -459.20829090259406, -1027.7363803712035, -356.2169999747437, -835.7268471733682, -810.7247578059114, -162.87467063543926, -932.8589002393353, -282.7803353278863, -742.1362502140535, -276.2710851769285, -437.9154747062936, -546.8342942786536, -657.9795233402282, -37.03854628106462, -91.36478745927488, -394.0190085450027, -37.29412601865002, -970.9547999650856, -24.06944306006276, -194.76677685723845, -456.5726029763228, -75.2175174799019, -216.24213144555742, -35.264219631859405, -218.28994175753948, -729.0394623213034, -262.49245305680756, -463.08905759054096, -738.1245937514262, -993.2752101278736, -548.682068137966, -872.7006990076366, -245.56273309531363, -651.6842123572223, -382.43247630706463, -384.98947749593805, -109.38727736816426, -934.0975461276754, -558.6305573034093, -56.449125967800335, -776.7108561642273, -866.4537868723207, -895.5793490097068, -1140.2787150859738, -553.184175805872, -111.65498765959202, -957.9169948669007, -1342.6098783686368, -881.4031435108359, -356.1832899938615, -123.30192739548639, -522.9207456039093, -144.21065869436302, -218.1771378606902, -745.187615126586, -483.05997925449907, -27.22894405720582, -772.5384050770765, -92.5085624756583, -471.20757088817805, -527.423930486258, -160.31771267234663, -1098.8295036201375, -877.4718059042821, -265.71609059036297, -750.8750743637845, -907.3197158476115, -437.57805126808233, -56.67174898482308, -346.9576113041513, -732.0103614877388, -27.644072365326103, -161.3837585694028, -487.79418944443324, -514.1949408995032, -679.2337617961591, -964.027766688683, -136.99718716015317, -406.09187814453145, -369.48999123879616, -76.70044542358316, -128.39433581348675, -456.52619543673575, -883.8509031299866, -1096.902944079503, -287.0324571382409, -948.1602555894436, -687.4307363443547, -47.51645842758788, -1034.626577654655, -1049.929151178462, -1304.2482655782328, -217.62340403071462, -11.625749229222965, -1101.1750087411272, -29.625322489151372, -241.0350692580962, -75.37741296711025, -295.7227894454602, -62.81895173313615, -970.2094881191863, -87.41265606475923, -967.1801479112281, -571.5568167107297, -142.41162878793708, -718.5460222232622, -591.8234527164593, -1128.7510611996015, -446.7967776187248, -915.9525574681788, -564.0952492090374, -375.1016570639487, -1027.1003252909425, -1197.4336883224667, -470.05042719521094, -70.92089092076816, -946.5976193970682, -154.82447487460954, -16.49465816494886, -1027.9460270518798, -206.48665972863552, -580.0998162293661, -964.551804125544, -48.233126302479796, -939.6558092604781, -443.2553328135475, -489.14612355853103, -1035.7087590066355, -983.1396966507075, -223.9616157323946, -262.64673341711966, -1004.8878425375254, -1056.7180492694881, -37.400777264161626, -31.272765276656408, -679.741251560624, -20.420329258064044, -435.5610918528602, -113.86656922262672, -1187.5388145069312, -147.97286014598757, -346.6984521254885, -63.75920832448681, -969.7955572301787, -511.654229865736, -249.56689691301693, -39.44346488307351, -332.72000321450435, -14.196987989856323, -400.65504886257145, -806.820565873527, -467.0342808145966, -127.38578989332467, -965.9317677023678, -349.3382645738598, -262.7884126819314, -747.2767238339325, -704.451925299799, -891.5262154507639, -400.35768998675553, -293.82398644348626, -789.1565970867672, -930.792733084196, -461.03668010191956, -152.69472850472405, -962.019496339461, -788.9934215620829, -91.03797447107242, -58.75729058740572, -792.8858980331329, -5.93102114516013, -435.60580054831854, -411.3914220357829, -133.8263064481779, -199.08522933979592, -1083.053895658801, -9.766215200138978, -234.64916573439163, -192.48879115868283, -408.05493485925166, -422.27178678503276, -116.59991763840122, -335.7395443090156, -181.48261997645338, -228.56779699388102, -671.9882085311573, -421.0671399706785, -150.7523356398285, -78.35478014435283, -725.3377945816, -1238.555127162113, -311.09617277532914, -271.5313405169883, -309.55234107935985, -166.64252362231625, -593.3974035486258, -63.207643828433255, -246.42230965653044, -857.0570901194584, -813.8274425737708, -246.26163457907296, -551.5028637621458, -327.60282915937273, -987.8961503806361, -54.91605124904613, -556.2527576600759, -559.3707597530715, -121.83908560109359, -615.3663890760959, -1006.3383471603312, -211.24906788920796, -62.76220288536454, -304.46874248005986, -447.9976325339743, -65.75603717686353, -332.01907319554846, -321.20635894411186, -1023.1114440514376, -496.78601489780345, -244.33336607841355, -61.43528811621252, -368.5457554906716, -437.8178418031972, -147.24537833213023, -423.11703125334236, -712.2488105126885, -543.554855705483, -178.33894963754807, -601.9843776147618, -458.01190645265433, -56.921893867032026, -1001.3412029874913, -326.2510289579482, -1045.8435677910106, -1060.8923537164571, -955.8016524793547, -528.4970527849108, -201.3544684507435, -139.52223742597857, -103.15939887859037, -188.9325242065696, -251.90273460499174, -73.0962037530514, -249.46439719562431, -7.3446482891927705, -6.203006909970315, -26.607562441049897, -157.38751016491182, -882.4572739593007, -72.74062971906318, -603.9440047053884, -610.423599857953, -395.09838635551006, -36.48646852047123, -995.582297033078, -429.0544221784604, -206.2585095229251, -952.5659051227711, -937.3820062698616, -609.827571003406, -477.6285610362278, -282.6247817339835, -59.90346728951257, -1155.9727047781355, -247.85151617033526, -290.3258642340195, -171.01675944468664, -153.3924082950916, -789.6230665610341, -452.16369052175935, -112.93645638489262, -999.7280378500873, -40.302293656831374, -44.00938000063233, -87.10467401169821, -32.227578146936615, -910.9878646655029, -435.8790228638375, -839.1696928032817, -125.00749965556545, -591.6906308653299, -145.83913881444536, -203.4642196355129, -113.1973654977348, -230.75125385591528, -292.09439275584856, -94.51816892388297, -814.9561296194751, -944.4085159567874, -377.09153292792746, -945.4622128695149, -741.5228041464608, -150.42736696862372, -379.57185168551064, -895.6184677253065, -187.7500920478509, -884.8678286809189, -388.7483267552432, -79.90172944764018, -999.288829835672, -865.65995326232, -95.00085608057213, -847.3154865097637, -716.3208007356174, -200.86078812517232, -54.86362013129888, -651.8287462473867, -970.7356848307369, -59.95819240766986, -329.6479860850067, -495.9222948077283, -150.98407630453497, -490.30314078764064, -1278.5061152761293, -764.0937845822987, -687.8079656560558, -656.9382075912858, -744.9617085454638, -228.5913018319513, -144.44011647808856, -21.30701126939511, -78.82795494743218, -521.7742051568493, -1114.3067507172282, -129.70735841328423, -457.406521266777, -346.704221359344, 3.8273552125683397, -43.74270392503628, -608.9351237638433, -383.6355708415459, -755.3160569079143, -926.3104238324169, -198.37271943565872, -848.3375861566116, -780.9909527952592, -839.3757971701538, -1239.5443927151073, -782.8835973629627, -947.4013545232584, -270.20907035376575, -117.32051438254074, -1216.2047382474786, -664.7568722716417, -1018.1588222376984, -1213.658688359181, -97.54383317680356, -556.0400609873999, -531.8886975890009, -502.07875151153485, -935.5496029524912, -17.676678812963406, -1048.9124939051371, -193.66681447712395, -56.299422256534925, -771.6833184480431, -1138.1719076349518, -195.55304054119617, -109.36342684390875, -723.4137995579744, -33.10070486677889, -290.4893977580899, -711.1868498826847, -103.80906189191565, -892.2838815607695, -461.68264403941015, -679.930595663974, -377.61004730715575, -427.8751797988928, -252.6917157043618, -981.935426173176, -636.4831257805959, -797.3041335833203, -495.1810433961063, -362.0133219765211, -72.9479617106113, -576.3345824539815, -731.5670542275154, -422.3188926456966, -515.351502947201, -342.91675364738194, -717.5025904638428, -200.79110688113704, -47.58680815241048, -248.7944606271424, -1365.3529396294339, -233.47276385272838, -333.8216216996642, -52.00962321387762, -229.80143756290423, -127.19688039437865, -79.1055531045996, -440.597981082842, -745.9404581582497, -1409.7102399631854, -921.5482618552891, -716.9290554398664, -76.78152533939569, -372.20235841371147, -827.7813209812813, -598.9420053829259, -1454.1678089968773, -154.79072075492923, -28.317994739175095, -952.2203623591862, -917.1478685293253, -609.8602372977275, -412.90342024833444, -516.965697831971, -259.6041567767922, -518.964193226216, -800.0466650254165, -360.27994871096007, -137.10032313971857, -269.65031731460255, -122.22307440139502, -758.5309093343409, -831.5824752338109, -916.9677879202345, -159.06571495582403, -197.66782924411035, -191.7958054913613, -524.8382550960207, -70.42583242378723, -82.69873392894131, -21.6442478742486, -933.4796381693284, -100.15890115963448, -399.6226906470277, -349.6757737276737, -273.58173959574106, -558.4725430025048, -916.6484078822024, -1129.2204050722787, -837.3612915917076, -106.79654175402278, -919.8129529400527, -271.24851442429156, -199.18368887773573, -255.11990966126388, -1332.6373961374802, -1250.8844850366665, -75.08678919396885, -220.85662283841452, -1210.213198659129, -12.568975297535044, -474.8928780829401, -90.44967260107066, -517.9874762440562, -485.0071627435846, -558.1986631088979, -416.5340253484857, -106.65846352239215, -1226.7032887500209, -44.14009676066204]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5027648056944238, "mean_inference_ms": 1.6978037127729915, "mean_action_processing_ms": 0.8079696910089287, "mean_env_wait_ms": 10.032462127890758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013107776641845703, "StateBufferConnector_ms": 0.00923013687133789, "ViewRequirementAgentConnector_ms": 0.3043181896209717}, "num_episodes": 28, "episode_return_max": -704.5795458929541, "episode_return_min": -4590.196094566742, "episode_return_mean": -2420.266162586771, "episodes_this_iter": 28}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 923241, "num_agent_steps_trained": 923241, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.93085447200725, "num_env_steps_trained_throughput_per_sec": 72.93085447200725, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 923241, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 923241, "timers": {"training_iteration_time_ms": 53362.021, "restore_workers_time_ms": 0.029, "training_step_time_ms": 53361.946, "sample_time_ms": 3198.591, "learn_time_ms": 50103.375, "learn_throughput": 79.835, "synch_weights_time_ms": 56.932}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 923241, "num_agent_steps_trained": 923241}, "done": false, "training_iteration": 53, "trial_id": "efc54_00000", "date": "2024-07-24_19-28-06", "timestamp": 1721829486, "time_this_iter_s": 54.85799288749695, "time_total_s": 2884.0431056022644, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7ebbe0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2884.0431056022644, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 9.633333333333335, "ram_util_percent": 23.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 117.26448211997163, "cur_kl_coeff": 0.33750000000000013, "cur_lr": 0.0010000000000000005, "total_loss": 4.778357679469913, "policy_loss": -0.001174757450901191, "vf_loss": 4.799283881573116, "vf_explained_var": 0.9801491698651922, "kl": 0.015571597516713618, "entropy": 2.5006857263106927, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.69852941176471, "num_grad_updates_lifetime": 219150.5, "diff_num_grad_updates_vs_sampler_policy": 2039.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 940608, "num_agent_steps_trained": 940608}, "env_runners": {"episode_reward_max": -770.7405080494301, "episode_reward_min": -4590.196094566742, "episode_reward_mean": -2417.415176945362, "episode_len_mean": 146.79, "episode_media": {}, "episodes_timesteps_total": 14679, "policy_reward_min": {"policy_0": -1454.1678089968773}, "policy_reward_max": {"policy_0": 3.8273552125683397}, "policy_reward_mean": {"policy_0": -483.4830353890725}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2738.7707375938407, -3801.8698712262244, -3633.7813470816063, -2216.783670409274, -2739.0272156465044, -3175.211527761817, -2392.9261677649524, -2437.1280564011045, -2039.8803076918775, -1036.5824018630217, -2716.5106688576752, -3006.400967253183, -2627.5047252210916, -2693.6940809931534, -1185.8397795172348, -1928.0130026112645, -1284.661665702784, -2047.500258867617, -2297.3775051561074, -2573.911889726816, -2168.1795291302756, -2859.167339250666, -1092.2336829654698, -2417.456257167315, -1438.1612949955534, -2494.138899923135, -3491.2500473199384, -1928.3348100195767, -770.7405080494301, -1145.3959831942964, -2641.5347564723993, -3135.0884140974235, -2223.9810310081925, -1856.5217890565903, -1284.0808419041416, -2343.271658135124, -1284.9426086689382, -2523.0687401839205, -3112.602703395416, -2540.556806767325, -2725.1578847134456, -2067.0342297020984, -3179.809411758333, -2462.739300102844, -1865.9232805041881, -1452.9612151024332, -3111.972357174149, -4590.196094566742, -3286.650017493124, -2901.210031623922, -2252.1050124042504, -2938.1854930260765, -2030.869895960236, -2199.7901825137906, -3272.917050909719, -2318.5199939850067, -1557.5917197719136, -2214.4583859586096, -2802.5511127032555, -2915.2425220295427, -3188.438892233093, -2716.4813806841503, -2086.0414474169143, -2788.3699618456058, -1067.4264561842215, -1804.5812515779137, -3715.284387144437, -1752.161607657369, -4089.6784918656617, -1580.9061649691855, -2352.2345374904594, -1922.8341638531945, -1614.22415743088, -1492.182983647707, -2401.7002287078335, -3396.6361428749824, -2694.160558956923, -2653.5314832191116, -2779.2330604086496, -3695.5974374232055, -1870.8934891290985, -3232.9285668298753, -2346.4664119044387, -2952.9855314512297, -1589.6929947222, -3592.2755096132387, -4330.659303893847, -2552.892618492015, -3052.469384841677, -4053.3456771680812, -1449.522292616661, -1919.6803726091575, -2684.1451486883616, -1718.102385182854, -2020.5876046016706, -2100.1504419793637, -2386.849093881948, -1350.1150219787667, -1657.4915261803037, -1618.5907821239814], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 122, 150, 108, 150, 150, 150, 150, 150, 99, 150, 117, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 143, 150, 150, 150, 129, 140, 150], "policy_policy_0_reward": [-970.2094881191863, -87.41265606475923, -967.1801479112281, -571.5568167107297, -142.41162878793708, -718.5460222232622, -591.8234527164593, -1128.7510611996015, -446.7967776187248, -915.9525574681788, -564.0952492090374, -375.1016570639487, -1027.1003252909425, -1197.4336883224667, -470.05042719521094, -70.92089092076816, -946.5976193970682, -154.82447487460954, -16.49465816494886, -1027.9460270518798, -206.48665972863552, -580.0998162293661, -964.551804125544, -48.233126302479796, -939.6558092604781, -443.2553328135475, -489.14612355853103, -1035.7087590066355, -983.1396966507075, -223.9616157323946, -262.64673341711966, -1004.8878425375254, -1056.7180492694881, -37.400777264161626, -31.272765276656408, -679.741251560624, -20.420329258064044, -435.5610918528602, -113.86656922262672, -1187.5388145069312, -147.97286014598757, -346.6984521254885, -63.75920832448681, -969.7955572301787, -511.654229865736, -249.56689691301693, -39.44346488307351, -332.72000321450435, -14.196987989856323, -400.65504886257145, -806.820565873527, -467.0342808145966, -127.38578989332467, -965.9317677023678, -349.3382645738598, -262.7884126819314, -747.2767238339325, -704.451925299799, -891.5262154507639, -400.35768998675553, -293.82398644348626, -789.1565970867672, -930.792733084196, -461.03668010191956, -152.69472850472405, -962.019496339461, -788.9934215620829, -91.03797447107242, -58.75729058740572, -792.8858980331329, -5.93102114516013, -435.60580054831854, -411.3914220357829, -133.8263064481779, -199.08522933979592, -1083.053895658801, -9.766215200138978, -234.64916573439163, -192.48879115868283, -408.05493485925166, -422.27178678503276, -116.59991763840122, -335.7395443090156, -181.48261997645338, -228.56779699388102, -671.9882085311573, -421.0671399706785, -150.7523356398285, -78.35478014435283, -725.3377945816, -1238.555127162113, -311.09617277532914, -271.5313405169883, -309.55234107935985, -166.64252362231625, -593.3974035486258, -63.207643828433255, -246.42230965653044, -857.0570901194584, -813.8274425737708, -246.26163457907296, -551.5028637621458, -327.60282915937273, -987.8961503806361, -54.91605124904613, -556.2527576600759, -559.3707597530715, -121.83908560109359, -615.3663890760959, -1006.3383471603312, -211.24906788920796, -62.76220288536454, -304.46874248005986, -447.9976325339743, -65.75603717686353, -332.01907319554846, -321.20635894411186, -1023.1114440514376, -496.78601489780345, -244.33336607841355, -61.43528811621252, -368.5457554906716, -437.8178418031972, -147.24537833213023, -423.11703125334236, -712.2488105126885, -543.554855705483, -178.33894963754807, -601.9843776147618, -458.01190645265433, -56.921893867032026, -1001.3412029874913, -326.2510289579482, -1045.8435677910106, -1060.8923537164571, -955.8016524793547, -528.4970527849108, -201.3544684507435, -139.52223742597857, -103.15939887859037, -188.9325242065696, -251.90273460499174, -73.0962037530514, -249.46439719562431, -7.3446482891927705, -6.203006909970315, -26.607562441049897, -157.38751016491182, -882.4572739593007, -72.74062971906318, -603.9440047053884, -610.423599857953, -395.09838635551006, -36.48646852047123, -995.582297033078, -429.0544221784604, -206.2585095229251, -952.5659051227711, -937.3820062698616, -609.827571003406, -477.6285610362278, -282.6247817339835, -59.90346728951257, -1155.9727047781355, -247.85151617033526, -290.3258642340195, -171.01675944468664, -153.3924082950916, -789.6230665610341, -452.16369052175935, -112.93645638489262, -999.7280378500873, -40.302293656831374, -44.00938000063233, -87.10467401169821, -32.227578146936615, -910.9878646655029, -435.8790228638375, -839.1696928032817, -125.00749965556545, -591.6906308653299, -145.83913881444536, -203.4642196355129, -113.1973654977348, -230.75125385591528, -292.09439275584856, -94.51816892388297, -814.9561296194751, -944.4085159567874, -377.09153292792746, -945.4622128695149, -741.5228041464608, -150.42736696862372, -379.57185168551064, -895.6184677253065, -187.7500920478509, -884.8678286809189, -388.7483267552432, -79.90172944764018, -999.288829835672, -865.65995326232, -95.00085608057213, -847.3154865097637, -716.3208007356174, -200.86078812517232, -54.86362013129888, -651.8287462473867, -970.7356848307369, -59.95819240766986, -329.6479860850067, -495.9222948077283, -150.98407630453497, -490.30314078764064, -1278.5061152761293, -764.0937845822987, -687.8079656560558, -656.9382075912858, -744.9617085454638, -228.5913018319513, -144.44011647808856, -21.30701126939511, -78.82795494743218, -521.7742051568493, -1114.3067507172282, -129.70735841328423, -457.406521266777, -346.704221359344, 3.8273552125683397, -43.74270392503628, -608.9351237638433, -383.6355708415459, -755.3160569079143, -926.3104238324169, -198.37271943565872, -848.3375861566116, -780.9909527952592, -839.3757971701538, -1239.5443927151073, -782.8835973629627, -947.4013545232584, -270.20907035376575, -117.32051438254074, -1216.2047382474786, -664.7568722716417, -1018.1588222376984, -1213.658688359181, -97.54383317680356, -556.0400609873999, -531.8886975890009, -502.07875151153485, -935.5496029524912, -17.676678812963406, -1048.9124939051371, -193.66681447712395, -56.299422256534925, -771.6833184480431, -1138.1719076349518, -195.55304054119617, -109.36342684390875, -723.4137995579744, -33.10070486677889, -290.4893977580899, -711.1868498826847, -103.80906189191565, -892.2838815607695, -461.68264403941015, -679.930595663974, -377.61004730715575, -427.8751797988928, -252.6917157043618, -981.935426173176, -636.4831257805959, -797.3041335833203, -495.1810433961063, -362.0133219765211, -72.9479617106113, -576.3345824539815, -731.5670542275154, -422.3188926456966, -515.351502947201, -342.91675364738194, -717.5025904638428, -200.79110688113704, -47.58680815241048, -248.7944606271424, -1365.3529396294339, -233.47276385272838, -333.8216216996642, -52.00962321387762, -229.80143756290423, -127.19688039437865, -79.1055531045996, -440.597981082842, -745.9404581582497, -1409.7102399631854, -921.5482618552891, -716.9290554398664, -76.78152533939569, -372.20235841371147, -827.7813209812813, -598.9420053829259, -1454.1678089968773, -154.79072075492923, -28.317994739175095, -952.2203623591862, -917.1478685293253, -609.8602372977275, -412.90342024833444, -516.965697831971, -259.6041567767922, -518.964193226216, -800.0466650254165, -360.27994871096007, -137.10032313971857, -269.65031731460255, -122.22307440139502, -758.5309093343409, -831.5824752338109, -916.9677879202345, -159.06571495582403, -197.66782924411035, -191.7958054913613, -524.8382550960207, -70.42583242378723, -82.69873392894131, -21.6442478742486, -933.4796381693284, -100.15890115963448, -399.6226906470277, -349.6757737276737, -273.58173959574106, -558.4725430025048, -916.6484078822024, -1129.2204050722787, -837.3612915917076, -106.79654175402278, -919.8129529400527, -271.24851442429156, -199.18368887773573, -255.11990966126388, -1332.6373961374802, -1250.8844850366665, -75.08678919396885, -220.85662283841452, -1210.213198659129, -12.568975297535044, -474.8928780829401, -90.44967260107066, -517.9874762440562, -485.0071627435846, -558.1986631088979, -416.5340253484857, -106.65846352239215, -1226.7032887500209, -44.14009676066204, -314.2648860182021, -60.57680672806226, -540.1486418025587, -415.1579204482017, -592.685908856171, -152.12731033634088, -320.7585027652931, -668.6909217457344, -123.09691486642437, -349.55050771708716, -230.61646400496696, -313.68304512502556, -210.00906651146838, -362.60505302402345, -375.26935498222406, -191.87839730008542, -1262.4510865376458, -747.8502757191724, -86.28328325265922, -113.23718589827017, -370.46089497679054, -390.1746476903563, -470.77732309070467, -975.5245613166279, -1189.6987158005038, -1307.0842765764437, -723.4182479053114, -370.66855059118114, -88.58111201971226, -204.40837186427336, -794.1492510316317, -543.6504436993989, -921.2266307587305, -181.58634064419442, -212.91881708515808, -278.93156298285976, -138.98647950379785, -741.3679568883152, -1246.675685033152, -373.27137600052527, -986.6814101373554, -392.2971899573437, -496.7535921802174, -1050.7065542006617, -769.1586909476282, -48.81917618517605, -120.8091413511448, -1328.0013552896316, -97.10384766621118, -276.1599686369345, -472.52115026686727, -777.8115169007023, -1425.3846028997602, -81.63898183256788, -475.57231492997704, -1071.9438772773453, -772.0009114160101, -120.39170301181841, -24.35390966931821, -357.776010529945, -158.27870228429512, -754.3430421108699, -174.65789526660345, -1272.4734423376071, -593.2324494518583, -141.42724009376246, -1140.8160210792523, -112.68131922037226, -61.95280213105456, -132.81561219775796, -169.63881563809537, -646.388134619945, -1049.5707114003544, -823.8304400750914, -902.847407879755, -865.4264021532445, -828.8582722661399, -1332.9610839361899, -419.2509057490545, -884.1626397892155, -171.85110861438184, -466.0123785489141, -764.9196003345475, -240.4430721174764, -909.6664588766957, -191.16218668763636, -91.82445003290701, -928.3101588280567, -1415.365971306424, -425.8066179866549, -1227.1074284581114, -649.9409479366609, -729.8714046765732, -278.86683319020665, -1167.5590629065316, -352.5016143000809, -37.02428211981211, -61.486639559664866, -931.0517685620804, -67.45798807502169, -773.67263039471, -255.32388937636378, -303.6233381171687, -145.55891854055074, -441.501596180364, -865.2676380805568, -709.8102104633398, -165.3900925238013, -640.0651873340893, -303.6120202865745, -203.17653219761007, -12.728312780107899, -340.7860708572385, -775.2983292059657, -386.11314014193175, -356.7165332349576, -139.31172284709436, -317.26973345566404, -397.77204467618077, -809.5175703877743, -143.23317480034947, -765.5992168576338, -161.77580012455013, -755.0141128671944, -274.5281373296355, -69.38891605397157, -1055.957786830903, -1062.334935028823, -193.49021139119935, -5.677244577054516, -561.4842886443552, -219.43038143363518, -93.10888196261124, -205.06196403317844, -271.02950590498665, -569.2284822388459, -124.70633722810013, -474.9559224149081, -353.14579115433935, -135.45499314410878, -11.63937383752356, -484.9632738187507, -540.4019322279494, -136.42282299990566, -445.1633792398529]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.50151031480168, "mean_inference_ms": 1.6985875113328004, "mean_action_processing_ms": 0.807217515376359, "mean_env_wait_ms": 10.035669296482883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013363122940063477, "StateBufferConnector_ms": 0.009183645248413086, "ViewRequirementAgentConnector_ms": 0.300678014755249}, "num_episodes": 29, "episode_return_max": -770.7405080494301, "episode_return_min": -4590.196094566742, "episode_return_mean": -2417.415176945362, "episodes_this_iter": 29}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 940608, "num_agent_steps_trained": 940608, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 71.59855262596143, "num_env_steps_trained_throughput_per_sec": 71.59855262596143, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 940608, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 940608, "timers": {"training_iteration_time_ms": 54356.428, "restore_workers_time_ms": 0.029, "training_step_time_ms": 54356.352, "sample_time_ms": 3222.503, "learn_time_ms": 51073.439, "learn_throughput": 78.319, "synch_weights_time_ms": 57.35}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 940608, "num_agent_steps_trained": 940608}, "done": false, "training_iteration": 54, "trial_id": "efc54_00000", "date": "2024-07-24_19-29-02", "timestamp": 1721829542, "time_this_iter_s": 55.87808847427368, "time_total_s": 2939.921194076538, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x717514105750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2939.921194076538, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 9.816455696202532, "ram_util_percent": 23.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 120.76631216564829, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.8347339494960515, "policy_loss": -0.0016634979818182512, "vf_loss": 4.855472817602433, "vf_explained_var": 0.9804977595336793, "kl": 0.01681286658880269, "entropy": 2.474971238334035, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.07874015748031, "num_grad_updates_lifetime": 223095.5, "diff_num_grad_updates_vs_sampler_policy": 1904.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 956747, "num_agent_steps_trained": 956747}, "env_runners": {"episode_reward_max": -507.0893449011191, "episode_reward_min": -4590.196094566742, "episode_reward_mean": -2370.9465886863795, "episode_len_mean": 147.23, "episode_media": {}, "episodes_timesteps_total": 14723, "policy_reward_min": {"policy_0": -1454.1678089968773}, "policy_reward_max": {"policy_0": 3.8273552125683397}, "policy_reward_mean": {"policy_0": -474.189317737276}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1438.1612949955534, -2494.138899923135, -3491.2500473199384, -1928.3348100195767, -770.7405080494301, -1145.3959831942964, -2641.5347564723993, -3135.0884140974235, -2223.9810310081925, -1856.5217890565903, -1284.0808419041416, -2343.271658135124, -1284.9426086689382, -2523.0687401839205, -3112.602703395416, -2540.556806767325, -2725.1578847134456, -2067.0342297020984, -3179.809411758333, -2462.739300102844, -1865.9232805041881, -1452.9612151024332, -3111.972357174149, -4590.196094566742, -3286.650017493124, -2901.210031623922, -2252.1050124042504, -2938.1854930260765, -2030.869895960236, -2199.7901825137906, -3272.917050909719, -2318.5199939850067, -1557.5917197719136, -2214.4583859586096, -2802.5511127032555, -2915.2425220295427, -3188.438892233093, -2716.4813806841503, -2086.0414474169143, -2788.3699618456058, -1067.4264561842215, -1804.5812515779137, -3715.284387144437, -1752.161607657369, -4089.6784918656617, -1580.9061649691855, -2352.2345374904594, -1922.8341638531945, -1614.22415743088, -1492.182983647707, -2401.7002287078335, -3396.6361428749824, -2694.160558956923, -2653.5314832191116, -2779.2330604086496, -3695.5974374232055, -1870.8934891290985, -3232.9285668298753, -2346.4664119044387, -2952.9855314512297, -1589.6929947222, -3592.2755096132387, -4330.659303893847, -2552.892618492015, -3052.469384841677, -4053.3456771680812, -1449.522292616661, -1919.6803726091575, -2684.1451486883616, -1718.102385182854, -2020.5876046016706, -2100.1504419793637, -2386.849093881948, -1350.1150219787667, -1657.4915261803037, -1618.5907821239814, -2449.490789810346, -1932.4854291636625, -507.0893449011191, -2302.8838974025794, -3776.8686369454967, -1387.6132748760863, -4043.6426348747164, -2188.5853064582498, -3176.1146524448295, -1190.9829404075015, -1803.3373620961993, -3046.2604199974885, -1861.9685694351556, -2488.603546944624, -1821.7253525566102, -1851.6846438143214, -1779.6372204101476, -2056.0346841266214, -2605.3674122267375, -2566.920688614645, -2411.5270497490865, -2837.7244541727555, -630.5500799918702, -1746.4554385417723], "episode_lengths": [117, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 143, 150, 150, 150, 129, 140, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150], "policy_policy_0_reward": [-61.43528811621252, -368.5457554906716, -437.8178418031972, -147.24537833213023, -423.11703125334236, -712.2488105126885, -543.554855705483, -178.33894963754807, -601.9843776147618, -458.01190645265433, -56.921893867032026, -1001.3412029874913, -326.2510289579482, -1045.8435677910106, -1060.8923537164571, -955.8016524793547, -528.4970527849108, -201.3544684507435, -139.52223742597857, -103.15939887859037, -188.9325242065696, -251.90273460499174, -73.0962037530514, -249.46439719562431, -7.3446482891927705, -6.203006909970315, -26.607562441049897, -157.38751016491182, -882.4572739593007, -72.74062971906318, -603.9440047053884, -610.423599857953, -395.09838635551006, -36.48646852047123, -995.582297033078, -429.0544221784604, -206.2585095229251, -952.5659051227711, -937.3820062698616, -609.827571003406, -477.6285610362278, -282.6247817339835, -59.90346728951257, -1155.9727047781355, -247.85151617033526, -290.3258642340195, -171.01675944468664, -153.3924082950916, -789.6230665610341, -452.16369052175935, -112.93645638489262, -999.7280378500873, -40.302293656831374, -44.00938000063233, -87.10467401169821, -32.227578146936615, -910.9878646655029, -435.8790228638375, -839.1696928032817, -125.00749965556545, -591.6906308653299, -145.83913881444536, -203.4642196355129, -113.1973654977348, -230.75125385591528, -292.09439275584856, -94.51816892388297, -814.9561296194751, -944.4085159567874, -377.09153292792746, -945.4622128695149, -741.5228041464608, -150.42736696862372, -379.57185168551064, -895.6184677253065, -187.7500920478509, -884.8678286809189, -388.7483267552432, -79.90172944764018, -999.288829835672, -865.65995326232, -95.00085608057213, -847.3154865097637, -716.3208007356174, -200.86078812517232, -54.86362013129888, -651.8287462473867, -970.7356848307369, -59.95819240766986, -329.6479860850067, -495.9222948077283, -150.98407630453497, -490.30314078764064, -1278.5061152761293, -764.0937845822987, -687.8079656560558, -656.9382075912858, -744.9617085454638, -228.5913018319513, -144.44011647808856, -21.30701126939511, -78.82795494743218, -521.7742051568493, -1114.3067507172282, -129.70735841328423, -457.406521266777, -346.704221359344, 3.8273552125683397, -43.74270392503628, -608.9351237638433, -383.6355708415459, -755.3160569079143, -926.3104238324169, -198.37271943565872, -848.3375861566116, -780.9909527952592, -839.3757971701538, -1239.5443927151073, -782.8835973629627, -947.4013545232584, -270.20907035376575, -117.32051438254074, -1216.2047382474786, -664.7568722716417, -1018.1588222376984, -1213.658688359181, -97.54383317680356, -556.0400609873999, -531.8886975890009, -502.07875151153485, -935.5496029524912, -17.676678812963406, -1048.9124939051371, -193.66681447712395, -56.299422256534925, -771.6833184480431, -1138.1719076349518, -195.55304054119617, -109.36342684390875, -723.4137995579744, -33.10070486677889, -290.4893977580899, -711.1868498826847, -103.80906189191565, -892.2838815607695, -461.68264403941015, -679.930595663974, -377.61004730715575, -427.8751797988928, -252.6917157043618, -981.935426173176, -636.4831257805959, -797.3041335833203, -495.1810433961063, -362.0133219765211, -72.9479617106113, -576.3345824539815, -731.5670542275154, -422.3188926456966, -515.351502947201, -342.91675364738194, -717.5025904638428, -200.79110688113704, -47.58680815241048, -248.7944606271424, -1365.3529396294339, -233.47276385272838, -333.8216216996642, -52.00962321387762, -229.80143756290423, -127.19688039437865, -79.1055531045996, -440.597981082842, -745.9404581582497, -1409.7102399631854, -921.5482618552891, -716.9290554398664, -76.78152533939569, -372.20235841371147, -827.7813209812813, -598.9420053829259, -1454.1678089968773, -154.79072075492923, -28.317994739175095, -952.2203623591862, -917.1478685293253, -609.8602372977275, -412.90342024833444, -516.965697831971, -259.6041567767922, -518.964193226216, -800.0466650254165, -360.27994871096007, -137.10032313971857, -269.65031731460255, -122.22307440139502, -758.5309093343409, -831.5824752338109, -916.9677879202345, -159.06571495582403, -197.66782924411035, -191.7958054913613, -524.8382550960207, -70.42583242378723, -82.69873392894131, -21.6442478742486, -933.4796381693284, -100.15890115963448, -399.6226906470277, -349.6757737276737, -273.58173959574106, -558.4725430025048, -916.6484078822024, -1129.2204050722787, -837.3612915917076, -106.79654175402278, -919.8129529400527, -271.24851442429156, -199.18368887773573, -255.11990966126388, -1332.6373961374802, -1250.8844850366665, -75.08678919396885, -220.85662283841452, -1210.213198659129, -12.568975297535044, -474.8928780829401, -90.44967260107066, -517.9874762440562, -485.0071627435846, -558.1986631088979, -416.5340253484857, -106.65846352239215, -1226.7032887500209, -44.14009676066204, -314.2648860182021, -60.57680672806226, -540.1486418025587, -415.1579204482017, -592.685908856171, -152.12731033634088, -320.7585027652931, -668.6909217457344, -123.09691486642437, -349.55050771708716, -230.61646400496696, -313.68304512502556, -210.00906651146838, -362.60505302402345, -375.26935498222406, -191.87839730008542, -1262.4510865376458, -747.8502757191724, -86.28328325265922, -113.23718589827017, -370.46089497679054, -390.1746476903563, -470.77732309070467, -975.5245613166279, -1189.6987158005038, -1307.0842765764437, -723.4182479053114, -370.66855059118114, -88.58111201971226, -204.40837186427336, -794.1492510316317, -543.6504436993989, -921.2266307587305, -181.58634064419442, -212.91881708515808, -278.93156298285976, -138.98647950379785, -741.3679568883152, -1246.675685033152, -373.27137600052527, -986.6814101373554, -392.2971899573437, -496.7535921802174, -1050.7065542006617, -769.1586909476282, -48.81917618517605, -120.8091413511448, -1328.0013552896316, -97.10384766621118, -276.1599686369345, -472.52115026686727, -777.8115169007023, -1425.3846028997602, -81.63898183256788, -475.57231492997704, -1071.9438772773453, -772.0009114160101, -120.39170301181841, -24.35390966931821, -357.776010529945, -158.27870228429512, -754.3430421108699, -174.65789526660345, -1272.4734423376071, -593.2324494518583, -141.42724009376246, -1140.8160210792523, -112.68131922037226, -61.95280213105456, -132.81561219775796, -169.63881563809537, -646.388134619945, -1049.5707114003544, -823.8304400750914, -902.847407879755, -865.4264021532445, -828.8582722661399, -1332.9610839361899, -419.2509057490545, -884.1626397892155, -171.85110861438184, -466.0123785489141, -764.9196003345475, -240.4430721174764, -909.6664588766957, -191.16218668763636, -91.82445003290701, -928.3101588280567, -1415.365971306424, -425.8066179866549, -1227.1074284581114, -649.9409479366609, -729.8714046765732, -278.86683319020665, -1167.5590629065316, -352.5016143000809, -37.02428211981211, -61.486639559664866, -931.0517685620804, -67.45798807502169, -773.67263039471, -255.32388937636378, -303.6233381171687, -145.55891854055074, -441.501596180364, -865.2676380805568, -709.8102104633398, -165.3900925238013, -640.0651873340893, -303.6120202865745, -203.17653219761007, -12.728312780107899, -340.7860708572385, -775.2983292059657, -386.11314014193175, -356.7165332349576, -139.31172284709436, -317.26973345566404, -397.77204467618077, -809.5175703877743, -143.23317480034947, -765.5992168576338, -161.77580012455013, -755.0141128671944, -274.5281373296355, -69.38891605397157, -1055.957786830903, -1062.334935028823, -193.49021139119935, -5.677244577054516, -561.4842886443552, -219.43038143363518, -93.10888196261124, -205.06196403317844, -271.02950590498665, -569.2284822388459, -124.70633722810013, -474.9559224149081, -353.14579115433935, -135.45499314410878, -11.63937383752356, -484.9632738187507, -540.4019322279494, -136.42282299990566, -445.1633792398529, -161.08963467262367, -510.1759652139406, -813.931262016705, -416.6451111806623, -547.6488167264142, -919.1731476777003, -102.54030852629029, -361.20263716810706, -166.21249580273312, -383.35683998883087, -177.00724128962872, -14.867410659813277, -150.15968564693318, -55.004905355942654, -110.05010194880087, -210.35663912174783, -630.7447347773204, -227.1637583306342, -1140.9924214025457, -93.62634377033136, -903.2842014706708, -783.5948769291017, -1072.382308909995, -786.3187836146243, -231.2884660211065, -604.5565841943089, -14.544741207136626, -88.62107599039209, -451.816910776074, -228.07396270817424, -931.0074558895747, -960.2279674642483, -335.52807478648305, -881.9432379316368, -934.9358988027699, -29.74835362149124, -916.8238802467488, -173.11166648873828, -194.50616030531756, -874.3952457959535, -98.72954894830659, -938.6522718946173, -1003.1409813086085, -102.72288349438892, -1032.8689667989097, -35.010024903430384, -31.85254252887949, -790.485171617073, -219.99978804351596, -113.6354133146007, -874.8613405708953, -39.62061197480174, -593.1474412313144, -256.15096848325885, -39.55699983592816, -898.942054001042, -879.4874565485208, -672.5618102958556, -80.36638356868495, -514.9027155833879, -598.2809931927137, -614.0398312791257, -141.83988316198747, -471.81614508947223, -35.99171671185497, -879.226659564304, -10.212000878824107, -815.9971261578421, -668.2315752623031, -114.93618508134787, -634.8199322158679, -939.822788056552, -118.37542186893315, -88.70661342436954, -40.000596990886784, -998.2955589022905, -56.58856081492296, -247.3838455961554, -512.8429508433472, -36.5737276576055, -715.8470814250577, -195.32051614996993, -296.2074829076625, -461.203014824447, -111.05912510301032, -821.8595153675843, -22.45692620471792, -213.91903418790247, -895.5118371036103, -102.28737126280699, -959.6078680691838, -239.2113382389801, -516.8608832581072, -869.6503499002583, -20.03697276020904, -352.57508247512345, -652.0503190067018, -42.70046269761197, -444.24104371414165, -1075.3537807210669, -148.45709222278643, -165.7507210277361, -480.12852442582835, -575.9115150955123, -1041.2791969772243, -303.1920919001735, -1026.0633563435688, -130.70416595104075, -42.5063267190195, -1335.2585132589547, -94.59458350069475, -276.55168766486895, -69.22604794426897, -78.64328579678421, -111.53447508525352, -11.646414753010303, -429.46914236701235, -347.92660553922644, -934.5489322705739, -22.864343611950574]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4983188387505515, "mean_inference_ms": 1.6963445672721462, "mean_action_processing_ms": 0.8057968015296397, "mean_env_wait_ms": 10.008201604492568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013363122940063477, "StateBufferConnector_ms": 0.009222745895385742, "ViewRequirementAgentConnector_ms": 0.30347537994384766}, "num_episodes": 24, "episode_return_max": -507.0893449011191, "episode_return_min": -4590.196094566742, "episode_return_mean": -2370.9465886863795, "episodes_this_iter": 24}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 956747, "num_agent_steps_trained": 956747, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 78.43277393631834, "num_env_steps_trained_throughput_per_sec": 78.43277393631834, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 956747, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 956747, "timers": {"training_iteration_time_ms": 53746.992, "restore_workers_time_ms": 0.028, "training_step_time_ms": 53746.918, "sample_time_ms": 3203.134, "learn_time_ms": 50484.174, "learn_throughput": 79.233, "synch_weights_time_ms": 56.568}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 956747, "num_agent_steps_trained": 956747}, "done": false, "training_iteration": 55, "trial_id": "efc54_00000", "date": "2024-07-24_19-29-53", "timestamp": 1721829593, "time_this_iter_s": 51.011247396469116, "time_total_s": 2990.932441473007, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7e91b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2990.932441473007, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 9.965753424657533, "ram_util_percent": 23.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 105.42528129201946, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.7794735548472165, "policy_loss": -0.0018071799170969035, "vf_loss": 4.800496911039256, "vf_explained_var": 0.9804297951435802, "kl": 0.0177301055965169, "entropy": 2.5200093862986326, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79545454545455, "num_grad_updates_lifetime": 226980.5, "diff_num_grad_updates_vs_sampler_policy": 1979.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 973616, "num_agent_steps_trained": 973616}, "env_runners": {"episode_reward_max": -507.0893449011191, "episode_reward_min": -4379.869239333892, "episode_reward_mean": -2365.9813190049754, "episode_len_mean": 147.48, "episode_media": {}, "episodes_timesteps_total": 14748, "policy_reward_min": {"policy_0": -1457.342944722022}, "policy_reward_max": {"policy_0": -4.17860290026679}, "policy_reward_mean": {"policy_0": -473.1962638009951}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2030.869895960236, -2199.7901825137906, -3272.917050909719, -2318.5199939850067, -1557.5917197719136, -2214.4583859586096, -2802.5511127032555, -2915.2425220295427, -3188.438892233093, -2716.4813806841503, -2086.0414474169143, -2788.3699618456058, -1067.4264561842215, -1804.5812515779137, -3715.284387144437, -1752.161607657369, -4089.6784918656617, -1580.9061649691855, -2352.2345374904594, -1922.8341638531945, -1614.22415743088, -1492.182983647707, -2401.7002287078335, -3396.6361428749824, -2694.160558956923, -2653.5314832191116, -2779.2330604086496, -3695.5974374232055, -1870.8934891290985, -3232.9285668298753, -2346.4664119044387, -2952.9855314512297, -1589.6929947222, -3592.2755096132387, -4330.659303893847, -2552.892618492015, -3052.469384841677, -4053.3456771680812, -1449.522292616661, -1919.6803726091575, -2684.1451486883616, -1718.102385182854, -2020.5876046016706, -2100.1504419793637, -2386.849093881948, -1350.1150219787667, -1657.4915261803037, -1618.5907821239814, -2449.490789810346, -1932.4854291636625, -507.0893449011191, -2302.8838974025794, -3776.8686369454967, -1387.6132748760863, -4043.6426348747164, -2188.5853064582498, -3176.1146524448295, -1190.9829404075015, -1803.3373620961993, -3046.2604199974885, -1861.9685694351556, -2488.603546944624, -1821.7253525566102, -1851.6846438143214, -1779.6372204101476, -2056.0346841266214, -2605.3674122267375, -2566.920688614645, -2411.5270497490865, -2837.7244541727555, -630.5500799918702, -1746.4554385417723, -2858.5091667676543, -4321.958874256471, -2307.1721910123388, -1353.7848105443484, -2653.636950726621, -1683.286811049152, -1916.2037310172204, -2949.906080599159, -2785.028250997675, -4379.869239333892, -539.7045705050989, -2078.3552347676655, -2233.024218334477, -2897.8724423563026, -1983.8502256900588, -1581.210243486282, -4013.301755956987, -2148.226889295783, -2617.8011467139017, -2974.2624833436685, -2005.9806501854507, -922.4175182484659, -2180.3854214232438, -2920.9812392154477, -1822.1248541332998, -3428.633673564103, -1234.8272335366414, -1758.7723461611495], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 143, 150, 150, 150, 129, 140, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 132, 150], "policy_policy_0_reward": [-33.10070486677889, -290.4893977580899, -711.1868498826847, -103.80906189191565, -892.2838815607695, -461.68264403941015, -679.930595663974, -377.61004730715575, -427.8751797988928, -252.6917157043618, -981.935426173176, -636.4831257805959, -797.3041335833203, -495.1810433961063, -362.0133219765211, -72.9479617106113, -576.3345824539815, -731.5670542275154, -422.3188926456966, -515.351502947201, -342.91675364738194, -717.5025904638428, -200.79110688113704, -47.58680815241048, -248.7944606271424, -1365.3529396294339, -233.47276385272838, -333.8216216996642, -52.00962321387762, -229.80143756290423, -127.19688039437865, -79.1055531045996, -440.597981082842, -745.9404581582497, -1409.7102399631854, -921.5482618552891, -716.9290554398664, -76.78152533939569, -372.20235841371147, -827.7813209812813, -598.9420053829259, -1454.1678089968773, -154.79072075492923, -28.317994739175095, -952.2203623591862, -917.1478685293253, -609.8602372977275, -412.90342024833444, -516.965697831971, -259.6041567767922, -518.964193226216, -800.0466650254165, -360.27994871096007, -137.10032313971857, -269.65031731460255, -122.22307440139502, -758.5309093343409, -831.5824752338109, -916.9677879202345, -159.06571495582403, -197.66782924411035, -191.7958054913613, -524.8382550960207, -70.42583242378723, -82.69873392894131, -21.6442478742486, -933.4796381693284, -100.15890115963448, -399.6226906470277, -349.6757737276737, -273.58173959574106, -558.4725430025048, -916.6484078822024, -1129.2204050722787, -837.3612915917076, -106.79654175402278, -919.8129529400527, -271.24851442429156, -199.18368887773573, -255.11990966126388, -1332.6373961374802, -1250.8844850366665, -75.08678919396885, -220.85662283841452, -1210.213198659129, -12.568975297535044, -474.8928780829401, -90.44967260107066, -517.9874762440562, -485.0071627435846, -558.1986631088979, -416.5340253484857, -106.65846352239215, -1226.7032887500209, -44.14009676066204, -314.2648860182021, -60.57680672806226, -540.1486418025587, -415.1579204482017, -592.685908856171, -152.12731033634088, -320.7585027652931, -668.6909217457344, -123.09691486642437, -349.55050771708716, -230.61646400496696, -313.68304512502556, -210.00906651146838, -362.60505302402345, -375.26935498222406, -191.87839730008542, -1262.4510865376458, -747.8502757191724, -86.28328325265922, -113.23718589827017, -370.46089497679054, -390.1746476903563, -470.77732309070467, -975.5245613166279, -1189.6987158005038, -1307.0842765764437, -723.4182479053114, -370.66855059118114, -88.58111201971226, -204.40837186427336, -794.1492510316317, -543.6504436993989, -921.2266307587305, -181.58634064419442, -212.91881708515808, -278.93156298285976, -138.98647950379785, -741.3679568883152, -1246.675685033152, -373.27137600052527, -986.6814101373554, -392.2971899573437, -496.7535921802174, -1050.7065542006617, -769.1586909476282, -48.81917618517605, -120.8091413511448, -1328.0013552896316, -97.10384766621118, -276.1599686369345, -472.52115026686727, -777.8115169007023, -1425.3846028997602, -81.63898183256788, -475.57231492997704, -1071.9438772773453, -772.0009114160101, -120.39170301181841, -24.35390966931821, -357.776010529945, -158.27870228429512, -754.3430421108699, -174.65789526660345, -1272.4734423376071, -593.2324494518583, -141.42724009376246, -1140.8160210792523, -112.68131922037226, -61.95280213105456, -132.81561219775796, -169.63881563809537, -646.388134619945, -1049.5707114003544, -823.8304400750914, -902.847407879755, -865.4264021532445, -828.8582722661399, -1332.9610839361899, -419.2509057490545, -884.1626397892155, -171.85110861438184, -466.0123785489141, -764.9196003345475, -240.4430721174764, -909.6664588766957, -191.16218668763636, -91.82445003290701, -928.3101588280567, -1415.365971306424, -425.8066179866549, -1227.1074284581114, -649.9409479366609, -729.8714046765732, -278.86683319020665, -1167.5590629065316, -352.5016143000809, -37.02428211981211, -61.486639559664866, -931.0517685620804, -67.45798807502169, -773.67263039471, -255.32388937636378, -303.6233381171687, -145.55891854055074, -441.501596180364, -865.2676380805568, -709.8102104633398, -165.3900925238013, -640.0651873340893, -303.6120202865745, -203.17653219761007, -12.728312780107899, -340.7860708572385, -775.2983292059657, -386.11314014193175, -356.7165332349576, -139.31172284709436, -317.26973345566404, -397.77204467618077, -809.5175703877743, -143.23317480034947, -765.5992168576338, -161.77580012455013, -755.0141128671944, -274.5281373296355, -69.38891605397157, -1055.957786830903, -1062.334935028823, -193.49021139119935, -5.677244577054516, -561.4842886443552, -219.43038143363518, -93.10888196261124, -205.06196403317844, -271.02950590498665, -569.2284822388459, -124.70633722810013, -474.9559224149081, -353.14579115433935, -135.45499314410878, -11.63937383752356, -484.9632738187507, -540.4019322279494, -136.42282299990566, -445.1633792398529, -161.08963467262367, -510.1759652139406, -813.931262016705, -416.6451111806623, -547.6488167264142, -919.1731476777003, -102.54030852629029, -361.20263716810706, -166.21249580273312, -383.35683998883087, -177.00724128962872, -14.867410659813277, -150.15968564693318, -55.004905355942654, -110.05010194880087, -210.35663912174783, -630.7447347773204, -227.1637583306342, -1140.9924214025457, -93.62634377033136, -903.2842014706708, -783.5948769291017, -1072.382308909995, -786.3187836146243, -231.2884660211065, -604.5565841943089, -14.544741207136626, -88.62107599039209, -451.816910776074, -228.07396270817424, -931.0074558895747, -960.2279674642483, -335.52807478648305, -881.9432379316368, -934.9358988027699, -29.74835362149124, -916.8238802467488, -173.11166648873828, -194.50616030531756, -874.3952457959535, -98.72954894830659, -938.6522718946173, -1003.1409813086085, -102.72288349438892, -1032.8689667989097, -35.010024903430384, -31.85254252887949, -790.485171617073, -219.99978804351596, -113.6354133146007, -874.8613405708953, -39.62061197480174, -593.1474412313144, -256.15096848325885, -39.55699983592816, -898.942054001042, -879.4874565485208, -672.5618102958556, -80.36638356868495, -514.9027155833879, -598.2809931927137, -614.0398312791257, -141.83988316198747, -471.81614508947223, -35.99171671185497, -879.226659564304, -10.212000878824107, -815.9971261578421, -668.2315752623031, -114.93618508134787, -634.8199322158679, -939.822788056552, -118.37542186893315, -88.70661342436954, -40.000596990886784, -998.2955589022905, -56.58856081492296, -247.3838455961554, -512.8429508433472, -36.5737276576055, -715.8470814250577, -195.32051614996993, -296.2074829076625, -461.203014824447, -111.05912510301032, -821.8595153675843, -22.45692620471792, -213.91903418790247, -895.5118371036103, -102.28737126280699, -959.6078680691838, -239.2113382389801, -516.8608832581072, -869.6503499002583, -20.03697276020904, -352.57508247512345, -652.0503190067018, -42.70046269761197, -444.24104371414165, -1075.3537807210669, -148.45709222278643, -165.7507210277361, -480.12852442582835, -575.9115150955123, -1041.2791969772243, -303.1920919001735, -1026.0633563435688, -130.70416595104075, -42.5063267190195, -1335.2585132589547, -94.59458350069475, -276.55168766486895, -69.22604794426897, -78.64328579678421, -111.53447508525352, -11.646414753010303, -429.46914236701235, -347.92660553922644, -934.5489322705739, -22.864343611950574, -600.2642786618593, -992.8683039246787, -48.901248553829696, -725.2488361119291, -491.2264995153586, -1011.0263778170624, -956.3143923545027, -864.2461943850188, -877.8826685006579, -612.4892411992288, -973.4339212257258, -214.06503605439005, -883.2131952577843, -192.80135596573402, -43.65868250870591, -28.23963879987869, -745.0715205764819, -210.51094043840368, -212.63766922796447, -157.3250415016188, -254.3569562474284, -543.608620826045, -998.2922387397847, -796.0983810313311, -61.28075388203122, -97.32908632634657, -927.1495070055122, -76.78627402114373, -539.1839954303492, -42.83794826579848, -89.1993016533993, -180.65118021967055, -1457.342944722022, -159.47966739270032, -29.53063702942863, -450.09024576031305, -809.0295760308179, -565.1139939975033, -878.4139675797322, -247.25829723079536, -921.7573813629381, -128.5428974016222, -460.45219126247576, -321.1574641293104, -953.1183168413297, -1082.7300827935446, -843.1971626378788, -897.2743459244674, -839.2350346528405, -717.4326133251587, -126.23343568138463, -36.51870225105336, -78.76402229177839, -23.875201722578787, -274.3132085583039, -371.75682366319427, -21.883669540013823, -346.94438381981087, -76.60366677206187, -1261.1666909725864, -903.7918235784758, -121.33327644674551, -71.9138677545778, -409.3395996448257, -726.6456509098508, -901.7992761412742, -619.8300080175077, -499.95636290159223, -749.4666289553265, -126.82016634060379, -299.5423164561459, -89.82613472299914, -82.56012684753784, -829.4987590230853, -682.4228886402924, -324.4397477249851, -161.1532287977917, -575.4465855660444, -131.08575116331326, -389.0849302341482, -241.94687607115063, -1434.741329892326, -1068.5905902179986, -826.4527789926374, -441.570180782877, -227.8683386115377, -55.392510082473095, -932.3321550253925, -753.2561696997648, -179.3777158766178, -1295.1374921114254, -340.43721755719525, -512.9686349351559, -406.96211021578813, -62.29569189433475, -1132.3583448914871, -398.71871757642305, -394.2720127892398, -612.8076613816388, -436.1057467048829, -298.9865083448611, -712.0889337883602, -181.04082703614935, -433.31089667370196, -380.5534843423781, -11.777951964930956, -4.17860290026679, -457.2271898111421, -146.37058668550583, -302.8631868866194, -126.21076246304816, -369.7523215837804, -354.78332940310975, -960.954806815516, -368.68420115779145, -43.21561282279631, -1005.7430508661638, -211.40670393983828, -637.2794559571208, -1023.33641562953, -264.26286737604124, -969.0243077770915, -109.28414278436229, -129.60864418082062, -349.9448920149839, -852.8630226698272, -409.43242786579475, -520.5011950589534, -939.6822186416416, -706.1548093278875, -224.6754888296271, -647.5366026587219, -177.94241183171576, -63.96917017491664, -120.70356004166064, -449.5265388043745, -315.1698114082311, -833.520165283966, -55.96555855705014, -104.5902721075269]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.49958289997149, "mean_inference_ms": 1.697063658622556, "mean_action_processing_ms": 0.8041793869833656, "mean_env_wait_ms": 10.012422621055553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013103485107421875, "StateBufferConnector_ms": 0.009071588516235352, "ViewRequirementAgentConnector_ms": 0.2950704097747803}, "num_episodes": 28, "episode_return_max": -507.0893449011191, "episode_return_min": -4379.869239333892, "episode_return_mean": -2365.9813190049754, "episodes_this_iter": 28}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 973616, "num_agent_steps_trained": 973616, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.52792638354498, "num_env_steps_trained_throughput_per_sec": 73.52792638354498, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 973616, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 973616, "timers": {"training_iteration_time_ms": 53882.316, "restore_workers_time_ms": 0.027, "training_step_time_ms": 53882.242, "sample_time_ms": 3229.38, "learn_time_ms": 50593.584, "learn_throughput": 79.061, "synch_weights_time_ms": 56.212}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 973616, "num_agent_steps_trained": 973616}, "done": false, "training_iteration": 56, "trial_id": "efc54_00000", "date": "2024-07-24_19-30-48", "timestamp": 1721829648, "time_this_iter_s": 54.41248083114624, "time_total_s": 3045.3449223041534, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7175141069e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3045.3449223041534, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 9.777922077922078, "ram_util_percent": 23.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 122.05091842274607, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.679558537801107, "policy_loss": -0.0022511178458592407, "vf_loss": 4.701565814430331, "vf_explained_var": 0.9819393510288662, "kl": 0.016228006501871818, "entropy": 2.5233111080122583, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.55555555555556, "num_grad_updates_lifetime": 230985.5, "diff_num_grad_updates_vs_sampler_policy": 2024.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 990836, "num_agent_steps_trained": 990836}, "env_runners": {"episode_reward_max": -507.0893449011191, "episode_reward_min": -4741.350890933286, "episode_reward_mean": -2410.5101857122827, "episode_len_mean": 147.87, "episode_media": {}, "episodes_timesteps_total": 14787, "policy_reward_min": {"policy_0": -1457.342944722022}, "policy_reward_max": {"policy_0": -0.20794378028347416}, "policy_reward_mean": {"policy_0": -482.10203714245665}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3232.9285668298753, -2346.4664119044387, -2952.9855314512297, -1589.6929947222, -3592.2755096132387, -4330.659303893847, -2552.892618492015, -3052.469384841677, -4053.3456771680812, -1449.522292616661, -1919.6803726091575, -2684.1451486883616, -1718.102385182854, -2020.5876046016706, -2100.1504419793637, -2386.849093881948, -1350.1150219787667, -1657.4915261803037, -1618.5907821239814, -2449.490789810346, -1932.4854291636625, -507.0893449011191, -2302.8838974025794, -3776.8686369454967, -1387.6132748760863, -4043.6426348747164, -2188.5853064582498, -3176.1146524448295, -1190.9829404075015, -1803.3373620961993, -3046.2604199974885, -1861.9685694351556, -2488.603546944624, -1821.7253525566102, -1851.6846438143214, -1779.6372204101476, -2056.0346841266214, -2605.3674122267375, -2566.920688614645, -2411.5270497490865, -2837.7244541727555, -630.5500799918702, -1746.4554385417723, -2858.5091667676543, -4321.958874256471, -2307.1721910123388, -1353.7848105443484, -2653.636950726621, -1683.286811049152, -1916.2037310172204, -2949.906080599159, -2785.028250997675, -4379.869239333892, -539.7045705050989, -2078.3552347676655, -2233.024218334477, -2897.8724423563026, -1983.8502256900588, -1581.210243486282, -4013.301755956987, -2148.226889295783, -2617.8011467139017, -2974.2624833436685, -2005.9806501854507, -922.4175182484659, -2180.3854214232438, -2920.9812392154477, -1822.1248541332998, -3428.633673564103, -1234.8272335366414, -1758.7723461611495, -2709.583421568516, -1949.9417547528328, -3065.596470669166, -1596.3179569125869, -1825.330495648661, -3134.8593663655406, -3157.5060050077154, -3607.085078262941, -3001.6541685869124, -1691.2630353746008, -3405.585730504322, -2664.345054207134, -1824.1710986654714, -1288.541182923524, -1971.0838000662015, -4741.350890933286, -2104.510030153984, -2093.172338923573, -2249.5098439881567, -2190.909435597417, -4229.595177139594, -2675.385607258532, -2782.132472912871, -2464.031392258971, -1605.3190102562444, -2465.7920973953555, -3172.1708816893097, -2173.035983148943, -3587.6460381110815], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 143, 150, 150, 150, 129, 140, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 132, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-472.52115026686727, -777.8115169007023, -1425.3846028997602, -81.63898183256788, -475.57231492997704, -1071.9438772773453, -772.0009114160101, -120.39170301181841, -24.35390966931821, -357.776010529945, -158.27870228429512, -754.3430421108699, -174.65789526660345, -1272.4734423376071, -593.2324494518583, -141.42724009376246, -1140.8160210792523, -112.68131922037226, -61.95280213105456, -132.81561219775796, -169.63881563809537, -646.388134619945, -1049.5707114003544, -823.8304400750914, -902.847407879755, -865.4264021532445, -828.8582722661399, -1332.9610839361899, -419.2509057490545, -884.1626397892155, -171.85110861438184, -466.0123785489141, -764.9196003345475, -240.4430721174764, -909.6664588766957, -191.16218668763636, -91.82445003290701, -928.3101588280567, -1415.365971306424, -425.8066179866549, -1227.1074284581114, -649.9409479366609, -729.8714046765732, -278.86683319020665, -1167.5590629065316, -352.5016143000809, -37.02428211981211, -61.486639559664866, -931.0517685620804, -67.45798807502169, -773.67263039471, -255.32388937636378, -303.6233381171687, -145.55891854055074, -441.501596180364, -865.2676380805568, -709.8102104633398, -165.3900925238013, -640.0651873340893, -303.6120202865745, -203.17653219761007, -12.728312780107899, -340.7860708572385, -775.2983292059657, -386.11314014193175, -356.7165332349576, -139.31172284709436, -317.26973345566404, -397.77204467618077, -809.5175703877743, -143.23317480034947, -765.5992168576338, -161.77580012455013, -755.0141128671944, -274.5281373296355, -69.38891605397157, -1055.957786830903, -1062.334935028823, -193.49021139119935, -5.677244577054516, -561.4842886443552, -219.43038143363518, -93.10888196261124, -205.06196403317844, -271.02950590498665, -569.2284822388459, -124.70633722810013, -474.9559224149081, -353.14579115433935, -135.45499314410878, -11.63937383752356, -484.9632738187507, -540.4019322279494, -136.42282299990566, -445.1633792398529, -161.08963467262367, -510.1759652139406, -813.931262016705, -416.6451111806623, -547.6488167264142, -919.1731476777003, -102.54030852629029, -361.20263716810706, -166.21249580273312, -383.35683998883087, -177.00724128962872, -14.867410659813277, -150.15968564693318, -55.004905355942654, -110.05010194880087, -210.35663912174783, -630.7447347773204, -227.1637583306342, -1140.9924214025457, -93.62634377033136, -903.2842014706708, -783.5948769291017, -1072.382308909995, -786.3187836146243, -231.2884660211065, -604.5565841943089, -14.544741207136626, -88.62107599039209, -451.816910776074, -228.07396270817424, -931.0074558895747, -960.2279674642483, -335.52807478648305, -881.9432379316368, -934.9358988027699, -29.74835362149124, -916.8238802467488, -173.11166648873828, -194.50616030531756, -874.3952457959535, -98.72954894830659, -938.6522718946173, -1003.1409813086085, -102.72288349438892, -1032.8689667989097, -35.010024903430384, -31.85254252887949, -790.485171617073, -219.99978804351596, -113.6354133146007, -874.8613405708953, -39.62061197480174, -593.1474412313144, -256.15096848325885, -39.55699983592816, -898.942054001042, -879.4874565485208, -672.5618102958556, -80.36638356868495, -514.9027155833879, -598.2809931927137, -614.0398312791257, -141.83988316198747, -471.81614508947223, -35.99171671185497, -879.226659564304, -10.212000878824107, -815.9971261578421, -668.2315752623031, -114.93618508134787, -634.8199322158679, -939.822788056552, -118.37542186893315, -88.70661342436954, -40.000596990886784, -998.2955589022905, -56.58856081492296, -247.3838455961554, -512.8429508433472, -36.5737276576055, -715.8470814250577, -195.32051614996993, -296.2074829076625, -461.203014824447, -111.05912510301032, -821.8595153675843, -22.45692620471792, -213.91903418790247, -895.5118371036103, -102.28737126280699, -959.6078680691838, -239.2113382389801, -516.8608832581072, -869.6503499002583, -20.03697276020904, -352.57508247512345, -652.0503190067018, -42.70046269761197, -444.24104371414165, -1075.3537807210669, -148.45709222278643, -165.7507210277361, -480.12852442582835, -575.9115150955123, -1041.2791969772243, -303.1920919001735, -1026.0633563435688, -130.70416595104075, -42.5063267190195, -1335.2585132589547, -94.59458350069475, -276.55168766486895, -69.22604794426897, -78.64328579678421, -111.53447508525352, -11.646414753010303, -429.46914236701235, -347.92660553922644, -934.5489322705739, -22.864343611950574, -600.2642786618593, -992.8683039246787, -48.901248553829696, -725.2488361119291, -491.2264995153586, -1011.0263778170624, -956.3143923545027, -864.2461943850188, -877.8826685006579, -612.4892411992288, -973.4339212257258, -214.06503605439005, -883.2131952577843, -192.80135596573402, -43.65868250870591, -28.23963879987869, -745.0715205764819, -210.51094043840368, -212.63766922796447, -157.3250415016188, -254.3569562474284, -543.608620826045, -998.2922387397847, -796.0983810313311, -61.28075388203122, -97.32908632634657, -927.1495070055122, -76.78627402114373, -539.1839954303492, -42.83794826579848, -89.1993016533993, -180.65118021967055, -1457.342944722022, -159.47966739270032, -29.53063702942863, -450.09024576031305, -809.0295760308179, -565.1139939975033, -878.4139675797322, -247.25829723079536, -921.7573813629381, -128.5428974016222, -460.45219126247576, -321.1574641293104, -953.1183168413297, -1082.7300827935446, -843.1971626378788, -897.2743459244674, -839.2350346528405, -717.4326133251587, -126.23343568138463, -36.51870225105336, -78.76402229177839, -23.875201722578787, -274.3132085583039, -371.75682366319427, -21.883669540013823, -346.94438381981087, -76.60366677206187, -1261.1666909725864, -903.7918235784758, -121.33327644674551, -71.9138677545778, -409.3395996448257, -726.6456509098508, -901.7992761412742, -619.8300080175077, -499.95636290159223, -749.4666289553265, -126.82016634060379, -299.5423164561459, -89.82613472299914, -82.56012684753784, -829.4987590230853, -682.4228886402924, -324.4397477249851, -161.1532287977917, -575.4465855660444, -131.08575116331326, -389.0849302341482, -241.94687607115063, -1434.741329892326, -1068.5905902179986, -826.4527789926374, -441.570180782877, -227.8683386115377, -55.392510082473095, -932.3321550253925, -753.2561696997648, -179.3777158766178, -1295.1374921114254, -340.43721755719525, -512.9686349351559, -406.96211021578813, -62.29569189433475, -1132.3583448914871, -398.71871757642305, -394.2720127892398, -612.8076613816388, -436.1057467048829, -298.9865083448611, -712.0889337883602, -181.04082703614935, -433.31089667370196, -380.5534843423781, -11.777951964930956, -4.17860290026679, -457.2271898111421, -146.37058668550583, -302.8631868866194, -126.21076246304816, -369.7523215837804, -354.78332940310975, -960.954806815516, -368.68420115779145, -43.21561282279631, -1005.7430508661638, -211.40670393983828, -637.2794559571208, -1023.33641562953, -264.26286737604124, -969.0243077770915, -109.28414278436229, -129.60864418082062, -349.9448920149839, -852.8630226698272, -409.43242786579475, -520.5011950589534, -939.6822186416416, -706.1548093278875, -224.6754888296271, -647.5366026587219, -177.94241183171576, -63.96917017491664, -120.70356004166064, -449.5265388043745, -315.1698114082311, -833.520165283966, -55.96555855705014, -104.5902721075269, -732.3296255923589, -134.34932358504955, -1079.8255685996032, -646.8129208846915, -116.26598290681335, -818.4655246665108, -33.263514837963676, -107.39075607013103, -534.772530227913, -456.0494289503121, -1077.5753936161657, -286.92343311212704, -789.1721750594703, -716.7505480863149, -195.17492079508983, -135.74511296606735, -787.3797458243359, -33.499703367166504, -69.54329472624335, -570.1501000287733, -1081.8035467209193, -301.9534411859237, -156.0137542017969, -60.48732403599617, -225.07242950402403, -925.9894696743867, -58.414054635212416, -149.69981748034377, -1396.2105844907483, -604.5454400848508, -807.6289705605462, -949.5246828611234, -1106.5498781738997, -202.36455049793514, -91.4379229142108, -148.92630340328964, -865.8203229585487, -19.592816814457667, -1272.0793231511602, -1300.6663119354832, -809.3545598644308, -892.4309085208085, -17.697198681817, -634.2608264787932, -647.9106750410633, -341.0234432538197, -335.47214979720906, -436.7045834304696, -25.240789655345004, -552.8220692377586, -758.5178730509753, -150.5891165648333, -895.6251093144082, -309.8377228120376, -1291.015908762065, -466.2436776972641, -531.9442769230745, -157.20968231543964, -343.61855969459083, -1165.3288575767642, -142.88037181993897, -144.04397937534554, -206.37557805110484, -872.131264077933, -458.7399053411502, -633.8379006829274, -334.09594494884453, -0.20794378028347416, -225.28705045942343, -95.11234305204587, -607.452450715762, -438.8189053011087, -373.338569766976, -226.1831191813215, -325.29075510103576, -1256.8240450552307, -936.9369336974625, -706.352244275134, -708.0361701826935, -1133.2014977227661, -888.4306300687432, -5.305429574874292, -480.58216123475046, -619.0615244462671, -111.13028482934895, -1224.6175644929922, -685.2300010307985, -73.51067064210808, -15.032622226113041, -94.78148053156308, -616.8030206895075, -146.7279829749385, -557.9424044226965, -282.3232441026534, -645.7131917983626, -72.91462346792567, -812.568449826822, -1012.0111031311648, -222.81526129839153, -70.59999787311138, -532.0244057050547, -706.8408353536854, -594.4572869737834, -1015.7385127864501, -1380.5341363206232, -386.0404181267494, -735.7045150872765, -1186.1131546554059, -97.57216631199914, -269.9553530770997, -1055.0329738397636, -1447.5732976561756, -208.40366762760485, -44.414265063697215, -26.70826872563375, -820.4217200482843, -38.66631710270567, -1049.4741395379597, -134.15760486809825, -421.3116107019225, -301.6415931705998, -136.81953868425694, -66.13424063139895, -1088.8221132904828, -11.901524479506854, -409.12544911063, -63.090816304915755, -105.52277977181, -595.5659412416123, -1292.4871109663868, -513.6419416347054, -14.796035971519736, -1017.3617843290941, -761.5618171730615, -864.8093025809324, -134.01070794606372, -268.68163433163653, -537.0580210164619, -1077.7880123841953, -155.4976074705848, -293.3729331616985, -581.4877992918496, -1137.0539637476213, -677.7587234669189, -897.9726184429937]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4962129755332825, "mean_inference_ms": 1.6967094085761125, "mean_action_processing_ms": 0.8028260277939284, "mean_env_wait_ms": 9.99825766116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013161897659301758, "StateBufferConnector_ms": 0.009198188781738281, "ViewRequirementAgentConnector_ms": 0.30019330978393555}, "num_episodes": 29, "episode_return_max": -507.0893449011191, "episode_return_min": -4741.350890933286, "episode_return_mean": -2410.5101857122827, "episodes_this_iter": 29}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 990836, "num_agent_steps_trained": 990836, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 71.55464389801651, "num_env_steps_trained_throughput_per_sec": 71.55464389801651, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 990836, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 990836, "timers": {"training_iteration_time_ms": 54196.936, "restore_workers_time_ms": 0.027, "training_step_time_ms": 54196.862, "sample_time_ms": 3252.961, "learn_time_ms": 50884.276, "learn_throughput": 78.61, "synch_weights_time_ms": 56.551}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 990836, "num_agent_steps_trained": 990836}, "done": false, "training_iteration": 57, "trial_id": "efc54_00000", "date": "2024-07-24_19-31-44", "timestamp": 1721829704, "time_this_iter_s": 55.91290783882141, "time_total_s": 3101.257830142975, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7175141056c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3101.257830142975, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 9.69375, "ram_util_percent": 23.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 115.4709712475619, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.572973786976926, "policy_loss": 0.0005149864885693562, "vf_loss": 4.592301699785682, "vf_explained_var": 0.9845450434419843, "kl": 0.017013329209515014, "entropy": 2.558489761636832, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.99186991869918, "num_grad_updates_lifetime": 234855.5, "diff_num_grad_updates_vs_sampler_policy": 1844.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 1006579, "num_agent_steps_trained": 1006579}, "env_runners": {"episode_reward_max": -539.7045705050989, "episode_reward_min": -4741.350890933286, "episode_reward_mean": -2408.617759529511, "episode_len_mean": 148.16, "episode_media": {}, "episodes_timesteps_total": 14816, "policy_reward_min": {"policy_0": -1457.342944722022}, "policy_reward_max": {"policy_0": -0.20794378028347416}, "policy_reward_mean": {"policy_0": -481.72355190590224}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4043.6426348747164, -2188.5853064582498, -3176.1146524448295, -1190.9829404075015, -1803.3373620961993, -3046.2604199974885, -1861.9685694351556, -2488.603546944624, -1821.7253525566102, -1851.6846438143214, -1779.6372204101476, -2056.0346841266214, -2605.3674122267375, -2566.920688614645, -2411.5270497490865, -2837.7244541727555, -630.5500799918702, -1746.4554385417723, -2858.5091667676543, -4321.958874256471, -2307.1721910123388, -1353.7848105443484, -2653.636950726621, -1683.286811049152, -1916.2037310172204, -2949.906080599159, -2785.028250997675, -4379.869239333892, -539.7045705050989, -2078.3552347676655, -2233.024218334477, -2897.8724423563026, -1983.8502256900588, -1581.210243486282, -4013.301755956987, -2148.226889295783, -2617.8011467139017, -2974.2624833436685, -2005.9806501854507, -922.4175182484659, -2180.3854214232438, -2920.9812392154477, -1822.1248541332998, -3428.633673564103, -1234.8272335366414, -1758.7723461611495, -2709.583421568516, -1949.9417547528328, -3065.596470669166, -1596.3179569125869, -1825.330495648661, -3134.8593663655406, -3157.5060050077154, -3607.085078262941, -3001.6541685869124, -1691.2630353746008, -3405.585730504322, -2664.345054207134, -1824.1710986654714, -1288.541182923524, -1971.0838000662015, -4741.350890933286, -2104.510030153984, -2093.172338923573, -2249.5098439881567, -2190.909435597417, -4229.595177139594, -2675.385607258532, -2782.132472912871, -2464.031392258971, -1605.3190102562444, -2465.7920973953555, -3172.1708816893097, -2173.035983148943, -3587.6460381110815, -2205.6523086445104, -2358.4879990186096, -1948.2619108518734, -2961.4905482322442, -1312.4710553790994, -1675.6285731249407, -2952.2136800496155, -1619.7607300616821, -1963.9292542562912, -1356.137064878906, -2365.1165394397453, -2902.122880890613, -2969.998318367185, -1005.4734978623817, -2221.2574592098435, -1805.9377418615725, -3517.917900200528, -3768.1681838881946, -4113.918760995331, -2334.0124443270015, -1619.0820537988395, -1772.398266687885, -1454.2408063653477, -2901.1210954436924, -3671.3403497458453], "episode_lengths": [150, 150, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 132, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 120, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 134, 150, 150], "policy_policy_0_reward": [-931.0074558895747, -960.2279674642483, -335.52807478648305, -881.9432379316368, -934.9358988027699, -29.74835362149124, -916.8238802467488, -173.11166648873828, -194.50616030531756, -874.3952457959535, -98.72954894830659, -938.6522718946173, -1003.1409813086085, -102.72288349438892, -1032.8689667989097, -35.010024903430384, -31.85254252887949, -790.485171617073, -219.99978804351596, -113.6354133146007, -874.8613405708953, -39.62061197480174, -593.1474412313144, -256.15096848325885, -39.55699983592816, -898.942054001042, -879.4874565485208, -672.5618102958556, -80.36638356868495, -514.9027155833879, -598.2809931927137, -614.0398312791257, -141.83988316198747, -471.81614508947223, -35.99171671185497, -879.226659564304, -10.212000878824107, -815.9971261578421, -668.2315752623031, -114.93618508134787, -634.8199322158679, -939.822788056552, -118.37542186893315, -88.70661342436954, -40.000596990886784, -998.2955589022905, -56.58856081492296, -247.3838455961554, -512.8429508433472, -36.5737276576055, -715.8470814250577, -195.32051614996993, -296.2074829076625, -461.203014824447, -111.05912510301032, -821.8595153675843, -22.45692620471792, -213.91903418790247, -895.5118371036103, -102.28737126280699, -959.6078680691838, -239.2113382389801, -516.8608832581072, -869.6503499002583, -20.03697276020904, -352.57508247512345, -652.0503190067018, -42.70046269761197, -444.24104371414165, -1075.3537807210669, -148.45709222278643, -165.7507210277361, -480.12852442582835, -575.9115150955123, -1041.2791969772243, -303.1920919001735, -1026.0633563435688, -130.70416595104075, -42.5063267190195, -1335.2585132589547, -94.59458350069475, -276.55168766486895, -69.22604794426897, -78.64328579678421, -111.53447508525352, -11.646414753010303, -429.46914236701235, -347.92660553922644, -934.5489322705739, -22.864343611950574, -600.2642786618593, -992.8683039246787, -48.901248553829696, -725.2488361119291, -491.2264995153586, -1011.0263778170624, -956.3143923545027, -864.2461943850188, -877.8826685006579, -612.4892411992288, -973.4339212257258, -214.06503605439005, -883.2131952577843, -192.80135596573402, -43.65868250870591, -28.23963879987869, -745.0715205764819, -210.51094043840368, -212.63766922796447, -157.3250415016188, -254.3569562474284, -543.608620826045, -998.2922387397847, -796.0983810313311, -61.28075388203122, -97.32908632634657, -927.1495070055122, -76.78627402114373, -539.1839954303492, -42.83794826579848, -89.1993016533993, -180.65118021967055, -1457.342944722022, -159.47966739270032, -29.53063702942863, -450.09024576031305, -809.0295760308179, -565.1139939975033, -878.4139675797322, -247.25829723079536, -921.7573813629381, -128.5428974016222, -460.45219126247576, -321.1574641293104, -953.1183168413297, -1082.7300827935446, -843.1971626378788, -897.2743459244674, -839.2350346528405, -717.4326133251587, -126.23343568138463, -36.51870225105336, -78.76402229177839, -23.875201722578787, -274.3132085583039, -371.75682366319427, -21.883669540013823, -346.94438381981087, -76.60366677206187, -1261.1666909725864, -903.7918235784758, -121.33327644674551, -71.9138677545778, -409.3395996448257, -726.6456509098508, -901.7992761412742, -619.8300080175077, -499.95636290159223, -749.4666289553265, -126.82016634060379, -299.5423164561459, -89.82613472299914, -82.56012684753784, -829.4987590230853, -682.4228886402924, -324.4397477249851, -161.1532287977917, -575.4465855660444, -131.08575116331326, -389.0849302341482, -241.94687607115063, -1434.741329892326, -1068.5905902179986, -826.4527789926374, -441.570180782877, -227.8683386115377, -55.392510082473095, -932.3321550253925, -753.2561696997648, -179.3777158766178, -1295.1374921114254, -340.43721755719525, -512.9686349351559, -406.96211021578813, -62.29569189433475, -1132.3583448914871, -398.71871757642305, -394.2720127892398, -612.8076613816388, -436.1057467048829, -298.9865083448611, -712.0889337883602, -181.04082703614935, -433.31089667370196, -380.5534843423781, -11.777951964930956, -4.17860290026679, -457.2271898111421, -146.37058668550583, -302.8631868866194, -126.21076246304816, -369.7523215837804, -354.78332940310975, -960.954806815516, -368.68420115779145, -43.21561282279631, -1005.7430508661638, -211.40670393983828, -637.2794559571208, -1023.33641562953, -264.26286737604124, -969.0243077770915, -109.28414278436229, -129.60864418082062, -349.9448920149839, -852.8630226698272, -409.43242786579475, -520.5011950589534, -939.6822186416416, -706.1548093278875, -224.6754888296271, -647.5366026587219, -177.94241183171576, -63.96917017491664, -120.70356004166064, -449.5265388043745, -315.1698114082311, -833.520165283966, -55.96555855705014, -104.5902721075269, -732.3296255923589, -134.34932358504955, -1079.8255685996032, -646.8129208846915, -116.26598290681335, -818.4655246665108, -33.263514837963676, -107.39075607013103, -534.772530227913, -456.0494289503121, -1077.5753936161657, -286.92343311212704, -789.1721750594703, -716.7505480863149, -195.17492079508983, -135.74511296606735, -787.3797458243359, -33.499703367166504, -69.54329472624335, -570.1501000287733, -1081.8035467209193, -301.9534411859237, -156.0137542017969, -60.48732403599617, -225.07242950402403, -925.9894696743867, -58.414054635212416, -149.69981748034377, -1396.2105844907483, -604.5454400848508, -807.6289705605462, -949.5246828611234, -1106.5498781738997, -202.36455049793514, -91.4379229142108, -148.92630340328964, -865.8203229585487, -19.592816814457667, -1272.0793231511602, -1300.6663119354832, -809.3545598644308, -892.4309085208085, -17.697198681817, -634.2608264787932, -647.9106750410633, -341.0234432538197, -335.47214979720906, -436.7045834304696, -25.240789655345004, -552.8220692377586, -758.5178730509753, -150.5891165648333, -895.6251093144082, -309.8377228120376, -1291.015908762065, -466.2436776972641, -531.9442769230745, -157.20968231543964, -343.61855969459083, -1165.3288575767642, -142.88037181993897, -144.04397937534554, -206.37557805110484, -872.131264077933, -458.7399053411502, -633.8379006829274, -334.09594494884453, -0.20794378028347416, -225.28705045942343, -95.11234305204587, -607.452450715762, -438.8189053011087, -373.338569766976, -226.1831191813215, -325.29075510103576, -1256.8240450552307, -936.9369336974625, -706.352244275134, -708.0361701826935, -1133.2014977227661, -888.4306300687432, -5.305429574874292, -480.58216123475046, -619.0615244462671, -111.13028482934895, -1224.6175644929922, -685.2300010307985, -73.51067064210808, -15.032622226113041, -94.78148053156308, -616.8030206895075, -146.7279829749385, -557.9424044226965, -282.3232441026534, -645.7131917983626, -72.91462346792567, -812.568449826822, -1012.0111031311648, -222.81526129839153, -70.59999787311138, -532.0244057050547, -706.8408353536854, -594.4572869737834, -1015.7385127864501, -1380.5341363206232, -386.0404181267494, -735.7045150872765, -1186.1131546554059, -97.57216631199914, -269.9553530770997, -1055.0329738397636, -1447.5732976561756, -208.40366762760485, -44.414265063697215, -26.70826872563375, -820.4217200482843, -38.66631710270567, -1049.4741395379597, -134.15760486809825, -421.3116107019225, -301.6415931705998, -136.81953868425694, -66.13424063139895, -1088.8221132904828, -11.901524479506854, -409.12544911063, -63.090816304915755, -105.52277977181, -595.5659412416123, -1292.4871109663868, -513.6419416347054, -14.796035971519736, -1017.3617843290941, -761.5618171730615, -864.8093025809324, -134.01070794606372, -268.68163433163653, -537.0580210164619, -1077.7880123841953, -155.4976074705848, -293.3729331616985, -581.4877992918496, -1137.0539637476213, -677.7587234669189, -897.9726184429937, -247.2159861154936, -512.9646854814468, -351.00349910589216, -110.38022940561628, -984.0879085360617, -227.91613048106657, -520.2629691182891, -112.1865272037906, -1124.834084361704, -373.28828785375947, -95.69044328547072, -138.98385726340322, -1188.8744562007448, -225.33025076949275, -299.38290333276, -823.0562452341294, -624.5344352575255, -907.9984497355526, -225.30154921009526, -380.5998687949404, -58.0853279786104, -318.6425283248686, -209.89072970988883, -339.8446167901781, -386.0078525755536, -17.236388434415847, -488.32413629594265, -734.7879739253622, -138.80046991994016, -296.47960454927994, -1216.7975899080236, -799.9115565733192, -785.0017273417204, -33.79031706762518, -116.71248915892616, -259.6678762405359, -146.0280821411695, -444.36460426029385, -433.40075017970605, -336.29941723997746, -595.8660040962768, -1086.297474689432, -31.07836468561647, -209.46141014562048, -41.226000639344676, -492.8809762553604, -25.327089349933868, -280.5191419038153, -93.15073426557359, -464.2591231042236, -320.727455781774, -9.8555974865289, -48.433528169292465, -960.956570586274, -1025.1433874158752, -548.8782096529754, -187.62239723016674, -954.469408380933, -717.0368189187509, -494.1160467077886, -658.693391092109, -1052.679908093528, -193.00006604204142, -50.05426065513344, -1015.5706924843746, -82.1354681456844, -151.24936542878297, -229.89668502434606, -517.1843365603374, -25.00764270323049, -210.54846058014735, -347.01135084212507, -808.2517453177554, -308.71786418278293, -546.7280382870351, -117.06653672415783, -1130.2061559681708, -269.54944736111617, -174.07943279972434, -115.03616900840252, -43.12096718273904, -820.4601663200602, -919.5956143326629, -902.1766492859978, -832.5645030790647, -1279.8637543815237, -1290.3088587123248, -290.5330958437129, -794.6628483745188, -112.79962657611331, -1028.863091382227, -291.3407457559299, -1256.5588431434842, -860.2416135789778, -676.9144671347085, -989.4056319683178, -393.8622576544499, -147.62829163894767, -745.8120121760146, -57.304250889271714, -43.831080831196076, -390.40520041622693, -700.606306447062, -419.82260568004216, -64.41686042431445, -77.36343167718586, -105.11495517006317, -447.3950321264224, -785.4613888672512, -357.0634588469624, -35.26304938639869, -677.4286250844234, -262.66088251584193, -212.34716371177655, -266.5410856669059, -100.40325580307822, -645.3039885785668, -1111.535911521944, -351.51345357372566, -692.3644859663763, -37.97451764040149, -1035.1724714499444, -750.0367223592359, -725.7859232470153, -1122.370715049247]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4933311968070273, "mean_inference_ms": 1.6941274305083809, "mean_action_processing_ms": 0.8012288807547385, "mean_env_wait_ms": 9.974359589385267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012457609176635742, "StateBufferConnector_ms": 0.008910179138183594, "ViewRequirementAgentConnector_ms": 0.29096078872680664}, "num_episodes": 25, "episode_return_max": -539.7045705050989, "episode_return_min": -4741.350890933286, "episode_return_mean": -2408.617759529511, "episodes_this_iter": 25}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1006579, "num_agent_steps_trained": 1006579, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.5014396555354, "num_env_steps_trained_throughput_per_sec": 79.5014396555354, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 1006579, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1006579, "timers": {"training_iteration_time_ms": 53558.979, "restore_workers_time_ms": 0.027, "training_step_time_ms": 53558.905, "sample_time_ms": 3231.561, "learn_time_ms": 50267.465, "learn_throughput": 79.574, "synch_weights_time_ms": 56.824}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 1006579, "num_agent_steps_trained": 1006579}, "done": false, "training_iteration": 58, "trial_id": "efc54_00000", "date": "2024-07-24_19-32-34", "timestamp": 1721829754, "time_this_iter_s": 50.325088024139404, "time_total_s": 3151.5829181671143, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d71ed40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3151.5829181671143, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 9.95492957746479, "ram_util_percent": 23.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 118.71043321125543, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 0.0010000000000000002, "total_loss": 4.608768537507128, "policy_loss": -0.0010990995865092794, "vf_loss": 4.6316625079705345, "vf_explained_var": 0.9850264014592811, "kl": 0.016141226620816473, "entropy": 2.7242530526806465, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.80597014925372, "num_grad_updates_lifetime": 238710.5, "diff_num_grad_updates_vs_sampler_policy": 2009.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 1023705, "num_agent_steps_trained": 1023705}, "env_runners": {"episode_reward_max": -539.7045705050989, "episode_reward_min": -4741.350890933286, "episode_reward_mean": -2437.5505833696106, "episode_len_mean": 148.24, "episode_media": {}, "episodes_timesteps_total": 14824, "policy_reward_min": {"policy_0": -1463.908706751174}, "policy_reward_max": {"policy_0": -0.20794378028347416}, "policy_reward_mean": {"policy_0": -487.5101166739222}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2785.028250997675, -4379.869239333892, -539.7045705050989, -2078.3552347676655, -2233.024218334477, -2897.8724423563026, -1983.8502256900588, -1581.210243486282, -4013.301755956987, -2148.226889295783, -2617.8011467139017, -2974.2624833436685, -2005.9806501854507, -922.4175182484659, -2180.3854214232438, -2920.9812392154477, -1822.1248541332998, -3428.633673564103, -1234.8272335366414, -1758.7723461611495, -2709.583421568516, -1949.9417547528328, -3065.596470669166, -1596.3179569125869, -1825.330495648661, -3134.8593663655406, -3157.5060050077154, -3607.085078262941, -3001.6541685869124, -1691.2630353746008, -3405.585730504322, -2664.345054207134, -1824.1710986654714, -1288.541182923524, -1971.0838000662015, -4741.350890933286, -2104.510030153984, -2093.172338923573, -2249.5098439881567, -2190.909435597417, -4229.595177139594, -2675.385607258532, -2782.132472912871, -2464.031392258971, -1605.3190102562444, -2465.7920973953555, -3172.1708816893097, -2173.035983148943, -3587.6460381110815, -2205.6523086445104, -2358.4879990186096, -1948.2619108518734, -2961.4905482322442, -1312.4710553790994, -1675.6285731249407, -2952.2136800496155, -1619.7607300616821, -1963.9292542562912, -1356.137064878906, -2365.1165394397453, -2902.122880890613, -2969.998318367185, -1005.4734978623817, -2221.2574592098435, -1805.9377418615725, -3517.917900200528, -3768.1681838881946, -4113.918760995331, -2334.0124443270015, -1619.0820537988395, -1772.398266687885, -1454.2408063653477, -2901.1210954436924, -3671.3403497458453, -3168.674784794455, -2306.5197114515263, -2749.260138202045, -1352.254554673893, -3071.2789107970443, -1017.7389384531594, -2994.7238824216606, -3941.7218366884913, -3607.1433994940885, -3049.423018869706, -3093.936072617265, -1713.58093642637, -2265.665776663004, -2252.383339387276, -1471.686748156955, -1809.6753813208802, -2824.556330808141, -1927.1864849451679, -1153.8701938616812, -1561.9545216048223, -1768.4703876527358, -2966.598683088929, -2819.274586516832, -3055.360724800582, -2618.202111608572, -2483.722001540982], "episode_lengths": [150, 150, 110, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 132, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 120, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 134, 150, 150, 150, 150, 150, 147, 150, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-921.7573813629381, -128.5428974016222, -460.45219126247576, -321.1574641293104, -953.1183168413297, -1082.7300827935446, -843.1971626378788, -897.2743459244674, -839.2350346528405, -717.4326133251587, -126.23343568138463, -36.51870225105336, -78.76402229177839, -23.875201722578787, -274.3132085583039, -371.75682366319427, -21.883669540013823, -346.94438381981087, -76.60366677206187, -1261.1666909725864, -903.7918235784758, -121.33327644674551, -71.9138677545778, -409.3395996448257, -726.6456509098508, -901.7992761412742, -619.8300080175077, -499.95636290159223, -749.4666289553265, -126.82016634060379, -299.5423164561459, -89.82613472299914, -82.56012684753784, -829.4987590230853, -682.4228886402924, -324.4397477249851, -161.1532287977917, -575.4465855660444, -131.08575116331326, -389.0849302341482, -241.94687607115063, -1434.741329892326, -1068.5905902179986, -826.4527789926374, -441.570180782877, -227.8683386115377, -55.392510082473095, -932.3321550253925, -753.2561696997648, -179.3777158766178, -1295.1374921114254, -340.43721755719525, -512.9686349351559, -406.96211021578813, -62.29569189433475, -1132.3583448914871, -398.71871757642305, -394.2720127892398, -612.8076613816388, -436.1057467048829, -298.9865083448611, -712.0889337883602, -181.04082703614935, -433.31089667370196, -380.5534843423781, -11.777951964930956, -4.17860290026679, -457.2271898111421, -146.37058668550583, -302.8631868866194, -126.21076246304816, -369.7523215837804, -354.78332940310975, -960.954806815516, -368.68420115779145, -43.21561282279631, -1005.7430508661638, -211.40670393983828, -637.2794559571208, -1023.33641562953, -264.26286737604124, -969.0243077770915, -109.28414278436229, -129.60864418082062, -349.9448920149839, -852.8630226698272, -409.43242786579475, -520.5011950589534, -939.6822186416416, -706.1548093278875, -224.6754888296271, -647.5366026587219, -177.94241183171576, -63.96917017491664, -120.70356004166064, -449.5265388043745, -315.1698114082311, -833.520165283966, -55.96555855705014, -104.5902721075269, -732.3296255923589, -134.34932358504955, -1079.8255685996032, -646.8129208846915, -116.26598290681335, -818.4655246665108, -33.263514837963676, -107.39075607013103, -534.772530227913, -456.0494289503121, -1077.5753936161657, -286.92343311212704, -789.1721750594703, -716.7505480863149, -195.17492079508983, -135.74511296606735, -787.3797458243359, -33.499703367166504, -69.54329472624335, -570.1501000287733, -1081.8035467209193, -301.9534411859237, -156.0137542017969, -60.48732403599617, -225.07242950402403, -925.9894696743867, -58.414054635212416, -149.69981748034377, -1396.2105844907483, -604.5454400848508, -807.6289705605462, -949.5246828611234, -1106.5498781738997, -202.36455049793514, -91.4379229142108, -148.92630340328964, -865.8203229585487, -19.592816814457667, -1272.0793231511602, -1300.6663119354832, -809.3545598644308, -892.4309085208085, -17.697198681817, -634.2608264787932, -647.9106750410633, -341.0234432538197, -335.47214979720906, -436.7045834304696, -25.240789655345004, -552.8220692377586, -758.5178730509753, -150.5891165648333, -895.6251093144082, -309.8377228120376, -1291.015908762065, -466.2436776972641, -531.9442769230745, -157.20968231543964, -343.61855969459083, -1165.3288575767642, -142.88037181993897, -144.04397937534554, -206.37557805110484, -872.131264077933, -458.7399053411502, -633.8379006829274, -334.09594494884453, -0.20794378028347416, -225.28705045942343, -95.11234305204587, -607.452450715762, -438.8189053011087, -373.338569766976, -226.1831191813215, -325.29075510103576, -1256.8240450552307, -936.9369336974625, -706.352244275134, -708.0361701826935, -1133.2014977227661, -888.4306300687432, -5.305429574874292, -480.58216123475046, -619.0615244462671, -111.13028482934895, -1224.6175644929922, -685.2300010307985, -73.51067064210808, -15.032622226113041, -94.78148053156308, -616.8030206895075, -146.7279829749385, -557.9424044226965, -282.3232441026534, -645.7131917983626, -72.91462346792567, -812.568449826822, -1012.0111031311648, -222.81526129839153, -70.59999787311138, -532.0244057050547, -706.8408353536854, -594.4572869737834, -1015.7385127864501, -1380.5341363206232, -386.0404181267494, -735.7045150872765, -1186.1131546554059, -97.57216631199914, -269.9553530770997, -1055.0329738397636, -1447.5732976561756, -208.40366762760485, -44.414265063697215, -26.70826872563375, -820.4217200482843, -38.66631710270567, -1049.4741395379597, -134.15760486809825, -421.3116107019225, -301.6415931705998, -136.81953868425694, -66.13424063139895, -1088.8221132904828, -11.901524479506854, -409.12544911063, -63.090816304915755, -105.52277977181, -595.5659412416123, -1292.4871109663868, -513.6419416347054, -14.796035971519736, -1017.3617843290941, -761.5618171730615, -864.8093025809324, -134.01070794606372, -268.68163433163653, -537.0580210164619, -1077.7880123841953, -155.4976074705848, -293.3729331616985, -581.4877992918496, -1137.0539637476213, -677.7587234669189, -897.9726184429937, -247.2159861154936, -512.9646854814468, -351.00349910589216, -110.38022940561628, -984.0879085360617, -227.91613048106657, -520.2629691182891, -112.1865272037906, -1124.834084361704, -373.28828785375947, -95.69044328547072, -138.98385726340322, -1188.8744562007448, -225.33025076949275, -299.38290333276, -823.0562452341294, -624.5344352575255, -907.9984497355526, -225.30154921009526, -380.5998687949404, -58.0853279786104, -318.6425283248686, -209.89072970988883, -339.8446167901781, -386.0078525755536, -17.236388434415847, -488.32413629594265, -734.7879739253622, -138.80046991994016, -296.47960454927994, -1216.7975899080236, -799.9115565733192, -785.0017273417204, -33.79031706762518, -116.71248915892616, -259.6678762405359, -146.0280821411695, -444.36460426029385, -433.40075017970605, -336.29941723997746, -595.8660040962768, -1086.297474689432, -31.07836468561647, -209.46141014562048, -41.226000639344676, -492.8809762553604, -25.327089349933868, -280.5191419038153, -93.15073426557359, -464.2591231042236, -320.727455781774, -9.8555974865289, -48.433528169292465, -960.956570586274, -1025.1433874158752, -548.8782096529754, -187.62239723016674, -954.469408380933, -717.0368189187509, -494.1160467077886, -658.693391092109, -1052.679908093528, -193.00006604204142, -50.05426065513344, -1015.5706924843746, -82.1354681456844, -151.24936542878297, -229.89668502434606, -517.1843365603374, -25.00764270323049, -210.54846058014735, -347.01135084212507, -808.2517453177554, -308.71786418278293, -546.7280382870351, -117.06653672415783, -1130.2061559681708, -269.54944736111617, -174.07943279972434, -115.03616900840252, -43.12096718273904, -820.4601663200602, -919.5956143326629, -902.1766492859978, -832.5645030790647, -1279.8637543815237, -1290.3088587123248, -290.5330958437129, -794.6628483745188, -112.79962657611331, -1028.863091382227, -291.3407457559299, -1256.5588431434842, -860.2416135789778, -676.9144671347085, -989.4056319683178, -393.8622576544499, -147.62829163894767, -745.8120121760146, -57.304250889271714, -43.831080831196076, -390.40520041622693, -700.606306447062, -419.82260568004216, -64.41686042431445, -77.36343167718586, -105.11495517006317, -447.3950321264224, -785.4613888672512, -357.0634588469624, -35.26304938639869, -677.4286250844234, -262.66088251584193, -212.34716371177655, -266.5410856669059, -100.40325580307822, -645.3039885785668, -1111.535911521944, -351.51345357372566, -692.3644859663763, -37.97451764040149, -1035.1724714499444, -750.0367223592359, -725.7859232470153, -1122.370715049247, -61.70469171286438, -712.3741837079947, -1228.1647399014607, -176.36859708452334, -990.0625723876119, -705.0969949614306, -76.91472400676632, -114.81954551851719, -1330.6479069579161, -79.04054000689652, -229.42249717000922, -90.25816810931808, -116.29910828923289, -1008.7479087897078, -1304.5324558437783, -30.882689963714316, -96.40610363206926, -554.5581372032656, -347.71529139183104, -322.6923324830119, -1278.8249079891166, -472.1887967151229, -171.885632712147, -744.9007306144114, -403.4788427662461, -45.02774852325276, -325.57535606512306, -241.0021415259934, -43.270500466031905, -362.863191872758, -762.7073662869839, -77.34520247200462, -759.7206548359148, -655.3689672393275, -739.5816915874312, -304.8755799399594, -77.00735285723135, -1227.5161589544377, -1362.986853981759, -969.3358909551027, -1010.7905923104635, -723.8268485848171, -551.3015732030996, -410.7557647524344, -910.4686206432744, -73.28036923154029, -1463.908706751174, -385.8123638532467, -92.45104106190728, -1033.9705379718328, -938.0306354616188, -1034.2697290547399, -117.44756351042442, -109.32147160222245, -894.8666729882559, -138.21265869529103, -298.4402106833759, -403.33716105441334, -18.747221550028584, -854.8436844432598, -212.55565441095854, -380.85925999186964, -42.30561674882127, -1018.7617460469444, -611.1834994644083, -369.41741976322646, -191.29175302276693, -731.1006919356155, -684.0344577739784, -276.5390168916935, -10.898320451218726, -641.8137711750779, -623.7982593446035, -2.594920884294719, -192.58147630176035, -316.85558737832616, -421.275398938707, -767.4112502149673, -277.7022470520133, -26.4308977368676, -436.38261546884513, -250.09025298322237, -1063.2887227580907, -76.53804886577223, -998.2566907322108, -498.9337463976404, -174.50281035238987, -169.89197466213167, -1063.2042179076336, -20.653735625372875, -78.66716893470023, -278.00424352013744, -220.02293367916823, -451.2844871890603, -125.89136053861624, -690.5363836691387, -131.7445357196525, -398.82057036530745, -276.6760304430832, -64.17700140764074, -78.71258991496077, -277.91145707368673, -865.8500142372648, -502.3597063986846, -43.636620028139326, -807.4205801766396, -985.772429805124, -68.56541074817942, -1017.7935634259695, -87.04669893301799, -28.232689032200895, -616.0449497643679, -730.6276182065463, -692.2607039797185, -752.1086255340039, -658.815078161823, -369.54895081707326, -1052.5560249627085, -517.2630219982856, -457.1776488606931, -868.3721965207232, -687.4074350207004, -577.6271246454022, -48.564560122575124, -436.2307952991718, -159.48822528183308, -1115.7046923132932, -27.836607405436165, -731.7887765218176, -448.90370001860003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4936472913738863, "mean_inference_ms": 1.6948260928801873, "mean_action_processing_ms": 0.7997387367288846, "mean_env_wait_ms": 9.977311154923129, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012394189834594727, "StateBufferConnector_ms": 0.008978128433227539, "ViewRequirementAgentConnector_ms": 0.2943904399871826}, "num_episodes": 26, "episode_return_max": -539.7045705050989, "episode_return_min": -4741.350890933286, "episode_return_mean": -2437.5505833696106, "episodes_this_iter": 26}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1023705, "num_agent_steps_trained": 1023705, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 71.81334195613113, "num_env_steps_trained_throughput_per_sec": 71.81334195613113, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 1023705, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1023705, "timers": {"training_iteration_time_ms": 53709.145, "restore_workers_time_ms": 0.027, "training_step_time_ms": 53709.072, "sample_time_ms": 3225.385, "learn_time_ms": 50423.451, "learn_throughput": 79.328, "synch_weights_time_ms": 57.189}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 1023705, "num_agent_steps_trained": 1023705}, "done": false, "training_iteration": 59, "trial_id": "efc54_00000", "date": "2024-07-24_19-33-30", "timestamp": 1721829810, "time_this_iter_s": 55.71225309371948, "time_total_s": 3207.2951712608337, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7175141070a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3207.2951712608337, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 9.751898734177216, "ram_util_percent": 23.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 123.71502110281108, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.553712184988422, "policy_loss": 0.00021917747690077918, "vf_loss": 4.574287011888292, "vf_explained_var": 0.9799011526431567, "kl": 0.017162843837322278, "entropy": 2.6586463573832573, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.25925925925925, "num_grad_updates_lifetime": 242745.5, "diff_num_grad_updates_vs_sampler_policy": 2024.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 1040885, "num_agent_steps_trained": 1040885}, "env_runners": {"episode_reward_max": -1005.4734978623817, "episode_reward_min": -4741.350890933286, "episode_reward_mean": -2478.900468902823, "episode_len_mean": 148.3, "episode_media": {}, "episodes_timesteps_total": 14830, "policy_reward_min": {"policy_0": -1502.8696659553793}, "policy_reward_max": {"policy_0": -0.20794378028347416}, "policy_reward_mean": {"policy_0": -495.78009378056464}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1691.2630353746008, -3405.585730504322, -2664.345054207134, -1824.1710986654714, -1288.541182923524, -1971.0838000662015, -4741.350890933286, -2104.510030153984, -2093.172338923573, -2249.5098439881567, -2190.909435597417, -4229.595177139594, -2675.385607258532, -2782.132472912871, -2464.031392258971, -1605.3190102562444, -2465.7920973953555, -3172.1708816893097, -2173.035983148943, -3587.6460381110815, -2205.6523086445104, -2358.4879990186096, -1948.2619108518734, -2961.4905482322442, -1312.4710553790994, -1675.6285731249407, -2952.2136800496155, -1619.7607300616821, -1963.9292542562912, -1356.137064878906, -2365.1165394397453, -2902.122880890613, -2969.998318367185, -1005.4734978623817, -2221.2574592098435, -1805.9377418615725, -3517.917900200528, -3768.1681838881946, -4113.918760995331, -2334.0124443270015, -1619.0820537988395, -1772.398266687885, -1454.2408063653477, -2901.1210954436924, -3671.3403497458453, -3168.674784794455, -2306.5197114515263, -2749.260138202045, -1352.254554673893, -3071.2789107970443, -1017.7389384531594, -2994.7238824216606, -3941.7218366884913, -3607.1433994940885, -3049.423018869706, -3093.936072617265, -1713.58093642637, -2265.665776663004, -2252.383339387276, -1471.686748156955, -1809.6753813208802, -2824.556330808141, -1927.1864849451679, -1153.8701938616812, -1561.9545216048223, -1768.4703876527358, -2966.598683088929, -2819.274586516832, -3055.360724800582, -2618.202111608572, -2483.722001540982, -1642.0835618501394, -2441.99983131908, -2151.8627385550585, -2844.301723426804, -2167.9148819308534, -2372.392066837414, -3389.072491531135, -2553.6551051132683, -1385.7017601376294, -3929.839412186928, -2996.2238887289195, -2140.9281792809784, -2016.6216876787903, -2914.8139246943733, -1901.2482519967307, -3625.0889425333235, -2204.066276715062, -2223.9117384884594, -3379.537323949088, -2504.109987365448, -1240.6922278218585, -3303.060397070913, -1618.818604669827, -2929.3049904452905, -4085.77915325513, -2022.619355822499, -2673.7038567146274, -3226.8738750713446, -2803.2666731547347], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 120, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 134, 150, 150, 150, 150, 150, 147, 150, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-341.0234432538197, -335.47214979720906, -436.7045834304696, -25.240789655345004, -552.8220692377586, -758.5178730509753, -150.5891165648333, -895.6251093144082, -309.8377228120376, -1291.015908762065, -466.2436776972641, -531.9442769230745, -157.20968231543964, -343.61855969459083, -1165.3288575767642, -142.88037181993897, -144.04397937534554, -206.37557805110484, -872.131264077933, -458.7399053411502, -633.8379006829274, -334.09594494884453, -0.20794378028347416, -225.28705045942343, -95.11234305204587, -607.452450715762, -438.8189053011087, -373.338569766976, -226.1831191813215, -325.29075510103576, -1256.8240450552307, -936.9369336974625, -706.352244275134, -708.0361701826935, -1133.2014977227661, -888.4306300687432, -5.305429574874292, -480.58216123475046, -619.0615244462671, -111.13028482934895, -1224.6175644929922, -685.2300010307985, -73.51067064210808, -15.032622226113041, -94.78148053156308, -616.8030206895075, -146.7279829749385, -557.9424044226965, -282.3232441026534, -645.7131917983626, -72.91462346792567, -812.568449826822, -1012.0111031311648, -222.81526129839153, -70.59999787311138, -532.0244057050547, -706.8408353536854, -594.4572869737834, -1015.7385127864501, -1380.5341363206232, -386.0404181267494, -735.7045150872765, -1186.1131546554059, -97.57216631199914, -269.9553530770997, -1055.0329738397636, -1447.5732976561756, -208.40366762760485, -44.414265063697215, -26.70826872563375, -820.4217200482843, -38.66631710270567, -1049.4741395379597, -134.15760486809825, -421.3116107019225, -301.6415931705998, -136.81953868425694, -66.13424063139895, -1088.8221132904828, -11.901524479506854, -409.12544911063, -63.090816304915755, -105.52277977181, -595.5659412416123, -1292.4871109663868, -513.6419416347054, -14.796035971519736, -1017.3617843290941, -761.5618171730615, -864.8093025809324, -134.01070794606372, -268.68163433163653, -537.0580210164619, -1077.7880123841953, -155.4976074705848, -293.3729331616985, -581.4877992918496, -1137.0539637476213, -677.7587234669189, -897.9726184429937, -247.2159861154936, -512.9646854814468, -351.00349910589216, -110.38022940561628, -984.0879085360617, -227.91613048106657, -520.2629691182891, -112.1865272037906, -1124.834084361704, -373.28828785375947, -95.69044328547072, -138.98385726340322, -1188.8744562007448, -225.33025076949275, -299.38290333276, -823.0562452341294, -624.5344352575255, -907.9984497355526, -225.30154921009526, -380.5998687949404, -58.0853279786104, -318.6425283248686, -209.89072970988883, -339.8446167901781, -386.0078525755536, -17.236388434415847, -488.32413629594265, -734.7879739253622, -138.80046991994016, -296.47960454927994, -1216.7975899080236, -799.9115565733192, -785.0017273417204, -33.79031706762518, -116.71248915892616, -259.6678762405359, -146.0280821411695, -444.36460426029385, -433.40075017970605, -336.29941723997746, -595.8660040962768, -1086.297474689432, -31.07836468561647, -209.46141014562048, -41.226000639344676, -492.8809762553604, -25.327089349933868, -280.5191419038153, -93.15073426557359, -464.2591231042236, -320.727455781774, -9.8555974865289, -48.433528169292465, -960.956570586274, -1025.1433874158752, -548.8782096529754, -187.62239723016674, -954.469408380933, -717.0368189187509, -494.1160467077886, -658.693391092109, -1052.679908093528, -193.00006604204142, -50.05426065513344, -1015.5706924843746, -82.1354681456844, -151.24936542878297, -229.89668502434606, -517.1843365603374, -25.00764270323049, -210.54846058014735, -347.01135084212507, -808.2517453177554, -308.71786418278293, -546.7280382870351, -117.06653672415783, -1130.2061559681708, -269.54944736111617, -174.07943279972434, -115.03616900840252, -43.12096718273904, -820.4601663200602, -919.5956143326629, -902.1766492859978, -832.5645030790647, -1279.8637543815237, -1290.3088587123248, -290.5330958437129, -794.6628483745188, -112.79962657611331, -1028.863091382227, -291.3407457559299, -1256.5588431434842, -860.2416135789778, -676.9144671347085, -989.4056319683178, -393.8622576544499, -147.62829163894767, -745.8120121760146, -57.304250889271714, -43.831080831196076, -390.40520041622693, -700.606306447062, -419.82260568004216, -64.41686042431445, -77.36343167718586, -105.11495517006317, -447.3950321264224, -785.4613888672512, -357.0634588469624, -35.26304938639869, -677.4286250844234, -262.66088251584193, -212.34716371177655, -266.5410856669059, -100.40325580307822, -645.3039885785668, -1111.535911521944, -351.51345357372566, -692.3644859663763, -37.97451764040149, -1035.1724714499444, -750.0367223592359, -725.7859232470153, -1122.370715049247, -61.70469171286438, -712.3741837079947, -1228.1647399014607, -176.36859708452334, -990.0625723876119, -705.0969949614306, -76.91472400676632, -114.81954551851719, -1330.6479069579161, -79.04054000689652, -229.42249717000922, -90.25816810931808, -116.29910828923289, -1008.7479087897078, -1304.5324558437783, -30.882689963714316, -96.40610363206926, -554.5581372032656, -347.71529139183104, -322.6923324830119, -1278.8249079891166, -472.1887967151229, -171.885632712147, -744.9007306144114, -403.4788427662461, -45.02774852325276, -325.57535606512306, -241.0021415259934, -43.270500466031905, -362.863191872758, -762.7073662869839, -77.34520247200462, -759.7206548359148, -655.3689672393275, -739.5816915874312, -304.8755799399594, -77.00735285723135, -1227.5161589544377, -1362.986853981759, -969.3358909551027, -1010.7905923104635, -723.8268485848171, -551.3015732030996, -410.7557647524344, -910.4686206432744, -73.28036923154029, -1463.908706751174, -385.8123638532467, -92.45104106190728, -1033.9705379718328, -938.0306354616188, -1034.2697290547399, -117.44756351042442, -109.32147160222245, -894.8666729882559, -138.21265869529103, -298.4402106833759, -403.33716105441334, -18.747221550028584, -854.8436844432598, -212.55565441095854, -380.85925999186964, -42.30561674882127, -1018.7617460469444, -611.1834994644083, -369.41741976322646, -191.29175302276693, -731.1006919356155, -684.0344577739784, -276.5390168916935, -10.898320451218726, -641.8137711750779, -623.7982593446035, -2.594920884294719, -192.58147630176035, -316.85558737832616, -421.275398938707, -767.4112502149673, -277.7022470520133, -26.4308977368676, -436.38261546884513, -250.09025298322237, -1063.2887227580907, -76.53804886577223, -998.2566907322108, -498.9337463976404, -174.50281035238987, -169.89197466213167, -1063.2042179076336, -20.653735625372875, -78.66716893470023, -278.00424352013744, -220.02293367916823, -451.2844871890603, -125.89136053861624, -690.5363836691387, -131.7445357196525, -398.82057036530745, -276.6760304430832, -64.17700140764074, -78.71258991496077, -277.91145707368673, -865.8500142372648, -502.3597063986846, -43.636620028139326, -807.4205801766396, -985.772429805124, -68.56541074817942, -1017.7935634259695, -87.04669893301799, -28.232689032200895, -616.0449497643679, -730.6276182065463, -692.2607039797185, -752.1086255340039, -658.815078161823, -369.54895081707326, -1052.5560249627085, -517.2630219982856, -457.1776488606931, -868.3721965207232, -687.4074350207004, -577.6271246454022, -48.564560122575124, -436.2307952991718, -159.48822528183308, -1115.7046923132932, -27.836607405436165, -731.7887765218176, -448.90370001860003, -366.0397786636347, -7.276457345240264, -121.01360716186139, -1053.2311183329205, -94.52260034648252, -558.3094295384888, -24.80752363630074, -829.1046758114339, -997.5836469728854, -32.1945553599704, -669.938099399503, -28.73255061812554, -215.5556459109789, -537.6126122177972, -700.0238304086535, -251.73318858238727, -551.2552384932098, -1250.8748405321035, -748.5822111865173, -41.856244632588485, -140.2249576884737, -946.5075205306824, -20.517752596747886, -888.2349533958896, -172.42969771905737, -367.9358970894125, -360.64988924878134, -94.19270169710818, -716.9694640008328, -832.6441148012794, -1325.041209039572, -579.5534282931412, -36.25675851681672, -1180.1995573228176, -268.02153835878966, -104.88456135068598, -1173.4583673376903, -816.3436092587752, -133.13791792341948, -325.83064924269695, -128.34279607372108, -235.4752687546426, -719.8450105165, -76.71231365463424, -225.32637113813175, -590.5737989310999, -20.380189476911806, -1070.3047841371013, -1148.7141743148377, -1099.8664653269725, -44.176019081091106, -985.1849848760178, -80.39057220503682, -580.9533760060511, -1305.5189365607212, -463.69180784771044, -460.9718741092807, -124.22179235806897, -746.048279336138, -345.99442562978226, -89.99366206202825, -89.34231956785935, -624.9608130324023, -58.48629433550629, -1153.838598680995, -35.97741183842519, -1188.4533902399962, -154.3446645702708, -643.5600246040234, -892.478433441658, -845.2616264024161, -342.8201723053621, -186.2968588324575, -416.4703303155458, -110.39926414094948, -1104.1846559834357, -328.4940317219168, -132.87787324970483, -835.9131933049903, -1223.6191882732771, -146.53346015721817, -165.31857337368257, -101.92801983380765, -1462.1937802356376, -328.0924431147163, -625.3909792293529, -911.8959081941449, -173.98748178091031, -176.2503861587726, -336.38698312527885, -189.85651857778518, -1295.7879497017489, -1360.9273197411221, -49.049617867461905, -483.9159180609726, -671.986091311049, -483.558696915512, -572.1335264242432, -696.1604732177319, -80.27119949691152, -225.5097912343153, -428.74678994126157, -76.22075200269005, -401.5413835057716, -108.67351113781984, -1108.1930325899605, -408.9464149696796, -908.1219241181624, -561.9038603199202, -315.89516507318916, -317.35013717665254, -237.89912188596261, -578.7742330106689, -129.13222850477683, -355.662884091767, -295.5564526178159, -97.57662996188525, -907.587998023367, -559.2975434877735, -1069.286366354446, -474.7458329553015, -1134.0912578799116, -349.40237911914386, -624.6700173453963, -1502.8696659553793, -352.48061355479064, -192.6854744678303, -778.0878610694974, -122.71076451158035, -576.6546422188019, -117.66097823344577, -942.9415178440239, -528.6588242086024, -735.1111587352251, -349.33137769332785, -180.89418440773102, -693.3908974609678, -922.3619067060498, -596.8531589552683, -833.3737275413287, -100.88507384259842, -852.2307401949057, -470.36262895542916, -937.8150960868941, -441.97313407490526]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4911928191569317, "mean_inference_ms": 1.694270736183251, "mean_action_processing_ms": 0.7985043757453383, "mean_env_wait_ms": 9.966300631453715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012787580490112305, "StateBufferConnector_ms": 0.009201288223266602, "ViewRequirementAgentConnector_ms": 0.29997873306274414}, "num_episodes": 29, "episode_return_max": -1005.4734978623817, "episode_return_min": -4741.350890933286, "episode_return_mean": -2478.900468902823, "episodes_this_iter": 29}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040885, "num_agent_steps_trained": 1040885, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.49423749977737, "num_env_steps_trained_throughput_per_sec": 77.49423749977737, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 1040885, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040885, "timers": {"training_iteration_time_ms": 53574.485, "restore_workers_time_ms": 0.027, "training_step_time_ms": 53574.412, "sample_time_ms": 3235.64, "learn_time_ms": 50278.281, "learn_throughput": 79.557, "synch_weights_time_ms": 57.441}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 1040885, "num_agent_steps_trained": 1040885}, "done": false, "training_iteration": 60, "trial_id": "efc54_00000", "date": "2024-07-24_19-34-21", "timestamp": 1721829861, "time_this_iter_s": 51.62844181060791, "time_total_s": 3258.9236130714417, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7175141052d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3258.9236130714417, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 10.191891891891892, "ram_util_percent": 23.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 129.03798326204222, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.43279301704218, "policy_loss": -0.00021475661924341694, "vf_loss": 4.454217519114414, "vf_explained_var": 0.9849674994902065, "kl": 0.017697333336370018, "entropy": 2.7182595572123924, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 246690.5, "diff_num_grad_updates_vs_sampler_policy": 1919.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 1057269, "num_agent_steps_trained": 1057269}, "env_runners": {"episode_reward_max": -1005.4734978623817, "episode_reward_min": -4113.918760995331, "episode_reward_mean": -2504.8887449714516, "episode_len_mean": 148.6, "episode_media": {}, "episodes_timesteps_total": 14860, "policy_reward_min": {"policy_0": -1502.8696659553793}, "policy_reward_max": {"policy_0": 1.9639725468003315}, "policy_reward_mean": {"policy_0": -500.9777489942903}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2952.2136800496155, -1619.7607300616821, -1963.9292542562912, -1356.137064878906, -2365.1165394397453, -2902.122880890613, -2969.998318367185, -1005.4734978623817, -2221.2574592098435, -1805.9377418615725, -3517.917900200528, -3768.1681838881946, -4113.918760995331, -2334.0124443270015, -1619.0820537988395, -1772.398266687885, -1454.2408063653477, -2901.1210954436924, -3671.3403497458453, -3168.674784794455, -2306.5197114515263, -2749.260138202045, -1352.254554673893, -3071.2789107970443, -1017.7389384531594, -2994.7238824216606, -3941.7218366884913, -3607.1433994940885, -3049.423018869706, -3093.936072617265, -1713.58093642637, -2265.665776663004, -2252.383339387276, -1471.686748156955, -1809.6753813208802, -2824.556330808141, -1927.1864849451679, -1153.8701938616812, -1561.9545216048223, -1768.4703876527358, -2966.598683088929, -2819.274586516832, -3055.360724800582, -2618.202111608572, -2483.722001540982, -1642.0835618501394, -2441.99983131908, -2151.8627385550585, -2844.301723426804, -2167.9148819308534, -2372.392066837414, -3389.072491531135, -2553.6551051132683, -1385.7017601376294, -3929.839412186928, -2996.2238887289195, -2140.9281792809784, -2016.6216876787903, -2914.8139246943733, -1901.2482519967307, -3625.0889425333235, -2204.066276715062, -2223.9117384884594, -3379.537323949088, -2504.109987365448, -1240.6922278218585, -3303.060397070913, -1618.818604669827, -2929.3049904452905, -4085.77915325513, -2022.619355822499, -2673.7038567146274, -3226.8738750713446, -2803.2666731547347, -3151.802785972039, -2694.188966160434, -2412.463041294293, -1971.6652838818904, -2049.8329116194855, -1410.725137564526, -3238.712924958316, -1628.721090611422, -4003.2583750526737, -1614.0075127267087, -3102.287549389591, -2895.6769194772655, -2113.3211215808215, -2147.329166325326, -3133.7453271120253, -2027.3069636284001, -3159.2753450152236, -2106.802622215693, -3412.452793115583, -1494.9995910559965, -2646.529947983477, -3214.0230310539346, -2613.764615888188, -3464.0129775153646, -3084.5120358970494, -1648.9530665269558], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 134, 150, 150, 150, 150, 150, 147, 150, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1216.7975899080236, -799.9115565733192, -785.0017273417204, -33.79031706762518, -116.71248915892616, -259.6678762405359, -146.0280821411695, -444.36460426029385, -433.40075017970605, -336.29941723997746, -595.8660040962768, -1086.297474689432, -31.07836468561647, -209.46141014562048, -41.226000639344676, -492.8809762553604, -25.327089349933868, -280.5191419038153, -93.15073426557359, -464.2591231042236, -320.727455781774, -9.8555974865289, -48.433528169292465, -960.956570586274, -1025.1433874158752, -548.8782096529754, -187.62239723016674, -954.469408380933, -717.0368189187509, -494.1160467077886, -658.693391092109, -1052.679908093528, -193.00006604204142, -50.05426065513344, -1015.5706924843746, -82.1354681456844, -151.24936542878297, -229.89668502434606, -517.1843365603374, -25.00764270323049, -210.54846058014735, -347.01135084212507, -808.2517453177554, -308.71786418278293, -546.7280382870351, -117.06653672415783, -1130.2061559681708, -269.54944736111617, -174.07943279972434, -115.03616900840252, -43.12096718273904, -820.4601663200602, -919.5956143326629, -902.1766492859978, -832.5645030790647, -1279.8637543815237, -1290.3088587123248, -290.5330958437129, -794.6628483745188, -112.79962657611331, -1028.863091382227, -291.3407457559299, -1256.5588431434842, -860.2416135789778, -676.9144671347085, -989.4056319683178, -393.8622576544499, -147.62829163894767, -745.8120121760146, -57.304250889271714, -43.831080831196076, -390.40520041622693, -700.606306447062, -419.82260568004216, -64.41686042431445, -77.36343167718586, -105.11495517006317, -447.3950321264224, -785.4613888672512, -357.0634588469624, -35.26304938639869, -677.4286250844234, -262.66088251584193, -212.34716371177655, -266.5410856669059, -100.40325580307822, -645.3039885785668, -1111.535911521944, -351.51345357372566, -692.3644859663763, -37.97451764040149, -1035.1724714499444, -750.0367223592359, -725.7859232470153, -1122.370715049247, -61.70469171286438, -712.3741837079947, -1228.1647399014607, -176.36859708452334, -990.0625723876119, -705.0969949614306, -76.91472400676632, -114.81954551851719, -1330.6479069579161, -79.04054000689652, -229.42249717000922, -90.25816810931808, -116.29910828923289, -1008.7479087897078, -1304.5324558437783, -30.882689963714316, -96.40610363206926, -554.5581372032656, -347.71529139183104, -322.6923324830119, -1278.8249079891166, -472.1887967151229, -171.885632712147, -744.9007306144114, -403.4788427662461, -45.02774852325276, -325.57535606512306, -241.0021415259934, -43.270500466031905, -362.863191872758, -762.7073662869839, -77.34520247200462, -759.7206548359148, -655.3689672393275, -739.5816915874312, -304.8755799399594, -77.00735285723135, -1227.5161589544377, -1362.986853981759, -969.3358909551027, -1010.7905923104635, -723.8268485848171, -551.3015732030996, -410.7557647524344, -910.4686206432744, -73.28036923154029, -1463.908706751174, -385.8123638532467, -92.45104106190728, -1033.9705379718328, -938.0306354616188, -1034.2697290547399, -117.44756351042442, -109.32147160222245, -894.8666729882559, -138.21265869529103, -298.4402106833759, -403.33716105441334, -18.747221550028584, -854.8436844432598, -212.55565441095854, -380.85925999186964, -42.30561674882127, -1018.7617460469444, -611.1834994644083, -369.41741976322646, -191.29175302276693, -731.1006919356155, -684.0344577739784, -276.5390168916935, -10.898320451218726, -641.8137711750779, -623.7982593446035, -2.594920884294719, -192.58147630176035, -316.85558737832616, -421.275398938707, -767.4112502149673, -277.7022470520133, -26.4308977368676, -436.38261546884513, -250.09025298322237, -1063.2887227580907, -76.53804886577223, -998.2566907322108, -498.9337463976404, -174.50281035238987, -169.89197466213167, -1063.2042179076336, -20.653735625372875, -78.66716893470023, -278.00424352013744, -220.02293367916823, -451.2844871890603, -125.89136053861624, -690.5363836691387, -131.7445357196525, -398.82057036530745, -276.6760304430832, -64.17700140764074, -78.71258991496077, -277.91145707368673, -865.8500142372648, -502.3597063986846, -43.636620028139326, -807.4205801766396, -985.772429805124, -68.56541074817942, -1017.7935634259695, -87.04669893301799, -28.232689032200895, -616.0449497643679, -730.6276182065463, -692.2607039797185, -752.1086255340039, -658.815078161823, -369.54895081707326, -1052.5560249627085, -517.2630219982856, -457.1776488606931, -868.3721965207232, -687.4074350207004, -577.6271246454022, -48.564560122575124, -436.2307952991718, -159.48822528183308, -1115.7046923132932, -27.836607405436165, -731.7887765218176, -448.90370001860003, -366.0397786636347, -7.276457345240264, -121.01360716186139, -1053.2311183329205, -94.52260034648252, -558.3094295384888, -24.80752363630074, -829.1046758114339, -997.5836469728854, -32.1945553599704, -669.938099399503, -28.73255061812554, -215.5556459109789, -537.6126122177972, -700.0238304086535, -251.73318858238727, -551.2552384932098, -1250.8748405321035, -748.5822111865173, -41.856244632588485, -140.2249576884737, -946.5075205306824, -20.517752596747886, -888.2349533958896, -172.42969771905737, -367.9358970894125, -360.64988924878134, -94.19270169710818, -716.9694640008328, -832.6441148012794, -1325.041209039572, -579.5534282931412, -36.25675851681672, -1180.1995573228176, -268.02153835878966, -104.88456135068598, -1173.4583673376903, -816.3436092587752, -133.13791792341948, -325.83064924269695, -128.34279607372108, -235.4752687546426, -719.8450105165, -76.71231365463424, -225.32637113813175, -590.5737989310999, -20.380189476911806, -1070.3047841371013, -1148.7141743148377, -1099.8664653269725, -44.176019081091106, -985.1849848760178, -80.39057220503682, -580.9533760060511, -1305.5189365607212, -463.69180784771044, -460.9718741092807, -124.22179235806897, -746.048279336138, -345.99442562978226, -89.99366206202825, -89.34231956785935, -624.9608130324023, -58.48629433550629, -1153.838598680995, -35.97741183842519, -1188.4533902399962, -154.3446645702708, -643.5600246040234, -892.478433441658, -845.2616264024161, -342.8201723053621, -186.2968588324575, -416.4703303155458, -110.39926414094948, -1104.1846559834357, -328.4940317219168, -132.87787324970483, -835.9131933049903, -1223.6191882732771, -146.53346015721817, -165.31857337368257, -101.92801983380765, -1462.1937802356376, -328.0924431147163, -625.3909792293529, -911.8959081941449, -173.98748178091031, -176.2503861587726, -336.38698312527885, -189.85651857778518, -1295.7879497017489, -1360.9273197411221, -49.049617867461905, -483.9159180609726, -671.986091311049, -483.558696915512, -572.1335264242432, -696.1604732177319, -80.27119949691152, -225.5097912343153, -428.74678994126157, -76.22075200269005, -401.5413835057716, -108.67351113781984, -1108.1930325899605, -408.9464149696796, -908.1219241181624, -561.9038603199202, -315.89516507318916, -317.35013717665254, -237.89912188596261, -578.7742330106689, -129.13222850477683, -355.662884091767, -295.5564526178159, -97.57662996188525, -907.587998023367, -559.2975434877735, -1069.286366354446, -474.7458329553015, -1134.0912578799116, -349.40237911914386, -624.6700173453963, -1502.8696659553793, -352.48061355479064, -192.6854744678303, -778.0878610694974, -122.71076451158035, -576.6546422188019, -117.66097823344577, -942.9415178440239, -528.6588242086024, -735.1111587352251, -349.33137769332785, -180.89418440773102, -693.3908974609678, -922.3619067060498, -596.8531589552683, -833.3737275413287, -100.88507384259842, -852.2307401949057, -470.36262895542916, -937.8150960868941, -441.97313407490526, -596.7964199344065, -329.08777242649046, -893.1223210057512, -831.8267647804012, -500.9695078249889, -357.2923321802792, -1062.0352601788636, -43.16890006809043, -1108.324260597312, -123.36821313588712, -76.90875892753733, -262.7562363432376, -192.50181504944663, -1133.7875681276437, -746.5086628464262, -699.8869675102809, -140.88808724292724, -233.990572224283, -165.87902850280557, -731.0206284015944, -419.83577647197353, -184.2430625278768, -380.6309132120443, -297.4875283621749, -767.6356310454158, -780.0765909975463, -59.50379027014309, -344.25548876182546, -128.8293052134455, -98.05996232156528, -302.3756711200048, -589.3697831009506, -972.5275159667852, -1179.7054581660223, -194.734496604556, -409.30882403231533, -102.34660285370875, -171.78483986442265, -409.9770378695686, -535.3037859914069, -1281.3151215990972, -991.4349361448714, -1124.0900344602078, -170.38904875551077, -436.0292340929866, 1.9639725468003315, -119.21286684631528, -228.9037159806675, -1180.2797785016303, -87.575123944895, -828.1312848784016, -717.7342208113971, -406.2625378550956, -376.8831601301662, -773.2763457145298, -62.31701950916877, -451.84319677656765, -48.31080254237742, -1189.8591997559831, -1143.3467008931673, -339.01639611537854, -98.89698127603059, -1154.631521751466, -159.42654265105392, -361.34967978689235, -100.70225208468108, -79.40309963198125, -674.021363720247, -570.2927116845063, -722.9097392039098, -171.38206946146514, -213.9180575689156, -997.4086541073275, -996.9828212010108, -754.0537247733045, -569.8143298461019, -249.10269724085364, -96.73384130359914, -386.28541027443293, -725.3706849634093, -1218.2681506543424, -421.17332801389006, -91.11831027685719, -1205.9907616322157, -222.72479443791988, -177.8702805874573, -720.2258535025987, -184.30923644091067, -973.0034492044854, -51.39380248024087, -747.2716906222012, -679.6008137356398, -97.841684242662, -807.5193729306959, -1080.2192315843874, -38.75290946310987, -267.0178071956968, -241.91953701588932, -65.60849347310652, -881.7008439081933, -454.83719926629544, -40.60229798308116, -1070.0682609856424, -72.58964040698874, -1008.4325493414682, -167.52760744714521, -845.830586615306, -1027.974018697185, -815.4610587797365, -357.2297595145597, -315.4408842238341, -410.2420769831627, -1009.6030634290946, -837.7196335135307, -40.75895773856746, -605.2655166195789, -738.105587848847, -1061.306274323687, -648.2172867828025, -411.1183119404477, -616.5304026448922, -564.8654389711993, -1247.4536301137407, -472.95236837368435, -182.7101957935296, -70.01941360588516, -556.4379413079498, -650.7165691236111, -133.28977194144844, -238.48937054806171]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4881524650552083, "mean_inference_ms": 1.6909396508568508, "mean_action_processing_ms": 0.7964562777743197, "mean_env_wait_ms": 9.940642695556068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012403249740600586, "StateBufferConnector_ms": 0.009299516677856445, "ViewRequirementAgentConnector_ms": 0.3036625385284424}, "num_episodes": 26, "episode_return_max": -1005.4734978623817, "episode_return_min": -4113.918760995331, "episode_return_mean": -2504.8887449714516, "episodes_this_iter": 26}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1057269, "num_agent_steps_trained": 1057269, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 75.41113767215275, "num_env_steps_trained_throughput_per_sec": 75.41113767215275, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 1057269, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1057269, "timers": {"training_iteration_time_ms": 53631.608, "restore_workers_time_ms": 0.027, "training_step_time_ms": 53631.536, "sample_time_ms": 3223.841, "learn_time_ms": 50348.755, "learn_throughput": 79.446, "synch_weights_time_ms": 56.013}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 1057269, "num_agent_steps_trained": 1057269}, "done": false, "training_iteration": 61, "trial_id": "efc54_00000", "date": "2024-07-24_19-35-14", "timestamp": 1721829914, "time_this_iter_s": 53.05467653274536, "time_total_s": 3311.978289604187, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7175141067a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3311.978289604187, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 9.908, "ram_util_percent": 23.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 119.66747516748559, "cur_kl_coeff": 0.33750000000000013, "cur_lr": 0.0010000000000000005, "total_loss": 4.86544917051422, "policy_loss": 0.001905087613839533, "vf_loss": 4.883779491905037, "vf_explained_var": 0.9797840727346241, "kl": 0.018047874775399993, "entropy": 2.6326565475560932, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.17557251908397, "num_grad_updates_lifetime": 250575.5, "diff_num_grad_updates_vs_sampler_policy": 1964.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 1073929, "num_agent_steps_trained": 1073929}, "env_runners": {"episode_reward_max": -813.0902803588866, "episode_reward_min": -4248.1799764405805, "episode_reward_mean": -2433.0492250378984, "episode_len_mean": 148.78, "episode_media": {}, "episodes_timesteps_total": 14878, "policy_reward_min": {"policy_0": -1502.8696659553793}, "policy_reward_max": {"policy_0": 1.9639725468003315}, "policy_reward_mean": {"policy_0": -486.6098450075798}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3941.7218366884913, -3607.1433994940885, -3049.423018869706, -3093.936072617265, -1713.58093642637, -2265.665776663004, -2252.383339387276, -1471.686748156955, -1809.6753813208802, -2824.556330808141, -1927.1864849451679, -1153.8701938616812, -1561.9545216048223, -1768.4703876527358, -2966.598683088929, -2819.274586516832, -3055.360724800582, -2618.202111608572, -2483.722001540982, -1642.0835618501394, -2441.99983131908, -2151.8627385550585, -2844.301723426804, -2167.9148819308534, -2372.392066837414, -3389.072491531135, -2553.6551051132683, -1385.7017601376294, -3929.839412186928, -2996.2238887289195, -2140.9281792809784, -2016.6216876787903, -2914.8139246943733, -1901.2482519967307, -3625.0889425333235, -2204.066276715062, -2223.9117384884594, -3379.537323949088, -2504.109987365448, -1240.6922278218585, -3303.060397070913, -1618.818604669827, -2929.3049904452905, -4085.77915325513, -2022.619355822499, -2673.7038567146274, -3226.8738750713446, -2803.2666731547347, -3151.802785972039, -2694.188966160434, -2412.463041294293, -1971.6652838818904, -2049.8329116194855, -1410.725137564526, -3238.712924958316, -1628.721090611422, -4003.2583750526737, -1614.0075127267087, -3102.287549389591, -2895.6769194772655, -2113.3211215808215, -2147.329166325326, -3133.7453271120253, -2027.3069636284001, -3159.2753450152236, -2106.802622215693, -3412.452793115583, -1494.9995910559965, -2646.529947983477, -3214.0230310539346, -2613.764615888188, -3464.0129775153646, -3084.5120358970494, -1648.9530665269558, -2125.4767757862774, -1289.9833482475815, -2712.4842325275713, -1548.5752602107482, -3068.335970580711, -1272.7529911209815, -2130.786202881017, -2651.4193504402, -1451.394410440175, -1988.9913345780762, -2004.871075392898, -1942.61630810766, -1556.4623122252522, -1961.0372165764363, -4248.1799764405805, -2726.111156547567, -1774.3274484394465, -2060.8302441214482, -1025.2929594193704, -813.0902803588866, -1348.0494713676587, -2907.5057940401152, -2522.327093237143, -3887.440222994209, -1491.581204704361, -3280.7233149826343], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-304.8755799399594, -77.00735285723135, -1227.5161589544377, -1362.986853981759, -969.3358909551027, -1010.7905923104635, -723.8268485848171, -551.3015732030996, -410.7557647524344, -910.4686206432744, -73.28036923154029, -1463.908706751174, -385.8123638532467, -92.45104106190728, -1033.9705379718328, -938.0306354616188, -1034.2697290547399, -117.44756351042442, -109.32147160222245, -894.8666729882559, -138.21265869529103, -298.4402106833759, -403.33716105441334, -18.747221550028584, -854.8436844432598, -212.55565441095854, -380.85925999186964, -42.30561674882127, -1018.7617460469444, -611.1834994644083, -369.41741976322646, -191.29175302276693, -731.1006919356155, -684.0344577739784, -276.5390168916935, -10.898320451218726, -641.8137711750779, -623.7982593446035, -2.594920884294719, -192.58147630176035, -316.85558737832616, -421.275398938707, -767.4112502149673, -277.7022470520133, -26.4308977368676, -436.38261546884513, -250.09025298322237, -1063.2887227580907, -76.53804886577223, -998.2566907322108, -498.9337463976404, -174.50281035238987, -169.89197466213167, -1063.2042179076336, -20.653735625372875, -78.66716893470023, -278.00424352013744, -220.02293367916823, -451.2844871890603, -125.89136053861624, -690.5363836691387, -131.7445357196525, -398.82057036530745, -276.6760304430832, -64.17700140764074, -78.71258991496077, -277.91145707368673, -865.8500142372648, -502.3597063986846, -43.636620028139326, -807.4205801766396, -985.772429805124, -68.56541074817942, -1017.7935634259695, -87.04669893301799, -28.232689032200895, -616.0449497643679, -730.6276182065463, -692.2607039797185, -752.1086255340039, -658.815078161823, -369.54895081707326, -1052.5560249627085, -517.2630219982856, -457.1776488606931, -868.3721965207232, -687.4074350207004, -577.6271246454022, -48.564560122575124, -436.2307952991718, -159.48822528183308, -1115.7046923132932, -27.836607405436165, -731.7887765218176, -448.90370001860003, -366.0397786636347, -7.276457345240264, -121.01360716186139, -1053.2311183329205, -94.52260034648252, -558.3094295384888, -24.80752363630074, -829.1046758114339, -997.5836469728854, -32.1945553599704, -669.938099399503, -28.73255061812554, -215.5556459109789, -537.6126122177972, -700.0238304086535, -251.73318858238727, -551.2552384932098, -1250.8748405321035, -748.5822111865173, -41.856244632588485, -140.2249576884737, -946.5075205306824, -20.517752596747886, -888.2349533958896, -172.42969771905737, -367.9358970894125, -360.64988924878134, -94.19270169710818, -716.9694640008328, -832.6441148012794, -1325.041209039572, -579.5534282931412, -36.25675851681672, -1180.1995573228176, -268.02153835878966, -104.88456135068598, -1173.4583673376903, -816.3436092587752, -133.13791792341948, -325.83064924269695, -128.34279607372108, -235.4752687546426, -719.8450105165, -76.71231365463424, -225.32637113813175, -590.5737989310999, -20.380189476911806, -1070.3047841371013, -1148.7141743148377, -1099.8664653269725, -44.176019081091106, -985.1849848760178, -80.39057220503682, -580.9533760060511, -1305.5189365607212, -463.69180784771044, -460.9718741092807, -124.22179235806897, -746.048279336138, -345.99442562978226, -89.99366206202825, -89.34231956785935, -624.9608130324023, -58.48629433550629, -1153.838598680995, -35.97741183842519, -1188.4533902399962, -154.3446645702708, -643.5600246040234, -892.478433441658, -845.2616264024161, -342.8201723053621, -186.2968588324575, -416.4703303155458, -110.39926414094948, -1104.1846559834357, -328.4940317219168, -132.87787324970483, -835.9131933049903, -1223.6191882732771, -146.53346015721817, -165.31857337368257, -101.92801983380765, -1462.1937802356376, -328.0924431147163, -625.3909792293529, -911.8959081941449, -173.98748178091031, -176.2503861587726, -336.38698312527885, -189.85651857778518, -1295.7879497017489, -1360.9273197411221, -49.049617867461905, -483.9159180609726, -671.986091311049, -483.558696915512, -572.1335264242432, -696.1604732177319, -80.27119949691152, -225.5097912343153, -428.74678994126157, -76.22075200269005, -401.5413835057716, -108.67351113781984, -1108.1930325899605, -408.9464149696796, -908.1219241181624, -561.9038603199202, -315.89516507318916, -317.35013717665254, -237.89912188596261, -578.7742330106689, -129.13222850477683, -355.662884091767, -295.5564526178159, -97.57662996188525, -907.587998023367, -559.2975434877735, -1069.286366354446, -474.7458329553015, -1134.0912578799116, -349.40237911914386, -624.6700173453963, -1502.8696659553793, -352.48061355479064, -192.6854744678303, -778.0878610694974, -122.71076451158035, -576.6546422188019, -117.66097823344577, -942.9415178440239, -528.6588242086024, -735.1111587352251, -349.33137769332785, -180.89418440773102, -693.3908974609678, -922.3619067060498, -596.8531589552683, -833.3737275413287, -100.88507384259842, -852.2307401949057, -470.36262895542916, -937.8150960868941, -441.97313407490526, -596.7964199344065, -329.08777242649046, -893.1223210057512, -831.8267647804012, -500.9695078249889, -357.2923321802792, -1062.0352601788636, -43.16890006809043, -1108.324260597312, -123.36821313588712, -76.90875892753733, -262.7562363432376, -192.50181504944663, -1133.7875681276437, -746.5086628464262, -699.8869675102809, -140.88808724292724, -233.990572224283, -165.87902850280557, -731.0206284015944, -419.83577647197353, -184.2430625278768, -380.6309132120443, -297.4875283621749, -767.6356310454158, -780.0765909975463, -59.50379027014309, -344.25548876182546, -128.8293052134455, -98.05996232156528, -302.3756711200048, -589.3697831009506, -972.5275159667852, -1179.7054581660223, -194.734496604556, -409.30882403231533, -102.34660285370875, -171.78483986442265, -409.9770378695686, -535.3037859914069, -1281.3151215990972, -991.4349361448714, -1124.0900344602078, -170.38904875551077, -436.0292340929866, 1.9639725468003315, -119.21286684631528, -228.9037159806675, -1180.2797785016303, -87.575123944895, -828.1312848784016, -717.7342208113971, -406.2625378550956, -376.8831601301662, -773.2763457145298, -62.31701950916877, -451.84319677656765, -48.31080254237742, -1189.8591997559831, -1143.3467008931673, -339.01639611537854, -98.89698127603059, -1154.631521751466, -159.42654265105392, -361.34967978689235, -100.70225208468108, -79.40309963198125, -674.021363720247, -570.2927116845063, -722.9097392039098, -171.38206946146514, -213.9180575689156, -997.4086541073275, -996.9828212010108, -754.0537247733045, -569.8143298461019, -249.10269724085364, -96.73384130359914, -386.28541027443293, -725.3706849634093, -1218.2681506543424, -421.17332801389006, -91.11831027685719, -1205.9907616322157, -222.72479443791988, -177.8702805874573, -720.2258535025987, -184.30923644091067, -973.0034492044854, -51.39380248024087, -747.2716906222012, -679.6008137356398, -97.841684242662, -807.5193729306959, -1080.2192315843874, -38.75290946310987, -267.0178071956968, -241.91953701588932, -65.60849347310652, -881.7008439081933, -454.83719926629544, -40.60229798308116, -1070.0682609856424, -72.58964040698874, -1008.4325493414682, -167.52760744714521, -845.830586615306, -1027.974018697185, -815.4610587797365, -357.2297595145597, -315.4408842238341, -410.2420769831627, -1009.6030634290946, -837.7196335135307, -40.75895773856746, -605.2655166195789, -738.105587848847, -1061.306274323687, -648.2172867828025, -411.1183119404477, -616.5304026448922, -564.8654389711993, -1247.4536301137407, -472.95236837368435, -182.7101957935296, -70.01941360588516, -556.4379413079498, -650.7165691236111, -133.28977194144844, -238.48937054806171, -717.9995318765095, -101.25078333180302, -294.272466688248, -502.2989403236512, -509.6550535660662, -78.05887607174371, -255.85791299547384, -135.26575982522962, -165.4356838925581, -655.3651154625768, -729.5914024877651, -69.1144998238989, -25.618874729345997, -732.122759641354, -1156.0366958452084, -765.2346630209993, -350.70059836569607, -201.7927047913476, -142.99230889288847, -87.85498513981486, -404.8519882190877, -914.8886582202202, -862.1404719428465, -490.54687130186414, -395.90798089669084, -208.3309450122685, -90.39549341661998, -201.06757257234324, -3.8840772054114443, -769.0749029143378, -209.212663369251, -439.1560282871111, -160.21106297520151, -943.5989332339946, -378.6075150154593, -41.64540558066942, -56.78827331564778, -815.6974049703517, -950.2450560453696, -787.0432105281654, -241.38929525799534, -252.45902348218033, -359.3575015542326, -489.3817387157917, -108.80685142997615, -700.2293379329504, -513.0259718519529, -272.4246737907498, -335.7512845629987, -167.56006643942425, -599.4606625315107, -818.9546972480784, -512.4485189924332, -48.05149186774776, -25.955704753127694, -581.3132929212659, -871.3450847605237, -303.13404665544476, -20.363802841230367, -166.46008092919266, -83.39630311974068, -385.57290630788015, -1025.6685632719173, -36.25727317529744, -25.567266350417913, -693.4446078293677, -37.69109992739751, -959.5198350165005, -170.04048283925943, -100.34119096391005, -1080.7607311085246, -600.0627883656047, -793.1702379650192, -1175.6944184961549, -598.4918005052779, -298.202932887504, -232.4760400388736, -1324.2399414050883, -212.04304079477524, -659.1492014213267, -509.69230767936824, -185.3807602875632, -29.723909479096505, -35.37734577895266, -1014.1531252144664, -78.54847130557644, -499.94347220093533, -245.07941974338897, -1133.3579288112583, -103.90095206029008, -167.69780432120442, -56.15737760146902, -262.4041655764006, -478.9643595257319, -60.069252394566014, -82.08287356338559, -158.33275005401683, -212.19168508458876, -243.20774564620007, -117.27522601069445, -940.2241948664866, -26.119311150282932, -162.3170300915152, -31.98792392134598, -187.4010113380283, -16.707383220632543, -1295.5964887472287, -86.17854934968531, -1269.4163113467866, -239.60706137578245, -53.67259020979114, -470.53509462816976, -799.323929392101, -1065.5223076172, -133.27317138988087, -740.5759114999585, -800.4400462719038, -1105.2174631646012, -1002.0363397642183, -239.17046229352928, -1036.30136823706, -61.01505227877565, -94.8537527074309, -216.51601967609247, -82.89501180500073, -341.97770686083885, -559.6694754601075, -650.9129683644209, -816.2984490208572, -911.8647152764089]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4901781586507798, "mean_inference_ms": 1.6930518416742888, "mean_action_processing_ms": 0.795667342879614, "mean_env_wait_ms": 9.949850934241338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012157678604125977, "StateBufferConnector_ms": 0.009117841720581055, "ViewRequirementAgentConnector_ms": 0.29587793350219727}, "num_episodes": 26, "episode_return_max": -813.0902803588866, "episode_return_min": -4248.1799764405805, "episode_return_mean": -2433.0492250378984, "episodes_this_iter": 26}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1073929, "num_agent_steps_trained": 1073929, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.76946827469813, "num_env_steps_trained_throughput_per_sec": 73.76946827469813, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 1073929, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1073929, "timers": {"training_iteration_time_ms": 53691.096, "restore_workers_time_ms": 0.026, "training_step_time_ms": 53691.025, "sample_time_ms": 3206.726, "learn_time_ms": 50425.853, "learn_throughput": 79.324, "synch_weights_time_ms": 55.512}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 1073929, "num_agent_steps_trained": 1073929}, "done": false, "training_iteration": 62, "trial_id": "efc54_00000", "date": "2024-07-24_19-36-09", "timestamp": 1721829969, "time_this_iter_s": 54.233885288238525, "time_total_s": 3366.2121748924255, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x717514107490>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3366.2121748924255, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 9.723376623376623, "ram_util_percent": 23.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 128.4251540225274, "cur_kl_coeff": 0.33750000000000013, "cur_lr": 0.0010000000000000005, "total_loss": 4.502872913241689, "policy_loss": 9.976573092637835e-05, "vf_loss": 4.524891523368486, "vf_explained_var": 0.9866958541724518, "kl": 0.01808858641149872, "entropy": 2.8223274223677075, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.72519083969466, "num_grad_updates_lifetime": 254505.5, "diff_num_grad_updates_vs_sampler_policy": 1964.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1090661, "num_agent_steps_trained": 1090661}, "env_runners": {"episode_reward_max": -813.0902803588866, "episode_reward_min": -4536.425086723783, "episode_reward_mean": -2486.5540198939034, "episode_len_mean": 148.85, "episode_media": {}, "episodes_timesteps_total": 14885, "policy_reward_min": {"policy_0": -1502.8696659553793}, "policy_reward_max": {"policy_0": 1.9639725468003315}, "policy_reward_mean": {"policy_0": -497.31080397878065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3929.839412186928, -2996.2238887289195, -2140.9281792809784, -2016.6216876787903, -2914.8139246943733, -1901.2482519967307, -3625.0889425333235, -2204.066276715062, -2223.9117384884594, -3379.537323949088, -2504.109987365448, -1240.6922278218585, -3303.060397070913, -1618.818604669827, -2929.3049904452905, -4085.77915325513, -2022.619355822499, -2673.7038567146274, -3226.8738750713446, -2803.2666731547347, -3151.802785972039, -2694.188966160434, -2412.463041294293, -1971.6652838818904, -2049.8329116194855, -1410.725137564526, -3238.712924958316, -1628.721090611422, -4003.2583750526737, -1614.0075127267087, -3102.287549389591, -2895.6769194772655, -2113.3211215808215, -2147.329166325326, -3133.7453271120253, -2027.3069636284001, -3159.2753450152236, -2106.802622215693, -3412.452793115583, -1494.9995910559965, -2646.529947983477, -3214.0230310539346, -2613.764615888188, -3464.0129775153646, -3084.5120358970494, -1648.9530665269558, -2125.4767757862774, -1289.9833482475815, -2712.4842325275713, -1548.5752602107482, -3068.335970580711, -1272.7529911209815, -2130.786202881017, -2651.4193504402, -1451.394410440175, -1988.9913345780762, -2004.871075392898, -1942.61630810766, -1556.4623122252522, -1961.0372165764363, -4248.1799764405805, -2726.111156547567, -1774.3274484394465, -2060.8302441214482, -1025.2929594193704, -813.0902803588866, -1348.0494713676587, -2907.5057940401152, -2522.327093237143, -3887.440222994209, -1491.581204704361, -3280.7233149826343, -3300.3035916227195, -2031.0992320945945, -2254.4241295755915, -1778.1724798912564, -1562.8457912526003, -3253.8945900483013, -3003.8594829414897, -2536.9143232155934, -3641.250556086982, -4536.425086723783, -3315.2412050188127, -2500.1024525723496, -2893.182703342554, -2226.4770555239097, -2823.8166580903403, -3659.6559360690844, -3149.386597123336, -1942.912392722691, -1252.2313801586283, -1767.100209990386, -3486.7726544058146, -3118.0079180332327, -2650.26971478211, -1993.6365904239194, -2223.9240848097584, -878.2379556694467, -2386.53688644441, -2517.194523720611], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 128, 150, 150], "policy_policy_0_reward": [-590.5737989310999, -20.380189476911806, -1070.3047841371013, -1148.7141743148377, -1099.8664653269725, -44.176019081091106, -985.1849848760178, -80.39057220503682, -580.9533760060511, -1305.5189365607212, -463.69180784771044, -460.9718741092807, -124.22179235806897, -746.048279336138, -345.99442562978226, -89.99366206202825, -89.34231956785935, -624.9608130324023, -58.48629433550629, -1153.838598680995, -35.97741183842519, -1188.4533902399962, -154.3446645702708, -643.5600246040234, -892.478433441658, -845.2616264024161, -342.8201723053621, -186.2968588324575, -416.4703303155458, -110.39926414094948, -1104.1846559834357, -328.4940317219168, -132.87787324970483, -835.9131933049903, -1223.6191882732771, -146.53346015721817, -165.31857337368257, -101.92801983380765, -1462.1937802356376, -328.0924431147163, -625.3909792293529, -911.8959081941449, -173.98748178091031, -176.2503861587726, -336.38698312527885, -189.85651857778518, -1295.7879497017489, -1360.9273197411221, -49.049617867461905, -483.9159180609726, -671.986091311049, -483.558696915512, -572.1335264242432, -696.1604732177319, -80.27119949691152, -225.5097912343153, -428.74678994126157, -76.22075200269005, -401.5413835057716, -108.67351113781984, -1108.1930325899605, -408.9464149696796, -908.1219241181624, -561.9038603199202, -315.89516507318916, -317.35013717665254, -237.89912188596261, -578.7742330106689, -129.13222850477683, -355.662884091767, -295.5564526178159, -97.57662996188525, -907.587998023367, -559.2975434877735, -1069.286366354446, -474.7458329553015, -1134.0912578799116, -349.40237911914386, -624.6700173453963, -1502.8696659553793, -352.48061355479064, -192.6854744678303, -778.0878610694974, -122.71076451158035, -576.6546422188019, -117.66097823344577, -942.9415178440239, -528.6588242086024, -735.1111587352251, -349.33137769332785, -180.89418440773102, -693.3908974609678, -922.3619067060498, -596.8531589552683, -833.3737275413287, -100.88507384259842, -852.2307401949057, -470.36262895542916, -937.8150960868941, -441.97313407490526, -596.7964199344065, -329.08777242649046, -893.1223210057512, -831.8267647804012, -500.9695078249889, -357.2923321802792, -1062.0352601788636, -43.16890006809043, -1108.324260597312, -123.36821313588712, -76.90875892753733, -262.7562363432376, -192.50181504944663, -1133.7875681276437, -746.5086628464262, -699.8869675102809, -140.88808724292724, -233.990572224283, -165.87902850280557, -731.0206284015944, -419.83577647197353, -184.2430625278768, -380.6309132120443, -297.4875283621749, -767.6356310454158, -780.0765909975463, -59.50379027014309, -344.25548876182546, -128.8293052134455, -98.05996232156528, -302.3756711200048, -589.3697831009506, -972.5275159667852, -1179.7054581660223, -194.734496604556, -409.30882403231533, -102.34660285370875, -171.78483986442265, -409.9770378695686, -535.3037859914069, -1281.3151215990972, -991.4349361448714, -1124.0900344602078, -170.38904875551077, -436.0292340929866, 1.9639725468003315, -119.21286684631528, -228.9037159806675, -1180.2797785016303, -87.575123944895, -828.1312848784016, -717.7342208113971, -406.2625378550956, -376.8831601301662, -773.2763457145298, -62.31701950916877, -451.84319677656765, -48.31080254237742, -1189.8591997559831, -1143.3467008931673, -339.01639611537854, -98.89698127603059, -1154.631521751466, -159.42654265105392, -361.34967978689235, -100.70225208468108, -79.40309963198125, -674.021363720247, -570.2927116845063, -722.9097392039098, -171.38206946146514, -213.9180575689156, -997.4086541073275, -996.9828212010108, -754.0537247733045, -569.8143298461019, -249.10269724085364, -96.73384130359914, -386.28541027443293, -725.3706849634093, -1218.2681506543424, -421.17332801389006, -91.11831027685719, -1205.9907616322157, -222.72479443791988, -177.8702805874573, -720.2258535025987, -184.30923644091067, -973.0034492044854, -51.39380248024087, -747.2716906222012, -679.6008137356398, -97.841684242662, -807.5193729306959, -1080.2192315843874, -38.75290946310987, -267.0178071956968, -241.91953701588932, -65.60849347310652, -881.7008439081933, -454.83719926629544, -40.60229798308116, -1070.0682609856424, -72.58964040698874, -1008.4325493414682, -167.52760744714521, -845.830586615306, -1027.974018697185, -815.4610587797365, -357.2297595145597, -315.4408842238341, -410.2420769831627, -1009.6030634290946, -837.7196335135307, -40.75895773856746, -605.2655166195789, -738.105587848847, -1061.306274323687, -648.2172867828025, -411.1183119404477, -616.5304026448922, -564.8654389711993, -1247.4536301137407, -472.95236837368435, -182.7101957935296, -70.01941360588516, -556.4379413079498, -650.7165691236111, -133.28977194144844, -238.48937054806171, -717.9995318765095, -101.25078333180302, -294.272466688248, -502.2989403236512, -509.6550535660662, -78.05887607174371, -255.85791299547384, -135.26575982522962, -165.4356838925581, -655.3651154625768, -729.5914024877651, -69.1144998238989, -25.618874729345997, -732.122759641354, -1156.0366958452084, -765.2346630209993, -350.70059836569607, -201.7927047913476, -142.99230889288847, -87.85498513981486, -404.8519882190877, -914.8886582202202, -862.1404719428465, -490.54687130186414, -395.90798089669084, -208.3309450122685, -90.39549341661998, -201.06757257234324, -3.8840772054114443, -769.0749029143378, -209.212663369251, -439.1560282871111, -160.21106297520151, -943.5989332339946, -378.6075150154593, -41.64540558066942, -56.78827331564778, -815.6974049703517, -950.2450560453696, -787.0432105281654, -241.38929525799534, -252.45902348218033, -359.3575015542326, -489.3817387157917, -108.80685142997615, -700.2293379329504, -513.0259718519529, -272.4246737907498, -335.7512845629987, -167.56006643942425, -599.4606625315107, -818.9546972480784, -512.4485189924332, -48.05149186774776, -25.955704753127694, -581.3132929212659, -871.3450847605237, -303.13404665544476, -20.363802841230367, -166.46008092919266, -83.39630311974068, -385.57290630788015, -1025.6685632719173, -36.25727317529744, -25.567266350417913, -693.4446078293677, -37.69109992739751, -959.5198350165005, -170.04048283925943, -100.34119096391005, -1080.7607311085246, -600.0627883656047, -793.1702379650192, -1175.6944184961549, -598.4918005052779, -298.202932887504, -232.4760400388736, -1324.2399414050883, -212.04304079477524, -659.1492014213267, -509.69230767936824, -185.3807602875632, -29.723909479096505, -35.37734577895266, -1014.1531252144664, -78.54847130557644, -499.94347220093533, -245.07941974338897, -1133.3579288112583, -103.90095206029008, -167.69780432120442, -56.15737760146902, -262.4041655764006, -478.9643595257319, -60.069252394566014, -82.08287356338559, -158.33275005401683, -212.19168508458876, -243.20774564620007, -117.27522601069445, -940.2241948664866, -26.119311150282932, -162.3170300915152, -31.98792392134598, -187.4010113380283, -16.707383220632543, -1295.5964887472287, -86.17854934968531, -1269.4163113467866, -239.60706137578245, -53.67259020979114, -470.53509462816976, -799.323929392101, -1065.5223076172, -133.27317138988087, -740.5759114999585, -800.4400462719038, -1105.2174631646012, -1002.0363397642183, -239.17046229352928, -1036.30136823706, -61.01505227877565, -94.8537527074309, -216.51601967609247, -82.89501180500073, -341.97770686083885, -559.6694754601075, -650.9129683644209, -816.2984490208572, -911.8647152764089, -1206.9322210468972, -56.22881669313408, -500.5227113607076, -524.0535389053082, -1012.566303616673, -10.781792700940553, -751.7216602967693, -1107.8670966974666, -71.5991006740664, -89.1295817253507, -18.149512136537798, -150.1610394707336, -273.1213189960619, -496.3461387151801, -1316.646120257077, -415.3370748596272, -107.38491311235512, -937.3510215962119, -154.604914296133, -163.4945560269294, -101.47908054588616, -30.96777810304709, -486.3855087959529, -599.5773388905823, -344.4360849171316, -380.18673879683337, -288.69791661790936, -983.7497151826473, -537.1571701001626, -1064.1030493507442, -577.3126683043241, -267.11554887407397, -696.7846601320708, -877.327483977339, -585.3191216536796, -158.05149180079297, -1065.2657125937505, -198.40707036693624, -34.49661489279913, -1080.6934335613134, -985.4924001343339, -1161.0351362054703, -888.4219034266303, -565.8429214982131, -40.45819482233218, -221.38175408195676, -1078.3698722350694, -1153.781178704768, -1154.3630924894137, -928.5291892125732, -918.4825791653342, -1101.294741546418, -221.45319878722339, -432.87119541674275, -641.1394901030935, -191.84254268555307, -1388.3704791248838, -405.5452874964824, -62.96966701396703, -451.374476251465, -899.1393923694402, -209.6801945955898, -789.0825772689453, -932.6998714013055, -62.580667707273456, -23.233568391115632, -458.03930662142477, -273.07740846094174, -1452.6729905847492, -19.45378146567754, -1204.105587079446, -905.3093704824877, -109.34706021024348, -380.1754132515537, -224.87922706660876, -1023.3153923301298, -411.1581589907641, -550.9588200708835, -515.7552509737669, -1158.46831370354, -1214.2312318325894, -636.7298178919374, -102.65359405264338, -426.22101687595335, -769.5509364702133, -179.0845067902876, -119.59854965014279, -596.8700767794921, -783.4100986654354, -263.949160837333, -77.29885912136274, -160.45150781765628, -417.035254103488, -497.5334103222175, -99.91234879390385, -154.85594840091852, -28.906809536297473, -116.07629857807045, -500.1673069381007, -967.0938465369977, -680.7947796564165, -420.8417007983186, -478.1984386619811, -947.4371087534986, -959.5006265356005, -186.90121233628574, -800.5394549039615, -198.73554526014578, -875.8870592817542, -1055.9446462510862, -835.7561002386893, -772.8846242510681, -922.972763510758, -111.52260940948175, -7.1336173721147205, -71.21771371580073, -1027.4369690150684, -90.46382687310098, -715.2687460059466, -89.2493348140033, -628.9794539103469, -591.2073718602409, -54.97489105779433, -553.4799155763802, -395.2824524049945, -13.282832932079309, -465.4547558597989, -22.98651724020248, -328.20028480056465, -48.31356483680092, -401.1543735405056, -47.21535343648646, -1188.6213558693314, -234.21846156260335, -515.327342035483, -611.5468727985055, -293.1428745924189, -109.14774691733946, -798.4845124791026, -704.8725169332465]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4879988439379452, "mean_inference_ms": 1.692642453485693, "mean_action_processing_ms": 0.7948532088891824, "mean_env_wait_ms": 9.942349456914275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01248931884765625, "StateBufferConnector_ms": 0.009414911270141602, "ViewRequirementAgentConnector_ms": 0.30577564239501953}, "num_episodes": 28, "episode_return_max": -813.0902803588866, "episode_return_min": -4536.425086723783, "episode_return_mean": -2486.5540198939034, "episodes_this_iter": 28}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1090661, "num_agent_steps_trained": 1090661, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.94723457346, "num_env_steps_trained_throughput_per_sec": 88.94723457346, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1090661, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1090661, "timers": {"training_iteration_time_ms": 52703.497, "restore_workers_time_ms": 0.027, "training_step_time_ms": 52703.425, "sample_time_ms": 3197.484, "learn_time_ms": 49447.306, "learn_throughput": 80.894, "synch_weights_time_ms": 55.717}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1090661, "num_agent_steps_trained": 1090661}, "done": false, "training_iteration": 63, "trial_id": "efc54_00000", "date": "2024-07-24_19-36-54", "timestamp": 1721830014, "time_this_iter_s": 44.98241996765137, "time_total_s": 3411.194594860077, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7add80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3411.194594860077, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 10.612499999999999, "ram_util_percent": 23.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 138.67155555965394, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.4934938900270485, "policy_loss": 0.0010861223910659005, "vf_loss": 4.5140235886016855, "vf_explained_var": 0.9796360667609167, "kl": 0.02209623755475114, "entropy": 2.9073303421651286, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.01574803149606, "num_grad_updates_lifetime": 258375.5, "diff_num_grad_updates_vs_sampler_policy": 1904.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1106792, "num_agent_steps_trained": 1106792}, "env_runners": {"episode_reward_max": -665.4995159671346, "episode_reward_min": -4536.425086723783, "episode_reward_mean": -2461.688261792485, "episode_len_mean": 148.37, "episode_media": {}, "episodes_timesteps_total": 14837, "policy_reward_min": {"policy_0": -1452.6729905847492}, "policy_reward_max": {"policy_0": 1.9639725468003315}, "policy_reward_mean": {"policy_0": -492.33765235849694}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1628.721090611422, -4003.2583750526737, -1614.0075127267087, -3102.287549389591, -2895.6769194772655, -2113.3211215808215, -2147.329166325326, -3133.7453271120253, -2027.3069636284001, -3159.2753450152236, -2106.802622215693, -3412.452793115583, -1494.9995910559965, -2646.529947983477, -3214.0230310539346, -2613.764615888188, -3464.0129775153646, -3084.5120358970494, -1648.9530665269558, -2125.4767757862774, -1289.9833482475815, -2712.4842325275713, -1548.5752602107482, -3068.335970580711, -1272.7529911209815, -2130.786202881017, -2651.4193504402, -1451.394410440175, -1988.9913345780762, -2004.871075392898, -1942.61630810766, -1556.4623122252522, -1961.0372165764363, -4248.1799764405805, -2726.111156547567, -1774.3274484394465, -2060.8302441214482, -1025.2929594193704, -813.0902803588866, -1348.0494713676587, -2907.5057940401152, -2522.327093237143, -3887.440222994209, -1491.581204704361, -3280.7233149826343, -3300.3035916227195, -2031.0992320945945, -2254.4241295755915, -1778.1724798912564, -1562.8457912526003, -3253.8945900483013, -3003.8594829414897, -2536.9143232155934, -3641.250556086982, -4536.425086723783, -3315.2412050188127, -2500.1024525723496, -2893.182703342554, -2226.4770555239097, -2823.8166580903403, -3659.6559360690844, -3149.386597123336, -1942.912392722691, -1252.2313801586283, -1767.100209990386, -3486.7726544058146, -3118.0079180332327, -2650.26971478211, -1993.6365904239194, -2223.9240848097584, -878.2379556694467, -2386.53688644441, -2517.194523720611, -3196.1684555963134, -2768.617049060804, -3673.9144674723316, -3326.5932339321907, -2052.5304856828334, -2083.0314634210886, -1521.8768690107718, -2031.5855938208886, -2093.0195715840873, -2737.123270205692, -1453.5970931943582, -2688.537690246402, -3826.6322144660435, -3732.147910179601, -2129.62502398658, -3153.4339720323073, -665.4995159671346, -2713.631606805086, -3235.825343464776, -1610.9341247543202, -2426.312078131636, -2753.066686574679, -2620.7463999074134, -1404.1819450041091, -1913.9933052138956, -3341.0534993165693, -3029.645119921564], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 132, 150, 150, 150, 150, 150, 91, 150, 150, 150, 150, 150, 150, 146, 150, 150, 150], "policy_policy_0_reward": [-409.30882403231533, -102.34660285370875, -171.78483986442265, -409.9770378695686, -535.3037859914069, -1281.3151215990972, -991.4349361448714, -1124.0900344602078, -170.38904875551077, -436.0292340929866, 1.9639725468003315, -119.21286684631528, -228.9037159806675, -1180.2797785016303, -87.575123944895, -828.1312848784016, -717.7342208113971, -406.2625378550956, -376.8831601301662, -773.2763457145298, -62.31701950916877, -451.84319677656765, -48.31080254237742, -1189.8591997559831, -1143.3467008931673, -339.01639611537854, -98.89698127603059, -1154.631521751466, -159.42654265105392, -361.34967978689235, -100.70225208468108, -79.40309963198125, -674.021363720247, -570.2927116845063, -722.9097392039098, -171.38206946146514, -213.9180575689156, -997.4086541073275, -996.9828212010108, -754.0537247733045, -569.8143298461019, -249.10269724085364, -96.73384130359914, -386.28541027443293, -725.3706849634093, -1218.2681506543424, -421.17332801389006, -91.11831027685719, -1205.9907616322157, -222.72479443791988, -177.8702805874573, -720.2258535025987, -184.30923644091067, -973.0034492044854, -51.39380248024087, -747.2716906222012, -679.6008137356398, -97.841684242662, -807.5193729306959, -1080.2192315843874, -38.75290946310987, -267.0178071956968, -241.91953701588932, -65.60849347310652, -881.7008439081933, -454.83719926629544, -40.60229798308116, -1070.0682609856424, -72.58964040698874, -1008.4325493414682, -167.52760744714521, -845.830586615306, -1027.974018697185, -815.4610587797365, -357.2297595145597, -315.4408842238341, -410.2420769831627, -1009.6030634290946, -837.7196335135307, -40.75895773856746, -605.2655166195789, -738.105587848847, -1061.306274323687, -648.2172867828025, -411.1183119404477, -616.5304026448922, -564.8654389711993, -1247.4536301137407, -472.95236837368435, -182.7101957935296, -70.01941360588516, -556.4379413079498, -650.7165691236111, -133.28977194144844, -238.48937054806171, -717.9995318765095, -101.25078333180302, -294.272466688248, -502.2989403236512, -509.6550535660662, -78.05887607174371, -255.85791299547384, -135.26575982522962, -165.4356838925581, -655.3651154625768, -729.5914024877651, -69.1144998238989, -25.618874729345997, -732.122759641354, -1156.0366958452084, -765.2346630209993, -350.70059836569607, -201.7927047913476, -142.99230889288847, -87.85498513981486, -404.8519882190877, -914.8886582202202, -862.1404719428465, -490.54687130186414, -395.90798089669084, -208.3309450122685, -90.39549341661998, -201.06757257234324, -3.8840772054114443, -769.0749029143378, -209.212663369251, -439.1560282871111, -160.21106297520151, -943.5989332339946, -378.6075150154593, -41.64540558066942, -56.78827331564778, -815.6974049703517, -950.2450560453696, -787.0432105281654, -241.38929525799534, -252.45902348218033, -359.3575015542326, -489.3817387157917, -108.80685142997615, -700.2293379329504, -513.0259718519529, -272.4246737907498, -335.7512845629987, -167.56006643942425, -599.4606625315107, -818.9546972480784, -512.4485189924332, -48.05149186774776, -25.955704753127694, -581.3132929212659, -871.3450847605237, -303.13404665544476, -20.363802841230367, -166.46008092919266, -83.39630311974068, -385.57290630788015, -1025.6685632719173, -36.25727317529744, -25.567266350417913, -693.4446078293677, -37.69109992739751, -959.5198350165005, -170.04048283925943, -100.34119096391005, -1080.7607311085246, -600.0627883656047, -793.1702379650192, -1175.6944184961549, -598.4918005052779, -298.202932887504, -232.4760400388736, -1324.2399414050883, -212.04304079477524, -659.1492014213267, -509.69230767936824, -185.3807602875632, -29.723909479096505, -35.37734577895266, -1014.1531252144664, -78.54847130557644, -499.94347220093533, -245.07941974338897, -1133.3579288112583, -103.90095206029008, -167.69780432120442, -56.15737760146902, -262.4041655764006, -478.9643595257319, -60.069252394566014, -82.08287356338559, -158.33275005401683, -212.19168508458876, -243.20774564620007, -117.27522601069445, -940.2241948664866, -26.119311150282932, -162.3170300915152, -31.98792392134598, -187.4010113380283, -16.707383220632543, -1295.5964887472287, -86.17854934968531, -1269.4163113467866, -239.60706137578245, -53.67259020979114, -470.53509462816976, -799.323929392101, -1065.5223076172, -133.27317138988087, -740.5759114999585, -800.4400462719038, -1105.2174631646012, -1002.0363397642183, -239.17046229352928, -1036.30136823706, -61.01505227877565, -94.8537527074309, -216.51601967609247, -82.89501180500073, -341.97770686083885, -559.6694754601075, -650.9129683644209, -816.2984490208572, -911.8647152764089, -1206.9322210468972, -56.22881669313408, -500.5227113607076, -524.0535389053082, -1012.566303616673, -10.781792700940553, -751.7216602967693, -1107.8670966974666, -71.5991006740664, -89.1295817253507, -18.149512136537798, -150.1610394707336, -273.1213189960619, -496.3461387151801, -1316.646120257077, -415.3370748596272, -107.38491311235512, -937.3510215962119, -154.604914296133, -163.4945560269294, -101.47908054588616, -30.96777810304709, -486.3855087959529, -599.5773388905823, -344.4360849171316, -380.18673879683337, -288.69791661790936, -983.7497151826473, -537.1571701001626, -1064.1030493507442, -577.3126683043241, -267.11554887407397, -696.7846601320708, -877.327483977339, -585.3191216536796, -158.05149180079297, -1065.2657125937505, -198.40707036693624, -34.49661489279913, -1080.6934335613134, -985.4924001343339, -1161.0351362054703, -888.4219034266303, -565.8429214982131, -40.45819482233218, -221.38175408195676, -1078.3698722350694, -1153.781178704768, -1154.3630924894137, -928.5291892125732, -918.4825791653342, -1101.294741546418, -221.45319878722339, -432.87119541674275, -641.1394901030935, -191.84254268555307, -1388.3704791248838, -405.5452874964824, -62.96966701396703, -451.374476251465, -899.1393923694402, -209.6801945955898, -789.0825772689453, -932.6998714013055, -62.580667707273456, -23.233568391115632, -458.03930662142477, -273.07740846094174, -1452.6729905847492, -19.45378146567754, -1204.105587079446, -905.3093704824877, -109.34706021024348, -380.1754132515537, -224.87922706660876, -1023.3153923301298, -411.1581589907641, -550.9588200708835, -515.7552509737669, -1158.46831370354, -1214.2312318325894, -636.7298178919374, -102.65359405264338, -426.22101687595335, -769.5509364702133, -179.0845067902876, -119.59854965014279, -596.8700767794921, -783.4100986654354, -263.949160837333, -77.29885912136274, -160.45150781765628, -417.035254103488, -497.5334103222175, -99.91234879390385, -154.85594840091852, -28.906809536297473, -116.07629857807045, -500.1673069381007, -967.0938465369977, -680.7947796564165, -420.8417007983186, -478.1984386619811, -947.4371087534986, -959.5006265356005, -186.90121233628574, -800.5394549039615, -198.73554526014578, -875.8870592817542, -1055.9446462510862, -835.7561002386893, -772.8846242510681, -922.972763510758, -111.52260940948175, -7.1336173721147205, -71.21771371580073, -1027.4369690150684, -90.46382687310098, -715.2687460059466, -89.2493348140033, -628.9794539103469, -591.2073718602409, -54.97489105779433, -553.4799155763802, -395.2824524049945, -13.282832932079309, -465.4547558597989, -22.98651724020248, -328.20028480056465, -48.31356483680092, -401.1543735405056, -47.21535343648646, -1188.6213558693314, -234.21846156260335, -515.327342035483, -611.5468727985055, -293.1428745924189, -109.14774691733946, -798.4845124791026, -704.8725169332465, -1203.0697385958406, -565.0078523082085, -72.66925940484276, -186.9261267697406, -1168.495478517681, -394.8985500664126, -274.3347450375452, -82.02578080342258, -944.7962736197993, -1072.5616995336259, -1329.259917952748, -106.86404748471097, -485.8970645462937, -1169.7165248998176, -582.1769125887587, -321.98850470812675, -906.9363740868658, -1155.6610745207602, -835.9377048103952, -106.06957580604391, -408.075151017121, -99.31906382041876, -489.4846281144224, -6.878770347447276, -1048.772872383423, -894.2051289704261, -201.64706659412997, -45.43318792353912, -57.47353965878943, -884.2725402742043, -310.80367966190215, -41.152006862398146, -539.9056206397051, -506.50918671234007, -123.50637513442487, -74.53630393762957, -142.37157056390342, -1094.5721589939087, -690.9201696498243, -29.18539067562393, -744.249901468919, -149.3547785751717, -446.2979574039181, -27.206874635475845, -725.9100595006028, -512.7132459086623, -859.1858341441385, -637.0345825503817, -124.1959396176322, -603.993667984876, -185.70144801906352, -802.330064121247, -202.6593646846528, -201.44563127717655, -61.46058509221978, -891.4474558588876, -841.088168731847, -90.87087712018143, -476.87299205812644, -388.25819647736404, -456.7602965163933, -1254.457402864168, -847.9841744463417, -221.65984458625414, -1045.7704960528852, -442.6337485401277, -265.0822224794187, -599.0864856339024, -1331.3206428371936, -1094.024810688958, -64.64943575925203, -111.75099001558809, -497.34544513914574, -358.1894921428248, -1097.6896609297683, -178.50031399716238, -1178.8760468915423, -287.79313952230484, -1043.4509054408747, -464.8135661804257, -113.47784587124796, -42.56324902621072, -316.51153917391633, -81.6390801514905, -111.30780174426894, -1105.0491075179868, -375.6378875747881, -185.28360277049117, -1041.73720324733, -5.923805694491431, -267.44111926788935, -959.8915940462149, -155.62368749425875, -1018.5555359206335, -834.3134067357771, -66.78599844105868, -151.34286398937962, -25.81898907360859, -822.5899386944035, -544.3963345558714, -501.67990350372355, -872.4318425393961, -731.9537325184342, -55.44465194853684, -264.8019476215473, -67.09976837603877, -1162.45878992769, -1218.7933732591248, -108.0002624415194, -196.7144925703053, -970.8484968165849, -1024.911727505324, -331.90585927559005, -213.15029402315497, -79.93002228675961, -336.7686154369215, -449.52115698733377, -199.678762791571, -134.02674190395166, -284.1866678843324, -509.05270145960714, -60.12418617646458, -141.13618166552652, -495.15055094004686, -708.5296849722511, -102.99113250533085, -1032.6042028435372, -835.9271516587631, -907.8268013391546, -461.7042109697851, -1027.190204107221, -64.79022332299864, -302.7851746246298, -549.1640794892583, -1085.7154383774541]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4846518372274162, "mean_inference_ms": 1.6899990982291144, "mean_action_processing_ms": 0.7928138250887605, "mean_env_wait_ms": 9.919742865176996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01269841194152832, "StateBufferConnector_ms": 0.009352445602416992, "ViewRequirementAgentConnector_ms": 0.29924845695495605}, "num_episodes": 27, "episode_return_max": -665.4995159671346, "episode_return_min": -4536.425086723783, "episode_return_mean": -2461.688261792485, "episodes_this_iter": 27}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1106792, "num_agent_steps_trained": 1106792, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.96444989860186, "num_env_steps_trained_throughput_per_sec": 83.96444989860186, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1106792, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1106792, "timers": {"training_iteration_time_ms": 51880.713, "restore_workers_time_ms": 0.027, "training_step_time_ms": 51880.641, "sample_time_ms": 3179.092, "learn_time_ms": 48643.437, "learn_throughput": 82.231, "synch_weights_time_ms": 55.214}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1106792, "num_agent_steps_trained": 1106792}, "done": false, "training_iteration": 64, "trial_id": "efc54_00000", "date": "2024-07-24_19-37-41", "timestamp": 1721830061, "time_this_iter_s": 47.65059208869934, "time_total_s": 3458.8451869487762, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7af6d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3458.8451869487762, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 10.377941176470587, "ram_util_percent": 23.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 130.29162156551075, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 0.0010000000000000005, "total_loss": 4.5364600837076665, "policy_loss": 0.0012108203725172183, "vf_loss": 4.55605598611117, "vf_explained_var": 0.9885202302643187, "kl": 0.013958068344909313, "entropy": 2.7872993761870903, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.67441860465117, "num_grad_updates_lifetime": 262215.5, "diff_num_grad_updates_vs_sampler_policy": 1934.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1123262, "num_agent_steps_trained": 1123262}, "env_runners": {"episode_reward_max": -665.4995159671346, "episode_reward_min": -4536.425086723783, "episode_reward_mean": -2472.2943393484065, "episode_len_mean": 148.38, "episode_media": {}, "episodes_timesteps_total": 14838, "policy_reward_min": {"policy_0": -1452.6729905847492}, "policy_reward_max": {"policy_0": 4.796339984964129}, "policy_reward_mean": {"policy_0": -494.45886786968134}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2651.4193504402, -1451.394410440175, -1988.9913345780762, -2004.871075392898, -1942.61630810766, -1556.4623122252522, -1961.0372165764363, -4248.1799764405805, -2726.111156547567, -1774.3274484394465, -2060.8302441214482, -1025.2929594193704, -813.0902803588866, -1348.0494713676587, -2907.5057940401152, -2522.327093237143, -3887.440222994209, -1491.581204704361, -3280.7233149826343, -3300.3035916227195, -2031.0992320945945, -2254.4241295755915, -1778.1724798912564, -1562.8457912526003, -3253.8945900483013, -3003.8594829414897, -2536.9143232155934, -3641.250556086982, -4536.425086723783, -3315.2412050188127, -2500.1024525723496, -2893.182703342554, -2226.4770555239097, -2823.8166580903403, -3659.6559360690844, -3149.386597123336, -1942.912392722691, -1252.2313801586283, -1767.100209990386, -3486.7726544058146, -3118.0079180332327, -2650.26971478211, -1993.6365904239194, -2223.9240848097584, -878.2379556694467, -2386.53688644441, -2517.194523720611, -3196.1684555963134, -2768.617049060804, -3673.9144674723316, -3326.5932339321907, -2052.5304856828334, -2083.0314634210886, -1521.8768690107718, -2031.5855938208886, -2093.0195715840873, -2737.123270205692, -1453.5970931943582, -2688.537690246402, -3826.6322144660435, -3732.147910179601, -2129.62502398658, -3153.4339720323073, -665.4995159671346, -2713.631606805086, -3235.825343464776, -1610.9341247543202, -2426.312078131636, -2753.066686574679, -2620.7463999074134, -1404.1819450041091, -1913.9933052138956, -3341.0534993165693, -3029.645119921564, -3460.016935924897, -2252.123766087679, -2642.7286326681915, -2101.0404344066546, -1588.3794996017473, -3903.5110878747178, -1826.6685667529514, -1584.7312498884587, -1717.306058986387, -1647.127404273557, -3024.9264793413413, -2698.0498918083986, -3083.9556589671565, -3067.962284842965, -1535.135537952722, -2826.835426657736, -2191.9389042827756, -2798.077999458612, -2020.694110979536, -2443.4816374377288, -3611.2993705035415, -2174.0701253475936, -2315.503577438267, -1847.1845303902462, -2497.8272873909227, -3859.4061298539627], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 132, 150, 150, 150, 150, 150, 91, 150, 150, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-41.64540558066942, -56.78827331564778, -815.6974049703517, -950.2450560453696, -787.0432105281654, -241.38929525799534, -252.45902348218033, -359.3575015542326, -489.3817387157917, -108.80685142997615, -700.2293379329504, -513.0259718519529, -272.4246737907498, -335.7512845629987, -167.56006643942425, -599.4606625315107, -818.9546972480784, -512.4485189924332, -48.05149186774776, -25.955704753127694, -581.3132929212659, -871.3450847605237, -303.13404665544476, -20.363802841230367, -166.46008092919266, -83.39630311974068, -385.57290630788015, -1025.6685632719173, -36.25727317529744, -25.567266350417913, -693.4446078293677, -37.69109992739751, -959.5198350165005, -170.04048283925943, -100.34119096391005, -1080.7607311085246, -600.0627883656047, -793.1702379650192, -1175.6944184961549, -598.4918005052779, -298.202932887504, -232.4760400388736, -1324.2399414050883, -212.04304079477524, -659.1492014213267, -509.69230767936824, -185.3807602875632, -29.723909479096505, -35.37734577895266, -1014.1531252144664, -78.54847130557644, -499.94347220093533, -245.07941974338897, -1133.3579288112583, -103.90095206029008, -167.69780432120442, -56.15737760146902, -262.4041655764006, -478.9643595257319, -60.069252394566014, -82.08287356338559, -158.33275005401683, -212.19168508458876, -243.20774564620007, -117.27522601069445, -940.2241948664866, -26.119311150282932, -162.3170300915152, -31.98792392134598, -187.4010113380283, -16.707383220632543, -1295.5964887472287, -86.17854934968531, -1269.4163113467866, -239.60706137578245, -53.67259020979114, -470.53509462816976, -799.323929392101, -1065.5223076172, -133.27317138988087, -740.5759114999585, -800.4400462719038, -1105.2174631646012, -1002.0363397642183, -239.17046229352928, -1036.30136823706, -61.01505227877565, -94.8537527074309, -216.51601967609247, -82.89501180500073, -341.97770686083885, -559.6694754601075, -650.9129683644209, -816.2984490208572, -911.8647152764089, -1206.9322210468972, -56.22881669313408, -500.5227113607076, -524.0535389053082, -1012.566303616673, -10.781792700940553, -751.7216602967693, -1107.8670966974666, -71.5991006740664, -89.1295817253507, -18.149512136537798, -150.1610394707336, -273.1213189960619, -496.3461387151801, -1316.646120257077, -415.3370748596272, -107.38491311235512, -937.3510215962119, -154.604914296133, -163.4945560269294, -101.47908054588616, -30.96777810304709, -486.3855087959529, -599.5773388905823, -344.4360849171316, -380.18673879683337, -288.69791661790936, -983.7497151826473, -537.1571701001626, -1064.1030493507442, -577.3126683043241, -267.11554887407397, -696.7846601320708, -877.327483977339, -585.3191216536796, -158.05149180079297, -1065.2657125937505, -198.40707036693624, -34.49661489279913, -1080.6934335613134, -985.4924001343339, -1161.0351362054703, -888.4219034266303, -565.8429214982131, -40.45819482233218, -221.38175408195676, -1078.3698722350694, -1153.781178704768, -1154.3630924894137, -928.5291892125732, -918.4825791653342, -1101.294741546418, -221.45319878722339, -432.87119541674275, -641.1394901030935, -191.84254268555307, -1388.3704791248838, -405.5452874964824, -62.96966701396703, -451.374476251465, -899.1393923694402, -209.6801945955898, -789.0825772689453, -932.6998714013055, -62.580667707273456, -23.233568391115632, -458.03930662142477, -273.07740846094174, -1452.6729905847492, -19.45378146567754, -1204.105587079446, -905.3093704824877, -109.34706021024348, -380.1754132515537, -224.87922706660876, -1023.3153923301298, -411.1581589907641, -550.9588200708835, -515.7552509737669, -1158.46831370354, -1214.2312318325894, -636.7298178919374, -102.65359405264338, -426.22101687595335, -769.5509364702133, -179.0845067902876, -119.59854965014279, -596.8700767794921, -783.4100986654354, -263.949160837333, -77.29885912136274, -160.45150781765628, -417.035254103488, -497.5334103222175, -99.91234879390385, -154.85594840091852, -28.906809536297473, -116.07629857807045, -500.1673069381007, -967.0938465369977, -680.7947796564165, -420.8417007983186, -478.1984386619811, -947.4371087534986, -959.5006265356005, -186.90121233628574, -800.5394549039615, -198.73554526014578, -875.8870592817542, -1055.9446462510862, -835.7561002386893, -772.8846242510681, -922.972763510758, -111.52260940948175, -7.1336173721147205, -71.21771371580073, -1027.4369690150684, -90.46382687310098, -715.2687460059466, -89.2493348140033, -628.9794539103469, -591.2073718602409, -54.97489105779433, -553.4799155763802, -395.2824524049945, -13.282832932079309, -465.4547558597989, -22.98651724020248, -328.20028480056465, -48.31356483680092, -401.1543735405056, -47.21535343648646, -1188.6213558693314, -234.21846156260335, -515.327342035483, -611.5468727985055, -293.1428745924189, -109.14774691733946, -798.4845124791026, -704.8725169332465, -1203.0697385958406, -565.0078523082085, -72.66925940484276, -186.9261267697406, -1168.495478517681, -394.8985500664126, -274.3347450375452, -82.02578080342258, -944.7962736197993, -1072.5616995336259, -1329.259917952748, -106.86404748471097, -485.8970645462937, -1169.7165248998176, -582.1769125887587, -321.98850470812675, -906.9363740868658, -1155.6610745207602, -835.9377048103952, -106.06957580604391, -408.075151017121, -99.31906382041876, -489.4846281144224, -6.878770347447276, -1048.772872383423, -894.2051289704261, -201.64706659412997, -45.43318792353912, -57.47353965878943, -884.2725402742043, -310.80367966190215, -41.152006862398146, -539.9056206397051, -506.50918671234007, -123.50637513442487, -74.53630393762957, -142.37157056390342, -1094.5721589939087, -690.9201696498243, -29.18539067562393, -744.249901468919, -149.3547785751717, -446.2979574039181, -27.206874635475845, -725.9100595006028, -512.7132459086623, -859.1858341441385, -637.0345825503817, -124.1959396176322, -603.993667984876, -185.70144801906352, -802.330064121247, -202.6593646846528, -201.44563127717655, -61.46058509221978, -891.4474558588876, -841.088168731847, -90.87087712018143, -476.87299205812644, -388.25819647736404, -456.7602965163933, -1254.457402864168, -847.9841744463417, -221.65984458625414, -1045.7704960528852, -442.6337485401277, -265.0822224794187, -599.0864856339024, -1331.3206428371936, -1094.024810688958, -64.64943575925203, -111.75099001558809, -497.34544513914574, -358.1894921428248, -1097.6896609297683, -178.50031399716238, -1178.8760468915423, -287.79313952230484, -1043.4509054408747, -464.8135661804257, -113.47784587124796, -42.56324902621072, -316.51153917391633, -81.6390801514905, -111.30780174426894, -1105.0491075179868, -375.6378875747881, -185.28360277049117, -1041.73720324733, -5.923805694491431, -267.44111926788935, -959.8915940462149, -155.62368749425875, -1018.5555359206335, -834.3134067357771, -66.78599844105868, -151.34286398937962, -25.81898907360859, -822.5899386944035, -544.3963345558714, -501.67990350372355, -872.4318425393961, -731.9537325184342, -55.44465194853684, -264.8019476215473, -67.09976837603877, -1162.45878992769, -1218.7933732591248, -108.0002624415194, -196.7144925703053, -970.8484968165849, -1024.911727505324, -331.90585927559005, -213.15029402315497, -79.93002228675961, -336.7686154369215, -449.52115698733377, -199.678762791571, -134.02674190395166, -284.1866678843324, -509.05270145960714, -60.12418617646458, -141.13618166552652, -495.15055094004686, -708.5296849722511, -102.99113250533085, -1032.6042028435372, -835.9271516587631, -907.8268013391546, -461.7042109697851, -1027.190204107221, -64.79022332299864, -302.7851746246298, -549.1640794892583, -1085.7154383774541, -68.14232867437543, -602.4019015037053, -1197.9684607036486, -1241.3295755153108, -350.17466952785503, -443.87804960447454, -377.9260179253724, -7.710798897235455, -1096.8767731645048, -325.7321264960909, -405.98725493884945, -1026.9794957981196, -901.4303157734794, -36.973504983503496, -271.3580611742388, -762.8284707971892, -475.0950591348404, -754.0448821889638, -36.11444641674901, -72.95757586891308, -245.04346180486053, -146.8838823909018, -813.8949095610752, -261.19074433168106, -121.36650151322901, -19.745827322100734, -1171.6693879230777, -1238.8869370730026, -358.2007195435694, -1115.0082160129648, 0.9958859691068198, -414.066795454084, -231.15352229268004, -902.7636253756872, -279.6805095996078, -43.5472419985294, -288.4454653087773, -1020.5917261122283, -111.90431597776316, -120.24250049115982, -1299.1941782716972, -151.11591083431827, -43.69891957551673, -38.29692858922878, -185.0001217156257, -107.84863326196108, -231.1844025652432, -183.21548654810596, -218.0130315191747, -906.8658503790732, -514.2318373504268, -1343.5113025104722, -83.23599976774763, -659.470618797019, -424.4767209156749, -129.38807117665942, -190.42199080885297, -930.9256042041678, -176.55029869481493, -1270.7639269239028, -712.3426364023986, -613.7805226577832, -698.9252801679274, 4.796339984964129, -1063.7035597240113, -238.48091372164734, -742.4971294298194, -1152.3630409783113, -181.03371462532633, -753.5874860878592, -100.89684881417085, -653.4690849042803, -410.99982630448926, -46.47610155559506, -323.2936763741858, -30.491200088985494, -798.1884708132495, -994.9237888712522, -382.88747737313895, -620.3444895111109, -10.206310917212479, -1360.0841278666364, -639.225391997983, -101.80604158430211, -80.61703191664166, -1010.1600643998123, -777.9592216485175, -331.828238167692, -544.7476760562923, -133.38279918629766, -451.9756865379203, -171.26224964099276, -360.3340132249175, -601.5304519286019, -435.59170964710523, -1162.8835382523428, -488.06201685167446, -233.8540075875657, -110.6813830803541, -448.0006916657911, -707.2939526361532, -794.1393212084955, -1167.230567832231, -848.1626226747835, -94.47290615188051, -1122.564972263546, -55.21913007102004, -12.432814119425089, -290.4558022585882, -693.3974066350132, -153.71686705037504, -83.99172728597239, -514.419454540958, -651.4960379322284, -911.8794906287329, -215.9681812136221, -323.0256888383741, -30.676804516345857, -713.2060968039383, -564.3077590179664, -74.62402403520879, -95.03687812043158, -229.95998844715768, -970.2453468156825, -1127.9610499724415, -720.1237994648294, -1122.365499394494, -310.2533716974114, -303.7251737301172, -1402.9382855671122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4862814917641891, "mean_inference_ms": 1.6917488705747987, "mean_action_processing_ms": 0.7919537969838537, "mean_env_wait_ms": 9.923223685065262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013210058212280273, "StateBufferConnector_ms": 0.009618759155273438, "ViewRequirementAgentConnector_ms": 0.3116114139556885}, "num_episodes": 26, "episode_return_max": -665.4995159671346, "episode_return_min": -4536.425086723783, "episode_return_mean": -2472.2943393484065, "episodes_this_iter": 26}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1123262, "num_agent_steps_trained": 1123262, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.90922078844001, "num_env_steps_trained_throughput_per_sec": 74.90922078844001, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1123262, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1123262, "timers": {"training_iteration_time_ms": 52120.601, "restore_workers_time_ms": 0.028, "training_step_time_ms": 52120.527, "sample_time_ms": 3187.556, "learn_time_ms": 48874.017, "learn_throughput": 81.843, "synch_weights_time_ms": 56.068}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1123262, "num_agent_steps_trained": 1123262}, "done": false, "training_iteration": 65, "trial_id": "efc54_00000", "date": "2024-07-24_19-38-35", "timestamp": 1721830115, "time_this_iter_s": 53.40923738479614, "time_total_s": 3512.2544243335724, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x717514105120>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3512.2544243335724, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 9.851315789473684, "ram_util_percent": 23.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 136.19378346034458, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 0.0010000000000000005, "total_loss": 4.613014361553622, "policy_loss": -0.000682760751747846, "vf_loss": 4.633290714787361, "vf_explained_var": 0.9849746321526386, "kl": 0.015618536907556305, "entropy": 2.750047372935111, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.90977443609023, "num_grad_updates_lifetime": 266145.5, "diff_num_grad_updates_vs_sampler_policy": 1994.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1140274, "num_agent_steps_trained": 1140274}, "env_runners": {"episode_reward_max": -523.0382690584937, "episode_reward_min": -4536.425086723783, "episode_reward_mean": -2513.748012739547, "episode_len_mean": 148.16, "episode_media": {}, "episodes_timesteps_total": 14816, "policy_reward_min": {"policy_0": -1452.6729905847492}, "policy_reward_max": {"policy_0": 4.796339984964129}, "policy_reward_mean": {"policy_0": -502.7496025479094}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4536.425086723783, -3315.2412050188127, -2500.1024525723496, -2893.182703342554, -2226.4770555239097, -2823.8166580903403, -3659.6559360690844, -3149.386597123336, -1942.912392722691, -1252.2313801586283, -1767.100209990386, -3486.7726544058146, -3118.0079180332327, -2650.26971478211, -1993.6365904239194, -2223.9240848097584, -878.2379556694467, -2386.53688644441, -2517.194523720611, -3196.1684555963134, -2768.617049060804, -3673.9144674723316, -3326.5932339321907, -2052.5304856828334, -2083.0314634210886, -1521.8768690107718, -2031.5855938208886, -2093.0195715840873, -2737.123270205692, -1453.5970931943582, -2688.537690246402, -3826.6322144660435, -3732.147910179601, -2129.62502398658, -3153.4339720323073, -665.4995159671346, -2713.631606805086, -3235.825343464776, -1610.9341247543202, -2426.312078131636, -2753.066686574679, -2620.7463999074134, -1404.1819450041091, -1913.9933052138956, -3341.0534993165693, -3029.645119921564, -3460.016935924897, -2252.123766087679, -2642.7286326681915, -2101.0404344066546, -1588.3794996017473, -3903.5110878747178, -1826.6685667529514, -1584.7312498884587, -1717.306058986387, -1647.127404273557, -3024.9264793413413, -2698.0498918083986, -3083.9556589671565, -3067.962284842965, -1535.135537952722, -2826.835426657736, -2191.9389042827756, -2798.077999458612, -2020.694110979536, -2443.4816374377288, -3611.2993705035415, -2174.0701253475936, -2315.503577438267, -1847.1845303902462, -2497.8272873909227, -3859.4061298539627, -3059.5822113018635, -3467.78739659419, -1585.1071450535376, -1614.9041725638795, -2964.3579030073615, -2120.4371252455094, -1957.970947822184, -1698.06604159194, -523.0382690584937, -2905.1278476830716, -2461.5850316154483, -2119.6550625930154, -3653.79038902779, -1780.428549102337, -2428.7382332995, -1486.5916798212643, -1743.0183817052534, -3210.4168216499484, -2955.9679395331423, -2592.721458448087, -3597.1269768048123, -2160.709977876002, -2297.3000644741114, -2583.9725453076762, -2672.8401357270054, -3864.0451136257248, -2640.0123622846904, -3005.0829074394483], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 132, 150, 150, 150, 150, 150, 91, 150, 150, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-221.38175408195676, -1078.3698722350694, -1153.781178704768, -1154.3630924894137, -928.5291892125732, -918.4825791653342, -1101.294741546418, -221.45319878722339, -432.87119541674275, -641.1394901030935, -191.84254268555307, -1388.3704791248838, -405.5452874964824, -62.96966701396703, -451.374476251465, -899.1393923694402, -209.6801945955898, -789.0825772689453, -932.6998714013055, -62.580667707273456, -23.233568391115632, -458.03930662142477, -273.07740846094174, -1452.6729905847492, -19.45378146567754, -1204.105587079446, -905.3093704824877, -109.34706021024348, -380.1754132515537, -224.87922706660876, -1023.3153923301298, -411.1581589907641, -550.9588200708835, -515.7552509737669, -1158.46831370354, -1214.2312318325894, -636.7298178919374, -102.65359405264338, -426.22101687595335, -769.5509364702133, -179.0845067902876, -119.59854965014279, -596.8700767794921, -783.4100986654354, -263.949160837333, -77.29885912136274, -160.45150781765628, -417.035254103488, -497.5334103222175, -99.91234879390385, -154.85594840091852, -28.906809536297473, -116.07629857807045, -500.1673069381007, -967.0938465369977, -680.7947796564165, -420.8417007983186, -478.1984386619811, -947.4371087534986, -959.5006265356005, -186.90121233628574, -800.5394549039615, -198.73554526014578, -875.8870592817542, -1055.9446462510862, -835.7561002386893, -772.8846242510681, -922.972763510758, -111.52260940948175, -7.1336173721147205, -71.21771371580073, -1027.4369690150684, -90.46382687310098, -715.2687460059466, -89.2493348140033, -628.9794539103469, -591.2073718602409, -54.97489105779433, -553.4799155763802, -395.2824524049945, -13.282832932079309, -465.4547558597989, -22.98651724020248, -328.20028480056465, -48.31356483680092, -401.1543735405056, -47.21535343648646, -1188.6213558693314, -234.21846156260335, -515.327342035483, -611.5468727985055, -293.1428745924189, -109.14774691733946, -798.4845124791026, -704.8725169332465, -1203.0697385958406, -565.0078523082085, -72.66925940484276, -186.9261267697406, -1168.495478517681, -394.8985500664126, -274.3347450375452, -82.02578080342258, -944.7962736197993, -1072.5616995336259, -1329.259917952748, -106.86404748471097, -485.8970645462937, -1169.7165248998176, -582.1769125887587, -321.98850470812675, -906.9363740868658, -1155.6610745207602, -835.9377048103952, -106.06957580604391, -408.075151017121, -99.31906382041876, -489.4846281144224, -6.878770347447276, -1048.772872383423, -894.2051289704261, -201.64706659412997, -45.43318792353912, -57.47353965878943, -884.2725402742043, -310.80367966190215, -41.152006862398146, -539.9056206397051, -506.50918671234007, -123.50637513442487, -74.53630393762957, -142.37157056390342, -1094.5721589939087, -690.9201696498243, -29.18539067562393, -744.249901468919, -149.3547785751717, -446.2979574039181, -27.206874635475845, -725.9100595006028, -512.7132459086623, -859.1858341441385, -637.0345825503817, -124.1959396176322, -603.993667984876, -185.70144801906352, -802.330064121247, -202.6593646846528, -201.44563127717655, -61.46058509221978, -891.4474558588876, -841.088168731847, -90.87087712018143, -476.87299205812644, -388.25819647736404, -456.7602965163933, -1254.457402864168, -847.9841744463417, -221.65984458625414, -1045.7704960528852, -442.6337485401277, -265.0822224794187, -599.0864856339024, -1331.3206428371936, -1094.024810688958, -64.64943575925203, -111.75099001558809, -497.34544513914574, -358.1894921428248, -1097.6896609297683, -178.50031399716238, -1178.8760468915423, -287.79313952230484, -1043.4509054408747, -464.8135661804257, -113.47784587124796, -42.56324902621072, -316.51153917391633, -81.6390801514905, -111.30780174426894, -1105.0491075179868, -375.6378875747881, -185.28360277049117, -1041.73720324733, -5.923805694491431, -267.44111926788935, -959.8915940462149, -155.62368749425875, -1018.5555359206335, -834.3134067357771, -66.78599844105868, -151.34286398937962, -25.81898907360859, -822.5899386944035, -544.3963345558714, -501.67990350372355, -872.4318425393961, -731.9537325184342, -55.44465194853684, -264.8019476215473, -67.09976837603877, -1162.45878992769, -1218.7933732591248, -108.0002624415194, -196.7144925703053, -970.8484968165849, -1024.911727505324, -331.90585927559005, -213.15029402315497, -79.93002228675961, -336.7686154369215, -449.52115698733377, -199.678762791571, -134.02674190395166, -284.1866678843324, -509.05270145960714, -60.12418617646458, -141.13618166552652, -495.15055094004686, -708.5296849722511, -102.99113250533085, -1032.6042028435372, -835.9271516587631, -907.8268013391546, -461.7042109697851, -1027.190204107221, -64.79022332299864, -302.7851746246298, -549.1640794892583, -1085.7154383774541, -68.14232867437543, -602.4019015037053, -1197.9684607036486, -1241.3295755153108, -350.17466952785503, -443.87804960447454, -377.9260179253724, -7.710798897235455, -1096.8767731645048, -325.7321264960909, -405.98725493884945, -1026.9794957981196, -901.4303157734794, -36.973504983503496, -271.3580611742388, -762.8284707971892, -475.0950591348404, -754.0448821889638, -36.11444641674901, -72.95757586891308, -245.04346180486053, -146.8838823909018, -813.8949095610752, -261.19074433168106, -121.36650151322901, -19.745827322100734, -1171.6693879230777, -1238.8869370730026, -358.2007195435694, -1115.0082160129648, 0.9958859691068198, -414.066795454084, -231.15352229268004, -902.7636253756872, -279.6805095996078, -43.5472419985294, -288.4454653087773, -1020.5917261122283, -111.90431597776316, -120.24250049115982, -1299.1941782716972, -151.11591083431827, -43.69891957551673, -38.29692858922878, -185.0001217156257, -107.84863326196108, -231.1844025652432, -183.21548654810596, -218.0130315191747, -906.8658503790732, -514.2318373504268, -1343.5113025104722, -83.23599976774763, -659.470618797019, -424.4767209156749, -129.38807117665942, -190.42199080885297, -930.9256042041678, -176.55029869481493, -1270.7639269239028, -712.3426364023986, -613.7805226577832, -698.9252801679274, 4.796339984964129, -1063.7035597240113, -238.48091372164734, -742.4971294298194, -1152.3630409783113, -181.03371462532633, -753.5874860878592, -100.89684881417085, -653.4690849042803, -410.99982630448926, -46.47610155559506, -323.2936763741858, -30.491200088985494, -798.1884708132495, -994.9237888712522, -382.88747737313895, -620.3444895111109, -10.206310917212479, -1360.0841278666364, -639.225391997983, -101.80604158430211, -80.61703191664166, -1010.1600643998123, -777.9592216485175, -331.828238167692, -544.7476760562923, -133.38279918629766, -451.9756865379203, -171.26224964099276, -360.3340132249175, -601.5304519286019, -435.59170964710523, -1162.8835382523428, -488.06201685167446, -233.8540075875657, -110.6813830803541, -448.0006916657911, -707.2939526361532, -794.1393212084955, -1167.230567832231, -848.1626226747835, -94.47290615188051, -1122.564972263546, -55.21913007102004, -12.432814119425089, -290.4558022585882, -693.3974066350132, -153.71686705037504, -83.99172728597239, -514.419454540958, -651.4960379322284, -911.8794906287329, -215.9681812136221, -323.0256888383741, -30.676804516345857, -713.2060968039383, -564.3077590179664, -74.62402403520879, -95.03687812043158, -229.95998844715768, -970.2453468156825, -1127.9610499724415, -720.1237994648294, -1122.365499394494, -310.2533716974114, -303.7251737301172, -1402.9382855671122, -308.843154862855, -657.5738795722293, -932.9653293834905, -1146.4532685793095, -13.74657890397695, -921.9479617569638, -902.5996349896033, -1159.2712055527022, -322.51339329308155, -161.45520100183543, -182.60062180082548, -636.5369511500426, -76.40544491726371, -507.74653645074227, -181.8175907346641, -281.1770859281909, -505.11225213315436, -321.4334000651984, -50.34940855992985, -456.8320258774062, -722.3923365704592, -788.080753811798, -635.15928949782, -555.7365402751274, -262.98898285215245, -23.344923208336198, -627.7424271755704, -40.09905710796097, -259.40800466976526, -1169.8427130838777, -499.51887953171945, -899.0680494109614, -137.74789342367913, -130.91994063074787, -290.7161848250752, -239.920045473932, -14.355871404941796, -1030.675439783592, -187.26774037991933, -225.84694454955425, -9.361811447400871, -175.3423693435371, -167.60321580560867, -127.85067096500424, -42.88020149694287, -68.95636870814398, -525.6073779827124, -919.8209516540068, -231.14915759941167, -1159.5939917388002, -1357.4503729774488, -672.6426822495546, -130.07050962098586, -258.768085700812, -42.653381066646205, -97.07651672136646, -728.6693759673221, -248.1391562927237, -851.1680676220033, -194.60194598960166, -78.76396777680591, -1034.4100350482709, -1315.6298147059535, -1168.7126626487247, -56.27390884803351, -225.96077052301854, -122.44761079426496, -311.2928698303054, -1107.55479310833, -13.172504846417203, -219.32893186287504, -225.2797399740225, -1034.5423716691548, -31.873992927035687, -917.7131968664125, -56.8885894322018, -661.6241676799149, -387.43173594780995, -47.20773924624388, -333.439447515095, -517.4759981417285, -322.8799879213791, -130.9120148637583, -530.1015434522212, -241.64883732616707, -52.146081881541015, -980.2965653586257, -813.5367420876048, -300.4656762181725, -1063.9717561040043, -598.5189271568885, -135.44300793527918, -697.9185240850974, -544.6302331693738, -979.4572471865032, -82.16957177288108, -642.3073081061626, -76.43512835967175, -981.0648426681873, -810.7446075411805, -1158.5314881976722, -447.2467808650998, -1249.371378484341, -478.1306116730355, -263.84671758466345, -1076.9752597889212, -308.32804949640604, -374.5761123880936, -141.86054249216298, -258.9700137104187, -917.144090926063, -650.1201491966896, -441.05229920702556, -36.02511651676954, -252.95840862756387, -566.7935768282475, -729.809563098797, -81.77958075819953, -1154.9998903215567, -50.58993430087661, -969.1249258222874, -903.0835299306978, -223.6875428603707, -242.3553686089532, -334.58876850469545, -194.2922781156077, -318.90577426763275, -1076.240781298299, -1127.2797810111356, -1147.3264989330494, -328.85015283726153, -127.8449298809941, -744.4341750137286, -435.5104586638415, -1003.3726458888644, -965.7778856886532, -101.42838772521543, -752.9028313624539, -554.1491574325657, -630.8246452305613]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.483719423123035, "mean_inference_ms": 1.6909682929900764, "mean_action_processing_ms": 0.7911907394097684, "mean_env_wait_ms": 9.917007674301418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013222694396972656, "StateBufferConnector_ms": 0.009907007217407227, "ViewRequirementAgentConnector_ms": 0.3250410556793213}, "num_episodes": 28, "episode_return_max": -523.0382690584937, "episode_return_min": -4536.425086723783, "episode_return_mean": -2513.748012739547, "episodes_this_iter": 28}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1140274, "num_agent_steps_trained": 1140274, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.35221139528561, "num_env_steps_trained_throughput_per_sec": 72.35221139528561, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1140274, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1140274, "timers": {"training_iteration_time_ms": 52209.002, "restore_workers_time_ms": 0.027, "training_step_time_ms": 52208.929, "sample_time_ms": 3169.54, "learn_time_ms": 48980.084, "learn_throughput": 81.666, "synch_weights_time_ms": 56.406}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1140274, "num_agent_steps_trained": 1140274}, "done": false, "training_iteration": 66, "trial_id": "efc54_00000", "date": "2024-07-24_19-39-30", "timestamp": 1721830170, "time_this_iter_s": 55.296722412109375, "time_total_s": 3567.5511467456818, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x717514110820>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3567.5511467456818, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 9.874358974358975, "ram_util_percent": 23.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 130.31694703884224, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 0.0010000000000000005, "total_loss": 4.564697544978409, "policy_loss": 0.000857360644645437, "vf_loss": 4.584629689070283, "vf_explained_var": 0.9849694736577846, "kl": 0.014058537077572611, "entropy": 2.790663367099863, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.7063492063492, "num_grad_updates_lifetime": 270030.5, "diff_num_grad_updates_vs_sampler_policy": 1889.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1156365, "num_agent_steps_trained": 1156365}, "env_runners": {"episode_reward_max": -523.0382690584937, "episode_reward_min": -4135.390523034483, "episode_reward_mean": -2497.592621020868, "episode_len_mean": 148.39, "episode_media": {}, "episodes_timesteps_total": 14839, "policy_reward_min": {"policy_0": -1402.9382855671122}, "policy_reward_max": {"policy_0": 6.964957672490852}, "policy_reward_mean": {"policy_0": -499.5185242041736}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2031.5855938208886, -2093.0195715840873, -2737.123270205692, -1453.5970931943582, -2688.537690246402, -3826.6322144660435, -3732.147910179601, -2129.62502398658, -3153.4339720323073, -665.4995159671346, -2713.631606805086, -3235.825343464776, -1610.9341247543202, -2426.312078131636, -2753.066686574679, -2620.7463999074134, -1404.1819450041091, -1913.9933052138956, -3341.0534993165693, -3029.645119921564, -3460.016935924897, -2252.123766087679, -2642.7286326681915, -2101.0404344066546, -1588.3794996017473, -3903.5110878747178, -1826.6685667529514, -1584.7312498884587, -1717.306058986387, -1647.127404273557, -3024.9264793413413, -2698.0498918083986, -3083.9556589671565, -3067.962284842965, -1535.135537952722, -2826.835426657736, -2191.9389042827756, -2798.077999458612, -2020.694110979536, -2443.4816374377288, -3611.2993705035415, -2174.0701253475936, -2315.503577438267, -1847.1845303902462, -2497.8272873909227, -3859.4061298539627, -3059.5822113018635, -3467.78739659419, -1585.1071450535376, -1614.9041725638795, -2964.3579030073615, -2120.4371252455094, -1957.970947822184, -1698.06604159194, -523.0382690584937, -2905.1278476830716, -2461.5850316154483, -2119.6550625930154, -3653.79038902779, -1780.428549102337, -2428.7382332995, -1486.5916798212643, -1743.0183817052534, -3210.4168216499484, -2955.9679395331423, -2592.721458448087, -3597.1269768048123, -2160.709977876002, -2297.3000644741114, -2583.9725453076762, -2672.8401357270054, -3864.0451136257248, -2640.0123622846904, -3005.0829074394483, -2793.644442470109, -1668.4013847595584, -3315.481232449547, -2394.940537120035, -1688.1200153299371, -4060.2251970885777, -1574.8982900268509, -2352.314276351066, -2467.128835797022, -3052.915458370502, -3086.9979496372616, -2906.8859322774915, -1800.9448865150941, -2746.3659590886014, -1278.6096188096915, -3444.0716566220417, -2400.3983094795735, -3644.9847422326006, -2535.5194208354023, -1588.2356502129232, -1348.0851279326027, -4135.390523034483, -2252.5549987526865, -2413.1860901191485, -2616.211051245119, -2761.7932713756773], "episode_lengths": [150, 150, 150, 132, 150, 150, 150, 150, 150, 91, 150, 150, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-74.53630393762957, -142.37157056390342, -1094.5721589939087, -690.9201696498243, -29.18539067562393, -744.249901468919, -149.3547785751717, -446.2979574039181, -27.206874635475845, -725.9100595006028, -512.7132459086623, -859.1858341441385, -637.0345825503817, -124.1959396176322, -603.993667984876, -185.70144801906352, -802.330064121247, -202.6593646846528, -201.44563127717655, -61.46058509221978, -891.4474558588876, -841.088168731847, -90.87087712018143, -476.87299205812644, -388.25819647736404, -456.7602965163933, -1254.457402864168, -847.9841744463417, -221.65984458625414, -1045.7704960528852, -442.6337485401277, -265.0822224794187, -599.0864856339024, -1331.3206428371936, -1094.024810688958, -64.64943575925203, -111.75099001558809, -497.34544513914574, -358.1894921428248, -1097.6896609297683, -178.50031399716238, -1178.8760468915423, -287.79313952230484, -1043.4509054408747, -464.8135661804257, -113.47784587124796, -42.56324902621072, -316.51153917391633, -81.6390801514905, -111.30780174426894, -1105.0491075179868, -375.6378875747881, -185.28360277049117, -1041.73720324733, -5.923805694491431, -267.44111926788935, -959.8915940462149, -155.62368749425875, -1018.5555359206335, -834.3134067357771, -66.78599844105868, -151.34286398937962, -25.81898907360859, -822.5899386944035, -544.3963345558714, -501.67990350372355, -872.4318425393961, -731.9537325184342, -55.44465194853684, -264.8019476215473, -67.09976837603877, -1162.45878992769, -1218.7933732591248, -108.0002624415194, -196.7144925703053, -970.8484968165849, -1024.911727505324, -331.90585927559005, -213.15029402315497, -79.93002228675961, -336.7686154369215, -449.52115698733377, -199.678762791571, -134.02674190395166, -284.1866678843324, -509.05270145960714, -60.12418617646458, -141.13618166552652, -495.15055094004686, -708.5296849722511, -102.99113250533085, -1032.6042028435372, -835.9271516587631, -907.8268013391546, -461.7042109697851, -1027.190204107221, -64.79022332299864, -302.7851746246298, -549.1640794892583, -1085.7154383774541, -68.14232867437543, -602.4019015037053, -1197.9684607036486, -1241.3295755153108, -350.17466952785503, -443.87804960447454, -377.9260179253724, -7.710798897235455, -1096.8767731645048, -325.7321264960909, -405.98725493884945, -1026.9794957981196, -901.4303157734794, -36.973504983503496, -271.3580611742388, -762.8284707971892, -475.0950591348404, -754.0448821889638, -36.11444641674901, -72.95757586891308, -245.04346180486053, -146.8838823909018, -813.8949095610752, -261.19074433168106, -121.36650151322901, -19.745827322100734, -1171.6693879230777, -1238.8869370730026, -358.2007195435694, -1115.0082160129648, 0.9958859691068198, -414.066795454084, -231.15352229268004, -902.7636253756872, -279.6805095996078, -43.5472419985294, -288.4454653087773, -1020.5917261122283, -111.90431597776316, -120.24250049115982, -1299.1941782716972, -151.11591083431827, -43.69891957551673, -38.29692858922878, -185.0001217156257, -107.84863326196108, -231.1844025652432, -183.21548654810596, -218.0130315191747, -906.8658503790732, -514.2318373504268, -1343.5113025104722, -83.23599976774763, -659.470618797019, -424.4767209156749, -129.38807117665942, -190.42199080885297, -930.9256042041678, -176.55029869481493, -1270.7639269239028, -712.3426364023986, -613.7805226577832, -698.9252801679274, 4.796339984964129, -1063.7035597240113, -238.48091372164734, -742.4971294298194, -1152.3630409783113, -181.03371462532633, -753.5874860878592, -100.89684881417085, -653.4690849042803, -410.99982630448926, -46.47610155559506, -323.2936763741858, -30.491200088985494, -798.1884708132495, -994.9237888712522, -382.88747737313895, -620.3444895111109, -10.206310917212479, -1360.0841278666364, -639.225391997983, -101.80604158430211, -80.61703191664166, -1010.1600643998123, -777.9592216485175, -331.828238167692, -544.7476760562923, -133.38279918629766, -451.9756865379203, -171.26224964099276, -360.3340132249175, -601.5304519286019, -435.59170964710523, -1162.8835382523428, -488.06201685167446, -233.8540075875657, -110.6813830803541, -448.0006916657911, -707.2939526361532, -794.1393212084955, -1167.230567832231, -848.1626226747835, -94.47290615188051, -1122.564972263546, -55.21913007102004, -12.432814119425089, -290.4558022585882, -693.3974066350132, -153.71686705037504, -83.99172728597239, -514.419454540958, -651.4960379322284, -911.8794906287329, -215.9681812136221, -323.0256888383741, -30.676804516345857, -713.2060968039383, -564.3077590179664, -74.62402403520879, -95.03687812043158, -229.95998844715768, -970.2453468156825, -1127.9610499724415, -720.1237994648294, -1122.365499394494, -310.2533716974114, -303.7251737301172, -1402.9382855671122, -308.843154862855, -657.5738795722293, -932.9653293834905, -1146.4532685793095, -13.74657890397695, -921.9479617569638, -902.5996349896033, -1159.2712055527022, -322.51339329308155, -161.45520100183543, -182.60062180082548, -636.5369511500426, -76.40544491726371, -507.74653645074227, -181.8175907346641, -281.1770859281909, -505.11225213315436, -321.4334000651984, -50.34940855992985, -456.8320258774062, -722.3923365704592, -788.080753811798, -635.15928949782, -555.7365402751274, -262.98898285215245, -23.344923208336198, -627.7424271755704, -40.09905710796097, -259.40800466976526, -1169.8427130838777, -499.51887953171945, -899.0680494109614, -137.74789342367913, -130.91994063074787, -290.7161848250752, -239.920045473932, -14.355871404941796, -1030.675439783592, -187.26774037991933, -225.84694454955425, -9.361811447400871, -175.3423693435371, -167.60321580560867, -127.85067096500424, -42.88020149694287, -68.95636870814398, -525.6073779827124, -919.8209516540068, -231.14915759941167, -1159.5939917388002, -1357.4503729774488, -672.6426822495546, -130.07050962098586, -258.768085700812, -42.653381066646205, -97.07651672136646, -728.6693759673221, -248.1391562927237, -851.1680676220033, -194.60194598960166, -78.76396777680591, -1034.4100350482709, -1315.6298147059535, -1168.7126626487247, -56.27390884803351, -225.96077052301854, -122.44761079426496, -311.2928698303054, -1107.55479310833, -13.172504846417203, -219.32893186287504, -225.2797399740225, -1034.5423716691548, -31.873992927035687, -917.7131968664125, -56.8885894322018, -661.6241676799149, -387.43173594780995, -47.20773924624388, -333.439447515095, -517.4759981417285, -322.8799879213791, -130.9120148637583, -530.1015434522212, -241.64883732616707, -52.146081881541015, -980.2965653586257, -813.5367420876048, -300.4656762181725, -1063.9717561040043, -598.5189271568885, -135.44300793527918, -697.9185240850974, -544.6302331693738, -979.4572471865032, -82.16957177288108, -642.3073081061626, -76.43512835967175, -981.0648426681873, -810.7446075411805, -1158.5314881976722, -447.2467808650998, -1249.371378484341, -478.1306116730355, -263.84671758466345, -1076.9752597889212, -308.32804949640604, -374.5761123880936, -141.86054249216298, -258.9700137104187, -917.144090926063, -650.1201491966896, -441.05229920702556, -36.02511651676954, -252.95840862756387, -566.7935768282475, -729.809563098797, -81.77958075819953, -1154.9998903215567, -50.58993430087661, -969.1249258222874, -903.0835299306978, -223.6875428603707, -242.3553686089532, -334.58876850469545, -194.2922781156077, -318.90577426763275, -1076.240781298299, -1127.2797810111356, -1147.3264989330494, -328.85015283726153, -127.8449298809941, -744.4341750137286, -435.5104586638415, -1003.3726458888644, -965.7778856886532, -101.42838772521543, -752.9028313624539, -554.1491574325657, -630.8246452305613, -1126.9851971162461, -350.8882945648817, -974.8430917945155, -82.50978465858041, -258.41807433588485, -758.3405135042966, -579.4352616291436, -117.33972399902713, -187.65468549696502, -25.631200130126714, -630.6305369498019, -1147.578127075157, -641.7088111398392, -435.7575412840834, -459.80621600066246, -126.38456912676227, -1327.6539530933494, -75.09379064579817, -187.92541375324484, -677.8828105008796, -108.38709358232565, -70.37539158947553, -17.45036308864985, -168.19577503769898, -1323.7113920317865, -264.9762005509978, -1098.7905275752642, -994.6258305801299, -1255.9904142913858, -445.8422240907978, -212.56786652172693, -100.86022050052266, -295.4588004284326, -273.8962195838938, -692.1151829922745, -104.6674868511433, -579.9330720132061, -617.0082924148483, -187.56749098038713, -863.1379340914806, -213.12681474526576, -372.78923668640294, -267.25184896778643, -487.49688780380666, -1126.4640475937588, -449.2524587982732, -1140.9955565452372, -713.7049475479242, -712.8804487130194, -36.082046766050205, -1086.6144404317802, -525.3200350878291, -36.92247269498626, -246.19551279424397, -1191.9454886284213, -465.9437597183488, -743.1298124892962, -710.5265405110396, -292.3768926491577, -694.9089269096478, -835.3402723323052, -65.8342584605759, -355.67270317253883, -239.22717055662542, -304.87048199304655, -1239.714539312955, -994.0651228791769, -141.8859500559678, -23.725883827446985, -346.9744630130536, -869.0691918561048, -223.83057704481075, -77.33431613026474, -92.16334848275379, -16.212185295757624, -392.78923041231275, -414.8585415342226, -769.6988923102989, -893.6185626507879, -973.1064297144144, -462.10414855783523, -495.7721499848827, -61.20863380568445, -464.18176115433323, -917.1316159768373, -765.8435489186775, -1014.8870305254102, -1176.873097007471, -194.75035984378152, -492.630705937259, -37.42699729395546, -75.53025337129836, -1173.0074840394125, -297.20805328978463, -952.3466328409517, -381.1258681337888, -228.5875060507928, -93.86807132433371, -891.6191623764987, 6.964957672490852, -385.878509906334, -213.15017715872955, -71.58993999215949, -216.2493828885896, -461.21711798678956, -533.2693256294756, -1168.2479663017778, -403.149528258028, -888.0180085861182, -1142.705694259083, -926.861981659641, -457.1950264278299, -463.8305695741377, -149.50875449762054, -255.15866659345699, -933.7299494603926, -380.1501860381905, -242.58223271318326, -143.93149209889887, -712.792229808485, -786.2388069793986, -1365.131116303742, -196.42785472886027, -245.52994899617335, -22.883324236943853, -1035.0298063840462, -323.2995248447825, -32.908036324612766, -1193.0967111104064, -177.4591927118292]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.481232546955435, "mean_inference_ms": 1.6893847287220598, "mean_action_processing_ms": 0.7897118928642997, "mean_env_wait_ms": 9.901032916692328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013161182403564453, "StateBufferConnector_ms": 0.00965738296508789, "ViewRequirementAgentConnector_ms": 0.3174154758453369}, "num_episodes": 26, "episode_return_max": -523.0382690584937, "episode_return_min": -4135.390523034483, "episode_return_mean": -2497.592621020868, "episodes_this_iter": 26}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1156365, "num_agent_steps_trained": 1156365, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.13929953209175, "num_env_steps_trained_throughput_per_sec": 76.13929953209175, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1156365, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1156365, "timers": {"training_iteration_time_ms": 51872.398, "restore_workers_time_ms": 0.028, "training_step_time_ms": 51872.324, "sample_time_ms": 3161.919, "learn_time_ms": 48651.102, "learn_throughput": 82.218, "synch_weights_time_ms": 56.38}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1156365, "num_agent_steps_trained": 1156365}, "done": false, "training_iteration": 67, "trial_id": "efc54_00000", "date": "2024-07-24_19-40-23", "timestamp": 1721830223, "time_this_iter_s": 52.54644751548767, "time_total_s": 3620.0975942611694, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x717514105750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3620.0975942611694, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 9.937333333333335, "ram_util_percent": 23.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 142.14947666758582, "cur_kl_coeff": 0.50625, "cur_lr": 0.0010000000000000005, "total_loss": 4.667543723412923, "policy_loss": 0.0023031428859879573, "vf_loss": 4.685206518513816, "vf_explained_var": 0.9830952561895052, "kl": 0.014604936174887588, "entropy": 2.7359695032097044, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.32142857142857, "num_grad_updates_lifetime": 274020.5, "diff_num_grad_updates_vs_sampler_policy": 2099.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1174190, "num_agent_steps_trained": 1174190}, "env_runners": {"episode_reward_max": -523.0382690584937, "episode_reward_min": -4926.156235212455, "episode_reward_mean": -2473.419044249177, "episode_len_mean": 147.0, "episode_media": {}, "episodes_timesteps_total": 14700, "policy_reward_min": {"policy_0": -1402.9382855671122}, "policy_reward_max": {"policy_0": 6.964957672490852}, "policy_reward_mean": {"policy_0": -494.68380884983543}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1584.7312498884587, -1717.306058986387, -1647.127404273557, -3024.9264793413413, -2698.0498918083986, -3083.9556589671565, -3067.962284842965, -1535.135537952722, -2826.835426657736, -2191.9389042827756, -2798.077999458612, -2020.694110979536, -2443.4816374377288, -3611.2993705035415, -2174.0701253475936, -2315.503577438267, -1847.1845303902462, -2497.8272873909227, -3859.4061298539627, -3059.5822113018635, -3467.78739659419, -1585.1071450535376, -1614.9041725638795, -2964.3579030073615, -2120.4371252455094, -1957.970947822184, -1698.06604159194, -523.0382690584937, -2905.1278476830716, -2461.5850316154483, -2119.6550625930154, -3653.79038902779, -1780.428549102337, -2428.7382332995, -1486.5916798212643, -1743.0183817052534, -3210.4168216499484, -2955.9679395331423, -2592.721458448087, -3597.1269768048123, -2160.709977876002, -2297.3000644741114, -2583.9725453076762, -2672.8401357270054, -3864.0451136257248, -2640.0123622846904, -3005.0829074394483, -2793.644442470109, -1668.4013847595584, -3315.481232449547, -2394.940537120035, -1688.1200153299371, -4060.2251970885777, -1574.8982900268509, -2352.314276351066, -2467.128835797022, -3052.915458370502, -3086.9979496372616, -2906.8859322774915, -1800.9448865150941, -2746.3659590886014, -1278.6096188096915, -3444.0716566220417, -2400.3983094795735, -3644.9847422326006, -2535.5194208354023, -1588.2356502129232, -1348.0851279326027, -4135.390523034483, -2252.5549987526865, -2413.1860901191485, -2616.211051245119, -2761.7932713756773, -1894.906315044248, -2883.92302345841, -581.0117185310253, -3974.3203937125936, -884.5411634040848, -2645.608920732078, -2742.6989778184807, -2415.383350876507, -3170.1284635955717, -2187.821416414182, -4926.156235212455, -2455.3387186591244, -2618.325111327678, -2006.9390946180943, -3153.282291859925, -1027.739210417604, -2443.5141565462923, -4016.9804974946824, -3464.9466723272158, -747.2841465267674, -2458.9084782902983, -1859.0965200642468, -2124.2554875498213, -3368.7455542130465, -2006.2396380855814, -1500.6872846810195, -1358.9203694638857], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 89, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-43.5472419985294, -288.4454653087773, -1020.5917261122283, -111.90431597776316, -120.24250049115982, -1299.1941782716972, -151.11591083431827, -43.69891957551673, -38.29692858922878, -185.0001217156257, -107.84863326196108, -231.1844025652432, -183.21548654810596, -218.0130315191747, -906.8658503790732, -514.2318373504268, -1343.5113025104722, -83.23599976774763, -659.470618797019, -424.4767209156749, -129.38807117665942, -190.42199080885297, -930.9256042041678, -176.55029869481493, -1270.7639269239028, -712.3426364023986, -613.7805226577832, -698.9252801679274, 4.796339984964129, -1063.7035597240113, -238.48091372164734, -742.4971294298194, -1152.3630409783113, -181.03371462532633, -753.5874860878592, -100.89684881417085, -653.4690849042803, -410.99982630448926, -46.47610155559506, -323.2936763741858, -30.491200088985494, -798.1884708132495, -994.9237888712522, -382.88747737313895, -620.3444895111109, -10.206310917212479, -1360.0841278666364, -639.225391997983, -101.80604158430211, -80.61703191664166, -1010.1600643998123, -777.9592216485175, -331.828238167692, -544.7476760562923, -133.38279918629766, -451.9756865379203, -171.26224964099276, -360.3340132249175, -601.5304519286019, -435.59170964710523, -1162.8835382523428, -488.06201685167446, -233.8540075875657, -110.6813830803541, -448.0006916657911, -707.2939526361532, -794.1393212084955, -1167.230567832231, -848.1626226747835, -94.47290615188051, -1122.564972263546, -55.21913007102004, -12.432814119425089, -290.4558022585882, -693.3974066350132, -153.71686705037504, -83.99172728597239, -514.419454540958, -651.4960379322284, -911.8794906287329, -215.9681812136221, -323.0256888383741, -30.676804516345857, -713.2060968039383, -564.3077590179664, -74.62402403520879, -95.03687812043158, -229.95998844715768, -970.2453468156825, -1127.9610499724415, -720.1237994648294, -1122.365499394494, -310.2533716974114, -303.7251737301172, -1402.9382855671122, -308.843154862855, -657.5738795722293, -932.9653293834905, -1146.4532685793095, -13.74657890397695, -921.9479617569638, -902.5996349896033, -1159.2712055527022, -322.51339329308155, -161.45520100183543, -182.60062180082548, -636.5369511500426, -76.40544491726371, -507.74653645074227, -181.8175907346641, -281.1770859281909, -505.11225213315436, -321.4334000651984, -50.34940855992985, -456.8320258774062, -722.3923365704592, -788.080753811798, -635.15928949782, -555.7365402751274, -262.98898285215245, -23.344923208336198, -627.7424271755704, -40.09905710796097, -259.40800466976526, -1169.8427130838777, -499.51887953171945, -899.0680494109614, -137.74789342367913, -130.91994063074787, -290.7161848250752, -239.920045473932, -14.355871404941796, -1030.675439783592, -187.26774037991933, -225.84694454955425, -9.361811447400871, -175.3423693435371, -167.60321580560867, -127.85067096500424, -42.88020149694287, -68.95636870814398, -525.6073779827124, -919.8209516540068, -231.14915759941167, -1159.5939917388002, -1357.4503729774488, -672.6426822495546, -130.07050962098586, -258.768085700812, -42.653381066646205, -97.07651672136646, -728.6693759673221, -248.1391562927237, -851.1680676220033, -194.60194598960166, -78.76396777680591, -1034.4100350482709, -1315.6298147059535, -1168.7126626487247, -56.27390884803351, -225.96077052301854, -122.44761079426496, -311.2928698303054, -1107.55479310833, -13.172504846417203, -219.32893186287504, -225.2797399740225, -1034.5423716691548, -31.873992927035687, -917.7131968664125, -56.8885894322018, -661.6241676799149, -387.43173594780995, -47.20773924624388, -333.439447515095, -517.4759981417285, -322.8799879213791, -130.9120148637583, -530.1015434522212, -241.64883732616707, -52.146081881541015, -980.2965653586257, -813.5367420876048, -300.4656762181725, -1063.9717561040043, -598.5189271568885, -135.44300793527918, -697.9185240850974, -544.6302331693738, -979.4572471865032, -82.16957177288108, -642.3073081061626, -76.43512835967175, -981.0648426681873, -810.7446075411805, -1158.5314881976722, -447.2467808650998, -1249.371378484341, -478.1306116730355, -263.84671758466345, -1076.9752597889212, -308.32804949640604, -374.5761123880936, -141.86054249216298, -258.9700137104187, -917.144090926063, -650.1201491966896, -441.05229920702556, -36.02511651676954, -252.95840862756387, -566.7935768282475, -729.809563098797, -81.77958075819953, -1154.9998903215567, -50.58993430087661, -969.1249258222874, -903.0835299306978, -223.6875428603707, -242.3553686089532, -334.58876850469545, -194.2922781156077, -318.90577426763275, -1076.240781298299, -1127.2797810111356, -1147.3264989330494, -328.85015283726153, -127.8449298809941, -744.4341750137286, -435.5104586638415, -1003.3726458888644, -965.7778856886532, -101.42838772521543, -752.9028313624539, -554.1491574325657, -630.8246452305613, -1126.9851971162461, -350.8882945648817, -974.8430917945155, -82.50978465858041, -258.41807433588485, -758.3405135042966, -579.4352616291436, -117.33972399902713, -187.65468549696502, -25.631200130126714, -630.6305369498019, -1147.578127075157, -641.7088111398392, -435.7575412840834, -459.80621600066246, -126.38456912676227, -1327.6539530933494, -75.09379064579817, -187.92541375324484, -677.8828105008796, -108.38709358232565, -70.37539158947553, -17.45036308864985, -168.19577503769898, -1323.7113920317865, -264.9762005509978, -1098.7905275752642, -994.6258305801299, -1255.9904142913858, -445.8422240907978, -212.56786652172693, -100.86022050052266, -295.4588004284326, -273.8962195838938, -692.1151829922745, -104.6674868511433, -579.9330720132061, -617.0082924148483, -187.56749098038713, -863.1379340914806, -213.12681474526576, -372.78923668640294, -267.25184896778643, -487.49688780380666, -1126.4640475937588, -449.2524587982732, -1140.9955565452372, -713.7049475479242, -712.8804487130194, -36.082046766050205, -1086.6144404317802, -525.3200350878291, -36.92247269498626, -246.19551279424397, -1191.9454886284213, -465.9437597183488, -743.1298124892962, -710.5265405110396, -292.3768926491577, -694.9089269096478, -835.3402723323052, -65.8342584605759, -355.67270317253883, -239.22717055662542, -304.87048199304655, -1239.714539312955, -994.0651228791769, -141.8859500559678, -23.725883827446985, -346.9744630130536, -869.0691918561048, -223.83057704481075, -77.33431613026474, -92.16334848275379, -16.212185295757624, -392.78923041231275, -414.8585415342226, -769.6988923102989, -893.6185626507879, -973.1064297144144, -462.10414855783523, -495.7721499848827, -61.20863380568445, -464.18176115433323, -917.1316159768373, -765.8435489186775, -1014.8870305254102, -1176.873097007471, -194.75035984378152, -492.630705937259, -37.42699729395546, -75.53025337129836, -1173.0074840394125, -297.20805328978463, -952.3466328409517, -381.1258681337888, -228.5875060507928, -93.86807132433371, -891.6191623764987, 6.964957672490852, -385.878509906334, -213.15017715872955, -71.58993999215949, -216.2493828885896, -461.21711798678956, -533.2693256294756, -1168.2479663017778, -403.149528258028, -888.0180085861182, -1142.705694259083, -926.861981659641, -457.1950264278299, -463.8305695741377, -149.50875449762054, -255.15866659345699, -933.7299494603926, -380.1501860381905, -242.58223271318326, -143.93149209889887, -712.792229808485, -786.2388069793986, -1365.131116303742, -196.42785472886027, -245.52994899617335, -22.883324236943853, -1035.0298063840462, -323.2995248447825, -32.908036324612766, -1193.0967111104064, -177.4591927118292, -96.98226446388344, -643.7709942650499, -74.03576233725185, -234.50449203939942, -845.6128019386615, -995.0250720983883, -1036.5827674199154, -15.347162981981704, -277.4384068338047, -559.5296141243202, -98.65312994353808, -198.18508343325885, -131.67706048515618, -19.801267062896034, -132.69517760617617, -585.475561954323, -506.06201110319097, -1145.3429440047778, -864.3259371501856, -873.1139395001162, -109.1548354739334, -187.06137064395799, -115.71748938146057, -317.7457342837515, -154.8617336209817, -727.7109283074465, -233.90840892788398, -1119.5704184040299, -165.54987175637942, -398.8692933363353, -264.0715696380059, -138.74802404089942, -132.10604658288352, -1105.7619119193541, -1102.0114256373386, -675.2115158358871, -929.6936758778886, -206.79722765698216, -328.1318669663891, -275.5490645393603, -436.5331029976785, -916.2052609033195, -45.05610275049009, -1099.2415198440544, -673.0924771000325, -147.35986600179945, -422.11895952362573, -157.74514802329028, -794.4472416041141, -666.1502012613524, -1002.6139289902065, -588.0653325910008, -1153.1962776119756, -1382.9252591909583, -799.355436828314, -47.91087899557982, -365.811950503343, -535.3129087148193, -1178.3880574871541, -327.91492295822695, -437.5544142252103, -273.62922055460626, -198.7545955884912, -704.667548971326, -1003.7193319880458, -954.8462243863507, -40.101746180926156, -619.3368324952855, -201.3660895990246, -191.28820195650897, -323.2972826837318, -874.9284019121839, -487.57449335112256, -835.8283423441927, -631.653771568694, -367.9807814026354, -365.51241196736413, -25.90954264402006, -35.36354196123213, -232.9729324423524, -280.1580546116395, -108.18952844905124, -942.998303352874, -127.12497038271832, -985.043299750011, -411.22599277382443, -125.1112771585037, -1231.2923014592507, -1284.3836328356124, -964.9672932674926, -891.79016600724, -1086.8699377311043, -665.4191563031659, -701.6522714895384, -119.21514079616416, -100.03078960755741, -102.12947861297403, -34.94878275674311, -323.9515148703793, -186.22358067911344, -984.2588414673596, -555.8035533878931, -74.6402333364187, -806.8108215392272, -37.395028559400686, -24.592320289796813, -839.4305221577762, -77.59468694164238, -190.2491549023976, -727.2298357726335, -374.0668779796324, -293.8569424620277, -340.21298113495243, 0.7002173483218453, -1116.8189033215317, -867.7402070310012, -133.661897920486, -129.75571731453553, -1203.6482796937923, -1033.9394522532266, -127.05154345540113, -483.7189662302531, -150.97969186766892, -961.8657866026136, -282.623649929647, -100.74531126290432, -15.54036381533825, -1245.49986886543, -81.51219288385019, -57.38954785349671, -660.6444474374895, -123.29860910021691, -81.5837605219891, -38.91866356351116, -454.474888840682]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4834477380653093, "mean_inference_ms": 1.6907843501473345, "mean_action_processing_ms": 0.7891119251944376, "mean_env_wait_ms": 9.902886122663178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013176679611206055, "StateBufferConnector_ms": 0.009826183319091797, "ViewRequirementAgentConnector_ms": 0.32865071296691895}, "num_episodes": 27, "episode_return_max": -523.0382690584937, "episode_return_min": -4926.156235212455, "episode_return_mean": -2473.419044249177, "episodes_this_iter": 27}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1174190, "num_agent_steps_trained": 1174190, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 68.76204859871147, "num_env_steps_trained_throughput_per_sec": 68.76204859871147, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1174190, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1174190, "timers": {"training_iteration_time_ms": 52658.205, "restore_workers_time_ms": 0.028, "training_step_time_ms": 52658.13, "sample_time_ms": 3183.081, "learn_time_ms": 49414.057, "learn_throughput": 80.949, "synch_weights_time_ms": 57.994}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1174190, "num_agent_steps_trained": 1174190}, "done": false, "training_iteration": 68, "trial_id": "efc54_00000", "date": "2024-07-24_19-41-21", "timestamp": 1721830281, "time_this_iter_s": 58.182591915130615, "time_total_s": 3678.2801861763, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x717514104280>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3678.2801861763, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 9.6609756097561, "ram_util_percent": 23.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 133.86892810831165, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 0.0010000000000000005, "total_loss": 4.398042383519086, "policy_loss": 0.00022944771424388618, "vf_loss": 4.417658357427578, "vf_explained_var": 0.984885786293131, "kl": 0.01613785578267216, "entropy": 2.8015214073537575, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.88636363636364, "num_grad_updates_lifetime": 278100.5, "diff_num_grad_updates_vs_sampler_policy": 1979.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1191071, "num_agent_steps_trained": 1191071}, "env_runners": {"episode_reward_max": -581.0117185310253, "episode_reward_min": -4926.156235212455, "episode_reward_mean": -2551.8089966937896, "episode_len_mean": 147.62, "episode_media": {}, "episodes_timesteps_total": 14762, "policy_reward_min": {"policy_0": -1477.8191307804166}, "policy_reward_max": {"policy_0": 6.964957672490852}, "policy_reward_mean": {"policy_0": -510.36179933875803}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2461.5850316154483, -2119.6550625930154, -3653.79038902779, -1780.428549102337, -2428.7382332995, -1486.5916798212643, -1743.0183817052534, -3210.4168216499484, -2955.9679395331423, -2592.721458448087, -3597.1269768048123, -2160.709977876002, -2297.3000644741114, -2583.9725453076762, -2672.8401357270054, -3864.0451136257248, -2640.0123622846904, -3005.0829074394483, -2793.644442470109, -1668.4013847595584, -3315.481232449547, -2394.940537120035, -1688.1200153299371, -4060.2251970885777, -1574.8982900268509, -2352.314276351066, -2467.128835797022, -3052.915458370502, -3086.9979496372616, -2906.8859322774915, -1800.9448865150941, -2746.3659590886014, -1278.6096188096915, -3444.0716566220417, -2400.3983094795735, -3644.9847422326006, -2535.5194208354023, -1588.2356502129232, -1348.0851279326027, -4135.390523034483, -2252.5549987526865, -2413.1860901191485, -2616.211051245119, -2761.7932713756773, -1894.906315044248, -2883.92302345841, -581.0117185310253, -3974.3203937125936, -884.5411634040848, -2645.608920732078, -2742.6989778184807, -2415.383350876507, -3170.1284635955717, -2187.821416414182, -4926.156235212455, -2455.3387186591244, -2618.325111327678, -2006.9390946180943, -3153.282291859925, -1027.739210417604, -2443.5141565462923, -4016.9804974946824, -3464.9466723272158, -747.2841465267674, -2458.9084782902983, -1859.0965200642468, -2124.2554875498213, -3368.7455542130465, -2006.2396380855814, -1500.6872846810195, -1358.9203694638857, -3401.6641272386314, -1519.383515364542, -2356.061123165668, -1466.5560966583735, -3728.884884971529, -2616.3039381649655, -2352.379249405194, -2860.426482695052, -4257.880713518048, -3384.8011288060907, -1719.4020365450287, -1409.9212957789546, -1378.3147429934518, -2114.502073161883, -2477.4013852952025, -1787.9218359251888, -3537.119402352475, -3332.4463458232067, -2102.6662927846473, -1942.3598904090798, -1584.7883434132452, -3976.603650674599, -2793.8891655018424, -2459.8027092653524, -2987.295691574005, -3620.812992773148, -3057.5683776376354, -3912.3410255080707, -2541.3894527801353], "episode_lengths": [150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 89, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 144, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1357.4503729774488, -672.6426822495546, -130.07050962098586, -258.768085700812, -42.653381066646205, -97.07651672136646, -728.6693759673221, -248.1391562927237, -851.1680676220033, -194.60194598960166, -78.76396777680591, -1034.4100350482709, -1315.6298147059535, -1168.7126626487247, -56.27390884803351, -225.96077052301854, -122.44761079426496, -311.2928698303054, -1107.55479310833, -13.172504846417203, -219.32893186287504, -225.2797399740225, -1034.5423716691548, -31.873992927035687, -917.7131968664125, -56.8885894322018, -661.6241676799149, -387.43173594780995, -47.20773924624388, -333.439447515095, -517.4759981417285, -322.8799879213791, -130.9120148637583, -530.1015434522212, -241.64883732616707, -52.146081881541015, -980.2965653586257, -813.5367420876048, -300.4656762181725, -1063.9717561040043, -598.5189271568885, -135.44300793527918, -697.9185240850974, -544.6302331693738, -979.4572471865032, -82.16957177288108, -642.3073081061626, -76.43512835967175, -981.0648426681873, -810.7446075411805, -1158.5314881976722, -447.2467808650998, -1249.371378484341, -478.1306116730355, -263.84671758466345, -1076.9752597889212, -308.32804949640604, -374.5761123880936, -141.86054249216298, -258.9700137104187, -917.144090926063, -650.1201491966896, -441.05229920702556, -36.02511651676954, -252.95840862756387, -566.7935768282475, -729.809563098797, -81.77958075819953, -1154.9998903215567, -50.58993430087661, -969.1249258222874, -903.0835299306978, -223.6875428603707, -242.3553686089532, -334.58876850469545, -194.2922781156077, -318.90577426763275, -1076.240781298299, -1127.2797810111356, -1147.3264989330494, -328.85015283726153, -127.8449298809941, -744.4341750137286, -435.5104586638415, -1003.3726458888644, -965.7778856886532, -101.42838772521543, -752.9028313624539, -554.1491574325657, -630.8246452305613, -1126.9851971162461, -350.8882945648817, -974.8430917945155, -82.50978465858041, -258.41807433588485, -758.3405135042966, -579.4352616291436, -117.33972399902713, -187.65468549696502, -25.631200130126714, -630.6305369498019, -1147.578127075157, -641.7088111398392, -435.7575412840834, -459.80621600066246, -126.38456912676227, -1327.6539530933494, -75.09379064579817, -187.92541375324484, -677.8828105008796, -108.38709358232565, -70.37539158947553, -17.45036308864985, -168.19577503769898, -1323.7113920317865, -264.9762005509978, -1098.7905275752642, -994.6258305801299, -1255.9904142913858, -445.8422240907978, -212.56786652172693, -100.86022050052266, -295.4588004284326, -273.8962195838938, -692.1151829922745, -104.6674868511433, -579.9330720132061, -617.0082924148483, -187.56749098038713, -863.1379340914806, -213.12681474526576, -372.78923668640294, -267.25184896778643, -487.49688780380666, -1126.4640475937588, -449.2524587982732, -1140.9955565452372, -713.7049475479242, -712.8804487130194, -36.082046766050205, -1086.6144404317802, -525.3200350878291, -36.92247269498626, -246.19551279424397, -1191.9454886284213, -465.9437597183488, -743.1298124892962, -710.5265405110396, -292.3768926491577, -694.9089269096478, -835.3402723323052, -65.8342584605759, -355.67270317253883, -239.22717055662542, -304.87048199304655, -1239.714539312955, -994.0651228791769, -141.8859500559678, -23.725883827446985, -346.9744630130536, -869.0691918561048, -223.83057704481075, -77.33431613026474, -92.16334848275379, -16.212185295757624, -392.78923041231275, -414.8585415342226, -769.6988923102989, -893.6185626507879, -973.1064297144144, -462.10414855783523, -495.7721499848827, -61.20863380568445, -464.18176115433323, -917.1316159768373, -765.8435489186775, -1014.8870305254102, -1176.873097007471, -194.75035984378152, -492.630705937259, -37.42699729395546, -75.53025337129836, -1173.0074840394125, -297.20805328978463, -952.3466328409517, -381.1258681337888, -228.5875060507928, -93.86807132433371, -891.6191623764987, 6.964957672490852, -385.878509906334, -213.15017715872955, -71.58993999215949, -216.2493828885896, -461.21711798678956, -533.2693256294756, -1168.2479663017778, -403.149528258028, -888.0180085861182, -1142.705694259083, -926.861981659641, -457.1950264278299, -463.8305695741377, -149.50875449762054, -255.15866659345699, -933.7299494603926, -380.1501860381905, -242.58223271318326, -143.93149209889887, -712.792229808485, -786.2388069793986, -1365.131116303742, -196.42785472886027, -245.52994899617335, -22.883324236943853, -1035.0298063840462, -323.2995248447825, -32.908036324612766, -1193.0967111104064, -177.4591927118292, -96.98226446388344, -643.7709942650499, -74.03576233725185, -234.50449203939942, -845.6128019386615, -995.0250720983883, -1036.5827674199154, -15.347162981981704, -277.4384068338047, -559.5296141243202, -98.65312994353808, -198.18508343325885, -131.67706048515618, -19.801267062896034, -132.69517760617617, -585.475561954323, -506.06201110319097, -1145.3429440047778, -864.3259371501856, -873.1139395001162, -109.1548354739334, -187.06137064395799, -115.71748938146057, -317.7457342837515, -154.8617336209817, -727.7109283074465, -233.90840892788398, -1119.5704184040299, -165.54987175637942, -398.8692933363353, -264.0715696380059, -138.74802404089942, -132.10604658288352, -1105.7619119193541, -1102.0114256373386, -675.2115158358871, -929.6936758778886, -206.79722765698216, -328.1318669663891, -275.5490645393603, -436.5331029976785, -916.2052609033195, -45.05610275049009, -1099.2415198440544, -673.0924771000325, -147.35986600179945, -422.11895952362573, -157.74514802329028, -794.4472416041141, -666.1502012613524, -1002.6139289902065, -588.0653325910008, -1153.1962776119756, -1382.9252591909583, -799.355436828314, -47.91087899557982, -365.811950503343, -535.3129087148193, -1178.3880574871541, -327.91492295822695, -437.5544142252103, -273.62922055460626, -198.7545955884912, -704.667548971326, -1003.7193319880458, -954.8462243863507, -40.101746180926156, -619.3368324952855, -201.3660895990246, -191.28820195650897, -323.2972826837318, -874.9284019121839, -487.57449335112256, -835.8283423441927, -631.653771568694, -367.9807814026354, -365.51241196736413, -25.90954264402006, -35.36354196123213, -232.9729324423524, -280.1580546116395, -108.18952844905124, -942.998303352874, -127.12497038271832, -985.043299750011, -411.22599277382443, -125.1112771585037, -1231.2923014592507, -1284.3836328356124, -964.9672932674926, -891.79016600724, -1086.8699377311043, -665.4191563031659, -701.6522714895384, -119.21514079616416, -100.03078960755741, -102.12947861297403, -34.94878275674311, -323.9515148703793, -186.22358067911344, -984.2588414673596, -555.8035533878931, -74.6402333364187, -806.8108215392272, -37.395028559400686, -24.592320289796813, -839.4305221577762, -77.59468694164238, -190.2491549023976, -727.2298357726335, -374.0668779796324, -293.8569424620277, -340.21298113495243, 0.7002173483218453, -1116.8189033215317, -867.7402070310012, -133.661897920486, -129.75571731453553, -1203.6482796937923, -1033.9394522532266, -127.05154345540113, -483.7189662302531, -150.97969186766892, -961.8657866026136, -282.623649929647, -100.74531126290432, -15.54036381533825, -1245.49986886543, -81.51219288385019, -57.38954785349671, -660.6444474374895, -123.29860910021691, -81.5837605219891, -38.91866356351116, -454.474888840682, -307.3766579664493, -772.9303294287267, -1420.6845709534025, -440.2822200695856, -460.3903488204683, -517.3175032794272, -46.042172640644466, -784.8104372330057, -103.77851090945872, -67.43489130200572, -74.53917181360507, -162.3132982146153, -838.3644477955189, -256.104766125178, -1024.7394392167496, -137.0727940420998, -190.9454714443933, -499.1919278421839, -442.437815570848, -196.90808775884705, -1477.8191307804166, -609.8716033108045, -640.7683109480216, -755.9406348993715, -244.48520503291738, -632.3143562285576, -882.1940236355413, -700.1489733069745, -181.88072124554196, -219.7658637483536, -718.5546453571383, -38.79782643628321, -415.19404199460706, -852.2264246974488, -327.6063109197179, -108.12815689142336, -1152.2750233160234, -1077.9310723124245, -64.00478180103097, -458.0874483741473, -1137.0441785999296, -986.4164825373016, -828.014541143271, -1235.814722653422, -70.59078858412445, -202.75300129164697, -859.6787317874476, -1443.043088384492, -669.6044071361576, -209.7219002063468, -251.0230456782539, -122.1463096954738, -570.4518003285759, -384.90653309769334, -390.8743477450334, -109.15408944891209, -193.46969790901937, -738.4473835972268, -30.648925419911578, -338.20119940388565, -989.4946680427281, -155.0136864864914, -76.82934605705483, -72.62648494498977, -84.35055746218855, -168.07808115249787, -81.79901065012808, -532.4775018679695, -1018.4032330329251, -313.74424645836183, -25.948153088508814, -766.7076292214164, -488.52384952284416, -1008.9204473260655, -187.30130613637138, -1035.2857974344058, -196.14900564972774, -90.5920635684875, -439.114629565619, -26.780339706950333, -210.02639572940453, -1033.1300910129712, -1079.1234507612287, -364.33964758236596, -850.4998172665064, -577.8748474584195, -535.3777097854299, -173.35222368615172, -978.9467316445246, -1066.8948332486827, -395.1159583637807, -283.51120068337605, -1068.9184973894257, -149.74252756568762, -205.3781087823763, -328.2191791648444, -417.61678378668125, -1068.856732175848, -37.556394488170795, -90.11080079353592, -158.14950528590225, -131.89301023914055, -299.8536570435213, -485.6525084700917, -509.2396623745902, -1328.526767926071, -708.4267900958798, -1000.0810438420779, -79.65929469723194, -859.9097541133401, -976.4908242411188, -635.3972636254424, -33.16834153137409, -940.3972939747811, -208.43544212912573, -281.2703157521612, -118.86577721075315, -111.61388122845023, -1303.8913020749844, -644.1614329990032, -726.1049566778223, -1158.5563255909549, -514.1809313174927, -186.80868375058662, -401.6447942371509, -462.2281662781983, -1298.9205082959793, -221.74517807077382, -491.60689344624143, -1146.312246681958, -12.307738527517454, -1091.8146279026348, -780.463144392618, -888.1116209756457, -284.8712458392181, -696.7609892626234, -430.26667380466205, -610.7314700343686, -1098.2698048907002, -1076.3120875157163, -1190.9920617216317, -74.86331949698133, -141.18533163450988, -23.3988672689624, -1110.9498726580523]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4820700039727015, "mean_inference_ms": 1.6907460669318584, "mean_action_processing_ms": 0.7886225701701899, "mean_env_wait_ms": 9.90496237065635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013319730758666992, "StateBufferConnector_ms": 0.009943485260009766, "ViewRequirementAgentConnector_ms": 0.3297896385192871}, "num_episodes": 29, "episode_return_max": -581.0117185310253, "episode_return_min": -4926.156235212455, "episode_return_mean": -2551.8089966937896, "episodes_this_iter": 29}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1191071, "num_agent_steps_trained": 1191071, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.96691785078978, "num_env_steps_trained_throughput_per_sec": 72.96691785078978, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 1191071, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1191071, "timers": {"training_iteration_time_ms": 52570.146, "restore_workers_time_ms": 0.029, "training_step_time_ms": 52570.07, "sample_time_ms": 3173.302, "learn_time_ms": 49336.744, "learn_throughput": 81.075, "synch_weights_time_ms": 57.028}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1191071, "num_agent_steps_trained": 1191071}, "done": false, "training_iteration": 69, "trial_id": "efc54_00000", "date": "2024-07-24_19-42-16", "timestamp": 1721830336, "time_this_iter_s": 54.83090305328369, "time_total_s": 3733.1110892295837, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7e91b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3733.1110892295837, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 9.79871794871795, "ram_util_percent": 23.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 133.21793043701737, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 0.0010000000000000005, "total_loss": 4.279413844290234, "policy_loss": 0.00474576339034472, "vf_loss": 4.295204605942681, "vf_explained_var": 0.9819927684844486, "kl": 0.01586835303378634, "entropy": 2.8569881125732706, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.80952380952381, "num_grad_updates_lifetime": 281970.5, "diff_num_grad_updates_vs_sampler_policy": 1889.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1207175, "num_agent_steps_trained": 1207175}, "env_runners": {"episode_reward_max": -581.0117185310253, "episode_reward_min": -4926.156235212455, "episode_reward_mean": -2540.763113036366, "episode_len_mean": 147.56, "episode_media": {}, "episodes_timesteps_total": 14756, "policy_reward_min": {"policy_0": -1477.8191307804166}, "policy_reward_max": {"policy_0": 6.964957672490852}, "policy_reward_mean": {"policy_0": -508.15262260727326}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2352.314276351066, -2467.128835797022, -3052.915458370502, -3086.9979496372616, -2906.8859322774915, -1800.9448865150941, -2746.3659590886014, -1278.6096188096915, -3444.0716566220417, -2400.3983094795735, -3644.9847422326006, -2535.5194208354023, -1588.2356502129232, -1348.0851279326027, -4135.390523034483, -2252.5549987526865, -2413.1860901191485, -2616.211051245119, -2761.7932713756773, -1894.906315044248, -2883.92302345841, -581.0117185310253, -3974.3203937125936, -884.5411634040848, -2645.608920732078, -2742.6989778184807, -2415.383350876507, -3170.1284635955717, -2187.821416414182, -4926.156235212455, -2455.3387186591244, -2618.325111327678, -2006.9390946180943, -3153.282291859925, -1027.739210417604, -2443.5141565462923, -4016.9804974946824, -3464.9466723272158, -747.2841465267674, -2458.9084782902983, -1859.0965200642468, -2124.2554875498213, -3368.7455542130465, -2006.2396380855814, -1500.6872846810195, -1358.9203694638857, -3401.6641272386314, -1519.383515364542, -2356.061123165668, -1466.5560966583735, -3728.884884971529, -2616.3039381649655, -2352.379249405194, -2860.426482695052, -4257.880713518048, -3384.8011288060907, -1719.4020365450287, -1409.9212957789546, -1378.3147429934518, -2114.502073161883, -2477.4013852952025, -1787.9218359251888, -3537.119402352475, -3332.4463458232067, -2102.6662927846473, -1942.3598904090798, -1584.7883434132452, -3976.603650674599, -2793.8891655018424, -2459.8027092653524, -2987.295691574005, -3620.812992773148, -3057.5683776376354, -3912.3410255080707, -2541.3894527801353, -1611.3547916804348, -1448.7090008628948, -1559.7485840292472, -2408.726460254097, -4126.730132906481, -3125.835067528967, -2159.3536813206847, -2828.494055726184, -3006.937507102695, -2953.3362838387125, -1898.3297194888105, -1456.7129208821966, -3946.643058505015, -2711.474416434959, -2976.6385327925673, -1786.7301036261492, -3535.233985404595, -2735.4195338619793, -2161.8434009141984, -2573.2221588000702, -2217.549814604944, -2290.6370919551805, -2009.6418270856057, -3316.433436211706, -2799.3907980190907], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 89, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 144, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 144, 150, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-104.6674868511433, -579.9330720132061, -617.0082924148483, -187.56749098038713, -863.1379340914806, -213.12681474526576, -372.78923668640294, -267.25184896778643, -487.49688780380666, -1126.4640475937588, -449.2524587982732, -1140.9955565452372, -713.7049475479242, -712.8804487130194, -36.082046766050205, -1086.6144404317802, -525.3200350878291, -36.92247269498626, -246.19551279424397, -1191.9454886284213, -465.9437597183488, -743.1298124892962, -710.5265405110396, -292.3768926491577, -694.9089269096478, -835.3402723323052, -65.8342584605759, -355.67270317253883, -239.22717055662542, -304.87048199304655, -1239.714539312955, -994.0651228791769, -141.8859500559678, -23.725883827446985, -346.9744630130536, -869.0691918561048, -223.83057704481075, -77.33431613026474, -92.16334848275379, -16.212185295757624, -392.78923041231275, -414.8585415342226, -769.6988923102989, -893.6185626507879, -973.1064297144144, -462.10414855783523, -495.7721499848827, -61.20863380568445, -464.18176115433323, -917.1316159768373, -765.8435489186775, -1014.8870305254102, -1176.873097007471, -194.75035984378152, -492.630705937259, -37.42699729395546, -75.53025337129836, -1173.0074840394125, -297.20805328978463, -952.3466328409517, -381.1258681337888, -228.5875060507928, -93.86807132433371, -891.6191623764987, 6.964957672490852, -385.878509906334, -213.15017715872955, -71.58993999215949, -216.2493828885896, -461.21711798678956, -533.2693256294756, -1168.2479663017778, -403.149528258028, -888.0180085861182, -1142.705694259083, -926.861981659641, -457.1950264278299, -463.8305695741377, -149.50875449762054, -255.15866659345699, -933.7299494603926, -380.1501860381905, -242.58223271318326, -143.93149209889887, -712.792229808485, -786.2388069793986, -1365.131116303742, -196.42785472886027, -245.52994899617335, -22.883324236943853, -1035.0298063840462, -323.2995248447825, -32.908036324612766, -1193.0967111104064, -177.4591927118292, -96.98226446388344, -643.7709942650499, -74.03576233725185, -234.50449203939942, -845.6128019386615, -995.0250720983883, -1036.5827674199154, -15.347162981981704, -277.4384068338047, -559.5296141243202, -98.65312994353808, -198.18508343325885, -131.67706048515618, -19.801267062896034, -132.69517760617617, -585.475561954323, -506.06201110319097, -1145.3429440047778, -864.3259371501856, -873.1139395001162, -109.1548354739334, -187.06137064395799, -115.71748938146057, -317.7457342837515, -154.8617336209817, -727.7109283074465, -233.90840892788398, -1119.5704184040299, -165.54987175637942, -398.8692933363353, -264.0715696380059, -138.74802404089942, -132.10604658288352, -1105.7619119193541, -1102.0114256373386, -675.2115158358871, -929.6936758778886, -206.79722765698216, -328.1318669663891, -275.5490645393603, -436.5331029976785, -916.2052609033195, -45.05610275049009, -1099.2415198440544, -673.0924771000325, -147.35986600179945, -422.11895952362573, -157.74514802329028, -794.4472416041141, -666.1502012613524, -1002.6139289902065, -588.0653325910008, -1153.1962776119756, -1382.9252591909583, -799.355436828314, -47.91087899557982, -365.811950503343, -535.3129087148193, -1178.3880574871541, -327.91492295822695, -437.5544142252103, -273.62922055460626, -198.7545955884912, -704.667548971326, -1003.7193319880458, -954.8462243863507, -40.101746180926156, -619.3368324952855, -201.3660895990246, -191.28820195650897, -323.2972826837318, -874.9284019121839, -487.57449335112256, -835.8283423441927, -631.653771568694, -367.9807814026354, -365.51241196736413, -25.90954264402006, -35.36354196123213, -232.9729324423524, -280.1580546116395, -108.18952844905124, -942.998303352874, -127.12497038271832, -985.043299750011, -411.22599277382443, -125.1112771585037, -1231.2923014592507, -1284.3836328356124, -964.9672932674926, -891.79016600724, -1086.8699377311043, -665.4191563031659, -701.6522714895384, -119.21514079616416, -100.03078960755741, -102.12947861297403, -34.94878275674311, -323.9515148703793, -186.22358067911344, -984.2588414673596, -555.8035533878931, -74.6402333364187, -806.8108215392272, -37.395028559400686, -24.592320289796813, -839.4305221577762, -77.59468694164238, -190.2491549023976, -727.2298357726335, -374.0668779796324, -293.8569424620277, -340.21298113495243, 0.7002173483218453, -1116.8189033215317, -867.7402070310012, -133.661897920486, -129.75571731453553, -1203.6482796937923, -1033.9394522532266, -127.05154345540113, -483.7189662302531, -150.97969186766892, -961.8657866026136, -282.623649929647, -100.74531126290432, -15.54036381533825, -1245.49986886543, -81.51219288385019, -57.38954785349671, -660.6444474374895, -123.29860910021691, -81.5837605219891, -38.91866356351116, -454.474888840682, -307.3766579664493, -772.9303294287267, -1420.6845709534025, -440.2822200695856, -460.3903488204683, -517.3175032794272, -46.042172640644466, -784.8104372330057, -103.77851090945872, -67.43489130200572, -74.53917181360507, -162.3132982146153, -838.3644477955189, -256.104766125178, -1024.7394392167496, -137.0727940420998, -190.9454714443933, -499.1919278421839, -442.437815570848, -196.90808775884705, -1477.8191307804166, -609.8716033108045, -640.7683109480216, -755.9406348993715, -244.48520503291738, -632.3143562285576, -882.1940236355413, -700.1489733069745, -181.88072124554196, -219.7658637483536, -718.5546453571383, -38.79782643628321, -415.19404199460706, -852.2264246974488, -327.6063109197179, -108.12815689142336, -1152.2750233160234, -1077.9310723124245, -64.00478180103097, -458.0874483741473, -1137.0441785999296, -986.4164825373016, -828.014541143271, -1235.814722653422, -70.59078858412445, -202.75300129164697, -859.6787317874476, -1443.043088384492, -669.6044071361576, -209.7219002063468, -251.0230456782539, -122.1463096954738, -570.4518003285759, -384.90653309769334, -390.8743477450334, -109.15408944891209, -193.46969790901937, -738.4473835972268, -30.648925419911578, -338.20119940388565, -989.4946680427281, -155.0136864864914, -76.82934605705483, -72.62648494498977, -84.35055746218855, -168.07808115249787, -81.79901065012808, -532.4775018679695, -1018.4032330329251, -313.74424645836183, -25.948153088508814, -766.7076292214164, -488.52384952284416, -1008.9204473260655, -187.30130613637138, -1035.2857974344058, -196.14900564972774, -90.5920635684875, -439.114629565619, -26.780339706950333, -210.02639572940453, -1033.1300910129712, -1079.1234507612287, -364.33964758236596, -850.4998172665064, -577.8748474584195, -535.3777097854299, -173.35222368615172, -978.9467316445246, -1066.8948332486827, -395.1159583637807, -283.51120068337605, -1068.9184973894257, -149.74252756568762, -205.3781087823763, -328.2191791648444, -417.61678378668125, -1068.856732175848, -37.556394488170795, -90.11080079353592, -158.14950528590225, -131.89301023914055, -299.8536570435213, -485.6525084700917, -509.2396623745902, -1328.526767926071, -708.4267900958798, -1000.0810438420779, -79.65929469723194, -859.9097541133401, -976.4908242411188, -635.3972636254424, -33.16834153137409, -940.3972939747811, -208.43544212912573, -281.2703157521612, -118.86577721075315, -111.61388122845023, -1303.8913020749844, -644.1614329990032, -726.1049566778223, -1158.5563255909549, -514.1809313174927, -186.80868375058662, -401.6447942371509, -462.2281662781983, -1298.9205082959793, -221.74517807077382, -491.60689344624143, -1146.312246681958, -12.307738527517454, -1091.8146279026348, -780.463144392618, -888.1116209756457, -284.8712458392181, -696.7609892626234, -430.26667380466205, -610.7314700343686, -1098.2698048907002, -1076.3120875157163, -1190.9920617216317, -74.86331949698133, -141.18533163450988, -23.3988672689624, -1110.9498726580523, -318.2221471021092, -367.876629451262, -222.3802516625465, -499.7305227828025, -203.1452406817144, -13.165595817244643, -293.8393500537258, -821.7850354926641, -104.75308066441524, -215.16593883484578, -234.0434037724739, -229.3510042263268, -422.2157131810048, -429.5773570680956, -244.5611057813463, -519.726747734059, -175.33354721060238, -1272.5211017380077, -222.03209916947068, -219.11296440195972, -1197.5237848451254, -1093.044189411435, -178.32894353526686, -796.4140498210188, -861.4191652936385, -542.4915278856074, -882.119521608536, -38.30384479171866, -1238.4136583551322, -424.5065148879726, -44.91811204019246, -698.4345180652704, -1147.6742850898484, -42.88546381101361, -225.44130231436105, -493.5076407798588, -177.31664327418076, -786.8365431177823, -889.7540162030191, -481.0792123513388, -38.8446654112911, -564.7976782096871, -1298.5974902721955, -592.8593514618543, -511.8383217476653, -1353.053235875454, -101.6463512880748, -581.7043751728925, -94.19614675739827, -822.7361747448898, -425.117131424214, -58.214653328906856, -54.653329944077385, -1219.672355155446, -140.67224963616525, -260.63451379889443, -218.2762425985761, -637.4376584517228, -318.3376555927759, -22.026850440227307, -770.3648206140624, -970.999910249787, -426.6936836432317, -684.1836055547163, -1094.4010384432208, -121.75778067203011, -1292.0130952305042, -496.17494946780994, -213.2786929027114, -588.249898161905, -1201.803858474725, -723.1701358292495, -37.74862708319026, -207.14701859085255, -806.7688928145523, -62.47675216712412, -209.3594787397394, -993.2493117433303, -237.35170736445158, -284.2928536115038, -978.3479506048978, -759.4302850024318, -52.079679418339325, -1101.512749490415, -643.8633208885085, -1272.3568998013084, -651.3890852342842, -242.39988589082748, -104.99315545508696, -464.28050748047144, -225.90289372262757, -345.25235268858165, -880.1780059570718, -329.01269202223085, -381.49745652368665, -326.3332826050141, -1017.1685981049982, -396.2071475888336, -21.548700132245877, -811.9644303689778, -623.0675809524402, -1085.9540630666595, -435.1913598755873, -39.749846973242406, -33.58696373701331, -340.9243981372659, -663.1655013168544, -161.4980357895976, -912.96787729838, -212.08127941308317, -27.719927518299976, -55.22183596171907, -1262.299325712698, -385.71065861224054, -278.6900792806487, -772.1489237355376, -1428.1462385376294, -264.3401318867847, -307.7787253727632, -544.0194166789953, -257.8973327879998, -829.5890829059097, -743.9742772523979, -834.5405391296991, -133.38956594308436]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.479987694959737, "mean_inference_ms": 1.6897243928779184, "mean_action_processing_ms": 0.7875053854003714, "mean_env_wait_ms": 9.89230282411073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013204097747802734, "StateBufferConnector_ms": 0.00966644287109375, "ViewRequirementAgentConnector_ms": 0.3187832832336426}, "num_episodes": 25, "episode_return_max": -581.0117185310253, "episode_return_min": -4926.156235212455, "episode_return_mean": -2540.763113036366, "episodes_this_iter": 25}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1207175, "num_agent_steps_trained": 1207175, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.83060140720234, "num_env_steps_trained_throughput_per_sec": 76.83060140720234, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 1207175, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1207175, "timers": {"training_iteration_time_ms": 52614.731, "restore_workers_time_ms": 0.029, "training_step_time_ms": 52614.654, "sample_time_ms": 3175.437, "learn_time_ms": 49380.092, "learn_throughput": 81.004, "synch_weights_time_ms": 56.151}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1207175, "num_agent_steps_trained": 1207175}, "done": false, "training_iteration": 70, "trial_id": "efc54_00000", "date": "2024-07-24_19-43-08", "timestamp": 1721830388, "time_this_iter_s": 52.0750470161438, "time_total_s": 3785.1861362457275, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x717514107760>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3785.1861362457275, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 10.048648648648651, "ram_util_percent": 23.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 136.95807727033443, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 0.0010000000000000005, "total_loss": 4.48943856689665, "policy_loss": 0.003311298366499632, "vf_loss": 4.5056133414759785, "vf_explained_var": 0.9839640645968794, "kl": 0.016833348146103547, "entropy": 2.8007958061767346, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.5, "num_grad_updates_lifetime": 285840.5, "diff_num_grad_updates_vs_sampler_policy": 1979.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1224005, "num_agent_steps_trained": 1224005}, "env_runners": {"episode_reward_max": -747.2841465267674, "episode_reward_min": -4926.156235212455, "episode_reward_mean": -2593.885919169823, "episode_len_mean": 148.79, "episode_media": {}, "episodes_timesteps_total": 14879, "policy_reward_min": {"policy_0": -1477.8191307804166}, "policy_reward_max": {"policy_0": 0.7002173483218453}, "policy_reward_mean": {"policy_0": -518.7771838339648}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2415.383350876507, -3170.1284635955717, -2187.821416414182, -4926.156235212455, -2455.3387186591244, -2618.325111327678, -2006.9390946180943, -3153.282291859925, -1027.739210417604, -2443.5141565462923, -4016.9804974946824, -3464.9466723272158, -747.2841465267674, -2458.9084782902983, -1859.0965200642468, -2124.2554875498213, -3368.7455542130465, -2006.2396380855814, -1500.6872846810195, -1358.9203694638857, -3401.6641272386314, -1519.383515364542, -2356.061123165668, -1466.5560966583735, -3728.884884971529, -2616.3039381649655, -2352.379249405194, -2860.426482695052, -4257.880713518048, -3384.8011288060907, -1719.4020365450287, -1409.9212957789546, -1378.3147429934518, -2114.502073161883, -2477.4013852952025, -1787.9218359251888, -3537.119402352475, -3332.4463458232067, -2102.6662927846473, -1942.3598904090798, -1584.7883434132452, -3976.603650674599, -2793.8891655018424, -2459.8027092653524, -2987.295691574005, -3620.812992773148, -3057.5683776376354, -3912.3410255080707, -2541.3894527801353, -1611.3547916804348, -1448.7090008628948, -1559.7485840292472, -2408.726460254097, -4126.730132906481, -3125.835067528967, -2159.3536813206847, -2828.494055726184, -3006.937507102695, -2953.3362838387125, -1898.3297194888105, -1456.7129208821966, -3946.643058505015, -2711.474416434959, -2976.6385327925673, -1786.7301036261492, -3535.233985404595, -2735.4195338619793, -2161.8434009141984, -2573.2221588000702, -2217.549814604944, -2290.6370919551805, -2009.6418270856057, -3316.433436211706, -2799.3907980190907, -2913.7132078111063, -4115.697672061928, -3018.97730960286, -2431.3127468671746, -2505.142145700036, -3979.2890742478044, -1924.4012732501512, -1936.277363911556, -2729.110171780793, -4458.0217398493305, -1088.4423791110605, -2875.3239366904318, -3388.8416050734177, -2639.1310495744347, -2373.347764097665, -1571.0999580349007, -1962.5471193571389, -1128.7148200670717, -1723.2380794953738, -4225.4666553495945, -2289.0651338546604, -2542.031966600868, -2990.243546767634, -2780.3791511937866, -2265.553009145183, -3896.5160052396955], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 89, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 144, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 144, 150, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-675.2115158358871, -929.6936758778886, -206.79722765698216, -328.1318669663891, -275.5490645393603, -436.5331029976785, -916.2052609033195, -45.05610275049009, -1099.2415198440544, -673.0924771000325, -147.35986600179945, -422.11895952362573, -157.74514802329028, -794.4472416041141, -666.1502012613524, -1002.6139289902065, -588.0653325910008, -1153.1962776119756, -1382.9252591909583, -799.355436828314, -47.91087899557982, -365.811950503343, -535.3129087148193, -1178.3880574871541, -327.91492295822695, -437.5544142252103, -273.62922055460626, -198.7545955884912, -704.667548971326, -1003.7193319880458, -954.8462243863507, -40.101746180926156, -619.3368324952855, -201.3660895990246, -191.28820195650897, -323.2972826837318, -874.9284019121839, -487.57449335112256, -835.8283423441927, -631.653771568694, -367.9807814026354, -365.51241196736413, -25.90954264402006, -35.36354196123213, -232.9729324423524, -280.1580546116395, -108.18952844905124, -942.998303352874, -127.12497038271832, -985.043299750011, -411.22599277382443, -125.1112771585037, -1231.2923014592507, -1284.3836328356124, -964.9672932674926, -891.79016600724, -1086.8699377311043, -665.4191563031659, -701.6522714895384, -119.21514079616416, -100.03078960755741, -102.12947861297403, -34.94878275674311, -323.9515148703793, -186.22358067911344, -984.2588414673596, -555.8035533878931, -74.6402333364187, -806.8108215392272, -37.395028559400686, -24.592320289796813, -839.4305221577762, -77.59468694164238, -190.2491549023976, -727.2298357726335, -374.0668779796324, -293.8569424620277, -340.21298113495243, 0.7002173483218453, -1116.8189033215317, -867.7402070310012, -133.661897920486, -129.75571731453553, -1203.6482796937923, -1033.9394522532266, -127.05154345540113, -483.7189662302531, -150.97969186766892, -961.8657866026136, -282.623649929647, -100.74531126290432, -15.54036381533825, -1245.49986886543, -81.51219288385019, -57.38954785349671, -660.6444474374895, -123.29860910021691, -81.5837605219891, -38.91866356351116, -454.474888840682, -307.3766579664493, -772.9303294287267, -1420.6845709534025, -440.2822200695856, -460.3903488204683, -517.3175032794272, -46.042172640644466, -784.8104372330057, -103.77851090945872, -67.43489130200572, -74.53917181360507, -162.3132982146153, -838.3644477955189, -256.104766125178, -1024.7394392167496, -137.0727940420998, -190.9454714443933, -499.1919278421839, -442.437815570848, -196.90808775884705, -1477.8191307804166, -609.8716033108045, -640.7683109480216, -755.9406348993715, -244.48520503291738, -632.3143562285576, -882.1940236355413, -700.1489733069745, -181.88072124554196, -219.7658637483536, -718.5546453571383, -38.79782643628321, -415.19404199460706, -852.2264246974488, -327.6063109197179, -108.12815689142336, -1152.2750233160234, -1077.9310723124245, -64.00478180103097, -458.0874483741473, -1137.0441785999296, -986.4164825373016, -828.014541143271, -1235.814722653422, -70.59078858412445, -202.75300129164697, -859.6787317874476, -1443.043088384492, -669.6044071361576, -209.7219002063468, -251.0230456782539, -122.1463096954738, -570.4518003285759, -384.90653309769334, -390.8743477450334, -109.15408944891209, -193.46969790901937, -738.4473835972268, -30.648925419911578, -338.20119940388565, -989.4946680427281, -155.0136864864914, -76.82934605705483, -72.62648494498977, -84.35055746218855, -168.07808115249787, -81.79901065012808, -532.4775018679695, -1018.4032330329251, -313.74424645836183, -25.948153088508814, -766.7076292214164, -488.52384952284416, -1008.9204473260655, -187.30130613637138, -1035.2857974344058, -196.14900564972774, -90.5920635684875, -439.114629565619, -26.780339706950333, -210.02639572940453, -1033.1300910129712, -1079.1234507612287, -364.33964758236596, -850.4998172665064, -577.8748474584195, -535.3777097854299, -173.35222368615172, -978.9467316445246, -1066.8948332486827, -395.1159583637807, -283.51120068337605, -1068.9184973894257, -149.74252756568762, -205.3781087823763, -328.2191791648444, -417.61678378668125, -1068.856732175848, -37.556394488170795, -90.11080079353592, -158.14950528590225, -131.89301023914055, -299.8536570435213, -485.6525084700917, -509.2396623745902, -1328.526767926071, -708.4267900958798, -1000.0810438420779, -79.65929469723194, -859.9097541133401, -976.4908242411188, -635.3972636254424, -33.16834153137409, -940.3972939747811, -208.43544212912573, -281.2703157521612, -118.86577721075315, -111.61388122845023, -1303.8913020749844, -644.1614329990032, -726.1049566778223, -1158.5563255909549, -514.1809313174927, -186.80868375058662, -401.6447942371509, -462.2281662781983, -1298.9205082959793, -221.74517807077382, -491.60689344624143, -1146.312246681958, -12.307738527517454, -1091.8146279026348, -780.463144392618, -888.1116209756457, -284.8712458392181, -696.7609892626234, -430.26667380466205, -610.7314700343686, -1098.2698048907002, -1076.3120875157163, -1190.9920617216317, -74.86331949698133, -141.18533163450988, -23.3988672689624, -1110.9498726580523, -318.2221471021092, -367.876629451262, -222.3802516625465, -499.7305227828025, -203.1452406817144, -13.165595817244643, -293.8393500537258, -821.7850354926641, -104.75308066441524, -215.16593883484578, -234.0434037724739, -229.3510042263268, -422.2157131810048, -429.5773570680956, -244.5611057813463, -519.726747734059, -175.33354721060238, -1272.5211017380077, -222.03209916947068, -219.11296440195972, -1197.5237848451254, -1093.044189411435, -178.32894353526686, -796.4140498210188, -861.4191652936385, -542.4915278856074, -882.119521608536, -38.30384479171866, -1238.4136583551322, -424.5065148879726, -44.91811204019246, -698.4345180652704, -1147.6742850898484, -42.88546381101361, -225.44130231436105, -493.5076407798588, -177.31664327418076, -786.8365431177823, -889.7540162030191, -481.0792123513388, -38.8446654112911, -564.7976782096871, -1298.5974902721955, -592.8593514618543, -511.8383217476653, -1353.053235875454, -101.6463512880748, -581.7043751728925, -94.19614675739827, -822.7361747448898, -425.117131424214, -58.214653328906856, -54.653329944077385, -1219.672355155446, -140.67224963616525, -260.63451379889443, -218.2762425985761, -637.4376584517228, -318.3376555927759, -22.026850440227307, -770.3648206140624, -970.999910249787, -426.6936836432317, -684.1836055547163, -1094.4010384432208, -121.75778067203011, -1292.0130952305042, -496.17494946780994, -213.2786929027114, -588.249898161905, -1201.803858474725, -723.1701358292495, -37.74862708319026, -207.14701859085255, -806.7688928145523, -62.47675216712412, -209.3594787397394, -993.2493117433303, -237.35170736445158, -284.2928536115038, -978.3479506048978, -759.4302850024318, -52.079679418339325, -1101.512749490415, -643.8633208885085, -1272.3568998013084, -651.3890852342842, -242.39988589082748, -104.99315545508696, -464.28050748047144, -225.90289372262757, -345.25235268858165, -880.1780059570718, -329.01269202223085, -381.49745652368665, -326.3332826050141, -1017.1685981049982, -396.2071475888336, -21.548700132245877, -811.9644303689778, -623.0675809524402, -1085.9540630666595, -435.1913598755873, -39.749846973242406, -33.58696373701331, -340.9243981372659, -663.1655013168544, -161.4980357895976, -912.96787729838, -212.08127941308317, -27.719927518299976, -55.22183596171907, -1262.299325712698, -385.71065861224054, -278.6900792806487, -772.1489237355376, -1428.1462385376294, -264.3401318867847, -307.7787253727632, -544.0194166789953, -257.8973327879998, -829.5890829059097, -743.9742772523979, -834.5405391296991, -133.38956594308436, -1215.7410898518633, -989.6035913205186, -587.410776047882, -35.94738795862236, -85.01036263221873, -980.1642281632941, -1372.3739238437158, -447.2775283914927, -1275.7890483791366, -40.092943284291245, -1387.6052754623497, -158.7598630628074, -1196.5991321859258, -68.06219834064272, -207.95084055113526, -317.7945878864235, -201.35717467556537, -1263.0846822242095, -227.08809314840113, -421.9882089325739, -264.32884600695576, -12.190559469677948, -142.57534116080987, -1222.6363743876773, -863.4110246749154, -1170.8822478010807, -39.119999954043486, -1092.994372931012, -1322.6739379904461, -353.6185155712215, -352.1894282706937, -766.0382125307455, -485.1156769796331, -155.8278005028097, -165.23015496627164, -1117.182295246824, -177.06413541580432, -40.144124049594886, -431.76072135713895, -170.12608784219208, -842.7987157135321, -66.51565354630539, -66.71744777320582, -669.4997836375732, -1083.5785711101762, -1064.0332514949187, -1006.8036311817744, -978.9568829974568, -1266.0154011296654, -142.21257304551057, -65.88559828144112, -99.60209002230484, -617.0289970503007, -211.86022123322599, -94.06547252378904, -220.1992223414246, -1017.4504626981659, -438.39903336362477, -243.0453397335496, -956.2298785536673, -1144.9720457283777, -117.0906183267891, -373.16713815934867, -498.1349211056324, -1255.4768817532745, -614.4357483572527, -509.1263594703876, -363.46152406121666, -125.2733083941507, -1026.834109291426, -569.4427493519128, -249.9724704563682, -868.0629159432798, -23.404210963737718, -662.4654173823665, -37.665541224565075, -27.56586429714432, -90.71366039676104, -305.1892995312179, -1109.9655925852132, -309.7477192974661, -278.11395041877046, -941.7106874650452, -80.91026439599348, -352.06449777986313, -39.20088976783249, -222.24023678058686, -218.01530595291172, -413.7221251165615, -235.53626244917928, -208.500027508847, -382.0131738794046, -79.66032757235456, -944.3877375538228, -108.6768129809439, -241.1909587594169, -1079.0576692714415, -844.0544030372938, -1195.755670141766, -865.4079541396779, -611.5450614160277, -505.11283920738407, -136.27379837730535, -81.97153652914449, -954.1618983247978, -805.9656913843058, -185.7005835365706, -272.68264880012623, -236.1709066441779, -1041.5121362356867, -585.3784361872277, -396.6580069925611, -781.251077799956, -41.2171051051946, -1185.738920682696, -101.40554819084038, -650.5887057518394, -723.9171608717793, -875.1614779499669, -429.30625842936143, -908.9774364360884, -645.1503990021491, -19.912435645493474, -288.9342535382068, -402.57848452324606, -1336.4002377907773, -25.356622267378242, -540.9923464817327, -744.3229698000358, -1249.44382889977]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4817864956706357, "mean_inference_ms": 1.691015858744908, "mean_action_processing_ms": 0.786961861481629, "mean_env_wait_ms": 9.894642849933517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013393640518188477, "StateBufferConnector_ms": 0.009546279907226562, "ViewRequirementAgentConnector_ms": 0.31461381912231445}, "num_episodes": 26, "episode_return_max": -747.2841465267674, "episode_return_min": -4926.156235212455, "episode_return_mean": -2593.885919169823, "episodes_this_iter": 26}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224005, "num_agent_steps_trained": 1224005, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.16580895457174, "num_env_steps_trained_throughput_per_sec": 74.16580895457174, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 1224005, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1224005, "timers": {"training_iteration_time_ms": 52703.796, "restore_workers_time_ms": 0.03, "training_step_time_ms": 52703.718, "sample_time_ms": 3160.494, "learn_time_ms": 49483.776, "learn_throughput": 80.835, "synch_weights_time_ms": 56.428}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1224005, "num_agent_steps_trained": 1224005}, "done": false, "training_iteration": 71, "trial_id": "efc54_00000", "date": "2024-07-24_19-44-02", "timestamp": 1721830442, "time_this_iter_s": 53.94512939453125, "time_total_s": 3839.131265640259, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7ade10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3839.131265640259, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 9.788311688311689, "ram_util_percent": 23.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 141.1226147392399, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 0.001, "total_loss": 4.625311262895029, "policy_loss": 0.00377698440198846, "vf_loss": 4.642400599540548, "vf_explained_var": 0.9853954591367825, "kl": 0.014674055588213688, "entropy": 2.8295062068506334, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.34751773049645, "num_grad_updates_lifetime": 289935.5, "diff_num_grad_updates_vs_sampler_policy": 2114.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1241961, "num_agent_steps_trained": 1241961}, "env_runners": {"episode_reward_max": -839.6472414672928, "episode_reward_min": -4652.886259048478, "episode_reward_mean": -2621.15144195709, "episode_len_mean": 148.72, "episode_media": {}, "episodes_timesteps_total": 14872, "policy_reward_min": {"policy_0": -1465.2945351160868}, "policy_reward_max": {"policy_0": -12.190559469677948}, "policy_reward_mean": {"policy_0": -524.230288391418}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1719.4020365450287, -1409.9212957789546, -1378.3147429934518, -2114.502073161883, -2477.4013852952025, -1787.9218359251888, -3537.119402352475, -3332.4463458232067, -2102.6662927846473, -1942.3598904090798, -1584.7883434132452, -3976.603650674599, -2793.8891655018424, -2459.8027092653524, -2987.295691574005, -3620.812992773148, -3057.5683776376354, -3912.3410255080707, -2541.3894527801353, -1611.3547916804348, -1448.7090008628948, -1559.7485840292472, -2408.726460254097, -4126.730132906481, -3125.835067528967, -2159.3536813206847, -2828.494055726184, -3006.937507102695, -2953.3362838387125, -1898.3297194888105, -1456.7129208821966, -3946.643058505015, -2711.474416434959, -2976.6385327925673, -1786.7301036261492, -3535.233985404595, -2735.4195338619793, -2161.8434009141984, -2573.2221588000702, -2217.549814604944, -2290.6370919551805, -2009.6418270856057, -3316.433436211706, -2799.3907980190907, -2913.7132078111063, -4115.697672061928, -3018.97730960286, -2431.3127468671746, -2505.142145700036, -3979.2890742478044, -1924.4012732501512, -1936.277363911556, -2729.110171780793, -4458.0217398493305, -1088.4423791110605, -2875.3239366904318, -3388.8416050734177, -2639.1310495744347, -2373.347764097665, -1571.0999580349007, -1962.5471193571389, -1128.7148200670717, -1723.2380794953738, -4225.4666553495945, -2289.0651338546604, -2542.031966600868, -2990.243546767634, -2780.3791511937866, -2265.553009145183, -3896.5160052396955, -4153.147286263118, -3179.3821023986416, -1085.4575651213195, -3655.5602992006416, -2751.106621704197, -3138.6180253447915, -2013.86462354053, -1360.8072587141635, -1977.865990610036, -2585.304167188184, -1418.433579987743, -2984.430509064911, -3545.7439059370217, -3951.8291532711874, -3424.8096697313167, -1770.502487865451, -3605.641263931944, -1931.2158180924748, -2635.396091633965, -3203.758112303903, -2325.389469702213, -3359.4318587632147, -839.6472414672928, -2417.208802500859, -1759.458594148442, -2552.7223565841564, -1667.7259275122506, -3645.1142586140677, -2389.1269366922234, -4652.886259048478], "episode_lengths": [144, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 144, 150, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 150, 150, 135, 150, 150, 150], "policy_policy_0_reward": [-251.0230456782539, -122.1463096954738, -570.4518003285759, -384.90653309769334, -390.8743477450334, -109.15408944891209, -193.46969790901937, -738.4473835972268, -30.648925419911578, -338.20119940388565, -989.4946680427281, -155.0136864864914, -76.82934605705483, -72.62648494498977, -84.35055746218855, -168.07808115249787, -81.79901065012808, -532.4775018679695, -1018.4032330329251, -313.74424645836183, -25.948153088508814, -766.7076292214164, -488.52384952284416, -1008.9204473260655, -187.30130613637138, -1035.2857974344058, -196.14900564972774, -90.5920635684875, -439.114629565619, -26.780339706950333, -210.02639572940453, -1033.1300910129712, -1079.1234507612287, -364.33964758236596, -850.4998172665064, -577.8748474584195, -535.3777097854299, -173.35222368615172, -978.9467316445246, -1066.8948332486827, -395.1159583637807, -283.51120068337605, -1068.9184973894257, -149.74252756568762, -205.3781087823763, -328.2191791648444, -417.61678378668125, -1068.856732175848, -37.556394488170795, -90.11080079353592, -158.14950528590225, -131.89301023914055, -299.8536570435213, -485.6525084700917, -509.2396623745902, -1328.526767926071, -708.4267900958798, -1000.0810438420779, -79.65929469723194, -859.9097541133401, -976.4908242411188, -635.3972636254424, -33.16834153137409, -940.3972939747811, -208.43544212912573, -281.2703157521612, -118.86577721075315, -111.61388122845023, -1303.8913020749844, -644.1614329990032, -726.1049566778223, -1158.5563255909549, -514.1809313174927, -186.80868375058662, -401.6447942371509, -462.2281662781983, -1298.9205082959793, -221.74517807077382, -491.60689344624143, -1146.312246681958, -12.307738527517454, -1091.8146279026348, -780.463144392618, -888.1116209756457, -284.8712458392181, -696.7609892626234, -430.26667380466205, -610.7314700343686, -1098.2698048907002, -1076.3120875157163, -1190.9920617216317, -74.86331949698133, -141.18533163450988, -23.3988672689624, -1110.9498726580523, -318.2221471021092, -367.876629451262, -222.3802516625465, -499.7305227828025, -203.1452406817144, -13.165595817244643, -293.8393500537258, -821.7850354926641, -104.75308066441524, -215.16593883484578, -234.0434037724739, -229.3510042263268, -422.2157131810048, -429.5773570680956, -244.5611057813463, -519.726747734059, -175.33354721060238, -1272.5211017380077, -222.03209916947068, -219.11296440195972, -1197.5237848451254, -1093.044189411435, -178.32894353526686, -796.4140498210188, -861.4191652936385, -542.4915278856074, -882.119521608536, -38.30384479171866, -1238.4136583551322, -424.5065148879726, -44.91811204019246, -698.4345180652704, -1147.6742850898484, -42.88546381101361, -225.44130231436105, -493.5076407798588, -177.31664327418076, -786.8365431177823, -889.7540162030191, -481.0792123513388, -38.8446654112911, -564.7976782096871, -1298.5974902721955, -592.8593514618543, -511.8383217476653, -1353.053235875454, -101.6463512880748, -581.7043751728925, -94.19614675739827, -822.7361747448898, -425.117131424214, -58.214653328906856, -54.653329944077385, -1219.672355155446, -140.67224963616525, -260.63451379889443, -218.2762425985761, -637.4376584517228, -318.3376555927759, -22.026850440227307, -770.3648206140624, -970.999910249787, -426.6936836432317, -684.1836055547163, -1094.4010384432208, -121.75778067203011, -1292.0130952305042, -496.17494946780994, -213.2786929027114, -588.249898161905, -1201.803858474725, -723.1701358292495, -37.74862708319026, -207.14701859085255, -806.7688928145523, -62.47675216712412, -209.3594787397394, -993.2493117433303, -237.35170736445158, -284.2928536115038, -978.3479506048978, -759.4302850024318, -52.079679418339325, -1101.512749490415, -643.8633208885085, -1272.3568998013084, -651.3890852342842, -242.39988589082748, -104.99315545508696, -464.28050748047144, -225.90289372262757, -345.25235268858165, -880.1780059570718, -329.01269202223085, -381.49745652368665, -326.3332826050141, -1017.1685981049982, -396.2071475888336, -21.548700132245877, -811.9644303689778, -623.0675809524402, -1085.9540630666595, -435.1913598755873, -39.749846973242406, -33.58696373701331, -340.9243981372659, -663.1655013168544, -161.4980357895976, -912.96787729838, -212.08127941308317, -27.719927518299976, -55.22183596171907, -1262.299325712698, -385.71065861224054, -278.6900792806487, -772.1489237355376, -1428.1462385376294, -264.3401318867847, -307.7787253727632, -544.0194166789953, -257.8973327879998, -829.5890829059097, -743.9742772523979, -834.5405391296991, -133.38956594308436, -1215.7410898518633, -989.6035913205186, -587.410776047882, -35.94738795862236, -85.01036263221873, -980.1642281632941, -1372.3739238437158, -447.2775283914927, -1275.7890483791366, -40.092943284291245, -1387.6052754623497, -158.7598630628074, -1196.5991321859258, -68.06219834064272, -207.95084055113526, -317.7945878864235, -201.35717467556537, -1263.0846822242095, -227.08809314840113, -421.9882089325739, -264.32884600695576, -12.190559469677948, -142.57534116080987, -1222.6363743876773, -863.4110246749154, -1170.8822478010807, -39.119999954043486, -1092.994372931012, -1322.6739379904461, -353.6185155712215, -352.1894282706937, -766.0382125307455, -485.1156769796331, -155.8278005028097, -165.23015496627164, -1117.182295246824, -177.06413541580432, -40.144124049594886, -431.76072135713895, -170.12608784219208, -842.7987157135321, -66.51565354630539, -66.71744777320582, -669.4997836375732, -1083.5785711101762, -1064.0332514949187, -1006.8036311817744, -978.9568829974568, -1266.0154011296654, -142.21257304551057, -65.88559828144112, -99.60209002230484, -617.0289970503007, -211.86022123322599, -94.06547252378904, -220.1992223414246, -1017.4504626981659, -438.39903336362477, -243.0453397335496, -956.2298785536673, -1144.9720457283777, -117.0906183267891, -373.16713815934867, -498.1349211056324, -1255.4768817532745, -614.4357483572527, -509.1263594703876, -363.46152406121666, -125.2733083941507, -1026.834109291426, -569.4427493519128, -249.9724704563682, -868.0629159432798, -23.404210963737718, -662.4654173823665, -37.665541224565075, -27.56586429714432, -90.71366039676104, -305.1892995312179, -1109.9655925852132, -309.7477192974661, -278.11395041877046, -941.7106874650452, -80.91026439599348, -352.06449777986313, -39.20088976783249, -222.24023678058686, -218.01530595291172, -413.7221251165615, -235.53626244917928, -208.500027508847, -382.0131738794046, -79.66032757235456, -944.3877375538228, -108.6768129809439, -241.1909587594169, -1079.0576692714415, -844.0544030372938, -1195.755670141766, -865.4079541396779, -611.5450614160277, -505.11283920738407, -136.27379837730535, -81.97153652914449, -954.1618983247978, -805.9656913843058, -185.7005835365706, -272.68264880012623, -236.1709066441779, -1041.5121362356867, -585.3784361872277, -396.6580069925611, -781.251077799956, -41.2171051051946, -1185.738920682696, -101.40554819084038, -650.5887057518394, -723.9171608717793, -875.1614779499669, -429.30625842936143, -908.9774364360884, -645.1503990021491, -19.912435645493474, -288.9342535382068, -402.57848452324606, -1336.4002377907773, -25.356622267378242, -540.9923464817327, -744.3229698000358, -1249.44382889977, -934.3407323626395, -991.932219877426, -743.1443027474353, -909.955652967048, -573.7743783085646, -971.6586614745825, -1137.1779403734995, -704.7199480552121, -167.8151232769747, -198.0104292183734, -63.420815341080015, -381.6712006028979, -158.97348178580188, -83.24053509804727, -398.151532293493, -19.649458170914873, -1195.0222605658034, -457.248691818183, -671.5055086293085, -1312.1343800164293, -97.66296001090834, -723.1032621481082, -1097.6683956507445, -664.1120667976643, -168.55993709677242, -402.7260982470897, -1120.9182484464866, -1074.709298537887, -95.04057050520882, -445.22380960812075, -52.526297547979155, -104.52158254417203, -877.3104405948619, -139.00923815984976, -840.4970646936681, -632.8187214021582, -365.13864156469793, -161.78400960555484, -150.88396442156883, -50.18192172018238, -727.0844319281305, -535.6376600472149, -477.36203196535206, -179.21107664689163, -58.57079002244586, -1026.745662053684, -574.9960679519505, -195.90402894851857, -103.55663990662796, -684.101768327404, -1206.9793071890624, -32.912505087858655, -18.951009227177792, -107.97958321925003, -51.611175264393474, -908.1149114449252, -958.107722634022, -25.27883386781124, -798.7322069262588, -294.19683419189255, -403.08907188003315, -1103.0962158110588, -512.2503478258221, -1395.9891609396163, -131.31910948049153, -833.8974511333499, -942.4380167931903, -196.85508239074656, -847.6853947016444, -1130.9532082522537, -487.030631425656, -937.3583131476047, -414.4554017599537, -1002.2435928177024, -583.7217305804039, -48.77299481021699, -450.21845329992755, -749.5571926772903, -350.29834216005423, -171.655504917963, -389.2397711752614, -683.3144630823664, -999.906170380499, -706.2195728846755, -826.9612864091382, -316.65495948062807, -60.55545854165439, -514.3271281702241, -592.960259605496, -446.7180122944723, -976.3308889737687, -427.50264204330097, -732.3059054821642, -231.407985129242, -267.84867000548394, -721.583586284392, -268.38259202685066, -247.36358643077108, -1006.1275947139068, -960.3007528479847, -1080.3036031380545, -298.7911370782199, -249.23145266478065, -667.9405656401786, -29.12271118097822, -778.3261981083816, -59.30328545142672, -1465.2945351160868, -993.3536871672952, -63.15415292002341, -25.664730160239582, -39.68023784416779, -227.85640159529947, -44.906813163580566, -501.5390587040056, -480.0216136418612, -271.35649265177483, -393.23020780261567, -511.7153781520408, -760.8851102525679, -194.4079331854564, -387.4782491357705, -244.92459925425953, -371.25976409290337, -561.3880484800511, -233.94637404391383, -1045.5305450577632, -409.42827478693744, -60.49582505658293, -803.321337638956, -430.6731479143051, -204.61745802913904, -393.36908467390714, -217.6850075449529, -421.38122934994806, -964.4998756158699, -454.94689446906347, -1256.9076818814028, -262.26279789187106, -706.4970087558576, -921.4268531217208, -44.6953133068364, -611.1168586618013, -596.6607752324697, -215.22713636939477, -1382.5454832051976, -1330.6179053533972, -830.729241354389, -73.16805857464388, -1035.8255705608392]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4795464967058378, "mean_inference_ms": 1.690126526950759, "mean_action_processing_ms": 0.7860344938038355, "mean_env_wait_ms": 9.89083198648916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013593196868896484, "StateBufferConnector_ms": 0.009435176849365234, "ViewRequirementAgentConnector_ms": 0.3088653087615967}, "num_episodes": 30, "episode_return_max": -839.6472414672928, "episode_return_min": -4652.886259048478, "episode_return_mean": -2621.15144195709, "episodes_this_iter": 30}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1241961, "num_agent_steps_trained": 1241961, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 68.59112983913349, "num_env_steps_trained_throughput_per_sec": 68.59112983913349, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 1241961, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1241961, "timers": {"training_iteration_time_ms": 53113.156, "restore_workers_time_ms": 0.031, "training_step_time_ms": 53113.076, "sample_time_ms": 3197.358, "learn_time_ms": 49854.464, "learn_throughput": 80.234, "synch_weights_time_ms": 58.147}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1241961, "num_agent_steps_trained": 1241961}, "done": false, "training_iteration": 72, "trial_id": "efc54_00000", "date": "2024-07-24_19-45-01", "timestamp": 1721830501, "time_this_iter_s": 58.328553199768066, "time_total_s": 3897.459818840027, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d71ed40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3897.459818840027, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 9.555421686746987, "ram_util_percent": 23.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 128.03870876985997, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 0.0010000000000000002, "total_loss": 4.613084548207658, "policy_loss": 0.0017973182441444317, "vf_loss": 4.63074856080226, "vf_explained_var": 0.9888673566318863, "kl": 0.0162802186597368, "entropy": 2.77031932885374, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.17910447761194, "num_grad_updates_lifetime": 294060.5, "diff_num_grad_updates_vs_sampler_policy": 2009.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1259003, "num_agent_steps_trained": 1259003}, "env_runners": {"episode_reward_max": -654.4132796302301, "episode_reward_min": -4652.886259048478, "episode_reward_mean": -2622.29672402351, "episode_len_mean": 148.32, "episode_media": {}, "episodes_timesteps_total": 14832, "policy_reward_min": {"policy_0": -1465.2945351160868}, "policy_reward_max": {"policy_0": -6.838446898369053}, "policy_reward_mean": {"policy_0": -524.459344804702}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2828.494055726184, -3006.937507102695, -2953.3362838387125, -1898.3297194888105, -1456.7129208821966, -3946.643058505015, -2711.474416434959, -2976.6385327925673, -1786.7301036261492, -3535.233985404595, -2735.4195338619793, -2161.8434009141984, -2573.2221588000702, -2217.549814604944, -2290.6370919551805, -2009.6418270856057, -3316.433436211706, -2799.3907980190907, -2913.7132078111063, -4115.697672061928, -3018.97730960286, -2431.3127468671746, -2505.142145700036, -3979.2890742478044, -1924.4012732501512, -1936.277363911556, -2729.110171780793, -4458.0217398493305, -1088.4423791110605, -2875.3239366904318, -3388.8416050734177, -2639.1310495744347, -2373.347764097665, -1571.0999580349007, -1962.5471193571389, -1128.7148200670717, -1723.2380794953738, -4225.4666553495945, -2289.0651338546604, -2542.031966600868, -2990.243546767634, -2780.3791511937866, -2265.553009145183, -3896.5160052396955, -4153.147286263118, -3179.3821023986416, -1085.4575651213195, -3655.5602992006416, -2751.106621704197, -3138.6180253447915, -2013.86462354053, -1360.8072587141635, -1977.865990610036, -2585.304167188184, -1418.433579987743, -2984.430509064911, -3545.7439059370217, -3951.8291532711874, -3424.8096697313167, -1770.502487865451, -3605.641263931944, -1931.2158180924748, -2635.396091633965, -3203.758112303903, -2325.389469702213, -3359.4318587632147, -839.6472414672928, -2417.208802500859, -1759.458594148442, -2552.7223565841564, -1667.7259275122506, -3645.1142586140677, -2389.1269366922234, -4652.886259048478, -3059.2926758715494, -2867.0066112886866, -1805.3636058632087, -3172.4286391523765, -1179.203472982404, -1308.1047602470096, -2613.473056449931, -2764.116684382811, -2570.597392401431, -2966.602730477308, -1594.7406254086077, -654.4132796302301, -2353.5949972263675, -3782.8501122586854, -2743.6675582239095, -2416.7713442743084, -2756.531219112108, -2101.4014305716505, -2681.2310988452537, -2714.427764194739, -3046.744045586007, -3221.2767069107517, -3483.604783738535, -2365.8157968965857, -2369.8244774855807, -2698.4477659419176], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 147, 136, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-493.5076407798588, -177.31664327418076, -786.8365431177823, -889.7540162030191, -481.0792123513388, -38.8446654112911, -564.7976782096871, -1298.5974902721955, -592.8593514618543, -511.8383217476653, -1353.053235875454, -101.6463512880748, -581.7043751728925, -94.19614675739827, -822.7361747448898, -425.117131424214, -58.214653328906856, -54.653329944077385, -1219.672355155446, -140.67224963616525, -260.63451379889443, -218.2762425985761, -637.4376584517228, -318.3376555927759, -22.026850440227307, -770.3648206140624, -970.999910249787, -426.6936836432317, -684.1836055547163, -1094.4010384432208, -121.75778067203011, -1292.0130952305042, -496.17494946780994, -213.2786929027114, -588.249898161905, -1201.803858474725, -723.1701358292495, -37.74862708319026, -207.14701859085255, -806.7688928145523, -62.47675216712412, -209.3594787397394, -993.2493117433303, -237.35170736445158, -284.2928536115038, -978.3479506048978, -759.4302850024318, -52.079679418339325, -1101.512749490415, -643.8633208885085, -1272.3568998013084, -651.3890852342842, -242.39988589082748, -104.99315545508696, -464.28050748047144, -225.90289372262757, -345.25235268858165, -880.1780059570718, -329.01269202223085, -381.49745652368665, -326.3332826050141, -1017.1685981049982, -396.2071475888336, -21.548700132245877, -811.9644303689778, -623.0675809524402, -1085.9540630666595, -435.1913598755873, -39.749846973242406, -33.58696373701331, -340.9243981372659, -663.1655013168544, -161.4980357895976, -912.96787729838, -212.08127941308317, -27.719927518299976, -55.22183596171907, -1262.299325712698, -385.71065861224054, -278.6900792806487, -772.1489237355376, -1428.1462385376294, -264.3401318867847, -307.7787253727632, -544.0194166789953, -257.8973327879998, -829.5890829059097, -743.9742772523979, -834.5405391296991, -133.38956594308436, -1215.7410898518633, -989.6035913205186, -587.410776047882, -35.94738795862236, -85.01036263221873, -980.1642281632941, -1372.3739238437158, -447.2775283914927, -1275.7890483791366, -40.092943284291245, -1387.6052754623497, -158.7598630628074, -1196.5991321859258, -68.06219834064272, -207.95084055113526, -317.7945878864235, -201.35717467556537, -1263.0846822242095, -227.08809314840113, -421.9882089325739, -264.32884600695576, -12.190559469677948, -142.57534116080987, -1222.6363743876773, -863.4110246749154, -1170.8822478010807, -39.119999954043486, -1092.994372931012, -1322.6739379904461, -353.6185155712215, -352.1894282706937, -766.0382125307455, -485.1156769796331, -155.8278005028097, -165.23015496627164, -1117.182295246824, -177.06413541580432, -40.144124049594886, -431.76072135713895, -170.12608784219208, -842.7987157135321, -66.51565354630539, -66.71744777320582, -669.4997836375732, -1083.5785711101762, -1064.0332514949187, -1006.8036311817744, -978.9568829974568, -1266.0154011296654, -142.21257304551057, -65.88559828144112, -99.60209002230484, -617.0289970503007, -211.86022123322599, -94.06547252378904, -220.1992223414246, -1017.4504626981659, -438.39903336362477, -243.0453397335496, -956.2298785536673, -1144.9720457283777, -117.0906183267891, -373.16713815934867, -498.1349211056324, -1255.4768817532745, -614.4357483572527, -509.1263594703876, -363.46152406121666, -125.2733083941507, -1026.834109291426, -569.4427493519128, -249.9724704563682, -868.0629159432798, -23.404210963737718, -662.4654173823665, -37.665541224565075, -27.56586429714432, -90.71366039676104, -305.1892995312179, -1109.9655925852132, -309.7477192974661, -278.11395041877046, -941.7106874650452, -80.91026439599348, -352.06449777986313, -39.20088976783249, -222.24023678058686, -218.01530595291172, -413.7221251165615, -235.53626244917928, -208.500027508847, -382.0131738794046, -79.66032757235456, -944.3877375538228, -108.6768129809439, -241.1909587594169, -1079.0576692714415, -844.0544030372938, -1195.755670141766, -865.4079541396779, -611.5450614160277, -505.11283920738407, -136.27379837730535, -81.97153652914449, -954.1618983247978, -805.9656913843058, -185.7005835365706, -272.68264880012623, -236.1709066441779, -1041.5121362356867, -585.3784361872277, -396.6580069925611, -781.251077799956, -41.2171051051946, -1185.738920682696, -101.40554819084038, -650.5887057518394, -723.9171608717793, -875.1614779499669, -429.30625842936143, -908.9774364360884, -645.1503990021491, -19.912435645493474, -288.9342535382068, -402.57848452324606, -1336.4002377907773, -25.356622267378242, -540.9923464817327, -744.3229698000358, -1249.44382889977, -934.3407323626395, -991.932219877426, -743.1443027474353, -909.955652967048, -573.7743783085646, -971.6586614745825, -1137.1779403734995, -704.7199480552121, -167.8151232769747, -198.0104292183734, -63.420815341080015, -381.6712006028979, -158.97348178580188, -83.24053509804727, -398.151532293493, -19.649458170914873, -1195.0222605658034, -457.248691818183, -671.5055086293085, -1312.1343800164293, -97.66296001090834, -723.1032621481082, -1097.6683956507445, -664.1120667976643, -168.55993709677242, -402.7260982470897, -1120.9182484464866, -1074.709298537887, -95.04057050520882, -445.22380960812075, -52.526297547979155, -104.52158254417203, -877.3104405948619, -139.00923815984976, -840.4970646936681, -632.8187214021582, -365.13864156469793, -161.78400960555484, -150.88396442156883, -50.18192172018238, -727.0844319281305, -535.6376600472149, -477.36203196535206, -179.21107664689163, -58.57079002244586, -1026.745662053684, -574.9960679519505, -195.90402894851857, -103.55663990662796, -684.101768327404, -1206.9793071890624, -32.912505087858655, -18.951009227177792, -107.97958321925003, -51.611175264393474, -908.1149114449252, -958.107722634022, -25.27883386781124, -798.7322069262588, -294.19683419189255, -403.08907188003315, -1103.0962158110588, -512.2503478258221, -1395.9891609396163, -131.31910948049153, -833.8974511333499, -942.4380167931903, -196.85508239074656, -847.6853947016444, -1130.9532082522537, -487.030631425656, -937.3583131476047, -414.4554017599537, -1002.2435928177024, -583.7217305804039, -48.77299481021699, -450.21845329992755, -749.5571926772903, -350.29834216005423, -171.655504917963, -389.2397711752614, -683.3144630823664, -999.906170380499, -706.2195728846755, -826.9612864091382, -316.65495948062807, -60.55545854165439, -514.3271281702241, -592.960259605496, -446.7180122944723, -976.3308889737687, -427.50264204330097, -732.3059054821642, -231.407985129242, -267.84867000548394, -721.583586284392, -268.38259202685066, -247.36358643077108, -1006.1275947139068, -960.3007528479847, -1080.3036031380545, -298.7911370782199, -249.23145266478065, -667.9405656401786, -29.12271118097822, -778.3261981083816, -59.30328545142672, -1465.2945351160868, -993.3536871672952, -63.15415292002341, -25.664730160239582, -39.68023784416779, -227.85640159529947, -44.906813163580566, -501.5390587040056, -480.0216136418612, -271.35649265177483, -393.23020780261567, -511.7153781520408, -760.8851102525679, -194.4079331854564, -387.4782491357705, -244.92459925425953, -371.25976409290337, -561.3880484800511, -233.94637404391383, -1045.5305450577632, -409.42827478693744, -60.49582505658293, -803.321337638956, -430.6731479143051, -204.61745802913904, -393.36908467390714, -217.6850075449529, -421.38122934994806, -964.4998756158699, -454.94689446906347, -1256.9076818814028, -262.26279789187106, -706.4970087558576, -921.4268531217208, -44.6953133068364, -611.1168586618013, -596.6607752324697, -215.22713636939477, -1382.5454832051976, -1330.6179053533972, -830.729241354389, -73.16805857464388, -1035.8255705608392, -299.23151770922385, -995.7095964650742, -473.47494456963994, -246.61464525137342, -1044.2619718762378, -436.2288670284164, -35.467462325025195, -1096.915209035362, -6.838446898369053, -1291.556626001512, -49.08560318878213, -740.9237378540658, -237.73055471549992, -744.233557650126, -33.39015245473478, -37.01257717613625, -630.7433055086927, -1438.6546051463158, -722.1577857721555, -343.8603655490786, -294.37069739658364, -112.01894749337566, -594.9296920960285, -75.10921342114936, -102.77492257526691, -75.88726799075837, -332.5486445309958, -506.1888456032635, -68.68636871657105, -324.7936334054218, -866.7917944859471, -1196.610817051536, -139.4119403200527, -325.5525176366199, -85.10598695577549, -174.84571942495793, -802.5566682887267, -1199.8870181369125, -112.2191553757511, -474.60812315646524, -129.84067519130545, -789.0633942663899, -222.05956741989036, -974.5916055020624, -455.04215002178205, -688.3368830445512, -445.59570512922517, -914.7774432831216, -559.4533855937881, -358.4393134266253, -93.92632920475265, -214.10834957578848, -270.0959249264506, -147.47546464847744, -869.1345570531398, -75.86805942585241, -302.8119704134912, -151.61625198215364, -116.47122794205285, -7.645769866680077, -140.14319016399483, -968.4375885756326, -645.0386983902877, -546.079346261529, -53.896173834924234, -647.8790848925403, -831.8621511932085, -834.4375092159938, -467.8897540254234, -1000.7816129315203, -75.66573127878061, -398.39668565575363, -1014.8811673895239, -528.4732150626002, -726.2507588372539, -98.52156764517557, -552.5242806413868, -1056.1146029639674, -193.34529740358278, -516.265595620195, -456.5285384926039, -529.3269091105637, -899.0253696758152, -97.69312124240523, -773.9572805907162, -953.2890587845804, -600.0470807945521, -78.05586796433833, -350.59456841172636, -119.41485461645311, -1198.1176860539256, -123.53296193455493, -1239.1805848921315, -23.617487372439502, -96.78237859220407, -529.7271710200953, -544.7276984487218, -968.2668954887458, -510.9326617999156, -160.77333743725978, -952.4732127408356, -348.34369936765484, -352.50624921304876, -1057.3986769029875, -336.02220736148087, -187.67116033255644, -90.68081374480514, -990.1064172687965, -922.6208416602798, -1030.197473904311, -69.12661435033714, -740.0817828479959, -984.4763407192656, -945.106004213642, -744.8140416072955, -211.44663626152638, -777.1013621114272, -234.8970092098, -1025.7442381452577, -116.62655116857736, -198.375166172008, -837.2644201030216, -406.3591231940638, -200.23218509331338, -727.5935829231739, -55.01522335405504, -1164.1402850915017, -476.0837987613086, -368.74322073563127, -634.4652379994226]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4785023983331655, "mean_inference_ms": 1.6888215086232676, "mean_action_processing_ms": 0.7851440101721289, "mean_env_wait_ms": 9.880855867861259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013246536254882812, "StateBufferConnector_ms": 0.009273290634155273, "ViewRequirementAgentConnector_ms": 0.3075826168060303}, "num_episodes": 26, "episode_return_max": -654.4132796302301, "episode_return_min": -4652.886259048478, "episode_return_mean": -2622.29672402351, "episodes_this_iter": 26}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1259003, "num_agent_steps_trained": 1259003, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.25955235014848, "num_env_steps_trained_throughput_per_sec": 72.25955235014848, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 1259003, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1259003, "timers": {"training_iteration_time_ms": 54151.709, "restore_workers_time_ms": 0.031, "training_step_time_ms": 54151.626, "sample_time_ms": 3216.673, "learn_time_ms": 50874.37, "learn_throughput": 78.625, "synch_weights_time_ms": 57.416}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1259003, "num_agent_steps_trained": 1259003}, "done": false, "training_iteration": 73, "trial_id": "efc54_00000", "date": "2024-07-24_19-45-56", "timestamp": 1721830556, "time_this_iter_s": 55.36757707595825, "time_total_s": 3952.827395915985, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7175141045e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3952.827395915985, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 9.843589743589742, "ram_util_percent": 23.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 124.02238240498369, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 0.0010000000000000005, "total_loss": 4.541490756311724, "policy_loss": 0.0015604637137624205, "vf_loss": 4.560297825964549, "vf_explained_var": 0.9881660713623929, "kl": 0.015248295338354974, "entropy": 2.808698691603958, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.71774193548387, "num_grad_updates_lifetime": 297930.5, "diff_num_grad_updates_vs_sampler_policy": 1859.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1274840, "num_agent_steps_trained": 1274840}, "env_runners": {"episode_reward_max": -654.4132796302301, "episode_reward_min": -4652.886259048478, "episode_reward_mean": -2505.9716763641236, "episode_len_mean": 146.93, "episode_media": {}, "episodes_timesteps_total": 14693, "policy_reward_min": {"policy_0": -1473.1761503590797}, "policy_reward_max": {"policy_0": -6.838446898369053}, "policy_reward_mean": {"policy_0": -501.19433527282473}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1936.277363911556, -2729.110171780793, -4458.0217398493305, -1088.4423791110605, -2875.3239366904318, -3388.8416050734177, -2639.1310495744347, -2373.347764097665, -1571.0999580349007, -1962.5471193571389, -1128.7148200670717, -1723.2380794953738, -4225.4666553495945, -2289.0651338546604, -2542.031966600868, -2990.243546767634, -2780.3791511937866, -2265.553009145183, -3896.5160052396955, -4153.147286263118, -3179.3821023986416, -1085.4575651213195, -3655.5602992006416, -2751.106621704197, -3138.6180253447915, -2013.86462354053, -1360.8072587141635, -1977.865990610036, -2585.304167188184, -1418.433579987743, -2984.430509064911, -3545.7439059370217, -3951.8291532711874, -3424.8096697313167, -1770.502487865451, -3605.641263931944, -1931.2158180924748, -2635.396091633965, -3203.758112303903, -2325.389469702213, -3359.4318587632147, -839.6472414672928, -2417.208802500859, -1759.458594148442, -2552.7223565841564, -1667.7259275122506, -3645.1142586140677, -2389.1269366922234, -4652.886259048478, -3059.2926758715494, -2867.0066112886866, -1805.3636058632087, -3172.4286391523765, -1179.203472982404, -1308.1047602470096, -2613.473056449931, -2764.116684382811, -2570.597392401431, -2966.602730477308, -1594.7406254086077, -654.4132796302301, -2353.5949972263675, -3782.8501122586854, -2743.6675582239095, -2416.7713442743084, -2756.531219112108, -2101.4014305716505, -2681.2310988452537, -2714.427764194739, -3046.744045586007, -3221.2767069107517, -3483.604783738535, -2365.8157968965857, -2369.8244774855807, -2698.4477659419176, -1223.3152929533942, -3738.0160270500496, -2079.1019522932643, -1329.4898186787311, -4071.665345151408, -3492.2790514132057, -1857.386110749551, -2261.863118010099, -815.429292155686, -3425.038058455414, -2580.3510225538457, -1152.1488648397308, -3799.537946209204, -934.3206956589157, -938.8304718825616, -3015.9264713877837, -1872.285580871474, -2563.922939129366, -2187.1421659995485, -2676.512324855836, -1562.931101749126, -2136.849786175543, -2140.546876639418, -1806.7342518869561, -2799.0727421069764], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 147, 136, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 129, 150, 115, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1117.182295246824, -177.06413541580432, -40.144124049594886, -431.76072135713895, -170.12608784219208, -842.7987157135321, -66.51565354630539, -66.71744777320582, -669.4997836375732, -1083.5785711101762, -1064.0332514949187, -1006.8036311817744, -978.9568829974568, -1266.0154011296654, -142.21257304551057, -65.88559828144112, -99.60209002230484, -617.0289970503007, -211.86022123322599, -94.06547252378904, -220.1992223414246, -1017.4504626981659, -438.39903336362477, -243.0453397335496, -956.2298785536673, -1144.9720457283777, -117.0906183267891, -373.16713815934867, -498.1349211056324, -1255.4768817532745, -614.4357483572527, -509.1263594703876, -363.46152406121666, -125.2733083941507, -1026.834109291426, -569.4427493519128, -249.9724704563682, -868.0629159432798, -23.404210963737718, -662.4654173823665, -37.665541224565075, -27.56586429714432, -90.71366039676104, -305.1892995312179, -1109.9655925852132, -309.7477192974661, -278.11395041877046, -941.7106874650452, -80.91026439599348, -352.06449777986313, -39.20088976783249, -222.24023678058686, -218.01530595291172, -413.7221251165615, -235.53626244917928, -208.500027508847, -382.0131738794046, -79.66032757235456, -944.3877375538228, -108.6768129809439, -241.1909587594169, -1079.0576692714415, -844.0544030372938, -1195.755670141766, -865.4079541396779, -611.5450614160277, -505.11283920738407, -136.27379837730535, -81.97153652914449, -954.1618983247978, -805.9656913843058, -185.7005835365706, -272.68264880012623, -236.1709066441779, -1041.5121362356867, -585.3784361872277, -396.6580069925611, -781.251077799956, -41.2171051051946, -1185.738920682696, -101.40554819084038, -650.5887057518394, -723.9171608717793, -875.1614779499669, -429.30625842936143, -908.9774364360884, -645.1503990021491, -19.912435645493474, -288.9342535382068, -402.57848452324606, -1336.4002377907773, -25.356622267378242, -540.9923464817327, -744.3229698000358, -1249.44382889977, -934.3407323626395, -991.932219877426, -743.1443027474353, -909.955652967048, -573.7743783085646, -971.6586614745825, -1137.1779403734995, -704.7199480552121, -167.8151232769747, -198.0104292183734, -63.420815341080015, -381.6712006028979, -158.97348178580188, -83.24053509804727, -398.151532293493, -19.649458170914873, -1195.0222605658034, -457.248691818183, -671.5055086293085, -1312.1343800164293, -97.66296001090834, -723.1032621481082, -1097.6683956507445, -664.1120667976643, -168.55993709677242, -402.7260982470897, -1120.9182484464866, -1074.709298537887, -95.04057050520882, -445.22380960812075, -52.526297547979155, -104.52158254417203, -877.3104405948619, -139.00923815984976, -840.4970646936681, -632.8187214021582, -365.13864156469793, -161.78400960555484, -150.88396442156883, -50.18192172018238, -727.0844319281305, -535.6376600472149, -477.36203196535206, -179.21107664689163, -58.57079002244586, -1026.745662053684, -574.9960679519505, -195.90402894851857, -103.55663990662796, -684.101768327404, -1206.9793071890624, -32.912505087858655, -18.951009227177792, -107.97958321925003, -51.611175264393474, -908.1149114449252, -958.107722634022, -25.27883386781124, -798.7322069262588, -294.19683419189255, -403.08907188003315, -1103.0962158110588, -512.2503478258221, -1395.9891609396163, -131.31910948049153, -833.8974511333499, -942.4380167931903, -196.85508239074656, -847.6853947016444, -1130.9532082522537, -487.030631425656, -937.3583131476047, -414.4554017599537, -1002.2435928177024, -583.7217305804039, -48.77299481021699, -450.21845329992755, -749.5571926772903, -350.29834216005423, -171.655504917963, -389.2397711752614, -683.3144630823664, -999.906170380499, -706.2195728846755, -826.9612864091382, -316.65495948062807, -60.55545854165439, -514.3271281702241, -592.960259605496, -446.7180122944723, -976.3308889737687, -427.50264204330097, -732.3059054821642, -231.407985129242, -267.84867000548394, -721.583586284392, -268.38259202685066, -247.36358643077108, -1006.1275947139068, -960.3007528479847, -1080.3036031380545, -298.7911370782199, -249.23145266478065, -667.9405656401786, -29.12271118097822, -778.3261981083816, -59.30328545142672, -1465.2945351160868, -993.3536871672952, -63.15415292002341, -25.664730160239582, -39.68023784416779, -227.85640159529947, -44.906813163580566, -501.5390587040056, -480.0216136418612, -271.35649265177483, -393.23020780261567, -511.7153781520408, -760.8851102525679, -194.4079331854564, -387.4782491357705, -244.92459925425953, -371.25976409290337, -561.3880484800511, -233.94637404391383, -1045.5305450577632, -409.42827478693744, -60.49582505658293, -803.321337638956, -430.6731479143051, -204.61745802913904, -393.36908467390714, -217.6850075449529, -421.38122934994806, -964.4998756158699, -454.94689446906347, -1256.9076818814028, -262.26279789187106, -706.4970087558576, -921.4268531217208, -44.6953133068364, -611.1168586618013, -596.6607752324697, -215.22713636939477, -1382.5454832051976, -1330.6179053533972, -830.729241354389, -73.16805857464388, -1035.8255705608392, -299.23151770922385, -995.7095964650742, -473.47494456963994, -246.61464525137342, -1044.2619718762378, -436.2288670284164, -35.467462325025195, -1096.915209035362, -6.838446898369053, -1291.556626001512, -49.08560318878213, -740.9237378540658, -237.73055471549992, -744.233557650126, -33.39015245473478, -37.01257717613625, -630.7433055086927, -1438.6546051463158, -722.1577857721555, -343.8603655490786, -294.37069739658364, -112.01894749337566, -594.9296920960285, -75.10921342114936, -102.77492257526691, -75.88726799075837, -332.5486445309958, -506.1888456032635, -68.68636871657105, -324.7936334054218, -866.7917944859471, -1196.610817051536, -139.4119403200527, -325.5525176366199, -85.10598695577549, -174.84571942495793, -802.5566682887267, -1199.8870181369125, -112.2191553757511, -474.60812315646524, -129.84067519130545, -789.0633942663899, -222.05956741989036, -974.5916055020624, -455.04215002178205, -688.3368830445512, -445.59570512922517, -914.7774432831216, -559.4533855937881, -358.4393134266253, -93.92632920475265, -214.10834957578848, -270.0959249264506, -147.47546464847744, -869.1345570531398, -75.86805942585241, -302.8119704134912, -151.61625198215364, -116.47122794205285, -7.645769866680077, -140.14319016399483, -968.4375885756326, -645.0386983902877, -546.079346261529, -53.896173834924234, -647.8790848925403, -831.8621511932085, -834.4375092159938, -467.8897540254234, -1000.7816129315203, -75.66573127878061, -398.39668565575363, -1014.8811673895239, -528.4732150626002, -726.2507588372539, -98.52156764517557, -552.5242806413868, -1056.1146029639674, -193.34529740358278, -516.265595620195, -456.5285384926039, -529.3269091105637, -899.0253696758152, -97.69312124240523, -773.9572805907162, -953.2890587845804, -600.0470807945521, -78.05586796433833, -350.59456841172636, -119.41485461645311, -1198.1176860539256, -123.53296193455493, -1239.1805848921315, -23.617487372439502, -96.78237859220407, -529.7271710200953, -544.7276984487218, -968.2668954887458, -510.9326617999156, -160.77333743725978, -952.4732127408356, -348.34369936765484, -352.50624921304876, -1057.3986769029875, -336.02220736148087, -187.67116033255644, -90.68081374480514, -990.1064172687965, -922.6208416602798, -1030.197473904311, -69.12661435033714, -740.0817828479959, -984.4763407192656, -945.106004213642, -744.8140416072955, -211.44663626152638, -777.1013621114272, -234.8970092098, -1025.7442381452577, -116.62655116857736, -198.375166172008, -837.2644201030216, -406.3591231940638, -200.23218509331338, -727.5935829231739, -55.01522335405504, -1164.1402850915017, -476.0837987613086, -368.74322073563127, -634.4652379994226, -635.8058225217853, -69.68576693697996, -78.86800526530179, -74.36617671056169, -364.5895215187648, -1226.3870826706866, -737.3669855196888, -1123.3678607607349, -549.0995445508906, -101.79455354805104, -707.9032734283539, -489.8051823539207, -64.79924139242178, -210.96643363603923, -605.6278214825295, -138.985667842339, -29.57044677326533, -738.793706155618, -242.60697212340028, -179.53302578410836, -965.3378111877589, -1170.8445893502578, -1015.0921237966023, -394.87073445432395, -525.5200863624636, -143.89245076697318, -1106.5557846130632, -1323.902848847113, -174.60628157306937, -743.3216856129889, -166.1381703987376, -1057.6889002455969, -220.24062161979916, -100.31130204412197, -313.00711644129643, -122.25954065643417, -167.71365209535955, -127.45803638240307, -842.0821508101288, -1002.3497380657705, -314.7646462002511, -279.1703073794403, -31.343470799899873, -54.93945884806831, -135.21140892802632, -216.07379561630182, -43.37696613190415, -1120.7986107471024, -571.6125356010239, -1473.1761503590797, -73.8032521961263, -37.57506074882699, -1095.4631313291563, -414.4632823033503, -959.0462959763854, -136.27748648760394, -386.40434405177456, -59.09634610054897, -445.26392655909143, -125.10676164071185, -1243.0411230627617, -363.78750202726076, -47.016985122128986, -1221.1837840100231, -924.5085519870323, -358.6199642691323, -40.46381339197325, -70.5098198713211, -153.71076796199517, -311.01633016449404, -117.549016110456, -234.9862486834566, -66.27686912480318, -349.52721761928007, -170.49112034456547, -242.81840677820267, -14.16507400649417, -1032.7975268639689, -507.33472007482, -1218.8107436642952, -547.2841031271361, -888.7045928187056, -255.55929540187162, -105.52127962576749, -75.21630989799276, -32.914123367606436, -984.3347172936528, -1049.9392535917902, -227.98416734842056, -268.7506775278946, -459.7900322154568, -294.50628435985794, -650.0856525415526, -739.4308399707007, -43.329356911981165, -1333.8824148305926, -283.6336423516662, -447.6876430655851, -531.4848704365266, -79.82375417146595, -90.27778443212792, -480.7856608229715, -399.8160421948666, -292.39525812614687, -299.65635617301353, -697.4386709812228, -136.07801327949753, -73.53682815765386, -449.80812413715563, -779.9881496200155, -94.64708699206662, -927.0313507431773, -628.4393345214879, -32.85573471307326, -457.5733696696131, -42.563926821546524, -166.6139960126592, -621.8437453100142, -741.8009490357169, -233.91163470701753, -1357.6511007433107, -554.5052680041002, -32.74268721209102, -601.8166165542069, -252.35706959326632]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4788592944168375, "mean_inference_ms": 1.6893321512933515, "mean_action_processing_ms": 0.7844566378447682, "mean_env_wait_ms": 9.878002167069429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013260602951049805, "StateBufferConnector_ms": 0.009279727935791016, "ViewRequirementAgentConnector_ms": 0.3057858943939209}, "num_episodes": 25, "episode_return_max": -654.4132796302301, "episode_return_min": -4652.886259048478, "episode_return_mean": -2505.9716763641236, "episodes_this_iter": 25}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1274840, "num_agent_steps_trained": 1274840, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 78.30190195190728, "num_env_steps_trained_throughput_per_sec": 78.30190195190728, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 1274840, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1274840, "timers": {"training_iteration_time_ms": 54496.221, "restore_workers_time_ms": 0.031, "training_step_time_ms": 54496.138, "sample_time_ms": 3208.383, "learn_time_ms": 51225.047, "learn_throughput": 78.087, "synch_weights_time_ms": 59.522}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1274840, "num_agent_steps_trained": 1274840}, "done": false, "training_iteration": 74, "trial_id": "efc54_00000", "date": "2024-07-24_19-46-47", "timestamp": 1721830607, "time_this_iter_s": 51.09644031524658, "time_total_s": 4003.9238362312317, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x717514110160>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4003.9238362312317, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 9.897260273972602, "ram_util_percent": 23.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 121.6843527255235, "cur_kl_coeff": 0.50625, "cur_lr": 0.001, "total_loss": 4.636212429459448, "policy_loss": 0.002129071687307226, "vf_loss": 4.650804852114783, "vf_explained_var": 0.9889807643299854, "kl": 0.020191006549241677, "entropy": 2.694319110556885, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.34027777777777, "num_grad_updates_lifetime": 301950.5, "diff_num_grad_updates_vs_sampler_policy": 2159.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1293177, "num_agent_steps_trained": 1293177}, "env_runners": {"episode_reward_max": -654.4132796302301, "episode_reward_min": -4929.573857001566, "episode_reward_mean": -2493.241008285337, "episode_len_mean": 146.93, "episode_media": {}, "episodes_timesteps_total": 14693, "policy_reward_min": {"policy_0": -1488.4185848923748}, "policy_reward_max": {"policy_0": 7.113715042645663}, "policy_reward_mean": {"policy_0": -498.6482016570675}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3951.8291532711874, -3424.8096697313167, -1770.502487865451, -3605.641263931944, -1931.2158180924748, -2635.396091633965, -3203.758112303903, -2325.389469702213, -3359.4318587632147, -839.6472414672928, -2417.208802500859, -1759.458594148442, -2552.7223565841564, -1667.7259275122506, -3645.1142586140677, -2389.1269366922234, -4652.886259048478, -3059.2926758715494, -2867.0066112886866, -1805.3636058632087, -3172.4286391523765, -1179.203472982404, -1308.1047602470096, -2613.473056449931, -2764.116684382811, -2570.597392401431, -2966.602730477308, -1594.7406254086077, -654.4132796302301, -2353.5949972263675, -3782.8501122586854, -2743.6675582239095, -2416.7713442743084, -2756.531219112108, -2101.4014305716505, -2681.2310988452537, -2714.427764194739, -3046.744045586007, -3221.2767069107517, -3483.604783738535, -2365.8157968965857, -2369.8244774855807, -2698.4477659419176, -1223.3152929533942, -3738.0160270500496, -2079.1019522932643, -1329.4898186787311, -4071.665345151408, -3492.2790514132057, -1857.386110749551, -2261.863118010099, -815.429292155686, -3425.038058455414, -2580.3510225538457, -1152.1488648397308, -3799.537946209204, -934.3206956589157, -938.8304718825616, -3015.9264713877837, -1872.285580871474, -2563.922939129366, -2187.1421659995485, -2676.512324855836, -1562.931101749126, -2136.849786175543, -2140.546876639418, -1806.7342518869561, -2799.0727421069764, -4499.719753693132, -2496.905865932914, -923.0181525711137, -1907.5833892022213, -2514.2625234317425, -3264.4965412155907, -2327.1541548633704, -2079.372640408234, -2008.7778193969325, -1876.4418416538674, -2460.3575752207553, -2494.123240586772, -3291.3260693335915, -3583.8861241892923, -2881.1279150776427, -2842.3515730347294, -3492.6531404726006, -1617.1420443549628, -1014.7006096619949, -2677.120019630583, -2631.0834188985973, -1591.6188577647147, -2068.365513163284, -1738.387508709272, -3542.2353095080734, -2199.8614915513144, -1903.4463619701755, -2618.2835741317263, -1857.420918274037, -4929.573857001566, -1805.1163135488573, -4302.0924639376035], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 147, 136, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 129, 150, 115, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-833.8974511333499, -942.4380167931903, -196.85508239074656, -847.6853947016444, -1130.9532082522537, -487.030631425656, -937.3583131476047, -414.4554017599537, -1002.2435928177024, -583.7217305804039, -48.77299481021699, -450.21845329992755, -749.5571926772903, -350.29834216005423, -171.655504917963, -389.2397711752614, -683.3144630823664, -999.906170380499, -706.2195728846755, -826.9612864091382, -316.65495948062807, -60.55545854165439, -514.3271281702241, -592.960259605496, -446.7180122944723, -976.3308889737687, -427.50264204330097, -732.3059054821642, -231.407985129242, -267.84867000548394, -721.583586284392, -268.38259202685066, -247.36358643077108, -1006.1275947139068, -960.3007528479847, -1080.3036031380545, -298.7911370782199, -249.23145266478065, -667.9405656401786, -29.12271118097822, -778.3261981083816, -59.30328545142672, -1465.2945351160868, -993.3536871672952, -63.15415292002341, -25.664730160239582, -39.68023784416779, -227.85640159529947, -44.906813163580566, -501.5390587040056, -480.0216136418612, -271.35649265177483, -393.23020780261567, -511.7153781520408, -760.8851102525679, -194.4079331854564, -387.4782491357705, -244.92459925425953, -371.25976409290337, -561.3880484800511, -233.94637404391383, -1045.5305450577632, -409.42827478693744, -60.49582505658293, -803.321337638956, -430.6731479143051, -204.61745802913904, -393.36908467390714, -217.6850075449529, -421.38122934994806, -964.4998756158699, -454.94689446906347, -1256.9076818814028, -262.26279789187106, -706.4970087558576, -921.4268531217208, -44.6953133068364, -611.1168586618013, -596.6607752324697, -215.22713636939477, -1382.5454832051976, -1330.6179053533972, -830.729241354389, -73.16805857464388, -1035.8255705608392, -299.23151770922385, -995.7095964650742, -473.47494456963994, -246.61464525137342, -1044.2619718762378, -436.2288670284164, -35.467462325025195, -1096.915209035362, -6.838446898369053, -1291.556626001512, -49.08560318878213, -740.9237378540658, -237.73055471549992, -744.233557650126, -33.39015245473478, -37.01257717613625, -630.7433055086927, -1438.6546051463158, -722.1577857721555, -343.8603655490786, -294.37069739658364, -112.01894749337566, -594.9296920960285, -75.10921342114936, -102.77492257526691, -75.88726799075837, -332.5486445309958, -506.1888456032635, -68.68636871657105, -324.7936334054218, -866.7917944859471, -1196.610817051536, -139.4119403200527, -325.5525176366199, -85.10598695577549, -174.84571942495793, -802.5566682887267, -1199.8870181369125, -112.2191553757511, -474.60812315646524, -129.84067519130545, -789.0633942663899, -222.05956741989036, -974.5916055020624, -455.04215002178205, -688.3368830445512, -445.59570512922517, -914.7774432831216, -559.4533855937881, -358.4393134266253, -93.92632920475265, -214.10834957578848, -270.0959249264506, -147.47546464847744, -869.1345570531398, -75.86805942585241, -302.8119704134912, -151.61625198215364, -116.47122794205285, -7.645769866680077, -140.14319016399483, -968.4375885756326, -645.0386983902877, -546.079346261529, -53.896173834924234, -647.8790848925403, -831.8621511932085, -834.4375092159938, -467.8897540254234, -1000.7816129315203, -75.66573127878061, -398.39668565575363, -1014.8811673895239, -528.4732150626002, -726.2507588372539, -98.52156764517557, -552.5242806413868, -1056.1146029639674, -193.34529740358278, -516.265595620195, -456.5285384926039, -529.3269091105637, -899.0253696758152, -97.69312124240523, -773.9572805907162, -953.2890587845804, -600.0470807945521, -78.05586796433833, -350.59456841172636, -119.41485461645311, -1198.1176860539256, -123.53296193455493, -1239.1805848921315, -23.617487372439502, -96.78237859220407, -529.7271710200953, -544.7276984487218, -968.2668954887458, -510.9326617999156, -160.77333743725978, -952.4732127408356, -348.34369936765484, -352.50624921304876, -1057.3986769029875, -336.02220736148087, -187.67116033255644, -90.68081374480514, -990.1064172687965, -922.6208416602798, -1030.197473904311, -69.12661435033714, -740.0817828479959, -984.4763407192656, -945.106004213642, -744.8140416072955, -211.44663626152638, -777.1013621114272, -234.8970092098, -1025.7442381452577, -116.62655116857736, -198.375166172008, -837.2644201030216, -406.3591231940638, -200.23218509331338, -727.5935829231739, -55.01522335405504, -1164.1402850915017, -476.0837987613086, -368.74322073563127, -634.4652379994226, -635.8058225217853, -69.68576693697996, -78.86800526530179, -74.36617671056169, -364.5895215187648, -1226.3870826706866, -737.3669855196888, -1123.3678607607349, -549.0995445508906, -101.79455354805104, -707.9032734283539, -489.8051823539207, -64.79924139242178, -210.96643363603923, -605.6278214825295, -138.985667842339, -29.57044677326533, -738.793706155618, -242.60697212340028, -179.53302578410836, -965.3378111877589, -1170.8445893502578, -1015.0921237966023, -394.87073445432395, -525.5200863624636, -143.89245076697318, -1106.5557846130632, -1323.902848847113, -174.60628157306937, -743.3216856129889, -166.1381703987376, -1057.6889002455969, -220.24062161979916, -100.31130204412197, -313.00711644129643, -122.25954065643417, -167.71365209535955, -127.45803638240307, -842.0821508101288, -1002.3497380657705, -314.7646462002511, -279.1703073794403, -31.343470799899873, -54.93945884806831, -135.21140892802632, -216.07379561630182, -43.37696613190415, -1120.7986107471024, -571.6125356010239, -1473.1761503590797, -73.8032521961263, -37.57506074882699, -1095.4631313291563, -414.4632823033503, -959.0462959763854, -136.27748648760394, -386.40434405177456, -59.09634610054897, -445.26392655909143, -125.10676164071185, -1243.0411230627617, -363.78750202726076, -47.016985122128986, -1221.1837840100231, -924.5085519870323, -358.6199642691323, -40.46381339197325, -70.5098198713211, -153.71076796199517, -311.01633016449404, -117.549016110456, -234.9862486834566, -66.27686912480318, -349.52721761928007, -170.49112034456547, -242.81840677820267, -14.16507400649417, -1032.7975268639689, -507.33472007482, -1218.8107436642952, -547.2841031271361, -888.7045928187056, -255.55929540187162, -105.52127962576749, -75.21630989799276, -32.914123367606436, -984.3347172936528, -1049.9392535917902, -227.98416734842056, -268.7506775278946, -459.7900322154568, -294.50628435985794, -650.0856525415526, -739.4308399707007, -43.329356911981165, -1333.8824148305926, -283.6336423516662, -447.6876430655851, -531.4848704365266, -79.82375417146595, -90.27778443212792, -480.7856608229715, -399.8160421948666, -292.39525812614687, -299.65635617301353, -697.4386709812228, -136.07801327949753, -73.53682815765386, -449.80812413715563, -779.9881496200155, -94.64708699206662, -927.0313507431773, -628.4393345214879, -32.85573471307326, -457.5733696696131, -42.563926821546524, -166.6139960126592, -621.8437453100142, -741.8009490357169, -233.91163470701753, -1357.6511007433107, -554.5052680041002, -32.74268721209102, -601.8166165542069, -252.35706959326632, -1052.532272467234, -1135.7548923519223, -440.9790013134429, -759.6188133548361, -1110.8347742056976, -411.90401876476295, -1080.6209955132576, -351.5781729982875, -458.713241764939, -194.08943689166333, -374.2846193578057, -302.9637356985888, -152.05179402889453, -54.76132649576219, -38.95667699006166, -1103.3953202589885, -136.0711464838559, -160.9161489792066, -498.643368252204, -8.55740522796597, -41.26387041665659, -531.7039234533623, -509.48339034450885, -930.7301030602733, -501.08123615694507, -1298.054770696933, -1237.8419767897183, -515.4241460692075, -52.30925033783946, -160.86639732189394, -562.8941561321303, -247.17877251498086, -407.85407004569015, -203.45287709183884, -905.774279078732, -207.5915937817269, -712.8627780388464, -832.2826219783819, -331.1534580611004, 4.517811451821562, -691.4761191404485, -133.59290845499584, -162.5999447881009, -858.4246699742913, -162.68417703909645, -206.2929429778298, -453.5110236520561, -969.9536264504345, -191.9769847130315, -54.707263860514814, -678.6756622933964, -385.58470503263874, -598.2427466585144, -27.33160951680653, -770.5228517193943, -493.02633402935663, -2.6901066693591043, -824.8915906175499, -1047.8413959933118, -125.6738132771954, -1217.318898507457, -298.23105841360604, -311.3325558754794, -461.5621154815694, -1002.8814410554776, -857.1836839704592, -824.2438044333131, -1372.3213479194496, -537.2510029087147, 7.113715042645663, -934.5943885050583, -1017.9306669123214, -153.53488807809194, -632.8343049202351, -142.23366666193724, -1002.5220442458991, -257.5333295923813, -237.55289784932884, -304.1821178888756, -1040.5611834582444, -1392.0743055075009, -1119.6850094369997, -536.0233537790322, -22.101998408914852, -422.76847334015315, -184.33583889293038, -161.55640877570718, -478.59322826494366, -441.2607860007791, -351.3957824206026, -40.24999815035782, -62.27337971528309, -463.42739048859374, -96.85302395674256, -351.8968173510184, -467.1168757916158, -892.0053371378917, -741.268803943326, -123.85993548389008, -452.869067273858, -534.4662573312983, -322.85349711787734, -235.33570758442806, -971.8705373291776, -566.5574195358201, -318.467371182306, -367.54978084141004, -605.726557079851, -185.7064158509926, -114.16873281015422, -64.89334889717408, -268.5983499712022, -571.6813100893702, -973.0229670754328, -190.16953713010705, -959.0990087237687, -70.08687780929645, -36.7299875052603, -326.46596226426624, -346.00567240668136, -1248.6373972560793, -806.6775437377577, -54.80863138010158, -136.59260280170315, -1295.519134332431, -703.525793616399, -748.1131263388477, -300.78071384204094, -232.39031096832318, -215.0515467857012, -88.27112985906766, -488.5879985415069, -456.44506891749165, -831.5490844634778, -38.59308018863136, -326.48493375992774, -484.89550131455104, -488.57202566393767, -209.07063366114582, -1109.2604797321633, -628.9464609314138, -168.634227231908, -176.96540823378757, -296.26215367330803, -586.6126682036198, -1488.4185848923748, -926.1846770597466, -883.9619369272755, -914.950112848006, -716.0585452741682, -776.0936598825875, -227.12045406798217, -380.37742150698324, -19.327388274833382, -402.19738981647225, -1180.662848419561, -481.93223885996184, -976.2424046866012, -1036.01723811686, -627.2377338546175]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.476836970806058, "mean_inference_ms": 1.6883758972030847, "mean_action_processing_ms": 0.7829727660238652, "mean_env_wait_ms": 9.872487555760765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013158798217773438, "StateBufferConnector_ms": 0.009263038635253906, "ViewRequirementAgentConnector_ms": 0.3053874969482422}, "num_episodes": 32, "episode_return_max": -654.4132796302301, "episode_return_min": -4929.573857001566, "episode_return_mean": -2493.241008285337, "episodes_this_iter": 32}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1293177, "num_agent_steps_trained": 1293177, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 67.22482143899656, "num_env_steps_trained_throughput_per_sec": 67.22482143899656, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 1293177, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1293177, "timers": {"training_iteration_time_ms": 55106.606, "restore_workers_time_ms": 0.03, "training_step_time_ms": 55106.526, "sample_time_ms": 3244.288, "learn_time_ms": 51800.402, "learn_throughput": 77.219, "synch_weights_time_ms": 58.616}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1293177, "num_agent_steps_trained": 1293177}, "done": false, "training_iteration": 75, "trial_id": "efc54_00000", "date": "2024-07-24_19-47-47", "timestamp": 1721830667, "time_this_iter_s": 59.51290488243103, "time_total_s": 4063.4367411136627, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x717514106dd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4063.4367411136627, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 9.661904761904761, "ram_util_percent": 23.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 113.53846319853658, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.678283633788427, "policy_loss": -0.0016154089802640932, "vf_loss": 4.69808936679002, "vf_explained_var": 0.9884365138381419, "kl": 0.0111694021858516, "entropy": 2.6672082823936387, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.5909090909091, "num_grad_updates_lifetime": 306090.5, "diff_num_grad_updates_vs_sampler_policy": 1979.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1310019, "num_agent_steps_trained": 1310019}, "env_runners": {"episode_reward_max": -375.41695529952835, "episode_reward_min": -4929.573857001566, "episode_reward_mean": -2441.155276953704, "episode_len_mean": 146.3, "episode_media": {}, "episodes_timesteps_total": 14630, "policy_reward_min": {"policy_0": -1499.48862879549}, "policy_reward_max": {"policy_0": 7.113715042645663}, "policy_reward_mean": {"policy_0": -488.23105539074083}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2570.597392401431, -2966.602730477308, -1594.7406254086077, -654.4132796302301, -2353.5949972263675, -3782.8501122586854, -2743.6675582239095, -2416.7713442743084, -2756.531219112108, -2101.4014305716505, -2681.2310988452537, -2714.427764194739, -3046.744045586007, -3221.2767069107517, -3483.604783738535, -2365.8157968965857, -2369.8244774855807, -2698.4477659419176, -1223.3152929533942, -3738.0160270500496, -2079.1019522932643, -1329.4898186787311, -4071.665345151408, -3492.2790514132057, -1857.386110749551, -2261.863118010099, -815.429292155686, -3425.038058455414, -2580.3510225538457, -1152.1488648397308, -3799.537946209204, -934.3206956589157, -938.8304718825616, -3015.9264713877837, -1872.285580871474, -2563.922939129366, -2187.1421659995485, -2676.512324855836, -1562.931101749126, -2136.849786175543, -2140.546876639418, -1806.7342518869561, -2799.0727421069764, -4499.719753693132, -2496.905865932914, -923.0181525711137, -1907.5833892022213, -2514.2625234317425, -3264.4965412155907, -2327.1541548633704, -2079.372640408234, -2008.7778193969325, -1876.4418416538674, -2460.3575752207553, -2494.123240586772, -3291.3260693335915, -3583.8861241892923, -2881.1279150776427, -2842.3515730347294, -3492.6531404726006, -1617.1420443549628, -1014.7006096619949, -2677.120019630583, -2631.0834188985973, -1591.6188577647147, -2068.365513163284, -1738.387508709272, -3542.2353095080734, -2199.8614915513144, -1903.4463619701755, -2618.2835741317263, -1857.420918274037, -4929.573857001566, -1805.1163135488573, -4302.0924639376035, -2137.0222451427417, -3115.6720995258383, -608.5175181294791, -2326.809342362351, -2536.9844175068756, -3574.696625107704, -2748.797869594855, -1747.0883884138618, -1999.7708540219508, -1607.1840634966948, -2898.3021647550113, -3384.2308794026, -3013.545709464724, -2731.879944437499, -2388.0328821648045, -4269.898723402652, -1881.1116870980645, -2698.1834805732674, -3660.129369192215, -3226.8532201769062, -2224.6097628181856, -375.41695529952835, -975.0294181581314, -1347.863268035967, -2214.649786656171], "episode_lengths": [150, 150, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 129, 150, 115, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 77, 150, 141, 150], "policy_policy_0_reward": [-129.84067519130545, -789.0633942663899, -222.05956741989036, -974.5916055020624, -455.04215002178205, -688.3368830445512, -445.59570512922517, -914.7774432831216, -559.4533855937881, -358.4393134266253, -93.92632920475265, -214.10834957578848, -270.0959249264506, -147.47546464847744, -869.1345570531398, -75.86805942585241, -302.8119704134912, -151.61625198215364, -116.47122794205285, -7.645769866680077, -140.14319016399483, -968.4375885756326, -645.0386983902877, -546.079346261529, -53.896173834924234, -647.8790848925403, -831.8621511932085, -834.4375092159938, -467.8897540254234, -1000.7816129315203, -75.66573127878061, -398.39668565575363, -1014.8811673895239, -528.4732150626002, -726.2507588372539, -98.52156764517557, -552.5242806413868, -1056.1146029639674, -193.34529740358278, -516.265595620195, -456.5285384926039, -529.3269091105637, -899.0253696758152, -97.69312124240523, -773.9572805907162, -953.2890587845804, -600.0470807945521, -78.05586796433833, -350.59456841172636, -119.41485461645311, -1198.1176860539256, -123.53296193455493, -1239.1805848921315, -23.617487372439502, -96.78237859220407, -529.7271710200953, -544.7276984487218, -968.2668954887458, -510.9326617999156, -160.77333743725978, -952.4732127408356, -348.34369936765484, -352.50624921304876, -1057.3986769029875, -336.02220736148087, -187.67116033255644, -90.68081374480514, -990.1064172687965, -922.6208416602798, -1030.197473904311, -69.12661435033714, -740.0817828479959, -984.4763407192656, -945.106004213642, -744.8140416072955, -211.44663626152638, -777.1013621114272, -234.8970092098, -1025.7442381452577, -116.62655116857736, -198.375166172008, -837.2644201030216, -406.3591231940638, -200.23218509331338, -727.5935829231739, -55.01522335405504, -1164.1402850915017, -476.0837987613086, -368.74322073563127, -634.4652379994226, -635.8058225217853, -69.68576693697996, -78.86800526530179, -74.36617671056169, -364.5895215187648, -1226.3870826706866, -737.3669855196888, -1123.3678607607349, -549.0995445508906, -101.79455354805104, -707.9032734283539, -489.8051823539207, -64.79924139242178, -210.96643363603923, -605.6278214825295, -138.985667842339, -29.57044677326533, -738.793706155618, -242.60697212340028, -179.53302578410836, -965.3378111877589, -1170.8445893502578, -1015.0921237966023, -394.87073445432395, -525.5200863624636, -143.89245076697318, -1106.5557846130632, -1323.902848847113, -174.60628157306937, -743.3216856129889, -166.1381703987376, -1057.6889002455969, -220.24062161979916, -100.31130204412197, -313.00711644129643, -122.25954065643417, -167.71365209535955, -127.45803638240307, -842.0821508101288, -1002.3497380657705, -314.7646462002511, -279.1703073794403, -31.343470799899873, -54.93945884806831, -135.21140892802632, -216.07379561630182, -43.37696613190415, -1120.7986107471024, -571.6125356010239, -1473.1761503590797, -73.8032521961263, -37.57506074882699, -1095.4631313291563, -414.4632823033503, -959.0462959763854, -136.27748648760394, -386.40434405177456, -59.09634610054897, -445.26392655909143, -125.10676164071185, -1243.0411230627617, -363.78750202726076, -47.016985122128986, -1221.1837840100231, -924.5085519870323, -358.6199642691323, -40.46381339197325, -70.5098198713211, -153.71076796199517, -311.01633016449404, -117.549016110456, -234.9862486834566, -66.27686912480318, -349.52721761928007, -170.49112034456547, -242.81840677820267, -14.16507400649417, -1032.7975268639689, -507.33472007482, -1218.8107436642952, -547.2841031271361, -888.7045928187056, -255.55929540187162, -105.52127962576749, -75.21630989799276, -32.914123367606436, -984.3347172936528, -1049.9392535917902, -227.98416734842056, -268.7506775278946, -459.7900322154568, -294.50628435985794, -650.0856525415526, -739.4308399707007, -43.329356911981165, -1333.8824148305926, -283.6336423516662, -447.6876430655851, -531.4848704365266, -79.82375417146595, -90.27778443212792, -480.7856608229715, -399.8160421948666, -292.39525812614687, -299.65635617301353, -697.4386709812228, -136.07801327949753, -73.53682815765386, -449.80812413715563, -779.9881496200155, -94.64708699206662, -927.0313507431773, -628.4393345214879, -32.85573471307326, -457.5733696696131, -42.563926821546524, -166.6139960126592, -621.8437453100142, -741.8009490357169, -233.91163470701753, -1357.6511007433107, -554.5052680041002, -32.74268721209102, -601.8166165542069, -252.35706959326632, -1052.532272467234, -1135.7548923519223, -440.9790013134429, -759.6188133548361, -1110.8347742056976, -411.90401876476295, -1080.6209955132576, -351.5781729982875, -458.713241764939, -194.08943689166333, -374.2846193578057, -302.9637356985888, -152.05179402889453, -54.76132649576219, -38.95667699006166, -1103.3953202589885, -136.0711464838559, -160.9161489792066, -498.643368252204, -8.55740522796597, -41.26387041665659, -531.7039234533623, -509.48339034450885, -930.7301030602733, -501.08123615694507, -1298.054770696933, -1237.8419767897183, -515.4241460692075, -52.30925033783946, -160.86639732189394, -562.8941561321303, -247.17877251498086, -407.85407004569015, -203.45287709183884, -905.774279078732, -207.5915937817269, -712.8627780388464, -832.2826219783819, -331.1534580611004, 4.517811451821562, -691.4761191404485, -133.59290845499584, -162.5999447881009, -858.4246699742913, -162.68417703909645, -206.2929429778298, -453.5110236520561, -969.9536264504345, -191.9769847130315, -54.707263860514814, -678.6756622933964, -385.58470503263874, -598.2427466585144, -27.33160951680653, -770.5228517193943, -493.02633402935663, -2.6901066693591043, -824.8915906175499, -1047.8413959933118, -125.6738132771954, -1217.318898507457, -298.23105841360604, -311.3325558754794, -461.5621154815694, -1002.8814410554776, -857.1836839704592, -824.2438044333131, -1372.3213479194496, -537.2510029087147, 7.113715042645663, -934.5943885050583, -1017.9306669123214, -153.53488807809194, -632.8343049202351, -142.23366666193724, -1002.5220442458991, -257.5333295923813, -237.55289784932884, -304.1821178888756, -1040.5611834582444, -1392.0743055075009, -1119.6850094369997, -536.0233537790322, -22.101998408914852, -422.76847334015315, -184.33583889293038, -161.55640877570718, -478.59322826494366, -441.2607860007791, -351.3957824206026, -40.24999815035782, -62.27337971528309, -463.42739048859374, -96.85302395674256, -351.8968173510184, -467.1168757916158, -892.0053371378917, -741.268803943326, -123.85993548389008, -452.869067273858, -534.4662573312983, -322.85349711787734, -235.33570758442806, -971.8705373291776, -566.5574195358201, -318.467371182306, -367.54978084141004, -605.726557079851, -185.7064158509926, -114.16873281015422, -64.89334889717408, -268.5983499712022, -571.6813100893702, -973.0229670754328, -190.16953713010705, -959.0990087237687, -70.08687780929645, -36.7299875052603, -326.46596226426624, -346.00567240668136, -1248.6373972560793, -806.6775437377577, -54.80863138010158, -136.59260280170315, -1295.519134332431, -703.525793616399, -748.1131263388477, -300.78071384204094, -232.39031096832318, -215.0515467857012, -88.27112985906766, -488.5879985415069, -456.44506891749165, -831.5490844634778, -38.59308018863136, -326.48493375992774, -484.89550131455104, -488.57202566393767, -209.07063366114582, -1109.2604797321633, -628.9464609314138, -168.634227231908, -176.96540823378757, -296.26215367330803, -586.6126682036198, -1488.4185848923748, -926.1846770597466, -883.9619369272755, -914.950112848006, -716.0585452741682, -776.0936598825875, -227.12045406798217, -380.37742150698324, -19.327388274833382, -402.19738981647225, -1180.662848419561, -481.93223885996184, -976.2424046866012, -1036.01723811686, -627.2377338546175, -1205.21973396937, -113.60077582581529, -94.99622543990522, -82.46570792149417, -640.739801986156, -825.3354805689631, -339.36223515217796, -1120.1604418970785, -580.6872501027747, -250.12669180484227, -12.380866653106946, -107.27295885137758, -23.46195451666809, -249.47241901465756, -215.92931909366948, -779.1773512054655, -210.1898608347219, -620.7691500471072, -127.7684414900976, -588.9045387849592, -455.57818221117736, -468.79746547345286, -576.9973138331446, -156.3282474469586, -879.2832085421416, -925.633341740255, -1070.415572015351, -1273.1732233697237, -116.96231618484984, -188.51217179752402, -790.0199033333879, -531.9305384591313, -80.22711859541603, -406.0557014544358, -940.5646077524852, -84.58830440369715, -485.31412687251657, -906.5728044085988, -69.50941727416756, -201.1037354548806, -312.14644881258204, -166.53625652284043, -827.0822813207512, -329.99439684564175, -364.011470520133, -258.4414954183073, -198.09328115955648, -284.4500414977531, -801.7954452253515, -64.40380019572711, -925.6362083116986, -298.5871449971994, -984.1014527822366, -76.38025587324141, -613.5971027906336, -79.67784758393132, -158.17053114595183, -815.0077389354567, -1309.423977548696, -1021.9507841885641, -171.16888793916425, -383.06963570397886, -901.5891469349191, -891.6091014968545, -666.1089373898079, -92.7180674337378, -757.0626979582611, -429.21488662203916, -1434.4162409362307, -18.468051487230348, -199.54398612309762, -1263.55596401478, -512.4530221718567, -320.31283433063754, -92.16707552443151, -937.3614592771622, -1041.3650421696525, -512.8584171407429, -935.0186126807453, -843.2951921343495, -787.4304459650626, -249.4784713682297, -100.06229855073376, -169.77069351021873, -574.3697777038192, -410.8729927241813, -478.4169596589214, -75.0202320026994, -234.38466739197682, -1499.48862879549, -1284.5266037513795, -557.7558436191206, -665.435882430859, -530.4311235291334, -621.9799158617238, -21.991563298021653, -1165.774926167771, -869.7289028621412, -158.55517430870904, -1010.8026535402666, -107.4540108771057, -1304.682925352919, -272.5719466842707, -347.9278310036137, -191.97304890027664, -34.17075641021301, -104.29746444015687, -111.39821530868643, -91.79265173793438, -33.75786740253776, -197.9713171915375, -83.73022752356736, -536.8053446755885, -100.254816833708, -56.26771193372988, -77.18048256217907, -353.1979370183651, -22.374048612497255, -476.28908032408714, -418.82171951883686, -574.0467352111056, -346.4788714993267, -191.7032461949185, -402.3592079656733, -700.0617257851459]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4763024578344885, "mean_inference_ms": 1.6868094247466348, "mean_action_processing_ms": 0.7823831908334746, "mean_env_wait_ms": 9.862247589900273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013184547424316406, "StateBufferConnector_ms": 0.00927114486694336, "ViewRequirementAgentConnector_ms": 0.3048520088195801}, "num_episodes": 25, "episode_return_max": -375.41695529952835, "episode_return_min": -4929.573857001566, "episode_return_mean": -2441.155276953704, "episodes_this_iter": 25}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1310019, "num_agent_steps_trained": 1310019, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.2954657056255, "num_env_steps_trained_throughput_per_sec": 73.2954657056255, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 1310019, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1310019, "timers": {"training_iteration_time_ms": 55035.459, "restore_workers_time_ms": 0.031, "training_step_time_ms": 55035.375, "sample_time_ms": 3258.422, "learn_time_ms": 51714.5, "learn_throughput": 77.348, "synch_weights_time_ms": 59.239}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1310019, "num_agent_steps_trained": 1310019}, "done": false, "training_iteration": 76, "trial_id": "efc54_00000", "date": "2024-07-24_19-48-41", "timestamp": 1721830721, "time_this_iter_s": 54.585365295410156, "time_total_s": 4118.022106409073, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7af6d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4118.022106409073, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 9.916666666666666, "ram_util_percent": 23.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 107.7503956007346, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.60797524874027, "policy_loss": 0.0015001205407465116, "vf_loss": 4.622226151869847, "vf_explained_var": 0.9830295091256117, "kl": 0.014265282024720457, "entropy": 2.658371669206864, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.15384615384616, "num_grad_updates_lifetime": 310020.5, "diff_num_grad_updates_vs_sampler_policy": 1949.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1326549, "num_agent_steps_trained": 1326549}, "env_runners": {"episode_reward_max": -375.41695529952835, "episode_reward_min": -4929.573857001566, "episode_reward_mean": -2340.018864110384, "episode_len_mean": 145.5, "episode_media": {}, "episodes_timesteps_total": 14550, "policy_reward_min": {"policy_0": -1499.48862879549}, "policy_reward_max": {"policy_0": 7.113715042645663}, "policy_reward_mean": {"policy_0": -468.00377282207694}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1857.386110749551, -2261.863118010099, -815.429292155686, -3425.038058455414, -2580.3510225538457, -1152.1488648397308, -3799.537946209204, -934.3206956589157, -938.8304718825616, -3015.9264713877837, -1872.285580871474, -2563.922939129366, -2187.1421659995485, -2676.512324855836, -1562.931101749126, -2136.849786175543, -2140.546876639418, -1806.7342518869561, -2799.0727421069764, -4499.719753693132, -2496.905865932914, -923.0181525711137, -1907.5833892022213, -2514.2625234317425, -3264.4965412155907, -2327.1541548633704, -2079.372640408234, -2008.7778193969325, -1876.4418416538674, -2460.3575752207553, -2494.123240586772, -3291.3260693335915, -3583.8861241892923, -2881.1279150776427, -2842.3515730347294, -3492.6531404726006, -1617.1420443549628, -1014.7006096619949, -2677.120019630583, -2631.0834188985973, -1591.6188577647147, -2068.365513163284, -1738.387508709272, -3542.2353095080734, -2199.8614915513144, -1903.4463619701755, -2618.2835741317263, -1857.420918274037, -4929.573857001566, -1805.1163135488573, -4302.0924639376035, -2137.0222451427417, -3115.6720995258383, -608.5175181294791, -2326.809342362351, -2536.9844175068756, -3574.696625107704, -2748.797869594855, -1747.0883884138618, -1999.7708540219508, -1607.1840634966948, -2898.3021647550113, -3384.2308794026, -3013.545709464724, -2731.879944437499, -2388.0328821648045, -4269.898723402652, -1881.1116870980645, -2698.1834805732674, -3660.129369192215, -3226.8532201769062, -2224.6097628181856, -375.41695529952835, -975.0294181581314, -1347.863268035967, -2214.649786656171, -2287.3523023674493, -2953.444388423948, -2494.195374306101, -790.9918687766285, -1241.9692053922795, -1555.7079160225517, -4140.551537655596, -1616.4768838046396, -1773.09708387964, -2190.8450785566347, -1394.8790815873222, -3497.9065465422113, -2180.2629940087545, -3060.0195832390223, -2914.9445505247227, -827.299359071246, -2893.1404882415104, -1092.7507233399808, -859.2862084437033, -2915.0015605922217, -2676.1140350117485, -1625.271813403168, -1966.911629129171, -3394.3491200718017], "episode_lengths": [150, 150, 124, 150, 150, 129, 150, 115, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 77, 150, 141, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 92, 150, 135, 96, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-166.1381703987376, -1057.6889002455969, -220.24062161979916, -100.31130204412197, -313.00711644129643, -122.25954065643417, -167.71365209535955, -127.45803638240307, -842.0821508101288, -1002.3497380657705, -314.7646462002511, -279.1703073794403, -31.343470799899873, -54.93945884806831, -135.21140892802632, -216.07379561630182, -43.37696613190415, -1120.7986107471024, -571.6125356010239, -1473.1761503590797, -73.8032521961263, -37.57506074882699, -1095.4631313291563, -414.4632823033503, -959.0462959763854, -136.27748648760394, -386.40434405177456, -59.09634610054897, -445.26392655909143, -125.10676164071185, -1243.0411230627617, -363.78750202726076, -47.016985122128986, -1221.1837840100231, -924.5085519870323, -358.6199642691323, -40.46381339197325, -70.5098198713211, -153.71076796199517, -311.01633016449404, -117.549016110456, -234.9862486834566, -66.27686912480318, -349.52721761928007, -170.49112034456547, -242.81840677820267, -14.16507400649417, -1032.7975268639689, -507.33472007482, -1218.8107436642952, -547.2841031271361, -888.7045928187056, -255.55929540187162, -105.52127962576749, -75.21630989799276, -32.914123367606436, -984.3347172936528, -1049.9392535917902, -227.98416734842056, -268.7506775278946, -459.7900322154568, -294.50628435985794, -650.0856525415526, -739.4308399707007, -43.329356911981165, -1333.8824148305926, -283.6336423516662, -447.6876430655851, -531.4848704365266, -79.82375417146595, -90.27778443212792, -480.7856608229715, -399.8160421948666, -292.39525812614687, -299.65635617301353, -697.4386709812228, -136.07801327949753, -73.53682815765386, -449.80812413715563, -779.9881496200155, -94.64708699206662, -927.0313507431773, -628.4393345214879, -32.85573471307326, -457.5733696696131, -42.563926821546524, -166.6139960126592, -621.8437453100142, -741.8009490357169, -233.91163470701753, -1357.6511007433107, -554.5052680041002, -32.74268721209102, -601.8166165542069, -252.35706959326632, -1052.532272467234, -1135.7548923519223, -440.9790013134429, -759.6188133548361, -1110.8347742056976, -411.90401876476295, -1080.6209955132576, -351.5781729982875, -458.713241764939, -194.08943689166333, -374.2846193578057, -302.9637356985888, -152.05179402889453, -54.76132649576219, -38.95667699006166, -1103.3953202589885, -136.0711464838559, -160.9161489792066, -498.643368252204, -8.55740522796597, -41.26387041665659, -531.7039234533623, -509.48339034450885, -930.7301030602733, -501.08123615694507, -1298.054770696933, -1237.8419767897183, -515.4241460692075, -52.30925033783946, -160.86639732189394, -562.8941561321303, -247.17877251498086, -407.85407004569015, -203.45287709183884, -905.774279078732, -207.5915937817269, -712.8627780388464, -832.2826219783819, -331.1534580611004, 4.517811451821562, -691.4761191404485, -133.59290845499584, -162.5999447881009, -858.4246699742913, -162.68417703909645, -206.2929429778298, -453.5110236520561, -969.9536264504345, -191.9769847130315, -54.707263860514814, -678.6756622933964, -385.58470503263874, -598.2427466585144, -27.33160951680653, -770.5228517193943, -493.02633402935663, -2.6901066693591043, -824.8915906175499, -1047.8413959933118, -125.6738132771954, -1217.318898507457, -298.23105841360604, -311.3325558754794, -461.5621154815694, -1002.8814410554776, -857.1836839704592, -824.2438044333131, -1372.3213479194496, -537.2510029087147, 7.113715042645663, -934.5943885050583, -1017.9306669123214, -153.53488807809194, -632.8343049202351, -142.23366666193724, -1002.5220442458991, -257.5333295923813, -237.55289784932884, -304.1821178888756, -1040.5611834582444, -1392.0743055075009, -1119.6850094369997, -536.0233537790322, -22.101998408914852, -422.76847334015315, -184.33583889293038, -161.55640877570718, -478.59322826494366, -441.2607860007791, -351.3957824206026, -40.24999815035782, -62.27337971528309, -463.42739048859374, -96.85302395674256, -351.8968173510184, -467.1168757916158, -892.0053371378917, -741.268803943326, -123.85993548389008, -452.869067273858, -534.4662573312983, -322.85349711787734, -235.33570758442806, -971.8705373291776, -566.5574195358201, -318.467371182306, -367.54978084141004, -605.726557079851, -185.7064158509926, -114.16873281015422, -64.89334889717408, -268.5983499712022, -571.6813100893702, -973.0229670754328, -190.16953713010705, -959.0990087237687, -70.08687780929645, -36.7299875052603, -326.46596226426624, -346.00567240668136, -1248.6373972560793, -806.6775437377577, -54.80863138010158, -136.59260280170315, -1295.519134332431, -703.525793616399, -748.1131263388477, -300.78071384204094, -232.39031096832318, -215.0515467857012, -88.27112985906766, -488.5879985415069, -456.44506891749165, -831.5490844634778, -38.59308018863136, -326.48493375992774, -484.89550131455104, -488.57202566393767, -209.07063366114582, -1109.2604797321633, -628.9464609314138, -168.634227231908, -176.96540823378757, -296.26215367330803, -586.6126682036198, -1488.4185848923748, -926.1846770597466, -883.9619369272755, -914.950112848006, -716.0585452741682, -776.0936598825875, -227.12045406798217, -380.37742150698324, -19.327388274833382, -402.19738981647225, -1180.662848419561, -481.93223885996184, -976.2424046866012, -1036.01723811686, -627.2377338546175, -1205.21973396937, -113.60077582581529, -94.99622543990522, -82.46570792149417, -640.739801986156, -825.3354805689631, -339.36223515217796, -1120.1604418970785, -580.6872501027747, -250.12669180484227, -12.380866653106946, -107.27295885137758, -23.46195451666809, -249.47241901465756, -215.92931909366948, -779.1773512054655, -210.1898608347219, -620.7691500471072, -127.7684414900976, -588.9045387849592, -455.57818221117736, -468.79746547345286, -576.9973138331446, -156.3282474469586, -879.2832085421416, -925.633341740255, -1070.415572015351, -1273.1732233697237, -116.96231618484984, -188.51217179752402, -790.0199033333879, -531.9305384591313, -80.22711859541603, -406.0557014544358, -940.5646077524852, -84.58830440369715, -485.31412687251657, -906.5728044085988, -69.50941727416756, -201.1037354548806, -312.14644881258204, -166.53625652284043, -827.0822813207512, -329.99439684564175, -364.011470520133, -258.4414954183073, -198.09328115955648, -284.4500414977531, -801.7954452253515, -64.40380019572711, -925.6362083116986, -298.5871449971994, -984.1014527822366, -76.38025587324141, -613.5971027906336, -79.67784758393132, -158.17053114595183, -815.0077389354567, -1309.423977548696, -1021.9507841885641, -171.16888793916425, -383.06963570397886, -901.5891469349191, -891.6091014968545, -666.1089373898079, -92.7180674337378, -757.0626979582611, -429.21488662203916, -1434.4162409362307, -18.468051487230348, -199.54398612309762, -1263.55596401478, -512.4530221718567, -320.31283433063754, -92.16707552443151, -937.3614592771622, -1041.3650421696525, -512.8584171407429, -935.0186126807453, -843.2951921343495, -787.4304459650626, -249.4784713682297, -100.06229855073376, -169.77069351021873, -574.3697777038192, -410.8729927241813, -478.4169596589214, -75.0202320026994, -234.38466739197682, -1499.48862879549, -1284.5266037513795, -557.7558436191206, -665.435882430859, -530.4311235291334, -621.9799158617238, -21.991563298021653, -1165.774926167771, -869.7289028621412, -158.55517430870904, -1010.8026535402666, -107.4540108771057, -1304.682925352919, -272.5719466842707, -347.9278310036137, -191.97304890027664, -34.17075641021301, -104.29746444015687, -111.39821530868643, -91.79265173793438, -33.75786740253776, -197.9713171915375, -83.73022752356736, -536.8053446755885, -100.254816833708, -56.26771193372988, -77.18048256217907, -353.1979370183651, -22.374048612497255, -476.28908032408714, -418.82171951883686, -574.0467352111056, -346.4788714993267, -191.7032461949185, -402.3592079656733, -700.0617257851459, -1182.3453906221403, -8.992836076899911, -236.81334752731314, -177.86597808157973, -681.334750059518, -375.75999244672846, -301.3338402671044, -359.2268777944438, -791.4293070318453, -1125.694370883828, -592.8689722649882, -413.76091364536995, -630.8137460152356, -461.6054368213147, -395.1463055591941, -23.227836401395287, -63.3907326545063, -87.520028154096, -93.2078463118794, -523.6454252547517, -23.371516700820436, -95.89644720602402, -458.3508077118329, -481.49059666754806, -182.8598371060541, -634.8896739323931, -609.443211352774, -97.58089213240642, -92.21362185094614, -121.58051675403308, -1261.4150428782907, -347.1107723833394, -1045.3295603168278, -1226.8733942050114, -259.8227678721279, -462.4350558153773, -162.90509303167477, -156.18507512359537, -62.33586696916752, -772.6157928648252, -41.49605231590236, -162.01399785523705, -756.6389308649041, -380.6043217735816, -432.34378107001413, -529.8352017367306, -161.98125980916137, -977.2000076569614, -445.33022860917015, -76.49838074461275, -920.4671736045242, -140.87381722458187, -56.613628372282236, -133.26075947648604, -143.66370290944633, -832.4063015846217, -44.788827758789616, -744.0966579491487, -944.3755866030957, -932.239172646556, -10.357054082803039, -146.46031695343942, -966.8892759797375, -814.643396976775, -241.91295001599994, -738.5358911298792, -542.5858559678267, -860.1296322405237, -430.06238263604104, -488.705821264749, -874.4851831834542, -231.23084386557665, -1095.1277503886392, -142.17769879978448, -571.9230742872701, -41.2752179576737, -126.94706646747758, -156.7886675678488, -131.41147291091949, -370.8769341673269, -992.9819976109377, -922.5291394874363, -371.5706889421922, -33.251769530301736, -572.8068926706427, -388.9402677850264, -91.17603617935617, -312.4702480567273, -31.837229694041703, -268.326941624829, -105.37312477033008, -140.27640207020096, -275.04149546940477, -101.66347800466889, -236.9317081290991, -1068.4179343623, -237.08262908542375, -867.4211570183604, -118.773967657521, -623.3058724686191, -803.8920801655439, -79.58670739092396, -774.9593822903418, -276.10194995853567, -741.5739152064049, -1205.7041970137996, -153.8394721817647, -84.69498894163289, -106.24969828745306, -74.78345697851742, -454.2996714524729, -748.783215849339, -62.7858309932877, -627.855496001689, -73.18741483238357, -818.4162773515001, -499.6703403671771, -464.60059547177127, -482.5971931070805, -1129.064713774273]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4766252277290264, "mean_inference_ms": 1.6876173890008088, "mean_action_processing_ms": 0.7820453316920809, "mean_env_wait_ms": 9.861704578413166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012793540954589844, "StateBufferConnector_ms": 0.009103059768676758, "ViewRequirementAgentConnector_ms": 0.2950937747955322}, "num_episodes": 24, "episode_return_max": -375.41695529952835, "episode_return_min": -4929.573857001566, "episode_return_mean": -2340.018864110384, "episodes_this_iter": 24}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1326549, "num_agent_steps_trained": 1326549, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.3679822409222, "num_env_steps_trained_throughput_per_sec": 74.3679822409222, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 1326549, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1326549, "timers": {"training_iteration_time_ms": 55160.589, "restore_workers_time_ms": 0.032, "training_step_time_ms": 55160.504, "sample_time_ms": 3262.098, "learn_time_ms": 51836.884, "learn_throughput": 77.165, "synch_weights_time_ms": 58.369}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1326549, "num_agent_steps_trained": 1326549}, "done": false, "training_iteration": 77, "trial_id": "efc54_00000", "date": "2024-07-24_19-49-35", "timestamp": 1721830775, "time_this_iter_s": 53.796881437301636, "time_total_s": 4171.8189878463745, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7175141123b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4171.8189878463745, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 9.764473684210527, "ram_util_percent": 23.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 115.75389713434781, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000007, "total_loss": 4.819136730311573, "policy_loss": 0.0007899453195378833, "vf_loss": 4.835178714558698, "vf_explained_var": 0.9817095933760998, "kl": 0.013100792693057445, "entropy": 2.6780338600637834, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.53623188405797, "num_grad_updates_lifetime": 314040.5, "diff_num_grad_updates_vs_sampler_policy": 2069.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1344149, "num_agent_steps_trained": 1344149}, "env_runners": {"episode_reward_max": -375.41695529952835, "episode_reward_min": -4929.573857001566, "episode_reward_mean": -2385.778851913171, "episode_len_mean": 146.85, "episode_media": {}, "episodes_timesteps_total": 14685, "policy_reward_min": {"policy_0": -1499.48862879549}, "policy_reward_max": {"policy_0": -8.992836076899911}, "policy_reward_mean": {"policy_0": -477.1557703826342}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2881.1279150776427, -2842.3515730347294, -3492.6531404726006, -1617.1420443549628, -1014.7006096619949, -2677.120019630583, -2631.0834188985973, -1591.6188577647147, -2068.365513163284, -1738.387508709272, -3542.2353095080734, -2199.8614915513144, -1903.4463619701755, -2618.2835741317263, -1857.420918274037, -4929.573857001566, -1805.1163135488573, -4302.0924639376035, -2137.0222451427417, -3115.6720995258383, -608.5175181294791, -2326.809342362351, -2536.9844175068756, -3574.696625107704, -2748.797869594855, -1747.0883884138618, -1999.7708540219508, -1607.1840634966948, -2898.3021647550113, -3384.2308794026, -3013.545709464724, -2731.879944437499, -2388.0328821648045, -4269.898723402652, -1881.1116870980645, -2698.1834805732674, -3660.129369192215, -3226.8532201769062, -2224.6097628181856, -375.41695529952835, -975.0294181581314, -1347.863268035967, -2214.649786656171, -2287.3523023674493, -2953.444388423948, -2494.195374306101, -790.9918687766285, -1241.9692053922795, -1555.7079160225517, -4140.551537655596, -1616.4768838046396, -1773.09708387964, -2190.8450785566347, -1394.8790815873222, -3497.9065465422113, -2180.2629940087545, -3060.0195832390223, -2914.9445505247227, -827.299359071246, -2893.1404882415104, -1092.7507233399808, -859.2862084437033, -2915.0015605922217, -2676.1140350117485, -1625.271813403168, -1966.911629129171, -3394.3491200718017, -2361.0151813278862, -1532.9799413025387, -1614.2940620040638, -1649.0475589240634, -2396.4112932577123, -3314.189672241332, -2531.8682678615114, -1737.1819447489484, -2344.797153518234, -1452.6548818956337, -3325.700644365703, -2310.9704732297755, -3923.6675640084513, -3058.9442965507956, -2129.919188583919, -1392.8900181128165, -4089.452310640488, -2572.56852048938, -2872.7131220610245, -2106.0131171220564, -1875.1310369917765, -1728.0101548164141, -2720.386100283813, -2307.6681415488956, -3017.469352966443, -1951.0710502018899, -3542.9524700797588, -1455.8686650015914, -1024.4471297725502, -3181.958799924594, -3578.866171133538, -3188.793299168429, -2540.352709159192], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 77, 150, 141, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 92, 150, 135, 96, 150, 150, 150, 150, 150, 150, 145, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 150, 150, 150], "policy_policy_0_reward": [-934.5943885050583, -1017.9306669123214, -153.53488807809194, -632.8343049202351, -142.23366666193724, -1002.5220442458991, -257.5333295923813, -237.55289784932884, -304.1821178888756, -1040.5611834582444, -1392.0743055075009, -1119.6850094369997, -536.0233537790322, -22.101998408914852, -422.76847334015315, -184.33583889293038, -161.55640877570718, -478.59322826494366, -441.2607860007791, -351.3957824206026, -40.24999815035782, -62.27337971528309, -463.42739048859374, -96.85302395674256, -351.8968173510184, -467.1168757916158, -892.0053371378917, -741.268803943326, -123.85993548389008, -452.869067273858, -534.4662573312983, -322.85349711787734, -235.33570758442806, -971.8705373291776, -566.5574195358201, -318.467371182306, -367.54978084141004, -605.726557079851, -185.7064158509926, -114.16873281015422, -64.89334889717408, -268.5983499712022, -571.6813100893702, -973.0229670754328, -190.16953713010705, -959.0990087237687, -70.08687780929645, -36.7299875052603, -326.46596226426624, -346.00567240668136, -1248.6373972560793, -806.6775437377577, -54.80863138010158, -136.59260280170315, -1295.519134332431, -703.525793616399, -748.1131263388477, -300.78071384204094, -232.39031096832318, -215.0515467857012, -88.27112985906766, -488.5879985415069, -456.44506891749165, -831.5490844634778, -38.59308018863136, -326.48493375992774, -484.89550131455104, -488.57202566393767, -209.07063366114582, -1109.2604797321633, -628.9464609314138, -168.634227231908, -176.96540823378757, -296.26215367330803, -586.6126682036198, -1488.4185848923748, -926.1846770597466, -883.9619369272755, -914.950112848006, -716.0585452741682, -776.0936598825875, -227.12045406798217, -380.37742150698324, -19.327388274833382, -402.19738981647225, -1180.662848419561, -481.93223885996184, -976.2424046866012, -1036.01723811686, -627.2377338546175, -1205.21973396937, -113.60077582581529, -94.99622543990522, -82.46570792149417, -640.739801986156, -825.3354805689631, -339.36223515217796, -1120.1604418970785, -580.6872501027747, -250.12669180484227, -12.380866653106946, -107.27295885137758, -23.46195451666809, -249.47241901465756, -215.92931909366948, -779.1773512054655, -210.1898608347219, -620.7691500471072, -127.7684414900976, -588.9045387849592, -455.57818221117736, -468.79746547345286, -576.9973138331446, -156.3282474469586, -879.2832085421416, -925.633341740255, -1070.415572015351, -1273.1732233697237, -116.96231618484984, -188.51217179752402, -790.0199033333879, -531.9305384591313, -80.22711859541603, -406.0557014544358, -940.5646077524852, -84.58830440369715, -485.31412687251657, -906.5728044085988, -69.50941727416756, -201.1037354548806, -312.14644881258204, -166.53625652284043, -827.0822813207512, -329.99439684564175, -364.011470520133, -258.4414954183073, -198.09328115955648, -284.4500414977531, -801.7954452253515, -64.40380019572711, -925.6362083116986, -298.5871449971994, -984.1014527822366, -76.38025587324141, -613.5971027906336, -79.67784758393132, -158.17053114595183, -815.0077389354567, -1309.423977548696, -1021.9507841885641, -171.16888793916425, -383.06963570397886, -901.5891469349191, -891.6091014968545, -666.1089373898079, -92.7180674337378, -757.0626979582611, -429.21488662203916, -1434.4162409362307, -18.468051487230348, -199.54398612309762, -1263.55596401478, -512.4530221718567, -320.31283433063754, -92.16707552443151, -937.3614592771622, -1041.3650421696525, -512.8584171407429, -935.0186126807453, -843.2951921343495, -787.4304459650626, -249.4784713682297, -100.06229855073376, -169.77069351021873, -574.3697777038192, -410.8729927241813, -478.4169596589214, -75.0202320026994, -234.38466739197682, -1499.48862879549, -1284.5266037513795, -557.7558436191206, -665.435882430859, -530.4311235291334, -621.9799158617238, -21.991563298021653, -1165.774926167771, -869.7289028621412, -158.55517430870904, -1010.8026535402666, -107.4540108771057, -1304.682925352919, -272.5719466842707, -347.9278310036137, -191.97304890027664, -34.17075641021301, -104.29746444015687, -111.39821530868643, -91.79265173793438, -33.75786740253776, -197.9713171915375, -83.73022752356736, -536.8053446755885, -100.254816833708, -56.26771193372988, -77.18048256217907, -353.1979370183651, -22.374048612497255, -476.28908032408714, -418.82171951883686, -574.0467352111056, -346.4788714993267, -191.7032461949185, -402.3592079656733, -700.0617257851459, -1182.3453906221403, -8.992836076899911, -236.81334752731314, -177.86597808157973, -681.334750059518, -375.75999244672846, -301.3338402671044, -359.2268777944438, -791.4293070318453, -1125.694370883828, -592.8689722649882, -413.76091364536995, -630.8137460152356, -461.6054368213147, -395.1463055591941, -23.227836401395287, -63.3907326545063, -87.520028154096, -93.2078463118794, -523.6454252547517, -23.371516700820436, -95.89644720602402, -458.3508077118329, -481.49059666754806, -182.8598371060541, -634.8896739323931, -609.443211352774, -97.58089213240642, -92.21362185094614, -121.58051675403308, -1261.4150428782907, -347.1107723833394, -1045.3295603168278, -1226.8733942050114, -259.8227678721279, -462.4350558153773, -162.90509303167477, -156.18507512359537, -62.33586696916752, -772.6157928648252, -41.49605231590236, -162.01399785523705, -756.6389308649041, -380.6043217735816, -432.34378107001413, -529.8352017367306, -161.98125980916137, -977.2000076569614, -445.33022860917015, -76.49838074461275, -920.4671736045242, -140.87381722458187, -56.613628372282236, -133.26075947648604, -143.66370290944633, -832.4063015846217, -44.788827758789616, -744.0966579491487, -944.3755866030957, -932.239172646556, -10.357054082803039, -146.46031695343942, -966.8892759797375, -814.643396976775, -241.91295001599994, -738.5358911298792, -542.5858559678267, -860.1296322405237, -430.06238263604104, -488.705821264749, -874.4851831834542, -231.23084386557665, -1095.1277503886392, -142.17769879978448, -571.9230742872701, -41.2752179576737, -126.94706646747758, -156.7886675678488, -131.41147291091949, -370.8769341673269, -992.9819976109377, -922.5291394874363, -371.5706889421922, -33.251769530301736, -572.8068926706427, -388.9402677850264, -91.17603617935617, -312.4702480567273, -31.837229694041703, -268.326941624829, -105.37312477033008, -140.27640207020096, -275.04149546940477, -101.66347800466889, -236.9317081290991, -1068.4179343623, -237.08262908542375, -867.4211570183604, -118.773967657521, -623.3058724686191, -803.8920801655439, -79.58670739092396, -774.9593822903418, -276.10194995853567, -741.5739152064049, -1205.7041970137996, -153.8394721817647, -84.69498894163289, -106.24969828745306, -74.78345697851742, -454.2996714524729, -748.783215849339, -62.7858309932877, -627.855496001689, -73.18741483238357, -818.4162773515001, -499.6703403671771, -464.60059547177127, -482.5971931070805, -1129.064713774273, -400.4366328879113, -117.33025795285869, -392.22354212368265, -476.33052769637777, -974.6942206670564, -637.698085770993, -262.760898589127, -46.76714086937617, -171.02165009091024, -414.7321659821324, -437.5906713631822, -72.79346209549188, -807.3882718873392, -60.478319859691794, -236.04333679835725, -201.23992150420483, -1117.8690918514285, -75.70069782668313, -223.9867469281745, -30.251100813572666, -775.9863501452204, -160.20492960107552, -184.3960796116611, -414.4549548588998, -861.3689790408554, -197.3246141260035, -1224.3799920527365, -1126.3872405409245, -37.885345674882686, -728.2124798467852, -754.4199600182974, -289.6395267736774, -866.0566803678395, -473.1292374221344, -148.62286327956417, -56.87680754128279, -492.23951497133623, -391.64452244408426, -366.19610976007726, -430.224990032168, -187.34918743665, -1010.67607328523, -372.2775087244828, -165.89912561564756, -608.5952584562249, -386.8062551005504, -163.10157051213432, -299.37893747356384, -571.5697244393053, -31.798394370078025, -1384.0039938163195, -894.4310368652366, -465.6553881322158, -368.92368589085186, -212.68653966107777, -542.5706912307502, -94.91161822422127, -913.1962502696862, -219.74949518684218, -540.5424183182762, -1082.447004227866, -1034.3326082825804, -305.61483705858, -1053.562633743651, -447.71048069577387, -1053.4472933273144, -338.95536359990695, -1041.8259628324165, -305.49780103812435, -319.2178757530341, -658.4565728654459, -389.41614363872037, -254.4447910219695, -151.37372972583213, -676.2279513319504, -113.61069203241858, -47.56577888989404, -395.96200725783206, -265.56194525258326, -570.1895946800872, -661.6350072085736, -1058.0804194252166, -797.9583447445466, -413.0246824846213, -1158.7538567775373, -184.68072898736023, -102.19389199071024, -873.8163825607753, -733.163815802786, -678.7137011477461, -712.9472574228824, -499.92395211776085, -887.9846165994039, -486.46869543889255, -285.3886004820819, -93.99504046637458, -25.51573756373483, -449.6155039403475, -274.9652194666647, -1261.9216156849332, -415.6362618658796, -324.97847899794453, -331.4615967561146, -363.4453955647228, -439.60930380711557, -182.5205577678944, -139.40508270972066, -242.27866656917868, -937.8106605917044, -225.99518717791628, -796.9512629097452, -305.5530591436057, -145.49429981675954, -652.5745043835838, -819.8129740301196, -228.18513796903318, -469.5090159296736, -486.08064382797863, -131.1668575592044, -992.726486263008, -757.7396547766712, -218.88623244515935, -828.1584542615257, -492.6215854127203, -720.0634260703675, -893.736787980035, -152.2845781692014, -47.10178160775741, -629.0808579992189, -228.867044445677, -1206.2056767879712, -890.6008268673573, -48.375558748426464, -1305.2600433296998, -92.51036434630487, -70.36402669616304, -294.93191617905603, -250.07448320491622, -457.96172492980287, -382.53651399165324, -247.14848593532258, -199.26992924771355, -95.25920957262139, -250.7095675330828, -232.0599374838097, -797.7668389757888, -389.6815758143381, -97.26456492129692, -1151.3914131828042, -745.854407030365, -396.44658179001897, -888.5210719113245, -133.6832954313939, -1440.06635456813, -720.1488674326671, -55.659192563340284, -560.831380758609, -772.1141525515042, -1312.4711971918528, -487.7173761031238, -136.23824441117003, -462.6930854699823, -800.3135999836692, -127.8976517151886, -1013.2101275791803]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4772932288837992, "mean_inference_ms": 1.6880282696848021, "mean_action_processing_ms": 0.7809570414690039, "mean_env_wait_ms": 9.864362535903261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012931585311889648, "StateBufferConnector_ms": 0.009515047073364258, "ViewRequirementAgentConnector_ms": 0.3117978572845459}, "num_episodes": 33, "episode_return_max": -375.41695529952835, "episode_return_min": -4929.573857001566, "episode_return_mean": -2385.778851913171, "episodes_this_iter": 33}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344149, "num_agent_steps_trained": 1344149, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 70.65220073655223, "num_env_steps_trained_throughput_per_sec": 70.65220073655223, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 1344149, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344149, "timers": {"training_iteration_time_ms": 55004.963, "restore_workers_time_ms": 0.032, "training_step_time_ms": 55004.879, "sample_time_ms": 3244.586, "learn_time_ms": 51700.631, "learn_throughput": 77.368, "synch_weights_time_ms": 56.62}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1344149, "num_agent_steps_trained": 1344149}, "done": false, "training_iteration": 78, "trial_id": "efc54_00000", "date": "2024-07-24_19-50-32", "timestamp": 1721830832, "time_this_iter_s": 56.62801551818848, "time_total_s": 4228.447003364563, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x717514105750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4228.447003364563, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 9.708641975308643, "ram_util_percent": 23.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 133.64318625869382, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000007, "total_loss": 4.578872453187399, "policy_loss": 0.0005693317320116837, "vf_loss": 4.596482477729447, "vf_explained_var": 0.9901772325453551, "kl": 0.0121228976696246, "entropy": 2.738517597792805, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.22463768115942, "num_grad_updates_lifetime": 318180.5, "diff_num_grad_updates_vs_sampler_policy": 2069.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1361706, "num_agent_steps_trained": 1361706}, "env_runners": {"episode_reward_max": -375.41695529952835, "episode_reward_min": -4944.803678705361, "episode_reward_mean": -2435.4482015634553, "episode_len_mean": 147.42, "episode_media": {}, "episodes_timesteps_total": 14742, "policy_reward_min": {"policy_0": -1499.48862879549}, "policy_reward_max": {"policy_0": -6.576407866805617}, "policy_reward_mean": {"policy_0": -487.08964031269113}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2748.797869594855, -1747.0883884138618, -1999.7708540219508, -1607.1840634966948, -2898.3021647550113, -3384.2308794026, -3013.545709464724, -2731.879944437499, -2388.0328821648045, -4269.898723402652, -1881.1116870980645, -2698.1834805732674, -3660.129369192215, -3226.8532201769062, -2224.6097628181856, -375.41695529952835, -975.0294181581314, -1347.863268035967, -2214.649786656171, -2287.3523023674493, -2953.444388423948, -2494.195374306101, -790.9918687766285, -1241.9692053922795, -1555.7079160225517, -4140.551537655596, -1616.4768838046396, -1773.09708387964, -2190.8450785566347, -1394.8790815873222, -3497.9065465422113, -2180.2629940087545, -3060.0195832390223, -2914.9445505247227, -827.299359071246, -2893.1404882415104, -1092.7507233399808, -859.2862084437033, -2915.0015605922217, -2676.1140350117485, -1625.271813403168, -1966.911629129171, -3394.3491200718017, -2361.0151813278862, -1532.9799413025387, -1614.2940620040638, -1649.0475589240634, -2396.4112932577123, -3314.189672241332, -2531.8682678615114, -1737.1819447489484, -2344.797153518234, -1452.6548818956337, -3325.700644365703, -2310.9704732297755, -3923.6675640084513, -3058.9442965507956, -2129.919188583919, -1392.8900181128165, -4089.452310640488, -2572.56852048938, -2872.7131220610245, -2106.0131171220564, -1875.1310369917765, -1728.0101548164141, -2720.386100283813, -2307.6681415488956, -3017.469352966443, -1951.0710502018899, -3542.9524700797588, -1455.8686650015914, -1024.4471297725502, -3181.958799924594, -3578.866171133538, -3188.793299168429, -2540.352709159192, -4944.803678705361, -2782.3479971040756, -1583.821856277845, -1963.8352016567194, -2296.725846375951, -3921.490850671659, -1742.940742402603, -1963.0199029531277, -4339.843018504663, -2609.207635727208, -1542.6798267203756, -2585.395473756142, -2384.7583266997954, -2601.1870277465327, -2940.4329157891034, -4422.276857260062, -2370.727482807375, -3625.936854352366, -2500.5839330519784, -2124.4420423503634, -2068.5621460203006, -2651.768816401142, -2080.540762372109, -2931.888907788292], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 77, 150, 141, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 92, 150, 135, 96, 150, 150, 150, 150, 150, 150, 145, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-790.0199033333879, -531.9305384591313, -80.22711859541603, -406.0557014544358, -940.5646077524852, -84.58830440369715, -485.31412687251657, -906.5728044085988, -69.50941727416756, -201.1037354548806, -312.14644881258204, -166.53625652284043, -827.0822813207512, -329.99439684564175, -364.011470520133, -258.4414954183073, -198.09328115955648, -284.4500414977531, -801.7954452253515, -64.40380019572711, -925.6362083116986, -298.5871449971994, -984.1014527822366, -76.38025587324141, -613.5971027906336, -79.67784758393132, -158.17053114595183, -815.0077389354567, -1309.423977548696, -1021.9507841885641, -171.16888793916425, -383.06963570397886, -901.5891469349191, -891.6091014968545, -666.1089373898079, -92.7180674337378, -757.0626979582611, -429.21488662203916, -1434.4162409362307, -18.468051487230348, -199.54398612309762, -1263.55596401478, -512.4530221718567, -320.31283433063754, -92.16707552443151, -937.3614592771622, -1041.3650421696525, -512.8584171407429, -935.0186126807453, -843.2951921343495, -787.4304459650626, -249.4784713682297, -100.06229855073376, -169.77069351021873, -574.3697777038192, -410.8729927241813, -478.4169596589214, -75.0202320026994, -234.38466739197682, -1499.48862879549, -1284.5266037513795, -557.7558436191206, -665.435882430859, -530.4311235291334, -621.9799158617238, -21.991563298021653, -1165.774926167771, -869.7289028621412, -158.55517430870904, -1010.8026535402666, -107.4540108771057, -1304.682925352919, -272.5719466842707, -347.9278310036137, -191.97304890027664, -34.17075641021301, -104.29746444015687, -111.39821530868643, -91.79265173793438, -33.75786740253776, -197.9713171915375, -83.73022752356736, -536.8053446755885, -100.254816833708, -56.26771193372988, -77.18048256217907, -353.1979370183651, -22.374048612497255, -476.28908032408714, -418.82171951883686, -574.0467352111056, -346.4788714993267, -191.7032461949185, -402.3592079656733, -700.0617257851459, -1182.3453906221403, -8.992836076899911, -236.81334752731314, -177.86597808157973, -681.334750059518, -375.75999244672846, -301.3338402671044, -359.2268777944438, -791.4293070318453, -1125.694370883828, -592.8689722649882, -413.76091364536995, -630.8137460152356, -461.6054368213147, -395.1463055591941, -23.227836401395287, -63.3907326545063, -87.520028154096, -93.2078463118794, -523.6454252547517, -23.371516700820436, -95.89644720602402, -458.3508077118329, -481.49059666754806, -182.8598371060541, -634.8896739323931, -609.443211352774, -97.58089213240642, -92.21362185094614, -121.58051675403308, -1261.4150428782907, -347.1107723833394, -1045.3295603168278, -1226.8733942050114, -259.8227678721279, -462.4350558153773, -162.90509303167477, -156.18507512359537, -62.33586696916752, -772.6157928648252, -41.49605231590236, -162.01399785523705, -756.6389308649041, -380.6043217735816, -432.34378107001413, -529.8352017367306, -161.98125980916137, -977.2000076569614, -445.33022860917015, -76.49838074461275, -920.4671736045242, -140.87381722458187, -56.613628372282236, -133.26075947648604, -143.66370290944633, -832.4063015846217, -44.788827758789616, -744.0966579491487, -944.3755866030957, -932.239172646556, -10.357054082803039, -146.46031695343942, -966.8892759797375, -814.643396976775, -241.91295001599994, -738.5358911298792, -542.5858559678267, -860.1296322405237, -430.06238263604104, -488.705821264749, -874.4851831834542, -231.23084386557665, -1095.1277503886392, -142.17769879978448, -571.9230742872701, -41.2752179576737, -126.94706646747758, -156.7886675678488, -131.41147291091949, -370.8769341673269, -992.9819976109377, -922.5291394874363, -371.5706889421922, -33.251769530301736, -572.8068926706427, -388.9402677850264, -91.17603617935617, -312.4702480567273, -31.837229694041703, -268.326941624829, -105.37312477033008, -140.27640207020096, -275.04149546940477, -101.66347800466889, -236.9317081290991, -1068.4179343623, -237.08262908542375, -867.4211570183604, -118.773967657521, -623.3058724686191, -803.8920801655439, -79.58670739092396, -774.9593822903418, -276.10194995853567, -741.5739152064049, -1205.7041970137996, -153.8394721817647, -84.69498894163289, -106.24969828745306, -74.78345697851742, -454.2996714524729, -748.783215849339, -62.7858309932877, -627.855496001689, -73.18741483238357, -818.4162773515001, -499.6703403671771, -464.60059547177127, -482.5971931070805, -1129.064713774273, -400.4366328879113, -117.33025795285869, -392.22354212368265, -476.33052769637777, -974.6942206670564, -637.698085770993, -262.760898589127, -46.76714086937617, -171.02165009091024, -414.7321659821324, -437.5906713631822, -72.79346209549188, -807.3882718873392, -60.478319859691794, -236.04333679835725, -201.23992150420483, -1117.8690918514285, -75.70069782668313, -223.9867469281745, -30.251100813572666, -775.9863501452204, -160.20492960107552, -184.3960796116611, -414.4549548588998, -861.3689790408554, -197.3246141260035, -1224.3799920527365, -1126.3872405409245, -37.885345674882686, -728.2124798467852, -754.4199600182974, -289.6395267736774, -866.0566803678395, -473.1292374221344, -148.62286327956417, -56.87680754128279, -492.23951497133623, -391.64452244408426, -366.19610976007726, -430.224990032168, -187.34918743665, -1010.67607328523, -372.2775087244828, -165.89912561564756, -608.5952584562249, -386.8062551005504, -163.10157051213432, -299.37893747356384, -571.5697244393053, -31.798394370078025, -1384.0039938163195, -894.4310368652366, -465.6553881322158, -368.92368589085186, -212.68653966107777, -542.5706912307502, -94.91161822422127, -913.1962502696862, -219.74949518684218, -540.5424183182762, -1082.447004227866, -1034.3326082825804, -305.61483705858, -1053.562633743651, -447.71048069577387, -1053.4472933273144, -338.95536359990695, -1041.8259628324165, -305.49780103812435, -319.2178757530341, -658.4565728654459, -389.41614363872037, -254.4447910219695, -151.37372972583213, -676.2279513319504, -113.61069203241858, -47.56577888989404, -395.96200725783206, -265.56194525258326, -570.1895946800872, -661.6350072085736, -1058.0804194252166, -797.9583447445466, -413.0246824846213, -1158.7538567775373, -184.68072898736023, -102.19389199071024, -873.8163825607753, -733.163815802786, -678.7137011477461, -712.9472574228824, -499.92395211776085, -887.9846165994039, -486.46869543889255, -285.3886004820819, -93.99504046637458, -25.51573756373483, -449.6155039403475, -274.9652194666647, -1261.9216156849332, -415.6362618658796, -324.97847899794453, -331.4615967561146, -363.4453955647228, -439.60930380711557, -182.5205577678944, -139.40508270972066, -242.27866656917868, -937.8106605917044, -225.99518717791628, -796.9512629097452, -305.5530591436057, -145.49429981675954, -652.5745043835838, -819.8129740301196, -228.18513796903318, -469.5090159296736, -486.08064382797863, -131.1668575592044, -992.726486263008, -757.7396547766712, -218.88623244515935, -828.1584542615257, -492.6215854127203, -720.0634260703675, -893.736787980035, -152.2845781692014, -47.10178160775741, -629.0808579992189, -228.867044445677, -1206.2056767879712, -890.6008268673573, -48.375558748426464, -1305.2600433296998, -92.51036434630487, -70.36402669616304, -294.93191617905603, -250.07448320491622, -457.96172492980287, -382.53651399165324, -247.14848593532258, -199.26992924771355, -95.25920957262139, -250.7095675330828, -232.0599374838097, -797.7668389757888, -389.6815758143381, -97.26456492129692, -1151.3914131828042, -745.854407030365, -396.44658179001897, -888.5210719113245, -133.6832954313939, -1440.06635456813, -720.1488674326671, -55.659192563340284, -560.831380758609, -772.1141525515042, -1312.4711971918528, -487.7173761031238, -136.23824441117003, -462.6930854699823, -800.3135999836692, -127.8976517151886, -1013.2101275791803, -434.9095487127062, -1019.2534413877169, -1308.2742089306607, -917.5083905709712, -1264.8580891033105, -473.4389969605554, -551.9215654435483, -634.5883661639982, -180.0921863402942, -942.3068821956832, -162.82037280939963, -328.6239327189495, -54.37966822910765, -970.0970396620637, -67.90084285832364, -1304.7027598754387, -82.96656212398533, -50.8035867714364, -233.13009141665603, -292.2322014692029, -247.66875097544585, -7.482187171738766, -414.31215415042357, -539.049689813576, -1088.2130642647662, -1216.3912955619053, -1035.605871061153, -1171.7710653682, -202.06208612933162, -295.66053255107323, -80.7045879869176, -1138.7825457846304, -383.7147828294277, -37.50006123465996, -102.23876456696628, -377.6017140595185, -116.24159374343662, -1315.6781665095318, -93.43914593500776, -60.059282705632995, -206.932085125934, -1116.5411257885373, -1457.9454295808025, -1225.5472840171055, -332.8770939922839, -428.77730589520917, -663.1785492709432, -400.89839409061574, -299.3337547164728, -817.0196317539725, -229.45248867789064, -36.24310636776859, -187.289482790968, -563.6014155142004, -526.0933333695484, -813.264599665521, -777.7497019801073, -68.70763212172885, -903.1744253833717, -22.49911460541354, -300.12544615571704, -412.2850128742641, -930.3017921837367, -267.715404695436, -474.330670790642, -674.1333871300828, -896.3027861339791, -300.545122003594, -20.248140112353035, -709.9575923665245, -847.4386459681758, -524.6341754918578, -228.5552435799682, -575.2977866518764, -764.5070640972241, -1039.9168372804438, -1073.0846453112995, -1433.0542724925083, -279.4715852663273, -596.7495169094834, -186.8508081210641, -917.5913551061524, -669.0103281712713, -330.3011926294541, -266.97379877943115, -1361.4836420513104, -170.41327969258833, -982.9908818626959, -735.7017664812415, -375.3472842645316, -141.76313076961458, -256.16827436349814, -1207.7577790272533, -37.15314280573999, -857.7416060858736, -1205.9685596031716, -604.9752432773328, -100.54265041582306, -94.84591177010375, -118.10967728393317, -272.3320203410714, -91.5533267236347, -552.0572783257411, -207.36531551793928, -945.2542051119152, -526.8738738137375, -1434.2698201920944, -48.824827477405385, -635.2238870510979, -6.576407866805617, -109.68228483108379, -102.31126587527025, -433.61396080581, -834.2315626622795, -600.7016881976655, -666.47545222957, -329.6873723195309, -1204.3211116043985, -544.4976604792307, -186.90731115556062]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4760745555047405, "mean_inference_ms": 1.6872487000389773, "mean_action_processing_ms": 0.7809903139873583, "mean_env_wait_ms": 9.857275524922017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01243901252746582, "StateBufferConnector_ms": 0.00937652587890625, "ViewRequirementAgentConnector_ms": 0.30833888053894043}, "num_episodes": 24, "episode_return_max": -375.41695529952835, "episode_return_min": -4944.803678705361, "episode_return_mean": -2435.4482015634553, "episodes_this_iter": 24}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1361706, "num_agent_steps_trained": 1361706, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 69.769631311898, "num_env_steps_trained_throughput_per_sec": 69.769631311898, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 1361706, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1361706, "timers": {"training_iteration_time_ms": 55256.18, "restore_workers_time_ms": 0.031, "training_step_time_ms": 55256.097, "sample_time_ms": 3250.478, "learn_time_ms": 51945.338, "learn_throughput": 77.004, "synch_weights_time_ms": 57.246}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1361706, "num_agent_steps_trained": 1361706}, "done": false, "training_iteration": 79, "trial_id": "efc54_00000", "date": "2024-07-24_19-51-29", "timestamp": 1721830889, "time_this_iter_s": 57.342217206954956, "time_total_s": 4285.789220571518, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x717514110e50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4285.789220571518, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 9.907407407407407, "ram_util_percent": 23.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 140.87975274141505, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.451949500659156, "policy_loss": 0.003120821523085907, "vf_loss": 4.468221005497786, "vf_explained_var": 0.9881321043879897, "kl": 0.01199223677672091, "entropy": 2.849893191314879, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.5952380952381, "num_grad_updates_lifetime": 322140.5, "diff_num_grad_updates_vs_sampler_policy": 1889.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1377783, "num_agent_steps_trained": 1377783}, "env_runners": {"episode_reward_max": -814.8012505513357, "episode_reward_min": -4944.803678705361, "episode_reward_mean": -2502.8808799570065, "episode_len_mean": 147.85, "episode_media": {}, "episodes_timesteps_total": 14785, "policy_reward_min": {"policy_0": -1457.9454295808025}, "policy_reward_max": {"policy_0": -6.576407866805617}, "policy_reward_mean": {"policy_0": -500.57617599140144}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4140.551537655596, -1616.4768838046396, -1773.09708387964, -2190.8450785566347, -1394.8790815873222, -3497.9065465422113, -2180.2629940087545, -3060.0195832390223, -2914.9445505247227, -827.299359071246, -2893.1404882415104, -1092.7507233399808, -859.2862084437033, -2915.0015605922217, -2676.1140350117485, -1625.271813403168, -1966.911629129171, -3394.3491200718017, -2361.0151813278862, -1532.9799413025387, -1614.2940620040638, -1649.0475589240634, -2396.4112932577123, -3314.189672241332, -2531.8682678615114, -1737.1819447489484, -2344.797153518234, -1452.6548818956337, -3325.700644365703, -2310.9704732297755, -3923.6675640084513, -3058.9442965507956, -2129.919188583919, -1392.8900181128165, -4089.452310640488, -2572.56852048938, -2872.7131220610245, -2106.0131171220564, -1875.1310369917765, -1728.0101548164141, -2720.386100283813, -2307.6681415488956, -3017.469352966443, -1951.0710502018899, -3542.9524700797588, -1455.8686650015914, -1024.4471297725502, -3181.958799924594, -3578.866171133538, -3188.793299168429, -2540.352709159192, -4944.803678705361, -2782.3479971040756, -1583.821856277845, -1963.8352016567194, -2296.725846375951, -3921.490850671659, -1742.940742402603, -1963.0199029531277, -4339.843018504663, -2609.207635727208, -1542.6798267203756, -2585.395473756142, -2384.7583266997954, -2601.1870277465327, -2940.4329157891034, -4422.276857260062, -2370.727482807375, -3625.936854352366, -2500.5839330519784, -2124.4420423503634, -2068.5621460203006, -2651.768816401142, -2080.540762372109, -2931.888907788292, -2282.1771947631037, -814.8012505513357, -2392.9704724497296, -1873.2398060680534, -1732.631227450302, -2131.935782636752, -2827.9147436934427, -1507.6259778754752, -3174.140988813553, -2809.880371958576, -3212.3390307565205, -4484.92225620861, -2997.6255627929418, -3066.3930744365302, -4258.823112359439, -2567.2536095999358, -2929.3189877793266, -1910.6284462793228, -2412.215867886355, -4135.99975347348, -2609.8679804337144, -3110.666266857077, -1689.1877673339727, -1194.6020893359998, -1332.3457000136787], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 92, 150, 135, 96, 150, 150, 150, 150, 150, 150, 145, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150], "policy_policy_0_reward": [-1261.4150428782907, -347.1107723833394, -1045.3295603168278, -1226.8733942050114, -259.8227678721279, -462.4350558153773, -162.90509303167477, -156.18507512359537, -62.33586696916752, -772.6157928648252, -41.49605231590236, -162.01399785523705, -756.6389308649041, -380.6043217735816, -432.34378107001413, -529.8352017367306, -161.98125980916137, -977.2000076569614, -445.33022860917015, -76.49838074461275, -920.4671736045242, -140.87381722458187, -56.613628372282236, -133.26075947648604, -143.66370290944633, -832.4063015846217, -44.788827758789616, -744.0966579491487, -944.3755866030957, -932.239172646556, -10.357054082803039, -146.46031695343942, -966.8892759797375, -814.643396976775, -241.91295001599994, -738.5358911298792, -542.5858559678267, -860.1296322405237, -430.06238263604104, -488.705821264749, -874.4851831834542, -231.23084386557665, -1095.1277503886392, -142.17769879978448, -571.9230742872701, -41.2752179576737, -126.94706646747758, -156.7886675678488, -131.41147291091949, -370.8769341673269, -992.9819976109377, -922.5291394874363, -371.5706889421922, -33.251769530301736, -572.8068926706427, -388.9402677850264, -91.17603617935617, -312.4702480567273, -31.837229694041703, -268.326941624829, -105.37312477033008, -140.27640207020096, -275.04149546940477, -101.66347800466889, -236.9317081290991, -1068.4179343623, -237.08262908542375, -867.4211570183604, -118.773967657521, -623.3058724686191, -803.8920801655439, -79.58670739092396, -774.9593822903418, -276.10194995853567, -741.5739152064049, -1205.7041970137996, -153.8394721817647, -84.69498894163289, -106.24969828745306, -74.78345697851742, -454.2996714524729, -748.783215849339, -62.7858309932877, -627.855496001689, -73.18741483238357, -818.4162773515001, -499.6703403671771, -464.60059547177127, -482.5971931070805, -1129.064713774273, -400.4366328879113, -117.33025795285869, -392.22354212368265, -476.33052769637777, -974.6942206670564, -637.698085770993, -262.760898589127, -46.76714086937617, -171.02165009091024, -414.7321659821324, -437.5906713631822, -72.79346209549188, -807.3882718873392, -60.478319859691794, -236.04333679835725, -201.23992150420483, -1117.8690918514285, -75.70069782668313, -223.9867469281745, -30.251100813572666, -775.9863501452204, -160.20492960107552, -184.3960796116611, -414.4549548588998, -861.3689790408554, -197.3246141260035, -1224.3799920527365, -1126.3872405409245, -37.885345674882686, -728.2124798467852, -754.4199600182974, -289.6395267736774, -866.0566803678395, -473.1292374221344, -148.62286327956417, -56.87680754128279, -492.23951497133623, -391.64452244408426, -366.19610976007726, -430.224990032168, -187.34918743665, -1010.67607328523, -372.2775087244828, -165.89912561564756, -608.5952584562249, -386.8062551005504, -163.10157051213432, -299.37893747356384, -571.5697244393053, -31.798394370078025, -1384.0039938163195, -894.4310368652366, -465.6553881322158, -368.92368589085186, -212.68653966107777, -542.5706912307502, -94.91161822422127, -913.1962502696862, -219.74949518684218, -540.5424183182762, -1082.447004227866, -1034.3326082825804, -305.61483705858, -1053.562633743651, -447.71048069577387, -1053.4472933273144, -338.95536359990695, -1041.8259628324165, -305.49780103812435, -319.2178757530341, -658.4565728654459, -389.41614363872037, -254.4447910219695, -151.37372972583213, -676.2279513319504, -113.61069203241858, -47.56577888989404, -395.96200725783206, -265.56194525258326, -570.1895946800872, -661.6350072085736, -1058.0804194252166, -797.9583447445466, -413.0246824846213, -1158.7538567775373, -184.68072898736023, -102.19389199071024, -873.8163825607753, -733.163815802786, -678.7137011477461, -712.9472574228824, -499.92395211776085, -887.9846165994039, -486.46869543889255, -285.3886004820819, -93.99504046637458, -25.51573756373483, -449.6155039403475, -274.9652194666647, -1261.9216156849332, -415.6362618658796, -324.97847899794453, -331.4615967561146, -363.4453955647228, -439.60930380711557, -182.5205577678944, -139.40508270972066, -242.27866656917868, -937.8106605917044, -225.99518717791628, -796.9512629097452, -305.5530591436057, -145.49429981675954, -652.5745043835838, -819.8129740301196, -228.18513796903318, -469.5090159296736, -486.08064382797863, -131.1668575592044, -992.726486263008, -757.7396547766712, -218.88623244515935, -828.1584542615257, -492.6215854127203, -720.0634260703675, -893.736787980035, -152.2845781692014, -47.10178160775741, -629.0808579992189, -228.867044445677, -1206.2056767879712, -890.6008268673573, -48.375558748426464, -1305.2600433296998, -92.51036434630487, -70.36402669616304, -294.93191617905603, -250.07448320491622, -457.96172492980287, -382.53651399165324, -247.14848593532258, -199.26992924771355, -95.25920957262139, -250.7095675330828, -232.0599374838097, -797.7668389757888, -389.6815758143381, -97.26456492129692, -1151.3914131828042, -745.854407030365, -396.44658179001897, -888.5210719113245, -133.6832954313939, -1440.06635456813, -720.1488674326671, -55.659192563340284, -560.831380758609, -772.1141525515042, -1312.4711971918528, -487.7173761031238, -136.23824441117003, -462.6930854699823, -800.3135999836692, -127.8976517151886, -1013.2101275791803, -434.9095487127062, -1019.2534413877169, -1308.2742089306607, -917.5083905709712, -1264.8580891033105, -473.4389969605554, -551.9215654435483, -634.5883661639982, -180.0921863402942, -942.3068821956832, -162.82037280939963, -328.6239327189495, -54.37966822910765, -970.0970396620637, -67.90084285832364, -1304.7027598754387, -82.96656212398533, -50.8035867714364, -233.13009141665603, -292.2322014692029, -247.66875097544585, -7.482187171738766, -414.31215415042357, -539.049689813576, -1088.2130642647662, -1216.3912955619053, -1035.605871061153, -1171.7710653682, -202.06208612933162, -295.66053255107323, -80.7045879869176, -1138.7825457846304, -383.7147828294277, -37.50006123465996, -102.23876456696628, -377.6017140595185, -116.24159374343662, -1315.6781665095318, -93.43914593500776, -60.059282705632995, -206.932085125934, -1116.5411257885373, -1457.9454295808025, -1225.5472840171055, -332.8770939922839, -428.77730589520917, -663.1785492709432, -400.89839409061574, -299.3337547164728, -817.0196317539725, -229.45248867789064, -36.24310636776859, -187.289482790968, -563.6014155142004, -526.0933333695484, -813.264599665521, -777.7497019801073, -68.70763212172885, -903.1744253833717, -22.49911460541354, -300.12544615571704, -412.2850128742641, -930.3017921837367, -267.715404695436, -474.330670790642, -674.1333871300828, -896.3027861339791, -300.545122003594, -20.248140112353035, -709.9575923665245, -847.4386459681758, -524.6341754918578, -228.5552435799682, -575.2977866518764, -764.5070640972241, -1039.9168372804438, -1073.0846453112995, -1433.0542724925083, -279.4715852663273, -596.7495169094834, -186.8508081210641, -917.5913551061524, -669.0103281712713, -330.3011926294541, -266.97379877943115, -1361.4836420513104, -170.41327969258833, -982.9908818626959, -735.7017664812415, -375.3472842645316, -141.76313076961458, -256.16827436349814, -1207.7577790272533, -37.15314280573999, -857.7416060858736, -1205.9685596031716, -604.9752432773328, -100.54265041582306, -94.84591177010375, -118.10967728393317, -272.3320203410714, -91.5533267236347, -552.0572783257411, -207.36531551793928, -945.2542051119152, -526.8738738137375, -1434.2698201920944, -48.824827477405385, -635.2238870510979, -6.576407866805617, -109.68228483108379, -102.31126587527025, -433.61396080581, -834.2315626622795, -600.7016881976655, -666.47545222957, -329.6873723195309, -1204.3211116043985, -544.4976604792307, -186.90731115556062, -68.07139614740366, -1082.1896147465793, -133.59886902333338, -425.97800874534715, -572.3393061004394, -121.05641695060135, -335.434752094734, -252.20380595249244, -96.11771192967434, -9.988563623833393, -891.351733529827, -264.4709893133566, -361.8629949240356, -767.7414162881556, -107.54333839435618, -604.6553570920539, -135.20795963811557, -844.8375830350357, -65.58822059758894, -222.95068570525848, -343.91392091323195, -124.05443697959254, -571.0129354715681, -657.412422589926, -36.2375114959823, -39.44997055623709, -32.300368257170774, -941.715374852945, -78.03324322046903, -1040.436825749929, -472.43962567252083, -1446.7062160861828, -342.82510958183934, -311.70348711576213, -254.2403052371367, -460.13018607716987, -549.8783997464463, -377.14492153514584, -107.98007012691757, -12.492400389796597, -785.1016125086967, -205.50189858696203, -545.2219296831809, -1099.8957657778176, -538.4197822568954, -33.429076336384355, -1406.1161110563328, -421.74595882030866, -433.87719120319946, -514.7120345423515, -1284.5851304717887, -501.99490761598173, -92.90353082064226, -941.8180519989389, -391.03740984916857, -944.8269984894116, -1322.941009029781, -589.65655325363, -1258.5082660209716, -368.98942941481397, -963.7826167780962, -132.00658623140393, -729.3747221422134, -179.72724405229658, -992.7343935889326, -625.6872285052976, -32.57389150673061, -884.5258303012135, -557.7932502069357, -965.8128739163524, -1033.6319487902988, -1166.3916255727497, -828.7924565336048, -224.90582998490396, -1005.1012514778839, -30.004283842927723, -903.8284628899839, -1096.198704761081, -225.3467129966077, -311.87544510933793, -922.9611366690968, -794.9646411775553, -298.8438824732797, -725.4420871169106, -187.10724034248352, -293.3844349686531, -774.8735328421863, -71.9324453841953, -703.1468340277753, -67.29119905651199, -80.10571953431327, -179.598023469741, -159.96535298366544, -1212.0833717640849, -780.4634001345491, -1280.2612230276457, -1034.5409726848077, -305.39605139224733, -456.6659542040194, -1059.1355521647579, -326.0481656217054, -590.6895798802951, -874.3412865011018, -633.2126429949294, -185.57630543568206, -861.8679988745572, -188.2946661552291, -1119.057663715411, -796.1061278073213, -145.3398103045585, -474.05367654939045, -376.5547215499805, -568.1833076845617, -83.93896777103471, -186.45709377900684, -194.48652544244374, -268.8259719005494, -13.431369565620264, -459.82271217074486, -258.03551025664024, -48.753526665768796, -712.7584037316609, -42.53437697862278, -37.383149027627574, -490.9162436100001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4761813389913485, "mean_inference_ms": 1.6876449894972145, "mean_action_processing_ms": 0.7804978307766564, "mean_env_wait_ms": 9.857526749358655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012604236602783203, "StateBufferConnector_ms": 0.00946950912475586, "ViewRequirementAgentConnector_ms": 0.31496334075927734}, "num_episodes": 25, "episode_return_max": -814.8012505513357, "episode_return_min": -4944.803678705361, "episode_return_mean": -2502.8808799570065, "episodes_this_iter": 25}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1377783, "num_agent_steps_trained": 1377783, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.34917548716916, "num_env_steps_trained_throughput_per_sec": 77.34917548716916, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 1377783, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1377783, "timers": {"training_iteration_time_ms": 55221.275, "restore_workers_time_ms": 0.03, "training_step_time_ms": 55221.194, "sample_time_ms": 3238.75, "learn_time_ms": 51921.53, "learn_throughput": 77.039, "synch_weights_time_ms": 57.931}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1377783, "num_agent_steps_trained": 1377783}, "done": false, "training_iteration": 80, "trial_id": "efc54_00000", "date": "2024-07-24_19-52-21", "timestamp": 1721830941, "time_this_iter_s": 51.72420358657837, "time_total_s": 4337.513424158096, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d71ed40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4337.513424158096, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 9.916216216216213, "ram_util_percent": 23.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 115.05941628942303, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.689839566338296, "policy_loss": -0.0012726174640085768, "vf_loss": 4.710465707440003, "vf_explained_var": 0.9822175307162836, "kl": 0.011493382516232041, "entropy": 2.808131527199465, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.375, "num_grad_updates_lifetime": 326070.5, "diff_num_grad_updates_vs_sampler_policy": 2039.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1395106, "num_agent_steps_trained": 1395106}, "env_runners": {"episode_reward_max": -814.8012505513357, "episode_reward_min": -4944.803678705361, "episode_reward_mean": -2565.390842579549, "episode_len_mean": 148.53, "episode_media": {}, "episodes_timesteps_total": 14853, "policy_reward_min": {"policy_0": -1574.7239216807855}, "policy_reward_max": {"policy_0": 3.510203108305724}, "policy_reward_mean": {"policy_0": -513.0781685159099}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3058.9442965507956, -2129.919188583919, -1392.8900181128165, -4089.452310640488, -2572.56852048938, -2872.7131220610245, -2106.0131171220564, -1875.1310369917765, -1728.0101548164141, -2720.386100283813, -2307.6681415488956, -3017.469352966443, -1951.0710502018899, -3542.9524700797588, -1455.8686650015914, -1024.4471297725502, -3181.958799924594, -3578.866171133538, -3188.793299168429, -2540.352709159192, -4944.803678705361, -2782.3479971040756, -1583.821856277845, -1963.8352016567194, -2296.725846375951, -3921.490850671659, -1742.940742402603, -1963.0199029531277, -4339.843018504663, -2609.207635727208, -1542.6798267203756, -2585.395473756142, -2384.7583266997954, -2601.1870277465327, -2940.4329157891034, -4422.276857260062, -2370.727482807375, -3625.936854352366, -2500.5839330519784, -2124.4420423503634, -2068.5621460203006, -2651.768816401142, -2080.540762372109, -2931.888907788292, -2282.1771947631037, -814.8012505513357, -2392.9704724497296, -1873.2398060680534, -1732.631227450302, -2131.935782636752, -2827.9147436934427, -1507.6259778754752, -3174.140988813553, -2809.880371958576, -3212.3390307565205, -4484.92225620861, -2997.6255627929418, -3066.3930744365302, -4258.823112359439, -2567.2536095999358, -2929.3189877793266, -1910.6284462793228, -2412.215867886355, -4135.99975347348, -2609.8679804337144, -3110.666266857077, -1689.1877673339727, -1194.6020893359998, -1332.3457000136787, -3604.818603554819, -1728.8508225338367, -1273.6371197198594, -2328.953938020528, -1867.4188564120518, -3483.0120650501926, -2354.078874455923, -2890.2932788299113, -3671.840902083128, -2646.5526505968774, -2624.6846517971703, -2403.2593525261905, -2441.275418283102, -2122.282955961397, -2450.6455642366845, -1012.6004961024336, -2234.797749035861, -4590.09048112731, -4055.3096471079652, -3714.07010720261, -2853.7162006747303, -2682.5908465583384, -1577.7648904781674, -1918.4488568578818, -1018.3056812596343, -1670.0822353145793, -2029.6414598652007, -2879.3013590295823, -3388.299543470655, -1838.3314826423525, -2409.9270872541774], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1053.4472933273144, -338.95536359990695, -1041.8259628324165, -305.49780103812435, -319.2178757530341, -658.4565728654459, -389.41614363872037, -254.4447910219695, -151.37372972583213, -676.2279513319504, -113.61069203241858, -47.56577888989404, -395.96200725783206, -265.56194525258326, -570.1895946800872, -661.6350072085736, -1058.0804194252166, -797.9583447445466, -413.0246824846213, -1158.7538567775373, -184.68072898736023, -102.19389199071024, -873.8163825607753, -733.163815802786, -678.7137011477461, -712.9472574228824, -499.92395211776085, -887.9846165994039, -486.46869543889255, -285.3886004820819, -93.99504046637458, -25.51573756373483, -449.6155039403475, -274.9652194666647, -1261.9216156849332, -415.6362618658796, -324.97847899794453, -331.4615967561146, -363.4453955647228, -439.60930380711557, -182.5205577678944, -139.40508270972066, -242.27866656917868, -937.8106605917044, -225.99518717791628, -796.9512629097452, -305.5530591436057, -145.49429981675954, -652.5745043835838, -819.8129740301196, -228.18513796903318, -469.5090159296736, -486.08064382797863, -131.1668575592044, -992.726486263008, -757.7396547766712, -218.88623244515935, -828.1584542615257, -492.6215854127203, -720.0634260703675, -893.736787980035, -152.2845781692014, -47.10178160775741, -629.0808579992189, -228.867044445677, -1206.2056767879712, -890.6008268673573, -48.375558748426464, -1305.2600433296998, -92.51036434630487, -70.36402669616304, -294.93191617905603, -250.07448320491622, -457.96172492980287, -382.53651399165324, -247.14848593532258, -199.26992924771355, -95.25920957262139, -250.7095675330828, -232.0599374838097, -797.7668389757888, -389.6815758143381, -97.26456492129692, -1151.3914131828042, -745.854407030365, -396.44658179001897, -888.5210719113245, -133.6832954313939, -1440.06635456813, -720.1488674326671, -55.659192563340284, -560.831380758609, -772.1141525515042, -1312.4711971918528, -487.7173761031238, -136.23824441117003, -462.6930854699823, -800.3135999836692, -127.8976517151886, -1013.2101275791803, -434.9095487127062, -1019.2534413877169, -1308.2742089306607, -917.5083905709712, -1264.8580891033105, -473.4389969605554, -551.9215654435483, -634.5883661639982, -180.0921863402942, -942.3068821956832, -162.82037280939963, -328.6239327189495, -54.37966822910765, -970.0970396620637, -67.90084285832364, -1304.7027598754387, -82.96656212398533, -50.8035867714364, -233.13009141665603, -292.2322014692029, -247.66875097544585, -7.482187171738766, -414.31215415042357, -539.049689813576, -1088.2130642647662, -1216.3912955619053, -1035.605871061153, -1171.7710653682, -202.06208612933162, -295.66053255107323, -80.7045879869176, -1138.7825457846304, -383.7147828294277, -37.50006123465996, -102.23876456696628, -377.6017140595185, -116.24159374343662, -1315.6781665095318, -93.43914593500776, -60.059282705632995, -206.932085125934, -1116.5411257885373, -1457.9454295808025, -1225.5472840171055, -332.8770939922839, -428.77730589520917, -663.1785492709432, -400.89839409061574, -299.3337547164728, -817.0196317539725, -229.45248867789064, -36.24310636776859, -187.289482790968, -563.6014155142004, -526.0933333695484, -813.264599665521, -777.7497019801073, -68.70763212172885, -903.1744253833717, -22.49911460541354, -300.12544615571704, -412.2850128742641, -930.3017921837367, -267.715404695436, -474.330670790642, -674.1333871300828, -896.3027861339791, -300.545122003594, -20.248140112353035, -709.9575923665245, -847.4386459681758, -524.6341754918578, -228.5552435799682, -575.2977866518764, -764.5070640972241, -1039.9168372804438, -1073.0846453112995, -1433.0542724925083, -279.4715852663273, -596.7495169094834, -186.8508081210641, -917.5913551061524, -669.0103281712713, -330.3011926294541, -266.97379877943115, -1361.4836420513104, -170.41327969258833, -982.9908818626959, -735.7017664812415, -375.3472842645316, -141.76313076961458, -256.16827436349814, -1207.7577790272533, -37.15314280573999, -857.7416060858736, -1205.9685596031716, -604.9752432773328, -100.54265041582306, -94.84591177010375, -118.10967728393317, -272.3320203410714, -91.5533267236347, -552.0572783257411, -207.36531551793928, -945.2542051119152, -526.8738738137375, -1434.2698201920944, -48.824827477405385, -635.2238870510979, -6.576407866805617, -109.68228483108379, -102.31126587527025, -433.61396080581, -834.2315626622795, -600.7016881976655, -666.47545222957, -329.6873723195309, -1204.3211116043985, -544.4976604792307, -186.90731115556062, -68.07139614740366, -1082.1896147465793, -133.59886902333338, -425.97800874534715, -572.3393061004394, -121.05641695060135, -335.434752094734, -252.20380595249244, -96.11771192967434, -9.988563623833393, -891.351733529827, -264.4709893133566, -361.8629949240356, -767.7414162881556, -107.54333839435618, -604.6553570920539, -135.20795963811557, -844.8375830350357, -65.58822059758894, -222.95068570525848, -343.91392091323195, -124.05443697959254, -571.0129354715681, -657.412422589926, -36.2375114959823, -39.44997055623709, -32.300368257170774, -941.715374852945, -78.03324322046903, -1040.436825749929, -472.43962567252083, -1446.7062160861828, -342.82510958183934, -311.70348711576213, -254.2403052371367, -460.13018607716987, -549.8783997464463, -377.14492153514584, -107.98007012691757, -12.492400389796597, -785.1016125086967, -205.50189858696203, -545.2219296831809, -1099.8957657778176, -538.4197822568954, -33.429076336384355, -1406.1161110563328, -421.74595882030866, -433.87719120319946, -514.7120345423515, -1284.5851304717887, -501.99490761598173, -92.90353082064226, -941.8180519989389, -391.03740984916857, -944.8269984894116, -1322.941009029781, -589.65655325363, -1258.5082660209716, -368.98942941481397, -963.7826167780962, -132.00658623140393, -729.3747221422134, -179.72724405229658, -992.7343935889326, -625.6872285052976, -32.57389150673061, -884.5258303012135, -557.7932502069357, -965.8128739163524, -1033.6319487902988, -1166.3916255727497, -828.7924565336048, -224.90582998490396, -1005.1012514778839, -30.004283842927723, -903.8284628899839, -1096.198704761081, -225.3467129966077, -311.87544510933793, -922.9611366690968, -794.9646411775553, -298.8438824732797, -725.4420871169106, -187.10724034248352, -293.3844349686531, -774.8735328421863, -71.9324453841953, -703.1468340277753, -67.29119905651199, -80.10571953431327, -179.598023469741, -159.96535298366544, -1212.0833717640849, -780.4634001345491, -1280.2612230276457, -1034.5409726848077, -305.39605139224733, -456.6659542040194, -1059.1355521647579, -326.0481656217054, -590.6895798802951, -874.3412865011018, -633.2126429949294, -185.57630543568206, -861.8679988745572, -188.2946661552291, -1119.057663715411, -796.1061278073213, -145.3398103045585, -474.05367654939045, -376.5547215499805, -568.1833076845617, -83.93896777103471, -186.45709377900684, -194.48652544244374, -268.8259719005494, -13.431369565620264, -459.82271217074486, -258.03551025664024, -48.753526665768796, -712.7584037316609, -42.53437697862278, -37.383149027627574, -490.9162436100001, -1574.7239216807855, -1390.9626114852074, -101.38386375159021, -188.3811474400431, -349.3670591971919, -208.82278654946944, -94.75357674784664, -1218.639849291795, -79.98495149577367, -126.64965844895355, -92.72023950473378, -189.84677820682575, -378.2843034764244, -274.87501764490645, -337.91078088696975, -162.3844714023528, -775.4428581882826, -651.9975356903889, -515.8355430550583, -223.29352968444562, -380.6160445619027, -326.92124431628037, -996.9872353073862, -46.02326313232518, -116.87106909415708, -410.43245278489604, -648.644571281769, -576.7252320177048, -633.0381219261349, -1214.171687039685, -35.324937194888356, -1141.0958657711774, -128.46808531159564, -536.5277309950526, -512.6622551832115, -947.0384364385088, -850.3114002898509, -277.79325830273945, -708.0226547007939, -107.12752909801604, -279.9304008605692, -1036.6986929277057, -740.8866261504293, -1181.4802830046708, -432.84489913975216, -270.19425020417367, -299.9844054026628, -972.5866216299779, -897.1069441592635, -206.68042920079944, -151.1103038256126, -44.23083659866743, -762.7664422292672, -608.859465373825, -1057.717603769798, -0.6495419078739746, -1542.1934760717174, -96.36420728316993, -551.5705328778837, -212.48159438554504, -22.036682038524415, -573.529985432009, -1358.5154364987288, -200.28656405339316, -286.90675026044545, 3.510203108305724, -527.3750712558069, -711.7256778220917, -424.1472566214258, -462.5451533703805, -1023.1418295481651, -185.6981627302971, -6.944301364244288, -808.1494253830621, -426.711845210916, -138.9206387883376, -511.69101789685556, -135.4119989226588, -71.01820482628283, -155.5586356682976, -862.8815798370492, -85.80143099414659, -219.82256445010438, -884.1838585854406, -182.10831516912032, -1244.1466841812019, -822.2911539402961, -1434.9046160458224, -113.34124193453754, -975.406785025451, -1361.6054438901133, -395.27592731507013, -503.377251034744, -1113.328959273925, -681.7220655941146, -686.276556534648, -178.4591152702836, -1294.7691805507525, -287.44953827797127, -1267.1157165689526, -33.303920445680546, -732.4022729065719, -1114.541074001545, -327.6430412807505, -645.8258920401853, -1288.2802883390918, -122.12137619179, -18.625635729873782, -902.0313984625127, -351.53214783506843, -595.6671000524195, -122.78745499712815, -318.15706540205656, -467.7019052920054, -73.45136473455635, -247.28799956782595, -796.8700454421817, -711.6868522011357, -44.78118974683949, -117.82276989989832, -306.7977793204706, -60.25312245189315, -288.14031311494364, -314.7762779567043, -48.338188415622824, -55.19101322214748, -174.96261782405472, -307.64484221423874, -1045.522556376758, -86.76120567737885, -100.74457409179591, -108.38549916075638, -668.0754455500387, -363.4632596640567, -788.9726813985516, -848.9620395451941, -588.0387476313418, -333.40214560395543, -851.7855010100685, -257.11292523902216, -250.2421418267783, -939.1271394028945, -918.351242431056, -797.4274890437014, -483.15153076622283, -65.36448852476211, -1098.194190153525, -485.2429954749185, -186.50371055158803, -3.0260979375580623, -1102.9576862936512, -685.5204331280363, -132.2489820399298, -437.97982292550427, -51.22016286705549]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.475443910439302, "mean_inference_ms": 1.6877476712090955, "mean_action_processing_ms": 0.7793543912403108, "mean_env_wait_ms": 9.85838803839503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012770652770996094, "StateBufferConnector_ms": 0.009426593780517578, "ViewRequirementAgentConnector_ms": 0.31358885765075684}, "num_episodes": 31, "episode_return_max": -814.8012505513357, "episode_return_min": -4944.803678705361, "episode_return_mean": -2565.390842579549, "episodes_this_iter": 31}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1395106, "num_agent_steps_trained": 1395106, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 70.57346234143664, "num_env_steps_trained_throughput_per_sec": 70.57346234143664, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 1395106, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1395106, "timers": {"training_iteration_time_ms": 55495.807, "restore_workers_time_ms": 0.03, "training_step_time_ms": 55495.727, "sample_time_ms": 3257.171, "learn_time_ms": 52177.288, "learn_throughput": 76.662, "synch_weights_time_ms": 58.269}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1395106, "num_agent_steps_trained": 1395106}, "done": false, "training_iteration": 81, "trial_id": "efc54_00000", "date": "2024-07-24_19-53-18", "timestamp": 1721830998, "time_this_iter_s": 56.69017457962036, "time_total_s": 4394.203598737717, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x717514111c60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4394.203598737717, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 9.63375, "ram_util_percent": 23.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 127.86623418033123, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.3924390764907, "policy_loss": -0.000757389771782376, "vf_loss": 4.413926907007893, "vf_explained_var": 0.9847712244372815, "kl": 0.011348358228315193, "entropy": 2.934810166123013, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.9453125, "num_grad_updates_lifetime": 330030.5, "diff_num_grad_updates_vs_sampler_policy": 1919.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1411483, "num_agent_steps_trained": 1411483}, "env_runners": {"episode_reward_max": -814.8012505513357, "episode_reward_min": -4590.09048112731, "episode_reward_mean": -2513.209824270294, "episode_len_mean": 148.72, "episode_media": {}, "episodes_timesteps_total": 14872, "policy_reward_min": {"policy_0": -1574.7239216807855}, "policy_reward_max": {"policy_0": 3.510203108305724}, "policy_reward_mean": {"policy_0": -502.6419648540588}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3921.490850671659, -1742.940742402603, -1963.0199029531277, -4339.843018504663, -2609.207635727208, -1542.6798267203756, -2585.395473756142, -2384.7583266997954, -2601.1870277465327, -2940.4329157891034, -4422.276857260062, -2370.727482807375, -3625.936854352366, -2500.5839330519784, -2124.4420423503634, -2068.5621460203006, -2651.768816401142, -2080.540762372109, -2931.888907788292, -2282.1771947631037, -814.8012505513357, -2392.9704724497296, -1873.2398060680534, -1732.631227450302, -2131.935782636752, -2827.9147436934427, -1507.6259778754752, -3174.140988813553, -2809.880371958576, -3212.3390307565205, -4484.92225620861, -2997.6255627929418, -3066.3930744365302, -4258.823112359439, -2567.2536095999358, -2929.3189877793266, -1910.6284462793228, -2412.215867886355, -4135.99975347348, -2609.8679804337144, -3110.666266857077, -1689.1877673339727, -1194.6020893359998, -1332.3457000136787, -3604.818603554819, -1728.8508225338367, -1273.6371197198594, -2328.953938020528, -1867.4188564120518, -3483.0120650501926, -2354.078874455923, -2890.2932788299113, -3671.840902083128, -2646.5526505968774, -2624.6846517971703, -2403.2593525261905, -2441.275418283102, -2122.282955961397, -2450.6455642366845, -1012.6004961024336, -2234.797749035861, -4590.09048112731, -4055.3096471079652, -3714.07010720261, -2853.7162006747303, -2682.5908465583384, -1577.7648904781674, -1918.4488568578818, -1018.3056812596343, -1670.0822353145793, -2029.6414598652007, -2879.3013590295823, -3388.299543470655, -1838.3314826423525, -2409.9270872541774, -1641.365706841637, -2167.1319083572153, -1682.8184836946384, -2049.034924150044, -2660.877687242165, -1914.9082190997392, -4104.237479191829, -2933.371036280686, -2348.0238975681555, -1801.9251774655027, -1686.9519611389794, -2426.1118980423444, -2447.7482260006236, -1900.128260499186, -3711.348041537995, -3509.2067548083373, -2186.8458986851883, -1358.8390555775893, -2481.4633532791067, -3534.580585523629, -1103.2425498472505, -1021.5327220827181, -4207.0839854825335, -2347.4167026021682, -1462.7138888045563], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 150, 150], "policy_policy_0_reward": [-1216.3912955619053, -1035.605871061153, -1171.7710653682, -202.06208612933162, -295.66053255107323, -80.7045879869176, -1138.7825457846304, -383.7147828294277, -37.50006123465996, -102.23876456696628, -377.6017140595185, -116.24159374343662, -1315.6781665095318, -93.43914593500776, -60.059282705632995, -206.932085125934, -1116.5411257885373, -1457.9454295808025, -1225.5472840171055, -332.8770939922839, -428.77730589520917, -663.1785492709432, -400.89839409061574, -299.3337547164728, -817.0196317539725, -229.45248867789064, -36.24310636776859, -187.289482790968, -563.6014155142004, -526.0933333695484, -813.264599665521, -777.7497019801073, -68.70763212172885, -903.1744253833717, -22.49911460541354, -300.12544615571704, -412.2850128742641, -930.3017921837367, -267.715404695436, -474.330670790642, -674.1333871300828, -896.3027861339791, -300.545122003594, -20.248140112353035, -709.9575923665245, -847.4386459681758, -524.6341754918578, -228.5552435799682, -575.2977866518764, -764.5070640972241, -1039.9168372804438, -1073.0846453112995, -1433.0542724925083, -279.4715852663273, -596.7495169094834, -186.8508081210641, -917.5913551061524, -669.0103281712713, -330.3011926294541, -266.97379877943115, -1361.4836420513104, -170.41327969258833, -982.9908818626959, -735.7017664812415, -375.3472842645316, -141.76313076961458, -256.16827436349814, -1207.7577790272533, -37.15314280573999, -857.7416060858736, -1205.9685596031716, -604.9752432773328, -100.54265041582306, -94.84591177010375, -118.10967728393317, -272.3320203410714, -91.5533267236347, -552.0572783257411, -207.36531551793928, -945.2542051119152, -526.8738738137375, -1434.2698201920944, -48.824827477405385, -635.2238870510979, -6.576407866805617, -109.68228483108379, -102.31126587527025, -433.61396080581, -834.2315626622795, -600.7016881976655, -666.47545222957, -329.6873723195309, -1204.3211116043985, -544.4976604792307, -186.90731115556062, -68.07139614740366, -1082.1896147465793, -133.59886902333338, -425.97800874534715, -572.3393061004394, -121.05641695060135, -335.434752094734, -252.20380595249244, -96.11771192967434, -9.988563623833393, -891.351733529827, -264.4709893133566, -361.8629949240356, -767.7414162881556, -107.54333839435618, -604.6553570920539, -135.20795963811557, -844.8375830350357, -65.58822059758894, -222.95068570525848, -343.91392091323195, -124.05443697959254, -571.0129354715681, -657.412422589926, -36.2375114959823, -39.44997055623709, -32.300368257170774, -941.715374852945, -78.03324322046903, -1040.436825749929, -472.43962567252083, -1446.7062160861828, -342.82510958183934, -311.70348711576213, -254.2403052371367, -460.13018607716987, -549.8783997464463, -377.14492153514584, -107.98007012691757, -12.492400389796597, -785.1016125086967, -205.50189858696203, -545.2219296831809, -1099.8957657778176, -538.4197822568954, -33.429076336384355, -1406.1161110563328, -421.74595882030866, -433.87719120319946, -514.7120345423515, -1284.5851304717887, -501.99490761598173, -92.90353082064226, -941.8180519989389, -391.03740984916857, -944.8269984894116, -1322.941009029781, -589.65655325363, -1258.5082660209716, -368.98942941481397, -963.7826167780962, -132.00658623140393, -729.3747221422134, -179.72724405229658, -992.7343935889326, -625.6872285052976, -32.57389150673061, -884.5258303012135, -557.7932502069357, -965.8128739163524, -1033.6319487902988, -1166.3916255727497, -828.7924565336048, -224.90582998490396, -1005.1012514778839, -30.004283842927723, -903.8284628899839, -1096.198704761081, -225.3467129966077, -311.87544510933793, -922.9611366690968, -794.9646411775553, -298.8438824732797, -725.4420871169106, -187.10724034248352, -293.3844349686531, -774.8735328421863, -71.9324453841953, -703.1468340277753, -67.29119905651199, -80.10571953431327, -179.598023469741, -159.96535298366544, -1212.0833717640849, -780.4634001345491, -1280.2612230276457, -1034.5409726848077, -305.39605139224733, -456.6659542040194, -1059.1355521647579, -326.0481656217054, -590.6895798802951, -874.3412865011018, -633.2126429949294, -185.57630543568206, -861.8679988745572, -188.2946661552291, -1119.057663715411, -796.1061278073213, -145.3398103045585, -474.05367654939045, -376.5547215499805, -568.1833076845617, -83.93896777103471, -186.45709377900684, -194.48652544244374, -268.8259719005494, -13.431369565620264, -459.82271217074486, -258.03551025664024, -48.753526665768796, -712.7584037316609, -42.53437697862278, -37.383149027627574, -490.9162436100001, -1574.7239216807855, -1390.9626114852074, -101.38386375159021, -188.3811474400431, -349.3670591971919, -208.82278654946944, -94.75357674784664, -1218.639849291795, -79.98495149577367, -126.64965844895355, -92.72023950473378, -189.84677820682575, -378.2843034764244, -274.87501764490645, -337.91078088696975, -162.3844714023528, -775.4428581882826, -651.9975356903889, -515.8355430550583, -223.29352968444562, -380.6160445619027, -326.92124431628037, -996.9872353073862, -46.02326313232518, -116.87106909415708, -410.43245278489604, -648.644571281769, -576.7252320177048, -633.0381219261349, -1214.171687039685, -35.324937194888356, -1141.0958657711774, -128.46808531159564, -536.5277309950526, -512.6622551832115, -947.0384364385088, -850.3114002898509, -277.79325830273945, -708.0226547007939, -107.12752909801604, -279.9304008605692, -1036.6986929277057, -740.8866261504293, -1181.4802830046708, -432.84489913975216, -270.19425020417367, -299.9844054026628, -972.5866216299779, -897.1069441592635, -206.68042920079944, -151.1103038256126, -44.23083659866743, -762.7664422292672, -608.859465373825, -1057.717603769798, -0.6495419078739746, -1542.1934760717174, -96.36420728316993, -551.5705328778837, -212.48159438554504, -22.036682038524415, -573.529985432009, -1358.5154364987288, -200.28656405339316, -286.90675026044545, 3.510203108305724, -527.3750712558069, -711.7256778220917, -424.1472566214258, -462.5451533703805, -1023.1418295481651, -185.6981627302971, -6.944301364244288, -808.1494253830621, -426.711845210916, -138.9206387883376, -511.69101789685556, -135.4119989226588, -71.01820482628283, -155.5586356682976, -862.8815798370492, -85.80143099414659, -219.82256445010438, -884.1838585854406, -182.10831516912032, -1244.1466841812019, -822.2911539402961, -1434.9046160458224, -113.34124193453754, -975.406785025451, -1361.6054438901133, -395.27592731507013, -503.377251034744, -1113.328959273925, -681.7220655941146, -686.276556534648, -178.4591152702836, -1294.7691805507525, -287.44953827797127, -1267.1157165689526, -33.303920445680546, -732.4022729065719, -1114.541074001545, -327.6430412807505, -645.8258920401853, -1288.2802883390918, -122.12137619179, -18.625635729873782, -902.0313984625127, -351.53214783506843, -595.6671000524195, -122.78745499712815, -318.15706540205656, -467.7019052920054, -73.45136473455635, -247.28799956782595, -796.8700454421817, -711.6868522011357, -44.78118974683949, -117.82276989989832, -306.7977793204706, -60.25312245189315, -288.14031311494364, -314.7762779567043, -48.338188415622824, -55.19101322214748, -174.96261782405472, -307.64484221423874, -1045.522556376758, -86.76120567737885, -100.74457409179591, -108.38549916075638, -668.0754455500387, -363.4632596640567, -788.9726813985516, -848.9620395451941, -588.0387476313418, -333.40214560395543, -851.7855010100685, -257.11292523902216, -250.2421418267783, -939.1271394028945, -918.351242431056, -797.4274890437014, -483.15153076622283, -65.36448852476211, -1098.194190153525, -485.2429954749185, -186.50371055158803, -3.0260979375580623, -1102.9576862936512, -685.5204331280363, -132.2489820399298, -437.97982292550427, -51.22016286705549, -1111.3882878733316, -37.7461389232115, -83.99230157853535, -312.67379985361316, -95.56517861294589, -800.8093397101289, -919.4937609998157, -277.1023337025596, -115.1352531760952, -54.591220768614484, -156.86643571083331, -94.88488849780146, -317.1870537645393, -44.821384772254795, -1069.058720949211, -247.27694016514138, -102.28719588292424, -663.0635361891074, -108.78353735368236, -927.6237145591879, -182.11534404617151, -67.55535721414816, -1292.6039150120175, -1021.2526960964781, -97.35037487335059, -407.4618633941655, -42.441715225997626, -663.270773517314, -62.17972805706856, -739.5541389051918, -630.0008997230464, -1158.7914542867932, -260.0720389427205, -979.2268791729538, -1076.146207066313, -1153.1350027405078, -389.49155170043304, -70.78762072139111, -384.63907657698326, -935.3177845413718, -115.79365809036474, -256.81212891355483, -331.4610164166546, -666.5486764317164, -977.4084177158668, -374.43110854100723, -1141.9731021396879, -134.5308209798638, -66.22832538897357, -84.76182041596854, -701.8157874650151, -600.4352298305189, -49.10018868846035, -11.551263833406722, -324.04949132157867, -90.14820756867803, -417.130416785253, -614.9129760183542, -1147.1159544620782, -156.80434320798187, -253.4634340903571, -400.24760183082327, -1310.9844240629607, -356.18376467248044, -126.86900134400429, -156.36707366680608, -132.36458475606216, -84.8498125025869, -1036.1796869049529, -490.36710266877816, -504.4705574085491, -903.5959790042023, -1172.9512281139353, -1045.533655907839, -84.79662110346769, -314.12441207019265, -833.4227706501065, -1011.1958206724969, -1094.2465093663543, -256.2172420491864, -26.444736374580263, -1363.0778232398698, -705.5671200906709, -8.361594923062349, -83.39462405700382, -129.50598013614098, -461.46031244616506, -237.23558659783052, -438.36876959093235, -92.26840680652097, -587.7936072401674, -320.8338145542519, -108.18769244873339, -761.8107140098755, -702.8375250260772, -1031.4273754353815, -243.60480621005098, -815.5012192212541, -1121.2593867455491, -322.7877979113946, -415.9732227469937, -271.2110625974146, -23.280509815903432, -303.83041136959014, -88.94734331734972, -50.018530434322386, -401.2265935408685, -481.17269591749, -12.940499837424907, -76.17440235261148, -967.5581739205553, -410.04149441040073, -1339.866646740631, -354.74559464097933, -1134.8720757699657, -74.81655005483698, -134.89651983974724, -763.5547748402107, -1347.0541073430331, -27.09475052433832, -780.7344815869371, -142.6711949290195, -231.69363253455126, -28.75328379665841, -278.86129595738936]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.473052475448451, "mean_inference_ms": 1.6860763491989825, "mean_action_processing_ms": 0.778891187536556, "mean_env_wait_ms": 9.842514649170415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012826681137084961, "StateBufferConnector_ms": 0.009268999099731445, "ViewRequirementAgentConnector_ms": 0.30544137954711914}, "num_episodes": 25, "episode_return_max": -814.8012505513357, "episode_return_min": -4590.09048112731, "episode_return_mean": -2513.209824270294, "episodes_this_iter": 25}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1411483, "num_agent_steps_trained": 1411483, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 75.1523075593652, "num_env_steps_trained_throughput_per_sec": 75.1523075593652, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 1411483, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1411483, "timers": {"training_iteration_time_ms": 54986.674, "restore_workers_time_ms": 0.03, "training_step_time_ms": 54986.594, "sample_time_ms": 3238.228, "learn_time_ms": 51689.203, "learn_throughput": 77.386, "synch_weights_time_ms": 56.27}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1411483, "num_agent_steps_trained": 1411483}, "done": false, "training_iteration": 82, "trial_id": "efc54_00000", "date": "2024-07-24_19-54-11", "timestamp": 1721831051, "time_this_iter_s": 53.236252546310425, "time_total_s": 4447.439851284027, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x717514111510>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4447.439851284027, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 9.886842105263158, "ram_util_percent": 23.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 130.86949655049642, "cur_kl_coeff": 0.7593750000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.294081825892131, "policy_loss": -0.0014880985154459873, "vf_loss": 4.31502388381958, "vf_explained_var": 0.9854972227414449, "kl": 0.013434781626115243, "entropy": 2.9655998390833536, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.792, "num_grad_updates_lifetime": 333825.5, "diff_num_grad_updates_vs_sampler_policy": 1874.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1427457, "num_agent_steps_trained": 1427457}, "env_runners": {"episode_reward_max": -1012.6004961024336, "episode_reward_min": -4590.09048112731, "episode_reward_mean": -2526.857091653237, "episode_len_mean": 149.08, "episode_media": {}, "episodes_timesteps_total": 14908, "policy_reward_min": {"policy_0": -1574.7239216807855}, "policy_reward_max": {"policy_0": 4.703451893622027}, "policy_reward_mean": {"policy_0": -505.3714183306473}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2827.9147436934427, -1507.6259778754752, -3174.140988813553, -2809.880371958576, -3212.3390307565205, -4484.92225620861, -2997.6255627929418, -3066.3930744365302, -4258.823112359439, -2567.2536095999358, -2929.3189877793266, -1910.6284462793228, -2412.215867886355, -4135.99975347348, -2609.8679804337144, -3110.666266857077, -1689.1877673339727, -1194.6020893359998, -1332.3457000136787, -3604.818603554819, -1728.8508225338367, -1273.6371197198594, -2328.953938020528, -1867.4188564120518, -3483.0120650501926, -2354.078874455923, -2890.2932788299113, -3671.840902083128, -2646.5526505968774, -2624.6846517971703, -2403.2593525261905, -2441.275418283102, -2122.282955961397, -2450.6455642366845, -1012.6004961024336, -2234.797749035861, -4590.09048112731, -4055.3096471079652, -3714.07010720261, -2853.7162006747303, -2682.5908465583384, -1577.7648904781674, -1918.4488568578818, -1018.3056812596343, -1670.0822353145793, -2029.6414598652007, -2879.3013590295823, -3388.299543470655, -1838.3314826423525, -2409.9270872541774, -1641.365706841637, -2167.1319083572153, -1682.8184836946384, -2049.034924150044, -2660.877687242165, -1914.9082190997392, -4104.237479191829, -2933.371036280686, -2348.0238975681555, -1801.9251774655027, -1686.9519611389794, -2426.1118980423444, -2447.7482260006236, -1900.128260499186, -3711.348041537995, -3509.2067548083373, -2186.8458986851883, -1358.8390555775893, -2481.4633532791067, -3534.580585523629, -1103.2425498472505, -1021.5327220827181, -4207.0839854825335, -2347.4167026021682, -1462.7138888045563, -3788.313373919244, -2262.475212794682, -2558.0645075869743, -2944.9203238551695, -2746.2852900820076, -2039.3929644490197, -1995.0373201869963, -1324.7387327190124, -3452.786429428761, -2762.311379472975, -2928.1834168031055, -1236.8488853007566, -2071.194007954488, -2278.8180186053346, -1883.8955522730598, -2324.675921965236, -1736.6757788656523, -3670.525541004911, -1919.4028521461287, -3382.0611945613, -2032.1102020584892, -3393.6264078659865, -2706.239278719404, -3273.201024413822, -3288.3823785562636], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-472.43962567252083, -1446.7062160861828, -342.82510958183934, -311.70348711576213, -254.2403052371367, -460.13018607716987, -549.8783997464463, -377.14492153514584, -107.98007012691757, -12.492400389796597, -785.1016125086967, -205.50189858696203, -545.2219296831809, -1099.8957657778176, -538.4197822568954, -33.429076336384355, -1406.1161110563328, -421.74595882030866, -433.87719120319946, -514.7120345423515, -1284.5851304717887, -501.99490761598173, -92.90353082064226, -941.8180519989389, -391.03740984916857, -944.8269984894116, -1322.941009029781, -589.65655325363, -1258.5082660209716, -368.98942941481397, -963.7826167780962, -132.00658623140393, -729.3747221422134, -179.72724405229658, -992.7343935889326, -625.6872285052976, -32.57389150673061, -884.5258303012135, -557.7932502069357, -965.8128739163524, -1033.6319487902988, -1166.3916255727497, -828.7924565336048, -224.90582998490396, -1005.1012514778839, -30.004283842927723, -903.8284628899839, -1096.198704761081, -225.3467129966077, -311.87544510933793, -922.9611366690968, -794.9646411775553, -298.8438824732797, -725.4420871169106, -187.10724034248352, -293.3844349686531, -774.8735328421863, -71.9324453841953, -703.1468340277753, -67.29119905651199, -80.10571953431327, -179.598023469741, -159.96535298366544, -1212.0833717640849, -780.4634001345491, -1280.2612230276457, -1034.5409726848077, -305.39605139224733, -456.6659542040194, -1059.1355521647579, -326.0481656217054, -590.6895798802951, -874.3412865011018, -633.2126429949294, -185.57630543568206, -861.8679988745572, -188.2946661552291, -1119.057663715411, -796.1061278073213, -145.3398103045585, -474.05367654939045, -376.5547215499805, -568.1833076845617, -83.93896777103471, -186.45709377900684, -194.48652544244374, -268.8259719005494, -13.431369565620264, -459.82271217074486, -258.03551025664024, -48.753526665768796, -712.7584037316609, -42.53437697862278, -37.383149027627574, -490.9162436100001, -1574.7239216807855, -1390.9626114852074, -101.38386375159021, -188.3811474400431, -349.3670591971919, -208.82278654946944, -94.75357674784664, -1218.639849291795, -79.98495149577367, -126.64965844895355, -92.72023950473378, -189.84677820682575, -378.2843034764244, -274.87501764490645, -337.91078088696975, -162.3844714023528, -775.4428581882826, -651.9975356903889, -515.8355430550583, -223.29352968444562, -380.6160445619027, -326.92124431628037, -996.9872353073862, -46.02326313232518, -116.87106909415708, -410.43245278489604, -648.644571281769, -576.7252320177048, -633.0381219261349, -1214.171687039685, -35.324937194888356, -1141.0958657711774, -128.46808531159564, -536.5277309950526, -512.6622551832115, -947.0384364385088, -850.3114002898509, -277.79325830273945, -708.0226547007939, -107.12752909801604, -279.9304008605692, -1036.6986929277057, -740.8866261504293, -1181.4802830046708, -432.84489913975216, -270.19425020417367, -299.9844054026628, -972.5866216299779, -897.1069441592635, -206.68042920079944, -151.1103038256126, -44.23083659866743, -762.7664422292672, -608.859465373825, -1057.717603769798, -0.6495419078739746, -1542.1934760717174, -96.36420728316993, -551.5705328778837, -212.48159438554504, -22.036682038524415, -573.529985432009, -1358.5154364987288, -200.28656405339316, -286.90675026044545, 3.510203108305724, -527.3750712558069, -711.7256778220917, -424.1472566214258, -462.5451533703805, -1023.1418295481651, -185.6981627302971, -6.944301364244288, -808.1494253830621, -426.711845210916, -138.9206387883376, -511.69101789685556, -135.4119989226588, -71.01820482628283, -155.5586356682976, -862.8815798370492, -85.80143099414659, -219.82256445010438, -884.1838585854406, -182.10831516912032, -1244.1466841812019, -822.2911539402961, -1434.9046160458224, -113.34124193453754, -975.406785025451, -1361.6054438901133, -395.27592731507013, -503.377251034744, -1113.328959273925, -681.7220655941146, -686.276556534648, -178.4591152702836, -1294.7691805507525, -287.44953827797127, -1267.1157165689526, -33.303920445680546, -732.4022729065719, -1114.541074001545, -327.6430412807505, -645.8258920401853, -1288.2802883390918, -122.12137619179, -18.625635729873782, -902.0313984625127, -351.53214783506843, -595.6671000524195, -122.78745499712815, -318.15706540205656, -467.7019052920054, -73.45136473455635, -247.28799956782595, -796.8700454421817, -711.6868522011357, -44.78118974683949, -117.82276989989832, -306.7977793204706, -60.25312245189315, -288.14031311494364, -314.7762779567043, -48.338188415622824, -55.19101322214748, -174.96261782405472, -307.64484221423874, -1045.522556376758, -86.76120567737885, -100.74457409179591, -108.38549916075638, -668.0754455500387, -363.4632596640567, -788.9726813985516, -848.9620395451941, -588.0387476313418, -333.40214560395543, -851.7855010100685, -257.11292523902216, -250.2421418267783, -939.1271394028945, -918.351242431056, -797.4274890437014, -483.15153076622283, -65.36448852476211, -1098.194190153525, -485.2429954749185, -186.50371055158803, -3.0260979375580623, -1102.9576862936512, -685.5204331280363, -132.2489820399298, -437.97982292550427, -51.22016286705549, -1111.3882878733316, -37.7461389232115, -83.99230157853535, -312.67379985361316, -95.56517861294589, -800.8093397101289, -919.4937609998157, -277.1023337025596, -115.1352531760952, -54.591220768614484, -156.86643571083331, -94.88488849780146, -317.1870537645393, -44.821384772254795, -1069.058720949211, -247.27694016514138, -102.28719588292424, -663.0635361891074, -108.78353735368236, -927.6237145591879, -182.11534404617151, -67.55535721414816, -1292.6039150120175, -1021.2526960964781, -97.35037487335059, -407.4618633941655, -42.441715225997626, -663.270773517314, -62.17972805706856, -739.5541389051918, -630.0008997230464, -1158.7914542867932, -260.0720389427205, -979.2268791729538, -1076.146207066313, -1153.1350027405078, -389.49155170043304, -70.78762072139111, -384.63907657698326, -935.3177845413718, -115.79365809036474, -256.81212891355483, -331.4610164166546, -666.5486764317164, -977.4084177158668, -374.43110854100723, -1141.9731021396879, -134.5308209798638, -66.22832538897357, -84.76182041596854, -701.8157874650151, -600.4352298305189, -49.10018868846035, -11.551263833406722, -324.04949132157867, -90.14820756867803, -417.130416785253, -614.9129760183542, -1147.1159544620782, -156.80434320798187, -253.4634340903571, -400.24760183082327, -1310.9844240629607, -356.18376467248044, -126.86900134400429, -156.36707366680608, -132.36458475606216, -84.8498125025869, -1036.1796869049529, -490.36710266877816, -504.4705574085491, -903.5959790042023, -1172.9512281139353, -1045.533655907839, -84.79662110346769, -314.12441207019265, -833.4227706501065, -1011.1958206724969, -1094.2465093663543, -256.2172420491864, -26.444736374580263, -1363.0778232398698, -705.5671200906709, -8.361594923062349, -83.39462405700382, -129.50598013614098, -461.46031244616506, -237.23558659783052, -438.36876959093235, -92.26840680652097, -587.7936072401674, -320.8338145542519, -108.18769244873339, -761.8107140098755, -702.8375250260772, -1031.4273754353815, -243.60480621005098, -815.5012192212541, -1121.2593867455491, -322.7877979113946, -415.9732227469937, -271.2110625974146, -23.280509815903432, -303.83041136959014, -88.94734331734972, -50.018530434322386, -401.2265935408685, -481.17269591749, -12.940499837424907, -76.17440235261148, -967.5581739205553, -410.04149441040073, -1339.866646740631, -354.74559464097933, -1134.8720757699657, -74.81655005483698, -134.89651983974724, -763.5547748402107, -1347.0541073430331, -27.09475052433832, -780.7344815869371, -142.6711949290195, -231.69363253455126, -28.75328379665841, -278.86129595738936, -463.964923773022, -81.41395390145021, -1053.511694188748, -825.2025074221808, -1364.2202946338425, -574.5647837425042, -800.2318166846292, -161.13401796174654, -238.59445440299808, -487.9501400028049, -244.51398545474183, -752.8663465079736, -218.41804794970167, -421.5614762641997, -920.7046514103549, -492.6994229602897, -81.69694300208158, -660.9222548811997, -1043.0910862243998, -666.5106167871959, -435.8320999327509, -498.1615927425824, -746.2383525583087, -185.084670966748, -880.9685738816155, -647.5597481529556, -94.33688325411954, -1053.0784727999699, -9.413182257005298, -235.00467798496908, 4.703451893622027, -38.937375079044884, -207.11915813603898, -1396.2194934399186, -357.4647454256151, -6.0868186241410145, -116.38231865022833, -232.42040362541013, -68.52737704378792, -901.3218147754449, -83.0587134128164, -1233.9490625102026, -678.5708870683982, -444.11049080449226, -1013.0972756328521, -467.0191229434422, -323.0891128306118, -970.1271681205577, -428.99050687339565, -573.0854687049673, -1438.8507036317276, -990.7201164216152, -114.77546941563534, -177.08029006245837, -206.7568372716679, -37.179439666559304, -110.50336379714635, -9.256310418335827, -73.7580897913876, -1006.1516816273277, -1166.7550049093984, -698.4816762238926, -75.13272868834467, -31.955354659729586, -98.86924347312197, -113.82596495804052, -277.0323256560689, -613.2162312220933, -771.4097888862176, -503.3337078829134, -422.6199842926815, -99.65906390793384, -468.33557612971447, -710.2076390225149, -183.07328892021923, -49.63681290340588, -785.8760743949823, -318.52136517727155, -338.69235438303735, -831.949315106538, -202.576636432735, -97.81935107832815, -343.4522098262729, -871.0426761158193, -221.78490541249673, -876.6143208292837, -985.6588811173724, -364.38523916055755, -94.67102260032048, -1349.1960772973746, -1291.9989867669897, -146.09880838779034, -18.341870945765102, -60.59944268522732, -402.3637433603571, -700.1916580019819, -1350.35410479673, -82.47465887157817, -442.9369545723072, -806.1038183186996, -124.35496221947612, -1093.6011965155008, -488.4007259867231, -224.6767500562046, -101.0765672805853, -170.40115474837026, -1089.2686405439463, -601.8630654420531, -274.41163551388314, -1257.6819116177355, -290.2815811921448, -383.0129472202628, -732.0216262742979, -1007.779193240101, -293.1439307925976, -122.90720092816045, -1006.2250895349493, -450.91277530935275, -678.7708287324921, -1014.3851299088667, -479.45037784889524, -1296.7637302276905, -203.6184964602688, -334.3107320900538, -974.2390419293556]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4731292462657128, "mean_inference_ms": 1.6860764101784067, "mean_action_processing_ms": 0.7780847023188735, "mean_env_wait_ms": 9.83890108873607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012891054153442383, "StateBufferConnector_ms": 0.00926828384399414, "ViewRequirementAgentConnector_ms": 0.3007502555847168}, "num_episodes": 25, "episode_return_max": -1012.6004961024336, "episode_return_min": -4590.09048112731, "episode_return_mean": -2526.857091653237, "episodes_this_iter": 25}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1427457, "num_agent_steps_trained": 1427457, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.97259040098338, "num_env_steps_trained_throughput_per_sec": 77.97259040098338, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 1427457, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1427457, "timers": {"training_iteration_time_ms": 54581.08, "restore_workers_time_ms": 0.029, "training_step_time_ms": 54581.004, "sample_time_ms": 3212.753, "learn_time_ms": 51308.326, "learn_throughput": 77.96, "synch_weights_time_ms": 57.103}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1427457, "num_agent_steps_trained": 1427457}, "done": false, "training_iteration": 83, "trial_id": "efc54_00000", "date": "2024-07-24_19-55-03", "timestamp": 1721831103, "time_this_iter_s": 51.31051158905029, "time_total_s": 4498.750362873077, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7add80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4498.750362873077, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 9.931506849315067, "ram_util_percent": 23.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 104.39346895429823, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.67762776657387, "policy_loss": -0.0015969946755694203, "vf_loss": 4.700148312309642, "vf_explained_var": 0.978345837548927, "kl": 0.010798969858780181, "entropy": 2.9124025453755884, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.19259259259259, "num_grad_updates_lifetime": 337725.5, "diff_num_grad_updates_vs_sampler_policy": 2024.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1444628, "num_agent_steps_trained": 1444628}, "env_runners": {"episode_reward_max": -727.4220609090416, "episode_reward_min": -4590.09048112731, "episode_reward_mean": -2338.7649949755573, "episode_len_mean": 147.76, "episode_media": {}, "episodes_timesteps_total": 14776, "policy_reward_min": {"policy_0": -1438.8507036317276}, "policy_reward_max": {"policy_0": 4.703451893622027}, "policy_reward_mean": {"policy_0": -467.75299899511145}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2441.275418283102, -2122.282955961397, -2450.6455642366845, -1012.6004961024336, -2234.797749035861, -4590.09048112731, -4055.3096471079652, -3714.07010720261, -2853.7162006747303, -2682.5908465583384, -1577.7648904781674, -1918.4488568578818, -1018.3056812596343, -1670.0822353145793, -2029.6414598652007, -2879.3013590295823, -3388.299543470655, -1838.3314826423525, -2409.9270872541774, -1641.365706841637, -2167.1319083572153, -1682.8184836946384, -2049.034924150044, -2660.877687242165, -1914.9082190997392, -4104.237479191829, -2933.371036280686, -2348.0238975681555, -1801.9251774655027, -1686.9519611389794, -2426.1118980423444, -2447.7482260006236, -1900.128260499186, -3711.348041537995, -3509.2067548083373, -2186.8458986851883, -1358.8390555775893, -2481.4633532791067, -3534.580585523629, -1103.2425498472505, -1021.5327220827181, -4207.0839854825335, -2347.4167026021682, -1462.7138888045563, -3788.313373919244, -2262.475212794682, -2558.0645075869743, -2944.9203238551695, -2746.2852900820076, -2039.3929644490197, -1995.0373201869963, -1324.7387327190124, -3452.786429428761, -2762.311379472975, -2928.1834168031055, -1236.8488853007566, -2071.194007954488, -2278.8180186053346, -1883.8955522730598, -2324.675921965236, -1736.6757788656523, -3670.525541004911, -1919.4028521461287, -3382.0611945613, -2032.1102020584892, -3393.6264078659865, -2706.239278719404, -3273.201024413822, -3288.3823785562636, -1441.931571780458, -3001.548758319304, -2891.8471377760316, -3041.1509949477104, -1528.991769204956, -1488.605954187888, -1770.2181869896167, -2289.6784953771034, -1375.7010795454564, -2774.034832342558, -2661.886397930591, -1644.2664687290355, -2459.036210253412, -2530.9654404292155, -1365.8307693858667, -1642.7936198015036, -1573.7795114088492, -2411.236847344265, -2379.2977609483755, -2146.3112664089344, -1611.263448662051, -727.4220609090416, -1584.1173351192626, -3296.298141816564, -901.0937174017445, -2260.052926677077, -2678.93720209988, -1202.5431332903418, -3185.7784707233072, -2699.97339985986, -1733.3501260302307], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 143, 92, 150, 150, 111, 150, 150, 112, 150, 150, 150], "policy_policy_0_reward": [-22.036682038524415, -573.529985432009, -1358.5154364987288, -200.28656405339316, -286.90675026044545, 3.510203108305724, -527.3750712558069, -711.7256778220917, -424.1472566214258, -462.5451533703805, -1023.1418295481651, -185.6981627302971, -6.944301364244288, -808.1494253830621, -426.711845210916, -138.9206387883376, -511.69101789685556, -135.4119989226588, -71.01820482628283, -155.5586356682976, -862.8815798370492, -85.80143099414659, -219.82256445010438, -884.1838585854406, -182.10831516912032, -1244.1466841812019, -822.2911539402961, -1434.9046160458224, -113.34124193453754, -975.406785025451, -1361.6054438901133, -395.27592731507013, -503.377251034744, -1113.328959273925, -681.7220655941146, -686.276556534648, -178.4591152702836, -1294.7691805507525, -287.44953827797127, -1267.1157165689526, -33.303920445680546, -732.4022729065719, -1114.541074001545, -327.6430412807505, -645.8258920401853, -1288.2802883390918, -122.12137619179, -18.625635729873782, -902.0313984625127, -351.53214783506843, -595.6671000524195, -122.78745499712815, -318.15706540205656, -467.7019052920054, -73.45136473455635, -247.28799956782595, -796.8700454421817, -711.6868522011357, -44.78118974683949, -117.82276989989832, -306.7977793204706, -60.25312245189315, -288.14031311494364, -314.7762779567043, -48.338188415622824, -55.19101322214748, -174.96261782405472, -307.64484221423874, -1045.522556376758, -86.76120567737885, -100.74457409179591, -108.38549916075638, -668.0754455500387, -363.4632596640567, -788.9726813985516, -848.9620395451941, -588.0387476313418, -333.40214560395543, -851.7855010100685, -257.11292523902216, -250.2421418267783, -939.1271394028945, -918.351242431056, -797.4274890437014, -483.15153076622283, -65.36448852476211, -1098.194190153525, -485.2429954749185, -186.50371055158803, -3.0260979375580623, -1102.9576862936512, -685.5204331280363, -132.2489820399298, -437.97982292550427, -51.22016286705549, -1111.3882878733316, -37.7461389232115, -83.99230157853535, -312.67379985361316, -95.56517861294589, -800.8093397101289, -919.4937609998157, -277.1023337025596, -115.1352531760952, -54.591220768614484, -156.86643571083331, -94.88488849780146, -317.1870537645393, -44.821384772254795, -1069.058720949211, -247.27694016514138, -102.28719588292424, -663.0635361891074, -108.78353735368236, -927.6237145591879, -182.11534404617151, -67.55535721414816, -1292.6039150120175, -1021.2526960964781, -97.35037487335059, -407.4618633941655, -42.441715225997626, -663.270773517314, -62.17972805706856, -739.5541389051918, -630.0008997230464, -1158.7914542867932, -260.0720389427205, -979.2268791729538, -1076.146207066313, -1153.1350027405078, -389.49155170043304, -70.78762072139111, -384.63907657698326, -935.3177845413718, -115.79365809036474, -256.81212891355483, -331.4610164166546, -666.5486764317164, -977.4084177158668, -374.43110854100723, -1141.9731021396879, -134.5308209798638, -66.22832538897357, -84.76182041596854, -701.8157874650151, -600.4352298305189, -49.10018868846035, -11.551263833406722, -324.04949132157867, -90.14820756867803, -417.130416785253, -614.9129760183542, -1147.1159544620782, -156.80434320798187, -253.4634340903571, -400.24760183082327, -1310.9844240629607, -356.18376467248044, -126.86900134400429, -156.36707366680608, -132.36458475606216, -84.8498125025869, -1036.1796869049529, -490.36710266877816, -504.4705574085491, -903.5959790042023, -1172.9512281139353, -1045.533655907839, -84.79662110346769, -314.12441207019265, -833.4227706501065, -1011.1958206724969, -1094.2465093663543, -256.2172420491864, -26.444736374580263, -1363.0778232398698, -705.5671200906709, -8.361594923062349, -83.39462405700382, -129.50598013614098, -461.46031244616506, -237.23558659783052, -438.36876959093235, -92.26840680652097, -587.7936072401674, -320.8338145542519, -108.18769244873339, -761.8107140098755, -702.8375250260772, -1031.4273754353815, -243.60480621005098, -815.5012192212541, -1121.2593867455491, -322.7877979113946, -415.9732227469937, -271.2110625974146, -23.280509815903432, -303.83041136959014, -88.94734331734972, -50.018530434322386, -401.2265935408685, -481.17269591749, -12.940499837424907, -76.17440235261148, -967.5581739205553, -410.04149441040073, -1339.866646740631, -354.74559464097933, -1134.8720757699657, -74.81655005483698, -134.89651983974724, -763.5547748402107, -1347.0541073430331, -27.09475052433832, -780.7344815869371, -142.6711949290195, -231.69363253455126, -28.75328379665841, -278.86129595738936, -463.964923773022, -81.41395390145021, -1053.511694188748, -825.2025074221808, -1364.2202946338425, -574.5647837425042, -800.2318166846292, -161.13401796174654, -238.59445440299808, -487.9501400028049, -244.51398545474183, -752.8663465079736, -218.41804794970167, -421.5614762641997, -920.7046514103549, -492.6994229602897, -81.69694300208158, -660.9222548811997, -1043.0910862243998, -666.5106167871959, -435.8320999327509, -498.1615927425824, -746.2383525583087, -185.084670966748, -880.9685738816155, -647.5597481529556, -94.33688325411954, -1053.0784727999699, -9.413182257005298, -235.00467798496908, 4.703451893622027, -38.937375079044884, -207.11915813603898, -1396.2194934399186, -357.4647454256151, -6.0868186241410145, -116.38231865022833, -232.42040362541013, -68.52737704378792, -901.3218147754449, -83.0587134128164, -1233.9490625102026, -678.5708870683982, -444.11049080449226, -1013.0972756328521, -467.0191229434422, -323.0891128306118, -970.1271681205577, -428.99050687339565, -573.0854687049673, -1438.8507036317276, -990.7201164216152, -114.77546941563534, -177.08029006245837, -206.7568372716679, -37.179439666559304, -110.50336379714635, -9.256310418335827, -73.7580897913876, -1006.1516816273277, -1166.7550049093984, -698.4816762238926, -75.13272868834467, -31.955354659729586, -98.86924347312197, -113.82596495804052, -277.0323256560689, -613.2162312220933, -771.4097888862176, -503.3337078829134, -422.6199842926815, -99.65906390793384, -468.33557612971447, -710.2076390225149, -183.07328892021923, -49.63681290340588, -785.8760743949823, -318.52136517727155, -338.69235438303735, -831.949315106538, -202.576636432735, -97.81935107832815, -343.4522098262729, -871.0426761158193, -221.78490541249673, -876.6143208292837, -985.6588811173724, -364.38523916055755, -94.67102260032048, -1349.1960772973746, -1291.9989867669897, -146.09880838779034, -18.341870945765102, -60.59944268522732, -402.3637433603571, -700.1916580019819, -1350.35410479673, -82.47465887157817, -442.9369545723072, -806.1038183186996, -124.35496221947612, -1093.6011965155008, -488.4007259867231, -224.6767500562046, -101.0765672805853, -170.40115474837026, -1089.2686405439463, -601.8630654420531, -274.41163551388314, -1257.6819116177355, -290.2815811921448, -383.0129472202628, -732.0216262742979, -1007.779193240101, -293.1439307925976, -122.90720092816045, -1006.2250895349493, -450.91277530935275, -678.7708287324921, -1014.3851299088667, -479.45037784889524, -1296.7637302276905, -203.6184964602688, -334.3107320900538, -974.2390419293556, -360.8744056695824, -46.10157426011524, -482.9494301878801, -160.53140364451556, -391.4747580183649, -1221.5496525500173, -546.2447741188595, -815.8317387510754, -388.0903325692771, -29.832260330073478, -981.6007794794385, -115.66273596918052, -107.02287448108139, -1033.9400547071878, -653.6206931391426, -453.57544900350297, -658.7557795339245, -962.6749665004779, -308.135466623644, -658.0093332861601, -210.5722643106201, -90.98422368402537, -88.92448636313159, -8.040659544310625, -1130.4701353028674, -66.67864650500807, 0.6461557427414567, -48.714827341193086, -1239.0766823728372, -134.78195371159086, -515.0159028982303, -46.63783973288408, -32.886510089379094, -611.8475166091254, -563.8304176599975, -55.31419619884843, -1358.359366961608, -125.16987749204057, -136.27872933624724, -614.5563253883603, -372.16256169814346, -147.38142003990157, -586.2972334437945, -230.63294847009215, -39.22691589352375, -920.0643815732936, -93.43345630774492, -840.6718411164586, -635.5557142563151, -284.30943908874553, -1134.539266760545, -1079.6172288504824, -134.62919914057335, -113.39567496528478, -199.7050282137055, -30.018498657650277, -1197.3714167255855, -69.75571623771884, -294.7042328070972, -52.41660430098426, -788.5488643668905, -321.45655535540504, -62.64436085017623, -1119.1713389754307, -167.21509070551053, -1093.0736832460004, -546.7367123536842, -314.340975390746, -212.53800785927675, -364.2760615795074, -68.8685652792564, -441.7994460979921, -341.3596210063283, -346.9978945159977, -166.80524248629212, -42.829864628470865, -81.16292331660875, -291.50197803164014, -1118.508176805927, -108.79067701885677, -68.84931376478498, -268.3279441990386, -279.3766913226272, -841.7146684614975, -115.51089366090048, -1048.5466356349475, -139.28882388958198, -359.3769857902293, -197.86762934196253, -666.1567726875422, -16.94886428917546, -58.06264323420532, -1061.304412931858, -123.61323814462676, -1119.36860234851, -95.44414777306314, -329.8677509321091, -284.78486191802045, -1053.466652552294, -382.7478532334462, -653.2717979102284, -179.05037793798556, -46.363297014921436, -138.68208700718625, -593.895888791729, -80.00500239284416, -183.369020400517, -54.16755104799549, -347.78595339302274, -62.09453367466215, -67.19890218350511, -116.39221807602101, -83.63767234618385, -136.8875412020345, -1180.0010013115184, -1145.7777304715453, -690.7365441305748, -852.7148574101542, -308.8032334948529, -298.2657763094422, -201.0814274912108, -40.780005280394946, -278.20686262055926, -19.71432886052052, -361.3110931490598, -405.267255049116, -93.0836586951891, -935.5668984284974, -703.1596508776104, -122.97546362666375, -510.6211383249715, -164.2603272116445, -187.24163069113052, -875.1492090189547, -941.6648968531792, -98.64784186635937, -60.710697104391386, -116.23664254243906, -405.98029025047214, -520.9676615266801, -412.7805079652824, -272.4057105779446, -676.6711728176573, -876.3624948708239, -947.5585844915977, -88.81606737157634, -584.7560567572876, -635.4094047759545, -1239.9069650159777, -151.0849059390629, -105.93065372032659, -67.22183701192344, -130.1092926297659, -644.4137720725315, -785.6745705956838]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4723756171531592, "mean_inference_ms": 1.6867328812511917, "mean_action_processing_ms": 0.7767973415553755, "mean_env_wait_ms": 9.838208270472675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012529611587524414, "StateBufferConnector_ms": 0.009016275405883789, "ViewRequirementAgentConnector_ms": 0.2872340679168701}, "num_episodes": 31, "episode_return_max": -727.4220609090416, "episode_return_min": -4590.09048112731, "episode_return_mean": -2338.7649949755573, "episodes_this_iter": 31}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1444628, "num_agent_steps_trained": 1444628, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.03558212735481, "num_env_steps_trained_throughput_per_sec": 74.03558212735481, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1444628, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1444628, "timers": {"training_iteration_time_ms": 54875.455, "restore_workers_time_ms": 0.03, "training_step_time_ms": 54875.379, "sample_time_ms": 3207.079, "learn_time_ms": 51610.535, "learn_throughput": 77.504, "synch_weights_time_ms": 54.991}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1444628, "num_agent_steps_trained": 1444628}, "done": false, "training_iteration": 84, "trial_id": "efc54_00000", "date": "2024-07-24_19-55-57", "timestamp": 1721831157, "time_this_iter_s": 54.03873252868652, "time_total_s": 4552.789095401764, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x717514113640>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4552.789095401764, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 9.92236842105263, "ram_util_percent": 23.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 127.06392532434678, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.380908508348584, "policy_loss": -0.0035482916327713894, "vf_loss": 4.405786036907282, "vf_explained_var": 0.9888615012467654, "kl": 0.01082100832228984, "entropy": 2.9546437852065965, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.99248120300751, "num_grad_updates_lifetime": 341745.5, "diff_num_grad_updates_vs_sampler_policy": 1994.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1461651, "num_agent_steps_trained": 1461651}, "env_runners": {"episode_reward_max": -560.7044747038519, "episode_reward_min": -4207.0839854825335, "episode_reward_mean": -2376.6461156889836, "episode_len_mean": 147.32, "episode_media": {}, "episodes_timesteps_total": 14732, "policy_reward_min": {"policy_0": -1578.2283585926643}, "policy_reward_max": {"policy_0": 4.703451893622027}, "policy_reward_mean": {"policy_0": -475.32922313779676}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2933.371036280686, -2348.0238975681555, -1801.9251774655027, -1686.9519611389794, -2426.1118980423444, -2447.7482260006236, -1900.128260499186, -3711.348041537995, -3509.2067548083373, -2186.8458986851883, -1358.8390555775893, -2481.4633532791067, -3534.580585523629, -1103.2425498472505, -1021.5327220827181, -4207.0839854825335, -2347.4167026021682, -1462.7138888045563, -3788.313373919244, -2262.475212794682, -2558.0645075869743, -2944.9203238551695, -2746.2852900820076, -2039.3929644490197, -1995.0373201869963, -1324.7387327190124, -3452.786429428761, -2762.311379472975, -2928.1834168031055, -1236.8488853007566, -2071.194007954488, -2278.8180186053346, -1883.8955522730598, -2324.675921965236, -1736.6757788656523, -3670.525541004911, -1919.4028521461287, -3382.0611945613, -2032.1102020584892, -3393.6264078659865, -2706.239278719404, -3273.201024413822, -3288.3823785562636, -1441.931571780458, -3001.548758319304, -2891.8471377760316, -3041.1509949477104, -1528.991769204956, -1488.605954187888, -1770.2181869896167, -2289.6784953771034, -1375.7010795454564, -2774.034832342558, -2661.886397930591, -1644.2664687290355, -2459.036210253412, -2530.9654404292155, -1365.8307693858667, -1642.7936198015036, -1573.7795114088492, -2411.236847344265, -2379.2977609483755, -2146.3112664089344, -1611.263448662051, -727.4220609090416, -1584.1173351192626, -3296.298141816564, -901.0937174017445, -2260.052926677077, -2678.93720209988, -1202.5431332903418, -3185.7784707233072, -2699.97339985986, -1733.3501260302307, -2070.329447542095, -2943.512097968499, -1217.0233756531347, -3561.246831325303, -3291.9238791474727, -2305.1462092645584, -4095.0577202776026, -3706.4773192445505, -2854.172360635578, -3468.7409259895894, -3741.7494050297987, -1744.9240570797942, -3673.893509779607, -2665.6703199309372, -2723.551082387974, -1397.653808530588, -560.7044747038519, -2470.985018980005, -3216.723955440858, -2221.204993005606, -2182.9899050493373, -1461.9064050177412, -857.3382908610172, -2413.9379425145, -2870.73229682669, -3178.372910195848], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 143, 92, 150, 150, 111, 150, 150, 112, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1153.1350027405078, -389.49155170043304, -70.78762072139111, -384.63907657698326, -935.3177845413718, -115.79365809036474, -256.81212891355483, -331.4610164166546, -666.5486764317164, -977.4084177158668, -374.43110854100723, -1141.9731021396879, -134.5308209798638, -66.22832538897357, -84.76182041596854, -701.8157874650151, -600.4352298305189, -49.10018868846035, -11.551263833406722, -324.04949132157867, -90.14820756867803, -417.130416785253, -614.9129760183542, -1147.1159544620782, -156.80434320798187, -253.4634340903571, -400.24760183082327, -1310.9844240629607, -356.18376467248044, -126.86900134400429, -156.36707366680608, -132.36458475606216, -84.8498125025869, -1036.1796869049529, -490.36710266877816, -504.4705574085491, -903.5959790042023, -1172.9512281139353, -1045.533655907839, -84.79662110346769, -314.12441207019265, -833.4227706501065, -1011.1958206724969, -1094.2465093663543, -256.2172420491864, -26.444736374580263, -1363.0778232398698, -705.5671200906709, -8.361594923062349, -83.39462405700382, -129.50598013614098, -461.46031244616506, -237.23558659783052, -438.36876959093235, -92.26840680652097, -587.7936072401674, -320.8338145542519, -108.18769244873339, -761.8107140098755, -702.8375250260772, -1031.4273754353815, -243.60480621005098, -815.5012192212541, -1121.2593867455491, -322.7877979113946, -415.9732227469937, -271.2110625974146, -23.280509815903432, -303.83041136959014, -88.94734331734972, -50.018530434322386, -401.2265935408685, -481.17269591749, -12.940499837424907, -76.17440235261148, -967.5581739205553, -410.04149441040073, -1339.866646740631, -354.74559464097933, -1134.8720757699657, -74.81655005483698, -134.89651983974724, -763.5547748402107, -1347.0541073430331, -27.09475052433832, -780.7344815869371, -142.6711949290195, -231.69363253455126, -28.75328379665841, -278.86129595738936, -463.964923773022, -81.41395390145021, -1053.511694188748, -825.2025074221808, -1364.2202946338425, -574.5647837425042, -800.2318166846292, -161.13401796174654, -238.59445440299808, -487.9501400028049, -244.51398545474183, -752.8663465079736, -218.41804794970167, -421.5614762641997, -920.7046514103549, -492.6994229602897, -81.69694300208158, -660.9222548811997, -1043.0910862243998, -666.5106167871959, -435.8320999327509, -498.1615927425824, -746.2383525583087, -185.084670966748, -880.9685738816155, -647.5597481529556, -94.33688325411954, -1053.0784727999699, -9.413182257005298, -235.00467798496908, 4.703451893622027, -38.937375079044884, -207.11915813603898, -1396.2194934399186, -357.4647454256151, -6.0868186241410145, -116.38231865022833, -232.42040362541013, -68.52737704378792, -901.3218147754449, -83.0587134128164, -1233.9490625102026, -678.5708870683982, -444.11049080449226, -1013.0972756328521, -467.0191229434422, -323.0891128306118, -970.1271681205577, -428.99050687339565, -573.0854687049673, -1438.8507036317276, -990.7201164216152, -114.77546941563534, -177.08029006245837, -206.7568372716679, -37.179439666559304, -110.50336379714635, -9.256310418335827, -73.7580897913876, -1006.1516816273277, -1166.7550049093984, -698.4816762238926, -75.13272868834467, -31.955354659729586, -98.86924347312197, -113.82596495804052, -277.0323256560689, -613.2162312220933, -771.4097888862176, -503.3337078829134, -422.6199842926815, -99.65906390793384, -468.33557612971447, -710.2076390225149, -183.07328892021923, -49.63681290340588, -785.8760743949823, -318.52136517727155, -338.69235438303735, -831.949315106538, -202.576636432735, -97.81935107832815, -343.4522098262729, -871.0426761158193, -221.78490541249673, -876.6143208292837, -985.6588811173724, -364.38523916055755, -94.67102260032048, -1349.1960772973746, -1291.9989867669897, -146.09880838779034, -18.341870945765102, -60.59944268522732, -402.3637433603571, -700.1916580019819, -1350.35410479673, -82.47465887157817, -442.9369545723072, -806.1038183186996, -124.35496221947612, -1093.6011965155008, -488.4007259867231, -224.6767500562046, -101.0765672805853, -170.40115474837026, -1089.2686405439463, -601.8630654420531, -274.41163551388314, -1257.6819116177355, -290.2815811921448, -383.0129472202628, -732.0216262742979, -1007.779193240101, -293.1439307925976, -122.90720092816045, -1006.2250895349493, -450.91277530935275, -678.7708287324921, -1014.3851299088667, -479.45037784889524, -1296.7637302276905, -203.6184964602688, -334.3107320900538, -974.2390419293556, -360.8744056695824, -46.10157426011524, -482.9494301878801, -160.53140364451556, -391.4747580183649, -1221.5496525500173, -546.2447741188595, -815.8317387510754, -388.0903325692771, -29.832260330073478, -981.6007794794385, -115.66273596918052, -107.02287448108139, -1033.9400547071878, -653.6206931391426, -453.57544900350297, -658.7557795339245, -962.6749665004779, -308.135466623644, -658.0093332861601, -210.5722643106201, -90.98422368402537, -88.92448636313159, -8.040659544310625, -1130.4701353028674, -66.67864650500807, 0.6461557427414567, -48.714827341193086, -1239.0766823728372, -134.78195371159086, -515.0159028982303, -46.63783973288408, -32.886510089379094, -611.8475166091254, -563.8304176599975, -55.31419619884843, -1358.359366961608, -125.16987749204057, -136.27872933624724, -614.5563253883603, -372.16256169814346, -147.38142003990157, -586.2972334437945, -230.63294847009215, -39.22691589352375, -920.0643815732936, -93.43345630774492, -840.6718411164586, -635.5557142563151, -284.30943908874553, -1134.539266760545, -1079.6172288504824, -134.62919914057335, -113.39567496528478, -199.7050282137055, -30.018498657650277, -1197.3714167255855, -69.75571623771884, -294.7042328070972, -52.41660430098426, -788.5488643668905, -321.45655535540504, -62.64436085017623, -1119.1713389754307, -167.21509070551053, -1093.0736832460004, -546.7367123536842, -314.340975390746, -212.53800785927675, -364.2760615795074, -68.8685652792564, -441.7994460979921, -341.3596210063283, -346.9978945159977, -166.80524248629212, -42.829864628470865, -81.16292331660875, -291.50197803164014, -1118.508176805927, -108.79067701885677, -68.84931376478498, -268.3279441990386, -279.3766913226272, -841.7146684614975, -115.51089366090048, -1048.5466356349475, -139.28882388958198, -359.3769857902293, -197.86762934196253, -666.1567726875422, -16.94886428917546, -58.06264323420532, -1061.304412931858, -123.61323814462676, -1119.36860234851, -95.44414777306314, -329.8677509321091, -284.78486191802045, -1053.466652552294, -382.7478532334462, -653.2717979102284, -179.05037793798556, -46.363297014921436, -138.68208700718625, -593.895888791729, -80.00500239284416, -183.369020400517, -54.16755104799549, -347.78595339302274, -62.09453367466215, -67.19890218350511, -116.39221807602101, -83.63767234618385, -136.8875412020345, -1180.0010013115184, -1145.7777304715453, -690.7365441305748, -852.7148574101542, -308.8032334948529, -298.2657763094422, -201.0814274912108, -40.780005280394946, -278.20686262055926, -19.71432886052052, -361.3110931490598, -405.267255049116, -93.0836586951891, -935.5668984284974, -703.1596508776104, -122.97546362666375, -510.6211383249715, -164.2603272116445, -187.24163069113052, -875.1492090189547, -941.6648968531792, -98.64784186635937, -60.710697104391386, -116.23664254243906, -405.98029025047214, -520.9676615266801, -412.7805079652824, -272.4057105779446, -676.6711728176573, -876.3624948708239, -947.5585844915977, -88.81606737157634, -584.7560567572876, -635.4094047759545, -1239.9069650159777, -151.0849059390629, -105.93065372032659, -67.22183701192344, -130.1092926297659, -644.4137720725315, -785.6745705956838, -500.92733214606915, -1116.6932809040761, -163.42555872771163, -226.83295802845686, -62.450317735781944, -1006.5404321008797, -72.19414198899109, -563.0559454403536, -77.80623392225705, -1223.9153445160196, -71.76266782741148, -148.89597063143273, -207.0670737132279, -502.7037008545599, -286.5939626265015, -1099.3989474953335, -1363.988209421526, -800.6254487548061, -263.1750872947772, -34.05913835885899, -18.225322752391364, -200.53976532384021, -1533.2135035544038, -196.13662373376474, -1343.808663783074, -127.50157782290584, -1131.9952974987311, -204.84435156252877, -692.6229270851743, -148.18205529521956, -69.22667490670571, -1192.803288289966, -1307.6115201054204, -1070.159287513694, -455.25694946181284, -1191.491666905232, -836.3501013021099, -784.304350582929, -478.05394393684367, -416.27725651743583, -886.1566349376137, -807.1135879372837, -306.7628799700493, -205.6185973405023, -648.5206604501258, -1578.2283585926643, -179.55729749700532, -541.1908699357685, -844.5667962309253, -325.1976037332265, -1377.3604115144692, -562.0419533159156, -1012.8276215536453, -111.08219346350918, -678.4372251822632, -117.90119065860583, -708.0959388549012, -492.231331475892, -16.232414518073803, -410.4631815723218, -786.9640361203674, -382.05014170064686, -967.4842837474228, -512.2397905633707, -1025.1552576477982, -483.06673714428916, -696.5908259862978, -758.1871908240888, -232.72411692509013, -495.10144905117295, -587.6319308157557, -745.7316597017272, -238.99903032708988, -1106.475093885926, -44.71336765747339, -190.53518330055041, -604.9655057286222, -232.8297948417138, -68.89861968223447, -300.424704977467, -84.12029482130609, -108.59770419441132, -134.2438981259532, -160.99197763017176, -72.75059993200998, -349.43651160687125, -156.6004453930998, -276.88583910608895, -1294.948676708614, -393.1135461653343, -132.85050956051543, -989.7439522650694, -1335.196288137627, -579.2306453308979, -179.70256014675127, -343.16259861443217, -335.0888558387863, -830.6940808278804, -480.3678596942309, -231.891598030276, -862.4736072218542, -140.13579989106628, -425.89550293507745, -314.094184155811, -440.3908108455264, -585.8409230810108, -289.9807671368383, -155.92755903339562, -27.80770376020306, -402.3494520062948, -214.52694486923872, -160.32505110953576, -59.21612543772064, -31.427673193618585, -391.8424962509031, -193.14729971650854, -668.3197723766798, -202.57821464505622, -708.3435966845165, -641.5490590917365, -253.63939901888742, -118.3835453887852, -1148.9804597267191, -220.14549632829144, -1129.583396364004, -1243.5838798186269, -330.807331031707, -1095.4665284847308, -404.1317052517441, -104.38346560903896]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.471395142809231, "mean_inference_ms": 1.6856953642068024, "mean_action_processing_ms": 0.7768440952900205, "mean_env_wait_ms": 9.829707931512484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012100458145141602, "StateBufferConnector_ms": 0.008952140808105469, "ViewRequirementAgentConnector_ms": 0.2871572971343994}, "num_episodes": 26, "episode_return_max": -560.7044747038519, "episode_return_min": -4207.0839854825335, "episode_return_mean": -2376.6461156889836, "episodes_this_iter": 26}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1461651, "num_agent_steps_trained": 1461651, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 71.96998324519866, "num_env_steps_trained_throughput_per_sec": 71.96998324519866, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1461651, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1461651, "timers": {"training_iteration_time_ms": 54483.145, "restore_workers_time_ms": 0.03, "training_step_time_ms": 54483.067, "sample_time_ms": 3199.123, "learn_time_ms": 51225.667, "learn_throughput": 78.086, "synch_weights_time_ms": 55.515}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1461651, "num_agent_steps_trained": 1461651}, "done": false, "training_iteration": 85, "trial_id": "efc54_00000", "date": "2024-07-24_19-56-52", "timestamp": 1721831212, "time_this_iter_s": 55.5897159576416, "time_total_s": 4608.3788113594055, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x717514111240>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4608.3788113594055, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 9.806329113924049, "ram_util_percent": 23.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 121.39872226764373, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.4567275807531, "policy_loss": -0.0006120934565635807, "vf_loss": 4.4776180462627755, "vf_explained_var": 0.9818136983293587, "kl": 0.012045352989419673, "entropy": 2.942531726957908, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23255813953489, "num_grad_updates_lifetime": 345675.5, "diff_num_grad_updates_vs_sampler_policy": 1934.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1478064, "num_agent_steps_trained": 1478064}, "env_runners": {"episode_reward_max": -560.7044747038519, "episode_reward_min": -4095.0577202776026, "episode_reward_mean": -2418.728792594703, "episode_len_mean": 147.11, "episode_media": {}, "episodes_timesteps_total": 14711, "policy_reward_min": {"policy_0": -1578.2283585926643}, "policy_reward_max": {"policy_0": 0.6461557427414567}, "policy_reward_mean": {"policy_0": -483.7457585189406}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1324.7387327190124, -3452.786429428761, -2762.311379472975, -2928.1834168031055, -1236.8488853007566, -2071.194007954488, -2278.8180186053346, -1883.8955522730598, -2324.675921965236, -1736.6757788656523, -3670.525541004911, -1919.4028521461287, -3382.0611945613, -2032.1102020584892, -3393.6264078659865, -2706.239278719404, -3273.201024413822, -3288.3823785562636, -1441.931571780458, -3001.548758319304, -2891.8471377760316, -3041.1509949477104, -1528.991769204956, -1488.605954187888, -1770.2181869896167, -2289.6784953771034, -1375.7010795454564, -2774.034832342558, -2661.886397930591, -1644.2664687290355, -2459.036210253412, -2530.9654404292155, -1365.8307693858667, -1642.7936198015036, -1573.7795114088492, -2411.236847344265, -2379.2977609483755, -2146.3112664089344, -1611.263448662051, -727.4220609090416, -1584.1173351192626, -3296.298141816564, -901.0937174017445, -2260.052926677077, -2678.93720209988, -1202.5431332903418, -3185.7784707233072, -2699.97339985986, -1733.3501260302307, -2070.329447542095, -2943.512097968499, -1217.0233756531347, -3561.246831325303, -3291.9238791474727, -2305.1462092645584, -4095.0577202776026, -3706.4773192445505, -2854.172360635578, -3468.7409259895894, -3741.7494050297987, -1744.9240570797942, -3673.893509779607, -2665.6703199309372, -2723.551082387974, -1397.653808530588, -560.7044747038519, -2470.985018980005, -3216.723955440858, -2221.204993005606, -2182.9899050493373, -1461.9064050177412, -857.3382908610172, -2413.9379425145, -2870.73229682669, -3178.372910195848, -1949.936740822043, -2676.836515046268, -2874.4921259378193, -2785.032409760978, -3578.8267812632785, -3210.5591869088794, -2566.223404251187, -3788.4539126847403, -2678.9503269381216, -1968.0748510653953, -2784.5633826269072, -2536.634616806038, -2334.7926932724463, -1047.1457395696884, -2889.742721498218, -1912.966998588014, -2715.6254710715148, -2493.392486464992, -1862.17803091549, -2777.353053283609, -1762.9533834248457, -1764.6605285536116, -2851.0635490035047, -4043.1237751383005, -3157.707993776694], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 143, 92, 150, 150, 111, 150, 150, 112, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150, 150, 150, 144, 150, 150, 121, 150, 150, 150, 150], "policy_policy_0_reward": [-6.0868186241410145, -116.38231865022833, -232.42040362541013, -68.52737704378792, -901.3218147754449, -83.0587134128164, -1233.9490625102026, -678.5708870683982, -444.11049080449226, -1013.0972756328521, -467.0191229434422, -323.0891128306118, -970.1271681205577, -428.99050687339565, -573.0854687049673, -1438.8507036317276, -990.7201164216152, -114.77546941563534, -177.08029006245837, -206.7568372716679, -37.179439666559304, -110.50336379714635, -9.256310418335827, -73.7580897913876, -1006.1516816273277, -1166.7550049093984, -698.4816762238926, -75.13272868834467, -31.955354659729586, -98.86924347312197, -113.82596495804052, -277.0323256560689, -613.2162312220933, -771.4097888862176, -503.3337078829134, -422.6199842926815, -99.65906390793384, -468.33557612971447, -710.2076390225149, -183.07328892021923, -49.63681290340588, -785.8760743949823, -318.52136517727155, -338.69235438303735, -831.949315106538, -202.576636432735, -97.81935107832815, -343.4522098262729, -871.0426761158193, -221.78490541249673, -876.6143208292837, -985.6588811173724, -364.38523916055755, -94.67102260032048, -1349.1960772973746, -1291.9989867669897, -146.09880838779034, -18.341870945765102, -60.59944268522732, -402.3637433603571, -700.1916580019819, -1350.35410479673, -82.47465887157817, -442.9369545723072, -806.1038183186996, -124.35496221947612, -1093.6011965155008, -488.4007259867231, -224.6767500562046, -101.0765672805853, -170.40115474837026, -1089.2686405439463, -601.8630654420531, -274.41163551388314, -1257.6819116177355, -290.2815811921448, -383.0129472202628, -732.0216262742979, -1007.779193240101, -293.1439307925976, -122.90720092816045, -1006.2250895349493, -450.91277530935275, -678.7708287324921, -1014.3851299088667, -479.45037784889524, -1296.7637302276905, -203.6184964602688, -334.3107320900538, -974.2390419293556, -360.8744056695824, -46.10157426011524, -482.9494301878801, -160.53140364451556, -391.4747580183649, -1221.5496525500173, -546.2447741188595, -815.8317387510754, -388.0903325692771, -29.832260330073478, -981.6007794794385, -115.66273596918052, -107.02287448108139, -1033.9400547071878, -653.6206931391426, -453.57544900350297, -658.7557795339245, -962.6749665004779, -308.135466623644, -658.0093332861601, -210.5722643106201, -90.98422368402537, -88.92448636313159, -8.040659544310625, -1130.4701353028674, -66.67864650500807, 0.6461557427414567, -48.714827341193086, -1239.0766823728372, -134.78195371159086, -515.0159028982303, -46.63783973288408, -32.886510089379094, -611.8475166091254, -563.8304176599975, -55.31419619884843, -1358.359366961608, -125.16987749204057, -136.27872933624724, -614.5563253883603, -372.16256169814346, -147.38142003990157, -586.2972334437945, -230.63294847009215, -39.22691589352375, -920.0643815732936, -93.43345630774492, -840.6718411164586, -635.5557142563151, -284.30943908874553, -1134.539266760545, -1079.6172288504824, -134.62919914057335, -113.39567496528478, -199.7050282137055, -30.018498657650277, -1197.3714167255855, -69.75571623771884, -294.7042328070972, -52.41660430098426, -788.5488643668905, -321.45655535540504, -62.64436085017623, -1119.1713389754307, -167.21509070551053, -1093.0736832460004, -546.7367123536842, -314.340975390746, -212.53800785927675, -364.2760615795074, -68.8685652792564, -441.7994460979921, -341.3596210063283, -346.9978945159977, -166.80524248629212, -42.829864628470865, -81.16292331660875, -291.50197803164014, -1118.508176805927, -108.79067701885677, -68.84931376478498, -268.3279441990386, -279.3766913226272, -841.7146684614975, -115.51089366090048, -1048.5466356349475, -139.28882388958198, -359.3769857902293, -197.86762934196253, -666.1567726875422, -16.94886428917546, -58.06264323420532, -1061.304412931858, -123.61323814462676, -1119.36860234851, -95.44414777306314, -329.8677509321091, -284.78486191802045, -1053.466652552294, -382.7478532334462, -653.2717979102284, -179.05037793798556, -46.363297014921436, -138.68208700718625, -593.895888791729, -80.00500239284416, -183.369020400517, -54.16755104799549, -347.78595339302274, -62.09453367466215, -67.19890218350511, -116.39221807602101, -83.63767234618385, -136.8875412020345, -1180.0010013115184, -1145.7777304715453, -690.7365441305748, -852.7148574101542, -308.8032334948529, -298.2657763094422, -201.0814274912108, -40.780005280394946, -278.20686262055926, -19.71432886052052, -361.3110931490598, -405.267255049116, -93.0836586951891, -935.5668984284974, -703.1596508776104, -122.97546362666375, -510.6211383249715, -164.2603272116445, -187.24163069113052, -875.1492090189547, -941.6648968531792, -98.64784186635937, -60.710697104391386, -116.23664254243906, -405.98029025047214, -520.9676615266801, -412.7805079652824, -272.4057105779446, -676.6711728176573, -876.3624948708239, -947.5585844915977, -88.81606737157634, -584.7560567572876, -635.4094047759545, -1239.9069650159777, -151.0849059390629, -105.93065372032659, -67.22183701192344, -130.1092926297659, -644.4137720725315, -785.6745705956838, -500.92733214606915, -1116.6932809040761, -163.42555872771163, -226.83295802845686, -62.450317735781944, -1006.5404321008797, -72.19414198899109, -563.0559454403536, -77.80623392225705, -1223.9153445160196, -71.76266782741148, -148.89597063143273, -207.0670737132279, -502.7037008545599, -286.5939626265015, -1099.3989474953335, -1363.988209421526, -800.6254487548061, -263.1750872947772, -34.05913835885899, -18.225322752391364, -200.53976532384021, -1533.2135035544038, -196.13662373376474, -1343.808663783074, -127.50157782290584, -1131.9952974987311, -204.84435156252877, -692.6229270851743, -148.18205529521956, -69.22667490670571, -1192.803288289966, -1307.6115201054204, -1070.159287513694, -455.25694946181284, -1191.491666905232, -836.3501013021099, -784.304350582929, -478.05394393684367, -416.27725651743583, -886.1566349376137, -807.1135879372837, -306.7628799700493, -205.6185973405023, -648.5206604501258, -1578.2283585926643, -179.55729749700532, -541.1908699357685, -844.5667962309253, -325.1976037332265, -1377.3604115144692, -562.0419533159156, -1012.8276215536453, -111.08219346350918, -678.4372251822632, -117.90119065860583, -708.0959388549012, -492.231331475892, -16.232414518073803, -410.4631815723218, -786.9640361203674, -382.05014170064686, -967.4842837474228, -512.2397905633707, -1025.1552576477982, -483.06673714428916, -696.5908259862978, -758.1871908240888, -232.72411692509013, -495.10144905117295, -587.6319308157557, -745.7316597017272, -238.99903032708988, -1106.475093885926, -44.71336765747339, -190.53518330055041, -604.9655057286222, -232.8297948417138, -68.89861968223447, -300.424704977467, -84.12029482130609, -108.59770419441132, -134.2438981259532, -160.99197763017176, -72.75059993200998, -349.43651160687125, -156.6004453930998, -276.88583910608895, -1294.948676708614, -393.1135461653343, -132.85050956051543, -989.7439522650694, -1335.196288137627, -579.2306453308979, -179.70256014675127, -343.16259861443217, -335.0888558387863, -830.6940808278804, -480.3678596942309, -231.891598030276, -862.4736072218542, -140.13579989106628, -425.89550293507745, -314.094184155811, -440.3908108455264, -585.8409230810108, -289.9807671368383, -155.92755903339562, -27.80770376020306, -402.3494520062948, -214.52694486923872, -160.32505110953576, -59.21612543772064, -31.427673193618585, -391.8424962509031, -193.14729971650854, -668.3197723766798, -202.57821464505622, -708.3435966845165, -641.5490590917365, -253.63939901888742, -118.3835453887852, -1148.9804597267191, -220.14549632829144, -1129.583396364004, -1243.5838798186269, -330.807331031707, -1095.4665284847308, -404.1317052517441, -104.38346560903896, -776.7665304719832, -948.0370851344431, -25.1977880614187, -137.2662924885828, -62.66904466561451, -172.74255269283626, -783.8925488921726, -516.7397588474265, -106.56269303813431, -1096.8989615756957, -544.9530340537664, -313.7939609577473, -1111.590260231432, -730.9789108987352, -173.1759597961369, -744.1887141608221, -157.68892971198096, -240.17435046064264, -960.4041868185491, -682.5762286089825, -30.710865766628224, -131.9993985851949, -1412.213506156755, -914.330899361039, -1089.5721113936615, -584.6354801860496, -385.10316512686194, -955.9818986156888, -93.11664651888138, -1191.7219964613982, -24.243696458265433, -214.63551323918222, -917.3073195467779, -620.266623418311, -789.770251588648, -441.90680793489963, -1290.25577285382, -482.8603174935279, -342.663103229606, -1230.7679111728871, -806.5248511955405, -572.0029417413635, -463.88619655433376, -539.2590575393882, -297.27727990749605, -469.63213342650647, -315.2495772066317, -383.39336826456446, -530.1530358284658, -269.64673633923144, -89.90631431152622, -1071.7460233669633, -375.84887293571484, -895.5535827554194, -351.5085892572869, -465.4322031085698, -524.1259847764009, -288.3941027598498, -847.4027562113283, -411.27956994988966, -15.166259302691122, -986.1904468650939, -237.87955191559087, -56.266962791058795, -1039.289472398012, -209.31317781299626, -170.56411481662698, -26.8654439218353, -496.8853292818903, -143.517673736339, -376.0148541065038, -1194.397795805582, -751.7534137994047, -468.2272956292775, -99.34936215745306, -275.64923399740155, -174.89400714260526, -268.2366149860757, -51.46963263883333, -1142.7175098230975, -168.93363062707704, -825.481792469617, -761.3231105527677, -102.58831684584851, -857.2986205762027, -228.28775870104812, -574.0882044479322, -654.3548774835201, -770.3103825128512, -266.3512633196408, -204.9475462290033, -97.8079093059556, -933.5363003982843, -535.9365511790834, -89.9497238031625, -78.38809466765763, -1033.182621484417, -931.2394055491789, -229.14487488656886, -505.3980566957848, -392.686826223232, -220.05572109496728, -372.18835502535006, -174.27509746320993, -603.7473836180852, -680.2311355143495, -61.82680237823236, -484.87505875093666, -492.80817330377755, -44.91935860631308, -883.7034583916, -641.1054050469929, -191.251508656952, -83.25105008952903, -1051.7521268184296, -635.2538735117628, -979.8808387228416, -1348.8660765422119, -868.828607551724, -210.29437880976084, -931.719603208299, -11.653515857948943, -35.13814848800488, -730.7394664644537, -1448.4572597579854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4707788140042617, "mean_inference_ms": 1.6853171586347406, "mean_action_processing_ms": 0.7756232862139253, "mean_env_wait_ms": 9.821506062998587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012382268905639648, "StateBufferConnector_ms": 0.009260892868041992, "ViewRequirementAgentConnector_ms": 0.30124378204345703}, "num_episodes": 25, "episode_return_max": -560.7044747038519, "episode_return_min": -4095.0577202776026, "episode_return_mean": -2418.728792594703, "episodes_this_iter": 25}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1478064, "num_agent_steps_trained": 1478064, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.22288436670048, "num_env_steps_trained_throughput_per_sec": 79.22288436670048, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1478064, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1478064, "timers": {"training_iteration_time_ms": 54074.828, "restore_workers_time_ms": 0.03, "training_step_time_ms": 54074.752, "sample_time_ms": 3176.408, "learn_time_ms": 50838.967, "learn_throughput": 78.68, "synch_weights_time_ms": 56.611}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1478064, "num_agent_steps_trained": 1478064}, "done": false, "training_iteration": 86, "trial_id": "efc54_00000", "date": "2024-07-24_19-57-43", "timestamp": 1721831263, "time_this_iter_s": 50.50184917449951, "time_total_s": 4658.880660533905, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d71ed40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4658.880660533905, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 10.20138888888889, "ram_util_percent": 23.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 113.47489549660388, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.526365028428443, "policy_loss": -0.0019227816468035733, "vf_loss": 4.548724196634175, "vf_explained_var": 0.9826329797874263, "kl": 0.01119199964677754, "entropy": 2.893531118557777, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.27407407407408, "num_grad_updates_lifetime": 349635.5, "diff_num_grad_updates_vs_sampler_policy": 2024.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1495246, "num_agent_steps_trained": 1495246}, "env_runners": {"episode_reward_max": -560.7044747038519, "episode_reward_min": -4987.696464263042, "episode_reward_mean": -2384.415697857804, "episode_len_mean": 146.53, "episode_media": {}, "episodes_timesteps_total": 14653, "policy_reward_min": {"policy_0": -1578.2283585926643}, "policy_reward_max": {"policy_0": -3.503347191388227}, "policy_reward_mean": {"policy_0": -476.8831395715608}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2459.036210253412, -2530.9654404292155, -1365.8307693858667, -1642.7936198015036, -1573.7795114088492, -2411.236847344265, -2379.2977609483755, -2146.3112664089344, -1611.263448662051, -727.4220609090416, -1584.1173351192626, -3296.298141816564, -901.0937174017445, -2260.052926677077, -2678.93720209988, -1202.5431332903418, -3185.7784707233072, -2699.97339985986, -1733.3501260302307, -2070.329447542095, -2943.512097968499, -1217.0233756531347, -3561.246831325303, -3291.9238791474727, -2305.1462092645584, -4095.0577202776026, -3706.4773192445505, -2854.172360635578, -3468.7409259895894, -3741.7494050297987, -1744.9240570797942, -3673.893509779607, -2665.6703199309372, -2723.551082387974, -1397.653808530588, -560.7044747038519, -2470.985018980005, -3216.723955440858, -2221.204993005606, -2182.9899050493373, -1461.9064050177412, -857.3382908610172, -2413.9379425145, -2870.73229682669, -3178.372910195848, -1949.936740822043, -2676.836515046268, -2874.4921259378193, -2785.032409760978, -3578.8267812632785, -3210.5591869088794, -2566.223404251187, -3788.4539126847403, -2678.9503269381216, -1968.0748510653953, -2784.5633826269072, -2536.634616806038, -2334.7926932724463, -1047.1457395696884, -2889.742721498218, -1912.966998588014, -2715.6254710715148, -2493.392486464992, -1862.17803091549, -2777.353053283609, -1762.9533834248457, -1764.6605285536116, -2851.0635490035047, -4043.1237751383005, -3157.707993776694, -1921.8506122019671, -1186.8668841820406, -1578.8024380110812, -1556.901989062459, -2816.47250867653, -2726.0515881164088, -2713.7515390125463, -2165.150506189694, -3512.938235515521, -982.1853513877219, -2269.3686625575924, -1649.5048612586372, -2237.344296805585, -2652.032996749795, -2149.7191984781975, -2496.7866631335514, -4826.548422004154, -4987.696464263042, -2725.989592117244, -645.0059519295241, -1558.0105142768748, -1537.1350414029312, -1679.7965763501957, -3076.8882791243495, -1676.6656054237903, -2060.3310006420284, -1835.2443295238118, -2180.012593301214, -2035.269856806242, -2703.9066176507604], "episode_lengths": [150, 150, 128, 150, 150, 150, 150, 150, 143, 92, 150, 150, 111, 150, 150, 112, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150, 150, 150, 144, 150, 150, 121, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-788.5488643668905, -321.45655535540504, -62.64436085017623, -1119.1713389754307, -167.21509070551053, -1093.0736832460004, -546.7367123536842, -314.340975390746, -212.53800785927675, -364.2760615795074, -68.8685652792564, -441.7994460979921, -341.3596210063283, -346.9978945159977, -166.80524248629212, -42.829864628470865, -81.16292331660875, -291.50197803164014, -1118.508176805927, -108.79067701885677, -68.84931376478498, -268.3279441990386, -279.3766913226272, -841.7146684614975, -115.51089366090048, -1048.5466356349475, -139.28882388958198, -359.3769857902293, -197.86762934196253, -666.1567726875422, -16.94886428917546, -58.06264323420532, -1061.304412931858, -123.61323814462676, -1119.36860234851, -95.44414777306314, -329.8677509321091, -284.78486191802045, -1053.466652552294, -382.7478532334462, -653.2717979102284, -179.05037793798556, -46.363297014921436, -138.68208700718625, -593.895888791729, -80.00500239284416, -183.369020400517, -54.16755104799549, -347.78595339302274, -62.09453367466215, -67.19890218350511, -116.39221807602101, -83.63767234618385, -136.8875412020345, -1180.0010013115184, -1145.7777304715453, -690.7365441305748, -852.7148574101542, -308.8032334948529, -298.2657763094422, -201.0814274912108, -40.780005280394946, -278.20686262055926, -19.71432886052052, -361.3110931490598, -405.267255049116, -93.0836586951891, -935.5668984284974, -703.1596508776104, -122.97546362666375, -510.6211383249715, -164.2603272116445, -187.24163069113052, -875.1492090189547, -941.6648968531792, -98.64784186635937, -60.710697104391386, -116.23664254243906, -405.98029025047214, -520.9676615266801, -412.7805079652824, -272.4057105779446, -676.6711728176573, -876.3624948708239, -947.5585844915977, -88.81606737157634, -584.7560567572876, -635.4094047759545, -1239.9069650159777, -151.0849059390629, -105.93065372032659, -67.22183701192344, -130.1092926297659, -644.4137720725315, -785.6745705956838, -500.92733214606915, -1116.6932809040761, -163.42555872771163, -226.83295802845686, -62.450317735781944, -1006.5404321008797, -72.19414198899109, -563.0559454403536, -77.80623392225705, -1223.9153445160196, -71.76266782741148, -148.89597063143273, -207.0670737132279, -502.7037008545599, -286.5939626265015, -1099.3989474953335, -1363.988209421526, -800.6254487548061, -263.1750872947772, -34.05913835885899, -18.225322752391364, -200.53976532384021, -1533.2135035544038, -196.13662373376474, -1343.808663783074, -127.50157782290584, -1131.9952974987311, -204.84435156252877, -692.6229270851743, -148.18205529521956, -69.22667490670571, -1192.803288289966, -1307.6115201054204, -1070.159287513694, -455.25694946181284, -1191.491666905232, -836.3501013021099, -784.304350582929, -478.05394393684367, -416.27725651743583, -886.1566349376137, -807.1135879372837, -306.7628799700493, -205.6185973405023, -648.5206604501258, -1578.2283585926643, -179.55729749700532, -541.1908699357685, -844.5667962309253, -325.1976037332265, -1377.3604115144692, -562.0419533159156, -1012.8276215536453, -111.08219346350918, -678.4372251822632, -117.90119065860583, -708.0959388549012, -492.231331475892, -16.232414518073803, -410.4631815723218, -786.9640361203674, -382.05014170064686, -967.4842837474228, -512.2397905633707, -1025.1552576477982, -483.06673714428916, -696.5908259862978, -758.1871908240888, -232.72411692509013, -495.10144905117295, -587.6319308157557, -745.7316597017272, -238.99903032708988, -1106.475093885926, -44.71336765747339, -190.53518330055041, -604.9655057286222, -232.8297948417138, -68.89861968223447, -300.424704977467, -84.12029482130609, -108.59770419441132, -134.2438981259532, -160.99197763017176, -72.75059993200998, -349.43651160687125, -156.6004453930998, -276.88583910608895, -1294.948676708614, -393.1135461653343, -132.85050956051543, -989.7439522650694, -1335.196288137627, -579.2306453308979, -179.70256014675127, -343.16259861443217, -335.0888558387863, -830.6940808278804, -480.3678596942309, -231.891598030276, -862.4736072218542, -140.13579989106628, -425.89550293507745, -314.094184155811, -440.3908108455264, -585.8409230810108, -289.9807671368383, -155.92755903339562, -27.80770376020306, -402.3494520062948, -214.52694486923872, -160.32505110953576, -59.21612543772064, -31.427673193618585, -391.8424962509031, -193.14729971650854, -668.3197723766798, -202.57821464505622, -708.3435966845165, -641.5490590917365, -253.63939901888742, -118.3835453887852, -1148.9804597267191, -220.14549632829144, -1129.583396364004, -1243.5838798186269, -330.807331031707, -1095.4665284847308, -404.1317052517441, -104.38346560903896, -776.7665304719832, -948.0370851344431, -25.1977880614187, -137.2662924885828, -62.66904466561451, -172.74255269283626, -783.8925488921726, -516.7397588474265, -106.56269303813431, -1096.8989615756957, -544.9530340537664, -313.7939609577473, -1111.590260231432, -730.9789108987352, -173.1759597961369, -744.1887141608221, -157.68892971198096, -240.17435046064264, -960.4041868185491, -682.5762286089825, -30.710865766628224, -131.9993985851949, -1412.213506156755, -914.330899361039, -1089.5721113936615, -584.6354801860496, -385.10316512686194, -955.9818986156888, -93.11664651888138, -1191.7219964613982, -24.243696458265433, -214.63551323918222, -917.3073195467779, -620.266623418311, -789.770251588648, -441.90680793489963, -1290.25577285382, -482.8603174935279, -342.663103229606, -1230.7679111728871, -806.5248511955405, -572.0029417413635, -463.88619655433376, -539.2590575393882, -297.27727990749605, -469.63213342650647, -315.2495772066317, -383.39336826456446, -530.1530358284658, -269.64673633923144, -89.90631431152622, -1071.7460233669633, -375.84887293571484, -895.5535827554194, -351.5085892572869, -465.4322031085698, -524.1259847764009, -288.3941027598498, -847.4027562113283, -411.27956994988966, -15.166259302691122, -986.1904468650939, -237.87955191559087, -56.266962791058795, -1039.289472398012, -209.31317781299626, -170.56411481662698, -26.8654439218353, -496.8853292818903, -143.517673736339, -376.0148541065038, -1194.397795805582, -751.7534137994047, -468.2272956292775, -99.34936215745306, -275.64923399740155, -174.89400714260526, -268.2366149860757, -51.46963263883333, -1142.7175098230975, -168.93363062707704, -825.481792469617, -761.3231105527677, -102.58831684584851, -857.2986205762027, -228.28775870104812, -574.0882044479322, -654.3548774835201, -770.3103825128512, -266.3512633196408, -204.9475462290033, -97.8079093059556, -933.5363003982843, -535.9365511790834, -89.9497238031625, -78.38809466765763, -1033.182621484417, -931.2394055491789, -229.14487488656886, -505.3980566957848, -392.686826223232, -220.05572109496728, -372.18835502535006, -174.27509746320993, -603.7473836180852, -680.2311355143495, -61.82680237823236, -484.87505875093666, -492.80817330377755, -44.91935860631308, -883.7034583916, -641.1054050469929, -191.251508656952, -83.25105008952903, -1051.7521268184296, -635.2538735117628, -979.8808387228416, -1348.8660765422119, -868.828607551724, -210.29437880976084, -931.719603208299, -11.653515857948943, -35.13814848800488, -730.7394664644537, -1448.4572597579854, -74.09077164161059, -251.83546664030925, -1135.4088757259417, -416.0275361840568, -44.48796201004922, -71.74672125840623, -124.1862738294182, -533.0944007636718, -90.53620557092812, -367.30328275961557, -184.6636306796039, -708.2532960940329, -29.78160870516679, -627.8006021772701, -28.30330035500783, -82.0313322022206, -276.56980403167336, -749.3800435326145, -127.25166982505284, -321.66913947089955, -1110.7608312004102, -880.9801720009431, -576.601716681888, -201.44582608757077, -46.68396270571679, -142.51080808609188, -296.58361741461107, -823.83421228848, -739.7960528208476, -723.3268975063795, -515.469850810882, -382.32230836337874, -676.047384817092, -838.7355132500439, -301.17648177114825, -794.7279130886544, -448.2418452407711, -267.17331912340455, -52.60479177498939, -602.4026369618732, -943.3613717716026, -983.4419568134508, -811.4512147657636, -752.8643867766149, -21.81930538808795, -199.87794185675114, -465.84611548316633, -282.8635620351765, -30.094384821239807, -3.503347191388227, -428.05360986469447, -150.10510188560656, -1272.682894055976, -360.0903763008173, -58.43668045049601, -110.84563068004724, -49.86254514018032, -714.6080157394107, -561.7076535412864, -212.48101615771307, -158.17427478513812, -529.4933217607584, -125.05783476039441, -548.4039330979358, -876.2149324013559, -713.3104200221538, -266.6664751843279, -359.652911235611, -308.10172106684774, -1004.3014692408557, -348.8932778524678, -681.3222609489305, -684.9692208499594, -91.35023002864118, -343.1842087981987, -184.97089395821118, -1238.1378140934578, -942.0458169771769, -100.32540958789413, -31.30672851681284, -1236.2737527686952, -1489.8439834684737, -123.67899526515082, -1086.23709039353, -890.5146001083074, -1319.9339766308703, -1124.4648132530592, -604.5383445181188, -550.7732274956732, -1387.9861023653227, -381.5961441780553, -108.12913336687619, -472.93319444101877, -1318.7910771172283, -444.54004301406655, -73.6057492930428, -313.96911693629573, -16.186834592179274, -168.6537084713478, -72.59054263665904, -30.620524501813872, -238.9344497007926, -387.6593180249433, -232.3968787579863, -668.3993432913385, -149.4846896762348, -1276.2808119781448, -32.14935864940189, -44.29063562116283, -34.929545477987, -328.31050710948847, -33.933988304694026, -12.923612904000965, -76.1995076903222, -1228.4289603416896, -841.209974003043, -482.8824178750158, -999.8943790387364, -559.4516888047051, -193.44981940285015, -52.432881088394424, -337.2205144831453, -144.6826119222521, -666.2195364248761, -476.1100615051212, -543.510968548803, -687.7811566039995, -197.60058218624056, -531.2815818195272, -100.15671148345761, -46.568769570965536, -126.33973982889292, -1146.5455767525073, -252.16732753181049, -263.62291583963673, -651.0809639818792, -182.6393367822451, -68.86162540739461, -691.8922603700094, -585.5384067596854, -484.50581102905016, -104.7973566065235, -790.1884720488899, -598.2826232810108, -57.49559384076937, -852.1245819045998, -473.57087898979336, -287.3324399562318, -948.868001683011, -142.01071511712556]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4705359750307991, "mean_inference_ms": 1.6859683070716758, "mean_action_processing_ms": 0.7749759578624498, "mean_env_wait_ms": 9.827128292305305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012299060821533203, "StateBufferConnector_ms": 0.009185314178466797, "ViewRequirementAgentConnector_ms": 0.3009982109069824}, "num_episodes": 30, "episode_return_max": -560.7044747038519, "episode_return_min": -4987.696464263042, "episode_return_mean": -2384.415697857804, "episodes_this_iter": 30}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1495246, "num_agent_steps_trained": 1495246, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 71.79813426795495, "num_env_steps_trained_throughput_per_sec": 71.79813426795495, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1495246, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1495246, "timers": {"training_iteration_time_ms": 54267.344, "restore_workers_time_ms": 0.029, "training_step_time_ms": 54267.27, "sample_time_ms": 3181.919, "learn_time_ms": 51026.23, "learn_throughput": 78.391, "synch_weights_time_ms": 56.338}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1495246, "num_agent_steps_trained": 1495246}, "done": false, "training_iteration": 87, "trial_id": "efc54_00000", "date": "2024-07-24_19-58-39", "timestamp": 1721831319, "time_this_iter_s": 55.71915555000305, "time_total_s": 4714.599816083908, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x717514111510>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4714.599816083908, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 9.781012658227848, "ram_util_percent": 23.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 150.7704177940593, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.103078638104831, "policy_loss": -0.004458913384644571, "vf_loss": 4.130400089539734, "vf_explained_var": 0.9898144054646586, "kl": 0.010752074021444308, "entropy": 3.102739991744359, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.88970588235294, "num_grad_updates_lifetime": 353700.5, "diff_num_grad_updates_vs_sampler_policy": 2039.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1512639, "num_agent_steps_trained": 1512639}, "env_runners": {"episode_reward_max": -560.7044747038519, "episode_reward_min": -5474.059341604801, "episode_reward_mean": -2538.910144478879, "episode_len_mean": 147.24, "episode_media": {}, "episodes_timesteps_total": 14724, "policy_reward_min": {"policy_0": -1578.2283585926643}, "policy_reward_max": {"policy_0": -3.503347191388227}, "policy_reward_mean": {"policy_0": -507.78202889577585}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3706.4773192445505, -2854.172360635578, -3468.7409259895894, -3741.7494050297987, -1744.9240570797942, -3673.893509779607, -2665.6703199309372, -2723.551082387974, -1397.653808530588, -560.7044747038519, -2470.985018980005, -3216.723955440858, -2221.204993005606, -2182.9899050493373, -1461.9064050177412, -857.3382908610172, -2413.9379425145, -2870.73229682669, -3178.372910195848, -1949.936740822043, -2676.836515046268, -2874.4921259378193, -2785.032409760978, -3578.8267812632785, -3210.5591869088794, -2566.223404251187, -3788.4539126847403, -2678.9503269381216, -1968.0748510653953, -2784.5633826269072, -2536.634616806038, -2334.7926932724463, -1047.1457395696884, -2889.742721498218, -1912.966998588014, -2715.6254710715148, -2493.392486464992, -1862.17803091549, -2777.353053283609, -1762.9533834248457, -1764.6605285536116, -2851.0635490035047, -4043.1237751383005, -3157.707993776694, -1921.8506122019671, -1186.8668841820406, -1578.8024380110812, -1556.901989062459, -2816.47250867653, -2726.0515881164088, -2713.7515390125463, -2165.150506189694, -3512.938235515521, -982.1853513877219, -2269.3686625575924, -1649.5048612586372, -2237.344296805585, -2652.032996749795, -2149.7191984781975, -2496.7866631335514, -4826.548422004154, -4987.696464263042, -2725.989592117244, -645.0059519295241, -1558.0105142768748, -1537.1350414029312, -1679.7965763501957, -3076.8882791243495, -1676.6656054237903, -2060.3310006420284, -1835.2443295238118, -2180.012593301214, -2035.269856806242, -2703.9066176507604, -2593.3923946103087, -2390.5082160347597, -2619.3902658600587, -3545.910120133057, -3172.816813522335, -3258.711522639756, -2524.4712953409694, -1736.246009692229, -3746.8994095557023, -3494.5399527032528, -2318.562291044848, -2932.4847784686917, -1915.0613848815512, -3140.1185832494707, -3704.5272609752374, -5474.059341604801, -3001.7852209364914, -4336.555874186257, -3162.874805866773, -2430.3141538655714, -2050.2238666468097, -4750.730396067877, -604.0860204090916, -931.1617586283638, -1431.0130603992227, -2057.3208145324857], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150, 150, 150, 144, 150, 150, 121, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 81, 125, 150, 150], "policy_policy_0_reward": [-1191.491666905232, -836.3501013021099, -784.304350582929, -478.05394393684367, -416.27725651743583, -886.1566349376137, -807.1135879372837, -306.7628799700493, -205.6185973405023, -648.5206604501258, -1578.2283585926643, -179.55729749700532, -541.1908699357685, -844.5667962309253, -325.1976037332265, -1377.3604115144692, -562.0419533159156, -1012.8276215536453, -111.08219346350918, -678.4372251822632, -117.90119065860583, -708.0959388549012, -492.231331475892, -16.232414518073803, -410.4631815723218, -786.9640361203674, -382.05014170064686, -967.4842837474228, -512.2397905633707, -1025.1552576477982, -483.06673714428916, -696.5908259862978, -758.1871908240888, -232.72411692509013, -495.10144905117295, -587.6319308157557, -745.7316597017272, -238.99903032708988, -1106.475093885926, -44.71336765747339, -190.53518330055041, -604.9655057286222, -232.8297948417138, -68.89861968223447, -300.424704977467, -84.12029482130609, -108.59770419441132, -134.2438981259532, -160.99197763017176, -72.75059993200998, -349.43651160687125, -156.6004453930998, -276.88583910608895, -1294.948676708614, -393.1135461653343, -132.85050956051543, -989.7439522650694, -1335.196288137627, -579.2306453308979, -179.70256014675127, -343.16259861443217, -335.0888558387863, -830.6940808278804, -480.3678596942309, -231.891598030276, -862.4736072218542, -140.13579989106628, -425.89550293507745, -314.094184155811, -440.3908108455264, -585.8409230810108, -289.9807671368383, -155.92755903339562, -27.80770376020306, -402.3494520062948, -214.52694486923872, -160.32505110953576, -59.21612543772064, -31.427673193618585, -391.8424962509031, -193.14729971650854, -668.3197723766798, -202.57821464505622, -708.3435966845165, -641.5490590917365, -253.63939901888742, -118.3835453887852, -1148.9804597267191, -220.14549632829144, -1129.583396364004, -1243.5838798186269, -330.807331031707, -1095.4665284847308, -404.1317052517441, -104.38346560903896, -776.7665304719832, -948.0370851344431, -25.1977880614187, -137.2662924885828, -62.66904466561451, -172.74255269283626, -783.8925488921726, -516.7397588474265, -106.56269303813431, -1096.8989615756957, -544.9530340537664, -313.7939609577473, -1111.590260231432, -730.9789108987352, -173.1759597961369, -744.1887141608221, -157.68892971198096, -240.17435046064264, -960.4041868185491, -682.5762286089825, -30.710865766628224, -131.9993985851949, -1412.213506156755, -914.330899361039, -1089.5721113936615, -584.6354801860496, -385.10316512686194, -955.9818986156888, -93.11664651888138, -1191.7219964613982, -24.243696458265433, -214.63551323918222, -917.3073195467779, -620.266623418311, -789.770251588648, -441.90680793489963, -1290.25577285382, -482.8603174935279, -342.663103229606, -1230.7679111728871, -806.5248511955405, -572.0029417413635, -463.88619655433376, -539.2590575393882, -297.27727990749605, -469.63213342650647, -315.2495772066317, -383.39336826456446, -530.1530358284658, -269.64673633923144, -89.90631431152622, -1071.7460233669633, -375.84887293571484, -895.5535827554194, -351.5085892572869, -465.4322031085698, -524.1259847764009, -288.3941027598498, -847.4027562113283, -411.27956994988966, -15.166259302691122, -986.1904468650939, -237.87955191559087, -56.266962791058795, -1039.289472398012, -209.31317781299626, -170.56411481662698, -26.8654439218353, -496.8853292818903, -143.517673736339, -376.0148541065038, -1194.397795805582, -751.7534137994047, -468.2272956292775, -99.34936215745306, -275.64923399740155, -174.89400714260526, -268.2366149860757, -51.46963263883333, -1142.7175098230975, -168.93363062707704, -825.481792469617, -761.3231105527677, -102.58831684584851, -857.2986205762027, -228.28775870104812, -574.0882044479322, -654.3548774835201, -770.3103825128512, -266.3512633196408, -204.9475462290033, -97.8079093059556, -933.5363003982843, -535.9365511790834, -89.9497238031625, -78.38809466765763, -1033.182621484417, -931.2394055491789, -229.14487488656886, -505.3980566957848, -392.686826223232, -220.05572109496728, -372.18835502535006, -174.27509746320993, -603.7473836180852, -680.2311355143495, -61.82680237823236, -484.87505875093666, -492.80817330377755, -44.91935860631308, -883.7034583916, -641.1054050469929, -191.251508656952, -83.25105008952903, -1051.7521268184296, -635.2538735117628, -979.8808387228416, -1348.8660765422119, -868.828607551724, -210.29437880976084, -931.719603208299, -11.653515857948943, -35.13814848800488, -730.7394664644537, -1448.4572597579854, -74.09077164161059, -251.83546664030925, -1135.4088757259417, -416.0275361840568, -44.48796201004922, -71.74672125840623, -124.1862738294182, -533.0944007636718, -90.53620557092812, -367.30328275961557, -184.6636306796039, -708.2532960940329, -29.78160870516679, -627.8006021772701, -28.30330035500783, -82.0313322022206, -276.56980403167336, -749.3800435326145, -127.25166982505284, -321.66913947089955, -1110.7608312004102, -880.9801720009431, -576.601716681888, -201.44582608757077, -46.68396270571679, -142.51080808609188, -296.58361741461107, -823.83421228848, -739.7960528208476, -723.3268975063795, -515.469850810882, -382.32230836337874, -676.047384817092, -838.7355132500439, -301.17648177114825, -794.7279130886544, -448.2418452407711, -267.17331912340455, -52.60479177498939, -602.4026369618732, -943.3613717716026, -983.4419568134508, -811.4512147657636, -752.8643867766149, -21.81930538808795, -199.87794185675114, -465.84611548316633, -282.8635620351765, -30.094384821239807, -3.503347191388227, -428.05360986469447, -150.10510188560656, -1272.682894055976, -360.0903763008173, -58.43668045049601, -110.84563068004724, -49.86254514018032, -714.6080157394107, -561.7076535412864, -212.48101615771307, -158.17427478513812, -529.4933217607584, -125.05783476039441, -548.4039330979358, -876.2149324013559, -713.3104200221538, -266.6664751843279, -359.652911235611, -308.10172106684774, -1004.3014692408557, -348.8932778524678, -681.3222609489305, -684.9692208499594, -91.35023002864118, -343.1842087981987, -184.97089395821118, -1238.1378140934578, -942.0458169771769, -100.32540958789413, -31.30672851681284, -1236.2737527686952, -1489.8439834684737, -123.67899526515082, -1086.23709039353, -890.5146001083074, -1319.9339766308703, -1124.4648132530592, -604.5383445181188, -550.7732274956732, -1387.9861023653227, -381.5961441780553, -108.12913336687619, -472.93319444101877, -1318.7910771172283, -444.54004301406655, -73.6057492930428, -313.96911693629573, -16.186834592179274, -168.6537084713478, -72.59054263665904, -30.620524501813872, -238.9344497007926, -387.6593180249433, -232.3968787579863, -668.3993432913385, -149.4846896762348, -1276.2808119781448, -32.14935864940189, -44.29063562116283, -34.929545477987, -328.31050710948847, -33.933988304694026, -12.923612904000965, -76.1995076903222, -1228.4289603416896, -841.209974003043, -482.8824178750158, -999.8943790387364, -559.4516888047051, -193.44981940285015, -52.432881088394424, -337.2205144831453, -144.6826119222521, -666.2195364248761, -476.1100615051212, -543.510968548803, -687.7811566039995, -197.60058218624056, -531.2815818195272, -100.15671148345761, -46.568769570965536, -126.33973982889292, -1146.5455767525073, -252.16732753181049, -263.62291583963673, -651.0809639818792, -182.6393367822451, -68.86162540739461, -691.8922603700094, -585.5384067596854, -484.50581102905016, -104.7973566065235, -790.1884720488899, -598.2826232810108, -57.49559384076937, -852.1245819045998, -473.57087898979336, -287.3324399562318, -948.868001683011, -142.01071511712556, -870.7274964899786, -1074.8185490911333, -204.42680491432407, -397.87741359877157, -45.54213051610211, -33.0270677311193, -15.35438727064874, -1177.8178946070207, -182.84186702735573, -981.4669993986123, -626.0117746369178, -211.18605450672183, -1045.4809555432207, -83.53695346154174, -653.1745277116546, -1271.6147816326356, -91.4955761912475, -860.6380376239426, -634.5090759874835, -687.6526486977432, -361.5786815961909, -1233.5643061485687, -234.50891526682983, -857.5942805773063, -485.5706299334376, -393.56447194783084, -1208.1077187744002, -121.41710531933829, -1189.1511893265574, -346.4710372716266, -577.0953525086212, -94.36013178586106, -326.66691530775023, -438.69299867207354, -1087.6558970666642, -507.7929397737401, -143.38309890922307, -178.98592204628602, -47.81789204064457, -858.2661569223345, -1239.626229846434, -122.56904860708, -1261.6294127733245, -64.84608273959597, -1058.2286355892657, -842.9503326857429, -415.53469422976104, -733.089384432267, -363.2062002572006, -1139.7593410982813, -273.574094493744, -1038.903669410345, -176.44513231376516, -145.75255951026807, -683.8868353167269, -579.0012624023759, -1221.3047975079146, -313.7265391850149, -607.3152211575563, -211.13695821582945, -177.2464731033215, -388.4433240658595, -132.11684087350994, -983.5927233762744, -233.6620234625861, -649.4031903898347, -1232.186468231148, -83.886417853276, -1093.5991925323092, -81.04331424290348, -813.6142047811867, -860.4988724776466, -1149.6165995935908, -358.7009969496341, -522.0965871731827, -1149.8159887044117, -1328.6059862254017, -1097.4374191149, -946.7066715910988, -951.4932759689934, -809.405721607459, -1136.837430652651, -803.2998901499077, -79.40515425237787, -172.8370242740969, -813.8047344601991, -1131.5697512473816, -148.48897421980317, -1235.9496376277461, -1006.7427766311255, -1000.4120687522927, -120.24870113517018, -330.0495847559961, -359.5615334795148, -1352.6029177438006, -92.89939533852649, -1554.9521033984568, -24.46052530284033, -52.17946086956857, -705.8226689561795, -69.21393977537501, -185.1903068352553, -644.1644132720354, -713.9114363859079, -437.743770378238, -498.61409553032087, -1093.7703321416377, -674.5141407149009, -1202.5242440459426, -1281.3075836350756, -86.38356635020122, -100.99372165576561, -275.42425496105596, -95.72434346811004, -45.56013397395853, -85.54340187520647, -92.04108732591278, -146.27854913012476, -86.48510901849608, -520.813611278624, -65.96446904734465, -648.8735849297408, -561.1860039518201, -101.05335730025804, -53.93564517005873, -133.22888127317026, -55.899712369563886, -886.3724557550811, -444.92861910183547, -536.8911460328361]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.470222579488543, "mean_inference_ms": 1.6854313326240657, "mean_action_processing_ms": 0.7752464966805163, "mean_env_wait_ms": 9.821704876384594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012712717056274414, "StateBufferConnector_ms": 0.00955653190612793, "ViewRequirementAgentConnector_ms": 0.3201162815093994}, "num_episodes": 26, "episode_return_max": -560.7044747038519, "episode_return_min": -5474.059341604801, "episode_return_mean": -2538.910144478879, "episodes_this_iter": 26}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1512639, "num_agent_steps_trained": 1512639, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.97253910424367, "num_env_steps_trained_throughput_per_sec": 72.97253910424367, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1512639, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1512639, "timers": {"training_iteration_time_ms": 54087.321, "restore_workers_time_ms": 0.029, "training_step_time_ms": 54087.247, "sample_time_ms": 3203.383, "learn_time_ms": 50824.827, "learn_throughput": 78.702, "synch_weights_time_ms": 56.216}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1512639, "num_agent_steps_trained": 1512639}, "done": false, "training_iteration": 88, "trial_id": "efc54_00000", "date": "2024-07-24_19-59-33", "timestamp": 1721831373, "time_this_iter_s": 54.826841831207275, "time_total_s": 4769.426657915115, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x717509f58160>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4769.426657915115, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 10.302564102564103, "ram_util_percent": 23.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 137.07743893613417, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.033412423543632, "policy_loss": 0.0002265952825837303, "vf_loss": 4.0547057356064515, "vf_explained_var": 0.9890857529360801, "kl": 0.012368614237038856, "entropy": 3.0912325251847506, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.2421875, "num_grad_updates_lifetime": 357660.5, "diff_num_grad_updates_vs_sampler_policy": 1919.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1528926, "num_agent_steps_trained": 1528926}, "env_runners": {"episode_reward_max": -604.0860204090916, "episode_reward_min": -5474.059341604801, "episode_reward_mean": -2565.6110484399896, "episode_len_mean": 147.13, "episode_media": {}, "episodes_timesteps_total": 14713, "policy_reward_min": {"policy_0": -1554.9521033984568}, "policy_reward_max": {"policy_0": -3.503347191388227}, "policy_reward_mean": {"policy_0": -513.122209687998}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2566.223404251187, -3788.4539126847403, -2678.9503269381216, -1968.0748510653953, -2784.5633826269072, -2536.634616806038, -2334.7926932724463, -1047.1457395696884, -2889.742721498218, -1912.966998588014, -2715.6254710715148, -2493.392486464992, -1862.17803091549, -2777.353053283609, -1762.9533834248457, -1764.6605285536116, -2851.0635490035047, -4043.1237751383005, -3157.707993776694, -1921.8506122019671, -1186.8668841820406, -1578.8024380110812, -1556.901989062459, -2816.47250867653, -2726.0515881164088, -2713.7515390125463, -2165.150506189694, -3512.938235515521, -982.1853513877219, -2269.3686625575924, -1649.5048612586372, -2237.344296805585, -2652.032996749795, -2149.7191984781975, -2496.7866631335514, -4826.548422004154, -4987.696464263042, -2725.989592117244, -645.0059519295241, -1558.0105142768748, -1537.1350414029312, -1679.7965763501957, -3076.8882791243495, -1676.6656054237903, -2060.3310006420284, -1835.2443295238118, -2180.012593301214, -2035.269856806242, -2703.9066176507604, -2593.3923946103087, -2390.5082160347597, -2619.3902658600587, -3545.910120133057, -3172.816813522335, -3258.711522639756, -2524.4712953409694, -1736.246009692229, -3746.8994095557023, -3494.5399527032528, -2318.562291044848, -2932.4847784686917, -1915.0613848815512, -3140.1185832494707, -3704.5272609752374, -5474.059341604801, -3001.7852209364914, -4336.555874186257, -3162.874805866773, -2430.3141538655714, -2050.2238666468097, -4750.730396067877, -604.0860204090916, -931.1617586283638, -1431.0130603992227, -2057.3208145324857, -3528.6872686428455, -2866.9638350710857, -1519.7426612797874, -2881.5990839330693, -2918.6982893627664, -2777.4036333004224, -2838.996337934676, -1205.5076619135527, -2597.23560584811, -856.1121965794226, -2441.769554880573, -2630.5015979304508, -1237.583336690521, -3243.245507027269, -2971.6405767070623, -2563.2135240358175, -3503.14089545097, -4612.793038502592, -2819.41852378477, -1106.4402412908928, -5011.845886784438, -2110.177680544509, -2297.4910095062114, -2443.654552543293, -4173.640637509064], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 139, 150, 150, 150, 144, 150, 150, 121, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 81, 125, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 128, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-24.243696458265433, -214.63551323918222, -917.3073195467779, -620.266623418311, -789.770251588648, -441.90680793489963, -1290.25577285382, -482.8603174935279, -342.663103229606, -1230.7679111728871, -806.5248511955405, -572.0029417413635, -463.88619655433376, -539.2590575393882, -297.27727990749605, -469.63213342650647, -315.2495772066317, -383.39336826456446, -530.1530358284658, -269.64673633923144, -89.90631431152622, -1071.7460233669633, -375.84887293571484, -895.5535827554194, -351.5085892572869, -465.4322031085698, -524.1259847764009, -288.3941027598498, -847.4027562113283, -411.27956994988966, -15.166259302691122, -986.1904468650939, -237.87955191559087, -56.266962791058795, -1039.289472398012, -209.31317781299626, -170.56411481662698, -26.8654439218353, -496.8853292818903, -143.517673736339, -376.0148541065038, -1194.397795805582, -751.7534137994047, -468.2272956292775, -99.34936215745306, -275.64923399740155, -174.89400714260526, -268.2366149860757, -51.46963263883333, -1142.7175098230975, -168.93363062707704, -825.481792469617, -761.3231105527677, -102.58831684584851, -857.2986205762027, -228.28775870104812, -574.0882044479322, -654.3548774835201, -770.3103825128512, -266.3512633196408, -204.9475462290033, -97.8079093059556, -933.5363003982843, -535.9365511790834, -89.9497238031625, -78.38809466765763, -1033.182621484417, -931.2394055491789, -229.14487488656886, -505.3980566957848, -392.686826223232, -220.05572109496728, -372.18835502535006, -174.27509746320993, -603.7473836180852, -680.2311355143495, -61.82680237823236, -484.87505875093666, -492.80817330377755, -44.91935860631308, -883.7034583916, -641.1054050469929, -191.251508656952, -83.25105008952903, -1051.7521268184296, -635.2538735117628, -979.8808387228416, -1348.8660765422119, -868.828607551724, -210.29437880976084, -931.719603208299, -11.653515857948943, -35.13814848800488, -730.7394664644537, -1448.4572597579854, -74.09077164161059, -251.83546664030925, -1135.4088757259417, -416.0275361840568, -44.48796201004922, -71.74672125840623, -124.1862738294182, -533.0944007636718, -90.53620557092812, -367.30328275961557, -184.6636306796039, -708.2532960940329, -29.78160870516679, -627.8006021772701, -28.30330035500783, -82.0313322022206, -276.56980403167336, -749.3800435326145, -127.25166982505284, -321.66913947089955, -1110.7608312004102, -880.9801720009431, -576.601716681888, -201.44582608757077, -46.68396270571679, -142.51080808609188, -296.58361741461107, -823.83421228848, -739.7960528208476, -723.3268975063795, -515.469850810882, -382.32230836337874, -676.047384817092, -838.7355132500439, -301.17648177114825, -794.7279130886544, -448.2418452407711, -267.17331912340455, -52.60479177498939, -602.4026369618732, -943.3613717716026, -983.4419568134508, -811.4512147657636, -752.8643867766149, -21.81930538808795, -199.87794185675114, -465.84611548316633, -282.8635620351765, -30.094384821239807, -3.503347191388227, -428.05360986469447, -150.10510188560656, -1272.682894055976, -360.0903763008173, -58.43668045049601, -110.84563068004724, -49.86254514018032, -714.6080157394107, -561.7076535412864, -212.48101615771307, -158.17427478513812, -529.4933217607584, -125.05783476039441, -548.4039330979358, -876.2149324013559, -713.3104200221538, -266.6664751843279, -359.652911235611, -308.10172106684774, -1004.3014692408557, -348.8932778524678, -681.3222609489305, -684.9692208499594, -91.35023002864118, -343.1842087981987, -184.97089395821118, -1238.1378140934578, -942.0458169771769, -100.32540958789413, -31.30672851681284, -1236.2737527686952, -1489.8439834684737, -123.67899526515082, -1086.23709039353, -890.5146001083074, -1319.9339766308703, -1124.4648132530592, -604.5383445181188, -550.7732274956732, -1387.9861023653227, -381.5961441780553, -108.12913336687619, -472.93319444101877, -1318.7910771172283, -444.54004301406655, -73.6057492930428, -313.96911693629573, -16.186834592179274, -168.6537084713478, -72.59054263665904, -30.620524501813872, -238.9344497007926, -387.6593180249433, -232.3968787579863, -668.3993432913385, -149.4846896762348, -1276.2808119781448, -32.14935864940189, -44.29063562116283, -34.929545477987, -328.31050710948847, -33.933988304694026, -12.923612904000965, -76.1995076903222, -1228.4289603416896, -841.209974003043, -482.8824178750158, -999.8943790387364, -559.4516888047051, -193.44981940285015, -52.432881088394424, -337.2205144831453, -144.6826119222521, -666.2195364248761, -476.1100615051212, -543.510968548803, -687.7811566039995, -197.60058218624056, -531.2815818195272, -100.15671148345761, -46.568769570965536, -126.33973982889292, -1146.5455767525073, -252.16732753181049, -263.62291583963673, -651.0809639818792, -182.6393367822451, -68.86162540739461, -691.8922603700094, -585.5384067596854, -484.50581102905016, -104.7973566065235, -790.1884720488899, -598.2826232810108, -57.49559384076937, -852.1245819045998, -473.57087898979336, -287.3324399562318, -948.868001683011, -142.01071511712556, -870.7274964899786, -1074.8185490911333, -204.42680491432407, -397.87741359877157, -45.54213051610211, -33.0270677311193, -15.35438727064874, -1177.8178946070207, -182.84186702735573, -981.4669993986123, -626.0117746369178, -211.18605450672183, -1045.4809555432207, -83.53695346154174, -653.1745277116546, -1271.6147816326356, -91.4955761912475, -860.6380376239426, -634.5090759874835, -687.6526486977432, -361.5786815961909, -1233.5643061485687, -234.50891526682983, -857.5942805773063, -485.5706299334376, -393.56447194783084, -1208.1077187744002, -121.41710531933829, -1189.1511893265574, -346.4710372716266, -577.0953525086212, -94.36013178586106, -326.66691530775023, -438.69299867207354, -1087.6558970666642, -507.7929397737401, -143.38309890922307, -178.98592204628602, -47.81789204064457, -858.2661569223345, -1239.626229846434, -122.56904860708, -1261.6294127733245, -64.84608273959597, -1058.2286355892657, -842.9503326857429, -415.53469422976104, -733.089384432267, -363.2062002572006, -1139.7593410982813, -273.574094493744, -1038.903669410345, -176.44513231376516, -145.75255951026807, -683.8868353167269, -579.0012624023759, -1221.3047975079146, -313.7265391850149, -607.3152211575563, -211.13695821582945, -177.2464731033215, -388.4433240658595, -132.11684087350994, -983.5927233762744, -233.6620234625861, -649.4031903898347, -1232.186468231148, -83.886417853276, -1093.5991925323092, -81.04331424290348, -813.6142047811867, -860.4988724776466, -1149.6165995935908, -358.7009969496341, -522.0965871731827, -1149.8159887044117, -1328.6059862254017, -1097.4374191149, -946.7066715910988, -951.4932759689934, -809.405721607459, -1136.837430652651, -803.2998901499077, -79.40515425237787, -172.8370242740969, -813.8047344601991, -1131.5697512473816, -148.48897421980317, -1235.9496376277461, -1006.7427766311255, -1000.4120687522927, -120.24870113517018, -330.0495847559961, -359.5615334795148, -1352.6029177438006, -92.89939533852649, -1554.9521033984568, -24.46052530284033, -52.17946086956857, -705.8226689561795, -69.21393977537501, -185.1903068352553, -644.1644132720354, -713.9114363859079, -437.743770378238, -498.61409553032087, -1093.7703321416377, -674.5141407149009, -1202.5242440459426, -1281.3075836350756, -86.38356635020122, -100.99372165576561, -275.42425496105596, -95.72434346811004, -45.56013397395853, -85.54340187520647, -92.04108732591278, -146.27854913012476, -86.48510901849608, -520.813611278624, -65.96446904734465, -648.8735849297408, -561.1860039518201, -101.05335730025804, -53.93564517005873, -133.22888127317026, -55.899712369563886, -886.3724557550811, -444.92861910183547, -536.8911460328361, -810.0371980334432, -145.50787488284138, -1090.3690850758267, -59.42784460556288, -1423.34526604517, -628.4664857073769, -310.85075293659855, -530.5068028014024, -299.8144149181248, -1097.3253787075878, -147.37478023269347, -68.08999856112565, -51.96288935776164, -69.4432062570738, -1182.8717868711326, -1231.2534476691635, -217.53023358091647, -926.4358598459532, -30.750906297598775, -475.62863653943646, -1279.7715729147267, -69.94396706734314, -421.4769253691884, -608.8106505870968, -538.6951734244087, -123.74912069201456, -914.7744998729795, -1106.9275870395525, -300.6070847164803, -331.3453409793971, -379.05119343562126, -794.2061689139141, -107.45386908731324, -876.683210548685, -681.6018959491416, -533.7695982541052, -477.7500496545423, -62.638430060908924, -79.31239829996163, -52.03718564403441, -840.4759105052569, -384.08576099509384, -173.1081696224311, -1093.3214071201805, -106.24435760514801, -134.65078451562897, -113.03852239292817, -59.566316982909484, -296.83201626983055, -252.02455641812563, -656.7772533178112, -699.7342558034013, -80.59280402684922, -871.2952727592974, -133.3699689732139, -57.48693278421847, -1260.87141016815, -968.2153698703177, -194.07987341809442, -149.84801168966942, -335.51595484397956, -518.3614140962702, -105.24572306968173, -121.77401422797944, -156.68623045260998, -92.50540010007286, -1178.0057109011889, -1014.8399026069098, -251.22306218861706, -706.6714312304795, -195.65376070797566, -984.8948739715968, -445.8139082924323, -50.73110568782441, -1294.5469280472335, -443.05175900002433, -462.58513583369455, -259.3196268203542, -265.3336002556605, -1132.9234021260866, -1288.6875658080862, -1244.1649239479884, -131.89068978727656, -393.0837267546072, -445.31398915301156, -1029.291640239617, -103.6290008289177, -728.0975665900058, -1408.401549195536, -1343.373281648518, -363.78982668656096, -271.5982088966018, -1024.2048757926652, -102.61526622902532, -1057.210346179919, -197.27559012330298, -145.25806216365302, -503.05057516277736, -200.5132603877364, -60.342753453423406, -380.8614827658792, -1083.9087376358723, -1088.0574601464589, -1528.1862813142368, -930.8319249219962, -618.9615246450227, -87.22849414955742, -212.15174372120572, -1097.9579269368262, -93.87799109189739, -24.170076001545407, -173.26864282010183, -1070.655916220389, -948.4550555003823, -80.94131896379282, -389.8873462800506, -221.47323810241838, -402.5949683694003, -340.6801106667197, -1089.0188891247042, -490.12886721328323, -495.4769843978113, -1501.1607437858634, -942.8115570632528, -744.0624850488505]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4687145363983738, "mean_inference_ms": 1.6848119916484752, "mean_action_processing_ms": 0.7738089284400087, "mean_env_wait_ms": 9.8112280768836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012593746185302734, "StateBufferConnector_ms": 0.009410858154296875, "ViewRequirementAgentConnector_ms": 0.31093287467956543}, "num_episodes": 25, "episode_return_max": -604.0860204090916, "episode_return_min": -5474.059341604801, "episode_return_mean": -2565.6110484399896, "episodes_this_iter": 25}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1528926, "num_agent_steps_trained": 1528926, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 75.72615343513571, "num_env_steps_trained_throughput_per_sec": 75.72615343513571, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1528926, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1528926, "timers": {"training_iteration_time_ms": 53636.359, "restore_workers_time_ms": 0.029, "training_step_time_ms": 53636.286, "sample_time_ms": 3192.833, "learn_time_ms": 50384.222, "learn_throughput": 79.39, "synch_weights_time_ms": 56.419}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1528926, "num_agent_steps_trained": 1528926}, "done": false, "training_iteration": 89, "trial_id": "efc54_00000", "date": "2024-07-24_20-00-26", "timestamp": 1721831426, "time_this_iter_s": 52.83241152763367, "time_total_s": 4822.259069442749, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x717514112290>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4822.259069442749, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 11.034666666666668, "ram_util_percent": 23.703999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 124.56631396144698, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.001, "total_loss": 4.4038687109113575, "policy_loss": -0.00400855534966158, "vf_loss": 4.430020486669385, "vf_explained_var": 0.9901837458560517, "kl": 0.011290514797456932, "entropy": 3.071695324201962, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.31468531468532, "num_grad_updates_lifetime": 361725.5, "diff_num_grad_updates_vs_sampler_policy": 2144.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1547132, "num_agent_steps_trained": 1547132}, "env_runners": {"episode_reward_max": -604.0860204090916, "episode_reward_min": -5474.059341604801, "episode_reward_mean": -2648.455029134084, "episode_len_mean": 146.25, "episode_media": {}, "episodes_timesteps_total": 14625, "policy_reward_min": {"policy_0": -1555.2980647044649}, "policy_reward_max": {"policy_0": -8.744107742809152}, "policy_reward_mean": {"policy_0": -529.6910058268168}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1649.5048612586372, -2237.344296805585, -2652.032996749795, -2149.7191984781975, -2496.7866631335514, -4826.548422004154, -4987.696464263042, -2725.989592117244, -645.0059519295241, -1558.0105142768748, -1537.1350414029312, -1679.7965763501957, -3076.8882791243495, -1676.6656054237903, -2060.3310006420284, -1835.2443295238118, -2180.012593301214, -2035.269856806242, -2703.9066176507604, -2593.3923946103087, -2390.5082160347597, -2619.3902658600587, -3545.910120133057, -3172.816813522335, -3258.711522639756, -2524.4712953409694, -1736.246009692229, -3746.8994095557023, -3494.5399527032528, -2318.562291044848, -2932.4847784686917, -1915.0613848815512, -3140.1185832494707, -3704.5272609752374, -5474.059341604801, -3001.7852209364914, -4336.555874186257, -3162.874805866773, -2430.3141538655714, -2050.2238666468097, -4750.730396067877, -604.0860204090916, -931.1617586283638, -1431.0130603992227, -2057.3208145324857, -3528.6872686428455, -2866.9638350710857, -1519.7426612797874, -2881.5990839330693, -2918.6982893627664, -2777.4036333004224, -2838.996337934676, -1205.5076619135527, -2597.23560584811, -856.1121965794226, -2441.769554880573, -2630.5015979304508, -1237.583336690521, -3243.245507027269, -2971.6405767070623, -2563.2135240358175, -3503.14089545097, -4612.793038502592, -2819.41852378477, -1106.4402412908928, -5011.845886784438, -2110.177680544509, -2297.4910095062114, -2443.654552543293, -4173.640637509064, -1689.1527267076904, -3181.6230942473003, -2820.2366209228617, -1877.8654181796878, -1152.5105455143405, -2279.021458862515, -1131.592094789126, -4892.927958287133, -2485.9663674481094, -1329.1547499235955, -3557.2692719043703, -3054.5940823423375, -4823.625999811512, -2854.4383415355487, -3104.63618322833, -1932.3127467652669, -2623.808387103748, -1579.5189697620003, -2959.974506971931, -2858.1685991769086, -963.5946680376575, -3031.98724517997, -2837.445063416495, -5450.135976920678, -3111.678516070298, -2043.6253898387085, -2894.6576482376245, -3151.670286365411, -2220.6079686825315, -1756.544417022647], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 81, 125, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 128, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 113, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 147, 150, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-110.84563068004724, -49.86254514018032, -714.6080157394107, -561.7076535412864, -212.48101615771307, -158.17427478513812, -529.4933217607584, -125.05783476039441, -548.4039330979358, -876.2149324013559, -713.3104200221538, -266.6664751843279, -359.652911235611, -308.10172106684774, -1004.3014692408557, -348.8932778524678, -681.3222609489305, -684.9692208499594, -91.35023002864118, -343.1842087981987, -184.97089395821118, -1238.1378140934578, -942.0458169771769, -100.32540958789413, -31.30672851681284, -1236.2737527686952, -1489.8439834684737, -123.67899526515082, -1086.23709039353, -890.5146001083074, -1319.9339766308703, -1124.4648132530592, -604.5383445181188, -550.7732274956732, -1387.9861023653227, -381.5961441780553, -108.12913336687619, -472.93319444101877, -1318.7910771172283, -444.54004301406655, -73.6057492930428, -313.96911693629573, -16.186834592179274, -168.6537084713478, -72.59054263665904, -30.620524501813872, -238.9344497007926, -387.6593180249433, -232.3968787579863, -668.3993432913385, -149.4846896762348, -1276.2808119781448, -32.14935864940189, -44.29063562116283, -34.929545477987, -328.31050710948847, -33.933988304694026, -12.923612904000965, -76.1995076903222, -1228.4289603416896, -841.209974003043, -482.8824178750158, -999.8943790387364, -559.4516888047051, -193.44981940285015, -52.432881088394424, -337.2205144831453, -144.6826119222521, -666.2195364248761, -476.1100615051212, -543.510968548803, -687.7811566039995, -197.60058218624056, -531.2815818195272, -100.15671148345761, -46.568769570965536, -126.33973982889292, -1146.5455767525073, -252.16732753181049, -263.62291583963673, -651.0809639818792, -182.6393367822451, -68.86162540739461, -691.8922603700094, -585.5384067596854, -484.50581102905016, -104.7973566065235, -790.1884720488899, -598.2826232810108, -57.49559384076937, -852.1245819045998, -473.57087898979336, -287.3324399562318, -948.868001683011, -142.01071511712556, -870.7274964899786, -1074.8185490911333, -204.42680491432407, -397.87741359877157, -45.54213051610211, -33.0270677311193, -15.35438727064874, -1177.8178946070207, -182.84186702735573, -981.4669993986123, -626.0117746369178, -211.18605450672183, -1045.4809555432207, -83.53695346154174, -653.1745277116546, -1271.6147816326356, -91.4955761912475, -860.6380376239426, -634.5090759874835, -687.6526486977432, -361.5786815961909, -1233.5643061485687, -234.50891526682983, -857.5942805773063, -485.5706299334376, -393.56447194783084, -1208.1077187744002, -121.41710531933829, -1189.1511893265574, -346.4710372716266, -577.0953525086212, -94.36013178586106, -326.66691530775023, -438.69299867207354, -1087.6558970666642, -507.7929397737401, -143.38309890922307, -178.98592204628602, -47.81789204064457, -858.2661569223345, -1239.626229846434, -122.56904860708, -1261.6294127733245, -64.84608273959597, -1058.2286355892657, -842.9503326857429, -415.53469422976104, -733.089384432267, -363.2062002572006, -1139.7593410982813, -273.574094493744, -1038.903669410345, -176.44513231376516, -145.75255951026807, -683.8868353167269, -579.0012624023759, -1221.3047975079146, -313.7265391850149, -607.3152211575563, -211.13695821582945, -177.2464731033215, -388.4433240658595, -132.11684087350994, -983.5927233762744, -233.6620234625861, -649.4031903898347, -1232.186468231148, -83.886417853276, -1093.5991925323092, -81.04331424290348, -813.6142047811867, -860.4988724776466, -1149.6165995935908, -358.7009969496341, -522.0965871731827, -1149.8159887044117, -1328.6059862254017, -1097.4374191149, -946.7066715910988, -951.4932759689934, -809.405721607459, -1136.837430652651, -803.2998901499077, -79.40515425237787, -172.8370242740969, -813.8047344601991, -1131.5697512473816, -148.48897421980317, -1235.9496376277461, -1006.7427766311255, -1000.4120687522927, -120.24870113517018, -330.0495847559961, -359.5615334795148, -1352.6029177438006, -92.89939533852649, -1554.9521033984568, -24.46052530284033, -52.17946086956857, -705.8226689561795, -69.21393977537501, -185.1903068352553, -644.1644132720354, -713.9114363859079, -437.743770378238, -498.61409553032087, -1093.7703321416377, -674.5141407149009, -1202.5242440459426, -1281.3075836350756, -86.38356635020122, -100.99372165576561, -275.42425496105596, -95.72434346811004, -45.56013397395853, -85.54340187520647, -92.04108732591278, -146.27854913012476, -86.48510901849608, -520.813611278624, -65.96446904734465, -648.8735849297408, -561.1860039518201, -101.05335730025804, -53.93564517005873, -133.22888127317026, -55.899712369563886, -886.3724557550811, -444.92861910183547, -536.8911460328361, -810.0371980334432, -145.50787488284138, -1090.3690850758267, -59.42784460556288, -1423.34526604517, -628.4664857073769, -310.85075293659855, -530.5068028014024, -299.8144149181248, -1097.3253787075878, -147.37478023269347, -68.08999856112565, -51.96288935776164, -69.4432062570738, -1182.8717868711326, -1231.2534476691635, -217.53023358091647, -926.4358598459532, -30.750906297598775, -475.62863653943646, -1279.7715729147267, -69.94396706734314, -421.4769253691884, -608.8106505870968, -538.6951734244087, -123.74912069201456, -914.7744998729795, -1106.9275870395525, -300.6070847164803, -331.3453409793971, -379.05119343562126, -794.2061689139141, -107.45386908731324, -876.683210548685, -681.6018959491416, -533.7695982541052, -477.7500496545423, -62.638430060908924, -79.31239829996163, -52.03718564403441, -840.4759105052569, -384.08576099509384, -173.1081696224311, -1093.3214071201805, -106.24435760514801, -134.65078451562897, -113.03852239292817, -59.566316982909484, -296.83201626983055, -252.02455641812563, -656.7772533178112, -699.7342558034013, -80.59280402684922, -871.2952727592974, -133.3699689732139, -57.48693278421847, -1260.87141016815, -968.2153698703177, -194.07987341809442, -149.84801168966942, -335.51595484397956, -518.3614140962702, -105.24572306968173, -121.77401422797944, -156.68623045260998, -92.50540010007286, -1178.0057109011889, -1014.8399026069098, -251.22306218861706, -706.6714312304795, -195.65376070797566, -984.8948739715968, -445.8139082924323, -50.73110568782441, -1294.5469280472335, -443.05175900002433, -462.58513583369455, -259.3196268203542, -265.3336002556605, -1132.9234021260866, -1288.6875658080862, -1244.1649239479884, -131.89068978727656, -393.0837267546072, -445.31398915301156, -1029.291640239617, -103.6290008289177, -728.0975665900058, -1408.401549195536, -1343.373281648518, -363.78982668656096, -271.5982088966018, -1024.2048757926652, -102.61526622902532, -1057.210346179919, -197.27559012330298, -145.25806216365302, -503.05057516277736, -200.5132603877364, -60.342753453423406, -380.8614827658792, -1083.9087376358723, -1088.0574601464589, -1528.1862813142368, -930.8319249219962, -618.9615246450227, -87.22849414955742, -212.15174372120572, -1097.9579269368262, -93.87799109189739, -24.170076001545407, -173.26864282010183, -1070.655916220389, -948.4550555003823, -80.94131896379282, -389.8873462800506, -221.47323810241838, -402.5949683694003, -340.6801106667197, -1089.0188891247042, -490.12886721328323, -495.4769843978113, -1501.1607437858634, -942.8115570632528, -744.0624850488505, -1037.0344242296753, -147.91095487092556, -297.41404929761075, -20.814240904574586, -185.97905740490503, -1306.9494853783115, -179.17478440818203, -849.570852396329, -372.84661470209056, -473.0813573623911, -355.4958063109192, -714.8813355092819, -99.24899852712494, -1033.7234636358369, -616.8870169396995, -467.9902877374785, -38.315142814560446, -351.52947128702095, -862.0593705135022, -157.9711458271257, -339.0953175561795, -488.98810806308427, -248.67002820454812, -62.05021761111821, -13.706874079411522, -392.6310426899331, -46.335699766870476, -252.9942893963581, -1135.4503869122993, -451.61004009705647, -400.45236014614494, -174.9376353435299, -291.8592725588544, -143.9940390130294, -120.3487877275667, -1217.5453708614402, -102.34194827831254, -1117.901186420617, -1104.0091490820803, -1351.1303036446805, -1046.6584258930372, -279.5390180794572, -116.42994759790886, -236.2302974024978, -807.1086784752068, -8.744107742809152, -90.46325275085464, -36.305728058165855, -844.577197772537, -349.0644635992285, -76.50097828594673, -389.3884363644379, -984.2556395513553, -1100.9883055279606, -1006.1359121746689, -40.25025464924669, -762.8830118971551, -484.79890214300076, -1361.56358568169, -405.09832797124585, -840.4714719336492, -1429.9267791268578, -279.5227290461671, -1390.9360474001587, -882.7689723046739, -534.7227571613075, -280.29750135839987, -1024.921501612781, -968.0323480796123, -46.464233323447175, -446.70521842277924, -152.13461671682947, -1251.535940731149, -140.18303291218203, -1114.07737444539, -842.3808092311219, -740.4413373412098, -160.2250609818171, -178.7020538063667, -10.563485404749784, -219.00177241049693, -1076.2862938055837, -407.22000603950016, -444.1400727250548, -477.16024212311066, -514.8594777248738, -229.66694089176116, -511.2291857855954, -166.97339422270565, -156.78997113706308, -500.43728952550487, -1020.7662147049505, -293.55530467784934, -1033.5130841514078, -111.70261391221739, -91.58968738756055, -752.3328902277175, -101.61940507632265, -965.4412874572432, -947.1853290280652, -71.89489536183414, -204.54560925901515, -256.71449766064956, -26.828207252924823, -403.61145850323334, -1138.969606031945, -772.7167744378231, -159.71044028082258, -341.0929387638906, -619.4974856654935, -296.1126112945055, -946.6916681237412, -76.90510669760259, -1330.115542369399, -187.6201349312453, -1555.2980647044649, -1047.9580403834052, -1100.6143869866269, -1284.9278588499137, -461.33762599626715, -1367.1317955932066, -387.7228053525506, -1226.5489007953568, -85.24885613822977, -45.0261581909526, -1173.0484876464627, -108.13254705459464, -634.2075186768553, -17.59331682999116, -110.64351963080581, -620.8841076855463, -477.87932977328927, -460.0177470658973, -428.16890672851827, -907.707556984372, -468.26389004960413, -473.50881851733254, -677.9393834934864, -1341.5130866456666, -190.4451076593227, -814.5263262632175, -466.8058735755173, -685.1829732812635, -225.52526179076563, -28.567533771767337, -390.9678275325118, -21.598418118984178, -49.823021232589745, -95.43312287674236, -1198.7220272618179]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4693647597423718, "mean_inference_ms": 1.6855976909036385, "mean_action_processing_ms": 0.7735436808940377, "mean_env_wait_ms": 9.821850516158714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013254404067993164, "StateBufferConnector_ms": 0.009807348251342773, "ViewRequirementAgentConnector_ms": 0.3266274929046631}, "num_episodes": 30, "episode_return_max": -604.0860204090916, "episode_return_min": -5474.059341604801, "episode_return_mean": -2648.455029134084, "episodes_this_iter": 30}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1547132, "num_agent_steps_trained": 1547132, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 68.94025526279155, "num_env_steps_trained_throughput_per_sec": 68.94025526279155, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1547132, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1547132, "timers": {"training_iteration_time_ms": 54267.13, "restore_workers_time_ms": 0.029, "training_step_time_ms": 54267.055, "sample_time_ms": 3242.352, "learn_time_ms": 50965.174, "learn_throughput": 78.485, "synch_weights_time_ms": 56.64}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1547132, "num_agent_steps_trained": 1547132}, "done": false, "training_iteration": 90, "trial_id": "efc54_00000", "date": "2024-07-24_20-01-24", "timestamp": 1721831484, "time_this_iter_s": 58.032729148864746, "time_total_s": 4880.291798591614, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x717509f588b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4880.291798591614, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 14.607317073170732, "ram_util_percent": 23.956097560975614}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 151.5627573427069, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.256633271552898, "policy_loss": -0.0014868297876630633, "vf_loss": 4.2807075877669, "vf_explained_var": 0.9860422890022318, "kl": 0.011904775405643882, "entropy": 3.1627674125489733, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65873015873017, "num_grad_updates_lifetime": 365760.5, "diff_num_grad_updates_vs_sampler_policy": 1889.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1563217, "num_agent_steps_trained": 1563217}, "env_runners": {"episode_reward_max": -604.0860204090916, "episode_reward_min": -5474.059341604801, "episode_reward_mean": -2697.482754836428, "episode_len_mean": 146.73, "episode_media": {}, "episodes_timesteps_total": 14673, "policy_reward_min": {"policy_0": -1555.2980647044649}, "policy_reward_max": {"policy_0": -0.47362164613113744}, "policy_reward_mean": {"policy_0": -539.4965509672855}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2524.4712953409694, -1736.246009692229, -3746.8994095557023, -3494.5399527032528, -2318.562291044848, -2932.4847784686917, -1915.0613848815512, -3140.1185832494707, -3704.5272609752374, -5474.059341604801, -3001.7852209364914, -4336.555874186257, -3162.874805866773, -2430.3141538655714, -2050.2238666468097, -4750.730396067877, -604.0860204090916, -931.1617586283638, -1431.0130603992227, -2057.3208145324857, -3528.6872686428455, -2866.9638350710857, -1519.7426612797874, -2881.5990839330693, -2918.6982893627664, -2777.4036333004224, -2838.996337934676, -1205.5076619135527, -2597.23560584811, -856.1121965794226, -2441.769554880573, -2630.5015979304508, -1237.583336690521, -3243.245507027269, -2971.6405767070623, -2563.2135240358175, -3503.14089545097, -4612.793038502592, -2819.41852378477, -1106.4402412908928, -5011.845886784438, -2110.177680544509, -2297.4910095062114, -2443.654552543293, -4173.640637509064, -1689.1527267076904, -3181.6230942473003, -2820.2366209228617, -1877.8654181796878, -1152.5105455143405, -2279.021458862515, -1131.592094789126, -4892.927958287133, -2485.9663674481094, -1329.1547499235955, -3557.2692719043703, -3054.5940823423375, -4823.625999811512, -2854.4383415355487, -3104.63618322833, -1932.3127467652669, -2623.808387103748, -1579.5189697620003, -2959.974506971931, -2858.1685991769086, -963.5946680376575, -3031.98724517997, -2837.445063416495, -5450.135976920678, -3111.678516070298, -2043.6253898387085, -2894.6576482376245, -3151.670286365411, -2220.6079686825315, -1756.544417022647, -3185.5471905662625, -2400.8435674532298, -2103.050125145876, -3068.174592874948, -1355.3142503044946, -2801.178753899577, -1350.7503314210446, -2549.8829547260384, -2687.6533520033195, -3027.9470256387053, -3457.950859714276, -1569.0036454772733, -4059.470290932733, -2672.320376221853, -4100.0363981148175, -1874.142790804567, -3097.7019458415016, -2668.997052466625, -5130.303520031657, -2761.5047564191646, -2924.884140724889, -1994.6961223774726, -2351.9644741097054, -2209.056965546929, -1795.0152814596113], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 81, 125, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 128, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 113, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 147, 150, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-577.0953525086212, -94.36013178586106, -326.66691530775023, -438.69299867207354, -1087.6558970666642, -507.7929397737401, -143.38309890922307, -178.98592204628602, -47.81789204064457, -858.2661569223345, -1239.626229846434, -122.56904860708, -1261.6294127733245, -64.84608273959597, -1058.2286355892657, -842.9503326857429, -415.53469422976104, -733.089384432267, -363.2062002572006, -1139.7593410982813, -273.574094493744, -1038.903669410345, -176.44513231376516, -145.75255951026807, -683.8868353167269, -579.0012624023759, -1221.3047975079146, -313.7265391850149, -607.3152211575563, -211.13695821582945, -177.2464731033215, -388.4433240658595, -132.11684087350994, -983.5927233762744, -233.6620234625861, -649.4031903898347, -1232.186468231148, -83.886417853276, -1093.5991925323092, -81.04331424290348, -813.6142047811867, -860.4988724776466, -1149.6165995935908, -358.7009969496341, -522.0965871731827, -1149.8159887044117, -1328.6059862254017, -1097.4374191149, -946.7066715910988, -951.4932759689934, -809.405721607459, -1136.837430652651, -803.2998901499077, -79.40515425237787, -172.8370242740969, -813.8047344601991, -1131.5697512473816, -148.48897421980317, -1235.9496376277461, -1006.7427766311255, -1000.4120687522927, -120.24870113517018, -330.0495847559961, -359.5615334795148, -1352.6029177438006, -92.89939533852649, -1554.9521033984568, -24.46052530284033, -52.17946086956857, -705.8226689561795, -69.21393977537501, -185.1903068352553, -644.1644132720354, -713.9114363859079, -437.743770378238, -498.61409553032087, -1093.7703321416377, -674.5141407149009, -1202.5242440459426, -1281.3075836350756, -86.38356635020122, -100.99372165576561, -275.42425496105596, -95.72434346811004, -45.56013397395853, -85.54340187520647, -92.04108732591278, -146.27854913012476, -86.48510901849608, -520.813611278624, -65.96446904734465, -648.8735849297408, -561.1860039518201, -101.05335730025804, -53.93564517005873, -133.22888127317026, -55.899712369563886, -886.3724557550811, -444.92861910183547, -536.8911460328361, -810.0371980334432, -145.50787488284138, -1090.3690850758267, -59.42784460556288, -1423.34526604517, -628.4664857073769, -310.85075293659855, -530.5068028014024, -299.8144149181248, -1097.3253787075878, -147.37478023269347, -68.08999856112565, -51.96288935776164, -69.4432062570738, -1182.8717868711326, -1231.2534476691635, -217.53023358091647, -926.4358598459532, -30.750906297598775, -475.62863653943646, -1279.7715729147267, -69.94396706734314, -421.4769253691884, -608.8106505870968, -538.6951734244087, -123.74912069201456, -914.7744998729795, -1106.9275870395525, -300.6070847164803, -331.3453409793971, -379.05119343562126, -794.2061689139141, -107.45386908731324, -876.683210548685, -681.6018959491416, -533.7695982541052, -477.7500496545423, -62.638430060908924, -79.31239829996163, -52.03718564403441, -840.4759105052569, -384.08576099509384, -173.1081696224311, -1093.3214071201805, -106.24435760514801, -134.65078451562897, -113.03852239292817, -59.566316982909484, -296.83201626983055, -252.02455641812563, -656.7772533178112, -699.7342558034013, -80.59280402684922, -871.2952727592974, -133.3699689732139, -57.48693278421847, -1260.87141016815, -968.2153698703177, -194.07987341809442, -149.84801168966942, -335.51595484397956, -518.3614140962702, -105.24572306968173, -121.77401422797944, -156.68623045260998, -92.50540010007286, -1178.0057109011889, -1014.8399026069098, -251.22306218861706, -706.6714312304795, -195.65376070797566, -984.8948739715968, -445.8139082924323, -50.73110568782441, -1294.5469280472335, -443.05175900002433, -462.58513583369455, -259.3196268203542, -265.3336002556605, -1132.9234021260866, -1288.6875658080862, -1244.1649239479884, -131.89068978727656, -393.0837267546072, -445.31398915301156, -1029.291640239617, -103.6290008289177, -728.0975665900058, -1408.401549195536, -1343.373281648518, -363.78982668656096, -271.5982088966018, -1024.2048757926652, -102.61526622902532, -1057.210346179919, -197.27559012330298, -145.25806216365302, -503.05057516277736, -200.5132603877364, -60.342753453423406, -380.8614827658792, -1083.9087376358723, -1088.0574601464589, -1528.1862813142368, -930.8319249219962, -618.9615246450227, -87.22849414955742, -212.15174372120572, -1097.9579269368262, -93.87799109189739, -24.170076001545407, -173.26864282010183, -1070.655916220389, -948.4550555003823, -80.94131896379282, -389.8873462800506, -221.47323810241838, -402.5949683694003, -340.6801106667197, -1089.0188891247042, -490.12886721328323, -495.4769843978113, -1501.1607437858634, -942.8115570632528, -744.0624850488505, -1037.0344242296753, -147.91095487092556, -297.41404929761075, -20.814240904574586, -185.97905740490503, -1306.9494853783115, -179.17478440818203, -849.570852396329, -372.84661470209056, -473.0813573623911, -355.4958063109192, -714.8813355092819, -99.24899852712494, -1033.7234636358369, -616.8870169396995, -467.9902877374785, -38.315142814560446, -351.52947128702095, -862.0593705135022, -157.9711458271257, -339.0953175561795, -488.98810806308427, -248.67002820454812, -62.05021761111821, -13.706874079411522, -392.6310426899331, -46.335699766870476, -252.9942893963581, -1135.4503869122993, -451.61004009705647, -400.45236014614494, -174.9376353435299, -291.8592725588544, -143.9940390130294, -120.3487877275667, -1217.5453708614402, -102.34194827831254, -1117.901186420617, -1104.0091490820803, -1351.1303036446805, -1046.6584258930372, -279.5390180794572, -116.42994759790886, -236.2302974024978, -807.1086784752068, -8.744107742809152, -90.46325275085464, -36.305728058165855, -844.577197772537, -349.0644635992285, -76.50097828594673, -389.3884363644379, -984.2556395513553, -1100.9883055279606, -1006.1359121746689, -40.25025464924669, -762.8830118971551, -484.79890214300076, -1361.56358568169, -405.09832797124585, -840.4714719336492, -1429.9267791268578, -279.5227290461671, -1390.9360474001587, -882.7689723046739, -534.7227571613075, -280.29750135839987, -1024.921501612781, -968.0323480796123, -46.464233323447175, -446.70521842277924, -152.13461671682947, -1251.535940731149, -140.18303291218203, -1114.07737444539, -842.3808092311219, -740.4413373412098, -160.2250609818171, -178.7020538063667, -10.563485404749784, -219.00177241049693, -1076.2862938055837, -407.22000603950016, -444.1400727250548, -477.16024212311066, -514.8594777248738, -229.66694089176116, -511.2291857855954, -166.97339422270565, -156.78997113706308, -500.43728952550487, -1020.7662147049505, -293.55530467784934, -1033.5130841514078, -111.70261391221739, -91.58968738756055, -752.3328902277175, -101.61940507632265, -965.4412874572432, -947.1853290280652, -71.89489536183414, -204.54560925901515, -256.71449766064956, -26.828207252924823, -403.61145850323334, -1138.969606031945, -772.7167744378231, -159.71044028082258, -341.0929387638906, -619.4974856654935, -296.1126112945055, -946.6916681237412, -76.90510669760259, -1330.115542369399, -187.6201349312453, -1555.2980647044649, -1047.9580403834052, -1100.6143869866269, -1284.9278588499137, -461.33762599626715, -1367.1317955932066, -387.7228053525506, -1226.5489007953568, -85.24885613822977, -45.0261581909526, -1173.0484876464627, -108.13254705459464, -634.2075186768553, -17.59331682999116, -110.64351963080581, -620.8841076855463, -477.87932977328927, -460.0177470658973, -428.16890672851827, -907.707556984372, -468.26389004960413, -473.50881851733254, -677.9393834934864, -1341.5130866456666, -190.4451076593227, -814.5263262632175, -466.8058735755173, -685.1829732812635, -225.52526179076563, -28.567533771767337, -390.9678275325118, -21.598418118984178, -49.823021232589745, -95.43312287674236, -1198.7220272618179, -755.1106342828077, -771.6528473746542, -54.25318629110463, -1510.6472700586887, -93.8832525590068, -30.78493776294375, -34.195183900359744, -506.79381226511595, -827.251250832012, -1001.8183826927977, -788.1356908509757, -152.7405823195276, -118.23149512534617, -623.2032555680587, -420.7391012819668, -889.0058299134125, -126.20433202555778, -119.7207887264775, -871.1197291621488, -1062.123913047352, -47.34749454857528, -364.17253127689867, -218.04058515221786, -442.33922290881634, -283.41441641798656, -104.03478418174748, -836.8178796854565, -633.7970374351403, -1206.6201541473567, -19.908898449876343, -236.47283285906022, -15.12151423806636, -922.7680491992311, -100.23940644127602, -76.14852868341194, -587.5711188320399, -86.55154291369618, -324.4583474702035, -484.2890946965446, -1067.0128508135554, -277.46652461848254, -1169.191273576884, -35.12481517692996, -55.126134088259825, -1150.7446045427616, -1454.66798245663, -1233.0935224683446, -113.14919705972834, -162.857599475449, -64.17872417855283, -1319.2421449583046, -1160.8733730094432, -576.0886389775451, -123.41221974520464, -278.3344830237782, -344.31323187687383, -0.47362164613113744, -82.89192841916186, -857.9831356129079, -283.34172792219914, -442.6519033250347, -501.77383923275136, -1004.6173651648031, -1198.4642509404794, -911.9629322696679, -68.16890435710438, -585.9739482947778, -265.78035844887467, -405.10492449499696, -1347.2922406260989, -1336.1252423334652, -1131.479866331637, -372.2638089831033, -331.0112431513984, -929.1562373152099, -313.86055654206734, -155.8499288988237, -66.18242213633916, -1249.9684840163848, -88.28139921095321, -618.4168207632362, -1505.5971056307947, -41.39149116002032, -537.0744707699946, -395.22205751745355, -503.2490446961036, -582.0622600374084, -498.1636193731499, -83.07982595333088, -1002.442302406631, -1448.476329108593, -948.4492967596057, -636.0370263271552, -911.6020401601268, -1185.7388276761828, -126.57766682139184, -25.853360624176485, -1238.0817220408587, -114.75643706219091, -1256.2355698705478, -69.71273655163186, -128.3769835623329, -1425.251049430938, -1296.3800665663375, -5.163304613648394, -1232.3973662081107, -79.46713028649161, -41.09661054341571, -147.70198762174763, -494.0330277177073, -208.05384261666563, -124.79686067062583, -598.1804623426286, -251.78701623591095, -1169.146292243874, -95.56337149424988, -611.2252323695457, -282.93224517717255, -1074.0422740373895, -145.29384246857134, -891.1175277965223, -154.60516501801524, -167.77069788255199, -540.9854345939278, -40.53645616859333]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4698114226723944, "mean_inference_ms": 1.6852918226193208, "mean_action_processing_ms": 0.7735761565270964, "mean_env_wait_ms": 9.817003062495678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012839078903198242, "StateBufferConnector_ms": 0.009701013565063477, "ViewRequirementAgentConnector_ms": 0.3223416805267334}, "num_episodes": 25, "episode_return_max": -604.0860204090916, "episode_return_min": -5474.059341604801, "episode_return_mean": -2697.482754836428, "episodes_this_iter": 25}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1563217, "num_agent_steps_trained": 1563217, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.65223577588644, "num_env_steps_trained_throughput_per_sec": 77.65223577588644, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1563217, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1563217, "timers": {"training_iteration_time_ms": 53750.449, "restore_workers_time_ms": 0.029, "training_step_time_ms": 53750.375, "sample_time_ms": 3242.52, "learn_time_ms": 50448.748, "learn_throughput": 79.288, "synch_weights_time_ms": 56.28}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1563217, "num_agent_steps_trained": 1563217}, "done": false, "training_iteration": 91, "trial_id": "efc54_00000", "date": "2024-07-24_20-02-16", "timestamp": 1721831536, "time_this_iter_s": 51.52338147163391, "time_total_s": 4931.815180063248, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d71ed40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4931.815180063248, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 10.693150684931506, "ram_util_percent": 24.024657534246572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 141.03998788888904, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000007, "total_loss": 4.403661278019781, "policy_loss": 0.002949279839463154, "vf_loss": 4.418566267156371, "vf_explained_var": 0.9849595468977224, "kl": 0.016914937489245375, "entropy": 3.069905042130014, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.5072463768116, "num_grad_updates_lifetime": 369720.5, "diff_num_grad_updates_vs_sampler_policy": 2069.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1580813, "num_agent_steps_trained": 1580813}, "env_runners": {"episode_reward_max": -761.1310366182719, "episode_reward_min": -5450.135976920678, "episode_reward_mean": -2696.4469126173813, "episode_len_mean": 147.0, "episode_media": {}, "episodes_timesteps_total": 14700, "policy_reward_min": {"policy_0": -1555.2980647044649}, "policy_reward_max": {"policy_0": -0.47362164613113744}, "policy_reward_mean": {"policy_0": -539.2893825234762}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2597.23560584811, -856.1121965794226, -2441.769554880573, -2630.5015979304508, -1237.583336690521, -3243.245507027269, -2971.6405767070623, -2563.2135240358175, -3503.14089545097, -4612.793038502592, -2819.41852378477, -1106.4402412908928, -5011.845886784438, -2110.177680544509, -2297.4910095062114, -2443.654552543293, -4173.640637509064, -1689.1527267076904, -3181.6230942473003, -2820.2366209228617, -1877.8654181796878, -1152.5105455143405, -2279.021458862515, -1131.592094789126, -4892.927958287133, -2485.9663674481094, -1329.1547499235955, -3557.2692719043703, -3054.5940823423375, -4823.625999811512, -2854.4383415355487, -3104.63618322833, -1932.3127467652669, -2623.808387103748, -1579.5189697620003, -2959.974506971931, -2858.1685991769086, -963.5946680376575, -3031.98724517997, -2837.445063416495, -5450.135976920678, -3111.678516070298, -2043.6253898387085, -2894.6576482376245, -3151.670286365411, -2220.6079686825315, -1756.544417022647, -3185.5471905662625, -2400.8435674532298, -2103.050125145876, -3068.174592874948, -1355.3142503044946, -2801.178753899577, -1350.7503314210446, -2549.8829547260384, -2687.6533520033195, -3027.9470256387053, -3457.950859714276, -1569.0036454772733, -4059.470290932733, -2672.320376221853, -4100.0363981148175, -1874.142790804567, -3097.7019458415016, -2668.997052466625, -5130.303520031657, -2761.5047564191646, -2924.884140724889, -1994.6961223774726, -2351.9644741097054, -2209.056965546929, -1795.0152814596113, -3662.6812257531706, -1967.0051713686048, -2998.7965182151966, -3688.44352250919, -3156.37198907387, -1747.7998067383178, -2475.8600180743038, -3277.8475909421795, -761.1310366182719, -1243.0347941937396, -2211.60140449684, -1901.8326119804929, -1837.6036105990236, -3680.252349587452, -2508.1721672612907, -2158.34207933833, -3012.7964086578586, -3396.3013759339874, -4077.756488554139, -2061.9314571152295, -2409.0683985316514, -3382.1666963748476, -3856.3252028937677, -2859.092212673053, -3956.065616866915, -3224.3559882346303, -2364.0728249456665, -2300.342261057215], "episode_lengths": [150, 108, 150, 150, 128, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 113, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 147, 150, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 91, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-840.4759105052569, -384.08576099509384, -173.1081696224311, -1093.3214071201805, -106.24435760514801, -134.65078451562897, -113.03852239292817, -59.566316982909484, -296.83201626983055, -252.02455641812563, -656.7772533178112, -699.7342558034013, -80.59280402684922, -871.2952727592974, -133.3699689732139, -57.48693278421847, -1260.87141016815, -968.2153698703177, -194.07987341809442, -149.84801168966942, -335.51595484397956, -518.3614140962702, -105.24572306968173, -121.77401422797944, -156.68623045260998, -92.50540010007286, -1178.0057109011889, -1014.8399026069098, -251.22306218861706, -706.6714312304795, -195.65376070797566, -984.8948739715968, -445.8139082924323, -50.73110568782441, -1294.5469280472335, -443.05175900002433, -462.58513583369455, -259.3196268203542, -265.3336002556605, -1132.9234021260866, -1288.6875658080862, -1244.1649239479884, -131.89068978727656, -393.0837267546072, -445.31398915301156, -1029.291640239617, -103.6290008289177, -728.0975665900058, -1408.401549195536, -1343.373281648518, -363.78982668656096, -271.5982088966018, -1024.2048757926652, -102.61526622902532, -1057.210346179919, -197.27559012330298, -145.25806216365302, -503.05057516277736, -200.5132603877364, -60.342753453423406, -380.8614827658792, -1083.9087376358723, -1088.0574601464589, -1528.1862813142368, -930.8319249219962, -618.9615246450227, -87.22849414955742, -212.15174372120572, -1097.9579269368262, -93.87799109189739, -24.170076001545407, -173.26864282010183, -1070.655916220389, -948.4550555003823, -80.94131896379282, -389.8873462800506, -221.47323810241838, -402.5949683694003, -340.6801106667197, -1089.0188891247042, -490.12886721328323, -495.4769843978113, -1501.1607437858634, -942.8115570632528, -744.0624850488505, -1037.0344242296753, -147.91095487092556, -297.41404929761075, -20.814240904574586, -185.97905740490503, -1306.9494853783115, -179.17478440818203, -849.570852396329, -372.84661470209056, -473.0813573623911, -355.4958063109192, -714.8813355092819, -99.24899852712494, -1033.7234636358369, -616.8870169396995, -467.9902877374785, -38.315142814560446, -351.52947128702095, -862.0593705135022, -157.9711458271257, -339.0953175561795, -488.98810806308427, -248.67002820454812, -62.05021761111821, -13.706874079411522, -392.6310426899331, -46.335699766870476, -252.9942893963581, -1135.4503869122993, -451.61004009705647, -400.45236014614494, -174.9376353435299, -291.8592725588544, -143.9940390130294, -120.3487877275667, -1217.5453708614402, -102.34194827831254, -1117.901186420617, -1104.0091490820803, -1351.1303036446805, -1046.6584258930372, -279.5390180794572, -116.42994759790886, -236.2302974024978, -807.1086784752068, -8.744107742809152, -90.46325275085464, -36.305728058165855, -844.577197772537, -349.0644635992285, -76.50097828594673, -389.3884363644379, -984.2556395513553, -1100.9883055279606, -1006.1359121746689, -40.25025464924669, -762.8830118971551, -484.79890214300076, -1361.56358568169, -405.09832797124585, -840.4714719336492, -1429.9267791268578, -279.5227290461671, -1390.9360474001587, -882.7689723046739, -534.7227571613075, -280.29750135839987, -1024.921501612781, -968.0323480796123, -46.464233323447175, -446.70521842277924, -152.13461671682947, -1251.535940731149, -140.18303291218203, -1114.07737444539, -842.3808092311219, -740.4413373412098, -160.2250609818171, -178.7020538063667, -10.563485404749784, -219.00177241049693, -1076.2862938055837, -407.22000603950016, -444.1400727250548, -477.16024212311066, -514.8594777248738, -229.66694089176116, -511.2291857855954, -166.97339422270565, -156.78997113706308, -500.43728952550487, -1020.7662147049505, -293.55530467784934, -1033.5130841514078, -111.70261391221739, -91.58968738756055, -752.3328902277175, -101.61940507632265, -965.4412874572432, -947.1853290280652, -71.89489536183414, -204.54560925901515, -256.71449766064956, -26.828207252924823, -403.61145850323334, -1138.969606031945, -772.7167744378231, -159.71044028082258, -341.0929387638906, -619.4974856654935, -296.1126112945055, -946.6916681237412, -76.90510669760259, -1330.115542369399, -187.6201349312453, -1555.2980647044649, -1047.9580403834052, -1100.6143869866269, -1284.9278588499137, -461.33762599626715, -1367.1317955932066, -387.7228053525506, -1226.5489007953568, -85.24885613822977, -45.0261581909526, -1173.0484876464627, -108.13254705459464, -634.2075186768553, -17.59331682999116, -110.64351963080581, -620.8841076855463, -477.87932977328927, -460.0177470658973, -428.16890672851827, -907.707556984372, -468.26389004960413, -473.50881851733254, -677.9393834934864, -1341.5130866456666, -190.4451076593227, -814.5263262632175, -466.8058735755173, -685.1829732812635, -225.52526179076563, -28.567533771767337, -390.9678275325118, -21.598418118984178, -49.823021232589745, -95.43312287674236, -1198.7220272618179, -755.1106342828077, -771.6528473746542, -54.25318629110463, -1510.6472700586887, -93.8832525590068, -30.78493776294375, -34.195183900359744, -506.79381226511595, -827.251250832012, -1001.8183826927977, -788.1356908509757, -152.7405823195276, -118.23149512534617, -623.2032555680587, -420.7391012819668, -889.0058299134125, -126.20433202555778, -119.7207887264775, -871.1197291621488, -1062.123913047352, -47.34749454857528, -364.17253127689867, -218.04058515221786, -442.33922290881634, -283.41441641798656, -104.03478418174748, -836.8178796854565, -633.7970374351403, -1206.6201541473567, -19.908898449876343, -236.47283285906022, -15.12151423806636, -922.7680491992311, -100.23940644127602, -76.14852868341194, -587.5711188320399, -86.55154291369618, -324.4583474702035, -484.2890946965446, -1067.0128508135554, -277.46652461848254, -1169.191273576884, -35.12481517692996, -55.126134088259825, -1150.7446045427616, -1454.66798245663, -1233.0935224683446, -113.14919705972834, -162.857599475449, -64.17872417855283, -1319.2421449583046, -1160.8733730094432, -576.0886389775451, -123.41221974520464, -278.3344830237782, -344.31323187687383, -0.47362164613113744, -82.89192841916186, -857.9831356129079, -283.34172792219914, -442.6519033250347, -501.77383923275136, -1004.6173651648031, -1198.4642509404794, -911.9629322696679, -68.16890435710438, -585.9739482947778, -265.78035844887467, -405.10492449499696, -1347.2922406260989, -1336.1252423334652, -1131.479866331637, -372.2638089831033, -331.0112431513984, -929.1562373152099, -313.86055654206734, -155.8499288988237, -66.18242213633916, -1249.9684840163848, -88.28139921095321, -618.4168207632362, -1505.5971056307947, -41.39149116002032, -537.0744707699946, -395.22205751745355, -503.2490446961036, -582.0622600374084, -498.1636193731499, -83.07982595333088, -1002.442302406631, -1448.476329108593, -948.4492967596057, -636.0370263271552, -911.6020401601268, -1185.7388276761828, -126.57766682139184, -25.853360624176485, -1238.0817220408587, -114.75643706219091, -1256.2355698705478, -69.71273655163186, -128.3769835623329, -1425.251049430938, -1296.3800665663375, -5.163304613648394, -1232.3973662081107, -79.46713028649161, -41.09661054341571, -147.70198762174763, -494.0330277177073, -208.05384261666563, -124.79686067062583, -598.1804623426286, -251.78701623591095, -1169.146292243874, -95.56337149424988, -611.2252323695457, -282.93224517717255, -1074.0422740373895, -145.29384246857134, -891.1175277965223, -154.60516501801524, -167.77069788255199, -540.9854345939278, -40.53645616859333, -497.1115324416644, -24.524192725753363, -1009.2774591581951, -1291.2726232500463, -840.4954181775063, -229.39718922856505, -849.9024767490362, -187.12641245473392, -297.35921424334583, -403.2198786929248, -1303.0178307220738, -75.817585570108, -1114.7980645982975, -48.73491193402509, -456.42812539068996, -925.4713070652144, -105.64102837492177, -1015.064520539115, -1167.0837766495904, -475.1828898803466, -1354.9954080256507, -144.17477897389423, -97.3470885100439, -1047.899433829275, -511.9552797350044, -283.15071421208637, -595.9198534256966, -425.20605551497306, -409.5091693129496, -34.0140142726115, -89.19390369911277, -504.6594707964309, -292.68296800800357, -1148.867462255579, -440.4562133151821, -1002.9438454331888, -151.822524845235, -811.4084130332643, -1056.6837188805257, -254.98908874996673, -34.19270628540103, -67.93962518754854, -146.2312335945421, -285.3623020017431, -227.405169549037, -146.82485823138126, -334.7689450334342, -209.63663544290182, -360.6233947348845, -191.18096075113863, -564.9881298731859, -432.15673192033836, -44.61893937684692, -206.89141933494847, -962.9461839915213, -469.18370914365875, -700.2993901919349, -119.66184838791169, -485.25659297417513, -127.43107128281328, -60.38995530120421, -348.5030497682257, -752.3678854521575, -236.6175080946993, -439.7252119827352, -803.9188745251477, -775.5392246730333, -607.3591994763995, -900.172363297347, -593.2626876155243, -78.82266304192775, -705.1492155875809, -152.0636368452165, -1037.253467505098, -534.883184281469, -137.36991254290214, -263.9744992005203, -282.42467325294444, -661.7557366782414, -812.8172576637231, -187.82772198179003, -1322.85043769447, -155.9181143179306, -1066.5088907136894, -279.69124394998005, -1068.267527995317, -962.4571760940167, -126.0488723960326, -708.5976823384525, -530.9301171101696, -592.6319127804364, -981.7617990380304, -1125.1265516502922, -1359.6554262552504, -18.5807988301258, -241.07949309763512, -869.3018183288445, -330.818724568924, -491.3353329880709, -129.39608813175465, -708.1001916073178, -822.9509136674757, -115.49730352918266, -645.4895643335503, -117.03042539412358, -690.8483570512855, -905.1706370077736, -312.50028098819234, -1426.8217685790105, -46.8256527485861, -288.9245764756092, -487.3295645148743, -1377.3588995907087, -1268.333885663995, -434.378276648578, -1449.2873805065217, -284.95423167548233, -327.4302006619854, -284.4632418207725, -512.957158008292, -1052.6096421247018, -257.39318547668665, -1279.8692106265755, -882.244843967244, -483.94873467170953, -707.3987726868311, -1210.7860241079209, -298.80671865782165, -246.40682283325444, -760.9576499488043, -172.64909375736806, -832.2288231502657, -106.23475366346756, -834.5425958296619, -418.417558544905, -72.12986908089604, -138.35115943868982, -216.7671194315414, -946.8489838488085, -926.2451292572786]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.468907946321016, "mean_inference_ms": 1.684316041173924, "mean_action_processing_ms": 0.7726841139102784, "mean_env_wait_ms": 9.810975380505116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013033390045166016, "StateBufferConnector_ms": 0.009675741195678711, "ViewRequirementAgentConnector_ms": 0.3189961910247803}, "num_episodes": 28, "episode_return_max": -761.1310366182719, "episode_return_min": -5450.135976920678, "episode_return_mean": -2696.4469126173813, "episodes_this_iter": 28}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1580813, "num_agent_steps_trained": 1580813, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.68096402252323, "num_env_steps_trained_throughput_per_sec": 73.68096402252323, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1580813, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1580813, "timers": {"training_iteration_time_ms": 53856.735, "restore_workers_time_ms": 0.028, "training_step_time_ms": 53856.663, "sample_time_ms": 3237.949, "learn_time_ms": 50560.402, "learn_throughput": 79.113, "synch_weights_time_ms": 55.489}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1580813, "num_agent_steps_trained": 1580813}, "done": false, "training_iteration": 92, "trial_id": "efc54_00000", "date": "2024-07-24_20-03-10", "timestamp": 1721831590, "time_this_iter_s": 54.29972553253174, "time_total_s": 4986.114905595779, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x717514106b00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4986.114905595779, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 9.815384615384616, "ram_util_percent": 24.09999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 153.44357498857312, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.106384694845157, "policy_loss": -0.00014691697904431052, "vf_loss": 4.129546405677509, "vf_explained_var": 0.9882023200504761, "kl": 0.011041729147213379, "entropy": 3.1399610810411307, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.7593984962406, "num_grad_updates_lifetime": 373785.5, "diff_num_grad_updates_vs_sampler_policy": 1994.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1597805, "num_agent_steps_trained": 1597805}, "env_runners": {"episode_reward_max": -761.1310366182719, "episode_reward_min": -5450.135976920678, "episode_reward_mean": -2788.803976305253, "episode_len_mean": 148.67, "episode_media": {}, "episodes_timesteps_total": 14867, "policy_reward_min": {"policy_0": -1555.2980647044649}, "policy_reward_max": {"policy_0": 2.558985731377639}, "policy_reward_mean": {"policy_0": -557.7607952610506}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3557.2692719043703, -3054.5940823423375, -4823.625999811512, -2854.4383415355487, -3104.63618322833, -1932.3127467652669, -2623.808387103748, -1579.5189697620003, -2959.974506971931, -2858.1685991769086, -963.5946680376575, -3031.98724517997, -2837.445063416495, -5450.135976920678, -3111.678516070298, -2043.6253898387085, -2894.6576482376245, -3151.670286365411, -2220.6079686825315, -1756.544417022647, -3185.5471905662625, -2400.8435674532298, -2103.050125145876, -3068.174592874948, -1355.3142503044946, -2801.178753899577, -1350.7503314210446, -2549.8829547260384, -2687.6533520033195, -3027.9470256387053, -3457.950859714276, -1569.0036454772733, -4059.470290932733, -2672.320376221853, -4100.0363981148175, -1874.142790804567, -3097.7019458415016, -2668.997052466625, -5130.303520031657, -2761.5047564191646, -2924.884140724889, -1994.6961223774726, -2351.9644741097054, -2209.056965546929, -1795.0152814596113, -3662.6812257531706, -1967.0051713686048, -2998.7965182151966, -3688.44352250919, -3156.37198907387, -1747.7998067383178, -2475.8600180743038, -3277.8475909421795, -761.1310366182719, -1243.0347941937396, -2211.60140449684, -1901.8326119804929, -1837.6036105990236, -3680.252349587452, -2508.1721672612907, -2158.34207933833, -3012.7964086578586, -3396.3013759339874, -4077.756488554139, -2061.9314571152295, -2409.0683985316514, -3382.1666963748476, -3856.3252028937677, -2859.092212673053, -3956.065616866915, -3224.3559882346303, -2364.0728249456665, -2300.342261057215, -1362.6775865665338, -2020.9301185190436, -3351.7065104775324, -3526.782437780865, -2823.7501277638553, -3459.16936923487, -2144.9627465331405, -2675.641680915261, -2074.354875604977, -2881.7098210035324, -4819.280802406342, -1881.4913209132624, -1285.124691624138, -2958.6196712162264, -2462.576675322274, -2842.092381324636, -3396.9531975032696, -2523.058988918187, -1529.9427343067052, -2955.6176033742126, -2407.5813573544847, -3785.350922704068, -5028.205742388226, -3437.797949522134, -2990.9618273002725, -3442.5225813925217, -4626.798047314915], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 147, 150, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 91, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-76.50097828594673, -389.3884363644379, -984.2556395513553, -1100.9883055279606, -1006.1359121746689, -40.25025464924669, -762.8830118971551, -484.79890214300076, -1361.56358568169, -405.09832797124585, -840.4714719336492, -1429.9267791268578, -279.5227290461671, -1390.9360474001587, -882.7689723046739, -534.7227571613075, -280.29750135839987, -1024.921501612781, -968.0323480796123, -46.464233323447175, -446.70521842277924, -152.13461671682947, -1251.535940731149, -140.18303291218203, -1114.07737444539, -842.3808092311219, -740.4413373412098, -160.2250609818171, -178.7020538063667, -10.563485404749784, -219.00177241049693, -1076.2862938055837, -407.22000603950016, -444.1400727250548, -477.16024212311066, -514.8594777248738, -229.66694089176116, -511.2291857855954, -166.97339422270565, -156.78997113706308, -500.43728952550487, -1020.7662147049505, -293.55530467784934, -1033.5130841514078, -111.70261391221739, -91.58968738756055, -752.3328902277175, -101.61940507632265, -965.4412874572432, -947.1853290280652, -71.89489536183414, -204.54560925901515, -256.71449766064956, -26.828207252924823, -403.61145850323334, -1138.969606031945, -772.7167744378231, -159.71044028082258, -341.0929387638906, -619.4974856654935, -296.1126112945055, -946.6916681237412, -76.90510669760259, -1330.115542369399, -187.6201349312453, -1555.2980647044649, -1047.9580403834052, -1100.6143869866269, -1284.9278588499137, -461.33762599626715, -1367.1317955932066, -387.7228053525506, -1226.5489007953568, -85.24885613822977, -45.0261581909526, -1173.0484876464627, -108.13254705459464, -634.2075186768553, -17.59331682999116, -110.64351963080581, -620.8841076855463, -477.87932977328927, -460.0177470658973, -428.16890672851827, -907.707556984372, -468.26389004960413, -473.50881851733254, -677.9393834934864, -1341.5130866456666, -190.4451076593227, -814.5263262632175, -466.8058735755173, -685.1829732812635, -225.52526179076563, -28.567533771767337, -390.9678275325118, -21.598418118984178, -49.823021232589745, -95.43312287674236, -1198.7220272618179, -755.1106342828077, -771.6528473746542, -54.25318629110463, -1510.6472700586887, -93.8832525590068, -30.78493776294375, -34.195183900359744, -506.79381226511595, -827.251250832012, -1001.8183826927977, -788.1356908509757, -152.7405823195276, -118.23149512534617, -623.2032555680587, -420.7391012819668, -889.0058299134125, -126.20433202555778, -119.7207887264775, -871.1197291621488, -1062.123913047352, -47.34749454857528, -364.17253127689867, -218.04058515221786, -442.33922290881634, -283.41441641798656, -104.03478418174748, -836.8178796854565, -633.7970374351403, -1206.6201541473567, -19.908898449876343, -236.47283285906022, -15.12151423806636, -922.7680491992311, -100.23940644127602, -76.14852868341194, -587.5711188320399, -86.55154291369618, -324.4583474702035, -484.2890946965446, -1067.0128508135554, -277.46652461848254, -1169.191273576884, -35.12481517692996, -55.126134088259825, -1150.7446045427616, -1454.66798245663, -1233.0935224683446, -113.14919705972834, -162.857599475449, -64.17872417855283, -1319.2421449583046, -1160.8733730094432, -576.0886389775451, -123.41221974520464, -278.3344830237782, -344.31323187687383, -0.47362164613113744, -82.89192841916186, -857.9831356129079, -283.34172792219914, -442.6519033250347, -501.77383923275136, -1004.6173651648031, -1198.4642509404794, -911.9629322696679, -68.16890435710438, -585.9739482947778, -265.78035844887467, -405.10492449499696, -1347.2922406260989, -1336.1252423334652, -1131.479866331637, -372.2638089831033, -331.0112431513984, -929.1562373152099, -313.86055654206734, -155.8499288988237, -66.18242213633916, -1249.9684840163848, -88.28139921095321, -618.4168207632362, -1505.5971056307947, -41.39149116002032, -537.0744707699946, -395.22205751745355, -503.2490446961036, -582.0622600374084, -498.1636193731499, -83.07982595333088, -1002.442302406631, -1448.476329108593, -948.4492967596057, -636.0370263271552, -911.6020401601268, -1185.7388276761828, -126.57766682139184, -25.853360624176485, -1238.0817220408587, -114.75643706219091, -1256.2355698705478, -69.71273655163186, -128.3769835623329, -1425.251049430938, -1296.3800665663375, -5.163304613648394, -1232.3973662081107, -79.46713028649161, -41.09661054341571, -147.70198762174763, -494.0330277177073, -208.05384261666563, -124.79686067062583, -598.1804623426286, -251.78701623591095, -1169.146292243874, -95.56337149424988, -611.2252323695457, -282.93224517717255, -1074.0422740373895, -145.29384246857134, -891.1175277965223, -154.60516501801524, -167.77069788255199, -540.9854345939278, -40.53645616859333, -497.1115324416644, -24.524192725753363, -1009.2774591581951, -1291.2726232500463, -840.4954181775063, -229.39718922856505, -849.9024767490362, -187.12641245473392, -297.35921424334583, -403.2198786929248, -1303.0178307220738, -75.817585570108, -1114.7980645982975, -48.73491193402509, -456.42812539068996, -925.4713070652144, -105.64102837492177, -1015.064520539115, -1167.0837766495904, -475.1828898803466, -1354.9954080256507, -144.17477897389423, -97.3470885100439, -1047.899433829275, -511.9552797350044, -283.15071421208637, -595.9198534256966, -425.20605551497306, -409.5091693129496, -34.0140142726115, -89.19390369911277, -504.6594707964309, -292.68296800800357, -1148.867462255579, -440.4562133151821, -1002.9438454331888, -151.822524845235, -811.4084130332643, -1056.6837188805257, -254.98908874996673, -34.19270628540103, -67.93962518754854, -146.2312335945421, -285.3623020017431, -227.405169549037, -146.82485823138126, -334.7689450334342, -209.63663544290182, -360.6233947348845, -191.18096075113863, -564.9881298731859, -432.15673192033836, -44.61893937684692, -206.89141933494847, -962.9461839915213, -469.18370914365875, -700.2993901919349, -119.66184838791169, -485.25659297417513, -127.43107128281328, -60.38995530120421, -348.5030497682257, -752.3678854521575, -236.6175080946993, -439.7252119827352, -803.9188745251477, -775.5392246730333, -607.3591994763995, -900.172363297347, -593.2626876155243, -78.82266304192775, -705.1492155875809, -152.0636368452165, -1037.253467505098, -534.883184281469, -137.36991254290214, -263.9744992005203, -282.42467325294444, -661.7557366782414, -812.8172576637231, -187.82772198179003, -1322.85043769447, -155.9181143179306, -1066.5088907136894, -279.69124394998005, -1068.267527995317, -962.4571760940167, -126.0488723960326, -708.5976823384525, -530.9301171101696, -592.6319127804364, -981.7617990380304, -1125.1265516502922, -1359.6554262552504, -18.5807988301258, -241.07949309763512, -869.3018183288445, -330.818724568924, -491.3353329880709, -129.39608813175465, -708.1001916073178, -822.9509136674757, -115.49730352918266, -645.4895643335503, -117.03042539412358, -690.8483570512855, -905.1706370077736, -312.50028098819234, -1426.8217685790105, -46.8256527485861, -288.9245764756092, -487.3295645148743, -1377.3588995907087, -1268.333885663995, -434.378276648578, -1449.2873805065217, -284.95423167548233, -327.4302006619854, -284.4632418207725, -512.957158008292, -1052.6096421247018, -257.39318547668665, -1279.8692106265755, -882.244843967244, -483.94873467170953, -707.3987726868311, -1210.7860241079209, -298.80671865782165, -246.40682283325444, -760.9576499488043, -172.64909375736806, -832.2288231502657, -106.23475366346756, -834.5425958296619, -418.417558544905, -72.12986908089604, -138.35115943868982, -216.7671194315414, -946.8489838488085, -926.2451292572786, -62.6510496590987, -900.9178692816635, -124.8940771819291, -104.8065719378792, -169.4080185059638, -32.33777733827946, -55.56194635131013, -94.18408508780693, -1116.4242293479128, -722.4220803937337, -213.12227253556767, -78.74692780126936, -868.1993667392856, -1016.949842390831, -1174.688101010579, -372.8439389445904, -11.475786795631599, -1054.7470974231196, -1090.4682508819349, -997.2473637355897, -3.066032681857733, -1271.437895387157, -131.41966914231347, -58.983742680888604, -1358.8427878716373, -736.3561236152008, -1044.3031983068852, -98.71916854822365, -885.9947446454014, -693.7961341191586, -322.78617370634765, -188.6248123366567, -505.61742745455854, -38.07810340430362, -1089.856229631274, -1534.8215483214951, -355.3206805628432, -22.307925281063643, -269.6382953186194, -493.5532314312389, -1005.6509177098503, -152.81500168225304, -171.55817281203065, -718.7415773313236, -25.589206069519125, -653.3288892220012, -243.9894839870424, -1151.4116043885667, -229.06675179745986, -603.9130916084616, -1545.173216018474, -1421.5534297009476, -157.54409835913734, -750.0442501365751, -944.9658081912098, -274.9877448339153, -228.71573453898012, -117.70034767126624, -142.1880837919611, -1117.8994100771374, -844.2248770691936, -26.020922194019995, -314.60959795967767, -43.61323600545788, -56.656058395788854, -1413.828086887846, -160.54971410147567, -1181.7056032637463, -71.36675710795046, -131.16950985520907, -18.642770893718996, -601.957624517862, -1060.4968017486015, -460.9207917170452, -320.5586864450456, -1056.7591311415176, -1257.1925929890808, -60.088934210427375, -173.17188643097043, -294.87983655264316, -89.06939485005064, -960.0144153675822, -1146.0550048494, -191.16821111204993, -1010.6461713241853, -1050.3551870833987, -754.0727383119065, -107.53993669276393, -410.79090754998504, -200.30021928013332, -1018.4476183118227, -166.45406916418858, 2.558985731377639, -323.29667933814846, -24.3033532239233, -1023.3556577757722, -553.8261331322175, -39.753280662773335, -1140.0434862977818, -198.63904550566716, -1041.56557406426, -315.3389528238251, -411.8845854350352, -283.3241601742194, -355.46808485714473, -409.8880529818091, -1211.4225757117854, -824.4502960199524, -108.28611022486811, -1231.303887765651, -1229.9541154064054, -1292.46227680436, -584.9102023560826, -1298.339166096745, -622.5399817246295, -660.9641435988029, -467.8610603584545, -5.351879301961056, -907.7613417387188, -1395.8595245241959, -163.89954008178833, -1036.0296655246268, -1013.8237230874234, -444.69886741579415, -332.5100311906392, -1244.4853426902562, -214.17783900864254, -221.09624859719466, -1368.2746178534226, -394.4885332430059, -731.9844063023826, -1332.8260332173274, -1193.633503252324, -695.3180574663876, -673.0360470764881]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4691638332962784, "mean_inference_ms": 1.685347577861844, "mean_action_processing_ms": 0.7722466108837461, "mean_env_wait_ms": 9.818419926610584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01342010498046875, "StateBufferConnector_ms": 0.009864091873168945, "ViewRequirementAgentConnector_ms": 0.3281123638153076}, "num_episodes": 27, "episode_return_max": -761.1310366182719, "episode_return_min": -5450.135976920678, "episode_return_mean": -2788.803976305253, "episodes_this_iter": 27}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1597805, "num_agent_steps_trained": 1597805, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.58471769170067, "num_env_steps_trained_throughput_per_sec": 73.58471769170067, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1597805, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1597805, "timers": {"training_iteration_time_ms": 54162.638, "restore_workers_time_ms": 0.028, "training_step_time_ms": 54162.566, "sample_time_ms": 3252.739, "learn_time_ms": 50851.093, "learn_throughput": 78.661, "synch_weights_time_ms": 55.912}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1597805, "num_agent_steps_trained": 1597805}, "done": false, "training_iteration": 93, "trial_id": "efc54_00000", "date": "2024-07-24_20-04-05", "timestamp": 1721831645, "time_this_iter_s": 54.37128043174744, "time_total_s": 5040.486186027527, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x717509f58ee0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5040.486186027527, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 10.583116883116885, "ram_util_percent": 24.20779220779221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 141.74632307311634, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.366945824858583, "policy_loss": 0.0008724169349182903, "vf_loss": 4.387627973262175, "vf_explained_var": 0.9881913518464124, "kl": 0.012291355510982455, "entropy": 3.0888314341910093, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.4, "num_grad_updates_lifetime": 377805.5, "diff_num_grad_updates_vs_sampler_policy": 2024.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1615004, "num_agent_steps_trained": 1615004}, "env_runners": {"episode_reward_max": -645.4816980735086, "episode_reward_min": -5130.303520031657, "episode_reward_mean": -2736.5321072747192, "episode_len_mean": 148.7, "episode_media": {}, "episodes_timesteps_total": 14870, "policy_reward_min": {"policy_0": -1545.173216018474}, "policy_reward_max": {"policy_0": 9.676213340995783}, "policy_reward_mean": {"policy_0": -547.3064214549437}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1350.7503314210446, -2549.8829547260384, -2687.6533520033195, -3027.9470256387053, -3457.950859714276, -1569.0036454772733, -4059.470290932733, -2672.320376221853, -4100.0363981148175, -1874.142790804567, -3097.7019458415016, -2668.997052466625, -5130.303520031657, -2761.5047564191646, -2924.884140724889, -1994.6961223774726, -2351.9644741097054, -2209.056965546929, -1795.0152814596113, -3662.6812257531706, -1967.0051713686048, -2998.7965182151966, -3688.44352250919, -3156.37198907387, -1747.7998067383178, -2475.8600180743038, -3277.8475909421795, -761.1310366182719, -1243.0347941937396, -2211.60140449684, -1901.8326119804929, -1837.6036105990236, -3680.252349587452, -2508.1721672612907, -2158.34207933833, -3012.7964086578586, -3396.3013759339874, -4077.756488554139, -2061.9314571152295, -2409.0683985316514, -3382.1666963748476, -3856.3252028937677, -2859.092212673053, -3956.065616866915, -3224.3559882346303, -2364.0728249456665, -2300.342261057215, -1362.6775865665338, -2020.9301185190436, -3351.7065104775324, -3526.782437780865, -2823.7501277638553, -3459.16936923487, -2144.9627465331405, -2675.641680915261, -2074.354875604977, -2881.7098210035324, -4819.280802406342, -1881.4913209132624, -1285.124691624138, -2958.6196712162264, -2462.576675322274, -2842.092381324636, -3396.9531975032696, -2523.058988918187, -1529.9427343067052, -2955.6176033742126, -2407.5813573544847, -3785.350922704068, -5028.205742388226, -3437.797949522134, -2990.9618273002725, -3442.5225813925217, -4626.798047314915, -2584.8595723116414, -2555.7846343391175, -3409.4874825956927, -2877.707191621459, -2228.904604396588, -3224.259362761599, -2030.0442710205164, -3775.004084950173, -1770.312491435942, -645.4816980735086, -2105.5666771733318, -2311.460337986001, -1544.7839558665785, -3852.2250553939875, -2408.2364389472114, -2187.5875005306257, -2206.3656226571925, -1826.6050739055138, -2518.2863261099246, -2590.1567994931115, -3552.932906710165, -2596.1245328642785, -2708.9719310113346, -3058.703680106938, -4349.779165873836, -1577.584447428687], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 91, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-236.47283285906022, -15.12151423806636, -922.7680491992311, -100.23940644127602, -76.14852868341194, -587.5711188320399, -86.55154291369618, -324.4583474702035, -484.2890946965446, -1067.0128508135554, -277.46652461848254, -1169.191273576884, -35.12481517692996, -55.126134088259825, -1150.7446045427616, -1454.66798245663, -1233.0935224683446, -113.14919705972834, -162.857599475449, -64.17872417855283, -1319.2421449583046, -1160.8733730094432, -576.0886389775451, -123.41221974520464, -278.3344830237782, -344.31323187687383, -0.47362164613113744, -82.89192841916186, -857.9831356129079, -283.34172792219914, -442.6519033250347, -501.77383923275136, -1004.6173651648031, -1198.4642509404794, -911.9629322696679, -68.16890435710438, -585.9739482947778, -265.78035844887467, -405.10492449499696, -1347.2922406260989, -1336.1252423334652, -1131.479866331637, -372.2638089831033, -331.0112431513984, -929.1562373152099, -313.86055654206734, -155.8499288988237, -66.18242213633916, -1249.9684840163848, -88.28139921095321, -618.4168207632362, -1505.5971056307947, -41.39149116002032, -537.0744707699946, -395.22205751745355, -503.2490446961036, -582.0622600374084, -498.1636193731499, -83.07982595333088, -1002.442302406631, -1448.476329108593, -948.4492967596057, -636.0370263271552, -911.6020401601268, -1185.7388276761828, -126.57766682139184, -25.853360624176485, -1238.0817220408587, -114.75643706219091, -1256.2355698705478, -69.71273655163186, -128.3769835623329, -1425.251049430938, -1296.3800665663375, -5.163304613648394, -1232.3973662081107, -79.46713028649161, -41.09661054341571, -147.70198762174763, -494.0330277177073, -208.05384261666563, -124.79686067062583, -598.1804623426286, -251.78701623591095, -1169.146292243874, -95.56337149424988, -611.2252323695457, -282.93224517717255, -1074.0422740373895, -145.29384246857134, -891.1175277965223, -154.60516501801524, -167.77069788255199, -540.9854345939278, -40.53645616859333, -497.1115324416644, -24.524192725753363, -1009.2774591581951, -1291.2726232500463, -840.4954181775063, -229.39718922856505, -849.9024767490362, -187.12641245473392, -297.35921424334583, -403.2198786929248, -1303.0178307220738, -75.817585570108, -1114.7980645982975, -48.73491193402509, -456.42812539068996, -925.4713070652144, -105.64102837492177, -1015.064520539115, -1167.0837766495904, -475.1828898803466, -1354.9954080256507, -144.17477897389423, -97.3470885100439, -1047.899433829275, -511.9552797350044, -283.15071421208637, -595.9198534256966, -425.20605551497306, -409.5091693129496, -34.0140142726115, -89.19390369911277, -504.6594707964309, -292.68296800800357, -1148.867462255579, -440.4562133151821, -1002.9438454331888, -151.822524845235, -811.4084130332643, -1056.6837188805257, -254.98908874996673, -34.19270628540103, -67.93962518754854, -146.2312335945421, -285.3623020017431, -227.405169549037, -146.82485823138126, -334.7689450334342, -209.63663544290182, -360.6233947348845, -191.18096075113863, -564.9881298731859, -432.15673192033836, -44.61893937684692, -206.89141933494847, -962.9461839915213, -469.18370914365875, -700.2993901919349, -119.66184838791169, -485.25659297417513, -127.43107128281328, -60.38995530120421, -348.5030497682257, -752.3678854521575, -236.6175080946993, -439.7252119827352, -803.9188745251477, -775.5392246730333, -607.3591994763995, -900.172363297347, -593.2626876155243, -78.82266304192775, -705.1492155875809, -152.0636368452165, -1037.253467505098, -534.883184281469, -137.36991254290214, -263.9744992005203, -282.42467325294444, -661.7557366782414, -812.8172576637231, -187.82772198179003, -1322.85043769447, -155.9181143179306, -1066.5088907136894, -279.69124394998005, -1068.267527995317, -962.4571760940167, -126.0488723960326, -708.5976823384525, -530.9301171101696, -592.6319127804364, -981.7617990380304, -1125.1265516502922, -1359.6554262552504, -18.5807988301258, -241.07949309763512, -869.3018183288445, -330.818724568924, -491.3353329880709, -129.39608813175465, -708.1001916073178, -822.9509136674757, -115.49730352918266, -645.4895643335503, -117.03042539412358, -690.8483570512855, -905.1706370077736, -312.50028098819234, -1426.8217685790105, -46.8256527485861, -288.9245764756092, -487.3295645148743, -1377.3588995907087, -1268.333885663995, -434.378276648578, -1449.2873805065217, -284.95423167548233, -327.4302006619854, -284.4632418207725, -512.957158008292, -1052.6096421247018, -257.39318547668665, -1279.8692106265755, -882.244843967244, -483.94873467170953, -707.3987726868311, -1210.7860241079209, -298.80671865782165, -246.40682283325444, -760.9576499488043, -172.64909375736806, -832.2288231502657, -106.23475366346756, -834.5425958296619, -418.417558544905, -72.12986908089604, -138.35115943868982, -216.7671194315414, -946.8489838488085, -926.2451292572786, -62.6510496590987, -900.9178692816635, -124.8940771819291, -104.8065719378792, -169.4080185059638, -32.33777733827946, -55.56194635131013, -94.18408508780693, -1116.4242293479128, -722.4220803937337, -213.12227253556767, -78.74692780126936, -868.1993667392856, -1016.949842390831, -1174.688101010579, -372.8439389445904, -11.475786795631599, -1054.7470974231196, -1090.4682508819349, -997.2473637355897, -3.066032681857733, -1271.437895387157, -131.41966914231347, -58.983742680888604, -1358.8427878716373, -736.3561236152008, -1044.3031983068852, -98.71916854822365, -885.9947446454014, -693.7961341191586, -322.78617370634765, -188.6248123366567, -505.61742745455854, -38.07810340430362, -1089.856229631274, -1534.8215483214951, -355.3206805628432, -22.307925281063643, -269.6382953186194, -493.5532314312389, -1005.6509177098503, -152.81500168225304, -171.55817281203065, -718.7415773313236, -25.589206069519125, -653.3288892220012, -243.9894839870424, -1151.4116043885667, -229.06675179745986, -603.9130916084616, -1545.173216018474, -1421.5534297009476, -157.54409835913734, -750.0442501365751, -944.9658081912098, -274.9877448339153, -228.71573453898012, -117.70034767126624, -142.1880837919611, -1117.8994100771374, -844.2248770691936, -26.020922194019995, -314.60959795967767, -43.61323600545788, -56.656058395788854, -1413.828086887846, -160.54971410147567, -1181.7056032637463, -71.36675710795046, -131.16950985520907, -18.642770893718996, -601.957624517862, -1060.4968017486015, -460.9207917170452, -320.5586864450456, -1056.7591311415176, -1257.1925929890808, -60.088934210427375, -173.17188643097043, -294.87983655264316, -89.06939485005064, -960.0144153675822, -1146.0550048494, -191.16821111204993, -1010.6461713241853, -1050.3551870833987, -754.0727383119065, -107.53993669276393, -410.79090754998504, -200.30021928013332, -1018.4476183118227, -166.45406916418858, 2.558985731377639, -323.29667933814846, -24.3033532239233, -1023.3556577757722, -553.8261331322175, -39.753280662773335, -1140.0434862977818, -198.63904550566716, -1041.56557406426, -315.3389528238251, -411.8845854350352, -283.3241601742194, -355.46808485714473, -409.8880529818091, -1211.4225757117854, -824.4502960199524, -108.28611022486811, -1231.303887765651, -1229.9541154064054, -1292.46227680436, -584.9102023560826, -1298.339166096745, -622.5399817246295, -660.9641435988029, -467.8610603584545, -5.351879301961056, -907.7613417387188, -1395.8595245241959, -163.89954008178833, -1036.0296655246268, -1013.8237230874234, -444.69886741579415, -332.5100311906392, -1244.4853426902562, -214.17783900864254, -221.09624859719466, -1368.2746178534226, -394.4885332430059, -731.9844063023826, -1332.8260332173274, -1193.633503252324, -695.3180574663876, -673.0360470764881, -1001.3857661177113, -199.79457129043743, -1302.481743459461, -73.68808219068335, -7.509409253346694, -194.44284011653536, -892.8518192983232, -1284.9142731822944, -174.86522038898997, -8.710481352973488, -1152.900878179126, -732.3579327353764, -36.303219257176224, -352.2292753181783, -1135.6961771058388, -451.8900544517527, -1222.009859004983, -836.5840793704992, -236.2890886198231, -130.9341101743992, -340.716178093222, -921.2980694679939, -116.97897977385854, -674.9569565255398, -174.9544205359744, -983.2214708686371, -1334.4538655520273, -159.67264875577828, -598.2006402310863, -148.71073735407234, -109.09528530233173, -122.24105006596406, -441.4122553410376, -433.00895640145677, -924.2867239097266, -976.0475761420515, -1253.2254010121999, -463.71455705756665, -911.121191831285, -170.89535890706847, -410.9523896490648, -103.43231511905394, -109.06100926629199, -815.4367908005023, -331.4299866010278, -145.42329307419962, -94.45631663059142, -215.86611707118786, -151.73411282905408, -38.001858468475845, -358.6567684376213, -228.18433131443464, -146.01913044752058, -998.5908717533437, -374.1155752204108, -651.6203913838267, -78.06064691621802, -1079.1957733883758, -53.69577229381995, -448.8877540037598, -387.1196355845567, -293.5898718538699, -380.28867086986287, -309.6958726840393, -174.08990487425083, -193.3872739210441, -1476.0097251423238, -731.4096714920543, -731.2458885031476, -720.172496335417, -805.636376042668, -75.61200246308093, -1281.5550286029343, -149.88885541510527, -95.54417642342378, -89.99100649983605, 9.676213340995783, -758.0750984579217, -1179.7923511202077, -169.40525779365572, -628.2029073645112, -647.9071871122927, -721.8620434767487, -67.10632532260574, -141.28715938103238, -1059.9041291960123, -338.95657843851217, -301.1014613564256, -13.605543378231081, -113.037361536333, -134.09210553529613, -252.78406563333024, -1131.2836135950874, -444.1349724199904, -555.9915689262194, -1336.1593036594004, -106.08504117746764, -68.18781992125776, -806.4936414415795, -273.2309932934066, -41.78090106673133, -1221.32036052375, -249.69371771289624, -1256.2336607001025, -783.9042667066839, -656.6980610550676, -620.3186244123154, -36.59177366837195, -41.948330123021336, -1240.5677436055025, -1124.7885516368488, -554.3082427602284, -71.1204895188694, -730.4448839040292, -228.30976319135976, -1271.9321560732353, -22.153666154610033, -82.176418313687, -515.2405955915432, -1167.2008439738606, -751.2123788427554, -203.61715249515368, -1409.162973797091, -962.6551543614014, -1023.1315063774326, -245.2206115396958, -203.72660084386098, -858.5273306631148, -7.6323503977163725, -262.4775539842999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4684585794096652, "mean_inference_ms": 1.6842627426645154, "mean_action_processing_ms": 0.7717569814548088, "mean_env_wait_ms": 9.806914162720368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013226985931396484, "StateBufferConnector_ms": 0.00950002670288086, "ViewRequirementAgentConnector_ms": 0.31218647956848145}, "num_episodes": 26, "episode_return_max": -645.4816980735086, "episode_return_min": -5130.303520031657, "episode_return_mean": -2736.5321072747192, "episodes_this_iter": 26}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1615004, "num_agent_steps_trained": 1615004, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.24431400582642, "num_env_steps_trained_throughput_per_sec": 73.24431400582642, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1615004, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1615004, "timers": {"training_iteration_time_ms": 54221.005, "restore_workers_time_ms": 0.027, "training_step_time_ms": 54220.934, "sample_time_ms": 3279.341, "learn_time_ms": 50882.646, "learn_throughput": 78.612, "synch_weights_time_ms": 56.11}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1615004, "num_agent_steps_trained": 1615004}, "done": false, "training_iteration": 94, "trial_id": "efc54_00000", "date": "2024-07-24_20-04-59", "timestamp": 1721831699, "time_this_iter_s": 54.62222909927368, "time_total_s": 5095.1084151268005, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d7af6d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5095.1084151268005, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 11.919480519480521, "ram_util_percent": 24.407792207792202}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 133.64218350087717, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.3556964853034374, "policy_loss": -0.002412659211176668, "vf_loss": 4.380925251327398, "vf_explained_var": 0.9851095481228282, "kl": 0.010566585673447034, "entropy": 3.0840109214831246, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.19847328244275, "num_grad_updates_lifetime": 381795.5, "diff_num_grad_updates_vs_sampler_policy": 1964.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1631667, "num_agent_steps_trained": 1631667}, "env_runners": {"episode_reward_max": -645.4816980735086, "episode_reward_min": -5028.205742388226, "episode_reward_mean": -2711.0873078874433, "episode_len_mean": 148.97, "episode_media": {}, "episodes_timesteps_total": 14897, "policy_reward_min": {"policy_0": -1566.918178113122}, "policy_reward_max": {"policy_0": 9.676213340995783}, "policy_reward_mean": {"policy_0": -542.2174615774888}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1243.0347941937396, -2211.60140449684, -1901.8326119804929, -1837.6036105990236, -3680.252349587452, -2508.1721672612907, -2158.34207933833, -3012.7964086578586, -3396.3013759339874, -4077.756488554139, -2061.9314571152295, -2409.0683985316514, -3382.1666963748476, -3856.3252028937677, -2859.092212673053, -3956.065616866915, -3224.3559882346303, -2364.0728249456665, -2300.342261057215, -1362.6775865665338, -2020.9301185190436, -3351.7065104775324, -3526.782437780865, -2823.7501277638553, -3459.16936923487, -2144.9627465331405, -2675.641680915261, -2074.354875604977, -2881.7098210035324, -4819.280802406342, -1881.4913209132624, -1285.124691624138, -2958.6196712162264, -2462.576675322274, -2842.092381324636, -3396.9531975032696, -2523.058988918187, -1529.9427343067052, -2955.6176033742126, -2407.5813573544847, -3785.350922704068, -5028.205742388226, -3437.797949522134, -2990.9618273002725, -3442.5225813925217, -4626.798047314915, -2584.8595723116414, -2555.7846343391175, -3409.4874825956927, -2877.707191621459, -2228.904604396588, -3224.259362761599, -2030.0442710205164, -3775.004084950173, -1770.312491435942, -645.4816980735086, -2105.5666771733318, -2311.460337986001, -1544.7839558665785, -3852.2250553939875, -2408.2364389472114, -2187.5875005306257, -2206.3656226571925, -1826.6050739055138, -2518.2863261099246, -2590.1567994931115, -3552.932906710165, -2596.1245328642785, -2708.9719310113346, -3058.703680106938, -4349.779165873836, -1577.584447428687, -1371.8237460720893, -1428.0118925153806, -3324.6329025000605, -2964.4502831642994, -2899.446613276131, -3876.2207627021503, -3243.499503027607, -2728.9125034119893, -3668.233025937848, -1923.2436031052107, -2004.9080543578684, -693.019990352772, -3124.014127640958, -830.554357278061, -2005.338410461086, -3000.112613623942, -2904.5608697570306, -3005.7969621216807, -2553.0663219058965, -3960.4111081100173, -1855.1956440482193, -3753.2558995378395, -2616.4970846322854, -2033.4905063780118, -3936.4310085673833, -3677.985098149074, -1672.6149673468392, -2419.0113646160808], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 140, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 150], "policy_policy_0_reward": [-146.82485823138126, -334.7689450334342, -209.63663544290182, -360.6233947348845, -191.18096075113863, -564.9881298731859, -432.15673192033836, -44.61893937684692, -206.89141933494847, -962.9461839915213, -469.18370914365875, -700.2993901919349, -119.66184838791169, -485.25659297417513, -127.43107128281328, -60.38995530120421, -348.5030497682257, -752.3678854521575, -236.6175080946993, -439.7252119827352, -803.9188745251477, -775.5392246730333, -607.3591994763995, -900.172363297347, -593.2626876155243, -78.82266304192775, -705.1492155875809, -152.0636368452165, -1037.253467505098, -534.883184281469, -137.36991254290214, -263.9744992005203, -282.42467325294444, -661.7557366782414, -812.8172576637231, -187.82772198179003, -1322.85043769447, -155.9181143179306, -1066.5088907136894, -279.69124394998005, -1068.267527995317, -962.4571760940167, -126.0488723960326, -708.5976823384525, -530.9301171101696, -592.6319127804364, -981.7617990380304, -1125.1265516502922, -1359.6554262552504, -18.5807988301258, -241.07949309763512, -869.3018183288445, -330.818724568924, -491.3353329880709, -129.39608813175465, -708.1001916073178, -822.9509136674757, -115.49730352918266, -645.4895643335503, -117.03042539412358, -690.8483570512855, -905.1706370077736, -312.50028098819234, -1426.8217685790105, -46.8256527485861, -288.9245764756092, -487.3295645148743, -1377.3588995907087, -1268.333885663995, -434.378276648578, -1449.2873805065217, -284.95423167548233, -327.4302006619854, -284.4632418207725, -512.957158008292, -1052.6096421247018, -257.39318547668665, -1279.8692106265755, -882.244843967244, -483.94873467170953, -707.3987726868311, -1210.7860241079209, -298.80671865782165, -246.40682283325444, -760.9576499488043, -172.64909375736806, -832.2288231502657, -106.23475366346756, -834.5425958296619, -418.417558544905, -72.12986908089604, -138.35115943868982, -216.7671194315414, -946.8489838488085, -926.2451292572786, -62.6510496590987, -900.9178692816635, -124.8940771819291, -104.8065719378792, -169.4080185059638, -32.33777733827946, -55.56194635131013, -94.18408508780693, -1116.4242293479128, -722.4220803937337, -213.12227253556767, -78.74692780126936, -868.1993667392856, -1016.949842390831, -1174.688101010579, -372.8439389445904, -11.475786795631599, -1054.7470974231196, -1090.4682508819349, -997.2473637355897, -3.066032681857733, -1271.437895387157, -131.41966914231347, -58.983742680888604, -1358.8427878716373, -736.3561236152008, -1044.3031983068852, -98.71916854822365, -885.9947446454014, -693.7961341191586, -322.78617370634765, -188.6248123366567, -505.61742745455854, -38.07810340430362, -1089.856229631274, -1534.8215483214951, -355.3206805628432, -22.307925281063643, -269.6382953186194, -493.5532314312389, -1005.6509177098503, -152.81500168225304, -171.55817281203065, -718.7415773313236, -25.589206069519125, -653.3288892220012, -243.9894839870424, -1151.4116043885667, -229.06675179745986, -603.9130916084616, -1545.173216018474, -1421.5534297009476, -157.54409835913734, -750.0442501365751, -944.9658081912098, -274.9877448339153, -228.71573453898012, -117.70034767126624, -142.1880837919611, -1117.8994100771374, -844.2248770691936, -26.020922194019995, -314.60959795967767, -43.61323600545788, -56.656058395788854, -1413.828086887846, -160.54971410147567, -1181.7056032637463, -71.36675710795046, -131.16950985520907, -18.642770893718996, -601.957624517862, -1060.4968017486015, -460.9207917170452, -320.5586864450456, -1056.7591311415176, -1257.1925929890808, -60.088934210427375, -173.17188643097043, -294.87983655264316, -89.06939485005064, -960.0144153675822, -1146.0550048494, -191.16821111204993, -1010.6461713241853, -1050.3551870833987, -754.0727383119065, -107.53993669276393, -410.79090754998504, -200.30021928013332, -1018.4476183118227, -166.45406916418858, 2.558985731377639, -323.29667933814846, -24.3033532239233, -1023.3556577757722, -553.8261331322175, -39.753280662773335, -1140.0434862977818, -198.63904550566716, -1041.56557406426, -315.3389528238251, -411.8845854350352, -283.3241601742194, -355.46808485714473, -409.8880529818091, -1211.4225757117854, -824.4502960199524, -108.28611022486811, -1231.303887765651, -1229.9541154064054, -1292.46227680436, -584.9102023560826, -1298.339166096745, -622.5399817246295, -660.9641435988029, -467.8610603584545, -5.351879301961056, -907.7613417387188, -1395.8595245241959, -163.89954008178833, -1036.0296655246268, -1013.8237230874234, -444.69886741579415, -332.5100311906392, -1244.4853426902562, -214.17783900864254, -221.09624859719466, -1368.2746178534226, -394.4885332430059, -731.9844063023826, -1332.8260332173274, -1193.633503252324, -695.3180574663876, -673.0360470764881, -1001.3857661177113, -199.79457129043743, -1302.481743459461, -73.68808219068335, -7.509409253346694, -194.44284011653536, -892.8518192983232, -1284.9142731822944, -174.86522038898997, -8.710481352973488, -1152.900878179126, -732.3579327353764, -36.303219257176224, -352.2292753181783, -1135.6961771058388, -451.8900544517527, -1222.009859004983, -836.5840793704992, -236.2890886198231, -130.9341101743992, -340.716178093222, -921.2980694679939, -116.97897977385854, -674.9569565255398, -174.9544205359744, -983.2214708686371, -1334.4538655520273, -159.67264875577828, -598.2006402310863, -148.71073735407234, -109.09528530233173, -122.24105006596406, -441.4122553410376, -433.00895640145677, -924.2867239097266, -976.0475761420515, -1253.2254010121999, -463.71455705756665, -911.121191831285, -170.89535890706847, -410.9523896490648, -103.43231511905394, -109.06100926629199, -815.4367908005023, -331.4299866010278, -145.42329307419962, -94.45631663059142, -215.86611707118786, -151.73411282905408, -38.001858468475845, -358.6567684376213, -228.18433131443464, -146.01913044752058, -998.5908717533437, -374.1155752204108, -651.6203913838267, -78.06064691621802, -1079.1957733883758, -53.69577229381995, -448.8877540037598, -387.1196355845567, -293.5898718538699, -380.28867086986287, -309.6958726840393, -174.08990487425083, -193.3872739210441, -1476.0097251423238, -731.4096714920543, -731.2458885031476, -720.172496335417, -805.636376042668, -75.61200246308093, -1281.5550286029343, -149.88885541510527, -95.54417642342378, -89.99100649983605, 9.676213340995783, -758.0750984579217, -1179.7923511202077, -169.40525779365572, -628.2029073645112, -647.9071871122927, -721.8620434767487, -67.10632532260574, -141.28715938103238, -1059.9041291960123, -338.95657843851217, -301.1014613564256, -13.605543378231081, -113.037361536333, -134.09210553529613, -252.78406563333024, -1131.2836135950874, -444.1349724199904, -555.9915689262194, -1336.1593036594004, -106.08504117746764, -68.18781992125776, -806.4936414415795, -273.2309932934066, -41.78090106673133, -1221.32036052375, -249.69371771289624, -1256.2336607001025, -783.9042667066839, -656.6980610550676, -620.3186244123154, -36.59177366837195, -41.948330123021336, -1240.5677436055025, -1124.7885516368488, -554.3082427602284, -71.1204895188694, -730.4448839040292, -228.30976319135976, -1271.9321560732353, -22.153666154610033, -82.176418313687, -515.2405955915432, -1167.2008439738606, -751.2123788427554, -203.61715249515368, -1409.162973797091, -962.6551543614014, -1023.1315063774326, -245.2206115396958, -203.72660084386098, -858.5273306631148, -7.6323503977163725, -262.4775539842999, -182.99600012362947, -100.54161761904197, -226.0113365379588, -351.4398008056456, -510.83499098581416, -194.99297385040632, -27.193986199455427, -845.2266504520711, -152.2854146507661, -208.31286736268072, -896.0171301554342, -870.1318655745248, -153.17104387402156, -311.88862701701396, -1093.4242358790652, -663.7611446207787, -109.69047165670617, -1006.3369815336538, -802.1157848828966, -382.5459004702637, -180.2340984617509, -882.3301518193639, -164.24802162509562, -1318.5022318664164, -354.1321095035065, -866.0454800781641, -1316.5494013774453, -526.2166839980889, -52.3630444923084, -1115.0461527561422, -406.5031765748691, -1341.2324054338887, -190.656583215536, -454.70798260176093, -850.3993552015517, -797.7323915790197, -754.8529970598655, -300.894250861455, -815.4257031912205, -60.007160720428104, -1324.943538773233, -1183.6637571410886, -652.0503377880405, -151.66276388480722, -355.91262835067954, -273.8149736336355, -1003.9213161020158, -227.1681231281879, -397.3470004743478, -20.99218976702601, -666.5162096048077, -288.76244744333434, -43.193158440766304, -864.7986897680173, -141.63754910094232, -410.07658282703835, -11.992611494570525, -221.12928647789707, -16.396862307152222, -33.424647246114354, -520.304957656976, -422.1872008430566, -1356.480668588642, -157.3464358806519, -667.6948646716331, -108.34445296074608, -163.08685572820306, -41.27740196234687, -29.062460645911326, -488.7831859808532, -864.7424350306525, -257.47534302796913, -35.77826125905642, -161.23857936702902, -686.1037917763781, -506.3225299552288, -816.1495909959738, -134.98174448805483, -114.78252781368751, -1427.8762203709973, -700.7564100008353, -735.2750054863951, -521.180511133952, -754.0435309040174, -193.3054122318303, -704.5487050346298, -1070.993750573151, -723.0821053567972, -432.9549093439987, -74.21749181310697, -136.62594469434953, -612.4362170200493, -311.9873886992726, -708.0922167510366, -783.9245547411916, -599.5427416711043, -1352.7755996929573, -515.0352369967279, -1135.0357610906117, -358.02176865861435, -857.4949817221969, -57.37441088020228, -360.01719974672494, -298.3229767127979, -281.9860749862961, -188.20137580543135, -365.3107083862374, -990.7801751002862, -1126.4343557276193, -1082.5292845182657, -384.1662807106397, -87.03177028519177, -1107.0049160399972, -41.85703277210988, -996.4370848243473, -74.87444626782037, -21.69732487226472, -140.35889381531422, -1566.918178113122, -229.6416633094906, -1211.8175317084444, -501.0270718685011, -629.9849357094015, -309.7609108559484, -1283.8405584250875, -1024.1597277945057, -415.47363667981546, -557.4830305885617, -899.1233238060951, -781.7453792800942, -628.9278430086821, -264.1516215392577, -310.02127106845285, -402.0577303827392, -67.45650134770645, -523.0734416163963, -1109.2081031769114, -456.97693443392495, -331.05433037917396, 1.3014449903272038]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.467308174884056, "mean_inference_ms": 1.6840139867321195, "mean_action_processing_ms": 0.771198275007243, "mean_env_wait_ms": 9.80562976255057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01357412338256836, "StateBufferConnector_ms": 0.009578466415405273, "ViewRequirementAgentConnector_ms": 0.31482434272766113}, "num_episodes": 28, "episode_return_max": -645.4816980735086, "episode_return_min": -5028.205742388226, "episode_return_mean": -2711.0873078874433, "episodes_this_iter": 28}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1631667, "num_agent_steps_trained": 1631667, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.43410698672828, "num_env_steps_trained_throughput_per_sec": 73.43410698672828, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1631667, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1631667, "timers": {"training_iteration_time_ms": 54110.193, "restore_workers_time_ms": 0.027, "training_step_time_ms": 54110.123, "sample_time_ms": 3275.049, "learn_time_ms": 50776.775, "learn_throughput": 78.776, "synch_weights_time_ms": 55.458}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1631667, "num_agent_steps_trained": 1631667}, "done": false, "training_iteration": 95, "trial_id": "efc54_00000", "date": "2024-07-24_20-05-54", "timestamp": 1721831754, "time_this_iter_s": 54.48152995109558, "time_total_s": 5149.589945077896, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x717514113760>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5149.589945077896, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 10.070512820512821, "ram_util_percent": 24.606410256410246}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 133.92093952093552, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000002, "total_loss": 4.383030483022851, "policy_loss": -0.006174593200210357, "vf_loss": 4.411804908009904, "vf_explained_var": 0.9918130382524794, "kl": 0.010566708761188016, "entropy": 3.062392181306336, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.41044776119404, "num_grad_updates_lifetime": 385770.5, "diff_num_grad_updates_vs_sampler_policy": 2009.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1648740, "num_agent_steps_trained": 1648740}, "env_runners": {"episode_reward_max": -645.4816980735086, "episode_reward_min": -5028.205742388226, "episode_reward_mean": -2760.1641993851495, "episode_len_mean": 148.77, "episode_media": {}, "episodes_timesteps_total": 14877, "policy_reward_min": {"policy_0": -1577.599671388818}, "policy_reward_max": {"policy_0": 9.676213340995783}, "policy_reward_mean": {"policy_0": -552.0328398770299}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2881.7098210035324, -4819.280802406342, -1881.4913209132624, -1285.124691624138, -2958.6196712162264, -2462.576675322274, -2842.092381324636, -3396.9531975032696, -2523.058988918187, -1529.9427343067052, -2955.6176033742126, -2407.5813573544847, -3785.350922704068, -5028.205742388226, -3437.797949522134, -2990.9618273002725, -3442.5225813925217, -4626.798047314915, -2584.8595723116414, -2555.7846343391175, -3409.4874825956927, -2877.707191621459, -2228.904604396588, -3224.259362761599, -2030.0442710205164, -3775.004084950173, -1770.312491435942, -645.4816980735086, -2105.5666771733318, -2311.460337986001, -1544.7839558665785, -3852.2250553939875, -2408.2364389472114, -2187.5875005306257, -2206.3656226571925, -1826.6050739055138, -2518.2863261099246, -2590.1567994931115, -3552.932906710165, -2596.1245328642785, -2708.9719310113346, -3058.703680106938, -4349.779165873836, -1577.584447428687, -1371.8237460720893, -1428.0118925153806, -3324.6329025000605, -2964.4502831642994, -2899.446613276131, -3876.2207627021503, -3243.499503027607, -2728.9125034119893, -3668.233025937848, -1923.2436031052107, -2004.9080543578684, -693.019990352772, -3124.014127640958, -830.554357278061, -2005.338410461086, -3000.112613623942, -2904.5608697570306, -3005.7969621216807, -2553.0663219058965, -3960.4111081100173, -1855.1956440482193, -3753.2558995378395, -2616.4970846322854, -2033.4905063780118, -3936.4310085673833, -3677.985098149074, -1672.6149673468392, -2419.0113646160808, -2750.750912373392, -3296.6485426211975, -3415.450458863726, -2565.9928083601494, -1674.7013049914813, -4655.187878018492, -4203.268627957222, -4497.237985564093, -4686.618271162497, -3492.792862552168, -1806.2605056314947, -2770.9104014816753, -1899.8143341998841, -3181.265046164625, -3857.6035058691264, -3166.4514173011626, -1829.9019441088035, -1180.8854680430197, -1123.859459705354, -2214.98781539597, -3347.976637878598, -3558.36924749114, -4571.335754118182, -1318.3537482406834, -3528.068493903168, -1234.931472898916, -2965.3676571376764, -1993.7859904288714], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 140, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 150, 150, 150, 150, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-653.3288892220012, -243.9894839870424, -1151.4116043885667, -229.06675179745986, -603.9130916084616, -1545.173216018474, -1421.5534297009476, -157.54409835913734, -750.0442501365751, -944.9658081912098, -274.9877448339153, -228.71573453898012, -117.70034767126624, -142.1880837919611, -1117.8994100771374, -844.2248770691936, -26.020922194019995, -314.60959795967767, -43.61323600545788, -56.656058395788854, -1413.828086887846, -160.54971410147567, -1181.7056032637463, -71.36675710795046, -131.16950985520907, -18.642770893718996, -601.957624517862, -1060.4968017486015, -460.9207917170452, -320.5586864450456, -1056.7591311415176, -1257.1925929890808, -60.088934210427375, -173.17188643097043, -294.87983655264316, -89.06939485005064, -960.0144153675822, -1146.0550048494, -191.16821111204993, -1010.6461713241853, -1050.3551870833987, -754.0727383119065, -107.53993669276393, -410.79090754998504, -200.30021928013332, -1018.4476183118227, -166.45406916418858, 2.558985731377639, -323.29667933814846, -24.3033532239233, -1023.3556577757722, -553.8261331322175, -39.753280662773335, -1140.0434862977818, -198.63904550566716, -1041.56557406426, -315.3389528238251, -411.8845854350352, -283.3241601742194, -355.46808485714473, -409.8880529818091, -1211.4225757117854, -824.4502960199524, -108.28611022486811, -1231.303887765651, -1229.9541154064054, -1292.46227680436, -584.9102023560826, -1298.339166096745, -622.5399817246295, -660.9641435988029, -467.8610603584545, -5.351879301961056, -907.7613417387188, -1395.8595245241959, -163.89954008178833, -1036.0296655246268, -1013.8237230874234, -444.69886741579415, -332.5100311906392, -1244.4853426902562, -214.17783900864254, -221.09624859719466, -1368.2746178534226, -394.4885332430059, -731.9844063023826, -1332.8260332173274, -1193.633503252324, -695.3180574663876, -673.0360470764881, -1001.3857661177113, -199.79457129043743, -1302.481743459461, -73.68808219068335, -7.509409253346694, -194.44284011653536, -892.8518192983232, -1284.9142731822944, -174.86522038898997, -8.710481352973488, -1152.900878179126, -732.3579327353764, -36.303219257176224, -352.2292753181783, -1135.6961771058388, -451.8900544517527, -1222.009859004983, -836.5840793704992, -236.2890886198231, -130.9341101743992, -340.716178093222, -921.2980694679939, -116.97897977385854, -674.9569565255398, -174.9544205359744, -983.2214708686371, -1334.4538655520273, -159.67264875577828, -598.2006402310863, -148.71073735407234, -109.09528530233173, -122.24105006596406, -441.4122553410376, -433.00895640145677, -924.2867239097266, -976.0475761420515, -1253.2254010121999, -463.71455705756665, -911.121191831285, -170.89535890706847, -410.9523896490648, -103.43231511905394, -109.06100926629199, -815.4367908005023, -331.4299866010278, -145.42329307419962, -94.45631663059142, -215.86611707118786, -151.73411282905408, -38.001858468475845, -358.6567684376213, -228.18433131443464, -146.01913044752058, -998.5908717533437, -374.1155752204108, -651.6203913838267, -78.06064691621802, -1079.1957733883758, -53.69577229381995, -448.8877540037598, -387.1196355845567, -293.5898718538699, -380.28867086986287, -309.6958726840393, -174.08990487425083, -193.3872739210441, -1476.0097251423238, -731.4096714920543, -731.2458885031476, -720.172496335417, -805.636376042668, -75.61200246308093, -1281.5550286029343, -149.88885541510527, -95.54417642342378, -89.99100649983605, 9.676213340995783, -758.0750984579217, -1179.7923511202077, -169.40525779365572, -628.2029073645112, -647.9071871122927, -721.8620434767487, -67.10632532260574, -141.28715938103238, -1059.9041291960123, -338.95657843851217, -301.1014613564256, -13.605543378231081, -113.037361536333, -134.09210553529613, -252.78406563333024, -1131.2836135950874, -444.1349724199904, -555.9915689262194, -1336.1593036594004, -106.08504117746764, -68.18781992125776, -806.4936414415795, -273.2309932934066, -41.78090106673133, -1221.32036052375, -249.69371771289624, -1256.2336607001025, -783.9042667066839, -656.6980610550676, -620.3186244123154, -36.59177366837195, -41.948330123021336, -1240.5677436055025, -1124.7885516368488, -554.3082427602284, -71.1204895188694, -730.4448839040292, -228.30976319135976, -1271.9321560732353, -22.153666154610033, -82.176418313687, -515.2405955915432, -1167.2008439738606, -751.2123788427554, -203.61715249515368, -1409.162973797091, -962.6551543614014, -1023.1315063774326, -245.2206115396958, -203.72660084386098, -858.5273306631148, -7.6323503977163725, -262.4775539842999, -182.99600012362947, -100.54161761904197, -226.0113365379588, -351.4398008056456, -510.83499098581416, -194.99297385040632, -27.193986199455427, -845.2266504520711, -152.2854146507661, -208.31286736268072, -896.0171301554342, -870.1318655745248, -153.17104387402156, -311.88862701701396, -1093.4242358790652, -663.7611446207787, -109.69047165670617, -1006.3369815336538, -802.1157848828966, -382.5459004702637, -180.2340984617509, -882.3301518193639, -164.24802162509562, -1318.5022318664164, -354.1321095035065, -866.0454800781641, -1316.5494013774453, -526.2166839980889, -52.3630444923084, -1115.0461527561422, -406.5031765748691, -1341.2324054338887, -190.656583215536, -454.70798260176093, -850.3993552015517, -797.7323915790197, -754.8529970598655, -300.894250861455, -815.4257031912205, -60.007160720428104, -1324.943538773233, -1183.6637571410886, -652.0503377880405, -151.66276388480722, -355.91262835067954, -273.8149736336355, -1003.9213161020158, -227.1681231281879, -397.3470004743478, -20.99218976702601, -666.5162096048077, -288.76244744333434, -43.193158440766304, -864.7986897680173, -141.63754910094232, -410.07658282703835, -11.992611494570525, -221.12928647789707, -16.396862307152222, -33.424647246114354, -520.304957656976, -422.1872008430566, -1356.480668588642, -157.3464358806519, -667.6948646716331, -108.34445296074608, -163.08685572820306, -41.27740196234687, -29.062460645911326, -488.7831859808532, -864.7424350306525, -257.47534302796913, -35.77826125905642, -161.23857936702902, -686.1037917763781, -506.3225299552288, -816.1495909959738, -134.98174448805483, -114.78252781368751, -1427.8762203709973, -700.7564100008353, -735.2750054863951, -521.180511133952, -754.0435309040174, -193.3054122318303, -704.5487050346298, -1070.993750573151, -723.0821053567972, -432.9549093439987, -74.21749181310697, -136.62594469434953, -612.4362170200493, -311.9873886992726, -708.0922167510366, -783.9245547411916, -599.5427416711043, -1352.7755996929573, -515.0352369967279, -1135.0357610906117, -358.02176865861435, -857.4949817221969, -57.37441088020228, -360.01719974672494, -298.3229767127979, -281.9860749862961, -188.20137580543135, -365.3107083862374, -990.7801751002862, -1126.4343557276193, -1082.5292845182657, -384.1662807106397, -87.03177028519177, -1107.0049160399972, -41.85703277210988, -996.4370848243473, -74.87444626782037, -21.69732487226472, -140.35889381531422, -1566.918178113122, -229.6416633094906, -1211.8175317084444, -501.0270718685011, -629.9849357094015, -309.7609108559484, -1283.8405584250875, -1024.1597277945057, -415.47363667981546, -557.4830305885617, -899.1233238060951, -781.7453792800942, -628.9278430086821, -264.1516215392577, -310.02127106845285, -402.0577303827392, -67.45650134770645, -523.0734416163963, -1109.2081031769114, -456.97693443392495, -331.05433037917396, 1.3014449903272038, -192.26739694656493, -555.4361024264606, -427.6405732019497, -1425.0519718743872, -150.35486792403168, -1003.8674553252785, -112.18564994870346, -1077.3617199564028, -793.6489038485797, -309.58481354222954, -1041.7505642162212, -1069.733311114947, -31.01420289933782, -1141.0138943801676, -131.93848625305424, -1091.9887011047272, -428.8569138998663, -624.5586999426763, -55.6335309388343, -364.9549624740446, -151.53502515958786, -444.3547663461447, -358.96056446570816, -398.59066109281633, -321.26028792722377, -1213.6532059040765, -1044.8642248880521, -1175.0743171975505, -628.2588193231323, -593.3373107056766, -780.1195529118065, -1364.3583365923416, -819.699420154482, -143.59042891659294, -1095.5008893819952, -335.1302974202978, -877.9079210351994, -1577.599671388818, -1363.1463161983595, -343.4537795214199, -190.49504760537528, -1235.8907445925497, -1145.4737236516348, -1249.2636880033829, -865.4950673095544, -780.9173460948786, -1106.5971219976261, -891.7711063027944, -470.5305570588687, -242.97673109799825, -50.98334827789397, -277.73850768319113, -266.93246717800344, -1093.1874932540118, -117.41868923839411, -540.0614004961081, -632.9252639062887, -664.1259041738547, -132.39907522487061, -801.3987576805512, -531.7207567425429, -115.66621657464732, -370.59912033664494, -281.6191967163936, -600.2090438296558, -794.753141541874, -114.32866609229912, -1476.6150006410005, -751.3866359387048, -44.18160195074474, -1292.3835898371372, -541.4420156402969, -355.03259742014546, -545.4682121106036, -1123.2770908609436, -184.27674228218228, -436.816725675775, -110.38830397360202, -1458.0093495402714, -976.9602958293323, -82.48363587408124, -42.89704343614255, -37.05913425221124, -236.08998880499803, -1431.372141741371, -122.08086061127271, -108.35767911220607, -254.05509601480532, -27.678053875372683, -668.7137784293628, -102.13256315939209, -23.63007540460085, -541.5784767115829, -110.41519441681957, -346.1031500129593, -32.2661139871554, -562.9014729536309, -1320.7846390430425, -133.27042555949325, -165.76516385264736, -117.73293284786797, -1085.5812514439447, -1477.9341501668086, -464.4682646970634, -202.26003872291247, -1241.7354964577753, -979.5032405440759, -587.6253297724751, -286.0576368942394, -463.4475438225728, -247.98845836972313, -1392.2730766850907, -513.9730996670645, -1235.7901012948644, -1181.311018101445, -50.65060238731005, -93.21472708710745, -802.8993548372134, -13.011948996830805, -358.57711493222155, -881.1998500735348, -66.52945356687252, -1291.655418948387, -1218.5069468363672, -70.17682447800809, -126.32454180443759, -597.9497286383771, -80.70865430658166, -412.3654630061597, -17.583085143360023, -1004.7836391615198, -430.5144354562538, -151.4900521864851, -1030.0900136392056, -348.48951669420904, -1060.02830786448, -95.65957679517273, -145.69806444913948, -575.9714733152038, -116.428568004876]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4673550803268145, "mean_inference_ms": 1.6846395244913372, "mean_action_processing_ms": 0.7706614357096282, "mean_env_wait_ms": 9.809425011795748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014003276824951172, "StateBufferConnector_ms": 0.00984811782836914, "ViewRequirementAgentConnector_ms": 0.3255345821380615}, "num_episodes": 28, "episode_return_max": -645.4816980735086, "episode_return_min": -5028.205742388226, "episode_return_mean": -2760.1641993851495, "episodes_this_iter": 28}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1648740, "num_agent_steps_trained": 1648740, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 97.83313561501659, "num_env_steps_trained_throughput_per_sec": 97.83313561501659, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1648740, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1648740, "timers": {"training_iteration_time_ms": 53149.741, "restore_workers_time_ms": 0.027, "training_step_time_ms": 53149.671, "sample_time_ms": 3296.495, "learn_time_ms": 49795.591, "learn_throughput": 80.328, "synch_weights_time_ms": 54.772}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1648740, "num_agent_steps_trained": 1648740}, "done": false, "training_iteration": 96, "trial_id": "efc54_00000", "date": "2024-07-24_20-06-35", "timestamp": 1721831795, "time_this_iter_s": 40.89866280555725, "time_total_s": 5190.488607883453, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x717509f59120>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5190.488607883453, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 11.222413793103449, "ram_util_percent": 24.599999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 140.29073057572046, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.2743461110939585, "policy_loss": -0.0010721777200766761, "vf_loss": 4.296791978677114, "vf_explained_var": 0.9866761535561334, "kl": 0.011393964981471072, "entropy": 3.002598365644614, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.5703125, "num_grad_updates_lifetime": 389700.5, "diff_num_grad_updates_vs_sampler_policy": 1919.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1665069, "num_agent_steps_trained": 1665069}, "env_runners": {"episode_reward_max": -645.4816980735086, "episode_reward_min": -4686.618271162497, "episode_reward_mean": -2649.3706625061154, "episode_len_mean": 148.53, "episode_media": {}, "episodes_timesteps_total": 14853, "policy_reward_min": {"policy_0": -1577.599671388818}, "policy_reward_max": {"policy_0": 9.676213340995783}, "policy_reward_mean": {"policy_0": -529.8741325012231}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3775.004084950173, -1770.312491435942, -645.4816980735086, -2105.5666771733318, -2311.460337986001, -1544.7839558665785, -3852.2250553939875, -2408.2364389472114, -2187.5875005306257, -2206.3656226571925, -1826.6050739055138, -2518.2863261099246, -2590.1567994931115, -3552.932906710165, -2596.1245328642785, -2708.9719310113346, -3058.703680106938, -4349.779165873836, -1577.584447428687, -1371.8237460720893, -1428.0118925153806, -3324.6329025000605, -2964.4502831642994, -2899.446613276131, -3876.2207627021503, -3243.499503027607, -2728.9125034119893, -3668.233025937848, -1923.2436031052107, -2004.9080543578684, -693.019990352772, -3124.014127640958, -830.554357278061, -2005.338410461086, -3000.112613623942, -2904.5608697570306, -3005.7969621216807, -2553.0663219058965, -3960.4111081100173, -1855.1956440482193, -3753.2558995378395, -2616.4970846322854, -2033.4905063780118, -3936.4310085673833, -3677.985098149074, -1672.6149673468392, -2419.0113646160808, -2750.750912373392, -3296.6485426211975, -3415.450458863726, -2565.9928083601494, -1674.7013049914813, -4655.187878018492, -4203.268627957222, -4497.237985564093, -4686.618271162497, -3492.792862552168, -1806.2605056314947, -2770.9104014816753, -1899.8143341998841, -3181.265046164625, -3857.6035058691264, -3166.4514173011626, -1829.9019441088035, -1180.8854680430197, -1123.859459705354, -2214.98781539597, -3347.976637878598, -3558.36924749114, -4571.335754118182, -1318.3537482406834, -3528.068493903168, -1234.931472898916, -2965.3676571376764, -1993.7859904288714, -2673.4047841457677, -3048.0797899539734, -1951.0068250568486, -2786.2289939429284, -2608.8894905027023, -1998.9859759236535, -4315.046252776369, -2231.2223690244095, -3498.1724042135843, -1999.525971274304, -3160.8996006677244, -1412.5246480264484, -2300.4793707803806, -1119.4828592225888, -2316.5306144072174, -2153.6493233308875, -3087.7671436687347, -1390.0639395767894, -2765.8907015139885, -2637.5120655006745, -1873.590473499604, -2869.742553524133, -2557.846042747093, -2980.3476385170516, -3350.4899152348016], "episode_lengths": [150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 140, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 150, 150, 150, 150, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-976.0475761420515, -1253.2254010121999, -463.71455705756665, -911.121191831285, -170.89535890706847, -410.9523896490648, -103.43231511905394, -109.06100926629199, -815.4367908005023, -331.4299866010278, -145.42329307419962, -94.45631663059142, -215.86611707118786, -151.73411282905408, -38.001858468475845, -358.6567684376213, -228.18433131443464, -146.01913044752058, -998.5908717533437, -374.1155752204108, -651.6203913838267, -78.06064691621802, -1079.1957733883758, -53.69577229381995, -448.8877540037598, -387.1196355845567, -293.5898718538699, -380.28867086986287, -309.6958726840393, -174.08990487425083, -193.3872739210441, -1476.0097251423238, -731.4096714920543, -731.2458885031476, -720.172496335417, -805.636376042668, -75.61200246308093, -1281.5550286029343, -149.88885541510527, -95.54417642342378, -89.99100649983605, 9.676213340995783, -758.0750984579217, -1179.7923511202077, -169.40525779365572, -628.2029073645112, -647.9071871122927, -721.8620434767487, -67.10632532260574, -141.28715938103238, -1059.9041291960123, -338.95657843851217, -301.1014613564256, -13.605543378231081, -113.037361536333, -134.09210553529613, -252.78406563333024, -1131.2836135950874, -444.1349724199904, -555.9915689262194, -1336.1593036594004, -106.08504117746764, -68.18781992125776, -806.4936414415795, -273.2309932934066, -41.78090106673133, -1221.32036052375, -249.69371771289624, -1256.2336607001025, -783.9042667066839, -656.6980610550676, -620.3186244123154, -36.59177366837195, -41.948330123021336, -1240.5677436055025, -1124.7885516368488, -554.3082427602284, -71.1204895188694, -730.4448839040292, -228.30976319135976, -1271.9321560732353, -22.153666154610033, -82.176418313687, -515.2405955915432, -1167.2008439738606, -751.2123788427554, -203.61715249515368, -1409.162973797091, -962.6551543614014, -1023.1315063774326, -245.2206115396958, -203.72660084386098, -858.5273306631148, -7.6323503977163725, -262.4775539842999, -182.99600012362947, -100.54161761904197, -226.0113365379588, -351.4398008056456, -510.83499098581416, -194.99297385040632, -27.193986199455427, -845.2266504520711, -152.2854146507661, -208.31286736268072, -896.0171301554342, -870.1318655745248, -153.17104387402156, -311.88862701701396, -1093.4242358790652, -663.7611446207787, -109.69047165670617, -1006.3369815336538, -802.1157848828966, -382.5459004702637, -180.2340984617509, -882.3301518193639, -164.24802162509562, -1318.5022318664164, -354.1321095035065, -866.0454800781641, -1316.5494013774453, -526.2166839980889, -52.3630444923084, -1115.0461527561422, -406.5031765748691, -1341.2324054338887, -190.656583215536, -454.70798260176093, -850.3993552015517, -797.7323915790197, -754.8529970598655, -300.894250861455, -815.4257031912205, -60.007160720428104, -1324.943538773233, -1183.6637571410886, -652.0503377880405, -151.66276388480722, -355.91262835067954, -273.8149736336355, -1003.9213161020158, -227.1681231281879, -397.3470004743478, -20.99218976702601, -666.5162096048077, -288.76244744333434, -43.193158440766304, -864.7986897680173, -141.63754910094232, -410.07658282703835, -11.992611494570525, -221.12928647789707, -16.396862307152222, -33.424647246114354, -520.304957656976, -422.1872008430566, -1356.480668588642, -157.3464358806519, -667.6948646716331, -108.34445296074608, -163.08685572820306, -41.27740196234687, -29.062460645911326, -488.7831859808532, -864.7424350306525, -257.47534302796913, -35.77826125905642, -161.23857936702902, -686.1037917763781, -506.3225299552288, -816.1495909959738, -134.98174448805483, -114.78252781368751, -1427.8762203709973, -700.7564100008353, -735.2750054863951, -521.180511133952, -754.0435309040174, -193.3054122318303, -704.5487050346298, -1070.993750573151, -723.0821053567972, -432.9549093439987, -74.21749181310697, -136.62594469434953, -612.4362170200493, -311.9873886992726, -708.0922167510366, -783.9245547411916, -599.5427416711043, -1352.7755996929573, -515.0352369967279, -1135.0357610906117, -358.02176865861435, -857.4949817221969, -57.37441088020228, -360.01719974672494, -298.3229767127979, -281.9860749862961, -188.20137580543135, -365.3107083862374, -990.7801751002862, -1126.4343557276193, -1082.5292845182657, -384.1662807106397, -87.03177028519177, -1107.0049160399972, -41.85703277210988, -996.4370848243473, -74.87444626782037, -21.69732487226472, -140.35889381531422, -1566.918178113122, -229.6416633094906, -1211.8175317084444, -501.0270718685011, -629.9849357094015, -309.7609108559484, -1283.8405584250875, -1024.1597277945057, -415.47363667981546, -557.4830305885617, -899.1233238060951, -781.7453792800942, -628.9278430086821, -264.1516215392577, -310.02127106845285, -402.0577303827392, -67.45650134770645, -523.0734416163963, -1109.2081031769114, -456.97693443392495, -331.05433037917396, 1.3014449903272038, -192.26739694656493, -555.4361024264606, -427.6405732019497, -1425.0519718743872, -150.35486792403168, -1003.8674553252785, -112.18564994870346, -1077.3617199564028, -793.6489038485797, -309.58481354222954, -1041.7505642162212, -1069.733311114947, -31.01420289933782, -1141.0138943801676, -131.93848625305424, -1091.9887011047272, -428.8569138998663, -624.5586999426763, -55.6335309388343, -364.9549624740446, -151.53502515958786, -444.3547663461447, -358.96056446570816, -398.59066109281633, -321.26028792722377, -1213.6532059040765, -1044.8642248880521, -1175.0743171975505, -628.2588193231323, -593.3373107056766, -780.1195529118065, -1364.3583365923416, -819.699420154482, -143.59042891659294, -1095.5008893819952, -335.1302974202978, -877.9079210351994, -1577.599671388818, -1363.1463161983595, -343.4537795214199, -190.49504760537528, -1235.8907445925497, -1145.4737236516348, -1249.2636880033829, -865.4950673095544, -780.9173460948786, -1106.5971219976261, -891.7711063027944, -470.5305570588687, -242.97673109799825, -50.98334827789397, -277.73850768319113, -266.93246717800344, -1093.1874932540118, -117.41868923839411, -540.0614004961081, -632.9252639062887, -664.1259041738547, -132.39907522487061, -801.3987576805512, -531.7207567425429, -115.66621657464732, -370.59912033664494, -281.6191967163936, -600.2090438296558, -794.753141541874, -114.32866609229912, -1476.6150006410005, -751.3866359387048, -44.18160195074474, -1292.3835898371372, -541.4420156402969, -355.03259742014546, -545.4682121106036, -1123.2770908609436, -184.27674228218228, -436.816725675775, -110.38830397360202, -1458.0093495402714, -976.9602958293323, -82.48363587408124, -42.89704343614255, -37.05913425221124, -236.08998880499803, -1431.372141741371, -122.08086061127271, -108.35767911220607, -254.05509601480532, -27.678053875372683, -668.7137784293628, -102.13256315939209, -23.63007540460085, -541.5784767115829, -110.41519441681957, -346.1031500129593, -32.2661139871554, -562.9014729536309, -1320.7846390430425, -133.27042555949325, -165.76516385264736, -117.73293284786797, -1085.5812514439447, -1477.9341501668086, -464.4682646970634, -202.26003872291247, -1241.7354964577753, -979.5032405440759, -587.6253297724751, -286.0576368942394, -463.4475438225728, -247.98845836972313, -1392.2730766850907, -513.9730996670645, -1235.7901012948644, -1181.311018101445, -50.65060238731005, -93.21472708710745, -802.8993548372134, -13.011948996830805, -358.57711493222155, -881.1998500735348, -66.52945356687252, -1291.655418948387, -1218.5069468363672, -70.17682447800809, -126.32454180443759, -597.9497286383771, -80.70865430658166, -412.3654630061597, -17.583085143360023, -1004.7836391615198, -430.5144354562538, -151.4900521864851, -1030.0900136392056, -348.48951669420904, -1060.02830786448, -95.65957679517273, -145.69806444913948, -575.9714733152038, -116.428568004876, -893.524801950671, -155.26419083249274, -433.353347828422, -1123.893131161548, -67.36931237263217, -1023.8611161563654, -166.83168274837587, -286.669562845004, -686.3820205115923, -884.3354076926317, -1203.3086586118725, -61.960264681725235, -461.77205685174727, -205.3789798255588, -18.586865085944105, -86.56122180905327, -1167.2212588718223, -848.4847174855721, -283.71973472008045, -400.2420610563999, -507.5580360337262, -187.2307762685592, -1014.734834664093, -179.37718204570785, -719.9886614906136, -502.2911983933303, -328.5231164547138, -23.636236564639173, -309.58385800340557, -834.9515665075643, -480.2664351023603, -631.1375206153031, -1458.349285100014, -779.6033357153202, -965.689676243374, -891.0404773866155, -799.7310423848226, -97.09978807723284, -355.5989422582789, -87.75211891745936, -1028.1350158370774, -81.8324154822405, -1001.6913087324153, -1211.3828906772883, -175.13077348455892, -146.3073797696676, -13.40126847418008, -579.3687813283505, -1163.7482424169893, -96.70029928511582, -115.15885372481529, -823.0603027032761, -1115.5038930118621, -362.2711664176486, -744.9053848101282, -596.7676264412415, -249.24102584370812, -261.6944847695299, -285.69155317592725, -19.129957796041545, -541.1612244552699, -646.5736802955261, -206.0662511913968, -314.57362708838156, -592.104587749807, -153.51623444090086, -690.9113242957529, -187.11882963379276, -43.43051835795833, -44.505952494184456, -22.53084386899471, -199.79911138163828, -266.64687147006754, -854.3619763399636, -973.1918113465535, -170.71462425354852, -174.27558338470848, -62.718852089421915, -1024.1195678335537, -721.8206957696555, -74.21015243451991, -1213.9015854972838, -1164.387086259644, -487.5254845361539, -147.74283494113354, -727.4511640755043, -157.37972385871927, -288.3294484664995, -167.37655269133631, -49.52705048473029, -37.62433635838183, -691.321781405449, -917.6149880042665, -117.92936362821813, -1001.4002321176716, -73.82198970676787, -419.4540736878915, -655.5482139653658, -1234.4023051389888, -254.28548300166008, -183.41140784783113, -971.1520725727192, -297.40855455370485, -99.55020368019863, -322.0682348451487, -108.99426832578808, -613.597863909665, -790.7229206602369, -931.138317092758, -425.2891835356867, -420.1738970805393, -778.2153936540826, -135.69690073482414, -424.1958098472322, -799.5640414304161, -311.2044219670955, -213.74042475251747, -1200.713603597083, -257.9995118146158, -996.6896763857413, -932.2907006038664, -1080.428204710883, -1240.5523353182737, -53.047071810803956, -44.171602790973566]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4672108382182052, "mean_inference_ms": 1.6839692645398001, "mean_action_processing_ms": 0.7705938416157414, "mean_env_wait_ms": 9.803062470547175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013733148574829102, "StateBufferConnector_ms": 0.009736776351928711, "ViewRequirementAgentConnector_ms": 0.3195974826812744}, "num_episodes": 25, "episode_return_max": -645.4816980735086, "episode_return_min": -4686.618271162497, "episode_return_mean": -2649.3706625061154, "episodes_this_iter": 25}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1665069, "num_agent_steps_trained": 1665069, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.08213045724786, "num_env_steps_trained_throughput_per_sec": 76.08213045724786, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1665069, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1665069, "timers": {"training_iteration_time_ms": 52836.042, "restore_workers_time_ms": 0.027, "training_step_time_ms": 52835.971, "sample_time_ms": 3279.186, "learn_time_ms": 49498.396, "learn_throughput": 80.811, "synch_weights_time_ms": 55.537}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1665069, "num_agent_steps_trained": 1665069}, "done": false, "training_iteration": 97, "trial_id": "efc54_00000", "date": "2024-07-24_20-07-28", "timestamp": 1721831848, "time_this_iter_s": 52.5863094329834, "time_total_s": 5243.074917316437, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71752d71ed40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5243.074917316437, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 10.085135135135136, "ram_util_percent": 24.599999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 144.1054962252393, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.259716456848898, "policy_loss": -0.001849106460246315, "vf_loss": 4.283679481906655, "vf_explained_var": 0.9885090015699834, "kl": 0.011002157945394298, "entropy": 3.046867862454167, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.13333333333334, "num_grad_updates_lifetime": 393645.5, "diff_num_grad_updates_vs_sampler_policy": 2024.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1682232, "num_agent_steps_trained": 1682232}, "env_runners": {"episode_reward_max": -402.5643261374734, "episode_reward_min": -4686.618271162497, "episode_reward_mean": -2638.4126421831475, "episode_len_mean": 148.2, "episode_media": {}, "episodes_timesteps_total": 14820, "policy_reward_min": {"policy_0": -1577.599671388818}, "policy_reward_max": {"policy_0": 1.3014449903272038}, "policy_reward_mean": {"policy_0": -527.6825284366295}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2004.9080543578684, -693.019990352772, -3124.014127640958, -830.554357278061, -2005.338410461086, -3000.112613623942, -2904.5608697570306, -3005.7969621216807, -2553.0663219058965, -3960.4111081100173, -1855.1956440482193, -3753.2558995378395, -2616.4970846322854, -2033.4905063780118, -3936.4310085673833, -3677.985098149074, -1672.6149673468392, -2419.0113646160808, -2750.750912373392, -3296.6485426211975, -3415.450458863726, -2565.9928083601494, -1674.7013049914813, -4655.187878018492, -4203.268627957222, -4497.237985564093, -4686.618271162497, -3492.792862552168, -1806.2605056314947, -2770.9104014816753, -1899.8143341998841, -3181.265046164625, -3857.6035058691264, -3166.4514173011626, -1829.9019441088035, -1180.8854680430197, -1123.859459705354, -2214.98781539597, -3347.976637878598, -3558.36924749114, -4571.335754118182, -1318.3537482406834, -3528.068493903168, -1234.931472898916, -2965.3676571376764, -1993.7859904288714, -2673.4047841457677, -3048.0797899539734, -1951.0068250568486, -2786.2289939429284, -2608.8894905027023, -1998.9859759236535, -4315.046252776369, -2231.2223690244095, -3498.1724042135843, -1999.525971274304, -3160.8996006677244, -1412.5246480264484, -2300.4793707803806, -1119.4828592225888, -2316.5306144072174, -2153.6493233308875, -3087.7671436687347, -1390.0639395767894, -2765.8907015139885, -2637.5120655006745, -1873.590473499604, -2869.742553524133, -2557.846042747093, -2980.3476385170516, -3350.4899152348016, -2957.9103695225485, -2284.1446680937484, -2722.7873541518657, -2147.290134715114, -2135.877785317466, -2072.9318166579005, -2135.9001285051845, -1960.9311301413793, -2621.967326361769, -1397.7144861741715, -3250.340556830026, -4029.2631295139254, -4610.65697099114, -2143.544426913629, -2015.157168707164, -3531.9812176159735, -1474.7175816887193, -402.5643261374734, -3187.666970243539, -2384.513171526907, -4124.547787571901, -3852.6698281229683, -2302.046311415006, -1827.6626521363737, -1663.3017529099911, -1909.003871356043, -3994.509769287587, -1800.1663094996761, -2977.07252782505], "episode_lengths": [150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 150, 150, 150, 150, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-666.5162096048077, -288.76244744333434, -43.193158440766304, -864.7986897680173, -141.63754910094232, -410.07658282703835, -11.992611494570525, -221.12928647789707, -16.396862307152222, -33.424647246114354, -520.304957656976, -422.1872008430566, -1356.480668588642, -157.3464358806519, -667.6948646716331, -108.34445296074608, -163.08685572820306, -41.27740196234687, -29.062460645911326, -488.7831859808532, -864.7424350306525, -257.47534302796913, -35.77826125905642, -161.23857936702902, -686.1037917763781, -506.3225299552288, -816.1495909959738, -134.98174448805483, -114.78252781368751, -1427.8762203709973, -700.7564100008353, -735.2750054863951, -521.180511133952, -754.0435309040174, -193.3054122318303, -704.5487050346298, -1070.993750573151, -723.0821053567972, -432.9549093439987, -74.21749181310697, -136.62594469434953, -612.4362170200493, -311.9873886992726, -708.0922167510366, -783.9245547411916, -599.5427416711043, -1352.7755996929573, -515.0352369967279, -1135.0357610906117, -358.02176865861435, -857.4949817221969, -57.37441088020228, -360.01719974672494, -298.3229767127979, -281.9860749862961, -188.20137580543135, -365.3107083862374, -990.7801751002862, -1126.4343557276193, -1082.5292845182657, -384.1662807106397, -87.03177028519177, -1107.0049160399972, -41.85703277210988, -996.4370848243473, -74.87444626782037, -21.69732487226472, -140.35889381531422, -1566.918178113122, -229.6416633094906, -1211.8175317084444, -501.0270718685011, -629.9849357094015, -309.7609108559484, -1283.8405584250875, -1024.1597277945057, -415.47363667981546, -557.4830305885617, -899.1233238060951, -781.7453792800942, -628.9278430086821, -264.1516215392577, -310.02127106845285, -402.0577303827392, -67.45650134770645, -523.0734416163963, -1109.2081031769114, -456.97693443392495, -331.05433037917396, 1.3014449903272038, -192.26739694656493, -555.4361024264606, -427.6405732019497, -1425.0519718743872, -150.35486792403168, -1003.8674553252785, -112.18564994870346, -1077.3617199564028, -793.6489038485797, -309.58481354222954, -1041.7505642162212, -1069.733311114947, -31.01420289933782, -1141.0138943801676, -131.93848625305424, -1091.9887011047272, -428.8569138998663, -624.5586999426763, -55.6335309388343, -364.9549624740446, -151.53502515958786, -444.3547663461447, -358.96056446570816, -398.59066109281633, -321.26028792722377, -1213.6532059040765, -1044.8642248880521, -1175.0743171975505, -628.2588193231323, -593.3373107056766, -780.1195529118065, -1364.3583365923416, -819.699420154482, -143.59042891659294, -1095.5008893819952, -335.1302974202978, -877.9079210351994, -1577.599671388818, -1363.1463161983595, -343.4537795214199, -190.49504760537528, -1235.8907445925497, -1145.4737236516348, -1249.2636880033829, -865.4950673095544, -780.9173460948786, -1106.5971219976261, -891.7711063027944, -470.5305570588687, -242.97673109799825, -50.98334827789397, -277.73850768319113, -266.93246717800344, -1093.1874932540118, -117.41868923839411, -540.0614004961081, -632.9252639062887, -664.1259041738547, -132.39907522487061, -801.3987576805512, -531.7207567425429, -115.66621657464732, -370.59912033664494, -281.6191967163936, -600.2090438296558, -794.753141541874, -114.32866609229912, -1476.6150006410005, -751.3866359387048, -44.18160195074474, -1292.3835898371372, -541.4420156402969, -355.03259742014546, -545.4682121106036, -1123.2770908609436, -184.27674228218228, -436.816725675775, -110.38830397360202, -1458.0093495402714, -976.9602958293323, -82.48363587408124, -42.89704343614255, -37.05913425221124, -236.08998880499803, -1431.372141741371, -122.08086061127271, -108.35767911220607, -254.05509601480532, -27.678053875372683, -668.7137784293628, -102.13256315939209, -23.63007540460085, -541.5784767115829, -110.41519441681957, -346.1031500129593, -32.2661139871554, -562.9014729536309, -1320.7846390430425, -133.27042555949325, -165.76516385264736, -117.73293284786797, -1085.5812514439447, -1477.9341501668086, -464.4682646970634, -202.26003872291247, -1241.7354964577753, -979.5032405440759, -587.6253297724751, -286.0576368942394, -463.4475438225728, -247.98845836972313, -1392.2730766850907, -513.9730996670645, -1235.7901012948644, -1181.311018101445, -50.65060238731005, -93.21472708710745, -802.8993548372134, -13.011948996830805, -358.57711493222155, -881.1998500735348, -66.52945356687252, -1291.655418948387, -1218.5069468363672, -70.17682447800809, -126.32454180443759, -597.9497286383771, -80.70865430658166, -412.3654630061597, -17.583085143360023, -1004.7836391615198, -430.5144354562538, -151.4900521864851, -1030.0900136392056, -348.48951669420904, -1060.02830786448, -95.65957679517273, -145.69806444913948, -575.9714733152038, -116.428568004876, -893.524801950671, -155.26419083249274, -433.353347828422, -1123.893131161548, -67.36931237263217, -1023.8611161563654, -166.83168274837587, -286.669562845004, -686.3820205115923, -884.3354076926317, -1203.3086586118725, -61.960264681725235, -461.77205685174727, -205.3789798255588, -18.586865085944105, -86.56122180905327, -1167.2212588718223, -848.4847174855721, -283.71973472008045, -400.2420610563999, -507.5580360337262, -187.2307762685592, -1014.734834664093, -179.37718204570785, -719.9886614906136, -502.2911983933303, -328.5231164547138, -23.636236564639173, -309.58385800340557, -834.9515665075643, -480.2664351023603, -631.1375206153031, -1458.349285100014, -779.6033357153202, -965.689676243374, -891.0404773866155, -799.7310423848226, -97.09978807723284, -355.5989422582789, -87.75211891745936, -1028.1350158370774, -81.8324154822405, -1001.6913087324153, -1211.3828906772883, -175.13077348455892, -146.3073797696676, -13.40126847418008, -579.3687813283505, -1163.7482424169893, -96.70029928511582, -115.15885372481529, -823.0603027032761, -1115.5038930118621, -362.2711664176486, -744.9053848101282, -596.7676264412415, -249.24102584370812, -261.6944847695299, -285.69155317592725, -19.129957796041545, -541.1612244552699, -646.5736802955261, -206.0662511913968, -314.57362708838156, -592.104587749807, -153.51623444090086, -690.9113242957529, -187.11882963379276, -43.43051835795833, -44.505952494184456, -22.53084386899471, -199.79911138163828, -266.64687147006754, -854.3619763399636, -973.1918113465535, -170.71462425354852, -174.27558338470848, -62.718852089421915, -1024.1195678335537, -721.8206957696555, -74.21015243451991, -1213.9015854972838, -1164.387086259644, -487.5254845361539, -147.74283494113354, -727.4511640755043, -157.37972385871927, -288.3294484664995, -167.37655269133631, -49.52705048473029, -37.62433635838183, -691.321781405449, -917.6149880042665, -117.92936362821813, -1001.4002321176716, -73.82198970676787, -419.4540736878915, -655.5482139653658, -1234.4023051389888, -254.28548300166008, -183.41140784783113, -971.1520725727192, -297.40855455370485, -99.55020368019863, -322.0682348451487, -108.99426832578808, -613.597863909665, -790.7229206602369, -931.138317092758, -425.2891835356867, -420.1738970805393, -778.2153936540826, -135.69690073482414, -424.1958098472322, -799.5640414304161, -311.2044219670955, -213.74042475251747, -1200.713603597083, -257.9995118146158, -996.6896763857413, -932.2907006038664, -1080.428204710883, -1240.5523353182737, -53.047071810803956, -44.171602790973566, -517.6773419800029, -452.94015444289096, -982.3082056197669, -98.62684973613926, -906.3578177437507, -129.89257145811862, -94.33251162508114, -522.8060729808952, -1263.869355127565, -273.24415690208974, -989.3627731113841, -531.2019030978901, -406.02557731662137, -548.1497325703283, -248.04736805564139, -254.17422190661105, -546.2175070000651, -335.0064933858118, -62.06401187000704, -949.8279005526196, -1042.5265215571462, -109.19791949414204, -34.76913710857563, -424.3407565393948, -525.0434506182074, -144.0989025044534, -258.4444383081259, -92.44669708071058, -1196.594734142042, -381.34704462256934, -508.6647996177187, -36.09201638286129, -79.2430298264703, -312.5438210272178, -1199.356461650915, -41.117397080721474, -868.6561155143002, -153.6726637138999, -69.55232509216877, -827.9326287402884, -183.2144104920128, -639.6588072477931, -1305.8507747853428, -62.97267092641849, -430.2706629102043, -401.50553577485164, -231.23868011875868, -291.62639442962757, -215.79115863104894, -257.5527172198836, -103.42035978174245, -230.35389655365344, -1361.515395216944, -89.89760418578882, -1465.1533010918952, -350.9814105024519, -293.92313665437507, -722.8105599002185, -1130.239798111024, -1531.3082243458537, -1394.8644851620757, -1062.8560444682691, -303.90786018805477, -1280.3346319265822, -568.6939492461601, -342.69205258496396, -86.36824198389515, -1112.2760318714807, -563.2936227380546, -38.91447773523558, -261.9821669395549, -351.65102542831465, -243.04373271270964, -913.2787853166594, -245.20145830992726, -1399.3807233329717, -36.931063729808685, -984.0774545137865, -106.80239076049699, -1004.789585278913, -155.08166647487636, -1016.2359926504673, -236.8845531626507, -24.465357732228686, -42.05001166849613, -235.42235410581304, -89.53542570664219, -10.978583817342995, -27.084405512714685, -39.543556994960646, -880.7402675343844, -39.33939260903252, -1296.3723478732015, -537.3870523582817, -433.82790986863967, -473.92545140359573, -38.13855093732998, -165.70152444593043, -1059.4301337003606, -647.3175110396936, -535.9481424942186, -1307.592292717351, -636.7218782303421, -898.4421097920011, -745.8433643379904, -1016.3216242589066, -332.9179359190646, -63.62770277584031, -1065.1547309278262, -1374.6478342413327, -99.41501764479901, -166.42357500735153, -515.9335720230354, -1425.2235584968325, -95.05058824298976, -1032.9857258373452, -114.89770760036994, -305.3100151591635, -87.76369520734852, -286.7055083321465, -50.1384047417783, -263.16839452830465, -11.833433955721672, -1160.67925912961, -177.48226055457644, -387.80357030821574, -767.600079215489, -25.570885336745878, -326.91132955887633, -401.1180069367146, -1293.4993000814486, -335.69137649021224, -1349.649330972526, -230.75972814543073, -784.9100335979676, -185.5988468440396, -117.10900355480767, -255.75861778740713, -1061.0083304803825, -180.6915108330382, -767.596953076021, -895.918880972204, -185.35441929722745, -1007.4109431172027, -120.79133136239224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4661844250858254, "mean_inference_ms": 1.6837137430735487, "mean_action_processing_ms": 0.7697105785869783, "mean_env_wait_ms": 9.801783847603213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013248920440673828, "StateBufferConnector_ms": 0.009392738342285156, "ViewRequirementAgentConnector_ms": 0.3065357208251953}, "num_episodes": 29, "episode_return_max": -402.5643261374734, "episode_return_min": -4686.618271162497, "episode_return_mean": -2638.4126421831475, "episodes_this_iter": 29}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1682232, "num_agent_steps_trained": 1682232, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 71.13988733930944, "num_env_steps_trained_throughput_per_sec": 71.13988733930944, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1682232, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1682232, "timers": {"training_iteration_time_ms": 52977.253, "restore_workers_time_ms": 0.027, "training_step_time_ms": 52977.182, "sample_time_ms": 3266.029, "learn_time_ms": 49652.896, "learn_throughput": 80.559, "synch_weights_time_ms": 55.429}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1682232, "num_agent_steps_trained": 1682232}, "done": false, "training_iteration": 98, "trial_id": "efc54_00000", "date": "2024-07-24_20-08-24", "timestamp": 1721831904, "time_this_iter_s": 56.23960590362549, "time_total_s": 5299.314523220062, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x717509f5aa70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5299.314523220062, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 9.74, "ram_util_percent": 24.599999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 131.84534945451577, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.451289834988329, "policy_loss": -0.0031114809574090117, "vf_loss": 4.476859108546308, "vf_explained_var": 0.9864677091287899, "kl": 0.010412013805388419, "entropy": 3.036441371944418, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.6412213740458, "num_grad_updates_lifetime": 397635.5, "diff_num_grad_updates_vs_sampler_policy": 1964.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1698953, "num_agent_steps_trained": 1698953}, "env_runners": {"episode_reward_max": -402.5643261374734, "episode_reward_min": -4686.618271162497, "episode_reward_mean": -2610.8758408156195, "episode_len_mean": 148.24, "episode_media": {}, "episodes_timesteps_total": 14824, "policy_reward_min": {"policy_0": -1531.3082243458537}, "policy_reward_max": {"policy_0": -10.978583817342995}, "policy_reward_mean": {"policy_0": -522.1751681631238}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4686.618271162497, -3492.792862552168, -1806.2605056314947, -2770.9104014816753, -1899.8143341998841, -3181.265046164625, -3857.6035058691264, -3166.4514173011626, -1829.9019441088035, -1180.8854680430197, -1123.859459705354, -2214.98781539597, -3347.976637878598, -3558.36924749114, -4571.335754118182, -1318.3537482406834, -3528.068493903168, -1234.931472898916, -2965.3676571376764, -1993.7859904288714, -2673.4047841457677, -3048.0797899539734, -1951.0068250568486, -2786.2289939429284, -2608.8894905027023, -1998.9859759236535, -4315.046252776369, -2231.2223690244095, -3498.1724042135843, -1999.525971274304, -3160.8996006677244, -1412.5246480264484, -2300.4793707803806, -1119.4828592225888, -2316.5306144072174, -2153.6493233308875, -3087.7671436687347, -1390.0639395767894, -2765.8907015139885, -2637.5120655006745, -1873.590473499604, -2869.742553524133, -2557.846042747093, -2980.3476385170516, -3350.4899152348016, -2957.9103695225485, -2284.1446680937484, -2722.7873541518657, -2147.290134715114, -2135.877785317466, -2072.9318166579005, -2135.9001285051845, -1960.9311301413793, -2621.967326361769, -1397.7144861741715, -3250.340556830026, -4029.2631295139254, -4610.65697099114, -2143.544426913629, -2015.157168707164, -3531.9812176159735, -1474.7175816887193, -402.5643261374734, -3187.666970243539, -2384.513171526907, -4124.547787571901, -3852.6698281229683, -2302.046311415006, -1827.6626521363737, -1663.3017529099911, -1909.003871356043, -3994.509769287587, -1800.1663094996761, -2977.07252782505, -1931.420690717719, -3604.412510614612, -1837.8654914516178, -1665.1048364471276, -2644.9333677273657, -696.8542509305012, -3738.11070355437, -3041.031153685807, -2338.3289513506975, -2805.0205971114224, -3499.866340185143, -1796.4354359975446, -1656.7438756701565, -3523.0143381973357, -3231.81325695483, -3690.6549649525027, -2487.5493664297555, -3444.238082850607, -2727.0655255060674, -2176.1568240683005, -3108.866412601095, -2250.1188944296605, -4563.206927122486, -3921.9489657366753, -2376.845684197957, -1594.2153223906553], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-190.49504760537528, -1235.8907445925497, -1145.4737236516348, -1249.2636880033829, -865.4950673095544, -780.9173460948786, -1106.5971219976261, -891.7711063027944, -470.5305570588687, -242.97673109799825, -50.98334827789397, -277.73850768319113, -266.93246717800344, -1093.1874932540118, -117.41868923839411, -540.0614004961081, -632.9252639062887, -664.1259041738547, -132.39907522487061, -801.3987576805512, -531.7207567425429, -115.66621657464732, -370.59912033664494, -281.6191967163936, -600.2090438296558, -794.753141541874, -114.32866609229912, -1476.6150006410005, -751.3866359387048, -44.18160195074474, -1292.3835898371372, -541.4420156402969, -355.03259742014546, -545.4682121106036, -1123.2770908609436, -184.27674228218228, -436.816725675775, -110.38830397360202, -1458.0093495402714, -976.9602958293323, -82.48363587408124, -42.89704343614255, -37.05913425221124, -236.08998880499803, -1431.372141741371, -122.08086061127271, -108.35767911220607, -254.05509601480532, -27.678053875372683, -668.7137784293628, -102.13256315939209, -23.63007540460085, -541.5784767115829, -110.41519441681957, -346.1031500129593, -32.2661139871554, -562.9014729536309, -1320.7846390430425, -133.27042555949325, -165.76516385264736, -117.73293284786797, -1085.5812514439447, -1477.9341501668086, -464.4682646970634, -202.26003872291247, -1241.7354964577753, -979.5032405440759, -587.6253297724751, -286.0576368942394, -463.4475438225728, -247.98845836972313, -1392.2730766850907, -513.9730996670645, -1235.7901012948644, -1181.311018101445, -50.65060238731005, -93.21472708710745, -802.8993548372134, -13.011948996830805, -358.57711493222155, -881.1998500735348, -66.52945356687252, -1291.655418948387, -1218.5069468363672, -70.17682447800809, -126.32454180443759, -597.9497286383771, -80.70865430658166, -412.3654630061597, -17.583085143360023, -1004.7836391615198, -430.5144354562538, -151.4900521864851, -1030.0900136392056, -348.48951669420904, -1060.02830786448, -95.65957679517273, -145.69806444913948, -575.9714733152038, -116.428568004876, -893.524801950671, -155.26419083249274, -433.353347828422, -1123.893131161548, -67.36931237263217, -1023.8611161563654, -166.83168274837587, -286.669562845004, -686.3820205115923, -884.3354076926317, -1203.3086586118725, -61.960264681725235, -461.77205685174727, -205.3789798255588, -18.586865085944105, -86.56122180905327, -1167.2212588718223, -848.4847174855721, -283.71973472008045, -400.2420610563999, -507.5580360337262, -187.2307762685592, -1014.734834664093, -179.37718204570785, -719.9886614906136, -502.2911983933303, -328.5231164547138, -23.636236564639173, -309.58385800340557, -834.9515665075643, -480.2664351023603, -631.1375206153031, -1458.349285100014, -779.6033357153202, -965.689676243374, -891.0404773866155, -799.7310423848226, -97.09978807723284, -355.5989422582789, -87.75211891745936, -1028.1350158370774, -81.8324154822405, -1001.6913087324153, -1211.3828906772883, -175.13077348455892, -146.3073797696676, -13.40126847418008, -579.3687813283505, -1163.7482424169893, -96.70029928511582, -115.15885372481529, -823.0603027032761, -1115.5038930118621, -362.2711664176486, -744.9053848101282, -596.7676264412415, -249.24102584370812, -261.6944847695299, -285.69155317592725, -19.129957796041545, -541.1612244552699, -646.5736802955261, -206.0662511913968, -314.57362708838156, -592.104587749807, -153.51623444090086, -690.9113242957529, -187.11882963379276, -43.43051835795833, -44.505952494184456, -22.53084386899471, -199.79911138163828, -266.64687147006754, -854.3619763399636, -973.1918113465535, -170.71462425354852, -174.27558338470848, -62.718852089421915, -1024.1195678335537, -721.8206957696555, -74.21015243451991, -1213.9015854972838, -1164.387086259644, -487.5254845361539, -147.74283494113354, -727.4511640755043, -157.37972385871927, -288.3294484664995, -167.37655269133631, -49.52705048473029, -37.62433635838183, -691.321781405449, -917.6149880042665, -117.92936362821813, -1001.4002321176716, -73.82198970676787, -419.4540736878915, -655.5482139653658, -1234.4023051389888, -254.28548300166008, -183.41140784783113, -971.1520725727192, -297.40855455370485, -99.55020368019863, -322.0682348451487, -108.99426832578808, -613.597863909665, -790.7229206602369, -931.138317092758, -425.2891835356867, -420.1738970805393, -778.2153936540826, -135.69690073482414, -424.1958098472322, -799.5640414304161, -311.2044219670955, -213.74042475251747, -1200.713603597083, -257.9995118146158, -996.6896763857413, -932.2907006038664, -1080.428204710883, -1240.5523353182737, -53.047071810803956, -44.171602790973566, -517.6773419800029, -452.94015444289096, -982.3082056197669, -98.62684973613926, -906.3578177437507, -129.89257145811862, -94.33251162508114, -522.8060729808952, -1263.869355127565, -273.24415690208974, -989.3627731113841, -531.2019030978901, -406.02557731662137, -548.1497325703283, -248.04736805564139, -254.17422190661105, -546.2175070000651, -335.0064933858118, -62.06401187000704, -949.8279005526196, -1042.5265215571462, -109.19791949414204, -34.76913710857563, -424.3407565393948, -525.0434506182074, -144.0989025044534, -258.4444383081259, -92.44669708071058, -1196.594734142042, -381.34704462256934, -508.6647996177187, -36.09201638286129, -79.2430298264703, -312.5438210272178, -1199.356461650915, -41.117397080721474, -868.6561155143002, -153.6726637138999, -69.55232509216877, -827.9326287402884, -183.2144104920128, -639.6588072477931, -1305.8507747853428, -62.97267092641849, -430.2706629102043, -401.50553577485164, -231.23868011875868, -291.62639442962757, -215.79115863104894, -257.5527172198836, -103.42035978174245, -230.35389655365344, -1361.515395216944, -89.89760418578882, -1465.1533010918952, -350.9814105024519, -293.92313665437507, -722.8105599002185, -1130.239798111024, -1531.3082243458537, -1394.8644851620757, -1062.8560444682691, -303.90786018805477, -1280.3346319265822, -568.6939492461601, -342.69205258496396, -86.36824198389515, -1112.2760318714807, -563.2936227380546, -38.91447773523558, -261.9821669395549, -351.65102542831465, -243.04373271270964, -913.2787853166594, -245.20145830992726, -1399.3807233329717, -36.931063729808685, -984.0774545137865, -106.80239076049699, -1004.789585278913, -155.08166647487636, -1016.2359926504673, -236.8845531626507, -24.465357732228686, -42.05001166849613, -235.42235410581304, -89.53542570664219, -10.978583817342995, -27.084405512714685, -39.543556994960646, -880.7402675343844, -39.33939260903252, -1296.3723478732015, -537.3870523582817, -433.82790986863967, -473.92545140359573, -38.13855093732998, -165.70152444593043, -1059.4301337003606, -647.3175110396936, -535.9481424942186, -1307.592292717351, -636.7218782303421, -898.4421097920011, -745.8433643379904, -1016.3216242589066, -332.9179359190646, -63.62770277584031, -1065.1547309278262, -1374.6478342413327, -99.41501764479901, -166.42357500735153, -515.9335720230354, -1425.2235584968325, -95.05058824298976, -1032.9857258373452, -114.89770760036994, -305.3100151591635, -87.76369520734852, -286.7055083321465, -50.1384047417783, -263.16839452830465, -11.833433955721672, -1160.67925912961, -177.48226055457644, -387.80357030821574, -767.600079215489, -25.570885336745878, -326.91132955887633, -401.1180069367146, -1293.4993000814486, -335.69137649021224, -1349.649330972526, -230.75972814543073, -784.9100335979676, -185.5988468440396, -117.10900355480767, -255.75861778740713, -1061.0083304803825, -180.6915108330382, -767.596953076021, -895.918880972204, -185.35441929722745, -1007.4109431172027, -120.79133136239224, -387.2146408590417, -448.3459358934262, -668.5676419785075, -113.24664985426723, -314.0458221324747, -917.0255726022546, -861.0341435578073, -34.50416614754398, -1519.2828942020888, -272.5657341049177, -256.9649732701829, -980.6844795773728, -354.5529941069843, -93.431668611802, -152.2313758852768, -306.61673791972225, -21.792903353314877, -826.8502771500666, -115.3435593108987, -394.50135871312506, -871.8490413484818, -811.8062870159945, -568.2597214228181, -240.0542177458483, -152.96410019422285, -415.6195160677967, -120.96416394297131, -15.635958358533516, -98.62436005464686, -46.01025250655246, -1069.5825487342838, -579.4280342444175, -29.63382051322121, -1063.7397805362225, -995.7265195262202, -63.95819555227158, -699.658806876644, -978.3895638908094, -1031.8178708404341, -267.2067165256439, -18.54288968800541, -1169.8529287818174, -750.4683588786928, -240.70401377167164, -158.76076023051326, -150.1390763549622, -638.5334551132509, -1113.4492400462377, -663.3518206409991, -239.54700495597174, -131.50374698930435, -1258.9616954949427, -1051.0211950630435, -141.28786160849262, -917.0918410293601, -217.65915110642894, -182.00400303150275, -255.4660670018174, -531.0093856298516, -610.296829227945, -756.8266183354878, -392.7078103238304, -132.57649044876393, -136.83192567246982, -237.80103088960482, -1206.2735814452124, -238.24458850409823, -324.36218294475617, -811.4481724854677, -942.6858128178011, -874.8208605508923, -216.22156026443608, -718.2644507961887, -317.39806482553695, -1105.1083205177777, -42.67006362217825, -1047.9461139592515, -920.0405722005654, -1356.4376614320317, -323.560553738479, -40.90460205721177, -310.6856766342909, -1097.8552886498758, -731.554846525738, -306.54895256263944, -1202.6685958281416, -1465.1249100036923, -259.68176565203623, -70.02901858324738, -446.73379278348904, -963.2943522787085, -1152.257653386122, -426.4666623938454, -144.94650332870725, -40.10035411868324, -440.46561621584226, -996.7075071783388, -355.1552333961249, -313.3538213989782, -70.47464587901531, -574.8781643243407, -473.65362016037875, -314.32402356642945, -584.9276306283929, -1161.0829739215533, -177.01787886718446, -76.42582403011926, -1267.041583641174, -266.8765212987986, -462.75708659238467, -1421.863638164003, -1397.9101351502634, -206.58942587501457, -882.5989265479179, -654.2448013852844, -1131.467284386972, -368.4777560743069, -1233.8323928057312, -212.6268397599109, -975.5446927097537, -882.3352161097265, -128.66399037301335, -791.3343831137805, -428.12230115093405, -146.3897934505006, -61.00777359825082, -374.75610417295786, -83.68543020826098, -78.01324774386444, -996.7527666673229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4661741424951413, "mean_inference_ms": 1.6850626490270795, "mean_action_processing_ms": 0.7695680130815625, "mean_env_wait_ms": 9.80548437887163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012795209884643555, "StateBufferConnector_ms": 0.009294271469116211, "ViewRequirementAgentConnector_ms": 0.30205774307250977}, "num_episodes": 26, "episode_return_max": -402.5643261374734, "episode_return_min": -4686.618271162497, "episode_return_mean": -2610.8758408156195, "episodes_this_iter": 26}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1698953, "num_agent_steps_trained": 1698953, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.2077712079118, "num_env_steps_trained_throughput_per_sec": 73.2077712079118, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1698953, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1698953, "timers": {"training_iteration_time_ms": 53158.963, "restore_workers_time_ms": 0.027, "training_step_time_ms": 53158.893, "sample_time_ms": 3269.589, "learn_time_ms": 49833.242, "learn_throughput": 80.268, "synch_weights_time_ms": 53.29}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1698953, "num_agent_steps_trained": 1698953}, "done": false, "training_iteration": 99, "trial_id": "efc54_00000", "date": "2024-07-24_20-09-19", "timestamp": 1721831959, "time_this_iter_s": 54.64638423919678, "time_total_s": 5353.960907459259, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x717b99573910>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5353.960907459259, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 10.320512820512821, "ram_util_percent": 24.544871794871796}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 136.14898166974385, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.10387899213367, "policy_loss": -0.006202713093726844, "vf_loss": 4.132405448887083, "vf_explained_var": 0.9911057462626033, "kl": 0.011166280861200195, "entropy": 3.080313488377465, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.675, "num_grad_updates_lifetime": 401400.5, "diff_num_grad_updates_vs_sampler_policy": 1799.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1714274, "num_agent_steps_trained": 1714274}, "env_runners": {"episode_reward_max": -402.5643261374734, "episode_reward_min": -4610.65697099114, "episode_reward_mean": -2531.621697409088, "episode_len_mean": 148.16, "episode_media": {}, "episodes_timesteps_total": 14816, "policy_reward_min": {"policy_0": -1531.3082243458537}, "policy_reward_max": {"policy_0": -10.675723037508885}, "policy_reward_mean": {"policy_0": -506.32433948181756}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1998.9859759236535, -4315.046252776369, -2231.2223690244095, -3498.1724042135843, -1999.525971274304, -3160.8996006677244, -1412.5246480264484, -2300.4793707803806, -1119.4828592225888, -2316.5306144072174, -2153.6493233308875, -3087.7671436687347, -1390.0639395767894, -2765.8907015139885, -2637.5120655006745, -1873.590473499604, -2869.742553524133, -2557.846042747093, -2980.3476385170516, -3350.4899152348016, -2957.9103695225485, -2284.1446680937484, -2722.7873541518657, -2147.290134715114, -2135.877785317466, -2072.9318166579005, -2135.9001285051845, -1960.9311301413793, -2621.967326361769, -1397.7144861741715, -3250.340556830026, -4029.2631295139254, -4610.65697099114, -2143.544426913629, -2015.157168707164, -3531.9812176159735, -1474.7175816887193, -402.5643261374734, -3187.666970243539, -2384.513171526907, -4124.547787571901, -3852.6698281229683, -2302.046311415006, -1827.6626521363737, -1663.3017529099911, -1909.003871356043, -3994.509769287587, -1800.1663094996761, -2977.07252782505, -1931.420690717719, -3604.412510614612, -1837.8654914516178, -1665.1048364471276, -2644.9333677273657, -696.8542509305012, -3738.11070355437, -3041.031153685807, -2338.3289513506975, -2805.0205971114224, -3499.866340185143, -1796.4354359975446, -1656.7438756701565, -3523.0143381973357, -3231.81325695483, -3690.6549649525027, -2487.5493664297555, -3444.238082850607, -2727.0655255060674, -2176.1568240683005, -3108.866412601095, -2250.1188944296605, -4563.206927122486, -3921.9489657366753, -2376.845684197957, -1594.2153223906553, -1877.1066274290447, -2966.034302808489, -3209.1636263450428, -1637.223947709447, -1763.4799347260562, -1732.8011601516073, -1650.2189908300065, -2419.4685948388114, -1109.9291428581978, -4412.168634503161, -4002.7900306145784, -2367.8568387717633, -3475.518427303739, -2876.757237258554, -3383.7223307907584, -1484.059806354718, -1865.457017221136, -2962.339860555924, -3569.2754371046058, -1290.126548679433, -2029.2859505186805, -2497.85763629294, -1174.8591457286568, -1680.1911856225083, -1434.0431616442368], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-502.2911983933303, -328.5231164547138, -23.636236564639173, -309.58385800340557, -834.9515665075643, -480.2664351023603, -631.1375206153031, -1458.349285100014, -779.6033357153202, -965.689676243374, -891.0404773866155, -799.7310423848226, -97.09978807723284, -355.5989422582789, -87.75211891745936, -1028.1350158370774, -81.8324154822405, -1001.6913087324153, -1211.3828906772883, -175.13077348455892, -146.3073797696676, -13.40126847418008, -579.3687813283505, -1163.7482424169893, -96.70029928511582, -115.15885372481529, -823.0603027032761, -1115.5038930118621, -362.2711664176486, -744.9053848101282, -596.7676264412415, -249.24102584370812, -261.6944847695299, -285.69155317592725, -19.129957796041545, -541.1612244552699, -646.5736802955261, -206.0662511913968, -314.57362708838156, -592.104587749807, -153.51623444090086, -690.9113242957529, -187.11882963379276, -43.43051835795833, -44.505952494184456, -22.53084386899471, -199.79911138163828, -266.64687147006754, -854.3619763399636, -973.1918113465535, -170.71462425354852, -174.27558338470848, -62.718852089421915, -1024.1195678335537, -721.8206957696555, -74.21015243451991, -1213.9015854972838, -1164.387086259644, -487.5254845361539, -147.74283494113354, -727.4511640755043, -157.37972385871927, -288.3294484664995, -167.37655269133631, -49.52705048473029, -37.62433635838183, -691.321781405449, -917.6149880042665, -117.92936362821813, -1001.4002321176716, -73.82198970676787, -419.4540736878915, -655.5482139653658, -1234.4023051389888, -254.28548300166008, -183.41140784783113, -971.1520725727192, -297.40855455370485, -99.55020368019863, -322.0682348451487, -108.99426832578808, -613.597863909665, -790.7229206602369, -931.138317092758, -425.2891835356867, -420.1738970805393, -778.2153936540826, -135.69690073482414, -424.1958098472322, -799.5640414304161, -311.2044219670955, -213.74042475251747, -1200.713603597083, -257.9995118146158, -996.6896763857413, -932.2907006038664, -1080.428204710883, -1240.5523353182737, -53.047071810803956, -44.171602790973566, -517.6773419800029, -452.94015444289096, -982.3082056197669, -98.62684973613926, -906.3578177437507, -129.89257145811862, -94.33251162508114, -522.8060729808952, -1263.869355127565, -273.24415690208974, -989.3627731113841, -531.2019030978901, -406.02557731662137, -548.1497325703283, -248.04736805564139, -254.17422190661105, -546.2175070000651, -335.0064933858118, -62.06401187000704, -949.8279005526196, -1042.5265215571462, -109.19791949414204, -34.76913710857563, -424.3407565393948, -525.0434506182074, -144.0989025044534, -258.4444383081259, -92.44669708071058, -1196.594734142042, -381.34704462256934, -508.6647996177187, -36.09201638286129, -79.2430298264703, -312.5438210272178, -1199.356461650915, -41.117397080721474, -868.6561155143002, -153.6726637138999, -69.55232509216877, -827.9326287402884, -183.2144104920128, -639.6588072477931, -1305.8507747853428, -62.97267092641849, -430.2706629102043, -401.50553577485164, -231.23868011875868, -291.62639442962757, -215.79115863104894, -257.5527172198836, -103.42035978174245, -230.35389655365344, -1361.515395216944, -89.89760418578882, -1465.1533010918952, -350.9814105024519, -293.92313665437507, -722.8105599002185, -1130.239798111024, -1531.3082243458537, -1394.8644851620757, -1062.8560444682691, -303.90786018805477, -1280.3346319265822, -568.6939492461601, -342.69205258496396, -86.36824198389515, -1112.2760318714807, -563.2936227380546, -38.91447773523558, -261.9821669395549, -351.65102542831465, -243.04373271270964, -913.2787853166594, -245.20145830992726, -1399.3807233329717, -36.931063729808685, -984.0774545137865, -106.80239076049699, -1004.789585278913, -155.08166647487636, -1016.2359926504673, -236.8845531626507, -24.465357732228686, -42.05001166849613, -235.42235410581304, -89.53542570664219, -10.978583817342995, -27.084405512714685, -39.543556994960646, -880.7402675343844, -39.33939260903252, -1296.3723478732015, -537.3870523582817, -433.82790986863967, -473.92545140359573, -38.13855093732998, -165.70152444593043, -1059.4301337003606, -647.3175110396936, -535.9481424942186, -1307.592292717351, -636.7218782303421, -898.4421097920011, -745.8433643379904, -1016.3216242589066, -332.9179359190646, -63.62770277584031, -1065.1547309278262, -1374.6478342413327, -99.41501764479901, -166.42357500735153, -515.9335720230354, -1425.2235584968325, -95.05058824298976, -1032.9857258373452, -114.89770760036994, -305.3100151591635, -87.76369520734852, -286.7055083321465, -50.1384047417783, -263.16839452830465, -11.833433955721672, -1160.67925912961, -177.48226055457644, -387.80357030821574, -767.600079215489, -25.570885336745878, -326.91132955887633, -401.1180069367146, -1293.4993000814486, -335.69137649021224, -1349.649330972526, -230.75972814543073, -784.9100335979676, -185.5988468440396, -117.10900355480767, -255.75861778740713, -1061.0083304803825, -180.6915108330382, -767.596953076021, -895.918880972204, -185.35441929722745, -1007.4109431172027, -120.79133136239224, -387.2146408590417, -448.3459358934262, -668.5676419785075, -113.24664985426723, -314.0458221324747, -917.0255726022546, -861.0341435578073, -34.50416614754398, -1519.2828942020888, -272.5657341049177, -256.9649732701829, -980.6844795773728, -354.5529941069843, -93.431668611802, -152.2313758852768, -306.61673791972225, -21.792903353314877, -826.8502771500666, -115.3435593108987, -394.50135871312506, -871.8490413484818, -811.8062870159945, -568.2597214228181, -240.0542177458483, -152.96410019422285, -415.6195160677967, -120.96416394297131, -15.635958358533516, -98.62436005464686, -46.01025250655246, -1069.5825487342838, -579.4280342444175, -29.63382051322121, -1063.7397805362225, -995.7265195262202, -63.95819555227158, -699.658806876644, -978.3895638908094, -1031.8178708404341, -267.2067165256439, -18.54288968800541, -1169.8529287818174, -750.4683588786928, -240.70401377167164, -158.76076023051326, -150.1390763549622, -638.5334551132509, -1113.4492400462377, -663.3518206409991, -239.54700495597174, -131.50374698930435, -1258.9616954949427, -1051.0211950630435, -141.28786160849262, -917.0918410293601, -217.65915110642894, -182.00400303150275, -255.4660670018174, -531.0093856298516, -610.296829227945, -756.8266183354878, -392.7078103238304, -132.57649044876393, -136.83192567246982, -237.80103088960482, -1206.2735814452124, -238.24458850409823, -324.36218294475617, -811.4481724854677, -942.6858128178011, -874.8208605508923, -216.22156026443608, -718.2644507961887, -317.39806482553695, -1105.1083205177777, -42.67006362217825, -1047.9461139592515, -920.0405722005654, -1356.4376614320317, -323.560553738479, -40.90460205721177, -310.6856766342909, -1097.8552886498758, -731.554846525738, -306.54895256263944, -1202.6685958281416, -1465.1249100036923, -259.68176565203623, -70.02901858324738, -446.73379278348904, -963.2943522787085, -1152.257653386122, -426.4666623938454, -144.94650332870725, -40.10035411868324, -440.46561621584226, -996.7075071783388, -355.1552333961249, -313.3538213989782, -70.47464587901531, -574.8781643243407, -473.65362016037875, -314.32402356642945, -584.9276306283929, -1161.0829739215533, -177.01787886718446, -76.42582403011926, -1267.041583641174, -266.8765212987986, -462.75708659238467, -1421.863638164003, -1397.9101351502634, -206.58942587501457, -882.5989265479179, -654.2448013852844, -1131.467284386972, -368.4777560743069, -1233.8323928057312, -212.6268397599109, -975.5446927097537, -882.3352161097265, -128.66399037301335, -791.3343831137805, -428.12230115093405, -146.3897934505006, -61.00777359825082, -374.75610417295786, -83.68543020826098, -78.01324774386444, -996.7527666673229, -84.59248954825728, -539.0559627456507, -352.65568910303705, -484.27550436303795, -416.52698166905935, -691.7483011345611, -206.587344970288, -741.339106294691, -1007.2286819376731, -319.1308684712737, -409.64533257852463, -665.8481333192804, -792.5674192312513, -84.36698793911053, -1256.735753276876, -101.30311422473596, -361.9911815517761, -528.0483271441022, -493.70250124471016, -152.17882354412419, -481.7520864377877, -29.153659763403414, -85.77792220744384, -572.7712634668458, -594.0250028505739, -10.675723037508885, -982.642965540945, -39.563166004731784, -548.0395928798566, -151.87971268856427, -40.50693529272058, -31.087317418646787, -1044.2697450193036, -218.99759803778633, -315.35739506154897, -12.309243828576967, -1029.2951752480217, -22.02480020044767, -1130.234791162367, -225.6045843993986, -98.85033350730336, -228.03366883988133, -470.25011728846374, -240.99053055502193, -71.80449266752696, -1080.3391921854109, -774.5819332659157, -970.6680942048213, -1164.7875644887054, -421.7918503583028, -1067.0950431432063, -479.1065527128607, -968.4692365018605, -293.0935583025019, -1195.0256399541513, -586.6667241020068, -324.68201828531426, -64.94388134272994, -1231.8778073324613, -159.68640770924947, -518.4785288317355, -212.63880987919663, -235.3736767561552, -1280.9793935501314, -1228.0480182865185, -461.0301898803578, -266.2743710431315, -818.8855895955547, -744.4542368169118, -586.1128499226004, -1111.1452636950453, -527.5568208164251, -135.29469640033574, -429.8612750786605, -1179.864274800292, -677.3869376549678, -185.97216738861738, -403.0444206241965, -130.43890551499587, -87.21737517193934, -407.77381102090214, -135.60493031370586, -252.03102200512757, -738.9226035532379, -331.1246503281619, -365.0294061922571, -939.8403697444767, -272.29903898076634, -1238.1955287629025, -146.97551687552277, -642.1250818337066, -1339.6385367998912, -197.49367773125473, -274.955444775833, -1115.0626959639237, -435.9217216685468, -130.9825584838255, -482.68707225873936, -20.285958755890974, -220.2492375124296, -311.07629144630585, -109.43314679667127, -331.08116827430376, -51.42291173956329, -1226.2724322618365, -789.7674661146073, -173.3135095748311, -533.0754797364189, -383.07446434384485, -618.626716523239, -772.4141020332886, -63.02356415425009, -230.1051191021348, -49.17960092315985, -60.13675951582293, -77.02572745548893, -112.37262657016623, -101.78517581499649, -1137.0846148602013, -251.92304092165722, -49.477973422537644, -866.3791918586733, -47.53419054529479, -397.3299296324263, -73.321876185303]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4651881077411861, "mean_inference_ms": 1.6828632571175164, "mean_action_processing_ms": 0.7684954396688081, "mean_env_wait_ms": 9.788074891766726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01231241226196289, "StateBufferConnector_ms": 0.008929014205932617, "ViewRequirementAgentConnector_ms": 0.2869222164154053}, "num_episodes": 25, "episode_return_max": -402.5643261374734, "episode_return_min": -4610.65697099114, "episode_return_mean": -2531.621697409088, "episodes_this_iter": 25}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1714274, "num_agent_steps_trained": 1714274, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 89.028279059886, "num_env_steps_trained_throughput_per_sec": 89.028279059886, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1714274, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1714274, "timers": {"training_iteration_time_ms": 51849.792, "restore_workers_time_ms": 0.026, "training_step_time_ms": 51849.724, "sample_time_ms": 3218.892, "learn_time_ms": 48574.166, "learn_throughput": 82.348, "synch_weights_time_ms": 53.899}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1714274, "num_agent_steps_trained": 1714274}, "done": true, "training_iteration": 100, "trial_id": "efc54_00000", "date": "2024-07-24_20-10-04", "timestamp": 1721832004, "time_this_iter_s": 44.94222664833069, "time_total_s": 5398.90313410759, "pid": 12596, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x717514110040>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5398.90313410759, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 10.15873015873016, "ram_util_percent": 24.42698412698414}}
