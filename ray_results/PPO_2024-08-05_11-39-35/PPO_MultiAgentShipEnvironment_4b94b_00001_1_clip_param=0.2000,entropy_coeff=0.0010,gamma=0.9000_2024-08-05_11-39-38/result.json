{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7799988638609647, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.856034344931443, "policy_loss": -0.00761920463022155, "vf_loss": 8.863110770781836, "vf_explained_var": 0.048691172649463016, "kl": 0.00974403929305178, "entropy": 1.406055660173297, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -29.84639244633183, "episode_reward_min": -1483.8984813582, "episode_reward_mean": -733.3176253488156, "episode_len_mean": 122.25925925925925, "episode_media": {}, "episodes_timesteps_total": 3301, "policy_reward_min": {"policy_0": -1483.8984813582}, "policy_reward_max": {"policy_0": -29.84639244633183}, "policy_reward_mean": {"policy_0": -733.3176253488156}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1404.978152671416, -1105.4181041074005, -1097.498074843994, -1151.2818954520826, -973.6024714825171, -523.024508101153, -1128.4164156666216, -371.7402655689751, -157.05728265117517, -29.84639244633183, -272.670654648485, -89.98393532906444, -1005.0629934722396, -160.3388043004844, -1269.098760928173, -1067.501531354298, -682.1705138256656, -924.7903872573746, -1114.9509737671708, -1483.8984813582, -233.5518299254357, -179.44858082701654, -1220.960566573801, -232.1508099379886, -166.71207142791195, -977.0119367116805, -776.409489781361], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 101, 53, 51, 92, 60, 150, 73, 150, 150, 150, 150, 150, 150, 74, 85, 150, 76, 86, 150, 150], "policy_policy_0_reward": [-1404.978152671416, -1105.4181041074005, -1097.498074843994, -1151.2818954520826, -973.6024714825171, -523.024508101153, -1128.4164156666216, -371.7402655689751, -157.05728265117517, -29.84639244633183, -272.670654648485, -89.98393532906444, -1005.0629934722396, -160.3388043004844, -1269.098760928173, -1067.501531354298, -682.1705138256656, -924.7903872573746, -1114.9509737671708, -1483.8984813582, -233.5518299254357, -179.44858082701654, -1220.960566573801, -232.1508099379886, -166.71207142791195, -977.0119367116805, -776.409489781361]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.575363006874831, "mean_inference_ms": 1.6890210530578542, "mean_action_processing_ms": 0.2810799883409971, "mean_env_wait_ms": 3.384476396453603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012901977256492333, "StateBufferConnector_ms": 0.008388801857277198, "ViewRequirementAgentConnector_ms": 0.18443178247522424}, "num_episodes": 27, "episode_return_max": -29.84639244633183, "episode_return_min": -1483.8984813582, "episode_return_mean": -733.3176253488156, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.4658796355122, "num_env_steps_trained_throughput_per_sec": 314.4658796355122, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 12719.991, "restore_workers_time_ms": 0.023, "training_step_time_ms": 12719.932, "sample_time_ms": 1124.147, "learn_time_ms": 11536.582, "learn_throughput": 346.723, "synch_weights_time_ms": 58.436}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "4b94b_00001", "date": "2024-08-05_12-00-40", "timestamp": 1722839440, "time_this_iter_s": 12.731789350509644, "time_total_s": 12.731789350509644, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e11156bf40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12.731789350509644, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 17.173684210526314, "ram_util_percent": 28.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.940237254090608, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.111752991378307, "policy_loss": -0.011604661654564552, "vf_loss": 8.121880762775739, "vf_explained_var": 0.2607105610271295, "kl": 0.014631919094783067, "entropy": 1.4494902120282254, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -8.546399985081555, "episode_reward_min": -1483.8984813582, "episode_reward_mean": -753.4026771392076, "episode_len_mean": 123.64814814814815, "episode_media": {}, "episodes_timesteps_total": 6677, "policy_reward_min": {"policy_0": -1483.8984813582}, "policy_reward_max": {"policy_0": -8.546399985081555}, "policy_reward_mean": {"policy_0": -753.4026771392076}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1404.978152671416, -1105.4181041074005, -1097.498074843994, -1151.2818954520826, -973.6024714825171, -523.024508101153, -1128.4164156666216, -371.7402655689751, -157.05728265117517, -29.84639244633183, -272.670654648485, -89.98393532906444, -1005.0629934722396, -160.3388043004844, -1269.098760928173, -1067.501531354298, -682.1705138256656, -924.7903872573746, -1114.9509737671708, -1483.8984813582, -233.5518299254357, -179.44858082701654, -1220.960566573801, -232.1508099379886, -166.71207142791195, -977.0119367116805, -776.409489781361, -975.2231148031325, -997.7347693645193, -1162.1749868320144, -35.21278650957472, -1073.2949493850763, -881.4251159875763, -1020.8466785656643, -1404.4241955039106, -1086.30421992144, -997.6249371173726, -8.546399985081555, -1110.4092376075291, -36.49227917464297, -888.056129133063, -11.482193639261602, -1177.1319988263288, -980.09635906597, -407.1238805739943, -1043.9535772080626, -934.0213812863618, -134.78789659120866, -631.6718547397398, -356.3360904434803, -1291.3297786471235, -964.6159498350772, -214.38408369616906, -1059.463836655822], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 101, 53, 51, 92, 60, 150, 73, 150, 150, 150, 150, 150, 150, 74, 85, 150, 76, 86, 150, 150, 150, 150, 150, 45, 150, 150, 150, 150, 150, 150, 43, 150, 42, 150, 34, 150, 150, 97, 150, 150, 58, 150, 136, 150, 150, 71, 150], "policy_policy_0_reward": [-1404.978152671416, -1105.4181041074005, -1097.498074843994, -1151.2818954520826, -973.6024714825171, -523.024508101153, -1128.4164156666216, -371.7402655689751, -157.05728265117517, -29.84639244633183, -272.670654648485, -89.98393532906444, -1005.0629934722396, -160.3388043004844, -1269.098760928173, -1067.501531354298, -682.1705138256656, -924.7903872573746, -1114.9509737671708, -1483.8984813582, -233.5518299254357, -179.44858082701654, -1220.960566573801, -232.1508099379886, -166.71207142791195, -977.0119367116805, -776.409489781361, -975.2231148031325, -997.7347693645193, -1162.1749868320144, -35.21278650957472, -1073.2949493850763, -881.4251159875763, -1020.8466785656643, -1404.4241955039106, -1086.30421992144, -997.6249371173726, -8.546399985081555, -1110.4092376075291, -36.49227917464297, -888.056129133063, -11.482193639261602, -1177.1319988263288, -980.09635906597, -407.1238805739943, -1043.9535772080626, -934.0213812863618, -134.78789659120866, -631.6718547397398, -356.3360904434803, -1291.3297786471235, -964.6159498350772, -214.38408369616906, -1059.463836655822]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.569894818341575, "mean_inference_ms": 1.680171557262727, "mean_action_processing_ms": 0.2810014997802535, "mean_env_wait_ms": 3.39020764407428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014499823252360025, "StateBufferConnector_ms": 0.008513750853361908, "ViewRequirementAgentConnector_ms": 0.18309001569394712}, "num_episodes": 27, "episode_return_max": -8.546399985081555, "episode_return_min": -1483.8984813582, "episode_return_mean": -753.4026771392076, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.1628539007154, "num_env_steps_trained_throughput_per_sec": 309.1628539007154, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 12829.084, "restore_workers_time_ms": 0.023, "training_step_time_ms": 12829.026, "sample_time_ms": 1125.327, "learn_time_ms": 11644.17, "learn_throughput": 343.52, "synch_weights_time_ms": 58.769}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "4b94b_00001", "date": "2024-08-05_12-00-53", "timestamp": 1722839453, "time_this_iter_s": 12.949830293655396, "time_total_s": 25.68161964416504, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1110a1090>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25.68161964416504, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 18.177777777777777, "ram_util_percent": 28.644444444444446}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 57.90622862974803, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.156140436977148, "policy_loss": -0.00728066661443639, "vf_loss": 5.162370712806781, "vf_explained_var": 0.8011948550119996, "kl": 0.012629021981532181, "entropy": 1.4754046202947697, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -8.546399985081555, "episode_reward_min": -1483.8984813582, "episode_reward_mean": -771.4538582641896, "episode_len_mean": 125.51190476190476, "episode_media": {}, "episodes_timesteps_total": 10543, "policy_reward_min": {"policy_0": -1483.8984813582}, "policy_reward_max": {"policy_0": -8.546399985081555}, "policy_reward_mean": {"policy_0": -771.4538582641896}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1404.978152671416, -1105.4181041074005, -1097.498074843994, -1151.2818954520826, -973.6024714825171, -523.024508101153, -1128.4164156666216, -371.7402655689751, -157.05728265117517, -29.84639244633183, -272.670654648485, -89.98393532906444, -1005.0629934722396, -160.3388043004844, -1269.098760928173, -1067.501531354298, -682.1705138256656, -924.7903872573746, -1114.9509737671708, -1483.8984813582, -233.5518299254357, -179.44858082701654, -1220.960566573801, -232.1508099379886, -166.71207142791195, -977.0119367116805, -776.409489781361, -975.2231148031325, -997.7347693645193, -1162.1749868320144, -35.21278650957472, -1073.2949493850763, -881.4251159875763, -1020.8466785656643, -1404.4241955039106, -1086.30421992144, -997.6249371173726, -8.546399985081555, -1110.4092376075291, -36.49227917464297, -888.056129133063, -11.482193639261602, -1177.1319988263288, -980.09635906597, -407.1238805739943, -1043.9535772080626, -934.0213812863618, -134.78789659120866, -631.6718547397398, -356.3360904434803, -1291.3297786471235, -964.6159498350772, -214.38408369616906, -1059.463836655822, -835.4320757690922, -1006.6606217721958, -270.861503462862, -381.30676972969604, -1159.8993902427485, -1412.8421599473259, -1177.4197420824999, -75.23119684221498, -794.7292415726555, -996.5489133188245, -1090.4455638343813, -97.98648128696462, -1197.5529965227388, -1153.9899495189125, -1186.8772593090382, -456.614332579855, -979.1877121738319, -23.54193094679904, -1300.5225072120124, -1341.1324761338558, -944.6156901256953, -1339.8790448644606, -874.9474974398826, -615.9895686644396, -127.17533303540198, -1008.3811760294413, -602.5176260926706, -71.71730666369177, -1101.8257049105646, -492.5477565899738], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 101, 53, 51, 92, 60, 150, 73, 150, 150, 150, 150, 150, 150, 74, 85, 150, 76, 86, 150, 150, 150, 150, 150, 45, 150, 150, 150, 150, 150, 150, 43, 150, 42, 150, 34, 150, 150, 97, 150, 150, 58, 150, 136, 150, 150, 71, 150, 150, 150, 92, 99, 150, 150, 150, 65, 150, 150, 150, 69, 150, 150, 150, 101, 150, 48, 150, 150, 150, 150, 150, 150, 61, 150, 150, 59, 150, 122], "policy_policy_0_reward": [-1404.978152671416, -1105.4181041074005, -1097.498074843994, -1151.2818954520826, -973.6024714825171, -523.024508101153, -1128.4164156666216, -371.7402655689751, -157.05728265117517, -29.84639244633183, -272.670654648485, -89.98393532906444, -1005.0629934722396, -160.3388043004844, -1269.098760928173, -1067.501531354298, -682.1705138256656, -924.7903872573746, -1114.9509737671708, -1483.8984813582, -233.5518299254357, -179.44858082701654, -1220.960566573801, -232.1508099379886, -166.71207142791195, -977.0119367116805, -776.409489781361, -975.2231148031325, -997.7347693645193, -1162.1749868320144, -35.21278650957472, -1073.2949493850763, -881.4251159875763, -1020.8466785656643, -1404.4241955039106, -1086.30421992144, -997.6249371173726, -8.546399985081555, -1110.4092376075291, -36.49227917464297, -888.056129133063, -11.482193639261602, -1177.1319988263288, -980.09635906597, -407.1238805739943, -1043.9535772080626, -934.0213812863618, -134.78789659120866, -631.6718547397398, -356.3360904434803, -1291.3297786471235, -964.6159498350772, -214.38408369616906, -1059.463836655822, -835.4320757690922, -1006.6606217721958, -270.861503462862, -381.30676972969604, -1159.8993902427485, -1412.8421599473259, -1177.4197420824999, -75.23119684221498, -794.7292415726555, -996.5489133188245, -1090.4455638343813, -97.98648128696462, -1197.5529965227388, -1153.9899495189125, -1186.8772593090382, -456.614332579855, -979.1877121738319, -23.54193094679904, -1300.5225072120124, -1341.1324761338558, -944.6156901256953, -1339.8790448644606, -874.9474974398826, -615.9895686644396, -127.17533303540198, -1008.3811760294413, -602.5176260926706, -71.71730666369177, -1101.8257049105646, -492.5477565899738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5664714248316722, "mean_inference_ms": 1.6748895833547277, "mean_action_processing_ms": 0.28004994031283686, "mean_env_wait_ms": 3.3969797414294822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013719002405802408, "StateBufferConnector_ms": 0.008582785016014463, "ViewRequirementAgentConnector_ms": 0.18520894504728772}, "num_episodes": 30, "episode_return_max": -8.546399985081555, "episode_return_min": -1483.8984813582, "episode_return_mean": -771.4538582641896, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.04430661306236, "num_env_steps_trained_throughput_per_sec": 314.04430661306236, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 12798.412, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12798.348, "sample_time_ms": 1116.182, "learn_time_ms": 11621.17, "learn_throughput": 344.199, "synch_weights_time_ms": 60.231}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "4b94b_00001", "date": "2024-08-05_12-01-06", "timestamp": 1722839466, "time_this_iter_s": 12.748335599899292, "time_total_s": 38.42995524406433, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e111113b50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 38.42995524406433, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 18.255555555555556, "ram_util_percent": 28.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 112.53503792087237, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.5918884556740522, "policy_loss": -0.01307209146519502, "vf_loss": 3.6031815841794015, "vf_explained_var": 0.9006687140092253, "kl": 0.016063588517196577, "entropy": 1.4337626813600461, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -8.546399985081555, "episode_reward_min": -1483.8984813582, "episode_reward_mean": -766.6099610062851, "episode_len_mean": 125.3, "episode_media": {}, "episodes_timesteps_total": 12530, "policy_reward_min": {"policy_0": -1483.8984813582}, "policy_reward_max": {"policy_0": -8.546399985081555}, "policy_reward_mean": {"policy_0": -766.6099610062851}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1269.098760928173, -1067.501531354298, -682.1705138256656, -924.7903872573746, -1114.9509737671708, -1483.8984813582, -233.5518299254357, -179.44858082701654, -1220.960566573801, -232.1508099379886, -166.71207142791195, -977.0119367116805, -776.409489781361, -975.2231148031325, -997.7347693645193, -1162.1749868320144, -35.21278650957472, -1073.2949493850763, -881.4251159875763, -1020.8466785656643, -1404.4241955039106, -1086.30421992144, -997.6249371173726, -8.546399985081555, -1110.4092376075291, -36.49227917464297, -888.056129133063, -11.482193639261602, -1177.1319988263288, -980.09635906597, -407.1238805739943, -1043.9535772080626, -934.0213812863618, -134.78789659120866, -631.6718547397398, -356.3360904434803, -1291.3297786471235, -964.6159498350772, -214.38408369616906, -1059.463836655822, -835.4320757690922, -1006.6606217721958, -270.861503462862, -381.30676972969604, -1159.8993902427485, -1412.8421599473259, -1177.4197420824999, -75.23119684221498, -794.7292415726555, -996.5489133188245, -1090.4455638343813, -97.98648128696462, -1197.5529965227388, -1153.9899495189125, -1186.8772593090382, -456.614332579855, -979.1877121738319, -23.54193094679904, -1300.5225072120124, -1341.1324761338558, -944.6156901256953, -1339.8790448644606, -874.9474974398826, -615.9895686644396, -127.17533303540198, -1008.3811760294413, -602.5176260926706, -71.71730666369177, -1101.8257049105646, -492.5477565899738, -1342.569493393817, -732.6854419731989, -1465.164380885251, -47.26211532208694, -627.0206612748036, -1025.969835303074, -1147.830388908359, -946.7200422605902, -151.25358512847512, -1177.1566195092778, -870.8538923216448, -1057.4781839602906, -78.21338168519445, -755.5922562792058, -879.0438411490828, -132.9430820246224, -1284.0738375135688, -1033.0850764444076, -868.7621327470847, -320.6344409801606, -1325.252338498319, -331.03323174333684, -654.2817197664729, -1216.0458783412912, -19.611493073217098, -235.66012832292688, -34.25555263110391, -701.4797269305503, -242.65140486727694, -625.2077939397903], "episode_lengths": [150, 150, 150, 150, 150, 150, 74, 85, 150, 76, 86, 150, 150, 150, 150, 150, 45, 150, 150, 150, 150, 150, 150, 43, 150, 42, 150, 34, 150, 150, 97, 150, 150, 58, 150, 136, 150, 150, 71, 150, 150, 150, 92, 99, 150, 150, 150, 65, 150, 150, 150, 69, 150, 150, 150, 101, 150, 48, 150, 150, 150, 150, 150, 150, 61, 150, 150, 59, 150, 122, 150, 150, 150, 53, 138, 150, 150, 150, 70, 150, 150, 150, 48, 150, 150, 71, 150, 150, 150, 81, 150, 82, 150, 150, 41, 81, 39, 150, 68, 145], "policy_policy_0_reward": [-1269.098760928173, -1067.501531354298, -682.1705138256656, -924.7903872573746, -1114.9509737671708, -1483.8984813582, -233.5518299254357, -179.44858082701654, -1220.960566573801, -232.1508099379886, -166.71207142791195, -977.0119367116805, -776.409489781361, -975.2231148031325, -997.7347693645193, -1162.1749868320144, -35.21278650957472, -1073.2949493850763, -881.4251159875763, -1020.8466785656643, -1404.4241955039106, -1086.30421992144, -997.6249371173726, -8.546399985081555, -1110.4092376075291, -36.49227917464297, -888.056129133063, -11.482193639261602, -1177.1319988263288, -980.09635906597, -407.1238805739943, -1043.9535772080626, -934.0213812863618, -134.78789659120866, -631.6718547397398, -356.3360904434803, -1291.3297786471235, -964.6159498350772, -214.38408369616906, -1059.463836655822, -835.4320757690922, -1006.6606217721958, -270.861503462862, -381.30676972969604, -1159.8993902427485, -1412.8421599473259, -1177.4197420824999, -75.23119684221498, -794.7292415726555, -996.5489133188245, -1090.4455638343813, -97.98648128696462, -1197.5529965227388, -1153.9899495189125, -1186.8772593090382, -456.614332579855, -979.1877121738319, -23.54193094679904, -1300.5225072120124, -1341.1324761338558, -944.6156901256953, -1339.8790448644606, -874.9474974398826, -615.9895686644396, -127.17533303540198, -1008.3811760294413, -602.5176260926706, -71.71730666369177, -1101.8257049105646, -492.5477565899738, -1342.569493393817, -732.6854419731989, -1465.164380885251, -47.26211532208694, -627.0206612748036, -1025.969835303074, -1147.830388908359, -946.7200422605902, -151.25358512847512, -1177.1566195092778, -870.8538923216448, -1057.4781839602906, -78.21338168519445, -755.5922562792058, -879.0438411490828, -132.9430820246224, -1284.0738375135688, -1033.0850764444076, -868.7621327470847, -320.6344409801606, -1325.252338498319, -331.03323174333684, -654.2817197664729, -1216.0458783412912, -19.611493073217098, -235.66012832292688, -34.25555263110391, -701.4797269305503, -242.65140486727694, -625.2077939397903]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5627989900299373, "mean_inference_ms": 1.667843730957217, "mean_action_processing_ms": 0.27889069269631045, "mean_env_wait_ms": 3.4036605859606435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013710975646972656, "StateBufferConnector_ms": 0.008740901947021484, "ViewRequirementAgentConnector_ms": 0.18545150756835938}, "num_episodes": 30, "episode_return_max": -8.546399985081555, "episode_return_min": -1483.8984813582, "episode_return_mean": -766.6099610062851, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.98897674636225, "num_env_steps_trained_throughput_per_sec": 313.98897674636225, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12783.638, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12783.572, "sample_time_ms": 1117.274, "learn_time_ms": 11602.822, "learn_throughput": 344.744, "synch_weights_time_ms": 62.7}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "4b94b_00001", "date": "2024-08-05_12-01-19", "timestamp": 1722839479, "time_this_iter_s": 12.7511727809906, "time_total_s": 51.18112802505493, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd0119f30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 51.18112802505493, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 18.28888888888889, "ram_util_percent": 28.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 145.1098382314046, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.650947816794117, "policy_loss": -0.01162822929181857, "vf_loss": 2.6604809439430634, "vf_explained_var": 0.9563703859845797, "kl": 0.017495341487286473, "entropy": 1.4039646265407404, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -19.611493073217098, "episode_reward_min": -1465.164380885251, "episode_reward_mean": -761.6920245801904, "episode_len_mean": 128.48, "episode_media": {}, "episodes_timesteps_total": 12848, "policy_reward_min": {"policy_0": -1465.164380885251}, "policy_reward_max": {"policy_0": -19.611493073217098}, "policy_reward_mean": {"policy_0": -761.6920245801904}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1043.9535772080626, -934.0213812863618, -134.78789659120866, -631.6718547397398, -356.3360904434803, -1291.3297786471235, -964.6159498350772, -214.38408369616906, -1059.463836655822, -835.4320757690922, -1006.6606217721958, -270.861503462862, -381.30676972969604, -1159.8993902427485, -1412.8421599473259, -1177.4197420824999, -75.23119684221498, -794.7292415726555, -996.5489133188245, -1090.4455638343813, -97.98648128696462, -1197.5529965227388, -1153.9899495189125, -1186.8772593090382, -456.614332579855, -979.1877121738319, -23.54193094679904, -1300.5225072120124, -1341.1324761338558, -944.6156901256953, -1339.8790448644606, -874.9474974398826, -615.9895686644396, -127.17533303540198, -1008.3811760294413, -602.5176260926706, -71.71730666369177, -1101.8257049105646, -492.5477565899738, -1342.569493393817, -732.6854419731989, -1465.164380885251, -47.26211532208694, -627.0206612748036, -1025.969835303074, -1147.830388908359, -946.7200422605902, -151.25358512847512, -1177.1566195092778, -870.8538923216448, -1057.4781839602906, -78.21338168519445, -755.5922562792058, -879.0438411490828, -132.9430820246224, -1284.0738375135688, -1033.0850764444076, -868.7621327470847, -320.6344409801606, -1325.252338498319, -331.03323174333684, -654.2817197664729, -1216.0458783412912, -19.611493073217098, -235.66012832292688, -34.25555263110391, -701.4797269305503, -242.65140486727694, -625.2077939397903, -942.0319205583285, -1198.3090285025287, -336.84959792467583, -97.86943113154332, -355.7471977430918, -315.8216562643147, -1241.986814459261, -940.8051054388503, -227.94717863226919, -1341.8396318522812, -1028.5511158826823, -1129.549990347661, -850.3725086461609, -378.54678548218493, -583.84954264126, -994.5391708180903, -845.7280960186677, -424.3047565971467, -874.9715746538651, -150.8639054147117, -677.7934910363493, -928.002432855585, -1032.4538999643148, -883.5757713603318, -1129.743264111934, -816.0466356684409, -935.1641046206717, -748.8201588280054, -1117.7342419747747, -371.2422268447908, -1189.405286788021], "episode_lengths": [150, 150, 58, 150, 136, 150, 150, 71, 150, 150, 150, 92, 99, 150, 150, 150, 65, 150, 150, 150, 69, 150, 150, 150, 101, 150, 48, 150, 150, 150, 150, 150, 150, 61, 150, 150, 59, 150, 122, 150, 150, 150, 53, 138, 150, 150, 150, 70, 150, 150, 150, 48, 150, 150, 71, 150, 150, 150, 81, 150, 82, 150, 150, 41, 81, 39, 150, 68, 145, 150, 150, 104, 70, 150, 87, 150, 150, 93, 150, 150, 150, 150, 88, 136, 150, 150, 147, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150], "policy_policy_0_reward": [-1043.9535772080626, -934.0213812863618, -134.78789659120866, -631.6718547397398, -356.3360904434803, -1291.3297786471235, -964.6159498350772, -214.38408369616906, -1059.463836655822, -835.4320757690922, -1006.6606217721958, -270.861503462862, -381.30676972969604, -1159.8993902427485, -1412.8421599473259, -1177.4197420824999, -75.23119684221498, -794.7292415726555, -996.5489133188245, -1090.4455638343813, -97.98648128696462, -1197.5529965227388, -1153.9899495189125, -1186.8772593090382, -456.614332579855, -979.1877121738319, -23.54193094679904, -1300.5225072120124, -1341.1324761338558, -944.6156901256953, -1339.8790448644606, -874.9474974398826, -615.9895686644396, -127.17533303540198, -1008.3811760294413, -602.5176260926706, -71.71730666369177, -1101.8257049105646, -492.5477565899738, -1342.569493393817, -732.6854419731989, -1465.164380885251, -47.26211532208694, -627.0206612748036, -1025.969835303074, -1147.830388908359, -946.7200422605902, -151.25358512847512, -1177.1566195092778, -870.8538923216448, -1057.4781839602906, -78.21338168519445, -755.5922562792058, -879.0438411490828, -132.9430820246224, -1284.0738375135688, -1033.0850764444076, -868.7621327470847, -320.6344409801606, -1325.252338498319, -331.03323174333684, -654.2817197664729, -1216.0458783412912, -19.611493073217098, -235.66012832292688, -34.25555263110391, -701.4797269305503, -242.65140486727694, -625.2077939397903, -942.0319205583285, -1198.3090285025287, -336.84959792467583, -97.86943113154332, -355.7471977430918, -315.8216562643147, -1241.986814459261, -940.8051054388503, -227.94717863226919, -1341.8396318522812, -1028.5511158826823, -1129.549990347661, -850.3725086461609, -378.54678548218493, -583.84954264126, -994.5391708180903, -845.7280960186677, -424.3047565971467, -874.9715746538651, -150.8639054147117, -677.7934910363493, -928.002432855585, -1032.4538999643148, -883.5757713603318, -1129.743264111934, -816.0466356684409, -935.1641046206717, -748.8201588280054, -1117.7342419747747, -371.2422268447908, -1189.405286788021]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5584458675915324, "mean_inference_ms": 1.6649321095201097, "mean_action_processing_ms": 0.27852363566433336, "mean_env_wait_ms": 3.4049738291677416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013463258743286133, "StateBufferConnector_ms": 0.008899688720703125, "ViewRequirementAgentConnector_ms": 0.18913507461547852}, "num_episodes": 31, "episode_return_max": -19.611493073217098, "episode_return_min": -1465.164380885251, "episode_return_mean": -761.6920245801904, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 321.13155064901156, "num_env_steps_trained_throughput_per_sec": 321.13155064901156, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 12718.104, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12718.038, "sample_time_ms": 1114.995, "learn_time_ms": 11540.679, "learn_throughput": 346.6, "synch_weights_time_ms": 61.584}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "4b94b_00001", "date": "2024-08-05_12-01-32", "timestamp": 1722839492, "time_this_iter_s": 12.46841549873352, "time_total_s": 63.64954352378845, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd011a170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 63.64954352378845, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 18.183333333333337, "ram_util_percent": 28.71111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 155.27830849885942, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.6173588829425474, "policy_loss": -0.014806288345425855, "vf_loss": 1.630549904331565, "vf_explained_var": 0.9886393376315633, "kl": 0.01489805350630983, "entropy": 1.3643439362446468, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -19.611493073217098, "episode_reward_min": -1465.164380885251, "episode_reward_mean": -743.8903742641517, "episode_len_mean": 129.69, "episode_media": {}, "episodes_timesteps_total": 12969, "policy_reward_min": {"policy_0": -1465.164380885251}, "policy_reward_max": {"policy_0": -19.611493073217098}, "policy_reward_mean": {"policy_0": -743.8903742641517}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-944.6156901256953, -1339.8790448644606, -874.9474974398826, -615.9895686644396, -127.17533303540198, -1008.3811760294413, -602.5176260926706, -71.71730666369177, -1101.8257049105646, -492.5477565899738, -1342.569493393817, -732.6854419731989, -1465.164380885251, -47.26211532208694, -627.0206612748036, -1025.969835303074, -1147.830388908359, -946.7200422605902, -151.25358512847512, -1177.1566195092778, -870.8538923216448, -1057.4781839602906, -78.21338168519445, -755.5922562792058, -879.0438411490828, -132.9430820246224, -1284.0738375135688, -1033.0850764444076, -868.7621327470847, -320.6344409801606, -1325.252338498319, -331.03323174333684, -654.2817197664729, -1216.0458783412912, -19.611493073217098, -235.66012832292688, -34.25555263110391, -701.4797269305503, -242.65140486727694, -625.2077939397903, -942.0319205583285, -1198.3090285025287, -336.84959792467583, -97.86943113154332, -355.7471977430918, -315.8216562643147, -1241.986814459261, -940.8051054388503, -227.94717863226919, -1341.8396318522812, -1028.5511158826823, -1129.549990347661, -850.3725086461609, -378.54678548218493, -583.84954264126, -994.5391708180903, -845.7280960186677, -424.3047565971467, -874.9715746538651, -150.8639054147117, -677.7934910363493, -928.002432855585, -1032.4538999643148, -883.5757713603318, -1129.743264111934, -816.0466356684409, -935.1641046206717, -748.8201588280054, -1117.7342419747747, -371.2422268447908, -1189.405286788021, -1107.8281793075184, -553.1238462203888, -153.7950724832402, -615.4746819428067, -762.8511543548385, -840.341080115643, -770.1092147483399, -134.6612080969799, -69.26590484292588, -462.5321212604271, -1187.3345888884544, -294.11653771394555, -1291.9231541336324, -1076.5651297285235, -1067.9360734742324, -739.7776573439268, -407.98638370853917, -826.9023006344568, -1021.1995880687833, -1037.638903332317, -1132.7148315640877, -122.99758442066457, -1188.633503329043, -1151.520957221845, -349.5451249795489, -985.3050579962425, -1037.0147254176122, -613.4801913525512, -786.6074850761645], "episode_lengths": [150, 150, 150, 150, 61, 150, 150, 59, 150, 122, 150, 150, 150, 53, 138, 150, 150, 150, 70, 150, 150, 150, 48, 150, 150, 71, 150, 150, 150, 81, 150, 82, 150, 150, 41, 81, 39, 150, 68, 145, 150, 150, 104, 70, 150, 87, 150, 150, 93, 150, 150, 150, 150, 88, 136, 150, 150, 147, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 63, 146, 150, 150, 150, 55, 58, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 108, 150, 150, 150, 150], "policy_policy_0_reward": [-944.6156901256953, -1339.8790448644606, -874.9474974398826, -615.9895686644396, -127.17533303540198, -1008.3811760294413, -602.5176260926706, -71.71730666369177, -1101.8257049105646, -492.5477565899738, -1342.569493393817, -732.6854419731989, -1465.164380885251, -47.26211532208694, -627.0206612748036, -1025.969835303074, -1147.830388908359, -946.7200422605902, -151.25358512847512, -1177.1566195092778, -870.8538923216448, -1057.4781839602906, -78.21338168519445, -755.5922562792058, -879.0438411490828, -132.9430820246224, -1284.0738375135688, -1033.0850764444076, -868.7621327470847, -320.6344409801606, -1325.252338498319, -331.03323174333684, -654.2817197664729, -1216.0458783412912, -19.611493073217098, -235.66012832292688, -34.25555263110391, -701.4797269305503, -242.65140486727694, -625.2077939397903, -942.0319205583285, -1198.3090285025287, -336.84959792467583, -97.86943113154332, -355.7471977430918, -315.8216562643147, -1241.986814459261, -940.8051054388503, -227.94717863226919, -1341.8396318522812, -1028.5511158826823, -1129.549990347661, -850.3725086461609, -378.54678548218493, -583.84954264126, -994.5391708180903, -845.7280960186677, -424.3047565971467, -874.9715746538651, -150.8639054147117, -677.7934910363493, -928.002432855585, -1032.4538999643148, -883.5757713603318, -1129.743264111934, -816.0466356684409, -935.1641046206717, -748.8201588280054, -1117.7342419747747, -371.2422268447908, -1189.405286788021, -1107.8281793075184, -553.1238462203888, -153.7950724832402, -615.4746819428067, -762.8511543548385, -840.341080115643, -770.1092147483399, -134.6612080969799, -69.26590484292588, -462.5321212604271, -1187.3345888884544, -294.11653771394555, -1291.9231541336324, -1076.5651297285235, -1067.9360734742324, -739.7776573439268, -407.98638370853917, -826.9023006344568, -1021.1995880687833, -1037.638903332317, -1132.7148315640877, -122.99758442066457, -1188.633503329043, -1151.520957221845, -349.5451249795489, -985.3050579962425, -1037.0147254176122, -613.4801913525512, -786.6074850761645]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5570105525136178, "mean_inference_ms": 1.6668585282410848, "mean_action_processing_ms": 0.27859049644707023, "mean_env_wait_ms": 3.4065696878005682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01344156265258789, "StateBufferConnector_ms": 0.008911609649658203, "ViewRequirementAgentConnector_ms": 0.18884634971618652}, "num_episodes": 29, "episode_return_max": -19.611493073217098, "episode_return_min": -1465.164380885251, "episode_return_mean": -743.8903742641517, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.20289318860006, "num_env_steps_trained_throughput_per_sec": 306.20289318860006, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12775.628, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12775.562, "sample_time_ms": 1123.065, "learn_time_ms": 11590.573, "learn_throughput": 345.108, "synch_weights_time_ms": 61.152}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "4b94b_00001", "date": "2024-08-05_12-01-45", "timestamp": 1722839505, "time_this_iter_s": 13.074488639831543, "time_total_s": 76.72403216362, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd011a440>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 76.72403216362, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 17.721052631578946, "ram_util_percent": 28.71578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 199.08315289517245, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.251708166829, "policy_loss": -0.005664607037518484, "vf_loss": 1.2560540745655695, "vf_explained_var": 0.9843127607057492, "kl": 0.012986307858106253, "entropy": 1.278560462842385, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -19.611493073217098, "episode_reward_min": -1341.8396318522812, "episode_reward_mean": -728.7587660464787, "episode_len_mean": 130.92, "episode_media": {}, "episodes_timesteps_total": 13092, "policy_reward_min": {"policy_0": -1341.8396318522812}, "policy_reward_max": {"policy_0": -19.611493073217098}, "policy_reward_mean": {"policy_0": -728.7587660464787}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-654.2817197664729, -1216.0458783412912, -19.611493073217098, -235.66012832292688, -34.25555263110391, -701.4797269305503, -242.65140486727694, -625.2077939397903, -942.0319205583285, -1198.3090285025287, -336.84959792467583, -97.86943113154332, -355.7471977430918, -315.8216562643147, -1241.986814459261, -940.8051054388503, -227.94717863226919, -1341.8396318522812, -1028.5511158826823, -1129.549990347661, -850.3725086461609, -378.54678548218493, -583.84954264126, -994.5391708180903, -845.7280960186677, -424.3047565971467, -874.9715746538651, -150.8639054147117, -677.7934910363493, -928.002432855585, -1032.4538999643148, -883.5757713603318, -1129.743264111934, -816.0466356684409, -935.1641046206717, -748.8201588280054, -1117.7342419747747, -371.2422268447908, -1189.405286788021, -1107.8281793075184, -553.1238462203888, -153.7950724832402, -615.4746819428067, -762.8511543548385, -840.341080115643, -770.1092147483399, -134.6612080969799, -69.26590484292588, -462.5321212604271, -1187.3345888884544, -294.11653771394555, -1291.9231541336324, -1076.5651297285235, -1067.9360734742324, -739.7776573439268, -407.98638370853917, -826.9023006344568, -1021.1995880687833, -1037.638903332317, -1132.7148315640877, -122.99758442066457, -1188.633503329043, -1151.520957221845, -349.5451249795489, -985.3050579962425, -1037.0147254176122, -613.4801913525512, -786.6074850761645, -1008.2469792549547, -997.6921825997669, -1149.3703993480044, -700.9131944799449, -820.0016294617401, -1011.1582266984968, -257.419549831003, -75.64153918952448, -1280.5666014484084, -1304.4659301055087, -556.0413870649771, -1083.4337164554331, -975.9529356501074, -165.6325386598982, -289.183441300041, -600.7154009605173, -1005.8095865252852, -151.3842491744134, -1037.0016096359147, -966.5830545291951, -1337.5693599513395, -519.558769547896, -801.2541543037145, -433.99816544132244, -617.1677297277816, -910.1765392236176, -471.0987789634313, -962.8487972362589, -144.30535818783744, -1250.7127488617232, -335.36067594288386, -45.768912193834396], "episode_lengths": [150, 150, 41, 81, 39, 150, 68, 145, 150, 150, 104, 70, 150, 87, 150, 150, 93, 150, 150, 150, 150, 88, 136, 150, 150, 147, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 63, 146, 150, 150, 150, 55, 58, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 141, 150, 150, 75, 58, 150, 150, 150, 150, 150, 68, 100, 150, 150, 150, 150, 150, 150, 117, 150, 99, 150, 150, 150, 150, 96, 150, 108, 46], "policy_policy_0_reward": [-654.2817197664729, -1216.0458783412912, -19.611493073217098, -235.66012832292688, -34.25555263110391, -701.4797269305503, -242.65140486727694, -625.2077939397903, -942.0319205583285, -1198.3090285025287, -336.84959792467583, -97.86943113154332, -355.7471977430918, -315.8216562643147, -1241.986814459261, -940.8051054388503, -227.94717863226919, -1341.8396318522812, -1028.5511158826823, -1129.549990347661, -850.3725086461609, -378.54678548218493, -583.84954264126, -994.5391708180903, -845.7280960186677, -424.3047565971467, -874.9715746538651, -150.8639054147117, -677.7934910363493, -928.002432855585, -1032.4538999643148, -883.5757713603318, -1129.743264111934, -816.0466356684409, -935.1641046206717, -748.8201588280054, -1117.7342419747747, -371.2422268447908, -1189.405286788021, -1107.8281793075184, -553.1238462203888, -153.7950724832402, -615.4746819428067, -762.8511543548385, -840.341080115643, -770.1092147483399, -134.6612080969799, -69.26590484292588, -462.5321212604271, -1187.3345888884544, -294.11653771394555, -1291.9231541336324, -1076.5651297285235, -1067.9360734742324, -739.7776573439268, -407.98638370853917, -826.9023006344568, -1021.1995880687833, -1037.638903332317, -1132.7148315640877, -122.99758442066457, -1188.633503329043, -1151.520957221845, -349.5451249795489, -985.3050579962425, -1037.0147254176122, -613.4801913525512, -786.6074850761645, -1008.2469792549547, -997.6921825997669, -1149.3703993480044, -700.9131944799449, -820.0016294617401, -1011.1582266984968, -257.419549831003, -75.64153918952448, -1280.5666014484084, -1304.4659301055087, -556.0413870649771, -1083.4337164554331, -975.9529356501074, -165.6325386598982, -289.183441300041, -600.7154009605173, -1005.8095865252852, -151.3842491744134, -1037.0016096359147, -966.5830545291951, -1337.5693599513395, -519.558769547896, -801.2541543037145, -433.99816544132244, -617.1677297277816, -910.1765392236176, -471.0987789634313, -962.8487972362589, -144.30535818783744, -1250.7127488617232, -335.36067594288386, -45.768912193834396]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.557915025847043, "mean_inference_ms": 1.667229633016421, "mean_action_processing_ms": 0.27849264518879907, "mean_env_wait_ms": 3.408667244144942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013213634490966797, "StateBufferConnector_ms": 0.008628368377685547, "ViewRequirementAgentConnector_ms": 0.18948674201965332}, "num_episodes": 32, "episode_return_max": -19.611493073217098, "episode_return_min": -1341.8396318522812, "episode_return_mean": -728.7587660464787, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.3292551750866, "num_env_steps_trained_throughput_per_sec": 315.3292551750866, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12762.705, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12762.639, "sample_time_ms": 1122.807, "learn_time_ms": 11578.607, "learn_throughput": 345.465, "synch_weights_time_ms": 60.456}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "4b94b_00001", "date": "2024-08-05_12-01-57", "timestamp": 1722839517, "time_this_iter_s": 12.69707989692688, "time_total_s": 89.42111206054688, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1110a1090>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 89.42111206054688, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 18.022222222222222, "ram_util_percent": 28.71111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 220.99549653828143, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.2031415552521745, "policy_loss": -0.004647014628668937, "vf_loss": 1.2064918795600534, "vf_explained_var": 0.989726267568767, "kl": 0.013060847259839647, "entropy": 1.31548071205616, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -40.552155485498076, "episode_reward_min": -1361.2626673601105, "episode_reward_mean": -764.7326120463433, "episode_len_mean": 132.9, "episode_media": {}, "episodes_timesteps_total": 13290, "policy_reward_min": {"policy_0": -1361.2626673601105}, "policy_reward_max": {"policy_0": -40.552155485498076}, "policy_reward_mean": {"policy_0": -764.7326120463433}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-928.002432855585, -1032.4538999643148, -883.5757713603318, -1129.743264111934, -816.0466356684409, -935.1641046206717, -748.8201588280054, -1117.7342419747747, -371.2422268447908, -1189.405286788021, -1107.8281793075184, -553.1238462203888, -153.7950724832402, -615.4746819428067, -762.8511543548385, -840.341080115643, -770.1092147483399, -134.6612080969799, -69.26590484292588, -462.5321212604271, -1187.3345888884544, -294.11653771394555, -1291.9231541336324, -1076.5651297285235, -1067.9360734742324, -739.7776573439268, -407.98638370853917, -826.9023006344568, -1021.1995880687833, -1037.638903332317, -1132.7148315640877, -122.99758442066457, -1188.633503329043, -1151.520957221845, -349.5451249795489, -985.3050579962425, -1037.0147254176122, -613.4801913525512, -786.6074850761645, -1008.2469792549547, -997.6921825997669, -1149.3703993480044, -700.9131944799449, -820.0016294617401, -1011.1582266984968, -257.419549831003, -75.64153918952448, -1280.5666014484084, -1304.4659301055087, -556.0413870649771, -1083.4337164554331, -975.9529356501074, -165.6325386598982, -289.183441300041, -600.7154009605173, -1005.8095865252852, -151.3842491744134, -1037.0016096359147, -966.5830545291951, -1337.5693599513395, -519.558769547896, -801.2541543037145, -433.99816544132244, -617.1677297277816, -910.1765392236176, -471.0987789634313, -962.8487972362589, -144.30535818783744, -1250.7127488617232, -335.36067594288386, -45.768912193834396, -965.3470898764537, -1191.008239247495, -40.552155485498076, -1361.2626673601105, -976.1443762731546, -869.8639957927892, -1123.4815687930868, -400.44929297266793, -775.4693758319285, -1356.8382434132154, -812.1587026928821, -686.2210346984654, -901.7946446673552, -724.5275726680026, -916.6484968780952, -852.443301787036, -901.5713254628081, -848.3957473992972, -130.79312819417927, -262.5376759575324, -1008.6766956696248, -780.3945674071374, -519.1239208738207, -349.11538239524515, -45.955682558726785, -302.27641781093496, -957.2409682542612, -968.9995222467945, -1235.5650052363915], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 63, 146, 150, 150, 150, 55, 58, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 141, 150, 150, 75, 58, 150, 150, 150, 150, 150, 68, 100, 150, 150, 150, 150, 150, 150, 117, 150, 99, 150, 150, 150, 150, 96, 150, 108, 46, 150, 150, 46, 150, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72, 73, 150, 150, 115, 85, 59, 80, 150, 150, 150], "policy_policy_0_reward": [-928.002432855585, -1032.4538999643148, -883.5757713603318, -1129.743264111934, -816.0466356684409, -935.1641046206717, -748.8201588280054, -1117.7342419747747, -371.2422268447908, -1189.405286788021, -1107.8281793075184, -553.1238462203888, -153.7950724832402, -615.4746819428067, -762.8511543548385, -840.341080115643, -770.1092147483399, -134.6612080969799, -69.26590484292588, -462.5321212604271, -1187.3345888884544, -294.11653771394555, -1291.9231541336324, -1076.5651297285235, -1067.9360734742324, -739.7776573439268, -407.98638370853917, -826.9023006344568, -1021.1995880687833, -1037.638903332317, -1132.7148315640877, -122.99758442066457, -1188.633503329043, -1151.520957221845, -349.5451249795489, -985.3050579962425, -1037.0147254176122, -613.4801913525512, -786.6074850761645, -1008.2469792549547, -997.6921825997669, -1149.3703993480044, -700.9131944799449, -820.0016294617401, -1011.1582266984968, -257.419549831003, -75.64153918952448, -1280.5666014484084, -1304.4659301055087, -556.0413870649771, -1083.4337164554331, -975.9529356501074, -165.6325386598982, -289.183441300041, -600.7154009605173, -1005.8095865252852, -151.3842491744134, -1037.0016096359147, -966.5830545291951, -1337.5693599513395, -519.558769547896, -801.2541543037145, -433.99816544132244, -617.1677297277816, -910.1765392236176, -471.0987789634313, -962.8487972362589, -144.30535818783744, -1250.7127488617232, -335.36067594288386, -45.768912193834396, -965.3470898764537, -1191.008239247495, -40.552155485498076, -1361.2626673601105, -976.1443762731546, -869.8639957927892, -1123.4815687930868, -400.44929297266793, -775.4693758319285, -1356.8382434132154, -812.1587026928821, -686.2210346984654, -901.7946446673552, -724.5275726680026, -916.6484968780952, -852.443301787036, -901.5713254628081, -848.3957473992972, -130.79312819417927, -262.5376759575324, -1008.6766956696248, -780.3945674071374, -519.1239208738207, -349.11538239524515, -45.955682558726785, -302.27641781093496, -957.2409682542612, -968.9995222467945, -1235.5650052363915]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5579038997671403, "mean_inference_ms": 1.670272139864441, "mean_action_processing_ms": 0.2785670806609883, "mean_env_wait_ms": 3.4159785513947605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012719154357910156, "StateBufferConnector_ms": 0.00841665267944336, "ViewRequirementAgentConnector_ms": 0.18871068954467773}, "num_episodes": 29, "episode_return_max": -40.552155485498076, "episode_return_min": -1361.2626673601105, "episode_return_mean": -764.7326120463433, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.0620564243027, "num_env_steps_trained_throughput_per_sec": 311.0620564243027, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12774.765, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12774.698, "sample_time_ms": 1123.34, "learn_time_ms": 11588.765, "learn_throughput": 345.162, "synch_weights_time_ms": 61.814}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "4b94b_00001", "date": "2024-08-05_12-02-10", "timestamp": 1722839530, "time_this_iter_s": 12.871358871459961, "time_total_s": 102.29247093200684, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd0119f30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 102.29247093200684, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 18.116666666666664, "ram_util_percent": 28.705555555555552}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 184.9280564516783, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.9560985916294158, "policy_loss": -0.01222419317685611, "vf_loss": 0.9667466145008803, "vf_explained_var": 0.9940449046591918, "kl": 0.014722928970377332, "entropy": 1.3684142702569564, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -36.499038817147635, "episode_reward_min": -1386.49164830484, "episode_reward_mean": -743.0854207131889, "episode_len_mean": 132.22, "episode_media": {}, "episodes_timesteps_total": 13222, "policy_reward_min": {"policy_0": -1386.49164830484}, "policy_reward_max": {"policy_0": -36.499038817147635}, "policy_reward_mean": {"policy_0": -743.0854207131889}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-122.99758442066457, -1188.633503329043, -1151.520957221845, -349.5451249795489, -985.3050579962425, -1037.0147254176122, -613.4801913525512, -786.6074850761645, -1008.2469792549547, -997.6921825997669, -1149.3703993480044, -700.9131944799449, -820.0016294617401, -1011.1582266984968, -257.419549831003, -75.64153918952448, -1280.5666014484084, -1304.4659301055087, -556.0413870649771, -1083.4337164554331, -975.9529356501074, -165.6325386598982, -289.183441300041, -600.7154009605173, -1005.8095865252852, -151.3842491744134, -1037.0016096359147, -966.5830545291951, -1337.5693599513395, -519.558769547896, -801.2541543037145, -433.99816544132244, -617.1677297277816, -910.1765392236176, -471.0987789634313, -962.8487972362589, -144.30535818783744, -1250.7127488617232, -335.36067594288386, -45.768912193834396, -965.3470898764537, -1191.008239247495, -40.552155485498076, -1361.2626673601105, -976.1443762731546, -869.8639957927892, -1123.4815687930868, -400.44929297266793, -775.4693758319285, -1356.8382434132154, -812.1587026928821, -686.2210346984654, -901.7946446673552, -724.5275726680026, -916.6484968780952, -852.443301787036, -901.5713254628081, -848.3957473992972, -130.79312819417927, -262.5376759575324, -1008.6766956696248, -780.3945674071374, -519.1239208738207, -349.11538239524515, -45.955682558726785, -302.27641781093496, -957.2409682542612, -968.9995222467945, -1235.5650052363915, -197.96167099469517, -486.8489217780332, -703.7622892653435, -1196.842275253624, -1256.7572366005395, -825.2470141561569, -1025.2232802477959, -36.499038817147635, -252.44116501866196, -1041.9708834661249, -753.967999538288, -989.1173736165797, -967.9188977795652, -124.269444262967, -786.949824963221, -917.561754706941, -624.985770549536, -735.2170593965506, -741.6211301928205, -661.7145837300342, -1163.6025814367858, -979.8564428512381, -886.0790284858118, -952.8489229495783, -838.5251089416636, -426.70753768424294, -174.61822963254644, -501.4525784860191, -387.6486917235139, -516.8381168345779, -1386.49164830484], "episode_lengths": [50, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 141, 150, 150, 75, 58, 150, 150, 150, 150, 150, 68, 100, 150, 150, 150, 150, 150, 150, 117, 150, 99, 150, 150, 150, 150, 96, 150, 108, 46, 150, 150, 46, 150, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72, 73, 150, 150, 115, 85, 59, 80, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 52, 77, 150, 150, 150, 150, 66, 150, 150, 150, 150, 150, 129, 150, 150, 150, 150, 150, 119, 89, 150, 146, 123, 150], "policy_policy_0_reward": [-122.99758442066457, -1188.633503329043, -1151.520957221845, -349.5451249795489, -985.3050579962425, -1037.0147254176122, -613.4801913525512, -786.6074850761645, -1008.2469792549547, -997.6921825997669, -1149.3703993480044, -700.9131944799449, -820.0016294617401, -1011.1582266984968, -257.419549831003, -75.64153918952448, -1280.5666014484084, -1304.4659301055087, -556.0413870649771, -1083.4337164554331, -975.9529356501074, -165.6325386598982, -289.183441300041, -600.7154009605173, -1005.8095865252852, -151.3842491744134, -1037.0016096359147, -966.5830545291951, -1337.5693599513395, -519.558769547896, -801.2541543037145, -433.99816544132244, -617.1677297277816, -910.1765392236176, -471.0987789634313, -962.8487972362589, -144.30535818783744, -1250.7127488617232, -335.36067594288386, -45.768912193834396, -965.3470898764537, -1191.008239247495, -40.552155485498076, -1361.2626673601105, -976.1443762731546, -869.8639957927892, -1123.4815687930868, -400.44929297266793, -775.4693758319285, -1356.8382434132154, -812.1587026928821, -686.2210346984654, -901.7946446673552, -724.5275726680026, -916.6484968780952, -852.443301787036, -901.5713254628081, -848.3957473992972, -130.79312819417927, -262.5376759575324, -1008.6766956696248, -780.3945674071374, -519.1239208738207, -349.11538239524515, -45.955682558726785, -302.27641781093496, -957.2409682542612, -968.9995222467945, -1235.5650052363915, -197.96167099469517, -486.8489217780332, -703.7622892653435, -1196.842275253624, -1256.7572366005395, -825.2470141561569, -1025.2232802477959, -36.499038817147635, -252.44116501866196, -1041.9708834661249, -753.967999538288, -989.1173736165797, -967.9188977795652, -124.269444262967, -786.949824963221, -917.561754706941, -624.985770549536, -735.2170593965506, -741.6211301928205, -661.7145837300342, -1163.6025814367858, -979.8564428512381, -886.0790284858118, -952.8489229495783, -838.5251089416636, -426.70753768424294, -174.61822963254644, -501.4525784860191, -387.6486917235139, -516.8381168345779, -1386.49164830484]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5589906787356922, "mean_inference_ms": 1.6700255889945046, "mean_action_processing_ms": 0.27807131348492675, "mean_env_wait_ms": 3.4178379124644906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01230311393737793, "StateBufferConnector_ms": 0.008229494094848633, "ViewRequirementAgentConnector_ms": 0.1912975311279297}, "num_episodes": 31, "episode_return_max": -36.499038817147635, "episode_return_min": -1386.49164830484, "episode_return_mean": -743.0854207131889, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 354.4212643767761, "num_env_steps_trained_throughput_per_sec": 354.4212643767761, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12609.349, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12609.282, "sample_time_ms": 1124.942, "learn_time_ms": 11421.984, "learn_throughput": 350.202, "synch_weights_time_ms": 61.579}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "4b94b_00001", "date": "2024-08-05_12-02-22", "timestamp": 1722839542, "time_this_iter_s": 11.297642946243286, "time_total_s": 113.59011387825012, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd011b520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 113.59011387825012, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 19.2375, "ram_util_percent": 28.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 174.5961829662323, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.9262259283879151, "policy_loss": -0.010152480654263248, "vf_loss": 0.9347589679993689, "vf_explained_var": 0.9970530497531096, "kl": 0.014600676105419551, "entropy": 1.3006961269925037, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -36.499038817147635, "episode_reward_min": -1386.49164830484, "episode_reward_mean": -742.8087928651685, "episode_len_mean": 134.13, "episode_media": {}, "episodes_timesteps_total": 13413, "policy_reward_min": {"policy_0": -1386.49164830484}, "policy_reward_max": {"policy_0": -36.499038817147635}, "policy_reward_mean": {"policy_0": -742.8087928651685}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-801.2541543037145, -433.99816544132244, -617.1677297277816, -910.1765392236176, -471.0987789634313, -962.8487972362589, -144.30535818783744, -1250.7127488617232, -335.36067594288386, -45.768912193834396, -965.3470898764537, -1191.008239247495, -40.552155485498076, -1361.2626673601105, -976.1443762731546, -869.8639957927892, -1123.4815687930868, -400.44929297266793, -775.4693758319285, -1356.8382434132154, -812.1587026928821, -686.2210346984654, -901.7946446673552, -724.5275726680026, -916.6484968780952, -852.443301787036, -901.5713254628081, -848.3957473992972, -130.79312819417927, -262.5376759575324, -1008.6766956696248, -780.3945674071374, -519.1239208738207, -349.11538239524515, -45.955682558726785, -302.27641781093496, -957.2409682542612, -968.9995222467945, -1235.5650052363915, -197.96167099469517, -486.8489217780332, -703.7622892653435, -1196.842275253624, -1256.7572366005395, -825.2470141561569, -1025.2232802477959, -36.499038817147635, -252.44116501866196, -1041.9708834661249, -753.967999538288, -989.1173736165797, -967.9188977795652, -124.269444262967, -786.949824963221, -917.561754706941, -624.985770549536, -735.2170593965506, -741.6211301928205, -661.7145837300342, -1163.6025814367858, -979.8564428512381, -886.0790284858118, -952.8489229495783, -838.5251089416636, -426.70753768424294, -174.61822963254644, -501.4525784860191, -387.6486917235139, -516.8381168345779, -1386.49164830484, -844.2352352888342, -795.7007635872404, -1218.3335135856687, -626.1486122247289, -1212.452476855876, -235.08971735845032, -285.8591745015476, -756.8403464715497, -917.8143293943587, -459.8102454468168, -1208.9960419691004, -1143.949277598947, -1060.982920938576, -1060.2969475695795, -554.1222724336644, -1298.8013195881797, -580.5965059244797, -737.6032093670823, -1011.4226438406042, -929.2701378569377, -125.7957186313571, -904.821643063158, -760.2085487953639, -410.3750705375671, -893.6876988205173, -826.5295612938985, -195.66592062873278, -939.3133834472217, -1220.801470577631, -286.2594192663406], "episode_lengths": [150, 99, 150, 150, 150, 150, 96, 150, 108, 46, 150, 150, 46, 150, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72, 73, 150, 150, 115, 85, 59, 80, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 52, 77, 150, 150, 150, 150, 66, 150, 150, 150, 150, 150, 129, 150, 150, 150, 150, 150, 119, 89, 150, 146, 123, 150, 150, 150, 150, 150, 150, 119, 77, 150, 150, 146, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 54, 150, 150, 108, 150, 150, 130, 150, 150, 150], "policy_policy_0_reward": [-801.2541543037145, -433.99816544132244, -617.1677297277816, -910.1765392236176, -471.0987789634313, -962.8487972362589, -144.30535818783744, -1250.7127488617232, -335.36067594288386, -45.768912193834396, -965.3470898764537, -1191.008239247495, -40.552155485498076, -1361.2626673601105, -976.1443762731546, -869.8639957927892, -1123.4815687930868, -400.44929297266793, -775.4693758319285, -1356.8382434132154, -812.1587026928821, -686.2210346984654, -901.7946446673552, -724.5275726680026, -916.6484968780952, -852.443301787036, -901.5713254628081, -848.3957473992972, -130.79312819417927, -262.5376759575324, -1008.6766956696248, -780.3945674071374, -519.1239208738207, -349.11538239524515, -45.955682558726785, -302.27641781093496, -957.2409682542612, -968.9995222467945, -1235.5650052363915, -197.96167099469517, -486.8489217780332, -703.7622892653435, -1196.842275253624, -1256.7572366005395, -825.2470141561569, -1025.2232802477959, -36.499038817147635, -252.44116501866196, -1041.9708834661249, -753.967999538288, -989.1173736165797, -967.9188977795652, -124.269444262967, -786.949824963221, -917.561754706941, -624.985770549536, -735.2170593965506, -741.6211301928205, -661.7145837300342, -1163.6025814367858, -979.8564428512381, -886.0790284858118, -952.8489229495783, -838.5251089416636, -426.70753768424294, -174.61822963254644, -501.4525784860191, -387.6486917235139, -516.8381168345779, -1386.49164830484, -844.2352352888342, -795.7007635872404, -1218.3335135856687, -626.1486122247289, -1212.452476855876, -235.08971735845032, -285.8591745015476, -756.8403464715497, -917.8143293943587, -459.8102454468168, -1208.9960419691004, -1143.949277598947, -1060.982920938576, -1060.2969475695795, -554.1222724336644, -1298.8013195881797, -580.5965059244797, -737.6032093670823, -1011.4226438406042, -929.2701378569377, -125.7957186313571, -904.821643063158, -760.2085487953639, -410.3750705375671, -893.6876988205173, -826.5295612938985, -195.66592062873278, -939.3133834472217, -1220.801470577631, -286.2594192663406]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5573113437225168, "mean_inference_ms": 1.6704744115507872, "mean_action_processing_ms": 0.27762794145106556, "mean_env_wait_ms": 3.419322676397531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012196779251098633, "StateBufferConnector_ms": 0.008088827133178711, "ViewRequirementAgentConnector_ms": 0.19071555137634277}, "num_episodes": 30, "episode_return_max": -36.499038817147635, "episode_return_min": -1386.49164830484, "episode_return_mean": -742.8087928651685, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 328.28908525538407, "num_env_steps_trained_throughput_per_sec": 328.28908525538407, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12566.853, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12566.787, "sample_time_ms": 1120.537, "learn_time_ms": 11384.36, "learn_throughput": 351.359, "synch_weights_time_ms": 61.113}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "4b94b_00001", "date": "2024-08-05_12-02-34", "timestamp": 1722839554, "time_this_iter_s": 12.1968252658844, "time_total_s": 125.78693914413452, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e111113ac0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 125.78693914413452, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 18.25, "ram_util_percent": 28.716666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 229.3731459458669, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.187447162779669, "policy_loss": -0.008797629424952902, "vf_loss": 1.1948982577770948, "vf_explained_var": 0.9911131444697578, "kl": 0.012696973280132322, "entropy": 1.1928592396279176, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -15.763868837200267, "episode_reward_min": -1386.49164830484, "episode_reward_mean": -721.6915750304231, "episode_len_mean": 133.15, "episode_media": {}, "episodes_timesteps_total": 13315, "policy_reward_min": {"policy_0": -1386.49164830484}, "policy_reward_max": {"policy_0": -15.763868837200267}, "policy_reward_mean": {"policy_0": -721.6915750304231}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-780.3945674071374, -519.1239208738207, -349.11538239524515, -45.955682558726785, -302.27641781093496, -957.2409682542612, -968.9995222467945, -1235.5650052363915, -197.96167099469517, -486.8489217780332, -703.7622892653435, -1196.842275253624, -1256.7572366005395, -825.2470141561569, -1025.2232802477959, -36.499038817147635, -252.44116501866196, -1041.9708834661249, -753.967999538288, -989.1173736165797, -967.9188977795652, -124.269444262967, -786.949824963221, -917.561754706941, -624.985770549536, -735.2170593965506, -741.6211301928205, -661.7145837300342, -1163.6025814367858, -979.8564428512381, -886.0790284858118, -952.8489229495783, -838.5251089416636, -426.70753768424294, -174.61822963254644, -501.4525784860191, -387.6486917235139, -516.8381168345779, -1386.49164830484, -844.2352352888342, -795.7007635872404, -1218.3335135856687, -626.1486122247289, -1212.452476855876, -235.08971735845032, -285.8591745015476, -756.8403464715497, -917.8143293943587, -459.8102454468168, -1208.9960419691004, -1143.949277598947, -1060.982920938576, -1060.2969475695795, -554.1222724336644, -1298.8013195881797, -580.5965059244797, -737.6032093670823, -1011.4226438406042, -929.2701378569377, -125.7957186313571, -904.821643063158, -760.2085487953639, -410.3750705375671, -893.6876988205173, -826.5295612938985, -195.66592062873278, -939.3133834472217, -1220.801470577631, -286.2594192663406, -913.0577977526493, -814.7867670639623, -971.5255644870913, -1090.0420338860204, -1061.9246066095372, -1128.1862114354813, -317.2125089905266, -1151.7736271852746, -656.1284205607911, -145.32761241517255, -1201.9749862200176, -181.22582365446652, -753.8581488936333, -121.73430874155824, -990.9332486722376, -645.1309950292253, -392.2224196703717, -536.3913274812027, -989.8288215170688, -279.07507598123254, -1023.0150541305004, -219.1996892872063, -913.3796831526295, -369.1174113237048, -313.0210661060956, -299.50533925575576, -639.4718311523329, -911.8664131579523, -1019.8376339991024, -900.6371110795305, -15.763868837200267], "episode_lengths": [150, 115, 85, 59, 80, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 52, 77, 150, 150, 150, 150, 66, 150, 150, 150, 150, 150, 129, 150, 150, 150, 150, 150, 119, 89, 150, 146, 123, 150, 150, 150, 150, 150, 150, 119, 77, 150, 150, 146, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 54, 150, 150, 108, 150, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 88, 150, 150, 68, 150, 66, 150, 85, 150, 150, 135, 150, 150, 77, 150, 116, 150, 110, 79, 125, 150, 150, 150, 150, 40], "policy_policy_0_reward": [-780.3945674071374, -519.1239208738207, -349.11538239524515, -45.955682558726785, -302.27641781093496, -957.2409682542612, -968.9995222467945, -1235.5650052363915, -197.96167099469517, -486.8489217780332, -703.7622892653435, -1196.842275253624, -1256.7572366005395, -825.2470141561569, -1025.2232802477959, -36.499038817147635, -252.44116501866196, -1041.9708834661249, -753.967999538288, -989.1173736165797, -967.9188977795652, -124.269444262967, -786.949824963221, -917.561754706941, -624.985770549536, -735.2170593965506, -741.6211301928205, -661.7145837300342, -1163.6025814367858, -979.8564428512381, -886.0790284858118, -952.8489229495783, -838.5251089416636, -426.70753768424294, -174.61822963254644, -501.4525784860191, -387.6486917235139, -516.8381168345779, -1386.49164830484, -844.2352352888342, -795.7007635872404, -1218.3335135856687, -626.1486122247289, -1212.452476855876, -235.08971735845032, -285.8591745015476, -756.8403464715497, -917.8143293943587, -459.8102454468168, -1208.9960419691004, -1143.949277598947, -1060.982920938576, -1060.2969475695795, -554.1222724336644, -1298.8013195881797, -580.5965059244797, -737.6032093670823, -1011.4226438406042, -929.2701378569377, -125.7957186313571, -904.821643063158, -760.2085487953639, -410.3750705375671, -893.6876988205173, -826.5295612938985, -195.66592062873278, -939.3133834472217, -1220.801470577631, -286.2594192663406, -913.0577977526493, -814.7867670639623, -971.5255644870913, -1090.0420338860204, -1061.9246066095372, -1128.1862114354813, -317.2125089905266, -1151.7736271852746, -656.1284205607911, -145.32761241517255, -1201.9749862200176, -181.22582365446652, -753.8581488936333, -121.73430874155824, -990.9332486722376, -645.1309950292253, -392.2224196703717, -536.3913274812027, -989.8288215170688, -279.07507598123254, -1023.0150541305004, -219.1996892872063, -913.3796831526295, -369.1174113237048, -313.0210661060956, -299.50533925575576, -639.4718311523329, -911.8664131579523, -1019.8376339991024, -900.6371110795305, -15.763868837200267]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5573565453990841, "mean_inference_ms": 1.6695173024580288, "mean_action_processing_ms": 0.2771253403985324, "mean_env_wait_ms": 3.4171804981498797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012187957763671875, "StateBufferConnector_ms": 0.008057117462158203, "ViewRequirementAgentConnector_ms": 0.19161462783813477}, "num_episodes": 31, "episode_return_max": -15.763868837200267, "episode_return_min": -1386.49164830484, "episode_return_mean": -721.6915750304231, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 335.20790534619454, "num_env_steps_trained_throughput_per_sec": 335.20790534619454, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12488.145, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12488.075, "sample_time_ms": 1119.974, "learn_time_ms": 11306.475, "learn_throughput": 353.78, "synch_weights_time_ms": 60.851}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "4b94b_00001", "date": "2024-08-05_12-02-46", "timestamp": 1722839566, "time_this_iter_s": 11.944937705993652, "time_total_s": 137.73187685012817, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd011a290>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 137.73187685012817, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 18.53529411764706, "ram_util_percent": 28.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 149.9262239277363, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.8384102664344634, "policy_loss": -0.007643329188673912, "vf_loss": 0.8442965078167617, "vf_explained_var": 0.9925463456660509, "kl": 0.014404901042113737, "entropy": 1.1238950374225776, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -15.763868837200267, "episode_reward_min": -1386.49164830484, "episode_reward_mean": -701.6250631522561, "episode_len_mean": 135.01, "episode_media": {}, "episodes_timesteps_total": 13501, "policy_reward_min": {"policy_0": -1386.49164830484}, "policy_reward_max": {"policy_0": -15.763868837200267}, "policy_reward_mean": {"policy_0": -701.6250631522561}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-979.8564428512381, -886.0790284858118, -952.8489229495783, -838.5251089416636, -426.70753768424294, -174.61822963254644, -501.4525784860191, -387.6486917235139, -516.8381168345779, -1386.49164830484, -844.2352352888342, -795.7007635872404, -1218.3335135856687, -626.1486122247289, -1212.452476855876, -235.08971735845032, -285.8591745015476, -756.8403464715497, -917.8143293943587, -459.8102454468168, -1208.9960419691004, -1143.949277598947, -1060.982920938576, -1060.2969475695795, -554.1222724336644, -1298.8013195881797, -580.5965059244797, -737.6032093670823, -1011.4226438406042, -929.2701378569377, -125.7957186313571, -904.821643063158, -760.2085487953639, -410.3750705375671, -893.6876988205173, -826.5295612938985, -195.66592062873278, -939.3133834472217, -1220.801470577631, -286.2594192663406, -913.0577977526493, -814.7867670639623, -971.5255644870913, -1090.0420338860204, -1061.9246066095372, -1128.1862114354813, -317.2125089905266, -1151.7736271852746, -656.1284205607911, -145.32761241517255, -1201.9749862200176, -181.22582365446652, -753.8581488936333, -121.73430874155824, -990.9332486722376, -645.1309950292253, -392.2224196703717, -536.3913274812027, -989.8288215170688, -279.07507598123254, -1023.0150541305004, -219.1996892872063, -913.3796831526295, -369.1174113237048, -313.0210661060956, -299.50533925575576, -639.4718311523329, -911.8664131579523, -1019.8376339991024, -900.6371110795305, -15.763868837200267, -69.43955609190705, -152.95007194197512, -387.3519269343127, -483.48326631277405, -553.1756188556375, -492.2216947435169, -162.73000120346853, -550.9629308111437, -619.232841537718, -805.829511192045, -1004.2413312542926, -923.9257343330844, -189.87788711107652, -976.2772393451128, -641.5927501920045, -1106.6735698216207, -161.940125247281, -335.9561294798943, -873.8591060776664, -680.3058350545422, -731.7353683313934, -758.4470408661012, -580.6872994844009, -523.7636358655913, -610.899716235259, -793.2211478408622, -1302.3937231815275, -1046.0149380180562, -1123.3104773737907], "episode_lengths": [150, 150, 150, 150, 119, 89, 150, 146, 123, 150, 150, 150, 150, 150, 150, 119, 77, 150, 150, 146, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 54, 150, 150, 108, 150, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 88, 150, 150, 68, 150, 66, 150, 85, 150, 150, 135, 150, 150, 77, 150, 116, 150, 110, 79, 125, 150, 150, 150, 150, 40, 54, 74, 150, 150, 150, 150, 72, 150, 150, 150, 150, 150, 67, 150, 129, 150, 81, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-979.8564428512381, -886.0790284858118, -952.8489229495783, -838.5251089416636, -426.70753768424294, -174.61822963254644, -501.4525784860191, -387.6486917235139, -516.8381168345779, -1386.49164830484, -844.2352352888342, -795.7007635872404, -1218.3335135856687, -626.1486122247289, -1212.452476855876, -235.08971735845032, -285.8591745015476, -756.8403464715497, -917.8143293943587, -459.8102454468168, -1208.9960419691004, -1143.949277598947, -1060.982920938576, -1060.2969475695795, -554.1222724336644, -1298.8013195881797, -580.5965059244797, -737.6032093670823, -1011.4226438406042, -929.2701378569377, -125.7957186313571, -904.821643063158, -760.2085487953639, -410.3750705375671, -893.6876988205173, -826.5295612938985, -195.66592062873278, -939.3133834472217, -1220.801470577631, -286.2594192663406, -913.0577977526493, -814.7867670639623, -971.5255644870913, -1090.0420338860204, -1061.9246066095372, -1128.1862114354813, -317.2125089905266, -1151.7736271852746, -656.1284205607911, -145.32761241517255, -1201.9749862200176, -181.22582365446652, -753.8581488936333, -121.73430874155824, -990.9332486722376, -645.1309950292253, -392.2224196703717, -536.3913274812027, -989.8288215170688, -279.07507598123254, -1023.0150541305004, -219.1996892872063, -913.3796831526295, -369.1174113237048, -313.0210661060956, -299.50533925575576, -639.4718311523329, -911.8664131579523, -1019.8376339991024, -900.6371110795305, -15.763868837200267, -69.43955609190705, -152.95007194197512, -387.3519269343127, -483.48326631277405, -553.1756188556375, -492.2216947435169, -162.73000120346853, -550.9629308111437, -619.232841537718, -805.829511192045, -1004.2413312542926, -923.9257343330844, -189.87788711107652, -976.2772393451128, -641.5927501920045, -1106.6735698216207, -161.940125247281, -335.9561294798943, -873.8591060776664, -680.3058350545422, -731.7353683313934, -758.4470408661012, -580.6872994844009, -523.7636358655913, -610.899716235259, -793.2211478408622, -1302.3937231815275, -1046.0149380180562, -1123.3104773737907]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5557823901552219, "mean_inference_ms": 1.6700057004904698, "mean_action_processing_ms": 0.2771887829911469, "mean_env_wait_ms": 3.4180196829570524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012169122695922852, "StateBufferConnector_ms": 0.008040189743041992, "ViewRequirementAgentConnector_ms": 0.19234991073608398}, "num_episodes": 29, "episode_return_max": -15.763868837200267, "episode_return_min": -1386.49164830484, "episode_return_mean": -701.6250631522561, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 348.55144429054343, "num_env_steps_trained_throughput_per_sec": 348.55144429054343, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12341.936, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12341.864, "sample_time_ms": 1115.143, "learn_time_ms": 11164.599, "learn_throughput": 358.275, "synch_weights_time_ms": 61.343}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "4b94b_00001", "date": "2024-08-05_12-02-57", "timestamp": 1722839577, "time_this_iter_s": 11.487251996994019, "time_total_s": 149.2191288471222, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd01b4310>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 149.2191288471222, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 19.293750000000003, "ram_util_percent": 28.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 168.61625550786655, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.8428529029867301, "policy_loss": -0.01679979588855834, "vf_loss": 0.8574182856827974, "vf_explained_var": 0.9973366617535552, "kl": 0.017096912675197026, "entropy": 1.1849679904679458, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -7.9170319589651355, "episode_reward_min": -1302.3937231815275, "episode_reward_mean": -648.2280606751455, "episode_len_mean": 133.22, "episode_media": {}, "episodes_timesteps_total": 13322, "policy_reward_min": {"policy_0": -1302.3937231815275}, "policy_reward_max": {"policy_0": -7.9170319589651355}, "policy_reward_mean": {"policy_0": -648.2280606751455}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-125.7957186313571, -904.821643063158, -760.2085487953639, -410.3750705375671, -893.6876988205173, -826.5295612938985, -195.66592062873278, -939.3133834472217, -1220.801470577631, -286.2594192663406, -913.0577977526493, -814.7867670639623, -971.5255644870913, -1090.0420338860204, -1061.9246066095372, -1128.1862114354813, -317.2125089905266, -1151.7736271852746, -656.1284205607911, -145.32761241517255, -1201.9749862200176, -181.22582365446652, -753.8581488936333, -121.73430874155824, -990.9332486722376, -645.1309950292253, -392.2224196703717, -536.3913274812027, -989.8288215170688, -279.07507598123254, -1023.0150541305004, -219.1996892872063, -913.3796831526295, -369.1174113237048, -313.0210661060956, -299.50533925575576, -639.4718311523329, -911.8664131579523, -1019.8376339991024, -900.6371110795305, -15.763868837200267, -69.43955609190705, -152.95007194197512, -387.3519269343127, -483.48326631277405, -553.1756188556375, -492.2216947435169, -162.73000120346853, -550.9629308111437, -619.232841537718, -805.829511192045, -1004.2413312542926, -923.9257343330844, -189.87788711107652, -976.2772393451128, -641.5927501920045, -1106.6735698216207, -161.940125247281, -335.9561294798943, -873.8591060776664, -680.3058350545422, -731.7353683313934, -758.4470408661012, -580.6872994844009, -523.7636358655913, -610.899716235259, -793.2211478408622, -1302.3937231815275, -1046.0149380180562, -1123.3104773737907, -635.0996173492849, -662.299211590042, -271.3599520408633, -843.0934372582461, -1259.6064703265636, -845.0223519633583, -749.6765570922914, -788.374257830771, -973.4856075871359, -427.26827831855996, -542.4110381498452, -873.5047215538788, -862.621706606368, -7.9170319589651355, -616.9132436803965, -765.0089734041629, -317.88980595826973, -118.21860923035538, -652.3152280933953, -629.8050535717557, -402.036905976544, -648.7346700479519, -760.1868247750622, -911.7136759695351, -67.567043612869, -719.1366317414793, -884.0299229985991, -836.4293173831253, -38.7390826095504, -539.2265213059538], "episode_lengths": [54, 150, 150, 108, 150, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 88, 150, 150, 68, 150, 66, 150, 85, 150, 150, 135, 150, 150, 77, 150, 116, 150, 110, 79, 125, 150, 150, 150, 150, 40, 54, 74, 150, 150, 150, 150, 72, 150, 150, 150, 150, 150, 67, 150, 129, 150, 81, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 32, 150, 150, 129, 79, 150, 150, 115, 150, 150, 150, 64, 150, 150, 150, 45, 150], "policy_policy_0_reward": [-125.7957186313571, -904.821643063158, -760.2085487953639, -410.3750705375671, -893.6876988205173, -826.5295612938985, -195.66592062873278, -939.3133834472217, -1220.801470577631, -286.2594192663406, -913.0577977526493, -814.7867670639623, -971.5255644870913, -1090.0420338860204, -1061.9246066095372, -1128.1862114354813, -317.2125089905266, -1151.7736271852746, -656.1284205607911, -145.32761241517255, -1201.9749862200176, -181.22582365446652, -753.8581488936333, -121.73430874155824, -990.9332486722376, -645.1309950292253, -392.2224196703717, -536.3913274812027, -989.8288215170688, -279.07507598123254, -1023.0150541305004, -219.1996892872063, -913.3796831526295, -369.1174113237048, -313.0210661060956, -299.50533925575576, -639.4718311523329, -911.8664131579523, -1019.8376339991024, -900.6371110795305, -15.763868837200267, -69.43955609190705, -152.95007194197512, -387.3519269343127, -483.48326631277405, -553.1756188556375, -492.2216947435169, -162.73000120346853, -550.9629308111437, -619.232841537718, -805.829511192045, -1004.2413312542926, -923.9257343330844, -189.87788711107652, -976.2772393451128, -641.5927501920045, -1106.6735698216207, -161.940125247281, -335.9561294798943, -873.8591060776664, -680.3058350545422, -731.7353683313934, -758.4470408661012, -580.6872994844009, -523.7636358655913, -610.899716235259, -793.2211478408622, -1302.3937231815275, -1046.0149380180562, -1123.3104773737907, -635.0996173492849, -662.299211590042, -271.3599520408633, -843.0934372582461, -1259.6064703265636, -845.0223519633583, -749.6765570922914, -788.374257830771, -973.4856075871359, -427.26827831855996, -542.4110381498452, -873.5047215538788, -862.621706606368, -7.9170319589651355, -616.9132436803965, -765.0089734041629, -317.88980595826973, -118.21860923035538, -652.3152280933953, -629.8050535717557, -402.036905976544, -648.7346700479519, -760.1868247750622, -911.7136759695351, -67.567043612869, -719.1366317414793, -884.0299229985991, -836.4293173831253, -38.7390826095504, -539.2265213059538]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5556670957129919, "mean_inference_ms": 1.6702861490692866, "mean_action_processing_ms": 0.2765642463191896, "mean_env_wait_ms": 3.4172320874688227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011863946914672852, "StateBufferConnector_ms": 0.008011341094970703, "ViewRequirementAgentConnector_ms": 0.19276952743530273}, "num_episodes": 30, "episode_return_max": -7.9170319589651355, "episode_return_min": -1302.3937231815275, "episode_return_mean": -648.2280606751455, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 383.9393357571142, "num_env_steps_trained_throughput_per_sec": 383.9393357571142, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12110.062, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12109.99, "sample_time_ms": 1113.503, "learn_time_ms": 10934.682, "learn_throughput": 365.809, "synch_weights_time_ms": 61.027}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "4b94b_00001", "date": "2024-08-05_12-03-08", "timestamp": 1722839588, "time_this_iter_s": 10.429873943328857, "time_total_s": 159.64900279045105, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd011b910>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 159.64900279045105, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 19.566666666666666, "ram_util_percent": 28.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 159.98286721110344, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.9403354262933135, "policy_loss": -0.014789341335805754, "vf_loss": 0.952605931305637, "vf_explained_var": 0.9948315062249701, "kl": 0.01829556958534038, "entropy": 1.14027658055226, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -7.9170319589651355, "episode_reward_min": -1302.3937231815275, "episode_reward_mean": -603.3735147913512, "episode_len_mean": 130.03, "episode_media": {}, "episodes_timesteps_total": 13003, "policy_reward_min": {"policy_0": -1302.3937231815275}, "policy_reward_max": {"policy_0": -7.9170319589651355}, "policy_reward_mean": {"policy_0": -603.3735147913512}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-279.07507598123254, -1023.0150541305004, -219.1996892872063, -913.3796831526295, -369.1174113237048, -313.0210661060956, -299.50533925575576, -639.4718311523329, -911.8664131579523, -1019.8376339991024, -900.6371110795305, -15.763868837200267, -69.43955609190705, -152.95007194197512, -387.3519269343127, -483.48326631277405, -553.1756188556375, -492.2216947435169, -162.73000120346853, -550.9629308111437, -619.232841537718, -805.829511192045, -1004.2413312542926, -923.9257343330844, -189.87788711107652, -976.2772393451128, -641.5927501920045, -1106.6735698216207, -161.940125247281, -335.9561294798943, -873.8591060776664, -680.3058350545422, -731.7353683313934, -758.4470408661012, -580.6872994844009, -523.7636358655913, -610.899716235259, -793.2211478408622, -1302.3937231815275, -1046.0149380180562, -1123.3104773737907, -635.0996173492849, -662.299211590042, -271.3599520408633, -843.0934372582461, -1259.6064703265636, -845.0223519633583, -749.6765570922914, -788.374257830771, -973.4856075871359, -427.26827831855996, -542.4110381498452, -873.5047215538788, -862.621706606368, -7.9170319589651355, -616.9132436803965, -765.0089734041629, -317.88980595826973, -118.21860923035538, -652.3152280933953, -629.8050535717557, -402.036905976544, -648.7346700479519, -760.1868247750622, -911.7136759695351, -67.567043612869, -719.1366317414793, -884.0299229985991, -836.4293173831253, -38.7390826095504, -539.2265213059538, -522.1723781277097, -767.0610202552529, -993.4772041298459, -580.4328893044585, -749.9867964173733, -869.8586710222106, -731.8915494484987, -216.41646495735165, -763.0664512054285, -843.8898198717382, -19.88274697466222, -67.16759435762995, -906.7522873055603, -319.39527584184157, -575.2300728120481, -488.93009499134956, -924.2049341102792, -13.602537459940137, -30.994443948347293, -188.20072033782625, -707.8538207023968, -993.3633336467389, -223.00494056237187, -70.65044263126738, -283.6198128888538, -223.75408911934522, -1198.4688871080973, -1128.7970844529764, -739.1427129572459], "episode_lengths": [77, 150, 116, 150, 110, 79, 125, 150, 150, 150, 150, 40, 54, 74, 150, 150, 150, 150, 72, 150, 150, 150, 150, 150, 67, 150, 129, 150, 81, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 32, 150, 150, 129, 79, 150, 150, 115, 150, 150, 150, 64, 150, 150, 150, 45, 150, 150, 150, 150, 150, 150, 150, 150, 109, 150, 150, 42, 59, 150, 104, 150, 150, 150, 40, 53, 79, 150, 150, 98, 62, 107, 112, 150, 150, 150], "policy_policy_0_reward": [-279.07507598123254, -1023.0150541305004, -219.1996892872063, -913.3796831526295, -369.1174113237048, -313.0210661060956, -299.50533925575576, -639.4718311523329, -911.8664131579523, -1019.8376339991024, -900.6371110795305, -15.763868837200267, -69.43955609190705, -152.95007194197512, -387.3519269343127, -483.48326631277405, -553.1756188556375, -492.2216947435169, -162.73000120346853, -550.9629308111437, -619.232841537718, -805.829511192045, -1004.2413312542926, -923.9257343330844, -189.87788711107652, -976.2772393451128, -641.5927501920045, -1106.6735698216207, -161.940125247281, -335.9561294798943, -873.8591060776664, -680.3058350545422, -731.7353683313934, -758.4470408661012, -580.6872994844009, -523.7636358655913, -610.899716235259, -793.2211478408622, -1302.3937231815275, -1046.0149380180562, -1123.3104773737907, -635.0996173492849, -662.299211590042, -271.3599520408633, -843.0934372582461, -1259.6064703265636, -845.0223519633583, -749.6765570922914, -788.374257830771, -973.4856075871359, -427.26827831855996, -542.4110381498452, -873.5047215538788, -862.621706606368, -7.9170319589651355, -616.9132436803965, -765.0089734041629, -317.88980595826973, -118.21860923035538, -652.3152280933953, -629.8050535717557, -402.036905976544, -648.7346700479519, -760.1868247750622, -911.7136759695351, -67.567043612869, -719.1366317414793, -884.0299229985991, -836.4293173831253, -38.7390826095504, -539.2265213059538, -522.1723781277097, -767.0610202552529, -993.4772041298459, -580.4328893044585, -749.9867964173733, -869.8586710222106, -731.8915494484987, -216.41646495735165, -763.0664512054285, -843.8898198717382, -19.88274697466222, -67.16759435762995, -906.7522873055603, -319.39527584184157, -575.2300728120481, -488.93009499134956, -924.2049341102792, -13.602537459940137, -30.994443948347293, -188.20072033782625, -707.8538207023968, -993.3633336467389, -223.00494056237187, -70.65044263126738, -283.6198128888538, -223.75408911934522, -1198.4688871080973, -1128.7970844529764, -739.1427129572459]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5554200293750611, "mean_inference_ms": 1.6705201966173604, "mean_action_processing_ms": 0.27619440919259286, "mean_env_wait_ms": 3.414143093884939, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01172184944152832, "StateBufferConnector_ms": 0.007983922958374023, "ViewRequirementAgentConnector_ms": 0.1943056583404541}, "num_episodes": 29, "episode_return_max": -7.9170319589651355, "episode_return_min": -1302.3937231815275, "episode_return_mean": -603.3735147913512, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.37456511913507, "num_env_steps_trained_throughput_per_sec": 320.37456511913507, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12084.671, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12084.598, "sample_time_ms": 1110.664, "learn_time_ms": 10912.765, "learn_throughput": 366.543, "synch_weights_time_ms": 60.388}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "4b94b_00001", "date": "2024-08-05_12-03-20", "timestamp": 1722839600, "time_this_iter_s": 12.496437788009644, "time_total_s": 172.1454405784607, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd011b370>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 172.1454405784607, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 18.311764705882354, "ram_util_percent": 28.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 172.7039848923683, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.9583398805155109, "policy_loss": -0.009668409944182107, "vf_loss": 0.9658765324701866, "vf_explained_var": 0.9951692304884394, "kl": 0.01671090030304186, "entropy": 1.2104223581030964, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -7.9170319589651355, "episode_reward_min": -1302.3937231815275, "episode_reward_mean": -647.9091239742153, "episode_len_mean": 132.11, "episode_media": {}, "episodes_timesteps_total": 13211, "policy_reward_min": {"policy_0": -1302.3937231815275}, "policy_reward_max": {"policy_0": -7.9170319589651355}, "policy_reward_mean": {"policy_0": -647.9091239742153}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-873.8591060776664, -680.3058350545422, -731.7353683313934, -758.4470408661012, -580.6872994844009, -523.7636358655913, -610.899716235259, -793.2211478408622, -1302.3937231815275, -1046.0149380180562, -1123.3104773737907, -635.0996173492849, -662.299211590042, -271.3599520408633, -843.0934372582461, -1259.6064703265636, -845.0223519633583, -749.6765570922914, -788.374257830771, -973.4856075871359, -427.26827831855996, -542.4110381498452, -873.5047215538788, -862.621706606368, -7.9170319589651355, -616.9132436803965, -765.0089734041629, -317.88980595826973, -118.21860923035538, -652.3152280933953, -629.8050535717557, -402.036905976544, -648.7346700479519, -760.1868247750622, -911.7136759695351, -67.567043612869, -719.1366317414793, -884.0299229985991, -836.4293173831253, -38.7390826095504, -539.2265213059538, -522.1723781277097, -767.0610202552529, -993.4772041298459, -580.4328893044585, -749.9867964173733, -869.8586710222106, -731.8915494484987, -216.41646495735165, -763.0664512054285, -843.8898198717382, -19.88274697466222, -67.16759435762995, -906.7522873055603, -319.39527584184157, -575.2300728120481, -488.93009499134956, -924.2049341102792, -13.602537459940137, -30.994443948347293, -188.20072033782625, -707.8538207023968, -993.3633336467389, -223.00494056237187, -70.65044263126738, -283.6198128888538, -223.75408911934522, -1198.4688871080973, -1128.7970844529764, -739.1427129572459, -589.4968986313357, -657.124946214155, -960.4556494036826, -166.86512419788974, -922.7474173936088, -965.2582664341879, -1041.0412141706017, -26.520680961425363, -839.740298010763, -608.5967887370748, -448.51173071287593, -905.0849036604168, -589.5969483734924, -941.9555613428527, -141.03435366395956, -532.5829250872048, -43.27987799928272, -1101.9906479131273, -1094.5907817332097, -79.32525797090496, -1074.8075700008887, -1033.830080171103, -1228.5211845875185, -986.3434958423426, -1060.5662929163261, -456.077600761503, -1083.5954974094516, -992.3271155059145, -21.075105654298092, -382.36906669711976], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 32, 150, 150, 129, 79, 150, 150, 115, 150, 150, 150, 64, 150, 150, 150, 45, 150, 150, 150, 150, 150, 150, 150, 150, 109, 150, 150, 42, 59, 150, 104, 150, 150, 150, 40, 53, 79, 150, 150, 98, 62, 107, 112, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 52, 150, 150, 126, 150, 150, 150, 127, 131, 44, 150, 150, 55, 150, 150, 150, 150, 150, 98, 150, 150, 46, 150], "policy_policy_0_reward": [-873.8591060776664, -680.3058350545422, -731.7353683313934, -758.4470408661012, -580.6872994844009, -523.7636358655913, -610.899716235259, -793.2211478408622, -1302.3937231815275, -1046.0149380180562, -1123.3104773737907, -635.0996173492849, -662.299211590042, -271.3599520408633, -843.0934372582461, -1259.6064703265636, -845.0223519633583, -749.6765570922914, -788.374257830771, -973.4856075871359, -427.26827831855996, -542.4110381498452, -873.5047215538788, -862.621706606368, -7.9170319589651355, -616.9132436803965, -765.0089734041629, -317.88980595826973, -118.21860923035538, -652.3152280933953, -629.8050535717557, -402.036905976544, -648.7346700479519, -760.1868247750622, -911.7136759695351, -67.567043612869, -719.1366317414793, -884.0299229985991, -836.4293173831253, -38.7390826095504, -539.2265213059538, -522.1723781277097, -767.0610202552529, -993.4772041298459, -580.4328893044585, -749.9867964173733, -869.8586710222106, -731.8915494484987, -216.41646495735165, -763.0664512054285, -843.8898198717382, -19.88274697466222, -67.16759435762995, -906.7522873055603, -319.39527584184157, -575.2300728120481, -488.93009499134956, -924.2049341102792, -13.602537459940137, -30.994443948347293, -188.20072033782625, -707.8538207023968, -993.3633336467389, -223.00494056237187, -70.65044263126738, -283.6198128888538, -223.75408911934522, -1198.4688871080973, -1128.7970844529764, -739.1427129572459, -589.4968986313357, -657.124946214155, -960.4556494036826, -166.86512419788974, -922.7474173936088, -965.2582664341879, -1041.0412141706017, -26.520680961425363, -839.740298010763, -608.5967887370748, -448.51173071287593, -905.0849036604168, -589.5969483734924, -941.9555613428527, -141.03435366395956, -532.5829250872048, -43.27987799928272, -1101.9906479131273, -1094.5907817332097, -79.32525797090496, -1074.8075700008887, -1033.830080171103, -1228.5211845875185, -986.3434958423426, -1060.5662929163261, -456.077600761503, -1083.5954974094516, -992.3271155059145, -21.075105654298092, -382.36906669711976]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5554633562858288, "mean_inference_ms": 1.6686898598214304, "mean_action_processing_ms": 0.27579833388296054, "mean_env_wait_ms": 3.408018771742536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011521577835083008, "StateBufferConnector_ms": 0.007950305938720703, "ViewRequirementAgentConnector_ms": 0.19388413429260254}, "num_episodes": 30, "episode_return_max": -7.9170319589651355, "episode_return_min": -1302.3937231815275, "episode_return_mean": -647.9091239742153, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.8014402842483, "num_env_steps_trained_throughput_per_sec": 326.8014402842483, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12063.06, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12062.986, "sample_time_ms": 1112.708, "learn_time_ms": 10888.079, "learn_throughput": 367.374, "synch_weights_time_ms": 61.416}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "4b94b_00001", "date": "2024-08-05_12-03-33", "timestamp": 1722839613, "time_this_iter_s": 12.252314805984497, "time_total_s": 184.3977553844452, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1110a3640>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 184.3977553844452, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 18.01666666666667, "ram_util_percent": 28.716666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 144.13699655930202, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.082154302485287, "policy_loss": -0.006160449929302559, "vf_loss": 1.0859952114832898, "vf_explained_var": 0.9879691194122037, "kl": 0.01743349937751191, "entropy": 1.1671567647407453, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -13.602537459940137, "episode_reward_min": -1349.785389151133, "episode_reward_mean": -643.3354544524082, "episode_len_mean": 130.48, "episode_media": {}, "episodes_timesteps_total": 13048, "policy_reward_min": {"policy_0": -1349.785389151133}, "policy_reward_max": {"policy_0": -13.602537459940137}, "policy_reward_mean": {"policy_0": -643.3354544524082}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-648.7346700479519, -760.1868247750622, -911.7136759695351, -67.567043612869, -719.1366317414793, -884.0299229985991, -836.4293173831253, -38.7390826095504, -539.2265213059538, -522.1723781277097, -767.0610202552529, -993.4772041298459, -580.4328893044585, -749.9867964173733, -869.8586710222106, -731.8915494484987, -216.41646495735165, -763.0664512054285, -843.8898198717382, -19.88274697466222, -67.16759435762995, -906.7522873055603, -319.39527584184157, -575.2300728120481, -488.93009499134956, -924.2049341102792, -13.602537459940137, -30.994443948347293, -188.20072033782625, -707.8538207023968, -993.3633336467389, -223.00494056237187, -70.65044263126738, -283.6198128888538, -223.75408911934522, -1198.4688871080973, -1128.7970844529764, -739.1427129572459, -589.4968986313357, -657.124946214155, -960.4556494036826, -166.86512419788974, -922.7474173936088, -965.2582664341879, -1041.0412141706017, -26.520680961425363, -839.740298010763, -608.5967887370748, -448.51173071287593, -905.0849036604168, -589.5969483734924, -941.9555613428527, -141.03435366395956, -532.5829250872048, -43.27987799928272, -1101.9906479131273, -1094.5907817332097, -79.32525797090496, -1074.8075700008887, -1033.830080171103, -1228.5211845875185, -986.3434958423426, -1060.5662929163261, -456.077600761503, -1083.5954974094516, -992.3271155059145, -21.075105654298092, -382.36906669711976, -248.54986903771223, -1314.9527974866426, -807.5524898097425, -257.9797281991111, -588.2055017213994, -802.784488531907, -164.0666400110284, -78.70496223375908, -1349.785389151133, -818.1340276906329, -689.5438299276517, -568.7230318012269, -298.9971721855179, -816.0025093081712, -519.7095550693123, -861.4095292539223, -703.8365177027882, -1002.1029006107143, -810.8556543688813, -1071.4765369796169, -521.5272782626326, -308.0738002646583, -722.464489153105, -1008.4596320089589, -1180.9377102260808, -274.8414774373209, -109.94365735066066, -640.5496258718541, -813.9187131848973, -836.6232967636079, -917.8710076325766, -702.6155764523032], "episode_lengths": [150, 150, 150, 64, 150, 150, 150, 45, 150, 150, 150, 150, 150, 150, 150, 150, 109, 150, 150, 42, 59, 150, 104, 150, 150, 150, 40, 53, 79, 150, 150, 98, 62, 107, 112, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 52, 150, 150, 126, 150, 150, 150, 127, 131, 44, 150, 150, 55, 150, 150, 150, 150, 150, 98, 150, 150, 46, 150, 150, 150, 150, 86, 150, 150, 83, 61, 150, 150, 150, 140, 107, 150, 150, 150, 129, 150, 150, 150, 124, 150, 150, 150, 150, 150, 82, 130, 150, 150, 150, 150], "policy_policy_0_reward": [-648.7346700479519, -760.1868247750622, -911.7136759695351, -67.567043612869, -719.1366317414793, -884.0299229985991, -836.4293173831253, -38.7390826095504, -539.2265213059538, -522.1723781277097, -767.0610202552529, -993.4772041298459, -580.4328893044585, -749.9867964173733, -869.8586710222106, -731.8915494484987, -216.41646495735165, -763.0664512054285, -843.8898198717382, -19.88274697466222, -67.16759435762995, -906.7522873055603, -319.39527584184157, -575.2300728120481, -488.93009499134956, -924.2049341102792, -13.602537459940137, -30.994443948347293, -188.20072033782625, -707.8538207023968, -993.3633336467389, -223.00494056237187, -70.65044263126738, -283.6198128888538, -223.75408911934522, -1198.4688871080973, -1128.7970844529764, -739.1427129572459, -589.4968986313357, -657.124946214155, -960.4556494036826, -166.86512419788974, -922.7474173936088, -965.2582664341879, -1041.0412141706017, -26.520680961425363, -839.740298010763, -608.5967887370748, -448.51173071287593, -905.0849036604168, -589.5969483734924, -941.9555613428527, -141.03435366395956, -532.5829250872048, -43.27987799928272, -1101.9906479131273, -1094.5907817332097, -79.32525797090496, -1074.8075700008887, -1033.830080171103, -1228.5211845875185, -986.3434958423426, -1060.5662929163261, -456.077600761503, -1083.5954974094516, -992.3271155059145, -21.075105654298092, -382.36906669711976, -248.54986903771223, -1314.9527974866426, -807.5524898097425, -257.9797281991111, -588.2055017213994, -802.784488531907, -164.0666400110284, -78.70496223375908, -1349.785389151133, -818.1340276906329, -689.5438299276517, -568.7230318012269, -298.9971721855179, -816.0025093081712, -519.7095550693123, -861.4095292539223, -703.8365177027882, -1002.1029006107143, -810.8556543688813, -1071.4765369796169, -521.5272782626326, -308.0738002646583, -722.464489153105, -1008.4596320089589, -1180.9377102260808, -274.8414774373209, -109.94365735066066, -640.5496258718541, -813.9187131848973, -836.6232967636079, -917.8710076325766, -702.6155764523032]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5559308330369851, "mean_inference_ms": 1.6671962275431285, "mean_action_processing_ms": 0.27534313419682765, "mean_env_wait_ms": 3.4026210937481016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011827707290649414, "StateBufferConnector_ms": 0.00792384147644043, "ViewRequirementAgentConnector_ms": 0.19436264038085938}, "num_episodes": 32, "episode_return_max": -13.602537459940137, "episode_return_min": -1349.785389151133, "episode_return_mean": -643.3354544524082, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.56035622783355, "num_env_steps_trained_throughput_per_sec": 317.56035622783355, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12016.34, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12016.265, "sample_time_ms": 1104.635, "learn_time_ms": 10847.609, "learn_throughput": 368.745, "synch_weights_time_ms": 63.232}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "4b94b_00001", "date": "2024-08-05_12-03-45", "timestamp": 1722839625, "time_this_iter_s": 12.608745336532593, "time_total_s": 197.00650072097778, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd011b910>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 197.00650072097778, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 18.127777777777776, "ram_util_percent": 28.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 145.1099465270837, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.2456455828932425, "policy_loss": -0.012217755814587387, "vf_loss": 1.255486130559196, "vf_explained_var": 0.9882479704916477, "kl": 0.01735413766018611, "entropy": 1.0936162470529476, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -21.075105654298092, "episode_reward_min": -1349.785389151133, "episode_reward_mean": -665.157182445049, "episode_len_mean": 132.91, "episode_media": {}, "episodes_timesteps_total": 13291, "policy_reward_min": {"policy_0": -1349.785389151133}, "policy_reward_max": {"policy_0": -21.075105654298092}, "policy_reward_mean": {"policy_0": -665.157182445049}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-283.6198128888538, -223.75408911934522, -1198.4688871080973, -1128.7970844529764, -739.1427129572459, -589.4968986313357, -657.124946214155, -960.4556494036826, -166.86512419788974, -922.7474173936088, -965.2582664341879, -1041.0412141706017, -26.520680961425363, -839.740298010763, -608.5967887370748, -448.51173071287593, -905.0849036604168, -589.5969483734924, -941.9555613428527, -141.03435366395956, -532.5829250872048, -43.27987799928272, -1101.9906479131273, -1094.5907817332097, -79.32525797090496, -1074.8075700008887, -1033.830080171103, -1228.5211845875185, -986.3434958423426, -1060.5662929163261, -456.077600761503, -1083.5954974094516, -992.3271155059145, -21.075105654298092, -382.36906669711976, -248.54986903771223, -1314.9527974866426, -807.5524898097425, -257.9797281991111, -588.2055017213994, -802.784488531907, -164.0666400110284, -78.70496223375908, -1349.785389151133, -818.1340276906329, -689.5438299276517, -568.7230318012269, -298.9971721855179, -816.0025093081712, -519.7095550693123, -861.4095292539223, -703.8365177027882, -1002.1029006107143, -810.8556543688813, -1071.4765369796169, -521.5272782626326, -308.0738002646583, -722.464489153105, -1008.4596320089589, -1180.9377102260808, -274.8414774373209, -109.94365735066066, -640.5496258718541, -813.9187131848973, -836.6232967636079, -917.8710076325766, -702.6155764523032, -122.57230266927456, -1059.1561255678475, -1089.1466665290825, -844.9447613300202, -1217.1895324527004, -115.12510263201202, -251.8098807157363, -581.489237629749, -1118.2946363967867, -478.35881449665925, -294.0677197840867, -71.49569352651422, -935.5850963886688, -149.87660686839752, -882.4060051571888, -1068.710460653913, -597.9052012038502, -759.5742855818753, -340.23045903375055, -757.1441182042068, -782.0696195328891, -479.00395414902783, -902.805406209173, -60.19586584623359, -953.0469222944681, -347.87340667645094, -834.7773138772623, -450.47283966691043, -926.3170754390835, -651.6534168327786, -267.860337971862, -338.251750640868, -426.01236417102035], "episode_lengths": [107, 112, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 52, 150, 150, 126, 150, 150, 150, 127, 131, 44, 150, 150, 55, 150, 150, 150, 150, 150, 98, 150, 150, 46, 150, 150, 150, 150, 86, 150, 150, 83, 61, 150, 150, 150, 140, 107, 150, 150, 150, 129, 150, 150, 150, 124, 150, 150, 150, 150, 150, 82, 130, 150, 150, 150, 150, 52, 150, 150, 150, 150, 73, 103, 150, 150, 150, 119, 59, 150, 61, 150, 150, 150, 150, 134, 150, 150, 150, 150, 41, 150, 85, 150, 147, 150, 150, 150, 124, 150], "policy_policy_0_reward": [-283.6198128888538, -223.75408911934522, -1198.4688871080973, -1128.7970844529764, -739.1427129572459, -589.4968986313357, -657.124946214155, -960.4556494036826, -166.86512419788974, -922.7474173936088, -965.2582664341879, -1041.0412141706017, -26.520680961425363, -839.740298010763, -608.5967887370748, -448.51173071287593, -905.0849036604168, -589.5969483734924, -941.9555613428527, -141.03435366395956, -532.5829250872048, -43.27987799928272, -1101.9906479131273, -1094.5907817332097, -79.32525797090496, -1074.8075700008887, -1033.830080171103, -1228.5211845875185, -986.3434958423426, -1060.5662929163261, -456.077600761503, -1083.5954974094516, -992.3271155059145, -21.075105654298092, -382.36906669711976, -248.54986903771223, -1314.9527974866426, -807.5524898097425, -257.9797281991111, -588.2055017213994, -802.784488531907, -164.0666400110284, -78.70496223375908, -1349.785389151133, -818.1340276906329, -689.5438299276517, -568.7230318012269, -298.9971721855179, -816.0025093081712, -519.7095550693123, -861.4095292539223, -703.8365177027882, -1002.1029006107143, -810.8556543688813, -1071.4765369796169, -521.5272782626326, -308.0738002646583, -722.464489153105, -1008.4596320089589, -1180.9377102260808, -274.8414774373209, -109.94365735066066, -640.5496258718541, -813.9187131848973, -836.6232967636079, -917.8710076325766, -702.6155764523032, -122.57230266927456, -1059.1561255678475, -1089.1466665290825, -844.9447613300202, -1217.1895324527004, -115.12510263201202, -251.8098807157363, -581.489237629749, -1118.2946363967867, -478.35881449665925, -294.0677197840867, -71.49569352651422, -935.5850963886688, -149.87660686839752, -882.4060051571888, -1068.710460653913, -597.9052012038502, -759.5742855818753, -340.23045903375055, -757.1441182042068, -782.0696195328891, -479.00395414902783, -902.805406209173, -60.19586584623359, -953.0469222944681, -347.87340667645094, -834.7773138772623, -450.47283966691043, -926.3170754390835, -651.6534168327786, -267.860337971862, -338.251750640868, -426.01236417102035]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5555268800347757, "mean_inference_ms": 1.6654253870934703, "mean_action_processing_ms": 0.27504875568357734, "mean_env_wait_ms": 3.3961582424339967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011685371398925781, "StateBufferConnector_ms": 0.007992029190063477, "ViewRequirementAgentConnector_ms": 0.19191861152648926}, "num_episodes": 33, "episode_return_max": -21.075105654298092, "episode_return_min": -1349.785389151133, "episode_return_mean": -665.157182445049, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.3981982844582, "num_env_steps_trained_throughput_per_sec": 309.3981982844582, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12040.657, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12040.582, "sample_time_ms": 1104.315, "learn_time_ms": 10871.72, "learn_throughput": 367.927, "synch_weights_time_ms": 63.757}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "4b94b_00001", "date": "2024-08-05_12-03-58", "timestamp": 1722839638, "time_this_iter_s": 12.94113278388977, "time_total_s": 209.94763350486755, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd011a5f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 209.94763350486755, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 18.016666666666666, "ram_util_percent": 28.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 126.50074474811554, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.0815494972281159, "policy_loss": -0.014395705209850954, "vf_loss": 1.0932615738672515, "vf_explained_var": 0.9947374542554219, "kl": 0.018892600920601896, "entropy": 1.0948874871556957, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -21.075105654298092, "episode_reward_min": -1468.4352786947431, "episode_reward_mean": -633.2951484291475, "episode_len_mean": 132.25, "episode_media": {}, "episodes_timesteps_total": 13225, "policy_reward_min": {"policy_0": -1468.4352786947431}, "policy_reward_max": {"policy_0": -21.075105654298092}, "policy_reward_mean": {"policy_0": -633.2951484291475}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1228.5211845875185, -986.3434958423426, -1060.5662929163261, -456.077600761503, -1083.5954974094516, -992.3271155059145, -21.075105654298092, -382.36906669711976, -248.54986903771223, -1314.9527974866426, -807.5524898097425, -257.9797281991111, -588.2055017213994, -802.784488531907, -164.0666400110284, -78.70496223375908, -1349.785389151133, -818.1340276906329, -689.5438299276517, -568.7230318012269, -298.9971721855179, -816.0025093081712, -519.7095550693123, -861.4095292539223, -703.8365177027882, -1002.1029006107143, -810.8556543688813, -1071.4765369796169, -521.5272782626326, -308.0738002646583, -722.464489153105, -1008.4596320089589, -1180.9377102260808, -274.8414774373209, -109.94365735066066, -640.5496258718541, -813.9187131848973, -836.6232967636079, -917.8710076325766, -702.6155764523032, -122.57230266927456, -1059.1561255678475, -1089.1466665290825, -844.9447613300202, -1217.1895324527004, -115.12510263201202, -251.8098807157363, -581.489237629749, -1118.2946363967867, -478.35881449665925, -294.0677197840867, -71.49569352651422, -935.5850963886688, -149.87660686839752, -882.4060051571888, -1068.710460653913, -597.9052012038502, -759.5742855818753, -340.23045903375055, -757.1441182042068, -782.0696195328891, -479.00395414902783, -902.805406209173, -60.19586584623359, -953.0469222944681, -347.87340667645094, -834.7773138772623, -450.47283966691043, -926.3170754390835, -651.6534168327786, -267.860337971862, -338.251750640868, -426.01236417102035, -1261.2989705111827, -57.93424525427392, -1468.4352786947431, -549.4610983780337, -623.602176915013, -337.6570489808168, -267.5828680197577, -573.4496636056502, -707.2203483230039, -939.0938204620666, -336.7518868214771, -1121.69329045362, -425.6337971250775, -368.4160711454983, -1047.2426083947744, -134.0159486172744, -120.41094742549676, -421.6189793033134, -446.6523816224212, -23.48823623255002, -573.7259784622865, -882.9344058774711, -791.7766469243776, -637.8475186661358, -748.0399134518366, -176.47286382390098, -109.56011422833356], "episode_lengths": [150, 150, 150, 98, 150, 150, 46, 150, 150, 150, 150, 86, 150, 150, 83, 61, 150, 150, 150, 140, 107, 150, 150, 150, 129, 150, 150, 150, 124, 150, 150, 150, 150, 150, 82, 130, 150, 150, 150, 150, 52, 150, 150, 150, 150, 73, 103, 150, 150, 150, 119, 59, 150, 61, 150, 150, 150, 150, 134, 150, 150, 150, 150, 41, 150, 85, 150, 147, 150, 150, 150, 124, 150, 150, 61, 150, 150, 150, 115, 115, 137, 150, 150, 139, 150, 150, 125, 150, 87, 119, 150, 150, 43, 150, 150, 150, 150, 150, 78, 72], "policy_policy_0_reward": [-1228.5211845875185, -986.3434958423426, -1060.5662929163261, -456.077600761503, -1083.5954974094516, -992.3271155059145, -21.075105654298092, -382.36906669711976, -248.54986903771223, -1314.9527974866426, -807.5524898097425, -257.9797281991111, -588.2055017213994, -802.784488531907, -164.0666400110284, -78.70496223375908, -1349.785389151133, -818.1340276906329, -689.5438299276517, -568.7230318012269, -298.9971721855179, -816.0025093081712, -519.7095550693123, -861.4095292539223, -703.8365177027882, -1002.1029006107143, -810.8556543688813, -1071.4765369796169, -521.5272782626326, -308.0738002646583, -722.464489153105, -1008.4596320089589, -1180.9377102260808, -274.8414774373209, -109.94365735066066, -640.5496258718541, -813.9187131848973, -836.6232967636079, -917.8710076325766, -702.6155764523032, -122.57230266927456, -1059.1561255678475, -1089.1466665290825, -844.9447613300202, -1217.1895324527004, -115.12510263201202, -251.8098807157363, -581.489237629749, -1118.2946363967867, -478.35881449665925, -294.0677197840867, -71.49569352651422, -935.5850963886688, -149.87660686839752, -882.4060051571888, -1068.710460653913, -597.9052012038502, -759.5742855818753, -340.23045903375055, -757.1441182042068, -782.0696195328891, -479.00395414902783, -902.805406209173, -60.19586584623359, -953.0469222944681, -347.87340667645094, -834.7773138772623, -450.47283966691043, -926.3170754390835, -651.6534168327786, -267.860337971862, -338.251750640868, -426.01236417102035, -1261.2989705111827, -57.93424525427392, -1468.4352786947431, -549.4610983780337, -623.602176915013, -337.6570489808168, -267.5828680197577, -573.4496636056502, -707.2203483230039, -939.0938204620666, -336.7518868214771, -1121.69329045362, -425.6337971250775, -368.4160711454983, -1047.2426083947744, -134.0159486172744, -120.41094742549676, -421.6189793033134, -446.6523816224212, -23.48823623255002, -573.7259784622865, -882.9344058774711, -791.7766469243776, -637.8475186661358, -748.0399134518366, -176.47286382390098, -109.56011422833356]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5552070163463119, "mean_inference_ms": 1.664625146238126, "mean_action_processing_ms": 0.27477053508561466, "mean_env_wait_ms": 3.3943677574207225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011583328247070312, "StateBufferConnector_ms": 0.007958412170410156, "ViewRequirementAgentConnector_ms": 0.19041752815246582}, "num_episodes": 27, "episode_return_max": -21.075105654298092, "episode_return_min": -1468.4352786947431, "episode_return_mean": -633.2951484291475, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 360.1992451349843, "num_env_steps_trained_throughput_per_sec": 360.1992451349843, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 11865.236, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11865.162, "sample_time_ms": 1098.95, "learn_time_ms": 10701.52, "learn_throughput": 373.779, "synch_weights_time_ms": 63.897}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "4b94b_00001", "date": "2024-08-05_12-04-10", "timestamp": 1722839650, "time_this_iter_s": 11.11709976196289, "time_total_s": 221.06473326683044, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd01b5ab0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 221.06473326683044, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 18.9125, "ram_util_percent": 28.7125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 132.70924103756747, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.011192855409657, "policy_loss": -0.015617744516930543, "vf_loss": 1.024109390936792, "vf_explained_var": 0.9965663672735293, "kl": 0.019058042126926026, "entropy": 1.1103992660840352, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -23.48823623255002, "episode_reward_min": -1468.4352786947431, "episode_reward_mean": -609.3372878014482, "episode_len_mean": 133.86, "episode_media": {}, "episodes_timesteps_total": 13386, "policy_reward_min": {"policy_0": -1468.4352786947431}, "policy_reward_max": {"policy_0": -23.48823623255002}, "policy_reward_mean": {"policy_0": -609.3372878014482}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-308.0738002646583, -722.464489153105, -1008.4596320089589, -1180.9377102260808, -274.8414774373209, -109.94365735066066, -640.5496258718541, -813.9187131848973, -836.6232967636079, -917.8710076325766, -702.6155764523032, -122.57230266927456, -1059.1561255678475, -1089.1466665290825, -844.9447613300202, -1217.1895324527004, -115.12510263201202, -251.8098807157363, -581.489237629749, -1118.2946363967867, -478.35881449665925, -294.0677197840867, -71.49569352651422, -935.5850963886688, -149.87660686839752, -882.4060051571888, -1068.710460653913, -597.9052012038502, -759.5742855818753, -340.23045903375055, -757.1441182042068, -782.0696195328891, -479.00395414902783, -902.805406209173, -60.19586584623359, -953.0469222944681, -347.87340667645094, -834.7773138772623, -450.47283966691043, -926.3170754390835, -651.6534168327786, -267.860337971862, -338.251750640868, -426.01236417102035, -1261.2989705111827, -57.93424525427392, -1468.4352786947431, -549.4610983780337, -623.602176915013, -337.6570489808168, -267.5828680197577, -573.4496636056502, -707.2203483230039, -939.0938204620666, -336.7518868214771, -1121.69329045362, -425.6337971250775, -368.4160711454983, -1047.2426083947744, -134.0159486172744, -120.41094742549676, -421.6189793033134, -446.6523816224212, -23.48823623255002, -573.7259784622865, -882.9344058774711, -791.7766469243776, -637.8475186661358, -748.0399134518366, -176.47286382390098, -109.56011422833356, -964.3446493029143, -215.68014422835935, -1104.043213056083, -467.55083380618146, -398.38604108856345, -82.07279958464028, -1463.1453461978444, -136.98144067285594, -1047.1277249070279, -249.01615605465807, -547.4505405797435, -777.3444475769174, -348.7320691379899, -534.8242857057782, -906.5789613002858, -590.9912987935925, -564.3561455952461, -356.01798989210937, -385.8192219510144, -199.97398564998898, -1019.4617607540897, -758.0660997154586, -370.6558317434957, -445.711833207432, -384.21602958455026, -646.9766418327953, -1027.8739606381698, -784.7397832390219, -1331.8504701512516], "episode_lengths": [150, 150, 150, 150, 150, 82, 130, 150, 150, 150, 150, 52, 150, 150, 150, 150, 73, 103, 150, 150, 150, 119, 59, 150, 61, 150, 150, 150, 150, 134, 150, 150, 150, 150, 41, 150, 85, 150, 147, 150, 150, 150, 124, 150, 150, 61, 150, 150, 150, 115, 115, 137, 150, 150, 139, 150, 150, 125, 150, 87, 119, 150, 150, 43, 150, 150, 150, 150, 150, 78, 72, 150, 112, 150, 150, 150, 69, 150, 83, 150, 102, 150, 150, 122, 150, 150, 150, 150, 150, 130, 150, 150, 150, 124, 150, 150, 143, 150, 150, 150], "policy_policy_0_reward": [-308.0738002646583, -722.464489153105, -1008.4596320089589, -1180.9377102260808, -274.8414774373209, -109.94365735066066, -640.5496258718541, -813.9187131848973, -836.6232967636079, -917.8710076325766, -702.6155764523032, -122.57230266927456, -1059.1561255678475, -1089.1466665290825, -844.9447613300202, -1217.1895324527004, -115.12510263201202, -251.8098807157363, -581.489237629749, -1118.2946363967867, -478.35881449665925, -294.0677197840867, -71.49569352651422, -935.5850963886688, -149.87660686839752, -882.4060051571888, -1068.710460653913, -597.9052012038502, -759.5742855818753, -340.23045903375055, -757.1441182042068, -782.0696195328891, -479.00395414902783, -902.805406209173, -60.19586584623359, -953.0469222944681, -347.87340667645094, -834.7773138772623, -450.47283966691043, -926.3170754390835, -651.6534168327786, -267.860337971862, -338.251750640868, -426.01236417102035, -1261.2989705111827, -57.93424525427392, -1468.4352786947431, -549.4610983780337, -623.602176915013, -337.6570489808168, -267.5828680197577, -573.4496636056502, -707.2203483230039, -939.0938204620666, -336.7518868214771, -1121.69329045362, -425.6337971250775, -368.4160711454983, -1047.2426083947744, -134.0159486172744, -120.41094742549676, -421.6189793033134, -446.6523816224212, -23.48823623255002, -573.7259784622865, -882.9344058774711, -791.7766469243776, -637.8475186661358, -748.0399134518366, -176.47286382390098, -109.56011422833356, -964.3446493029143, -215.68014422835935, -1104.043213056083, -467.55083380618146, -398.38604108856345, -82.07279958464028, -1463.1453461978444, -136.98144067285594, -1047.1277249070279, -249.01615605465807, -547.4505405797435, -777.3444475769174, -348.7320691379899, -534.8242857057782, -906.5789613002858, -590.9912987935925, -564.3561455952461, -356.01798989210937, -385.8192219510144, -199.97398564998898, -1019.4617607540897, -758.0660997154586, -370.6558317434957, -445.711833207432, -384.21602958455026, -646.9766418327953, -1027.8739606381698, -784.7397832390219, -1331.8504701512516]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5548116431450079, "mean_inference_ms": 1.6646600052381557, "mean_action_processing_ms": 0.27488412848878707, "mean_env_wait_ms": 3.391506104737264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0114898681640625, "StateBufferConnector_ms": 0.008064031600952148, "ViewRequirementAgentConnector_ms": 0.19295597076416016}, "num_episodes": 29, "episode_return_max": -23.48823623255002, "episode_return_min": -1468.4352786947431, "episode_return_mean": -609.3372878014482, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.7513798681329, "num_env_steps_trained_throughput_per_sec": 311.7513798681329, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12019.709, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12019.635, "sample_time_ms": 1097.435, "learn_time_ms": 10857.233, "learn_throughput": 368.418, "synch_weights_time_ms": 64.172}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "4b94b_00001", "date": "2024-08-05_12-04-22", "timestamp": 1722839662, "time_this_iter_s": 12.84273886680603, "time_total_s": 233.90747213363647, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd011a5f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 233.90747213363647, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 18.177777777777777, "ram_util_percent": 28.705555555555552}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 161.20462956925232, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.210436055654039, "policy_loss": -0.012364200792217162, "vf_loss": 1.2203717914099494, "vf_explained_var": 0.9951281004895767, "kl": 0.017876145858084187, "entropy": 1.1467604500552018, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -23.48823623255002, "episode_reward_min": -1468.4352786947431, "episode_reward_mean": -594.7970357735644, "episode_len_mean": 135.32, "episode_media": {}, "episodes_timesteps_total": 13532, "policy_reward_min": {"policy_0": -1468.4352786947431}, "policy_reward_max": {"policy_0": -23.48823623255002}, "policy_reward_mean": {"policy_0": -594.7970357735644}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-757.1441182042068, -782.0696195328891, -479.00395414902783, -902.805406209173, -60.19586584623359, -953.0469222944681, -347.87340667645094, -834.7773138772623, -450.47283966691043, -926.3170754390835, -651.6534168327786, -267.860337971862, -338.251750640868, -426.01236417102035, -1261.2989705111827, -57.93424525427392, -1468.4352786947431, -549.4610983780337, -623.602176915013, -337.6570489808168, -267.5828680197577, -573.4496636056502, -707.2203483230039, -939.0938204620666, -336.7518868214771, -1121.69329045362, -425.6337971250775, -368.4160711454983, -1047.2426083947744, -134.0159486172744, -120.41094742549676, -421.6189793033134, -446.6523816224212, -23.48823623255002, -573.7259784622865, -882.9344058774711, -791.7766469243776, -637.8475186661358, -748.0399134518366, -176.47286382390098, -109.56011422833356, -964.3446493029143, -215.68014422835935, -1104.043213056083, -467.55083380618146, -398.38604108856345, -82.07279958464028, -1463.1453461978444, -136.98144067285594, -1047.1277249070279, -249.01615605465807, -547.4505405797435, -777.3444475769174, -348.7320691379899, -534.8242857057782, -906.5789613002858, -590.9912987935925, -564.3561455952461, -356.01798989210937, -385.8192219510144, -199.97398564998898, -1019.4617607540897, -758.0660997154586, -370.6558317434957, -445.711833207432, -384.21602958455026, -646.9766418327953, -1027.8739606381698, -784.7397832390219, -1331.8504701512516, -867.3965784549152, -1035.085963181893, -251.67135339235313, -792.5807394828439, -1140.0090546336598, -316.129375270219, -822.3653991782196, -312.00144030861514, -725.4082674110756, -544.5163280830027, -819.4538423150797, -122.39997498652284, -564.8451619287866, -413.05141632455184, -254.97517825410887, -134.48010158012113, -693.4945355609112, -564.6856613946748, -790.0424426285213, -349.4332916384429, -686.1769984131967, -141.6914486188199, -533.9725615939551, -1171.39237331793, -748.2315661247239, -623.3299426907921, -951.8013067451807, -803.7329588867293, -588.9542245667085, -276.9028852091975], "episode_lengths": [150, 150, 150, 150, 41, 150, 85, 150, 147, 150, 150, 150, 124, 150, 150, 61, 150, 150, 150, 115, 115, 137, 150, 150, 139, 150, 150, 125, 150, 87, 119, 150, 150, 43, 150, 150, 150, 150, 150, 78, 72, 150, 112, 150, 150, 150, 69, 150, 83, 150, 102, 150, 150, 122, 150, 150, 150, 150, 150, 130, 150, 150, 150, 124, 150, 150, 143, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 74, 150, 145, 119, 93, 150, 150, 150, 145, 150, 71, 128, 150, 150, 150, 150, 150, 150, 82], "policy_policy_0_reward": [-757.1441182042068, -782.0696195328891, -479.00395414902783, -902.805406209173, -60.19586584623359, -953.0469222944681, -347.87340667645094, -834.7773138772623, -450.47283966691043, -926.3170754390835, -651.6534168327786, -267.860337971862, -338.251750640868, -426.01236417102035, -1261.2989705111827, -57.93424525427392, -1468.4352786947431, -549.4610983780337, -623.602176915013, -337.6570489808168, -267.5828680197577, -573.4496636056502, -707.2203483230039, -939.0938204620666, -336.7518868214771, -1121.69329045362, -425.6337971250775, -368.4160711454983, -1047.2426083947744, -134.0159486172744, -120.41094742549676, -421.6189793033134, -446.6523816224212, -23.48823623255002, -573.7259784622865, -882.9344058774711, -791.7766469243776, -637.8475186661358, -748.0399134518366, -176.47286382390098, -109.56011422833356, -964.3446493029143, -215.68014422835935, -1104.043213056083, -467.55083380618146, -398.38604108856345, -82.07279958464028, -1463.1453461978444, -136.98144067285594, -1047.1277249070279, -249.01615605465807, -547.4505405797435, -777.3444475769174, -348.7320691379899, -534.8242857057782, -906.5789613002858, -590.9912987935925, -564.3561455952461, -356.01798989210937, -385.8192219510144, -199.97398564998898, -1019.4617607540897, -758.0660997154586, -370.6558317434957, -445.711833207432, -384.21602958455026, -646.9766418327953, -1027.8739606381698, -784.7397832390219, -1331.8504701512516, -867.3965784549152, -1035.085963181893, -251.67135339235313, -792.5807394828439, -1140.0090546336598, -316.129375270219, -822.3653991782196, -312.00144030861514, -725.4082674110756, -544.5163280830027, -819.4538423150797, -122.39997498652284, -564.8451619287866, -413.05141632455184, -254.97517825410887, -134.48010158012113, -693.4945355609112, -564.6856613946748, -790.0424426285213, -349.4332916384429, -686.1769984131967, -141.6914486188199, -533.9725615939551, -1171.39237331793, -748.2315661247239, -623.3299426907921, -951.8013067451807, -803.7329588867293, -588.9542245667085, -276.9028852091975]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5543098339418172, "mean_inference_ms": 1.66322131851216, "mean_action_processing_ms": 0.274479300382207, "mean_env_wait_ms": 3.388400138483577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011496782302856445, "StateBufferConnector_ms": 0.007989168167114258, "ViewRequirementAgentConnector_ms": 0.19350147247314453}, "num_episodes": 30, "episode_return_max": -23.48823623255002, "episode_return_min": -1468.4352786947431, "episode_return_mean": -594.7970357735644, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 337.56502474593213, "num_env_steps_trained_throughput_per_sec": 337.56502474593213, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 11986.228, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11986.153, "sample_time_ms": 1099.601, "learn_time_ms": 10819.322, "learn_throughput": 369.709, "synch_weights_time_ms": 66.423}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "4b94b_00001", "date": "2024-08-05_12-04-34", "timestamp": 1722839674, "time_this_iter_s": 11.862199544906616, "time_total_s": 245.7696716785431, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd0103ac0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 245.7696716785431, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 18.78235294117647, "ram_util_percent": 28.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 129.5760309259097, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.1302730011753739, "policy_loss": -0.01228155052473691, "vf_loss": 1.1393882816346983, "vf_explained_var": 0.995357743712763, "kl": 0.021063319374813243, "entropy": 1.0463976082081596, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -17.739776606058978, "episode_reward_min": -1463.1453461978444, "episode_reward_mean": -590.8944656829594, "episode_len_mean": 133.35, "episode_media": {}, "episodes_timesteps_total": 13335, "policy_reward_min": {"policy_0": -1463.1453461978444}, "policy_reward_max": {"policy_0": -17.739776606058978}, "policy_reward_mean": {"policy_0": -590.8944656829594}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-573.7259784622865, -882.9344058774711, -791.7766469243776, -637.8475186661358, -748.0399134518366, -176.47286382390098, -109.56011422833356, -964.3446493029143, -215.68014422835935, -1104.043213056083, -467.55083380618146, -398.38604108856345, -82.07279958464028, -1463.1453461978444, -136.98144067285594, -1047.1277249070279, -249.01615605465807, -547.4505405797435, -777.3444475769174, -348.7320691379899, -534.8242857057782, -906.5789613002858, -590.9912987935925, -564.3561455952461, -356.01798989210937, -385.8192219510144, -199.97398564998898, -1019.4617607540897, -758.0660997154586, -370.6558317434957, -445.711833207432, -384.21602958455026, -646.9766418327953, -1027.8739606381698, -784.7397832390219, -1331.8504701512516, -867.3965784549152, -1035.085963181893, -251.67135339235313, -792.5807394828439, -1140.0090546336598, -316.129375270219, -822.3653991782196, -312.00144030861514, -725.4082674110756, -544.5163280830027, -819.4538423150797, -122.39997498652284, -564.8451619287866, -413.05141632455184, -254.97517825410887, -134.48010158012113, -693.4945355609112, -564.6856613946748, -790.0424426285213, -349.4332916384429, -686.1769984131967, -141.6914486188199, -533.9725615939551, -1171.39237331793, -748.2315661247239, -623.3299426907921, -951.8013067451807, -803.7329588867293, -588.9542245667085, -276.9028852091975, -126.2061025729202, -1053.5523180586724, -897.0136990709547, -372.19755586488714, -784.4653176606745, -1247.8591512961293, -550.5368329653392, -121.83185191825949, -902.7947192266781, -157.40001624261893, -1411.084858737942, -934.8978765337276, -305.3722427064348, -186.69641541742794, -1269.66780331263, -282.04402976097964, -504.75029220139794, -1200.6212798975755, -570.0093039143305, -631.955783409462, -17.739776606058978, -401.19171892780486, -335.73271921916205, -516.1075769805356, -826.3411021588537, -221.79773386601687, -50.388656927354305, -833.5596106973685, -265.6502880357467, -546.4289258486804, -195.43580418903412, -424.3034874819459, -81.24446665664654, -792.0077303735388], "episode_lengths": [150, 150, 150, 150, 150, 78, 72, 150, 112, 150, 150, 150, 69, 150, 83, 150, 102, 150, 150, 122, 150, 150, 150, 150, 150, 130, 150, 150, 150, 124, 150, 150, 143, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 74, 150, 145, 119, 93, 150, 150, 150, 145, 150, 71, 128, 150, 150, 150, 150, 150, 150, 82, 80, 150, 150, 93, 150, 150, 150, 76, 150, 72, 150, 150, 126, 79, 150, 150, 150, 150, 150, 150, 35, 150, 119, 150, 150, 98, 56, 150, 92, 150, 102, 150, 113, 150], "policy_policy_0_reward": [-573.7259784622865, -882.9344058774711, -791.7766469243776, -637.8475186661358, -748.0399134518366, -176.47286382390098, -109.56011422833356, -964.3446493029143, -215.68014422835935, -1104.043213056083, -467.55083380618146, -398.38604108856345, -82.07279958464028, -1463.1453461978444, -136.98144067285594, -1047.1277249070279, -249.01615605465807, -547.4505405797435, -777.3444475769174, -348.7320691379899, -534.8242857057782, -906.5789613002858, -590.9912987935925, -564.3561455952461, -356.01798989210937, -385.8192219510144, -199.97398564998898, -1019.4617607540897, -758.0660997154586, -370.6558317434957, -445.711833207432, -384.21602958455026, -646.9766418327953, -1027.8739606381698, -784.7397832390219, -1331.8504701512516, -867.3965784549152, -1035.085963181893, -251.67135339235313, -792.5807394828439, -1140.0090546336598, -316.129375270219, -822.3653991782196, -312.00144030861514, -725.4082674110756, -544.5163280830027, -819.4538423150797, -122.39997498652284, -564.8451619287866, -413.05141632455184, -254.97517825410887, -134.48010158012113, -693.4945355609112, -564.6856613946748, -790.0424426285213, -349.4332916384429, -686.1769984131967, -141.6914486188199, -533.9725615939551, -1171.39237331793, -748.2315661247239, -623.3299426907921, -951.8013067451807, -803.7329588867293, -588.9542245667085, -276.9028852091975, -126.2061025729202, -1053.5523180586724, -897.0136990709547, -372.19755586488714, -784.4653176606745, -1247.8591512961293, -550.5368329653392, -121.83185191825949, -902.7947192266781, -157.40001624261893, -1411.084858737942, -934.8978765337276, -305.3722427064348, -186.69641541742794, -1269.66780331263, -282.04402976097964, -504.75029220139794, -1200.6212798975755, -570.0093039143305, -631.955783409462, -17.739776606058978, -401.19171892780486, -335.73271921916205, -516.1075769805356, -826.3411021588537, -221.79773386601687, -50.388656927354305, -833.5596106973685, -265.6502880357467, -546.4289258486804, -195.43580418903412, -424.3034874819459, -81.24446665664654, -792.0077303735388]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5542136314519077, "mean_inference_ms": 1.6632227183143684, "mean_action_processing_ms": 0.27450971023434356, "mean_env_wait_ms": 3.3891723496235175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011717557907104492, "StateBufferConnector_ms": 0.008266687393188477, "ViewRequirementAgentConnector_ms": 0.19768571853637695}, "num_episodes": 34, "episode_return_max": -17.739776606058978, "episode_return_min": -1463.1453461978444, "episode_return_mean": -590.8944656829594, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.1968625536082, "num_env_steps_trained_throughput_per_sec": 310.1968625536082, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12082.442, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12082.369, "sample_time_ms": 1097.275, "learn_time_ms": 10917.594, "learn_throughput": 366.381, "synch_weights_time_ms": 66.691}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "4b94b_00001", "date": "2024-08-05_12-04-47", "timestamp": 1722839687, "time_this_iter_s": 12.907389640808105, "time_total_s": 258.6770613193512, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd011b370>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 258.6770613193512, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 17.763157894736842, "ram_util_percent": 28.71578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 151.03161175946394, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.0835543504605691, "policy_loss": -0.014697256516956258, "vf_loss": 1.0940750065570077, "vf_explained_var": 0.9943080191810926, "kl": 0.017259929417590077, "entropy": 1.0013796259338656, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -17.739776606058978, "episode_reward_min": -1411.084858737942, "episode_reward_mean": -560.8201171356994, "episode_len_mean": 128.33, "episode_media": {}, "episodes_timesteps_total": 12833, "policy_reward_min": {"policy_0": -1411.084858737942}, "policy_reward_max": {"policy_0": -17.739776606058978}, "policy_reward_mean": {"policy_0": -560.8201171356994}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-384.21602958455026, -646.9766418327953, -1027.8739606381698, -784.7397832390219, -1331.8504701512516, -867.3965784549152, -1035.085963181893, -251.67135339235313, -792.5807394828439, -1140.0090546336598, -316.129375270219, -822.3653991782196, -312.00144030861514, -725.4082674110756, -544.5163280830027, -819.4538423150797, -122.39997498652284, -564.8451619287866, -413.05141632455184, -254.97517825410887, -134.48010158012113, -693.4945355609112, -564.6856613946748, -790.0424426285213, -349.4332916384429, -686.1769984131967, -141.6914486188199, -533.9725615939551, -1171.39237331793, -748.2315661247239, -623.3299426907921, -951.8013067451807, -803.7329588867293, -588.9542245667085, -276.9028852091975, -126.2061025729202, -1053.5523180586724, -897.0136990709547, -372.19755586488714, -784.4653176606745, -1247.8591512961293, -550.5368329653392, -121.83185191825949, -902.7947192266781, -157.40001624261893, -1411.084858737942, -934.8978765337276, -305.3722427064348, -186.69641541742794, -1269.66780331263, -282.04402976097964, -504.75029220139794, -1200.6212798975755, -570.0093039143305, -631.955783409462, -17.739776606058978, -401.19171892780486, -335.73271921916205, -516.1075769805356, -826.3411021588537, -221.79773386601687, -50.388656927354305, -833.5596106973685, -265.6502880357467, -546.4289258486804, -195.43580418903412, -424.3034874819459, -81.24446665664654, -792.0077303735388, -1050.894349920565, -665.9588187752661, -302.5275472944854, -51.47285916548456, -1015.5278614237174, -950.8828110829336, -67.68327930879873, -728.1929591087785, -283.5090238502181, -1102.7997603909455, -191.07934926090607, -507.0929308203025, -475.0262458900573, -498.62299403289524, -636.2760299833395, -350.677801522559, -204.08517042783683, -144.26195377566134, -189.04399394061798, -56.82285478653495, -486.49606484910873, -263.3026241918432, -466.41492377241207, -228.7450009106798, -847.5048769304642, -455.5316417215885, -700.4748868983253, -1084.0897635865845, -321.51434137322866, -195.5465944221866, -325.19609379228353], "episode_lengths": [150, 143, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 74, 150, 145, 119, 93, 150, 150, 150, 145, 150, 71, 128, 150, 150, 150, 150, 150, 150, 82, 80, 150, 150, 93, 150, 150, 150, 76, 150, 72, 150, 150, 126, 79, 150, 150, 150, 150, 150, 150, 35, 150, 119, 150, 150, 98, 56, 150, 92, 150, 102, 150, 113, 150, 150, 150, 84, 49, 150, 150, 47, 150, 103, 150, 82, 150, 150, 150, 150, 123, 90, 83, 94, 42, 149, 72, 150, 104, 150, 150, 150, 150, 106, 94, 118], "policy_policy_0_reward": [-384.21602958455026, -646.9766418327953, -1027.8739606381698, -784.7397832390219, -1331.8504701512516, -867.3965784549152, -1035.085963181893, -251.67135339235313, -792.5807394828439, -1140.0090546336598, -316.129375270219, -822.3653991782196, -312.00144030861514, -725.4082674110756, -544.5163280830027, -819.4538423150797, -122.39997498652284, -564.8451619287866, -413.05141632455184, -254.97517825410887, -134.48010158012113, -693.4945355609112, -564.6856613946748, -790.0424426285213, -349.4332916384429, -686.1769984131967, -141.6914486188199, -533.9725615939551, -1171.39237331793, -748.2315661247239, -623.3299426907921, -951.8013067451807, -803.7329588867293, -588.9542245667085, -276.9028852091975, -126.2061025729202, -1053.5523180586724, -897.0136990709547, -372.19755586488714, -784.4653176606745, -1247.8591512961293, -550.5368329653392, -121.83185191825949, -902.7947192266781, -157.40001624261893, -1411.084858737942, -934.8978765337276, -305.3722427064348, -186.69641541742794, -1269.66780331263, -282.04402976097964, -504.75029220139794, -1200.6212798975755, -570.0093039143305, -631.955783409462, -17.739776606058978, -401.19171892780486, -335.73271921916205, -516.1075769805356, -826.3411021588537, -221.79773386601687, -50.388656927354305, -833.5596106973685, -265.6502880357467, -546.4289258486804, -195.43580418903412, -424.3034874819459, -81.24446665664654, -792.0077303735388, -1050.894349920565, -665.9588187752661, -302.5275472944854, -51.47285916548456, -1015.5278614237174, -950.8828110829336, -67.68327930879873, -728.1929591087785, -283.5090238502181, -1102.7997603909455, -191.07934926090607, -507.0929308203025, -475.0262458900573, -498.62299403289524, -636.2760299833395, -350.677801522559, -204.08517042783683, -144.26195377566134, -189.04399394061798, -56.82285478653495, -486.49606484910873, -263.3026241918432, -466.41492377241207, -228.7450009106798, -847.5048769304642, -455.5316417215885, -700.4748868983253, -1084.0897635865845, -321.51434137322866, -195.5465944221866, -325.19609379228353]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5538836135930694, "mean_inference_ms": 1.6629460861118652, "mean_action_processing_ms": 0.2743040382665326, "mean_env_wait_ms": 3.388173837712535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01165318489074707, "StateBufferConnector_ms": 0.008210182189941406, "ViewRequirementAgentConnector_ms": 0.1972975730895996}, "num_episodes": 31, "episode_return_max": -17.739776606058978, "episode_return_min": -1411.084858737942, "episode_return_mean": -560.8201171356994, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 362.4385664061774, "num_env_steps_trained_throughput_per_sec": 362.4385664061774, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12038.47, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12038.397, "sample_time_ms": 1100.814, "learn_time_ms": 10869.947, "learn_throughput": 367.987, "synch_weights_time_ms": 66.82}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "4b94b_00001", "date": "2024-08-05_12-04-58", "timestamp": 1722839698, "time_this_iter_s": 11.048872470855713, "time_total_s": 269.7259337902069, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd0103760>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 269.7259337902069, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 19.168750000000003, "ram_util_percent": 28.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 140.07190426985423, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 0.8826657401708266, "policy_loss": -0.011682269162459609, "vf_loss": 0.889693639986217, "vf_explained_var": 0.997793071779112, "kl": 0.019151735264828555, "entropy": 1.0911478921150168, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -17.739776606058978, "episode_reward_min": -1411.084858737942, "episode_reward_mean": -520.196752480392, "episode_len_mean": 121.7, "episode_media": {}, "episodes_timesteps_total": 12170, "policy_reward_min": {"policy_0": -1411.084858737942}, "policy_reward_max": {"policy_0": -17.739776606058978}, "policy_reward_mean": {"policy_0": -520.196752480392}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-588.9542245667085, -276.9028852091975, -126.2061025729202, -1053.5523180586724, -897.0136990709547, -372.19755586488714, -784.4653176606745, -1247.8591512961293, -550.5368329653392, -121.83185191825949, -902.7947192266781, -157.40001624261893, -1411.084858737942, -934.8978765337276, -305.3722427064348, -186.69641541742794, -1269.66780331263, -282.04402976097964, -504.75029220139794, -1200.6212798975755, -570.0093039143305, -631.955783409462, -17.739776606058978, -401.19171892780486, -335.73271921916205, -516.1075769805356, -826.3411021588537, -221.79773386601687, -50.388656927354305, -833.5596106973685, -265.6502880357467, -546.4289258486804, -195.43580418903412, -424.3034874819459, -81.24446665664654, -792.0077303735388, -1050.894349920565, -665.9588187752661, -302.5275472944854, -51.47285916548456, -1015.5278614237174, -950.8828110829336, -67.68327930879873, -728.1929591087785, -283.5090238502181, -1102.7997603909455, -191.07934926090607, -507.0929308203025, -475.0262458900573, -498.62299403289524, -636.2760299833395, -350.677801522559, -204.08517042783683, -144.26195377566134, -189.04399394061798, -56.82285478653495, -486.49606484910873, -263.3026241918432, -466.41492377241207, -228.7450009106798, -847.5048769304642, -455.5316417215885, -700.4748868983253, -1084.0897635865845, -321.51434137322866, -195.5465944221866, -325.19609379228353, -1129.6310601726016, -59.42928048473903, -357.4432610034286, -346.77984820661237, -24.298344359739797, -676.7440287604815, -915.2846135375272, -970.6442894994324, -98.10604998770621, -644.2906285521632, -877.1807297340766, -148.57227251896725, -944.7257982960874, -968.9984934976261, -72.33062049810722, -105.86475371593784, -27.586735954738263, -142.9984969259732, -1214.0369553454714, -384.8101124092861, -899.1525913760751, -1099.093780984185, -680.5102050904986, -206.61277691813052, -1009.9806892243482, -154.51397296031348, -578.5256033455861, -733.2807865282525, -31.396504431835012, -535.8606651259556, -65.98420594854174, -817.7165578054905, -365.29096911498027], "episode_lengths": [150, 82, 80, 150, 150, 93, 150, 150, 150, 76, 150, 72, 150, 150, 126, 79, 150, 150, 150, 150, 150, 150, 35, 150, 119, 150, 150, 98, 56, 150, 92, 150, 102, 150, 113, 150, 150, 150, 84, 49, 150, 150, 47, 150, 103, 150, 82, 150, 150, 150, 150, 123, 90, 83, 94, 42, 149, 72, 150, 104, 150, 150, 150, 150, 106, 94, 118, 150, 59, 140, 150, 39, 150, 150, 150, 71, 150, 150, 72, 150, 150, 66, 75, 42, 67, 150, 150, 150, 150, 150, 117, 150, 91, 150, 150, 56, 150, 62, 150, 150], "policy_policy_0_reward": [-588.9542245667085, -276.9028852091975, -126.2061025729202, -1053.5523180586724, -897.0136990709547, -372.19755586488714, -784.4653176606745, -1247.8591512961293, -550.5368329653392, -121.83185191825949, -902.7947192266781, -157.40001624261893, -1411.084858737942, -934.8978765337276, -305.3722427064348, -186.69641541742794, -1269.66780331263, -282.04402976097964, -504.75029220139794, -1200.6212798975755, -570.0093039143305, -631.955783409462, -17.739776606058978, -401.19171892780486, -335.73271921916205, -516.1075769805356, -826.3411021588537, -221.79773386601687, -50.388656927354305, -833.5596106973685, -265.6502880357467, -546.4289258486804, -195.43580418903412, -424.3034874819459, -81.24446665664654, -792.0077303735388, -1050.894349920565, -665.9588187752661, -302.5275472944854, -51.47285916548456, -1015.5278614237174, -950.8828110829336, -67.68327930879873, -728.1929591087785, -283.5090238502181, -1102.7997603909455, -191.07934926090607, -507.0929308203025, -475.0262458900573, -498.62299403289524, -636.2760299833395, -350.677801522559, -204.08517042783683, -144.26195377566134, -189.04399394061798, -56.82285478653495, -486.49606484910873, -263.3026241918432, -466.41492377241207, -228.7450009106798, -847.5048769304642, -455.5316417215885, -700.4748868983253, -1084.0897635865845, -321.51434137322866, -195.5465944221866, -325.19609379228353, -1129.6310601726016, -59.42928048473903, -357.4432610034286, -346.77984820661237, -24.298344359739797, -676.7440287604815, -915.2846135375272, -970.6442894994324, -98.10604998770621, -644.2906285521632, -877.1807297340766, -148.57227251896725, -944.7257982960874, -968.9984934976261, -72.33062049810722, -105.86475371593784, -27.586735954738263, -142.9984969259732, -1214.0369553454714, -384.8101124092861, -899.1525913760751, -1099.093780984185, -680.5102050904986, -206.61277691813052, -1009.9806892243482, -154.51397296031348, -578.5256033455861, -733.2807865282525, -31.396504431835012, -535.8606651259556, -65.98420594854174, -817.7165578054905, -365.29096911498027]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5537878437020387, "mean_inference_ms": 1.664045279331476, "mean_action_processing_ms": 0.2748693885827878, "mean_env_wait_ms": 3.3901706383290002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011817693710327148, "StateBufferConnector_ms": 0.0081024169921875, "ViewRequirementAgentConnector_ms": 0.1920778751373291}, "num_episodes": 33, "episode_return_max": -17.739776606058978, "episode_return_min": -1411.084858737942, "episode_return_mean": -520.196752480392, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 339.03399007920547, "num_env_steps_trained_throughput_per_sec": 339.03399007920547, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12176.461, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12176.39, "sample_time_ms": 1108.574, "learn_time_ms": 10998.874, "learn_throughput": 363.674, "synch_weights_time_ms": 68.111}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "4b94b_00001", "date": "2024-08-05_12-05-10", "timestamp": 1722839710, "time_this_iter_s": 11.809948444366455, "time_total_s": 281.53588223457336, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd01b4ca0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 281.53588223457336, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 18.90625, "ram_util_percent": 28.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 177.43520204126835, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.0899831897579133, "policy_loss": -0.010434538179348843, "vf_loss": 1.0972909067446988, "vf_explained_var": 0.9925380817924937, "kl": 0.014093330207773154, "entropy": 1.101179210903744, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -24.298344359739797, "episode_reward_min": -1240.013268915161, "episode_reward_mean": -553.6933822047324, "episode_len_mean": 124.76, "episode_media": {}, "episodes_timesteps_total": 12476, "policy_reward_min": {"policy_0": -1240.013268915161}, "policy_reward_max": {"policy_0": -24.298344359739797}, "policy_reward_mean": {"policy_0": -553.6933822047324}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-424.3034874819459, -81.24446665664654, -792.0077303735388, -1050.894349920565, -665.9588187752661, -302.5275472944854, -51.47285916548456, -1015.5278614237174, -950.8828110829336, -67.68327930879873, -728.1929591087785, -283.5090238502181, -1102.7997603909455, -191.07934926090607, -507.0929308203025, -475.0262458900573, -498.62299403289524, -636.2760299833395, -350.677801522559, -204.08517042783683, -144.26195377566134, -189.04399394061798, -56.82285478653495, -486.49606484910873, -263.3026241918432, -466.41492377241207, -228.7450009106798, -847.5048769304642, -455.5316417215885, -700.4748868983253, -1084.0897635865845, -321.51434137322866, -195.5465944221866, -325.19609379228353, -1129.6310601726016, -59.42928048473903, -357.4432610034286, -346.77984820661237, -24.298344359739797, -676.7440287604815, -915.2846135375272, -970.6442894994324, -98.10604998770621, -644.2906285521632, -877.1807297340766, -148.57227251896725, -944.7257982960874, -968.9984934976261, -72.33062049810722, -105.86475371593784, -27.586735954738263, -142.9984969259732, -1214.0369553454714, -384.8101124092861, -899.1525913760751, -1099.093780984185, -680.5102050904986, -206.61277691813052, -1009.9806892243482, -154.51397296031348, -578.5256033455861, -733.2807865282525, -31.396504431835012, -535.8606651259556, -65.98420594854174, -817.7165578054905, -365.29096911498027, -752.896541820286, -731.228101589339, -1031.43250300031, -744.9887762320075, -1183.983647115621, -436.3761701985967, -580.0780028973512, -413.03103458547565, -1123.2495711725978, -531.7418529061772, -179.43982395945977, -730.8072032745398, -1221.660503290044, -1100.8814322876199, -611.2203030434928, -1240.013268915161, -179.28577931559212, -235.75402549258638, -1159.4519912778926, -733.6252631949992, -729.7407054351964, -318.986741226932, -167.28672421472717, -657.2229489010962, -1055.0575839945604, -449.1833544101962, -388.91314310870314, -404.351239277916, -1073.9694393082707, -735.5887641236094, -618.6782286505904, -300.8106755625286, -115.91610265212228], "episode_lengths": [150, 113, 150, 150, 150, 84, 49, 150, 150, 47, 150, 103, 150, 82, 150, 150, 150, 150, 123, 90, 83, 94, 42, 149, 72, 150, 104, 150, 150, 150, 150, 106, 94, 118, 150, 59, 140, 150, 39, 150, 150, 150, 71, 150, 150, 72, 150, 150, 66, 75, 42, 67, 150, 150, 150, 150, 150, 117, 150, 91, 150, 150, 56, 150, 62, 150, 150, 150, 150, 150, 150, 150, 146, 150, 128, 150, 122, 83, 150, 150, 150, 150, 150, 87, 94, 150, 143, 150, 110, 89, 150, 150, 137, 121, 134, 150, 150, 150, 98, 74], "policy_policy_0_reward": [-424.3034874819459, -81.24446665664654, -792.0077303735388, -1050.894349920565, -665.9588187752661, -302.5275472944854, -51.47285916548456, -1015.5278614237174, -950.8828110829336, -67.68327930879873, -728.1929591087785, -283.5090238502181, -1102.7997603909455, -191.07934926090607, -507.0929308203025, -475.0262458900573, -498.62299403289524, -636.2760299833395, -350.677801522559, -204.08517042783683, -144.26195377566134, -189.04399394061798, -56.82285478653495, -486.49606484910873, -263.3026241918432, -466.41492377241207, -228.7450009106798, -847.5048769304642, -455.5316417215885, -700.4748868983253, -1084.0897635865845, -321.51434137322866, -195.5465944221866, -325.19609379228353, -1129.6310601726016, -59.42928048473903, -357.4432610034286, -346.77984820661237, -24.298344359739797, -676.7440287604815, -915.2846135375272, -970.6442894994324, -98.10604998770621, -644.2906285521632, -877.1807297340766, -148.57227251896725, -944.7257982960874, -968.9984934976261, -72.33062049810722, -105.86475371593784, -27.586735954738263, -142.9984969259732, -1214.0369553454714, -384.8101124092861, -899.1525913760751, -1099.093780984185, -680.5102050904986, -206.61277691813052, -1009.9806892243482, -154.51397296031348, -578.5256033455861, -733.2807865282525, -31.396504431835012, -535.8606651259556, -65.98420594854174, -817.7165578054905, -365.29096911498027, -752.896541820286, -731.228101589339, -1031.43250300031, -744.9887762320075, -1183.983647115621, -436.3761701985967, -580.0780028973512, -413.03103458547565, -1123.2495711725978, -531.7418529061772, -179.43982395945977, -730.8072032745398, -1221.660503290044, -1100.8814322876199, -611.2203030434928, -1240.013268915161, -179.28577931559212, -235.75402549258638, -1159.4519912778926, -733.6252631949992, -729.7407054351964, -318.986741226932, -167.28672421472717, -657.2229489010962, -1055.0575839945604, -449.1833544101962, -388.91314310870314, -404.351239277916, -1073.9694393082707, -735.5887641236094, -618.6782286505904, -300.8106755625286, -115.91610265212228]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5537859736208558, "mean_inference_ms": 1.6638447969003927, "mean_action_processing_ms": 0.2749312347182101, "mean_env_wait_ms": 3.3902088254179596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01178121566772461, "StateBufferConnector_ms": 0.008161544799804688, "ViewRequirementAgentConnector_ms": 0.19421029090881348}, "num_episodes": 33, "episode_return_max": -24.298344359739797, "episode_return_min": -1240.013268915161, "episode_return_mean": -553.6933822047324, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.42427022864865, "num_env_steps_trained_throughput_per_sec": 309.42427022864865, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12220.646, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12220.571, "sample_time_ms": 1111.574, "learn_time_ms": 11039.543, "learn_throughput": 362.334, "synch_weights_time_ms": 68.629}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "4b94b_00001", "date": "2024-08-05_12-05-23", "timestamp": 1722839723, "time_this_iter_s": 12.939388036727905, "time_total_s": 294.47527027130127, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd01b6290>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 294.47527027130127, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 17.942105263157895, "ram_util_percent": 28.71578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 114.63646355867385, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.1050601765202979, "policy_loss": -0.021817183305392972, "vf_loss": 1.1221404821922383, "vf_explained_var": 0.9964485400666793, "kl": 0.019191120250585923, "entropy": 1.0204559264704585, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -24.298344359739797, "episode_reward_min": -1240.013268915161, "episode_reward_mean": -550.4726710450707, "episode_len_mean": 125.51, "episode_media": {}, "episodes_timesteps_total": 12551, "policy_reward_min": {"policy_0": -1240.013268915161}, "policy_reward_max": {"policy_0": -24.298344359739797}, "policy_reward_mean": {"policy_0": -550.4726710450707}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-700.4748868983253, -1084.0897635865845, -321.51434137322866, -195.5465944221866, -325.19609379228353, -1129.6310601726016, -59.42928048473903, -357.4432610034286, -346.77984820661237, -24.298344359739797, -676.7440287604815, -915.2846135375272, -970.6442894994324, -98.10604998770621, -644.2906285521632, -877.1807297340766, -148.57227251896725, -944.7257982960874, -968.9984934976261, -72.33062049810722, -105.86475371593784, -27.586735954738263, -142.9984969259732, -1214.0369553454714, -384.8101124092861, -899.1525913760751, -1099.093780984185, -680.5102050904986, -206.61277691813052, -1009.9806892243482, -154.51397296031348, -578.5256033455861, -733.2807865282525, -31.396504431835012, -535.8606651259556, -65.98420594854174, -817.7165578054905, -365.29096911498027, -752.896541820286, -731.228101589339, -1031.43250300031, -744.9887762320075, -1183.983647115621, -436.3761701985967, -580.0780028973512, -413.03103458547565, -1123.2495711725978, -531.7418529061772, -179.43982395945977, -730.8072032745398, -1221.660503290044, -1100.8814322876199, -611.2203030434928, -1240.013268915161, -179.28577931559212, -235.75402549258638, -1159.4519912778926, -733.6252631949992, -729.7407054351964, -318.986741226932, -167.28672421472717, -657.2229489010962, -1055.0575839945604, -449.1833544101962, -388.91314310870314, -404.351239277916, -1073.9694393082707, -735.5887641236094, -618.6782286505904, -300.8106755625286, -115.91610265212228, -59.57783230801226, -589.0772139924647, -1023.5400132275986, -975.4041224956371, -50.32370944426083, -247.06642776578897, -406.0615027761795, -1076.2439933437477, -350.4310342405701, -109.14496590217487, -396.64227339848117, -618.8271517086964, -83.67949976009879, -1038.806731261164, -160.68561056497168, -681.4707256463848, -604.9196553385995, -442.5543496041248, -40.25953963875575, -781.7334591520613, -100.03730615131204, -75.00120352127233, -134.539700742375, -877.5065530076763, -584.1053638063393, -920.4963342599415, -109.86580473027746, -69.8726201801226, -588.0435977148658], "episode_lengths": [150, 150, 106, 94, 118, 150, 59, 140, 150, 39, 150, 150, 150, 71, 150, 150, 72, 150, 150, 66, 75, 42, 67, 150, 150, 150, 150, 150, 117, 150, 91, 150, 150, 56, 150, 62, 150, 150, 150, 150, 150, 150, 150, 146, 150, 128, 150, 122, 83, 150, 150, 150, 150, 150, 87, 94, 150, 143, 150, 110, 89, 150, 150, 137, 121, 134, 150, 150, 150, 98, 74, 60, 150, 150, 150, 56, 147, 150, 150, 150, 79, 150, 150, 62, 150, 150, 150, 150, 116, 51, 150, 141, 76, 88, 150, 150, 150, 81, 53, 150], "policy_policy_0_reward": [-700.4748868983253, -1084.0897635865845, -321.51434137322866, -195.5465944221866, -325.19609379228353, -1129.6310601726016, -59.42928048473903, -357.4432610034286, -346.77984820661237, -24.298344359739797, -676.7440287604815, -915.2846135375272, -970.6442894994324, -98.10604998770621, -644.2906285521632, -877.1807297340766, -148.57227251896725, -944.7257982960874, -968.9984934976261, -72.33062049810722, -105.86475371593784, -27.586735954738263, -142.9984969259732, -1214.0369553454714, -384.8101124092861, -899.1525913760751, -1099.093780984185, -680.5102050904986, -206.61277691813052, -1009.9806892243482, -154.51397296031348, -578.5256033455861, -733.2807865282525, -31.396504431835012, -535.8606651259556, -65.98420594854174, -817.7165578054905, -365.29096911498027, -752.896541820286, -731.228101589339, -1031.43250300031, -744.9887762320075, -1183.983647115621, -436.3761701985967, -580.0780028973512, -413.03103458547565, -1123.2495711725978, -531.7418529061772, -179.43982395945977, -730.8072032745398, -1221.660503290044, -1100.8814322876199, -611.2203030434928, -1240.013268915161, -179.28577931559212, -235.75402549258638, -1159.4519912778926, -733.6252631949992, -729.7407054351964, -318.986741226932, -167.28672421472717, -657.2229489010962, -1055.0575839945604, -449.1833544101962, -388.91314310870314, -404.351239277916, -1073.9694393082707, -735.5887641236094, -618.6782286505904, -300.8106755625286, -115.91610265212228, -59.57783230801226, -589.0772139924647, -1023.5400132275986, -975.4041224956371, -50.32370944426083, -247.06642776578897, -406.0615027761795, -1076.2439933437477, -350.4310342405701, -109.14496590217487, -396.64227339848117, -618.8271517086964, -83.67949976009879, -1038.806731261164, -160.68561056497168, -681.4707256463848, -604.9196553385995, -442.5543496041248, -40.25953963875575, -781.7334591520613, -100.03730615131204, -75.00120352127233, -134.539700742375, -877.5065530076763, -584.1053638063393, -920.4963342599415, -109.86580473027746, -69.8726201801226, -588.0435977148658]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5538574400341182, "mean_inference_ms": 1.6636063415866476, "mean_action_processing_ms": 0.2748801741074849, "mean_env_wait_ms": 3.3900569500262994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011691808700561523, "StateBufferConnector_ms": 0.00795888900756836, "ViewRequirementAgentConnector_ms": 0.19228124618530273}, "num_episodes": 29, "episode_return_max": -24.298344359739797, "episode_return_min": -1240.013268915161, "episode_return_mean": -550.4726710450707, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.0414805049587, "num_env_steps_trained_throughput_per_sec": 312.0414805049587, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12278.542, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12278.468, "sample_time_ms": 1107.454, "learn_time_ms": 11102.046, "learn_throughput": 360.294, "synch_weights_time_ms": 68.145}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "training_iteration": 25, "trial_id": "4b94b_00001", "date": "2024-08-05_12-05-36", "timestamp": 1722839736, "time_this_iter_s": 12.832976341247559, "time_total_s": 307.3082466125488, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd011b6d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 307.3082466125488, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 18.149999999999995, "ram_util_percent": 28.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 114.49969752629598, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.0665232826334734, "policy_loss": -0.01591804734877466, "vf_loss": 1.0780422538518906, "vf_explained_var": 0.992774652565519, "kl": 0.018273209184068658, "entropy": 1.0828868413344026, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "env_runners": {"episode_reward_max": -40.25953963875575, "episode_reward_min": -1266.4160013844603, "episode_reward_mean": -524.1114403559785, "episode_len_mean": 124.59, "episode_media": {}, "episodes_timesteps_total": 12459, "policy_reward_min": {"policy_0": -1266.4160013844603}, "policy_reward_max": {"policy_0": -40.25953963875575}, "policy_reward_mean": {"policy_0": -524.1114403559785}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-752.896541820286, -731.228101589339, -1031.43250300031, -744.9887762320075, -1183.983647115621, -436.3761701985967, -580.0780028973512, -413.03103458547565, -1123.2495711725978, -531.7418529061772, -179.43982395945977, -730.8072032745398, -1221.660503290044, -1100.8814322876199, -611.2203030434928, -1240.013268915161, -179.28577931559212, -235.75402549258638, -1159.4519912778926, -733.6252631949992, -729.7407054351964, -318.986741226932, -167.28672421472717, -657.2229489010962, -1055.0575839945604, -449.1833544101962, -388.91314310870314, -404.351239277916, -1073.9694393082707, -735.5887641236094, -618.6782286505904, -300.8106755625286, -115.91610265212228, -59.57783230801226, -589.0772139924647, -1023.5400132275986, -975.4041224956371, -50.32370944426083, -247.06642776578897, -406.0615027761795, -1076.2439933437477, -350.4310342405701, -109.14496590217487, -396.64227339848117, -618.8271517086964, -83.67949976009879, -1038.806731261164, -160.68561056497168, -681.4707256463848, -604.9196553385995, -442.5543496041248, -40.25953963875575, -781.7334591520613, -100.03730615131204, -75.00120352127233, -134.539700742375, -877.5065530076763, -584.1053638063393, -920.4963342599415, -109.86580473027746, -69.8726201801226, -588.0435977148658, -854.4292957521916, -259.83103232988344, -61.828997957001015, -487.29903509438793, -426.18029396722324, -964.4757835558436, -286.08284654062317, -1037.2404157507374, -100.6329266524246, -871.6540571591398, -1058.8102130448626, -591.1356917447961, -327.83206320704187, -751.3187159723051, -425.37031708866505, -70.35124036970005, -742.4239797242406, -547.3089070870941, -1096.5451070413742, -86.18056476314544, -454.6373657950172, -58.74257141975271, -551.8134178777668, -163.23082669326453, -69.93920876612371, -846.507067747566, -775.5713069217456, -279.0327585843493, -201.45590090233696, -1266.4160013844603, -198.702643761322, -142.20336551403176, -238.96974403094632, -85.95463808733223, -188.80877390756692, -96.77453026188924, -170.28374089609048, -442.3989461240538], "episode_lengths": [150, 150, 150, 150, 150, 146, 150, 128, 150, 122, 83, 150, 150, 150, 150, 150, 87, 94, 150, 143, 150, 110, 89, 150, 150, 137, 121, 134, 150, 150, 150, 98, 74, 60, 150, 150, 150, 56, 147, 150, 150, 150, 79, 150, 150, 62, 150, 150, 150, 150, 116, 51, 150, 141, 76, 88, 150, 150, 150, 81, 53, 150, 150, 106, 52, 150, 150, 150, 150, 150, 70, 150, 150, 150, 108, 149, 107, 65, 150, 150, 150, 67, 127, 57, 150, 100, 65, 150, 150, 139, 72, 150, 102, 88, 92, 70, 150, 60, 87, 150], "policy_policy_0_reward": [-752.896541820286, -731.228101589339, -1031.43250300031, -744.9887762320075, -1183.983647115621, -436.3761701985967, -580.0780028973512, -413.03103458547565, -1123.2495711725978, -531.7418529061772, -179.43982395945977, -730.8072032745398, -1221.660503290044, -1100.8814322876199, -611.2203030434928, -1240.013268915161, -179.28577931559212, -235.75402549258638, -1159.4519912778926, -733.6252631949992, -729.7407054351964, -318.986741226932, -167.28672421472717, -657.2229489010962, -1055.0575839945604, -449.1833544101962, -388.91314310870314, -404.351239277916, -1073.9694393082707, -735.5887641236094, -618.6782286505904, -300.8106755625286, -115.91610265212228, -59.57783230801226, -589.0772139924647, -1023.5400132275986, -975.4041224956371, -50.32370944426083, -247.06642776578897, -406.0615027761795, -1076.2439933437477, -350.4310342405701, -109.14496590217487, -396.64227339848117, -618.8271517086964, -83.67949976009879, -1038.806731261164, -160.68561056497168, -681.4707256463848, -604.9196553385995, -442.5543496041248, -40.25953963875575, -781.7334591520613, -100.03730615131204, -75.00120352127233, -134.539700742375, -877.5065530076763, -584.1053638063393, -920.4963342599415, -109.86580473027746, -69.8726201801226, -588.0435977148658, -854.4292957521916, -259.83103232988344, -61.828997957001015, -487.29903509438793, -426.18029396722324, -964.4757835558436, -286.08284654062317, -1037.2404157507374, -100.6329266524246, -871.6540571591398, -1058.8102130448626, -591.1356917447961, -327.83206320704187, -751.3187159723051, -425.37031708866505, -70.35124036970005, -742.4239797242406, -547.3089070870941, -1096.5451070413742, -86.18056476314544, -454.6373657950172, -58.74257141975271, -551.8134178777668, -163.23082669326453, -69.93920876612371, -846.507067747566, -775.5713069217456, -279.0327585843493, -201.45590090233696, -1266.4160013844603, -198.702643761322, -142.20336551403176, -238.96974403094632, -85.95463808733223, -188.80877390756692, -96.77453026188924, -170.28374089609048, -442.3989461240538]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5534913023507929, "mean_inference_ms": 1.66207099200305, "mean_action_processing_ms": 0.2743089690771677, "mean_env_wait_ms": 3.3872849495972956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011662721633911133, "StateBufferConnector_ms": 0.008064746856689453, "ViewRequirementAgentConnector_ms": 0.19802045822143555}, "num_episodes": 38, "episode_return_max": -40.25953963875575, "episode_return_min": -1266.4160013844603, "episode_return_mean": -524.1114403559785, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.0519913550603, "num_env_steps_trained_throughput_per_sec": 312.0519913550603, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 12300.776, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12300.703, "sample_time_ms": 1105.684, "learn_time_ms": 11125.623, "learn_throughput": 359.53, "synch_weights_time_ms": 68.562}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "training_iteration": 26, "trial_id": "4b94b_00001", "date": "2024-08-05_12-05-49", "timestamp": 1722839749, "time_this_iter_s": 12.830533981323242, "time_total_s": 320.13878059387207, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd011aa70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 320.13878059387207, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 18.033333333333335, "ram_util_percent": 28.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 138.36983036299546, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 0.9900062886998058, "policy_loss": -0.011808111901336816, "vf_loss": 0.9969445555781324, "vf_explained_var": 0.9951049440850814, "kl": 0.01958547799825586, "entropy": 1.0057966233541569, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "env_runners": {"episode_reward_max": -33.94717222305172, "episode_reward_min": -1266.4160013844603, "episode_reward_mean": -456.1100540338862, "episode_len_mean": 120.88, "episode_media": {}, "episodes_timesteps_total": 12088, "policy_reward_min": {"policy_0": -1266.4160013844603}, "policy_reward_max": {"policy_0": -33.94717222305172}, "policy_reward_mean": {"policy_0": -456.1100540338862}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-618.6782286505904, -300.8106755625286, -115.91610265212228, -59.57783230801226, -589.0772139924647, -1023.5400132275986, -975.4041224956371, -50.32370944426083, -247.06642776578897, -406.0615027761795, -1076.2439933437477, -350.4310342405701, -109.14496590217487, -396.64227339848117, -618.8271517086964, -83.67949976009879, -1038.806731261164, -160.68561056497168, -681.4707256463848, -604.9196553385995, -442.5543496041248, -40.25953963875575, -781.7334591520613, -100.03730615131204, -75.00120352127233, -134.539700742375, -877.5065530076763, -584.1053638063393, -920.4963342599415, -109.86580473027746, -69.8726201801226, -588.0435977148658, -854.4292957521916, -259.83103232988344, -61.828997957001015, -487.29903509438793, -426.18029396722324, -964.4757835558436, -286.08284654062317, -1037.2404157507374, -100.6329266524246, -871.6540571591398, -1058.8102130448626, -591.1356917447961, -327.83206320704187, -751.3187159723051, -425.37031708866505, -70.35124036970005, -742.4239797242406, -547.3089070870941, -1096.5451070413742, -86.18056476314544, -454.6373657950172, -58.74257141975271, -551.8134178777668, -163.23082669326453, -69.93920876612371, -846.507067747566, -775.5713069217456, -279.0327585843493, -201.45590090233696, -1266.4160013844603, -198.702643761322, -142.20336551403176, -238.96974403094632, -85.95463808733223, -188.80877390756692, -96.77453026188924, -170.28374089609048, -442.3989461240538, -118.63013606595456, -33.94717222305172, -291.73452448209264, -717.7365406607197, -601.4676158542229, -793.9945137049882, -509.9518272548978, -62.49184985931316, -882.3310083728351, -1139.3449427845342, -321.44344546069925, -493.8132250084573, -711.8421658218984, -686.2148352267835, -357.10547267457684, -178.24788601906783, -146.12045329614074, -926.1579759683748, -690.8041849501423, -956.2693444084697, -727.261464893201, -39.28332563748523, -126.26473383461598, -437.07540680841277, -277.70235731754735, -315.02558922798755, -68.17983553286163, -528.1948902034908, -406.6371474224247, -556.0339363858831], "episode_lengths": [150, 98, 74, 60, 150, 150, 150, 56, 147, 150, 150, 150, 79, 150, 150, 62, 150, 150, 150, 150, 116, 51, 150, 141, 76, 88, 150, 150, 150, 81, 53, 150, 150, 106, 52, 150, 150, 150, 150, 150, 70, 150, 150, 150, 108, 149, 107, 65, 150, 150, 150, 67, 127, 57, 150, 100, 65, 150, 150, 139, 72, 150, 102, 88, 92, 70, 150, 60, 87, 150, 53, 53, 148, 150, 150, 150, 144, 85, 150, 150, 150, 150, 150, 150, 119, 103, 92, 150, 150, 150, 150, 54, 75, 150, 75, 111, 66, 150, 145, 150], "policy_policy_0_reward": [-618.6782286505904, -300.8106755625286, -115.91610265212228, -59.57783230801226, -589.0772139924647, -1023.5400132275986, -975.4041224956371, -50.32370944426083, -247.06642776578897, -406.0615027761795, -1076.2439933437477, -350.4310342405701, -109.14496590217487, -396.64227339848117, -618.8271517086964, -83.67949976009879, -1038.806731261164, -160.68561056497168, -681.4707256463848, -604.9196553385995, -442.5543496041248, -40.25953963875575, -781.7334591520613, -100.03730615131204, -75.00120352127233, -134.539700742375, -877.5065530076763, -584.1053638063393, -920.4963342599415, -109.86580473027746, -69.8726201801226, -588.0435977148658, -854.4292957521916, -259.83103232988344, -61.828997957001015, -487.29903509438793, -426.18029396722324, -964.4757835558436, -286.08284654062317, -1037.2404157507374, -100.6329266524246, -871.6540571591398, -1058.8102130448626, -591.1356917447961, -327.83206320704187, -751.3187159723051, -425.37031708866505, -70.35124036970005, -742.4239797242406, -547.3089070870941, -1096.5451070413742, -86.18056476314544, -454.6373657950172, -58.74257141975271, -551.8134178777668, -163.23082669326453, -69.93920876612371, -846.507067747566, -775.5713069217456, -279.0327585843493, -201.45590090233696, -1266.4160013844603, -198.702643761322, -142.20336551403176, -238.96974403094632, -85.95463808733223, -188.80877390756692, -96.77453026188924, -170.28374089609048, -442.3989461240538, -118.63013606595456, -33.94717222305172, -291.73452448209264, -717.7365406607197, -601.4676158542229, -793.9945137049882, -509.9518272548978, -62.49184985931316, -882.3310083728351, -1139.3449427845342, -321.44344546069925, -493.8132250084573, -711.8421658218984, -686.2148352267835, -357.10547267457684, -178.24788601906783, -146.12045329614074, -926.1579759683748, -690.8041849501423, -956.2693444084697, -727.261464893201, -39.28332563748523, -126.26473383461598, -437.07540680841277, -277.70235731754735, -315.02558922798755, -68.17983553286163, -528.1948902034908, -406.6371474224247, -556.0339363858831]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5534102965428204, "mean_inference_ms": 1.6619074685284572, "mean_action_processing_ms": 0.27437545094181226, "mean_env_wait_ms": 3.3847039875093485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011651992797851562, "StateBufferConnector_ms": 0.007968425750732422, "ViewRequirementAgentConnector_ms": 0.19362878799438477}, "num_episodes": 30, "episode_return_max": -33.94717222305172, "episode_return_min": -1266.4160013844603, "episode_return_mean": -456.1100540338862, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.65502720003565, "num_env_steps_trained_throughput_per_sec": 311.65502720003565, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 12291.415, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12291.34, "sample_time_ms": 1112.465, "learn_time_ms": 11110.179, "learn_throughput": 360.03, "synch_weights_time_ms": 67.865}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "training_iteration": 27, "trial_id": "4b94b_00001", "date": "2024-08-05_12-06-02", "timestamp": 1722839762, "time_this_iter_s": 12.847706317901611, "time_total_s": 332.9864869117737, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd01b4f70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 332.9864869117737, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 17.842105263157894, "ram_util_percent": 28.710526315789473}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 118.94328044354916, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 0.9308783214228848, "policy_loss": -0.018008637619398846, "vf_loss": 0.9448030158566932, "vf_explained_var": 0.9951118929311633, "kl": 0.017356864455420406, "entropy": 1.123118466945986, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": -33.94717222305172, "episode_reward_min": -1293.0492171191206, "episode_reward_mean": -481.988217854295, "episode_len_mean": 122.1, "episode_media": {}, "episodes_timesteps_total": 12210, "policy_reward_min": {"policy_0": -1293.0492171191206}, "policy_reward_max": {"policy_0": -33.94717222305172}, "policy_reward_mean": {"policy_0": -481.988217854295}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-588.0435977148658, -854.4292957521916, -259.83103232988344, -61.828997957001015, -487.29903509438793, -426.18029396722324, -964.4757835558436, -286.08284654062317, -1037.2404157507374, -100.6329266524246, -871.6540571591398, -1058.8102130448626, -591.1356917447961, -327.83206320704187, -751.3187159723051, -425.37031708866505, -70.35124036970005, -742.4239797242406, -547.3089070870941, -1096.5451070413742, -86.18056476314544, -454.6373657950172, -58.74257141975271, -551.8134178777668, -163.23082669326453, -69.93920876612371, -846.507067747566, -775.5713069217456, -279.0327585843493, -201.45590090233696, -1266.4160013844603, -198.702643761322, -142.20336551403176, -238.96974403094632, -85.95463808733223, -188.80877390756692, -96.77453026188924, -170.28374089609048, -442.3989461240538, -118.63013606595456, -33.94717222305172, -291.73452448209264, -717.7365406607197, -601.4676158542229, -793.9945137049882, -509.9518272548978, -62.49184985931316, -882.3310083728351, -1139.3449427845342, -321.44344546069925, -493.8132250084573, -711.8421658218984, -686.2148352267835, -357.10547267457684, -178.24788601906783, -146.12045329614074, -926.1579759683748, -690.8041849501423, -956.2693444084697, -727.261464893201, -39.28332563748523, -126.26473383461598, -437.07540680841277, -277.70235731754735, -315.02558922798755, -68.17983553286163, -528.1948902034908, -406.6371474224247, -556.0339363858831, -702.596951134421, -155.68720861336712, -642.742907982138, -255.85374095000262, -95.23650643098986, -1077.1449109001394, -625.0795748588752, -61.434672598838, -362.1395008657944, -698.7502990711057, -813.9026960530301, -426.7658745337067, -1293.0492171191206, -654.1011939133944, -166.31065132605778, -193.29838230129752, -243.91782136101259, -124.56629066350214, -423.9674166405376, -78.85767609648448, -245.83988400464983, -820.3072394464889, -928.3240753774975, -619.9544525567895, -297.0387511234583, -1041.8369732832364, -161.82182275608096, -349.7762757158719, -1234.0793632741734, -812.8320562423507, -623.881699680788], "episode_lengths": [150, 150, 106, 52, 150, 150, 150, 150, 150, 70, 150, 150, 150, 108, 149, 107, 65, 150, 150, 150, 67, 127, 57, 150, 100, 65, 150, 150, 139, 72, 150, 102, 88, 92, 70, 150, 60, 87, 150, 53, 53, 148, 150, 150, 150, 144, 85, 150, 150, 150, 150, 150, 150, 119, 103, 92, 150, 150, 150, 150, 54, 75, 150, 75, 111, 66, 150, 145, 150, 150, 80, 135, 83, 72, 150, 150, 53, 146, 150, 150, 146, 150, 150, 150, 92, 76, 87, 150, 65, 92, 150, 150, 150, 99, 150, 78, 150, 150, 150, 150], "policy_policy_0_reward": [-588.0435977148658, -854.4292957521916, -259.83103232988344, -61.828997957001015, -487.29903509438793, -426.18029396722324, -964.4757835558436, -286.08284654062317, -1037.2404157507374, -100.6329266524246, -871.6540571591398, -1058.8102130448626, -591.1356917447961, -327.83206320704187, -751.3187159723051, -425.37031708866505, -70.35124036970005, -742.4239797242406, -547.3089070870941, -1096.5451070413742, -86.18056476314544, -454.6373657950172, -58.74257141975271, -551.8134178777668, -163.23082669326453, -69.93920876612371, -846.507067747566, -775.5713069217456, -279.0327585843493, -201.45590090233696, -1266.4160013844603, -198.702643761322, -142.20336551403176, -238.96974403094632, -85.95463808733223, -188.80877390756692, -96.77453026188924, -170.28374089609048, -442.3989461240538, -118.63013606595456, -33.94717222305172, -291.73452448209264, -717.7365406607197, -601.4676158542229, -793.9945137049882, -509.9518272548978, -62.49184985931316, -882.3310083728351, -1139.3449427845342, -321.44344546069925, -493.8132250084573, -711.8421658218984, -686.2148352267835, -357.10547267457684, -178.24788601906783, -146.12045329614074, -926.1579759683748, -690.8041849501423, -956.2693444084697, -727.261464893201, -39.28332563748523, -126.26473383461598, -437.07540680841277, -277.70235731754735, -315.02558922798755, -68.17983553286163, -528.1948902034908, -406.6371474224247, -556.0339363858831, -702.596951134421, -155.68720861336712, -642.742907982138, -255.85374095000262, -95.23650643098986, -1077.1449109001394, -625.0795748588752, -61.434672598838, -362.1395008657944, -698.7502990711057, -813.9026960530301, -426.7658745337067, -1293.0492171191206, -654.1011939133944, -166.31065132605778, -193.29838230129752, -243.91782136101259, -124.56629066350214, -423.9674166405376, -78.85767609648448, -245.83988400464983, -820.3072394464889, -928.3240753774975, -619.9544525567895, -297.0387511234583, -1041.8369732832364, -161.82182275608096, -349.7762757158719, -1234.0793632741734, -812.8320562423507, -623.881699680788]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5531194374349859, "mean_inference_ms": 1.6622668007345487, "mean_action_processing_ms": 0.2743769529450029, "mean_env_wait_ms": 3.3851866216257465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011705160140991211, "StateBufferConnector_ms": 0.00858616828918457, "ViewRequirementAgentConnector_ms": 0.19271039962768555}, "num_episodes": 31, "episode_return_max": -33.94717222305172, "episode_return_min": -1293.0492171191206, "episode_return_mean": -481.988217854295, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.0081057365343, "num_env_steps_trained_throughput_per_sec": 313.0081057365343, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 12458.84, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12458.766, "sample_time_ms": 1136.777, "learn_time_ms": 11254.359, "learn_throughput": 355.418, "synch_weights_time_ms": 66.81}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 28, "trial_id": "4b94b_00001", "date": "2024-08-05_12-06-15", "timestamp": 1722839775, "time_this_iter_s": 12.792527437210083, "time_total_s": 345.77901434898376, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd011b6d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 345.77901434898376, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 17.549999999999997, "ram_util_percent": 28.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 126.80329857269923, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 0.8956973935011774, "policy_loss": -0.017244232490096087, "vf_loss": 0.9087165439811845, "vf_explained_var": 0.9954701407502095, "kl": 0.01806712192968312, "entropy": 1.1950561875477432, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "env_runners": {"episode_reward_max": -23.80563333241723, "episode_reward_min": -1309.1324612074789, "episode_reward_mean": -507.0292786649742, "episode_len_mean": 122.29, "episode_media": {}, "episodes_timesteps_total": 12229, "policy_reward_min": {"policy_0": -1309.1324612074789}, "policy_reward_max": {"policy_0": -23.80563333241723}, "policy_reward_mean": {"policy_0": -507.0292786649742}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-238.96974403094632, -85.95463808733223, -188.80877390756692, -96.77453026188924, -170.28374089609048, -442.3989461240538, -118.63013606595456, -33.94717222305172, -291.73452448209264, -717.7365406607197, -601.4676158542229, -793.9945137049882, -509.9518272548978, -62.49184985931316, -882.3310083728351, -1139.3449427845342, -321.44344546069925, -493.8132250084573, -711.8421658218984, -686.2148352267835, -357.10547267457684, -178.24788601906783, -146.12045329614074, -926.1579759683748, -690.8041849501423, -956.2693444084697, -727.261464893201, -39.28332563748523, -126.26473383461598, -437.07540680841277, -277.70235731754735, -315.02558922798755, -68.17983553286163, -528.1948902034908, -406.6371474224247, -556.0339363858831, -702.596951134421, -155.68720861336712, -642.742907982138, -255.85374095000262, -95.23650643098986, -1077.1449109001394, -625.0795748588752, -61.434672598838, -362.1395008657944, -698.7502990711057, -813.9026960530301, -426.7658745337067, -1293.0492171191206, -654.1011939133944, -166.31065132605778, -193.29838230129752, -243.91782136101259, -124.56629066350214, -423.9674166405376, -78.85767609648448, -245.83988400464983, -820.3072394464889, -928.3240753774975, -619.9544525567895, -297.0387511234583, -1041.8369732832364, -161.82182275608096, -349.7762757158719, -1234.0793632741734, -812.8320562423507, -623.881699680788, -700.6504941124203, -52.55824239591296, -1135.232261412606, -947.9283826197446, -94.05765647764318, -978.63922980879, -629.7710392820674, -1146.7900363424744, -479.67924306831964, -514.5245304057285, -126.08955338090811, -23.80563333241723, -700.2643773731501, -132.4586112034817, -358.89415715798793, -1035.765048231496, -611.2648557997281, -1309.1324612074789, -940.0524524180564, -146.45798443255168, -246.84296906050838, -1071.3135007848825, -871.3898804725487, -153.8011754006998, -791.327054582291, -670.6619905553331, -119.41429522006379, -388.7684190966392, -845.7973142883442, -109.56855780591756, -472.7668997272821, -85.22342055778314, -1256.4418709379465], "episode_lengths": [92, 70, 150, 60, 87, 150, 53, 53, 148, 150, 150, 150, 144, 85, 150, 150, 150, 150, 150, 150, 119, 103, 92, 150, 150, 150, 150, 54, 75, 150, 75, 111, 66, 150, 145, 150, 150, 80, 135, 83, 72, 150, 150, 53, 146, 150, 150, 146, 150, 150, 150, 92, 76, 87, 150, 65, 92, 150, 150, 150, 99, 150, 78, 150, 150, 150, 150, 150, 51, 150, 150, 68, 150, 150, 150, 150, 142, 74, 39, 150, 72, 119, 150, 150, 150, 150, 81, 110, 150, 150, 55, 150, 150, 123, 132, 150, 71, 150, 56, 150], "policy_policy_0_reward": [-238.96974403094632, -85.95463808733223, -188.80877390756692, -96.77453026188924, -170.28374089609048, -442.3989461240538, -118.63013606595456, -33.94717222305172, -291.73452448209264, -717.7365406607197, -601.4676158542229, -793.9945137049882, -509.9518272548978, -62.49184985931316, -882.3310083728351, -1139.3449427845342, -321.44344546069925, -493.8132250084573, -711.8421658218984, -686.2148352267835, -357.10547267457684, -178.24788601906783, -146.12045329614074, -926.1579759683748, -690.8041849501423, -956.2693444084697, -727.261464893201, -39.28332563748523, -126.26473383461598, -437.07540680841277, -277.70235731754735, -315.02558922798755, -68.17983553286163, -528.1948902034908, -406.6371474224247, -556.0339363858831, -702.596951134421, -155.68720861336712, -642.742907982138, -255.85374095000262, -95.23650643098986, -1077.1449109001394, -625.0795748588752, -61.434672598838, -362.1395008657944, -698.7502990711057, -813.9026960530301, -426.7658745337067, -1293.0492171191206, -654.1011939133944, -166.31065132605778, -193.29838230129752, -243.91782136101259, -124.56629066350214, -423.9674166405376, -78.85767609648448, -245.83988400464983, -820.3072394464889, -928.3240753774975, -619.9544525567895, -297.0387511234583, -1041.8369732832364, -161.82182275608096, -349.7762757158719, -1234.0793632741734, -812.8320562423507, -623.881699680788, -700.6504941124203, -52.55824239591296, -1135.232261412606, -947.9283826197446, -94.05765647764318, -978.63922980879, -629.7710392820674, -1146.7900363424744, -479.67924306831964, -514.5245304057285, -126.08955338090811, -23.80563333241723, -700.2643773731501, -132.4586112034817, -358.89415715798793, -1035.765048231496, -611.2648557997281, -1309.1324612074789, -940.0524524180564, -146.45798443255168, -246.84296906050838, -1071.3135007848825, -871.3898804725487, -153.8011754006998, -791.327054582291, -670.6619905553331, -119.41429522006379, -388.7684190966392, -845.7973142883442, -109.56855780591756, -472.7668997272821, -85.22342055778314, -1256.4418709379465]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5531817967190148, "mean_inference_ms": 1.6626882225117372, "mean_action_processing_ms": 0.2741235609941808, "mean_env_wait_ms": 3.3851144589373683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011549234390258789, "StateBufferConnector_ms": 0.008567571640014648, "ViewRequirementAgentConnector_ms": 0.18932867050170898}, "num_episodes": 33, "episode_return_max": -23.80563333241723, "episode_return_min": -1309.1324612074789, "episode_return_mean": -507.0292786649742, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.30336942157663, "num_env_steps_trained_throughput_per_sec": 326.30336942157663, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 12401.62, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12401.544, "sample_time_ms": 1135.826, "learn_time_ms": 11198.14, "learn_throughput": 357.202, "synch_weights_time_ms": 66.757}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "training_iteration": 29, "trial_id": "4b94b_00001", "date": "2024-08-05_12-06-27", "timestamp": 1722839787, "time_this_iter_s": 12.271183729171753, "time_total_s": 358.0501980781555, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd011aa70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 358.0501980781555, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 18.63529411764706, "ram_util_percent": 28.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 118.0816412637631, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 0.9663692554769416, "policy_loss": -0.017325004919742544, "vf_loss": 0.9791144165831308, "vf_explained_var": 0.9982928848514955, "kl": 0.018606646081480015, "entropy": 1.0021484250202775, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": -23.80563333241723, "episode_reward_min": -1451.3301179201887, "episode_reward_mean": -509.85173689839866, "episode_len_mean": 116.64, "episode_media": {}, "episodes_timesteps_total": 11664, "policy_reward_min": {"policy_0": -1451.3301179201887}, "policy_reward_max": {"policy_0": -23.80563333241723}, "policy_reward_mean": {"policy_0": -509.85173689839866}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155.68720861336712, -642.742907982138, -255.85374095000262, -95.23650643098986, -1077.1449109001394, -625.0795748588752, -61.434672598838, -362.1395008657944, -698.7502990711057, -813.9026960530301, -426.7658745337067, -1293.0492171191206, -654.1011939133944, -166.31065132605778, -193.29838230129752, -243.91782136101259, -124.56629066350214, -423.9674166405376, -78.85767609648448, -245.83988400464983, -820.3072394464889, -928.3240753774975, -619.9544525567895, -297.0387511234583, -1041.8369732832364, -161.82182275608096, -349.7762757158719, -1234.0793632741734, -812.8320562423507, -623.881699680788, -700.6504941124203, -52.55824239591296, -1135.232261412606, -947.9283826197446, -94.05765647764318, -978.63922980879, -629.7710392820674, -1146.7900363424744, -479.67924306831964, -514.5245304057285, -126.08955338090811, -23.80563333241723, -700.2643773731501, -132.4586112034817, -358.89415715798793, -1035.765048231496, -611.2648557997281, -1309.1324612074789, -940.0524524180564, -146.45798443255168, -246.84296906050838, -1071.3135007848825, -871.3898804725487, -153.8011754006998, -791.327054582291, -670.6619905553331, -119.41429522006379, -388.7684190966392, -845.7973142883442, -109.56855780591756, -472.7668997272821, -85.22342055778314, -1256.4418709379465, -1412.9141075663404, -126.69290179407876, -689.250549381733, -1451.3301179201887, -52.85607338326906, -82.33006042398304, -340.4274896575472, -358.1487376626031, -26.762083529072154, -77.75283896227513, -80.19709218179395, -622.1191233467513, -904.4202841800594, -56.75649132784394, -249.3284120549306, -200.6665674719614, -666.2098600011558, -89.21255304313642, -540.5940986063956, -50.895234799004776, -1026.9807302989602, -1057.2242690580897, -1006.7749046702016, -542.3713750724436, -107.09977759560336, -25.45179840285769, -859.2551542992218, -75.77885901276646, -367.75968504103224, -930.2820700461249, -130.25334163143788, -168.50233682475346, -71.34937056401311, -792.2437974643693, -76.81115453903777, -753.3659743099623, -238.97167902089313], "episode_lengths": [80, 135, 83, 72, 150, 150, 53, 146, 150, 150, 146, 150, 150, 150, 92, 76, 87, 150, 65, 92, 150, 150, 150, 99, 150, 78, 150, 150, 150, 150, 150, 51, 150, 150, 68, 150, 150, 150, 150, 142, 74, 39, 150, 72, 119, 150, 150, 150, 150, 81, 110, 150, 150, 55, 150, 150, 123, 132, 150, 71, 150, 56, 150, 150, 69, 150, 150, 58, 61, 116, 109, 45, 67, 54, 150, 150, 65, 98, 102, 150, 78, 150, 61, 150, 150, 150, 150, 59, 50, 150, 67, 110, 150, 68, 85, 66, 150, 64, 150, 115], "policy_policy_0_reward": [-155.68720861336712, -642.742907982138, -255.85374095000262, -95.23650643098986, -1077.1449109001394, -625.0795748588752, -61.434672598838, -362.1395008657944, -698.7502990711057, -813.9026960530301, -426.7658745337067, -1293.0492171191206, -654.1011939133944, -166.31065132605778, -193.29838230129752, -243.91782136101259, -124.56629066350214, -423.9674166405376, -78.85767609648448, -245.83988400464983, -820.3072394464889, -928.3240753774975, -619.9544525567895, -297.0387511234583, -1041.8369732832364, -161.82182275608096, -349.7762757158719, -1234.0793632741734, -812.8320562423507, -623.881699680788, -700.6504941124203, -52.55824239591296, -1135.232261412606, -947.9283826197446, -94.05765647764318, -978.63922980879, -629.7710392820674, -1146.7900363424744, -479.67924306831964, -514.5245304057285, -126.08955338090811, -23.80563333241723, -700.2643773731501, -132.4586112034817, -358.89415715798793, -1035.765048231496, -611.2648557997281, -1309.1324612074789, -940.0524524180564, -146.45798443255168, -246.84296906050838, -1071.3135007848825, -871.3898804725487, -153.8011754006998, -791.327054582291, -670.6619905553331, -119.41429522006379, -388.7684190966392, -845.7973142883442, -109.56855780591756, -472.7668997272821, -85.22342055778314, -1256.4418709379465, -1412.9141075663404, -126.69290179407876, -689.250549381733, -1451.3301179201887, -52.85607338326906, -82.33006042398304, -340.4274896575472, -358.1487376626031, -26.762083529072154, -77.75283896227513, -80.19709218179395, -622.1191233467513, -904.4202841800594, -56.75649132784394, -249.3284120549306, -200.6665674719614, -666.2098600011558, -89.21255304313642, -540.5940986063956, -50.895234799004776, -1026.9807302989602, -1057.2242690580897, -1006.7749046702016, -542.3713750724436, -107.09977759560336, -25.45179840285769, -859.2551542992218, -75.77885901276646, -367.75968504103224, -930.2820700461249, -130.25334163143788, -168.50233682475346, -71.34937056401311, -792.2437974643693, -76.81115453903777, -753.3659743099623, -238.97167902089313]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5530955190837272, "mean_inference_ms": 1.6644214385908886, "mean_action_processing_ms": 0.27414464612034267, "mean_env_wait_ms": 3.3895455148945333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011684894561767578, "StateBufferConnector_ms": 0.008597135543823242, "ViewRequirementAgentConnector_ms": 0.19100046157836914}, "num_episodes": 37, "episode_return_max": -23.80563333241723, "episode_return_min": -1451.3301179201887, "episode_return_mean": -509.85173689839866, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 344.23646280403324, "num_env_steps_trained_throughput_per_sec": 344.23646280403324, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 12378.656, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12378.578, "sample_time_ms": 1135.631, "learn_time_ms": 11176.188, "learn_throughput": 357.904, "synch_weights_time_ms": 65.934}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 30, "trial_id": "4b94b_00001", "date": "2024-08-05_12-06-39", "timestamp": 1722839799, "time_this_iter_s": 11.632040977478027, "time_total_s": 369.68223905563354, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd011bbe0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 369.68223905563354, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 18.623529411764707, "ram_util_percent": 28.71764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 116.5557371844848, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.0151017444208263, "policy_loss": -0.01901989904581569, "vf_loss": 1.0298869194773337, "vf_explained_var": 0.9962200223157803, "kl": 0.018121951729638888, "entropy": 1.2018648962179819, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "env_runners": {"episode_reward_max": -5.86977501716266, "episode_reward_min": -1451.3301179201887, "episode_reward_mean": -461.1078166422071, "episode_len_mean": 113.19, "episode_media": {}, "episodes_timesteps_total": 11319, "policy_reward_min": {"policy_0": -1451.3301179201887}, "policy_reward_max": {"policy_0": -5.86977501716266}, "policy_reward_mean": {"policy_0": -461.1078166422071}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1146.7900363424744, -479.67924306831964, -514.5245304057285, -126.08955338090811, -23.80563333241723, -700.2643773731501, -132.4586112034817, -358.89415715798793, -1035.765048231496, -611.2648557997281, -1309.1324612074789, -940.0524524180564, -146.45798443255168, -246.84296906050838, -1071.3135007848825, -871.3898804725487, -153.8011754006998, -791.327054582291, -670.6619905553331, -119.41429522006379, -388.7684190966392, -845.7973142883442, -109.56855780591756, -472.7668997272821, -85.22342055778314, -1256.4418709379465, -1412.9141075663404, -126.69290179407876, -689.250549381733, -1451.3301179201887, -52.85607338326906, -82.33006042398304, -340.4274896575472, -358.1487376626031, -26.762083529072154, -77.75283896227513, -80.19709218179395, -622.1191233467513, -904.4202841800594, -56.75649132784394, -249.3284120549306, -200.6665674719614, -666.2098600011558, -89.21255304313642, -540.5940986063956, -50.895234799004776, -1026.9807302989602, -1057.2242690580897, -1006.7749046702016, -542.3713750724436, -107.09977759560336, -25.45179840285769, -859.2551542992218, -75.77885901276646, -367.75968504103224, -930.2820700461249, -130.25334163143788, -168.50233682475346, -71.34937056401311, -792.2437974643693, -76.81115453903777, -753.3659743099623, -238.97167902089313, -742.15195268768, -1165.7640894837102, -230.96438649091755, -1121.4251036767814, -1120.8396664290838, -421.0850196652813, -654.2746462914672, -181.52774006485237, -313.4788011248269, -737.2284266164384, -714.6457408901159, -278.4952571131471, -86.85833066063934, -1030.3517538926467, -112.20359895264605, -68.92798897668253, -85.41037303222039, -291.4948556576628, -113.56302211765258, -318.92322526436504, -537.4795624895866, -627.8474738463945, -265.08617697124566, -137.29686664046423, -694.0111316865682, -445.9930570403746, -234.1051454436085, -708.6907967772814, -225.19756070269776, -67.70211079547471, -183.77532602930117, -7.22425954703118, -5.86977501716266, -242.2500136777159, -121.96778023507092, -61.45676559915227, -837.376634642856], "episode_lengths": [150, 150, 142, 74, 39, 150, 72, 119, 150, 150, 150, 150, 81, 110, 150, 150, 55, 150, 150, 123, 132, 150, 71, 150, 56, 150, 150, 69, 150, 150, 58, 61, 116, 109, 45, 67, 54, 150, 150, 65, 98, 102, 150, 78, 150, 61, 150, 150, 150, 150, 59, 50, 150, 67, 110, 150, 68, 85, 66, 150, 64, 150, 115, 150, 150, 103, 150, 150, 150, 150, 74, 127, 150, 150, 111, 66, 150, 75, 63, 67, 150, 85, 127, 150, 150, 113, 81, 150, 148, 150, 150, 150, 63, 96, 33, 39, 111, 46, 50, 150], "policy_policy_0_reward": [-1146.7900363424744, -479.67924306831964, -514.5245304057285, -126.08955338090811, -23.80563333241723, -700.2643773731501, -132.4586112034817, -358.89415715798793, -1035.765048231496, -611.2648557997281, -1309.1324612074789, -940.0524524180564, -146.45798443255168, -246.84296906050838, -1071.3135007848825, -871.3898804725487, -153.8011754006998, -791.327054582291, -670.6619905553331, -119.41429522006379, -388.7684190966392, -845.7973142883442, -109.56855780591756, -472.7668997272821, -85.22342055778314, -1256.4418709379465, -1412.9141075663404, -126.69290179407876, -689.250549381733, -1451.3301179201887, -52.85607338326906, -82.33006042398304, -340.4274896575472, -358.1487376626031, -26.762083529072154, -77.75283896227513, -80.19709218179395, -622.1191233467513, -904.4202841800594, -56.75649132784394, -249.3284120549306, -200.6665674719614, -666.2098600011558, -89.21255304313642, -540.5940986063956, -50.895234799004776, -1026.9807302989602, -1057.2242690580897, -1006.7749046702016, -542.3713750724436, -107.09977759560336, -25.45179840285769, -859.2551542992218, -75.77885901276646, -367.75968504103224, -930.2820700461249, -130.25334163143788, -168.50233682475346, -71.34937056401311, -792.2437974643693, -76.81115453903777, -753.3659743099623, -238.97167902089313, -742.15195268768, -1165.7640894837102, -230.96438649091755, -1121.4251036767814, -1120.8396664290838, -421.0850196652813, -654.2746462914672, -181.52774006485237, -313.4788011248269, -737.2284266164384, -714.6457408901159, -278.4952571131471, -86.85833066063934, -1030.3517538926467, -112.20359895264605, -68.92798897668253, -85.41037303222039, -291.4948556576628, -113.56302211765258, -318.92322526436504, -537.4795624895866, -627.8474738463945, -265.08617697124566, -137.29686664046423, -694.0111316865682, -445.9930570403746, -234.1051454436085, -708.6907967772814, -225.19756070269776, -67.70211079547471, -183.77532602930117, -7.22425954703118, -5.86977501716266, -242.2500136777159, -121.96778023507092, -61.45676559915227, -837.376634642856]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5532987289976683, "mean_inference_ms": 1.6898117338018834, "mean_action_processing_ms": 0.27399038136373255, "mean_env_wait_ms": 3.388458936436532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012155771255493164, "StateBufferConnector_ms": 0.007993221282958984, "ViewRequirementAgentConnector_ms": 0.1919710636138916}, "num_episodes": 37, "episode_return_max": -5.86977501716266, "episode_return_min": -1451.3301179201887, "episode_return_mean": -461.1078166422071, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.62286321283466, "num_env_steps_trained_throughput_per_sec": 319.62286321283466, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 12340.627, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12340.549, "sample_time_ms": 1177.397, "learn_time_ms": 11095.424, "learn_throughput": 360.509, "synch_weights_time_ms": 66.89}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "training_iteration": 31, "trial_id": "4b94b_00001", "date": "2024-08-05_12-06-51", "timestamp": 1722839811, "time_this_iter_s": 12.529411792755127, "time_total_s": 382.2116508483887, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd011a320>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 382.2116508483887, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 20.611111111111114, "ram_util_percent": 28.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 108.43331203858058, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.125938095152378, "policy_loss": -0.020617880784266164, "vf_loss": 1.1416592227295042, "vf_explained_var": 0.997568917957445, "kl": 0.020424062742586103, "entropy": 1.2304681979119778, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 2.578890780581683, "episode_reward_min": -1285.4578224033803, "episode_reward_mean": -440.25514651072086, "episode_len_mean": 114.74, "episode_media": {}, "episodes_timesteps_total": 11474, "policy_reward_min": {"policy_0": -1285.4578224033803}, "policy_reward_max": {"policy_0": 2.578890780581683}, "policy_reward_mean": {"policy_0": -440.25514651072086}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-80.19709218179395, -622.1191233467513, -904.4202841800594, -56.75649132784394, -249.3284120549306, -200.6665674719614, -666.2098600011558, -89.21255304313642, -540.5940986063956, -50.895234799004776, -1026.9807302989602, -1057.2242690580897, -1006.7749046702016, -542.3713750724436, -107.09977759560336, -25.45179840285769, -859.2551542992218, -75.77885901276646, -367.75968504103224, -930.2820700461249, -130.25334163143788, -168.50233682475346, -71.34937056401311, -792.2437974643693, -76.81115453903777, -753.3659743099623, -238.97167902089313, -742.15195268768, -1165.7640894837102, -230.96438649091755, -1121.4251036767814, -1120.8396664290838, -421.0850196652813, -654.2746462914672, -181.52774006485237, -313.4788011248269, -737.2284266164384, -714.6457408901159, -278.4952571131471, -86.85833066063934, -1030.3517538926467, -112.20359895264605, -68.92798897668253, -85.41037303222039, -291.4948556576628, -113.56302211765258, -318.92322526436504, -537.4795624895866, -627.8474738463945, -265.08617697124566, -137.29686664046423, -694.0111316865682, -445.9930570403746, -234.1051454436085, -708.6907967772814, -225.19756070269776, -67.70211079547471, -183.77532602930117, -7.22425954703118, -5.86977501716266, -242.2500136777159, -121.96778023507092, -61.45676559915227, -837.376634642856, -744.0830214061898, -1285.4578224033803, -61.371157196830254, -290.7703525385958, -994.2416065523812, -887.7006069108361, -45.06301825187948, -262.62595103335434, -1123.033852619197, -243.32419232388182, -707.9303280842657, -344.2120084753189, -1249.307317845238, -1251.5524350763592, -406.9416133439061, -444.44665958663705, -51.76182194878151, -401.1753782996643, -1133.1560325857868, -379.4642553986445, -464.4790200432717, -38.88403075461329, -618.4230489728526, -270.4937862819001, -798.9416048051744, -92.23727600581769, -133.55828633552494, -246.36369813445333, -307.38709847122317, -358.33386866556435, -346.05978491516004, -51.15774961439011, -141.6882893191297, 2.578890780581683, -618.0513666859059, -350.5947898709543], "episode_lengths": [54, 150, 150, 65, 98, 102, 150, 78, 150, 61, 150, 150, 150, 150, 59, 50, 150, 67, 110, 150, 68, 85, 66, 150, 64, 150, 115, 150, 150, 103, 150, 150, 150, 150, 74, 127, 150, 150, 111, 66, 150, 75, 63, 67, 150, 85, 127, 150, 150, 113, 81, 150, 148, 150, 150, 150, 63, 96, 33, 39, 111, 46, 50, 150, 150, 150, 55, 150, 150, 150, 52, 82, 150, 104, 150, 150, 150, 150, 150, 150, 56, 150, 150, 139, 150, 57, 150, 89, 150, 77, 91, 125, 150, 133, 111, 55, 71, 29, 150, 128], "policy_policy_0_reward": [-80.19709218179395, -622.1191233467513, -904.4202841800594, -56.75649132784394, -249.3284120549306, -200.6665674719614, -666.2098600011558, -89.21255304313642, -540.5940986063956, -50.895234799004776, -1026.9807302989602, -1057.2242690580897, -1006.7749046702016, -542.3713750724436, -107.09977759560336, -25.45179840285769, -859.2551542992218, -75.77885901276646, -367.75968504103224, -930.2820700461249, -130.25334163143788, -168.50233682475346, -71.34937056401311, -792.2437974643693, -76.81115453903777, -753.3659743099623, -238.97167902089313, -742.15195268768, -1165.7640894837102, -230.96438649091755, -1121.4251036767814, -1120.8396664290838, -421.0850196652813, -654.2746462914672, -181.52774006485237, -313.4788011248269, -737.2284266164384, -714.6457408901159, -278.4952571131471, -86.85833066063934, -1030.3517538926467, -112.20359895264605, -68.92798897668253, -85.41037303222039, -291.4948556576628, -113.56302211765258, -318.92322526436504, -537.4795624895866, -627.8474738463945, -265.08617697124566, -137.29686664046423, -694.0111316865682, -445.9930570403746, -234.1051454436085, -708.6907967772814, -225.19756070269776, -67.70211079547471, -183.77532602930117, -7.22425954703118, -5.86977501716266, -242.2500136777159, -121.96778023507092, -61.45676559915227, -837.376634642856, -744.0830214061898, -1285.4578224033803, -61.371157196830254, -290.7703525385958, -994.2416065523812, -887.7006069108361, -45.06301825187948, -262.62595103335434, -1123.033852619197, -243.32419232388182, -707.9303280842657, -344.2120084753189, -1249.307317845238, -1251.5524350763592, -406.9416133439061, -444.44665958663705, -51.76182194878151, -401.1753782996643, -1133.1560325857868, -379.4642553986445, -464.4790200432717, -38.88403075461329, -618.4230489728526, -270.4937862819001, -798.9416048051744, -92.23727600581769, -133.55828633552494, -246.36369813445333, -307.38709847122317, -358.33386866556435, -346.05978491516004, -51.15774961439011, -141.6882893191297, 2.578890780581683, -618.0513666859059, -350.5947898709543]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5535334327232344, "mean_inference_ms": 1.7140494740311067, "mean_action_processing_ms": 0.27403553129288044, "mean_env_wait_ms": 3.389787643221114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012441158294677734, "StateBufferConnector_ms": 0.008009672164916992, "ViewRequirementAgentConnector_ms": 0.19351506233215332}, "num_episodes": 36, "episode_return_max": 2.578890780581683, "episode_return_min": -1285.4578224033803, "episode_return_mean": -440.25514651072086, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.9675952445694, "num_env_steps_trained_throughput_per_sec": 305.9675952445694, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 12544.32, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12544.243, "sample_time_ms": 1191.362, "learn_time_ms": 11284.945, "learn_throughput": 354.455, "synch_weights_time_ms": 67.065}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 32, "trial_id": "4b94b_00001", "date": "2024-08-05_12-07-04", "timestamp": 1722839824, "time_this_iter_s": 13.08475947380066, "time_total_s": 395.29641032218933, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd011b250>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 395.29641032218933, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 18.21666666666667, "ram_util_percent": 28.716666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 148.10333308180174, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.8960399472775559, "policy_loss": -0.016305954246490728, "vf_loss": 0.9057516448820631, "vf_explained_var": 0.9978350294753909, "kl": 0.017203550854901575, "entropy": 1.1473398814598719, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "env_runners": {"episode_reward_max": 2.578890780581683, "episode_reward_min": -1421.5234252554503, "episode_reward_mean": -451.1082505140875, "episode_len_mean": 116.43, "episode_media": {}, "episodes_timesteps_total": 11643, "policy_reward_min": {"policy_0": -1421.5234252554503}, "policy_reward_max": {"policy_0": 2.578890780581683}, "policy_reward_mean": {"policy_0": -451.1082505140875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1120.8396664290838, -421.0850196652813, -654.2746462914672, -181.52774006485237, -313.4788011248269, -737.2284266164384, -714.6457408901159, -278.4952571131471, -86.85833066063934, -1030.3517538926467, -112.20359895264605, -68.92798897668253, -85.41037303222039, -291.4948556576628, -113.56302211765258, -318.92322526436504, -537.4795624895866, -627.8474738463945, -265.08617697124566, -137.29686664046423, -694.0111316865682, -445.9930570403746, -234.1051454436085, -708.6907967772814, -225.19756070269776, -67.70211079547471, -183.77532602930117, -7.22425954703118, -5.86977501716266, -242.2500136777159, -121.96778023507092, -61.45676559915227, -837.376634642856, -744.0830214061898, -1285.4578224033803, -61.371157196830254, -290.7703525385958, -994.2416065523812, -887.7006069108361, -45.06301825187948, -262.62595103335434, -1123.033852619197, -243.32419232388182, -707.9303280842657, -344.2120084753189, -1249.307317845238, -1251.5524350763592, -406.9416133439061, -444.44665958663705, -51.76182194878151, -401.1753782996643, -1133.1560325857868, -379.4642553986445, -464.4790200432717, -38.88403075461329, -618.4230489728526, -270.4937862819001, -798.9416048051744, -92.23727600581769, -133.55828633552494, -246.36369813445333, -307.38709847122317, -358.33386866556435, -346.05978491516004, -51.15774961439011, -141.6882893191297, 2.578890780581683, -618.0513666859059, -350.5947898709543, -1038.7848172690283, -65.69884895776379, -164.30092691783827, -71.45800292467847, -270.008940246622, -517.2123732662516, -284.8176324536738, -807.3651342200656, -1147.4793759191996, -460.52528904047284, -1215.20419172991, -529.0431956553757, -767.7342066102563, -1193.0255880364753, -986.7484486472584, -131.7199613087874, -251.24807340111326, -501.46838848443383, -260.7322600522475, -1421.5234252554503, -518.0359231912191, -47.604290587060696, -589.8586579356203, -891.1071782820965, -448.9022200371407, -852.724761420646, -327.02159818453396, -42.81552455033977, -12.2834469129674, -91.08249016997596, -128.95675587206122], "episode_lengths": [150, 150, 150, 74, 127, 150, 150, 111, 66, 150, 75, 63, 67, 150, 85, 127, 150, 150, 113, 81, 150, 148, 150, 150, 150, 63, 96, 33, 39, 111, 46, 50, 150, 150, 150, 55, 150, 150, 150, 52, 82, 150, 104, 150, 150, 150, 150, 150, 150, 56, 150, 150, 139, 150, 57, 150, 89, 150, 77, 91, 125, 150, 133, 111, 55, 71, 29, 150, 128, 150, 69, 90, 51, 110, 150, 122, 150, 150, 138, 150, 150, 150, 150, 150, 79, 113, 144, 115, 150, 150, 54, 150, 150, 150, 150, 89, 64, 43, 60, 73], "policy_policy_0_reward": [-1120.8396664290838, -421.0850196652813, -654.2746462914672, -181.52774006485237, -313.4788011248269, -737.2284266164384, -714.6457408901159, -278.4952571131471, -86.85833066063934, -1030.3517538926467, -112.20359895264605, -68.92798897668253, -85.41037303222039, -291.4948556576628, -113.56302211765258, -318.92322526436504, -537.4795624895866, -627.8474738463945, -265.08617697124566, -137.29686664046423, -694.0111316865682, -445.9930570403746, -234.1051454436085, -708.6907967772814, -225.19756070269776, -67.70211079547471, -183.77532602930117, -7.22425954703118, -5.86977501716266, -242.2500136777159, -121.96778023507092, -61.45676559915227, -837.376634642856, -744.0830214061898, -1285.4578224033803, -61.371157196830254, -290.7703525385958, -994.2416065523812, -887.7006069108361, -45.06301825187948, -262.62595103335434, -1123.033852619197, -243.32419232388182, -707.9303280842657, -344.2120084753189, -1249.307317845238, -1251.5524350763592, -406.9416133439061, -444.44665958663705, -51.76182194878151, -401.1753782996643, -1133.1560325857868, -379.4642553986445, -464.4790200432717, -38.88403075461329, -618.4230489728526, -270.4937862819001, -798.9416048051744, -92.23727600581769, -133.55828633552494, -246.36369813445333, -307.38709847122317, -358.33386866556435, -346.05978491516004, -51.15774961439011, -141.6882893191297, 2.578890780581683, -618.0513666859059, -350.5947898709543, -1038.7848172690283, -65.69884895776379, -164.30092691783827, -71.45800292467847, -270.008940246622, -517.2123732662516, -284.8176324536738, -807.3651342200656, -1147.4793759191996, -460.52528904047284, -1215.20419172991, -529.0431956553757, -767.7342066102563, -1193.0255880364753, -986.7484486472584, -131.7199613087874, -251.24807340111326, -501.46838848443383, -260.7322600522475, -1421.5234252554503, -518.0359231912191, -47.604290587060696, -589.8586579356203, -891.1071782820965, -448.9022200371407, -852.724761420646, -327.02159818453396, -42.81552455033977, -12.2834469129674, -91.08249016997596, -128.95675587206122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5532908736953268, "mean_inference_ms": 1.732027412260691, "mean_action_processing_ms": 0.27398443467131467, "mean_env_wait_ms": 3.3887608626349555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012393712997436523, "StateBufferConnector_ms": 0.00796651840209961, "ViewRequirementAgentConnector_ms": 0.19230961799621582}, "num_episodes": 31, "episode_return_max": 2.578890780581683, "episode_return_min": -1421.5234252554503, "episode_return_mean": -451.1082505140875, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 359.08901080630613, "num_env_steps_trained_throughput_per_sec": 359.08901080630613, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 12478.427, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12478.349, "sample_time_ms": 1185.138, "learn_time_ms": 11227.136, "learn_throughput": 356.28, "synch_weights_time_ms": 65.215}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "training_iteration": 33, "trial_id": "4b94b_00001", "date": "2024-08-05_12-07-16", "timestamp": 1722839836, "time_this_iter_s": 11.153120517730713, "time_total_s": 406.44953083992004, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd011b1c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 406.44953083992004, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 19.18125, "ram_util_percent": 28.7125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 117.01897205015024, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.9652144713948171, "policy_loss": -0.01762893870860959, "vf_loss": 0.9771311381831765, "vf_explained_var": 0.9963909746458133, "kl": 0.014952285001800191, "entropy": 1.016256207972765, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "env_runners": {"episode_reward_max": 2.578890780581683, "episode_reward_min": -1421.5234252554503, "episode_reward_mean": -435.8996271277607, "episode_len_mean": 113.01, "episode_media": {}, "episodes_timesteps_total": 11301, "policy_reward_min": {"policy_0": -1421.5234252554503}, "policy_reward_max": {"policy_0": 2.578890780581683}, "policy_reward_mean": {"policy_0": -435.8996271277607}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-262.62595103335434, -1123.033852619197, -243.32419232388182, -707.9303280842657, -344.2120084753189, -1249.307317845238, -1251.5524350763592, -406.9416133439061, -444.44665958663705, -51.76182194878151, -401.1753782996643, -1133.1560325857868, -379.4642553986445, -464.4790200432717, -38.88403075461329, -618.4230489728526, -270.4937862819001, -798.9416048051744, -92.23727600581769, -133.55828633552494, -246.36369813445333, -307.38709847122317, -358.33386866556435, -346.05978491516004, -51.15774961439011, -141.6882893191297, 2.578890780581683, -618.0513666859059, -350.5947898709543, -1038.7848172690283, -65.69884895776379, -164.30092691783827, -71.45800292467847, -270.008940246622, -517.2123732662516, -284.8176324536738, -807.3651342200656, -1147.4793759191996, -460.52528904047284, -1215.20419172991, -529.0431956553757, -767.7342066102563, -1193.0255880364753, -986.7484486472584, -131.7199613087874, -251.24807340111326, -501.46838848443383, -260.7322600522475, -1421.5234252554503, -518.0359231912191, -47.604290587060696, -589.8586579356203, -891.1071782820965, -448.9022200371407, -852.724761420646, -327.02159818453396, -42.81552455033977, -12.2834469129674, -91.08249016997596, -128.95675587206122, -463.0406903974949, -195.12751375253433, -319.0865537441951, -10.969824708430343, -625.7955953680894, -384.6301514702877, -149.1076314764687, -599.29713976782, -288.5896079463055, -114.72143018177458, -19.77908497822404, -100.07633113428544, -1160.4358182451215, -128.27452137624144, -49.830041642436065, -244.17860568161294, -103.55791366255553, -393.38892174501905, -303.1241351577395, -11.607397868094711, -102.26602805375693, -89.64274787700576, -523.2223767527255, -1146.02915484853, -264.38171316972915, -88.53081705761926, -982.0243440412684, -58.184934553532536, -55.73163563344048, -877.0239204393062, -1198.0588430325633, -63.275390627364864, -482.9440988489612, -961.1285066071339, -848.1988888223567, -384.8908758757446, -59.43187133707183, -584.3797803483934, -164.7220024787203, -121.7772898091554], "episode_lengths": [82, 150, 104, 150, 150, 150, 150, 150, 150, 56, 150, 150, 139, 150, 57, 150, 89, 150, 77, 91, 125, 150, 133, 111, 55, 71, 29, 150, 128, 150, 69, 90, 51, 110, 150, 122, 150, 150, 138, 150, 150, 150, 150, 150, 79, 113, 144, 115, 150, 150, 54, 150, 150, 150, 150, 89, 64, 43, 60, 73, 106, 102, 124, 34, 150, 150, 86, 150, 133, 123, 43, 82, 150, 74, 56, 90, 52, 149, 115, 38, 72, 67, 150, 150, 93, 68, 150, 66, 61, 150, 150, 62, 136, 150, 147, 141, 61, 150, 86, 73], "policy_policy_0_reward": [-262.62595103335434, -1123.033852619197, -243.32419232388182, -707.9303280842657, -344.2120084753189, -1249.307317845238, -1251.5524350763592, -406.9416133439061, -444.44665958663705, -51.76182194878151, -401.1753782996643, -1133.1560325857868, -379.4642553986445, -464.4790200432717, -38.88403075461329, -618.4230489728526, -270.4937862819001, -798.9416048051744, -92.23727600581769, -133.55828633552494, -246.36369813445333, -307.38709847122317, -358.33386866556435, -346.05978491516004, -51.15774961439011, -141.6882893191297, 2.578890780581683, -618.0513666859059, -350.5947898709543, -1038.7848172690283, -65.69884895776379, -164.30092691783827, -71.45800292467847, -270.008940246622, -517.2123732662516, -284.8176324536738, -807.3651342200656, -1147.4793759191996, -460.52528904047284, -1215.20419172991, -529.0431956553757, -767.7342066102563, -1193.0255880364753, -986.7484486472584, -131.7199613087874, -251.24807340111326, -501.46838848443383, -260.7322600522475, -1421.5234252554503, -518.0359231912191, -47.604290587060696, -589.8586579356203, -891.1071782820965, -448.9022200371407, -852.724761420646, -327.02159818453396, -42.81552455033977, -12.2834469129674, -91.08249016997596, -128.95675587206122, -463.0406903974949, -195.12751375253433, -319.0865537441951, -10.969824708430343, -625.7955953680894, -384.6301514702877, -149.1076314764687, -599.29713976782, -288.5896079463055, -114.72143018177458, -19.77908497822404, -100.07633113428544, -1160.4358182451215, -128.27452137624144, -49.830041642436065, -244.17860568161294, -103.55791366255553, -393.38892174501905, -303.1241351577395, -11.607397868094711, -102.26602805375693, -89.64274787700576, -523.2223767527255, -1146.02915484853, -264.38171316972915, -88.53081705761926, -982.0243440412684, -58.184934553532536, -55.73163563344048, -877.0239204393062, -1198.0588430325633, -63.275390627364864, -482.9440988489612, -961.1285066071339, -848.1988888223567, -384.8908758757446, -59.43187133707183, -584.3797803483934, -164.7220024787203, -121.7772898091554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.553144983568943, "mean_inference_ms": 1.7295287060903934, "mean_action_processing_ms": 0.2741947130518492, "mean_env_wait_ms": 3.389936310373182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012703180313110352, "StateBufferConnector_ms": 0.00807332992553711, "ViewRequirementAgentConnector_ms": 0.19696307182312012}, "num_episodes": 40, "episode_return_max": 2.578890780581683, "episode_return_min": -1421.5234252554503, "episode_return_mean": -435.8996271277607, "episodes_this_iter": 40}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.636622966444, "num_env_steps_trained_throughput_per_sec": 303.636622966444, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 12503.068, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12502.991, "sample_time_ms": 1183.246, "learn_time_ms": 11253.268, "learn_throughput": 355.452, "synch_weights_time_ms": 65.617}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "training_iteration": 34, "trial_id": "4b94b_00001", "date": "2024-08-05_12-07-29", "timestamp": 1722839849, "time_this_iter_s": 13.189133405685425, "time_total_s": 419.63866424560547, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd011a0e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 419.63866424560547, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 17.81578947368421, "ram_util_percent": 28.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 114.78969594736894, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.9295230187475682, "policy_loss": -0.01892955406171192, "vf_loss": 0.9420404299162328, "vf_explained_var": 0.9967481413856148, "kl": 0.016356141555146093, "entropy": 0.9481207232922315, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "env_runners": {"episode_reward_max": -10.969824708430343, "episode_reward_min": -1421.5234252554503, "episode_reward_mean": -424.2511266499494, "episode_len_mean": 111.06, "episode_media": {}, "episodes_timesteps_total": 11106, "policy_reward_min": {"policy_0": -1421.5234252554503}, "policy_reward_max": {"policy_0": -10.969824708430343}, "policy_reward_mean": {"policy_0": -424.2511266499494}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-284.8176324536738, -807.3651342200656, -1147.4793759191996, -460.52528904047284, -1215.20419172991, -529.0431956553757, -767.7342066102563, -1193.0255880364753, -986.7484486472584, -131.7199613087874, -251.24807340111326, -501.46838848443383, -260.7322600522475, -1421.5234252554503, -518.0359231912191, -47.604290587060696, -589.8586579356203, -891.1071782820965, -448.9022200371407, -852.724761420646, -327.02159818453396, -42.81552455033977, -12.2834469129674, -91.08249016997596, -128.95675587206122, -463.0406903974949, -195.12751375253433, -319.0865537441951, -10.969824708430343, -625.7955953680894, -384.6301514702877, -149.1076314764687, -599.29713976782, -288.5896079463055, -114.72143018177458, -19.77908497822404, -100.07633113428544, -1160.4358182451215, -128.27452137624144, -49.830041642436065, -244.17860568161294, -103.55791366255553, -393.38892174501905, -303.1241351577395, -11.607397868094711, -102.26602805375693, -89.64274787700576, -523.2223767527255, -1146.02915484853, -264.38171316972915, -88.53081705761926, -982.0243440412684, -58.184934553532536, -55.73163563344048, -877.0239204393062, -1198.0588430325633, -63.275390627364864, -482.9440988489612, -961.1285066071339, -848.1988888223567, -384.8908758757446, -59.43187133707183, -584.3797803483934, -164.7220024787203, -121.7772898091554, -64.5793123901851, -63.208875790291934, -298.35467183133204, -107.58645379887204, -209.6632806805288, -715.6782080987349, -45.65839092797562, -83.07471294085562, -349.4673382852669, -338.39892304910904, -283.54820436394164, -284.0301806362893, -905.2452994729304, -146.38410030816104, -173.70083946508822, -26.309889551093022, -756.4736766858407, -751.1789759702766, -219.06759356477934, -62.041144122767975, -543.6642207558422, -1217.2349917799581, -411.27509409549464, -387.8903568327318, -543.8944049111134, -489.4951943466037, -248.5101987322689, -680.5656275638953, -298.3160520536893, -165.54063963525985, -1279.209193176026, -275.0020093804621, -212.97502060942477, -1009.3798789070154, -149.0175618033471], "episode_lengths": [122, 150, 150, 138, 150, 150, 150, 150, 150, 79, 113, 144, 115, 150, 150, 54, 150, 150, 150, 150, 89, 64, 43, 60, 73, 106, 102, 124, 34, 150, 150, 86, 150, 133, 123, 43, 82, 150, 74, 56, 90, 52, 149, 115, 38, 72, 67, 150, 150, 93, 68, 150, 66, 61, 150, 150, 62, 136, 150, 147, 141, 61, 150, 86, 73, 69, 60, 100, 78, 103, 150, 55, 71, 117, 133, 112, 120, 150, 74, 103, 53, 150, 150, 99, 56, 150, 150, 99, 136, 150, 150, 97, 150, 115, 85, 150, 101, 89, 150, 97], "policy_policy_0_reward": [-284.8176324536738, -807.3651342200656, -1147.4793759191996, -460.52528904047284, -1215.20419172991, -529.0431956553757, -767.7342066102563, -1193.0255880364753, -986.7484486472584, -131.7199613087874, -251.24807340111326, -501.46838848443383, -260.7322600522475, -1421.5234252554503, -518.0359231912191, -47.604290587060696, -589.8586579356203, -891.1071782820965, -448.9022200371407, -852.724761420646, -327.02159818453396, -42.81552455033977, -12.2834469129674, -91.08249016997596, -128.95675587206122, -463.0406903974949, -195.12751375253433, -319.0865537441951, -10.969824708430343, -625.7955953680894, -384.6301514702877, -149.1076314764687, -599.29713976782, -288.5896079463055, -114.72143018177458, -19.77908497822404, -100.07633113428544, -1160.4358182451215, -128.27452137624144, -49.830041642436065, -244.17860568161294, -103.55791366255553, -393.38892174501905, -303.1241351577395, -11.607397868094711, -102.26602805375693, -89.64274787700576, -523.2223767527255, -1146.02915484853, -264.38171316972915, -88.53081705761926, -982.0243440412684, -58.184934553532536, -55.73163563344048, -877.0239204393062, -1198.0588430325633, -63.275390627364864, -482.9440988489612, -961.1285066071339, -848.1988888223567, -384.8908758757446, -59.43187133707183, -584.3797803483934, -164.7220024787203, -121.7772898091554, -64.5793123901851, -63.208875790291934, -298.35467183133204, -107.58645379887204, -209.6632806805288, -715.6782080987349, -45.65839092797562, -83.07471294085562, -349.4673382852669, -338.39892304910904, -283.54820436394164, -284.0301806362893, -905.2452994729304, -146.38410030816104, -173.70083946508822, -26.309889551093022, -756.4736766858407, -751.1789759702766, -219.06759356477934, -62.041144122767975, -543.6642207558422, -1217.2349917799581, -411.27509409549464, -387.8903568327318, -543.8944049111134, -489.4951943466037, -248.5101987322689, -680.5656275638953, -298.3160520536893, -165.54063963525985, -1279.209193176026, -275.0020093804621, -212.97502060942477, -1009.3798789070154, -149.0175618033471]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5527509176166002, "mean_inference_ms": 1.7274583273627155, "mean_action_processing_ms": 0.27396687963785676, "mean_env_wait_ms": 3.391070921936854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012140989303588867, "StateBufferConnector_ms": 0.008077859878540039, "ViewRequirementAgentConnector_ms": 0.19657516479492188}, "num_episodes": 35, "episode_return_max": -10.969824708430343, "episode_return_min": -1421.5234252554503, "episode_return_mean": -424.2511266499494, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.77282246157324, "num_env_steps_trained_throughput_per_sec": 313.77282246157324, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 12495.995, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12495.916, "sample_time_ms": 1194.633, "learn_time_ms": 11235.475, "learn_throughput": 356.015, "synch_weights_time_ms": 64.948}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "training_iteration": 35, "trial_id": "4b94b_00001", "date": "2024-08-05_12-07-42", "timestamp": 1722839862, "time_this_iter_s": 12.759476661682129, "time_total_s": 432.3981409072876, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd01b7e20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 432.3981409072876, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 18.3, "ram_util_percent": 28.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 139.08809547821681, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.7772381993631522, "policy_loss": -0.016523068482638337, "vf_loss": 0.7883840847760439, "vf_explained_var": 0.9969395550588767, "kl": 0.014623072823087597, "entropy": 1.2031999149670203, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": -11.607397868094711, "episode_reward_min": -1283.6945544934094, "episode_reward_mean": -416.38734203083004, "episode_len_mean": 106.08, "episode_media": {}, "episodes_timesteps_total": 10608, "policy_reward_min": {"policy_0": -1283.6945544934094}, "policy_reward_max": {"policy_0": -11.607397868094711}, "policy_reward_mean": {"policy_0": -416.38734203083004}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.77908497822404, -100.07633113428544, -1160.4358182451215, -128.27452137624144, -49.830041642436065, -244.17860568161294, -103.55791366255553, -393.38892174501905, -303.1241351577395, -11.607397868094711, -102.26602805375693, -89.64274787700576, -523.2223767527255, -1146.02915484853, -264.38171316972915, -88.53081705761926, -982.0243440412684, -58.184934553532536, -55.73163563344048, -877.0239204393062, -1198.0588430325633, -63.275390627364864, -482.9440988489612, -961.1285066071339, -848.1988888223567, -384.8908758757446, -59.43187133707183, -584.3797803483934, -164.7220024787203, -121.7772898091554, -64.5793123901851, -63.208875790291934, -298.35467183133204, -107.58645379887204, -209.6632806805288, -715.6782080987349, -45.65839092797562, -83.07471294085562, -349.4673382852669, -338.39892304910904, -283.54820436394164, -284.0301806362893, -905.2452994729304, -146.38410030816104, -173.70083946508822, -26.309889551093022, -756.4736766858407, -751.1789759702766, -219.06759356477934, -62.041144122767975, -543.6642207558422, -1217.2349917799581, -411.27509409549464, -387.8903568327318, -543.8944049111134, -489.4951943466037, -248.5101987322689, -680.5656275638953, -298.3160520536893, -165.54063963525985, -1279.209193176026, -275.0020093804621, -212.97502060942477, -1009.3798789070154, -149.0175618033471, -671.7484396427965, -172.3220567335294, -915.4841491825039, -1168.9322287230898, -389.13750736316285, -35.39755003500557, -326.31557960885806, -239.71755097581624, -853.2580311076794, -36.808907128415186, -855.287456232251, -42.226359440649595, -647.2504788264214, -147.67673179026775, -241.67174465387632, -1241.5038813411634, -131.4068170834998, -1283.6945544934094, -157.73527633815306, -913.153658608088, -20.266012694228287, -140.0215146624826, -49.33116475807439, -16.803803451368573, -734.3179888798703, -666.5789170286628, -1076.5141119832822, -42.331207473437125, -1063.7208136368354, -1084.9848291498056, -35.38333781808265, -177.40922798746666, -39.98731718966359, -338.94070545937194, -315.69578337857274], "episode_lengths": [43, 82, 150, 74, 56, 90, 52, 149, 115, 38, 72, 67, 150, 150, 93, 68, 150, 66, 61, 150, 150, 62, 136, 150, 147, 141, 61, 150, 86, 73, 69, 60, 100, 78, 103, 150, 55, 71, 117, 133, 112, 120, 150, 74, 103, 53, 150, 150, 99, 56, 150, 150, 99, 136, 150, 150, 97, 150, 115, 85, 150, 101, 89, 150, 97, 129, 97, 150, 150, 109, 55, 110, 114, 150, 48, 150, 53, 150, 83, 98, 150, 81, 150, 74, 150, 47, 81, 58, 44, 150, 150, 150, 49, 150, 150, 52, 76, 46, 124, 126], "policy_policy_0_reward": [-19.77908497822404, -100.07633113428544, -1160.4358182451215, -128.27452137624144, -49.830041642436065, -244.17860568161294, -103.55791366255553, -393.38892174501905, -303.1241351577395, -11.607397868094711, -102.26602805375693, -89.64274787700576, -523.2223767527255, -1146.02915484853, -264.38171316972915, -88.53081705761926, -982.0243440412684, -58.184934553532536, -55.73163563344048, -877.0239204393062, -1198.0588430325633, -63.275390627364864, -482.9440988489612, -961.1285066071339, -848.1988888223567, -384.8908758757446, -59.43187133707183, -584.3797803483934, -164.7220024787203, -121.7772898091554, -64.5793123901851, -63.208875790291934, -298.35467183133204, -107.58645379887204, -209.6632806805288, -715.6782080987349, -45.65839092797562, -83.07471294085562, -349.4673382852669, -338.39892304910904, -283.54820436394164, -284.0301806362893, -905.2452994729304, -146.38410030816104, -173.70083946508822, -26.309889551093022, -756.4736766858407, -751.1789759702766, -219.06759356477934, -62.041144122767975, -543.6642207558422, -1217.2349917799581, -411.27509409549464, -387.8903568327318, -543.8944049111134, -489.4951943466037, -248.5101987322689, -680.5656275638953, -298.3160520536893, -165.54063963525985, -1279.209193176026, -275.0020093804621, -212.97502060942477, -1009.3798789070154, -149.0175618033471, -671.7484396427965, -172.3220567335294, -915.4841491825039, -1168.9322287230898, -389.13750736316285, -35.39755003500557, -326.31557960885806, -239.71755097581624, -853.2580311076794, -36.808907128415186, -855.287456232251, -42.226359440649595, -647.2504788264214, -147.67673179026775, -241.67174465387632, -1241.5038813411634, -131.4068170834998, -1283.6945544934094, -157.73527633815306, -913.153658608088, -20.266012694228287, -140.0215146624826, -49.33116475807439, -16.803803451368573, -734.3179888798703, -666.5789170286628, -1076.5141119832822, -42.331207473437125, -1063.7208136368354, -1084.9848291498056, -35.38333781808265, -177.40922798746666, -39.98731718966359, -338.94070545937194, -315.69578337857274]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5527763212598548, "mean_inference_ms": 1.7270861631101226, "mean_action_processing_ms": 0.2741585589478985, "mean_env_wait_ms": 3.393453174622059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012061119079589844, "StateBufferConnector_ms": 0.008087396621704102, "ViewRequirementAgentConnector_ms": 0.2014322280883789}, "num_episodes": 35, "episode_return_max": -11.607397868094711, "episode_return_min": -1283.6945544934094, "episode_return_mean": -416.38734203083004, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 329.9661044190324, "num_env_steps_trained_throughput_per_sec": 329.9661044190324, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 12426.404, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12426.324, "sample_time_ms": 1202.636, "learn_time_ms": 11159.334, "learn_throughput": 358.444, "synch_weights_time_ms": 63.499}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 36, "trial_id": "4b94b_00001", "date": "2024-08-05_12-07-54", "timestamp": 1722839874, "time_this_iter_s": 12.134807825088501, "time_total_s": 444.5329487323761, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75df2c744160>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 444.5329487323761, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 18.133333333333336, "ram_util_percent": 28.705555555555552}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 117.66438863476118, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.8086711547182251, "policy_loss": -0.013370847688444579, "vf_loss": 0.8164746145407359, "vf_explained_var": 0.9974444483717283, "kl": 0.014734342773166076, "entropy": 1.0630681701625386, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "env_runners": {"episode_reward_max": -16.803803451368573, "episode_reward_min": -1283.6945544934094, "episode_reward_mean": -497.2269132203421, "episode_len_mean": 116.39, "episode_media": {}, "episodes_timesteps_total": 11639, "policy_reward_min": {"policy_0": -1283.6945544934094}, "policy_reward_max": {"policy_0": -16.803803451368573}, "policy_reward_mean": {"policy_0": -497.2269132203421}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-715.6782080987349, -45.65839092797562, -83.07471294085562, -349.4673382852669, -338.39892304910904, -283.54820436394164, -284.0301806362893, -905.2452994729304, -146.38410030816104, -173.70083946508822, -26.309889551093022, -756.4736766858407, -751.1789759702766, -219.06759356477934, -62.041144122767975, -543.6642207558422, -1217.2349917799581, -411.27509409549464, -387.8903568327318, -543.8944049111134, -489.4951943466037, -248.5101987322689, -680.5656275638953, -298.3160520536893, -165.54063963525985, -1279.209193176026, -275.0020093804621, -212.97502060942477, -1009.3798789070154, -149.0175618033471, -671.7484396427965, -172.3220567335294, -915.4841491825039, -1168.9322287230898, -389.13750736316285, -35.39755003500557, -326.31557960885806, -239.71755097581624, -853.2580311076794, -36.808907128415186, -855.287456232251, -42.226359440649595, -647.2504788264214, -147.67673179026775, -241.67174465387632, -1241.5038813411634, -131.4068170834998, -1283.6945544934094, -157.73527633815306, -913.153658608088, -20.266012694228287, -140.0215146624826, -49.33116475807439, -16.803803451368573, -734.3179888798703, -666.5789170286628, -1076.5141119832822, -42.331207473437125, -1063.7208136368354, -1084.9848291498056, -35.38333781808265, -177.40922798746666, -39.98731718966359, -338.94070545937194, -315.69578337857274, -327.8976643719506, -1277.189518677322, -390.6727161326985, -762.6546670846241, -467.37554513067175, -931.6544330039608, -413.50084790036414, -616.6301883619489, -206.76393616207898, -331.3015308276414, -982.1013755982674, -73.34435424188622, -193.23851711609404, -591.8704711732114, -25.9646850955882, -1199.3038231997245, -1059.6283920046108, -409.35034346261745, -260.5302129402242, -479.8541559277004, -785.0452824162734, -1278.404057237875, -1066.1881863301114, -598.7717193761736, -547.901266900737, -1149.4890689755628, -529.691911148091, -101.60864127261303, -48.030413432636166, -618.0642713073338, -564.5970451573735, -1260.2449098569555, -234.29424566197972, -509.2098967074547, -105.07941095376565], "episode_lengths": [150, 55, 71, 117, 133, 112, 120, 150, 74, 103, 53, 150, 150, 99, 56, 150, 150, 99, 136, 150, 150, 97, 150, 115, 85, 150, 101, 89, 150, 97, 129, 97, 150, 150, 109, 55, 110, 114, 150, 48, 150, 53, 150, 83, 98, 150, 81, 150, 74, 150, 47, 81, 58, 44, 150, 150, 150, 49, 150, 150, 52, 76, 46, 124, 126, 136, 150, 89, 150, 150, 150, 139, 150, 96, 127, 150, 54, 88, 150, 48, 150, 150, 150, 105, 150, 150, 150, 150, 150, 150, 150, 141, 69, 59, 150, 150, 150, 106, 150, 66], "policy_policy_0_reward": [-715.6782080987349, -45.65839092797562, -83.07471294085562, -349.4673382852669, -338.39892304910904, -283.54820436394164, -284.0301806362893, -905.2452994729304, -146.38410030816104, -173.70083946508822, -26.309889551093022, -756.4736766858407, -751.1789759702766, -219.06759356477934, -62.041144122767975, -543.6642207558422, -1217.2349917799581, -411.27509409549464, -387.8903568327318, -543.8944049111134, -489.4951943466037, -248.5101987322689, -680.5656275638953, -298.3160520536893, -165.54063963525985, -1279.209193176026, -275.0020093804621, -212.97502060942477, -1009.3798789070154, -149.0175618033471, -671.7484396427965, -172.3220567335294, -915.4841491825039, -1168.9322287230898, -389.13750736316285, -35.39755003500557, -326.31557960885806, -239.71755097581624, -853.2580311076794, -36.808907128415186, -855.287456232251, -42.226359440649595, -647.2504788264214, -147.67673179026775, -241.67174465387632, -1241.5038813411634, -131.4068170834998, -1283.6945544934094, -157.73527633815306, -913.153658608088, -20.266012694228287, -140.0215146624826, -49.33116475807439, -16.803803451368573, -734.3179888798703, -666.5789170286628, -1076.5141119832822, -42.331207473437125, -1063.7208136368354, -1084.9848291498056, -35.38333781808265, -177.40922798746666, -39.98731718966359, -338.94070545937194, -315.69578337857274, -327.8976643719506, -1277.189518677322, -390.6727161326985, -762.6546670846241, -467.37554513067175, -931.6544330039608, -413.50084790036414, -616.6301883619489, -206.76393616207898, -331.3015308276414, -982.1013755982674, -73.34435424188622, -193.23851711609404, -591.8704711732114, -25.9646850955882, -1199.3038231997245, -1059.6283920046108, -409.35034346261745, -260.5302129402242, -479.8541559277004, -785.0452824162734, -1278.404057237875, -1066.1881863301114, -598.7717193761736, -547.901266900737, -1149.4890689755628, -529.691911148091, -101.60864127261303, -48.030413432636166, -618.0642713073338, -564.5970451573735, -1260.2449098569555, -234.29424566197972, -509.2098967074547, -105.07941095376565]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5530733438099145, "mean_inference_ms": 1.7261806376421882, "mean_action_processing_ms": 0.2740500260794246, "mean_env_wait_ms": 3.397210801644842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011587858200073242, "StateBufferConnector_ms": 0.008015155792236328, "ViewRequirementAgentConnector_ms": 0.1973860263824463}, "num_episodes": 35, "episode_return_max": -16.803803451368573, "episode_return_min": -1283.6945544934094, "episode_return_mean": -497.2269132203421, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.8753309719391, "num_env_steps_trained_throughput_per_sec": 320.8753309719391, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 12389.523, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12389.444, "sample_time_ms": 1194.762, "learn_time_ms": 11129.35, "learn_throughput": 359.41, "synch_weights_time_ms": 64.477}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "training_iteration": 37, "trial_id": "4b94b_00001", "date": "2024-08-05_12-08-06", "timestamp": 1722839886, "time_this_iter_s": 12.477391481399536, "time_total_s": 457.01034021377563, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd01b7f40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 457.01034021377563, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 18.158823529411766, "ram_util_percent": 28.711764705882352}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 149.08463239272436, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.7817701892927289, "policy_loss": -0.010099267989668684, "vf_loss": 0.785508350438128, "vf_explained_var": 0.9975542489439249, "kl": 0.016920595300750088, "entropy": 1.2531620787456632, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "env_runners": {"episode_reward_max": -16.30789886531604, "episode_reward_min": -1283.6945544934094, "episode_reward_mean": -484.5930827051055, "episode_len_mean": 112.32, "episode_media": {}, "episodes_timesteps_total": 11232, "policy_reward_min": {"policy_0": -1283.6945544934094}, "policy_reward_max": {"policy_0": -16.30789886531604}, "policy_reward_mean": {"policy_0": -484.5930827051055}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35.39755003500557, -326.31557960885806, -239.71755097581624, -853.2580311076794, -36.808907128415186, -855.287456232251, -42.226359440649595, -647.2504788264214, -147.67673179026775, -241.67174465387632, -1241.5038813411634, -131.4068170834998, -1283.6945544934094, -157.73527633815306, -913.153658608088, -20.266012694228287, -140.0215146624826, -49.33116475807439, -16.803803451368573, -734.3179888798703, -666.5789170286628, -1076.5141119832822, -42.331207473437125, -1063.7208136368354, -1084.9848291498056, -35.38333781808265, -177.40922798746666, -39.98731718966359, -338.94070545937194, -315.69578337857274, -327.8976643719506, -1277.189518677322, -390.6727161326985, -762.6546670846241, -467.37554513067175, -931.6544330039608, -413.50084790036414, -616.6301883619489, -206.76393616207898, -331.3015308276414, -982.1013755982674, -73.34435424188622, -193.23851711609404, -591.8704711732114, -25.9646850955882, -1199.3038231997245, -1059.6283920046108, -409.35034346261745, -260.5302129402242, -479.8541559277004, -785.0452824162734, -1278.404057237875, -1066.1881863301114, -598.7717193761736, -547.901266900737, -1149.4890689755628, -529.691911148091, -101.60864127261303, -48.030413432636166, -618.0642713073338, -564.5970451573735, -1260.2449098569555, -234.29424566197972, -509.2098967074547, -105.07941095376565, -396.0987615956726, -65.53512148200113, -1001.5355244028312, -1087.4063394876614, -35.78339192193764, -157.7003373956697, -149.0549674130445, -480.6628989629635, -176.78766742336094, -128.05824384596983, -834.6948877211546, -23.634292134345856, -586.0771366097036, -281.3311836935936, -73.81759752444249, -85.08026209969847, -754.5945947030112, -523.980216321771, -1126.7300778642293, -126.86534862815205, -28.170156737398347, -1165.1353124970674, -465.5607848358046, -599.6357954539127, -94.89711330757274, -47.45986629120101, -126.4033194014917, -361.6718047660764, -958.4670539268596, -129.71161595911647, -16.30789886531604, -52.225264509952304, -1072.8761596103482, -982.39410743524, -910.1241473190975], "episode_lengths": [55, 110, 114, 150, 48, 150, 53, 150, 83, 98, 150, 81, 150, 74, 150, 47, 81, 58, 44, 150, 150, 150, 49, 150, 150, 52, 76, 46, 124, 126, 136, 150, 89, 150, 150, 150, 139, 150, 96, 127, 150, 54, 88, 150, 48, 150, 150, 150, 105, 150, 150, 150, 150, 150, 150, 150, 141, 69, 59, 150, 150, 150, 106, 150, 66, 146, 65, 150, 150, 52, 85, 94, 144, 81, 81, 150, 44, 150, 114, 60, 68, 150, 150, 150, 72, 49, 150, 150, 150, 75, 37, 75, 104, 150, 55, 38, 51, 150, 150, 150], "policy_policy_0_reward": [-35.39755003500557, -326.31557960885806, -239.71755097581624, -853.2580311076794, -36.808907128415186, -855.287456232251, -42.226359440649595, -647.2504788264214, -147.67673179026775, -241.67174465387632, -1241.5038813411634, -131.4068170834998, -1283.6945544934094, -157.73527633815306, -913.153658608088, -20.266012694228287, -140.0215146624826, -49.33116475807439, -16.803803451368573, -734.3179888798703, -666.5789170286628, -1076.5141119832822, -42.331207473437125, -1063.7208136368354, -1084.9848291498056, -35.38333781808265, -177.40922798746666, -39.98731718966359, -338.94070545937194, -315.69578337857274, -327.8976643719506, -1277.189518677322, -390.6727161326985, -762.6546670846241, -467.37554513067175, -931.6544330039608, -413.50084790036414, -616.6301883619489, -206.76393616207898, -331.3015308276414, -982.1013755982674, -73.34435424188622, -193.23851711609404, -591.8704711732114, -25.9646850955882, -1199.3038231997245, -1059.6283920046108, -409.35034346261745, -260.5302129402242, -479.8541559277004, -785.0452824162734, -1278.404057237875, -1066.1881863301114, -598.7717193761736, -547.901266900737, -1149.4890689755628, -529.691911148091, -101.60864127261303, -48.030413432636166, -618.0642713073338, -564.5970451573735, -1260.2449098569555, -234.29424566197972, -509.2098967074547, -105.07941095376565, -396.0987615956726, -65.53512148200113, -1001.5355244028312, -1087.4063394876614, -35.78339192193764, -157.7003373956697, -149.0549674130445, -480.6628989629635, -176.78766742336094, -128.05824384596983, -834.6948877211546, -23.634292134345856, -586.0771366097036, -281.3311836935936, -73.81759752444249, -85.08026209969847, -754.5945947030112, -523.980216321771, -1126.7300778642293, -126.86534862815205, -28.170156737398347, -1165.1353124970674, -465.5607848358046, -599.6357954539127, -94.89711330757274, -47.45986629120101, -126.4033194014917, -361.6718047660764, -958.4670539268596, -129.71161595911647, -16.30789886531604, -52.225264509952304, -1072.8761596103482, -982.39410743524, -910.1241473190975]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5533082513698695, "mean_inference_ms": 1.7242539717503802, "mean_action_processing_ms": 0.2742080893300335, "mean_env_wait_ms": 3.3974805923867204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011727333068847656, "StateBufferConnector_ms": 0.007950305938720703, "ViewRequirementAgentConnector_ms": 0.19624781608581543}, "num_episodes": 35, "episode_return_max": -16.30789886531604, "episode_return_min": -1283.6945544934094, "episode_return_mean": -484.5930827051055, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.60796166651744, "num_env_steps_trained_throughput_per_sec": 308.60796166651744, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 12407.744, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12407.664, "sample_time_ms": 1173.896, "learn_time_ms": 11167.824, "learn_throughput": 358.172, "synch_weights_time_ms": 65.087}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "training_iteration": 38, "trial_id": "4b94b_00001", "date": "2024-08-05_12-08-19", "timestamp": 1722839899, "time_this_iter_s": 12.975736379623413, "time_total_s": 469.98607659339905, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd01b6200>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 469.98607659339905, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 17.921052631578945, "ram_util_percent": 28.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 104.904964864254, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.7352798892495532, "policy_loss": -0.012955914632766508, "vf_loss": 0.742847780821224, "vf_explained_var": 0.998096134327352, "kl": 0.0145309033183518, "entropy": 1.15088371510307, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "env_runners": {"episode_reward_max": -7.387896905434929, "episode_reward_min": -1363.0590707393287, "episode_reward_mean": -488.2959603729279, "episode_len_mean": 113.2, "episode_media": {}, "episodes_timesteps_total": 11320, "policy_reward_min": {"policy_0": -1363.0590707393287}, "policy_reward_max": {"policy_0": -7.387896905434929}, "policy_reward_mean": {"policy_0": -488.2959603729279}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-331.3015308276414, -982.1013755982674, -73.34435424188622, -193.23851711609404, -591.8704711732114, -25.9646850955882, -1199.3038231997245, -1059.6283920046108, -409.35034346261745, -260.5302129402242, -479.8541559277004, -785.0452824162734, -1278.404057237875, -1066.1881863301114, -598.7717193761736, -547.901266900737, -1149.4890689755628, -529.691911148091, -101.60864127261303, -48.030413432636166, -618.0642713073338, -564.5970451573735, -1260.2449098569555, -234.29424566197972, -509.2098967074547, -105.07941095376565, -396.0987615956726, -65.53512148200113, -1001.5355244028312, -1087.4063394876614, -35.78339192193764, -157.7003373956697, -149.0549674130445, -480.6628989629635, -176.78766742336094, -128.05824384596983, -834.6948877211546, -23.634292134345856, -586.0771366097036, -281.3311836935936, -73.81759752444249, -85.08026209969847, -754.5945947030112, -523.980216321771, -1126.7300778642293, -126.86534862815205, -28.170156737398347, -1165.1353124970674, -465.5607848358046, -599.6357954539127, -94.89711330757274, -47.45986629120101, -126.4033194014917, -361.6718047660764, -958.4670539268596, -129.71161595911647, -16.30789886531604, -52.225264509952304, -1072.8761596103482, -982.39410743524, -910.1241473190975, -652.7528415977526, -128.67988572292901, -354.01401920600205, -349.85759423100177, -876.578652726081, -1075.779126070811, -182.26647405584868, -56.165170937325385, -237.7523513631842, -207.51539999657336, -108.23029161961686, -12.89881736534672, -95.45884315341526, -142.54821305510785, -1074.2035122524649, -768.9364211581628, -367.25949519356607, -7.387896905434929, -1143.8935028081225, -43.84456063725359, -819.9670489041988, -688.1195636006104, -1031.9104231268655, -206.08424253979916, -645.2199098995823, -744.1072896712103, -22.878245997232547, -1265.9818842752923, -226.87277225866066, -148.34221438695522, -228.31086399561863, -880.117250702315, -189.09351691883683, -296.4564947844143, -261.19537588235835, -664.0960647225539, -1363.0590707393287, -942.5895254388777, -209.59376892191548], "episode_lengths": [127, 150, 54, 88, 150, 48, 150, 150, 150, 105, 150, 150, 150, 150, 150, 150, 150, 141, 69, 59, 150, 150, 150, 106, 150, 66, 146, 65, 150, 150, 52, 85, 94, 144, 81, 81, 150, 44, 150, 114, 60, 68, 150, 150, 150, 72, 49, 150, 150, 150, 75, 37, 75, 104, 150, 55, 38, 51, 150, 150, 150, 150, 81, 137, 110, 150, 150, 102, 59, 107, 101, 80, 43, 76, 80, 150, 150, 129, 37, 150, 49, 150, 150, 150, 65, 150, 150, 47, 150, 100, 74, 94, 150, 90, 105, 98, 150, 150, 150, 103], "policy_policy_0_reward": [-331.3015308276414, -982.1013755982674, -73.34435424188622, -193.23851711609404, -591.8704711732114, -25.9646850955882, -1199.3038231997245, -1059.6283920046108, -409.35034346261745, -260.5302129402242, -479.8541559277004, -785.0452824162734, -1278.404057237875, -1066.1881863301114, -598.7717193761736, -547.901266900737, -1149.4890689755628, -529.691911148091, -101.60864127261303, -48.030413432636166, -618.0642713073338, -564.5970451573735, -1260.2449098569555, -234.29424566197972, -509.2098967074547, -105.07941095376565, -396.0987615956726, -65.53512148200113, -1001.5355244028312, -1087.4063394876614, -35.78339192193764, -157.7003373956697, -149.0549674130445, -480.6628989629635, -176.78766742336094, -128.05824384596983, -834.6948877211546, -23.634292134345856, -586.0771366097036, -281.3311836935936, -73.81759752444249, -85.08026209969847, -754.5945947030112, -523.980216321771, -1126.7300778642293, -126.86534862815205, -28.170156737398347, -1165.1353124970674, -465.5607848358046, -599.6357954539127, -94.89711330757274, -47.45986629120101, -126.4033194014917, -361.6718047660764, -958.4670539268596, -129.71161595911647, -16.30789886531604, -52.225264509952304, -1072.8761596103482, -982.39410743524, -910.1241473190975, -652.7528415977526, -128.67988572292901, -354.01401920600205, -349.85759423100177, -876.578652726081, -1075.779126070811, -182.26647405584868, -56.165170937325385, -237.7523513631842, -207.51539999657336, -108.23029161961686, -12.89881736534672, -95.45884315341526, -142.54821305510785, -1074.2035122524649, -768.9364211581628, -367.25949519356607, -7.387896905434929, -1143.8935028081225, -43.84456063725359, -819.9670489041988, -688.1195636006104, -1031.9104231268655, -206.08424253979916, -645.2199098995823, -744.1072896712103, -22.878245997232547, -1265.9818842752923, -226.87277225866066, -148.34221438695522, -228.31086399561863, -880.117250702315, -189.09351691883683, -296.4564947844143, -261.19537588235835, -664.0960647225539, -1363.0590707393287, -942.5895254388777, -209.59376892191548]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5536315123745623, "mean_inference_ms": 1.7215418979979409, "mean_action_processing_ms": 0.27426237689001637, "mean_env_wait_ms": 3.3962326966607477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012047529220581055, "StateBufferConnector_ms": 0.007954597473144531, "ViewRequirementAgentConnector_ms": 0.18996238708496094}, "num_episodes": 39, "episode_return_max": -7.387896905434929, "episode_return_min": -1363.0590707393287, "episode_return_mean": -488.2959603729279, "episodes_this_iter": 39}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.7449682141186, "num_env_steps_trained_throughput_per_sec": 313.7449682141186, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 12456.812, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12456.733, "sample_time_ms": 1170.859, "learn_time_ms": 11218.621, "learn_throughput": 356.55, "synch_weights_time_ms": 66.387}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "training_iteration": 39, "trial_id": "4b94b_00001", "date": "2024-08-05_12-08-32", "timestamp": 1722839912, "time_this_iter_s": 12.762495756149292, "time_total_s": 482.74857234954834, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd011bbe0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 482.74857234954834, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 18.12777777777778, "ram_util_percent": 28.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 128.51275359392167, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.779365974649166, "policy_loss": -0.018187218166228074, "vf_loss": 0.7909299754227201, "vf_explained_var": 0.9986552600438396, "kl": 0.017392286250863767, "entropy": 1.2033111033961177, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": -7.387896905434929, "episode_reward_min": -1363.0590707393287, "episode_reward_mean": -458.3563173283194, "episode_len_mean": 109.48, "episode_media": {}, "episodes_timesteps_total": 10948, "policy_reward_min": {"policy_0": -1363.0590707393287}, "policy_reward_max": {"policy_0": -7.387896905434929}, "policy_reward_mean": {"policy_0": -458.3563173283194}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-480.6628989629635, -176.78766742336094, -128.05824384596983, -834.6948877211546, -23.634292134345856, -586.0771366097036, -281.3311836935936, -73.81759752444249, -85.08026209969847, -754.5945947030112, -523.980216321771, -1126.7300778642293, -126.86534862815205, -28.170156737398347, -1165.1353124970674, -465.5607848358046, -599.6357954539127, -94.89711330757274, -47.45986629120101, -126.4033194014917, -361.6718047660764, -958.4670539268596, -129.71161595911647, -16.30789886531604, -52.225264509952304, -1072.8761596103482, -982.39410743524, -910.1241473190975, -652.7528415977526, -128.67988572292901, -354.01401920600205, -349.85759423100177, -876.578652726081, -1075.779126070811, -182.26647405584868, -56.165170937325385, -237.7523513631842, -207.51539999657336, -108.23029161961686, -12.89881736534672, -95.45884315341526, -142.54821305510785, -1074.2035122524649, -768.9364211581628, -367.25949519356607, -7.387896905434929, -1143.8935028081225, -43.84456063725359, -819.9670489041988, -688.1195636006104, -1031.9104231268655, -206.08424253979916, -645.2199098995823, -744.1072896712103, -22.878245997232547, -1265.9818842752923, -226.87277225866066, -148.34221438695522, -228.31086399561863, -880.117250702315, -189.09351691883683, -296.4564947844143, -261.19537588235835, -664.0960647225539, -1363.0590707393287, -942.5895254388777, -209.59376892191548, -96.26577903011218, -412.2755892428874, -1012.4023696551859, -312.69710038864196, -195.95565669303255, -783.1986664973297, -1008.2831592707834, -1154.355433486091, -34.51030560675975, -204.88317102552017, -111.71242131840854, -7.513397641981675, -194.36462724844816, -1020.8198858647295, -993.0095621002927, -202.0657217812897, -1101.7065859745383, -617.1639757592021, -64.1213767781636, -169.74308671974862, -25.171223362824637, -357.8805808540629, -106.15036561040195, -213.87640542960082, -136.70049310700165, -465.5475416224152, -362.0474107869647, -146.66451064501575, -1204.421304351466, -89.1533942532401, -955.334583893705, -471.4655268768001, -670.7971146838249], "episode_lengths": [144, 81, 81, 150, 44, 150, 114, 60, 68, 150, 150, 150, 72, 49, 150, 150, 150, 75, 37, 75, 104, 150, 55, 38, 51, 150, 150, 150, 150, 81, 137, 110, 150, 150, 102, 59, 107, 101, 80, 43, 76, 80, 150, 150, 129, 37, 150, 49, 150, 150, 150, 65, 150, 150, 47, 150, 100, 74, 94, 150, 90, 105, 98, 150, 150, 150, 103, 62, 148, 150, 137, 82, 150, 150, 150, 55, 87, 69, 39, 84, 150, 150, 87, 150, 150, 61, 61, 50, 137, 76, 98, 76, 150, 131, 77, 150, 66, 150, 150, 150], "policy_policy_0_reward": [-480.6628989629635, -176.78766742336094, -128.05824384596983, -834.6948877211546, -23.634292134345856, -586.0771366097036, -281.3311836935936, -73.81759752444249, -85.08026209969847, -754.5945947030112, -523.980216321771, -1126.7300778642293, -126.86534862815205, -28.170156737398347, -1165.1353124970674, -465.5607848358046, -599.6357954539127, -94.89711330757274, -47.45986629120101, -126.4033194014917, -361.6718047660764, -958.4670539268596, -129.71161595911647, -16.30789886531604, -52.225264509952304, -1072.8761596103482, -982.39410743524, -910.1241473190975, -652.7528415977526, -128.67988572292901, -354.01401920600205, -349.85759423100177, -876.578652726081, -1075.779126070811, -182.26647405584868, -56.165170937325385, -237.7523513631842, -207.51539999657336, -108.23029161961686, -12.89881736534672, -95.45884315341526, -142.54821305510785, -1074.2035122524649, -768.9364211581628, -367.25949519356607, -7.387896905434929, -1143.8935028081225, -43.84456063725359, -819.9670489041988, -688.1195636006104, -1031.9104231268655, -206.08424253979916, -645.2199098995823, -744.1072896712103, -22.878245997232547, -1265.9818842752923, -226.87277225866066, -148.34221438695522, -228.31086399561863, -880.117250702315, -189.09351691883683, -296.4564947844143, -261.19537588235835, -664.0960647225539, -1363.0590707393287, -942.5895254388777, -209.59376892191548, -96.26577903011218, -412.2755892428874, -1012.4023696551859, -312.69710038864196, -195.95565669303255, -783.1986664973297, -1008.2831592707834, -1154.355433486091, -34.51030560675975, -204.88317102552017, -111.71242131840854, -7.513397641981675, -194.36462724844816, -1020.8198858647295, -993.0095621002927, -202.0657217812897, -1101.7065859745383, -617.1639757592021, -64.1213767781636, -169.74308671974862, -25.171223362824637, -357.8805808540629, -106.15036561040195, -213.87640542960082, -136.70049310700165, -465.5475416224152, -362.0474107869647, -146.66451064501575, -1204.421304351466, -89.1533942532401, -955.334583893705, -471.4655268768001, -670.7971146838249]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5536556504900115, "mean_inference_ms": 1.7206078287045181, "mean_action_processing_ms": 0.2741338714855899, "mean_env_wait_ms": 3.3990708525227853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012121200561523438, "StateBufferConnector_ms": 0.007879972457885742, "ViewRequirementAgentConnector_ms": 0.19127869606018066}, "num_episodes": 33, "episode_return_max": -7.387896905434929, "episode_return_min": -1363.0590707393287, "episode_return_mean": -458.3563173283194, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 328.56282649617003, "num_env_steps_trained_throughput_per_sec": 328.56282649617003, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 12512.242, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12512.164, "sample_time_ms": 1170.394, "learn_time_ms": 11275.162, "learn_throughput": 354.762, "synch_weights_time_ms": 65.749}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 40, "trial_id": "4b94b_00001", "date": "2024-08-05_12-08-44", "timestamp": 1722839924, "time_this_iter_s": 12.18738842010498, "time_total_s": 494.9359607696533, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd011b370>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 494.9359607696533, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 18.752941176470593, "ram_util_percent": 28.71764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 110.94435621102652, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.9733919334597886, "policy_loss": -0.010736747348952727, "vf_loss": 0.9788821424978474, "vf_explained_var": 0.9929840814943115, "kl": 0.014081741564586992, "entropy": 1.0902462531502048, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "env_runners": {"episode_reward_max": 1.6918368141941915, "episode_reward_min": -1431.2809692937437, "episode_reward_mean": -474.50864992453046, "episode_len_mean": 111.52, "episode_media": {}, "episodes_timesteps_total": 11152, "policy_reward_min": {"policy_0": -1431.2809692937437}, "policy_reward_max": {"policy_0": 1.6918368141941915}, "policy_reward_mean": {"policy_0": -474.50864992453046}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-207.51539999657336, -108.23029161961686, -12.89881736534672, -95.45884315341526, -142.54821305510785, -1074.2035122524649, -768.9364211581628, -367.25949519356607, -7.387896905434929, -1143.8935028081225, -43.84456063725359, -819.9670489041988, -688.1195636006104, -1031.9104231268655, -206.08424253979916, -645.2199098995823, -744.1072896712103, -22.878245997232547, -1265.9818842752923, -226.87277225866066, -148.34221438695522, -228.31086399561863, -880.117250702315, -189.09351691883683, -296.4564947844143, -261.19537588235835, -664.0960647225539, -1363.0590707393287, -942.5895254388777, -209.59376892191548, -96.26577903011218, -412.2755892428874, -1012.4023696551859, -312.69710038864196, -195.95565669303255, -783.1986664973297, -1008.2831592707834, -1154.355433486091, -34.51030560675975, -204.88317102552017, -111.71242131840854, -7.513397641981675, -194.36462724844816, -1020.8198858647295, -993.0095621002927, -202.0657217812897, -1101.7065859745383, -617.1639757592021, -64.1213767781636, -169.74308671974862, -25.171223362824637, -357.8805808540629, -106.15036561040195, -213.87640542960082, -136.70049310700165, -465.5475416224152, -362.0474107869647, -146.66451064501575, -1204.421304351466, -89.1533942532401, -955.334583893705, -471.4655268768001, -670.7971146838249, -1081.0680112627256, -168.61259923282185, -1307.8565944632887, -376.77438644796035, -275.8107435832792, -375.8557813125109, -58.265525379981774, -604.1594997443754, -222.48044320858352, -11.97133578362322, -440.6492252684744, -865.0664469784065, -168.756568497344, -615.7924300157861, -176.60709969051126, -1431.2809692937437, -71.68765488861044, -298.74415914374976, -751.1017291267365, -601.6880473269858, -1031.198124172683, -949.1784736728094, -988.596433752959, 1.6918368141941915, -705.2172725030789, -68.22183382752948, -918.0376506906638, -357.1642223552389, -62.05885776776803, -100.79548928581738, -725.9112717642402, -237.71791662404405, -162.19832684294053, -156.89202358581292, -374.84748106075364, -72.96107920969409, -928.9003130295548], "episode_lengths": [101, 80, 43, 76, 80, 150, 150, 129, 37, 150, 49, 150, 150, 150, 65, 150, 150, 47, 150, 100, 74, 94, 150, 90, 105, 98, 150, 150, 150, 103, 62, 148, 150, 137, 82, 150, 150, 150, 55, 87, 69, 39, 84, 150, 150, 87, 150, 150, 61, 61, 50, 137, 76, 98, 76, 150, 131, 77, 150, 66, 150, 150, 150, 150, 60, 150, 134, 117, 116, 57, 150, 107, 40, 150, 150, 84, 150, 84, 150, 70, 114, 150, 150, 150, 148, 150, 30, 150, 58, 150, 107, 67, 67, 150, 108, 93, 83, 135, 69, 150], "policy_policy_0_reward": [-207.51539999657336, -108.23029161961686, -12.89881736534672, -95.45884315341526, -142.54821305510785, -1074.2035122524649, -768.9364211581628, -367.25949519356607, -7.387896905434929, -1143.8935028081225, -43.84456063725359, -819.9670489041988, -688.1195636006104, -1031.9104231268655, -206.08424253979916, -645.2199098995823, -744.1072896712103, -22.878245997232547, -1265.9818842752923, -226.87277225866066, -148.34221438695522, -228.31086399561863, -880.117250702315, -189.09351691883683, -296.4564947844143, -261.19537588235835, -664.0960647225539, -1363.0590707393287, -942.5895254388777, -209.59376892191548, -96.26577903011218, -412.2755892428874, -1012.4023696551859, -312.69710038864196, -195.95565669303255, -783.1986664973297, -1008.2831592707834, -1154.355433486091, -34.51030560675975, -204.88317102552017, -111.71242131840854, -7.513397641981675, -194.36462724844816, -1020.8198858647295, -993.0095621002927, -202.0657217812897, -1101.7065859745383, -617.1639757592021, -64.1213767781636, -169.74308671974862, -25.171223362824637, -357.8805808540629, -106.15036561040195, -213.87640542960082, -136.70049310700165, -465.5475416224152, -362.0474107869647, -146.66451064501575, -1204.421304351466, -89.1533942532401, -955.334583893705, -471.4655268768001, -670.7971146838249, -1081.0680112627256, -168.61259923282185, -1307.8565944632887, -376.77438644796035, -275.8107435832792, -375.8557813125109, -58.265525379981774, -604.1594997443754, -222.48044320858352, -11.97133578362322, -440.6492252684744, -865.0664469784065, -168.756568497344, -615.7924300157861, -176.60709969051126, -1431.2809692937437, -71.68765488861044, -298.74415914374976, -751.1017291267365, -601.6880473269858, -1031.198124172683, -949.1784736728094, -988.596433752959, 1.6918368141941915, -705.2172725030789, -68.22183382752948, -918.0376506906638, -357.1642223552389, -62.05885776776803, -100.79548928581738, -725.9112717642402, -237.71791662404405, -162.19832684294053, -156.89202358581292, -374.84748106075364, -72.96107920969409, -928.9003130295548]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5537920863842467, "mean_inference_ms": 1.7181778671602315, "mean_action_processing_ms": 0.273870946823533, "mean_env_wait_ms": 3.398030178590435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01216435432434082, "StateBufferConnector_ms": 0.008007287979125977, "ViewRequirementAgentConnector_ms": 0.19394207000732422}, "num_episodes": 37, "episode_return_max": 1.6918368141941915, "episode_return_min": -1431.2809692937437, "episode_return_mean": -474.50864992453046, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.33164864465226, "num_env_steps_trained_throughput_per_sec": 310.33164864465226, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 12549.711, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12549.634, "sample_time_ms": 1128.45, "learn_time_ms": 11356.069, "learn_throughput": 352.235, "synch_weights_time_ms": 64.269}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "training_iteration": 41, "trial_id": "4b94b_00001", "date": "2024-08-05_12-08-57", "timestamp": 1722839937, "time_this_iter_s": 12.900956630706787, "time_total_s": 507.8369174003601, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd01b7be0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 507.8369174003601, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 17.857894736842105, "ram_util_percent": 28.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 121.35202240546545, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.7504909168152759, "policy_loss": -0.010835359482249866, "vf_loss": 0.7552695396045844, "vf_explained_var": 0.9967779835065206, "kl": 0.01608724300940594, "entropy": 1.182522915924589, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "env_runners": {"episode_reward_max": 3.133762506240049, "episode_reward_min": -1431.2809692937437, "episode_reward_mean": -407.7559316906394, "episode_len_mean": 105.36, "episode_media": {}, "episodes_timesteps_total": 10536, "policy_reward_min": {"policy_0": -1431.2809692937437}, "policy_reward_max": {"policy_0": 3.133762506240049}, "policy_reward_mean": {"policy_0": -407.7559316906394}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-204.88317102552017, -111.71242131840854, -7.513397641981675, -194.36462724844816, -1020.8198858647295, -993.0095621002927, -202.0657217812897, -1101.7065859745383, -617.1639757592021, -64.1213767781636, -169.74308671974862, -25.171223362824637, -357.8805808540629, -106.15036561040195, -213.87640542960082, -136.70049310700165, -465.5475416224152, -362.0474107869647, -146.66451064501575, -1204.421304351466, -89.1533942532401, -955.334583893705, -471.4655268768001, -670.7971146838249, -1081.0680112627256, -168.61259923282185, -1307.8565944632887, -376.77438644796035, -275.8107435832792, -375.8557813125109, -58.265525379981774, -604.1594997443754, -222.48044320858352, -11.97133578362322, -440.6492252684744, -865.0664469784065, -168.756568497344, -615.7924300157861, -176.60709969051126, -1431.2809692937437, -71.68765488861044, -298.74415914374976, -751.1017291267365, -601.6880473269858, -1031.198124172683, -949.1784736728094, -988.596433752959, 1.6918368141941915, -705.2172725030789, -68.22183382752948, -918.0376506906638, -357.1642223552389, -62.05885776776803, -100.79548928581738, -725.9112717642402, -237.71791662404405, -162.19832684294053, -156.89202358581292, -374.84748106075364, -72.96107920969409, -928.9003130295548, -1149.2267067953894, -123.17205716816723, -161.64713125477607, -50.59913729307765, -229.61217521441688, -25.48935806557597, -53.68252295522633, -16.39544789392291, -444.0473945886553, -143.68857291773577, -698.0002218824053, -66.94603227640648, -473.29886370822834, -139.87259491668374, -65.97568047274201, -39.054296296073886, -1171.2240281817485, -462.29012937673076, 3.133762506240049, -184.70805389268128, -336.6093634646035, -389.6398676228822, -830.2602397180949, -24.201869402804736, -67.63241904839352, -697.437109623043, -98.01863361883991, -273.04464533917803, -155.90191192757644, -6.6195891999754615, -646.7605344527875, -1083.9062137857907, -35.370523981190814, -244.6175120886731, -533.7735568182738, -514.9346914522483, -944.9748595905195, -157.55230421096147, -403.79222940315805], "episode_lengths": [87, 69, 39, 84, 150, 150, 87, 150, 150, 61, 61, 50, 137, 76, 98, 76, 150, 131, 77, 150, 66, 150, 150, 150, 150, 60, 150, 134, 117, 116, 57, 150, 107, 40, 150, 150, 84, 150, 84, 150, 70, 114, 150, 150, 150, 148, 150, 30, 150, 58, 150, 107, 67, 67, 150, 108, 93, 83, 135, 69, 150, 150, 72, 93, 55, 93, 49, 49, 38, 150, 73, 150, 60, 150, 79, 61, 43, 150, 150, 30, 83, 115, 130, 150, 45, 58, 150, 63, 102, 77, 41, 150, 150, 48, 128, 108, 150, 150, 72, 124], "policy_policy_0_reward": [-204.88317102552017, -111.71242131840854, -7.513397641981675, -194.36462724844816, -1020.8198858647295, -993.0095621002927, -202.0657217812897, -1101.7065859745383, -617.1639757592021, -64.1213767781636, -169.74308671974862, -25.171223362824637, -357.8805808540629, -106.15036561040195, -213.87640542960082, -136.70049310700165, -465.5475416224152, -362.0474107869647, -146.66451064501575, -1204.421304351466, -89.1533942532401, -955.334583893705, -471.4655268768001, -670.7971146838249, -1081.0680112627256, -168.61259923282185, -1307.8565944632887, -376.77438644796035, -275.8107435832792, -375.8557813125109, -58.265525379981774, -604.1594997443754, -222.48044320858352, -11.97133578362322, -440.6492252684744, -865.0664469784065, -168.756568497344, -615.7924300157861, -176.60709969051126, -1431.2809692937437, -71.68765488861044, -298.74415914374976, -751.1017291267365, -601.6880473269858, -1031.198124172683, -949.1784736728094, -988.596433752959, 1.6918368141941915, -705.2172725030789, -68.22183382752948, -918.0376506906638, -357.1642223552389, -62.05885776776803, -100.79548928581738, -725.9112717642402, -237.71791662404405, -162.19832684294053, -156.89202358581292, -374.84748106075364, -72.96107920969409, -928.9003130295548, -1149.2267067953894, -123.17205716816723, -161.64713125477607, -50.59913729307765, -229.61217521441688, -25.48935806557597, -53.68252295522633, -16.39544789392291, -444.0473945886553, -143.68857291773577, -698.0002218824053, -66.94603227640648, -473.29886370822834, -139.87259491668374, -65.97568047274201, -39.054296296073886, -1171.2240281817485, -462.29012937673076, 3.133762506240049, -184.70805389268128, -336.6093634646035, -389.6398676228822, -830.2602397180949, -24.201869402804736, -67.63241904839352, -697.437109623043, -98.01863361883991, -273.04464533917803, -155.90191192757644, -6.6195891999754615, -646.7605344527875, -1083.9062137857907, -35.370523981190814, -244.6175120886731, -533.7735568182738, -514.9346914522483, -944.9748595905195, -157.55230421096147, -403.79222940315805]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5540125312276732, "mean_inference_ms": 1.7155966033505285, "mean_action_processing_ms": 0.2738288652829113, "mean_env_wait_ms": 3.397034203942248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012090921401977539, "StateBufferConnector_ms": 0.008155107498168945, "ViewRequirementAgentConnector_ms": 0.19619965553283691}, "num_episodes": 39, "episode_return_max": 3.133762506240049, "episode_return_min": -1431.2809692937437, "episode_return_mean": -407.7559316906394, "episodes_this_iter": 39}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.4168914898639, "num_env_steps_trained_throughput_per_sec": 311.4168914898639, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 12526.834, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12526.757, "sample_time_ms": 1114.472, "learn_time_ms": 11347.459, "learn_throughput": 352.502, "synch_weights_time_ms": 64.021}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "training_iteration": 42, "trial_id": "4b94b_00001", "date": "2024-08-05_12-09-10", "timestamp": 1722839950, "time_this_iter_s": 12.85906195640564, "time_total_s": 520.6959793567657, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75df2c745750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 520.6959793567657, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 18.09444444444445, "ram_util_percent": 28.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 115.49746151367823, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.7240045790870985, "policy_loss": -0.016731170836525658, "vf_loss": 0.7341316734130184, "vf_explained_var": 0.9988943135986725, "kl": 0.017227554844430445, "entropy": 1.148323284710447, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "env_runners": {"episode_reward_max": 3.133762506240049, "episode_reward_min": -1431.2809692937437, "episode_reward_mean": -442.2973589541307, "episode_len_mean": 109.74, "episode_media": {}, "episodes_timesteps_total": 10974, "policy_reward_min": {"policy_0": -1431.2809692937437}, "policy_reward_max": {"policy_0": 3.133762506240049}, "policy_reward_mean": {"policy_0": -442.2973589541307}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-440.6492252684744, -865.0664469784065, -168.756568497344, -615.7924300157861, -176.60709969051126, -1431.2809692937437, -71.68765488861044, -298.74415914374976, -751.1017291267365, -601.6880473269858, -1031.198124172683, -949.1784736728094, -988.596433752959, 1.6918368141941915, -705.2172725030789, -68.22183382752948, -918.0376506906638, -357.1642223552389, -62.05885776776803, -100.79548928581738, -725.9112717642402, -237.71791662404405, -162.19832684294053, -156.89202358581292, -374.84748106075364, -72.96107920969409, -928.9003130295548, -1149.2267067953894, -123.17205716816723, -161.64713125477607, -50.59913729307765, -229.61217521441688, -25.48935806557597, -53.68252295522633, -16.39544789392291, -444.0473945886553, -143.68857291773577, -698.0002218824053, -66.94603227640648, -473.29886370822834, -139.87259491668374, -65.97568047274201, -39.054296296073886, -1171.2240281817485, -462.29012937673076, 3.133762506240049, -184.70805389268128, -336.6093634646035, -389.6398676228822, -830.2602397180949, -24.201869402804736, -67.63241904839352, -697.437109623043, -98.01863361883991, -273.04464533917803, -155.90191192757644, -6.6195891999754615, -646.7605344527875, -1083.9062137857907, -35.370523981190814, -244.6175120886731, -533.7735568182738, -514.9346914522483, -944.9748595905195, -157.55230421096147, -403.79222940315805, -364.43300634252137, -265.79831369046815, -1280.4248927094504, -722.064740980195, -976.4284387597584, -856.6298087518815, -370.06607970410056, -1169.9048284967023, -227.40708536946408, -238.24627721454524, -371.6156647745676, -410.0707024431085, -16.149098932391663, -725.9917601922909, -43.40633473117687, -997.9644484569009, -196.4688732670472, -112.97624912792507, -1129.6404046350724, -1272.7987052522733, -305.2791168470449, -611.3392997423673, -319.5118148351358, -427.100085461697, -970.7245504630098, -221.8657232188307, -865.5956261697588, -18.400149543192324, -8.364262900455795, -468.65862505601297, -480.1243897747929, -817.5621838305051, -216.16348030601347, -350.13689247725944], "episode_lengths": [150, 150, 84, 150, 84, 150, 70, 114, 150, 150, 150, 148, 150, 30, 150, 58, 150, 107, 67, 67, 150, 108, 93, 83, 135, 69, 150, 150, 72, 93, 55, 93, 49, 49, 38, 150, 73, 150, 60, 150, 79, 61, 43, 150, 150, 30, 83, 115, 130, 150, 45, 58, 150, 63, 102, 77, 41, 150, 150, 48, 128, 108, 150, 150, 72, 124, 128, 95, 150, 150, 150, 150, 117, 150, 108, 102, 147, 130, 42, 150, 51, 150, 85, 74, 150, 150, 118, 150, 122, 119, 150, 92, 150, 47, 42, 150, 131, 150, 104, 114], "policy_policy_0_reward": [-440.6492252684744, -865.0664469784065, -168.756568497344, -615.7924300157861, -176.60709969051126, -1431.2809692937437, -71.68765488861044, -298.74415914374976, -751.1017291267365, -601.6880473269858, -1031.198124172683, -949.1784736728094, -988.596433752959, 1.6918368141941915, -705.2172725030789, -68.22183382752948, -918.0376506906638, -357.1642223552389, -62.05885776776803, -100.79548928581738, -725.9112717642402, -237.71791662404405, -162.19832684294053, -156.89202358581292, -374.84748106075364, -72.96107920969409, -928.9003130295548, -1149.2267067953894, -123.17205716816723, -161.64713125477607, -50.59913729307765, -229.61217521441688, -25.48935806557597, -53.68252295522633, -16.39544789392291, -444.0473945886553, -143.68857291773577, -698.0002218824053, -66.94603227640648, -473.29886370822834, -139.87259491668374, -65.97568047274201, -39.054296296073886, -1171.2240281817485, -462.29012937673076, 3.133762506240049, -184.70805389268128, -336.6093634646035, -389.6398676228822, -830.2602397180949, -24.201869402804736, -67.63241904839352, -697.437109623043, -98.01863361883991, -273.04464533917803, -155.90191192757644, -6.6195891999754615, -646.7605344527875, -1083.9062137857907, -35.370523981190814, -244.6175120886731, -533.7735568182738, -514.9346914522483, -944.9748595905195, -157.55230421096147, -403.79222940315805, -364.43300634252137, -265.79831369046815, -1280.4248927094504, -722.064740980195, -976.4284387597584, -856.6298087518815, -370.06607970410056, -1169.9048284967023, -227.40708536946408, -238.24627721454524, -371.6156647745676, -410.0707024431085, -16.149098932391663, -725.9917601922909, -43.40633473117687, -997.9644484569009, -196.4688732670472, -112.97624912792507, -1129.6404046350724, -1272.7987052522733, -305.2791168470449, -611.3392997423673, -319.5118148351358, -427.100085461697, -970.7245504630098, -221.8657232188307, -865.5956261697588, -18.400149543192324, -8.364262900455795, -468.65862505601297, -480.1243897747929, -817.5621838305051, -216.16348030601347, -350.13689247725944]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5537273579465493, "mean_inference_ms": 1.7163247499066148, "mean_action_processing_ms": 0.27376204771740176, "mean_env_wait_ms": 3.39423602422524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012298345565795898, "StateBufferConnector_ms": 0.008268117904663086, "ViewRequirementAgentConnector_ms": 0.1975114345550537}, "num_episodes": 34, "episode_return_max": 3.133762506240049, "episode_return_min": -1431.2809692937437, "episode_return_mean": -442.2973589541307, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.90657735400197, "num_env_steps_trained_throughput_per_sec": 314.90657735400197, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 12683.122, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12683.045, "sample_time_ms": 1114.032, "learn_time_ms": 11502.324, "learn_throughput": 347.756, "synch_weights_time_ms": 65.886}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "training_iteration": 43, "trial_id": "4b94b_00001", "date": "2024-08-05_12-09-23", "timestamp": 1722839963, "time_this_iter_s": 12.715327978134155, "time_total_s": 533.4113073348999, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd01b7be0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 533.4113073348999, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 18.122222222222224, "ram_util_percent": 28.716666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 155.48056497673193, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.9162659717723727, "policy_loss": -0.010941833685016415, "vf_loss": 0.9203496813774109, "vf_explained_var": 0.9974815633147955, "kl": 0.017722207188489877, "entropy": 1.1168742813169956, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 3.133762506240049, "episode_reward_min": -1340.1321058420613, "episode_reward_mean": -454.6847912596132, "episode_len_mean": 111.69, "episode_media": {}, "episodes_timesteps_total": 11169, "policy_reward_min": {"policy_0": -1340.1321058420613}, "policy_reward_max": {"policy_0": 3.133762506240049}, "policy_reward_mean": {"policy_0": -454.6847912596132}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-444.0473945886553, -143.68857291773577, -698.0002218824053, -66.94603227640648, -473.29886370822834, -139.87259491668374, -65.97568047274201, -39.054296296073886, -1171.2240281817485, -462.29012937673076, 3.133762506240049, -184.70805389268128, -336.6093634646035, -389.6398676228822, -830.2602397180949, -24.201869402804736, -67.63241904839352, -697.437109623043, -98.01863361883991, -273.04464533917803, -155.90191192757644, -6.6195891999754615, -646.7605344527875, -1083.9062137857907, -35.370523981190814, -244.6175120886731, -533.7735568182738, -514.9346914522483, -944.9748595905195, -157.55230421096147, -403.79222940315805, -364.43300634252137, -265.79831369046815, -1280.4248927094504, -722.064740980195, -976.4284387597584, -856.6298087518815, -370.06607970410056, -1169.9048284967023, -227.40708536946408, -238.24627721454524, -371.6156647745676, -410.0707024431085, -16.149098932391663, -725.9917601922909, -43.40633473117687, -997.9644484569009, -196.4688732670472, -112.97624912792507, -1129.6404046350724, -1272.7987052522733, -305.2791168470449, -611.3392997423673, -319.5118148351358, -427.100085461697, -970.7245504630098, -221.8657232188307, -865.5956261697588, -18.400149543192324, -8.364262900455795, -468.65862505601297, -480.1243897747929, -817.5621838305051, -216.16348030601347, -350.13689247725944, -430.0488256450558, -132.1907135139993, -173.1696836792696, -958.4496344186947, -79.1625322018697, -506.5199753926118, -1087.3614735919066, -344.1785448584776, -289.4736917657467, -1325.2809826649952, -307.1581657453434, -58.41937957309701, -1340.1321058420613, -90.44061056183662, -217.16326953603308, -207.6522408083608, -426.46846696637687, -364.6258160102769, -45.84030515161423, -320.8288303649411, -834.6590939997877, -744.6534190247779, -1321.0461916971599, -802.1644244739628, -25.717957103056765, -202.73616755162027, -611.580015655033, -44.00913597883286, -325.1195146741501, -136.30582461253135, -1063.6876984829807, -279.35882288163464, -126.71682642080583, -209.61949700241084, -876.2071928992453], "episode_lengths": [150, 73, 150, 60, 150, 79, 61, 43, 150, 150, 30, 83, 115, 130, 150, 45, 58, 150, 63, 102, 77, 41, 150, 150, 48, 128, 108, 150, 150, 72, 124, 128, 95, 150, 150, 150, 150, 117, 150, 108, 102, 147, 130, 42, 150, 51, 150, 85, 74, 150, 150, 118, 150, 122, 119, 150, 92, 150, 47, 42, 150, 131, 150, 104, 114, 123, 69, 56, 150, 59, 131, 150, 115, 112, 150, 121, 59, 150, 67, 96, 89, 150, 130, 63, 150, 150, 150, 150, 150, 46, 83, 138, 45, 131, 79, 150, 120, 71, 108, 150], "policy_policy_0_reward": [-444.0473945886553, -143.68857291773577, -698.0002218824053, -66.94603227640648, -473.29886370822834, -139.87259491668374, -65.97568047274201, -39.054296296073886, -1171.2240281817485, -462.29012937673076, 3.133762506240049, -184.70805389268128, -336.6093634646035, -389.6398676228822, -830.2602397180949, -24.201869402804736, -67.63241904839352, -697.437109623043, -98.01863361883991, -273.04464533917803, -155.90191192757644, -6.6195891999754615, -646.7605344527875, -1083.9062137857907, -35.370523981190814, -244.6175120886731, -533.7735568182738, -514.9346914522483, -944.9748595905195, -157.55230421096147, -403.79222940315805, -364.43300634252137, -265.79831369046815, -1280.4248927094504, -722.064740980195, -976.4284387597584, -856.6298087518815, -370.06607970410056, -1169.9048284967023, -227.40708536946408, -238.24627721454524, -371.6156647745676, -410.0707024431085, -16.149098932391663, -725.9917601922909, -43.40633473117687, -997.9644484569009, -196.4688732670472, -112.97624912792507, -1129.6404046350724, -1272.7987052522733, -305.2791168470449, -611.3392997423673, -319.5118148351358, -427.100085461697, -970.7245504630098, -221.8657232188307, -865.5956261697588, -18.400149543192324, -8.364262900455795, -468.65862505601297, -480.1243897747929, -817.5621838305051, -216.16348030601347, -350.13689247725944, -430.0488256450558, -132.1907135139993, -173.1696836792696, -958.4496344186947, -79.1625322018697, -506.5199753926118, -1087.3614735919066, -344.1785448584776, -289.4736917657467, -1325.2809826649952, -307.1581657453434, -58.41937957309701, -1340.1321058420613, -90.44061056183662, -217.16326953603308, -207.6522408083608, -426.46846696637687, -364.6258160102769, -45.84030515161423, -320.8288303649411, -834.6590939997877, -744.6534190247779, -1321.0461916971599, -802.1644244739628, -25.717957103056765, -202.73616755162027, -611.580015655033, -44.00913597883286, -325.1195146741501, -136.30582461253135, -1063.6876984829807, -279.35882288163464, -126.71682642080583, -209.61949700241084, -876.2071928992453]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5536576178372264, "mean_inference_ms": 1.7156788326335493, "mean_action_processing_ms": 0.2738678692342838, "mean_env_wait_ms": 3.3946200689066224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01212930679321289, "StateBufferConnector_ms": 0.008223295211791992, "ViewRequirementAgentConnector_ms": 0.1960444450378418}, "num_episodes": 35, "episode_return_max": 3.133762506240049, "episode_return_min": -1340.1321058420613, "episode_return_mean": -454.6847912596132, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.91624174857145, "num_env_steps_trained_throughput_per_sec": 314.91624174857145, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 12635.937, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12635.863, "sample_time_ms": 1115.019, "learn_time_ms": 11454.788, "learn_throughput": 349.199, "synch_weights_time_ms": 65.247}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 44, "trial_id": "4b94b_00001", "date": "2024-08-05_12-09-36", "timestamp": 1722839976, "time_this_iter_s": 12.71349811553955, "time_total_s": 546.1248054504395, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd011a320>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 546.1248054504395, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 17.74736842105263, "ram_util_percent": 28.72631578947368}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 116.02301514446735, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.910163783437262, "policy_loss": -0.016243155960304043, "vf_loss": 0.9189598312911887, "vf_explained_var": 0.9986223921800653, "kl": 0.018771791175314925, "entropy": 1.0001987639814616, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "env_runners": {"episode_reward_max": 2.0815965376746375, "episode_reward_min": -1340.1321058420613, "episode_reward_mean": -448.6516763238611, "episode_len_mean": 107.96, "episode_media": {}, "episodes_timesteps_total": 10796, "policy_reward_min": {"policy_0": -1340.1321058420613}, "policy_reward_max": {"policy_0": 2.0815965376746375}, "policy_reward_mean": {"policy_0": -448.6516763238611}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-410.0707024431085, -16.149098932391663, -725.9917601922909, -43.40633473117687, -997.9644484569009, -196.4688732670472, -112.97624912792507, -1129.6404046350724, -1272.7987052522733, -305.2791168470449, -611.3392997423673, -319.5118148351358, -427.100085461697, -970.7245504630098, -221.8657232188307, -865.5956261697588, -18.400149543192324, -8.364262900455795, -468.65862505601297, -480.1243897747929, -817.5621838305051, -216.16348030601347, -350.13689247725944, -430.0488256450558, -132.1907135139993, -173.1696836792696, -958.4496344186947, -79.1625322018697, -506.5199753926118, -1087.3614735919066, -344.1785448584776, -289.4736917657467, -1325.2809826649952, -307.1581657453434, -58.41937957309701, -1340.1321058420613, -90.44061056183662, -217.16326953603308, -207.6522408083608, -426.46846696637687, -364.6258160102769, -45.84030515161423, -320.8288303649411, -834.6590939997877, -744.6534190247779, -1321.0461916971599, -802.1644244739628, -25.717957103056765, -202.73616755162027, -611.580015655033, -44.00913597883286, -325.1195146741501, -136.30582461253135, -1063.6876984829807, -279.35882288163464, -126.71682642080583, -209.61949700241084, -876.2071928992453, -968.672582894347, -115.23098920761791, -1119.1600367451535, -1151.9798283312941, -951.5091534948061, -100.71343372744039, -250.54903524008003, -45.64960782769049, -44.14256769568237, -38.20737036811528, -570.0797565651334, -66.37488322784174, -22.059636343263875, -94.67308408536574, -144.7376551837765, -18.361932375989948, -1079.3999325832665, 2.0815965376746375, -344.4573832134766, -1006.5006829031857, -130.3669205372571, -64.09768660982328, -57.99032250974064, -674.9345637009882, -42.80818148767181, -804.7446719805641, -491.96990700904485, -52.445955751449894, -959.198639452762, -156.54065391170226, -31.038643883919917, -477.47614615747756, -784.0533739688149, -766.9525818107948, -790.6119604007583, -131.56231694745878, -947.9404323078185, -442.4026895511539, -1308.794723511106, -96.86886336099023, -110.62404553238963, -116.9265881117428], "episode_lengths": [130, 42, 150, 51, 150, 85, 74, 150, 150, 118, 150, 122, 119, 150, 92, 150, 47, 42, 150, 131, 150, 104, 114, 123, 69, 56, 150, 59, 131, 150, 115, 112, 150, 121, 59, 150, 67, 96, 89, 150, 130, 63, 150, 150, 150, 150, 150, 46, 83, 138, 45, 131, 79, 150, 120, 71, 108, 150, 150, 75, 150, 150, 150, 65, 98, 56, 52, 59, 150, 60, 50, 70, 78, 41, 150, 30, 120, 150, 78, 69, 63, 150, 49, 150, 133, 60, 150, 94, 49, 150, 150, 150, 150, 66, 150, 150, 150, 65, 70, 64], "policy_policy_0_reward": [-410.0707024431085, -16.149098932391663, -725.9917601922909, -43.40633473117687, -997.9644484569009, -196.4688732670472, -112.97624912792507, -1129.6404046350724, -1272.7987052522733, -305.2791168470449, -611.3392997423673, -319.5118148351358, -427.100085461697, -970.7245504630098, -221.8657232188307, -865.5956261697588, -18.400149543192324, -8.364262900455795, -468.65862505601297, -480.1243897747929, -817.5621838305051, -216.16348030601347, -350.13689247725944, -430.0488256450558, -132.1907135139993, -173.1696836792696, -958.4496344186947, -79.1625322018697, -506.5199753926118, -1087.3614735919066, -344.1785448584776, -289.4736917657467, -1325.2809826649952, -307.1581657453434, -58.41937957309701, -1340.1321058420613, -90.44061056183662, -217.16326953603308, -207.6522408083608, -426.46846696637687, -364.6258160102769, -45.84030515161423, -320.8288303649411, -834.6590939997877, -744.6534190247779, -1321.0461916971599, -802.1644244739628, -25.717957103056765, -202.73616755162027, -611.580015655033, -44.00913597883286, -325.1195146741501, -136.30582461253135, -1063.6876984829807, -279.35882288163464, -126.71682642080583, -209.61949700241084, -876.2071928992453, -968.672582894347, -115.23098920761791, -1119.1600367451535, -1151.9798283312941, -951.5091534948061, -100.71343372744039, -250.54903524008003, -45.64960782769049, -44.14256769568237, -38.20737036811528, -570.0797565651334, -66.37488322784174, -22.059636343263875, -94.67308408536574, -144.7376551837765, -18.361932375989948, -1079.3999325832665, 2.0815965376746375, -344.4573832134766, -1006.5006829031857, -130.3669205372571, -64.09768660982328, -57.99032250974064, -674.9345637009882, -42.80818148767181, -804.7446719805641, -491.96990700904485, -52.445955751449894, -959.198639452762, -156.54065391170226, -31.038643883919917, -477.47614615747756, -784.0533739688149, -766.9525818107948, -790.6119604007583, -131.56231694745878, -947.9404323078185, -442.4026895511539, -1308.794723511106, -96.86886336099023, -110.62404553238963, -116.9265881117428]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.55375877687515, "mean_inference_ms": 1.7134673010840833, "mean_action_processing_ms": 0.2739366113482983, "mean_env_wait_ms": 3.393179776371483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011887550354003906, "StateBufferConnector_ms": 0.00801706314086914, "ViewRequirementAgentConnector_ms": 0.19327354431152344}, "num_episodes": 42, "episode_return_max": 2.0815965376746375, "episode_return_min": -1340.1321058420613, "episode_return_mean": -448.6516763238611, "episodes_this_iter": 42}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 321.43225471851474, "num_env_steps_trained_throughput_per_sec": 321.43225471851474, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 12605.559, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12605.486, "sample_time_ms": 1104.517, "learn_time_ms": 11432.31, "learn_throughput": 349.886, "synch_weights_time_ms": 67.84}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "training_iteration": 45, "trial_id": "4b94b_00001", "date": "2024-08-05_12-09-48", "timestamp": 1722839988, "time_this_iter_s": 12.456626892089844, "time_total_s": 558.5814323425293, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd01b6440>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 558.5814323425293, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 18.423529411764704, "ram_util_percent": 28.75294117647059}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 107.33449824005365, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.7715023518850406, "policy_loss": -0.01427095881687516, "vf_loss": 0.7820377582373719, "vf_explained_var": 0.991314543907841, "kl": 0.011024710102052875, "entropy": 1.2255699448908368, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "env_runners": {"episode_reward_max": 2.0815965376746375, "episode_reward_min": -1340.1321058420613, "episode_reward_mean": -401.7674707153103, "episode_len_mean": 105.79, "episode_media": {}, "episodes_timesteps_total": 10579, "policy_reward_min": {"policy_0": -1340.1321058420613}, "policy_reward_max": {"policy_0": 2.0815965376746375}, "policy_reward_mean": {"policy_0": -401.7674707153103}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-58.41937957309701, -1340.1321058420613, -90.44061056183662, -217.16326953603308, -207.6522408083608, -426.46846696637687, -364.6258160102769, -45.84030515161423, -320.8288303649411, -834.6590939997877, -744.6534190247779, -1321.0461916971599, -802.1644244739628, -25.717957103056765, -202.73616755162027, -611.580015655033, -44.00913597883286, -325.1195146741501, -136.30582461253135, -1063.6876984829807, -279.35882288163464, -126.71682642080583, -209.61949700241084, -876.2071928992453, -968.672582894347, -115.23098920761791, -1119.1600367451535, -1151.9798283312941, -951.5091534948061, -100.71343372744039, -250.54903524008003, -45.64960782769049, -44.14256769568237, -38.20737036811528, -570.0797565651334, -66.37488322784174, -22.059636343263875, -94.67308408536574, -144.7376551837765, -18.361932375989948, -1079.3999325832665, 2.0815965376746375, -344.4573832134766, -1006.5006829031857, -130.3669205372571, -64.09768660982328, -57.99032250974064, -674.9345637009882, -42.80818148767181, -804.7446719805641, -491.96990700904485, -52.445955751449894, -959.198639452762, -156.54065391170226, -31.038643883919917, -477.47614615747756, -784.0533739688149, -766.9525818107948, -790.6119604007583, -131.56231694745878, -947.9404323078185, -442.4026895511539, -1308.794723511106, -96.86886336099023, -110.62404553238963, -116.9265881117428, -40.695257933310074, -965.9196915534138, -738.9923561916928, -454.9485821598245, -11.1037631969551, -91.69882036958955, -49.02792730298887, -221.25623808486245, -63.98162334202271, -856.9400407522761, -251.00060832122097, -363.2689878862637, -15.813755519562356, 1.3618295897938857, -99.23576831550014, -716.5199323854749, -127.2625629084394, -219.80269284128335, -305.97677626726727, -219.97017291068187, -60.71047750098101, -448.6600058190298, -41.31871905317473, -792.309716601291, -137.4959888624806, -401.2984432811499, -211.5661290341789, -126.66634278926418, -587.759869692899, -389.57311767840855, -542.6184129322388, -386.2808578061066, -786.6233441073472, -1205.9312864757756], "episode_lengths": [59, 150, 67, 96, 89, 150, 130, 63, 150, 150, 150, 150, 150, 46, 83, 138, 45, 131, 79, 150, 120, 71, 108, 150, 150, 75, 150, 150, 150, 65, 98, 56, 52, 59, 150, 60, 50, 70, 78, 41, 150, 30, 120, 150, 78, 69, 63, 150, 49, 150, 133, 60, 150, 94, 49, 150, 150, 150, 150, 66, 150, 150, 150, 65, 70, 64, 63, 150, 150, 150, 40, 75, 57, 88, 57, 150, 106, 139, 47, 36, 77, 150, 75, 103, 122, 110, 61, 140, 55, 138, 90, 150, 94, 89, 150, 143, 150, 135, 150, 150], "policy_policy_0_reward": [-58.41937957309701, -1340.1321058420613, -90.44061056183662, -217.16326953603308, -207.6522408083608, -426.46846696637687, -364.6258160102769, -45.84030515161423, -320.8288303649411, -834.6590939997877, -744.6534190247779, -1321.0461916971599, -802.1644244739628, -25.717957103056765, -202.73616755162027, -611.580015655033, -44.00913597883286, -325.1195146741501, -136.30582461253135, -1063.6876984829807, -279.35882288163464, -126.71682642080583, -209.61949700241084, -876.2071928992453, -968.672582894347, -115.23098920761791, -1119.1600367451535, -1151.9798283312941, -951.5091534948061, -100.71343372744039, -250.54903524008003, -45.64960782769049, -44.14256769568237, -38.20737036811528, -570.0797565651334, -66.37488322784174, -22.059636343263875, -94.67308408536574, -144.7376551837765, -18.361932375989948, -1079.3999325832665, 2.0815965376746375, -344.4573832134766, -1006.5006829031857, -130.3669205372571, -64.09768660982328, -57.99032250974064, -674.9345637009882, -42.80818148767181, -804.7446719805641, -491.96990700904485, -52.445955751449894, -959.198639452762, -156.54065391170226, -31.038643883919917, -477.47614615747756, -784.0533739688149, -766.9525818107948, -790.6119604007583, -131.56231694745878, -947.9404323078185, -442.4026895511539, -1308.794723511106, -96.86886336099023, -110.62404553238963, -116.9265881117428, -40.695257933310074, -965.9196915534138, -738.9923561916928, -454.9485821598245, -11.1037631969551, -91.69882036958955, -49.02792730298887, -221.25623808486245, -63.98162334202271, -856.9400407522761, -251.00060832122097, -363.2689878862637, -15.813755519562356, 1.3618295897938857, -99.23576831550014, -716.5199323854749, -127.2625629084394, -219.80269284128335, -305.97677626726727, -219.97017291068187, -60.71047750098101, -448.6600058190298, -41.31871905317473, -792.309716601291, -137.4959888624806, -401.2984432811499, -211.5661290341789, -126.66634278926418, -587.759869692899, -389.57311767840855, -542.6184129322388, -386.2808578061066, -786.6233441073472, -1205.9312864757756]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5537826479185416, "mean_inference_ms": 1.7126672191081307, "mean_action_processing_ms": 0.27394087239825304, "mean_env_wait_ms": 3.3971271355600696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011609554290771484, "StateBufferConnector_ms": 0.007967710494995117, "ViewRequirementAgentConnector_ms": 0.1933286190032959}, "num_episodes": 34, "episode_return_max": 2.0815965376746375, "episode_return_min": -1340.1321058420613, "episode_return_mean": -401.7674707153103, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.8281386118817, "num_env_steps_trained_throughput_per_sec": 320.8281386118817, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 12640.087, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12640.015, "sample_time_ms": 1103.593, "learn_time_ms": 11468.778, "learn_throughput": 348.773, "synch_weights_time_ms": 66.833}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "training_iteration": 46, "trial_id": "4b94b_00001", "date": "2024-08-05_12-10-01", "timestamp": 1722840001, "time_this_iter_s": 12.480958938598633, "time_total_s": 571.0623912811279, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75df2c744dc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 571.0623912811279, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 18.08888888888889, "ram_util_percent": 28.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 111.6522641936938, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.8364346524390082, "policy_loss": -0.014157285277421276, "vf_loss": 0.8423014846630394, "vf_explained_var": 0.9986093955114483, "kl": 0.020483539438040075, "entropy": 0.9271415972461303, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "env_runners": {"episode_reward_max": 1.3618295897938857, "episode_reward_min": -1473.0678391571203, "episode_reward_mean": -382.32645649139295, "episode_len_mean": 105.46, "episode_media": {}, "episodes_timesteps_total": 10546, "policy_reward_min": {"policy_0": -1473.0678391571203}, "policy_reward_max": {"policy_0": 1.3618295897938857}, "policy_reward_mean": {"policy_0": -382.32645649139295}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1006.5006829031857, -130.3669205372571, -64.09768660982328, -57.99032250974064, -674.9345637009882, -42.80818148767181, -804.7446719805641, -491.96990700904485, -52.445955751449894, -959.198639452762, -156.54065391170226, -31.038643883919917, -477.47614615747756, -784.0533739688149, -766.9525818107948, -790.6119604007583, -131.56231694745878, -947.9404323078185, -442.4026895511539, -1308.794723511106, -96.86886336099023, -110.62404553238963, -116.9265881117428, -40.695257933310074, -965.9196915534138, -738.9923561916928, -454.9485821598245, -11.1037631969551, -91.69882036958955, -49.02792730298887, -221.25623808486245, -63.98162334202271, -856.9400407522761, -251.00060832122097, -363.2689878862637, -15.813755519562356, 1.3618295897938857, -99.23576831550014, -716.5199323854749, -127.2625629084394, -219.80269284128335, -305.97677626726727, -219.97017291068187, -60.71047750098101, -448.6600058190298, -41.31871905317473, -792.309716601291, -137.4959888624806, -401.2984432811499, -211.5661290341789, -126.66634278926418, -587.759869692899, -389.57311767840855, -542.6184129322388, -386.2808578061066, -786.6233441073472, -1205.9312864757756, -962.8946743303181, -388.90185219445783, -770.4067426707418, -9.334896899775854, -140.00954505299305, -295.8411911954662, -770.5848145329267, -104.25579133182272, -145.63860976655695, -147.11827973059516, -23.747824645778522, -340.7899232570642, -692.6899799726068, -460.5817799887606, -846.1565882814764, -967.2965637335008, -288.35154917664937, -44.9554747664045, -532.8857530741129, -146.4062649073433, -35.60810102681572, -554.8452083281969, -2.8611720102781604, -391.30804717034493, -786.4321092370297, -49.924257435737665, -171.55094419319087, -124.688931471481, -119.73613390871425, -103.18631009977477, -42.453637971926916, -218.07151931584508, -566.3041800634226, -50.64692696795181, -159.8544604977311, -97.8853198313573, -166.8972538644286, -885.4787975223115, -1040.480356164819, -68.26861149038585, -629.9074216954567, -36.623018519850234, -1473.0678391571203], "episode_lengths": [150, 78, 69, 63, 150, 49, 150, 133, 60, 150, 94, 49, 150, 150, 150, 150, 66, 150, 150, 150, 65, 70, 64, 63, 150, 150, 150, 40, 75, 57, 88, 57, 150, 106, 139, 47, 36, 77, 150, 75, 103, 122, 110, 61, 140, 55, 138, 90, 150, 94, 89, 150, 143, 150, 135, 150, 150, 150, 150, 150, 39, 92, 118, 150, 69, 78, 69, 47, 134, 150, 150, 150, 150, 105, 59, 150, 78, 56, 150, 32, 129, 150, 64, 81, 76, 63, 61, 50, 112, 150, 58, 89, 65, 78, 150, 150, 60, 150, 34, 150], "policy_policy_0_reward": [-1006.5006829031857, -130.3669205372571, -64.09768660982328, -57.99032250974064, -674.9345637009882, -42.80818148767181, -804.7446719805641, -491.96990700904485, -52.445955751449894, -959.198639452762, -156.54065391170226, -31.038643883919917, -477.47614615747756, -784.0533739688149, -766.9525818107948, -790.6119604007583, -131.56231694745878, -947.9404323078185, -442.4026895511539, -1308.794723511106, -96.86886336099023, -110.62404553238963, -116.9265881117428, -40.695257933310074, -965.9196915534138, -738.9923561916928, -454.9485821598245, -11.1037631969551, -91.69882036958955, -49.02792730298887, -221.25623808486245, -63.98162334202271, -856.9400407522761, -251.00060832122097, -363.2689878862637, -15.813755519562356, 1.3618295897938857, -99.23576831550014, -716.5199323854749, -127.2625629084394, -219.80269284128335, -305.97677626726727, -219.97017291068187, -60.71047750098101, -448.6600058190298, -41.31871905317473, -792.309716601291, -137.4959888624806, -401.2984432811499, -211.5661290341789, -126.66634278926418, -587.759869692899, -389.57311767840855, -542.6184129322388, -386.2808578061066, -786.6233441073472, -1205.9312864757756, -962.8946743303181, -388.90185219445783, -770.4067426707418, -9.334896899775854, -140.00954505299305, -295.8411911954662, -770.5848145329267, -104.25579133182272, -145.63860976655695, -147.11827973059516, -23.747824645778522, -340.7899232570642, -692.6899799726068, -460.5817799887606, -846.1565882814764, -967.2965637335008, -288.35154917664937, -44.9554747664045, -532.8857530741129, -146.4062649073433, -35.60810102681572, -554.8452083281969, -2.8611720102781604, -391.30804717034493, -786.4321092370297, -49.924257435737665, -171.55094419319087, -124.688931471481, -119.73613390871425, -103.18631009977477, -42.453637971926916, -218.07151931584508, -566.3041800634226, -50.64692696795181, -159.8544604977311, -97.8853198313573, -166.8972538644286, -885.4787975223115, -1040.480356164819, -68.26861149038585, -629.9074216954567, -36.623018519850234, -1473.0678391571203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5539421288462358, "mean_inference_ms": 1.7116239101579964, "mean_action_processing_ms": 0.2740003576374938, "mean_env_wait_ms": 3.3975330711262126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011766433715820312, "StateBufferConnector_ms": 0.008026599884033203, "ViewRequirementAgentConnector_ms": 0.19603562355041504}, "num_episodes": 43, "episode_return_max": 1.3618295897938857, "episode_return_min": -1473.0678391571203, "episode_return_mean": -382.32645649139295, "episodes_this_iter": 43}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.8632444568362, "num_env_steps_trained_throughput_per_sec": 318.8632444568362, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 12647.953, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12647.88, "sample_time_ms": 1121.466, "learn_time_ms": 11457.369, "learn_throughput": 349.12, "synch_weights_time_ms": 68.222}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "training_iteration": 47, "trial_id": "4b94b_00001", "date": "2024-08-05_12-10-13", "timestamp": 1722840013, "time_this_iter_s": 12.556607484817505, "time_total_s": 583.6189987659454, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75df2c745bd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 583.6189987659454, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 18.51111111111111, "ram_util_percent": 28.727777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 122.19610343476137, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.8384442307210217, "policy_loss": -0.014760530368463757, "vf_loss": 0.8465061248590549, "vf_explained_var": 0.9963958481947581, "kl": 0.011554928591491868, "entropy": 1.1009412003681063, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": -2.8611720102781604, "episode_reward_min": -1473.0678391571203, "episode_reward_mean": -369.5255090983522, "episode_len_mean": 104.07, "episode_media": {}, "episodes_timesteps_total": 10407, "policy_reward_min": {"policy_0": -1473.0678391571203}, "policy_reward_max": {"policy_0": -2.8611720102781604}, "policy_reward_mean": {"policy_0": -369.5255090983522}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-305.97677626726727, -219.97017291068187, -60.71047750098101, -448.6600058190298, -41.31871905317473, -792.309716601291, -137.4959888624806, -401.2984432811499, -211.5661290341789, -126.66634278926418, -587.759869692899, -389.57311767840855, -542.6184129322388, -386.2808578061066, -786.6233441073472, -1205.9312864757756, -962.8946743303181, -388.90185219445783, -770.4067426707418, -9.334896899775854, -140.00954505299305, -295.8411911954662, -770.5848145329267, -104.25579133182272, -145.63860976655695, -147.11827973059516, -23.747824645778522, -340.7899232570642, -692.6899799726068, -460.5817799887606, -846.1565882814764, -967.2965637335008, -288.35154917664937, -44.9554747664045, -532.8857530741129, -146.4062649073433, -35.60810102681572, -554.8452083281969, -2.8611720102781604, -391.30804717034493, -786.4321092370297, -49.924257435737665, -171.55094419319087, -124.688931471481, -119.73613390871425, -103.18631009977477, -42.453637971926916, -218.07151931584508, -566.3041800634226, -50.64692696795181, -159.8544604977311, -97.8853198313573, -166.8972538644286, -885.4787975223115, -1040.480356164819, -68.26861149038585, -629.9074216954567, -36.623018519850234, -1473.0678391571203, -422.75491946901576, -706.1271951154048, -362.2708605007054, -10.13204776158987, -7.455283284225322, -7.67281010663301, -19.68801997335081, -665.8383247990233, -168.61658617971872, -1013.6266929858446, -119.56683387199159, -32.67488039499656, -41.93974585555205, -187.87407243680283, -743.2564527884363, -1045.1477598332801, -90.03231682884314, -115.15759002546537, -144.22232520346466, -867.5667462817144, -24.746942466014932, -277.0556023151011, -868.4765170628365, -103.07367054104832, -146.92982238189262, -149.0077751627851, -705.562346683459, -284.5258939900682, -72.83146630237373, -130.83729376999383, -96.01224441475081, -58.683470924607676, -550.5141938919406, -875.890084041819, -460.861153883112, -12.01448296065835, -884.3549268722439, -268.80503901107124, -266.19461323680025, -1148.4094925052427, -296.45409545554304], "episode_lengths": [122, 110, 61, 140, 55, 138, 90, 150, 94, 89, 150, 143, 150, 135, 150, 150, 150, 150, 150, 39, 92, 118, 150, 69, 78, 69, 47, 134, 150, 150, 150, 150, 105, 59, 150, 78, 56, 150, 32, 129, 150, 64, 81, 76, 63, 61, 50, 112, 150, 58, 89, 65, 78, 150, 150, 60, 150, 34, 150, 147, 150, 130, 37, 38, 35, 48, 150, 82, 150, 64, 56, 60, 85, 150, 150, 69, 73, 86, 150, 46, 118, 148, 69, 76, 83, 150, 111, 59, 72, 70, 63, 150, 150, 150, 43, 150, 112, 98, 150, 106], "policy_policy_0_reward": [-305.97677626726727, -219.97017291068187, -60.71047750098101, -448.6600058190298, -41.31871905317473, -792.309716601291, -137.4959888624806, -401.2984432811499, -211.5661290341789, -126.66634278926418, -587.759869692899, -389.57311767840855, -542.6184129322388, -386.2808578061066, -786.6233441073472, -1205.9312864757756, -962.8946743303181, -388.90185219445783, -770.4067426707418, -9.334896899775854, -140.00954505299305, -295.8411911954662, -770.5848145329267, -104.25579133182272, -145.63860976655695, -147.11827973059516, -23.747824645778522, -340.7899232570642, -692.6899799726068, -460.5817799887606, -846.1565882814764, -967.2965637335008, -288.35154917664937, -44.9554747664045, -532.8857530741129, -146.4062649073433, -35.60810102681572, -554.8452083281969, -2.8611720102781604, -391.30804717034493, -786.4321092370297, -49.924257435737665, -171.55094419319087, -124.688931471481, -119.73613390871425, -103.18631009977477, -42.453637971926916, -218.07151931584508, -566.3041800634226, -50.64692696795181, -159.8544604977311, -97.8853198313573, -166.8972538644286, -885.4787975223115, -1040.480356164819, -68.26861149038585, -629.9074216954567, -36.623018519850234, -1473.0678391571203, -422.75491946901576, -706.1271951154048, -362.2708605007054, -10.13204776158987, -7.455283284225322, -7.67281010663301, -19.68801997335081, -665.8383247990233, -168.61658617971872, -1013.6266929858446, -119.56683387199159, -32.67488039499656, -41.93974585555205, -187.87407243680283, -743.2564527884363, -1045.1477598332801, -90.03231682884314, -115.15759002546537, -144.22232520346466, -867.5667462817144, -24.746942466014932, -277.0556023151011, -868.4765170628365, -103.07367054104832, -146.92982238189262, -149.0077751627851, -705.562346683459, -284.5258939900682, -72.83146630237373, -130.83729376999383, -96.01224441475081, -58.683470924607676, -550.5141938919406, -875.890084041819, -460.861153883112, -12.01448296065835, -884.3549268722439, -268.80503901107124, -266.19461323680025, -1148.4094925052427, -296.45409545554304]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5538013377026543, "mean_inference_ms": 1.7099130388145085, "mean_action_processing_ms": 0.27374068130260576, "mean_env_wait_ms": 3.393412448090509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012291193008422852, "StateBufferConnector_ms": 0.008189201354980469, "ViewRequirementAgentConnector_ms": 0.19909429550170898}, "num_episodes": 41, "episode_return_max": -2.8611720102781604, "episode_return_min": -1473.0678391571203, "episode_return_mean": -369.5255090983522, "episodes_this_iter": 41}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 390.38961880877014, "num_env_steps_trained_throughput_per_sec": 390.38961880877014, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 12376.428, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12376.353, "sample_time_ms": 1134.894, "learn_time_ms": 11173.477, "learn_throughput": 357.991, "synch_weights_time_ms": 67.159}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 48, "trial_id": "4b94b_00001", "date": "2024-08-05_12-10-24", "timestamp": 1722840024, "time_this_iter_s": 10.257806539535522, "time_total_s": 593.876805305481, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75df2c745ea0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 593.876805305481, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 19.69333333333333, "ram_util_percent": 28.79333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 101.00533581872781, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.6128923621154778, "policy_loss": -0.0195762515955721, "vf_loss": 0.6237488734225433, "vf_explained_var": 0.9992743260537584, "kl": 0.014352793154406148, "entropy": 0.9683956788852811, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "env_runners": {"episode_reward_max": -7.455283284225322, "episode_reward_min": -1473.0678391571203, "episode_reward_mean": -363.86220889790775, "episode_len_mean": 99.36, "episode_media": {}, "episodes_timesteps_total": 9936, "policy_reward_min": {"policy_0": -1473.0678391571203}, "policy_reward_max": {"policy_0": -7.455283284225322}, "policy_reward_mean": {"policy_0": -363.86220889790775}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-786.4321092370297, -49.924257435737665, -171.55094419319087, -124.688931471481, -119.73613390871425, -103.18631009977477, -42.453637971926916, -218.07151931584508, -566.3041800634226, -50.64692696795181, -159.8544604977311, -97.8853198313573, -166.8972538644286, -885.4787975223115, -1040.480356164819, -68.26861149038585, -629.9074216954567, -36.623018519850234, -1473.0678391571203, -422.75491946901576, -706.1271951154048, -362.2708605007054, -10.13204776158987, -7.455283284225322, -7.67281010663301, -19.68801997335081, -665.8383247990233, -168.61658617971872, -1013.6266929858446, -119.56683387199159, -32.67488039499656, -41.93974585555205, -187.87407243680283, -743.2564527884363, -1045.1477598332801, -90.03231682884314, -115.15759002546537, -144.22232520346466, -867.5667462817144, -24.746942466014932, -277.0556023151011, -868.4765170628365, -103.07367054104832, -146.92982238189262, -149.0077751627851, -705.562346683459, -284.5258939900682, -72.83146630237373, -130.83729376999383, -96.01224441475081, -58.683470924607676, -550.5141938919406, -875.890084041819, -460.861153883112, -12.01448296065835, -884.3549268722439, -268.80503901107124, -266.19461323680025, -1148.4094925052427, -296.45409545554304, -245.43124910698583, -38.18036600706805, -558.306823128355, -25.460765125011505, -171.9904792297388, -144.05372240376104, -1109.413927501115, -508.45313504030065, -215.74857522815705, -448.4433947325959, -1185.0200080468603, -64.2905102795182, -141.64617853197475, -1091.12371106985, -258.56288405306776, -236.9749451731231, -275.0912070092667, -326.44198746143246, -169.9094167270013, -25.86098186085825, -1295.9117701823725, -55.35186612127308, -167.52776352754506, -1148.3694988010157, -37.81026870091612, -303.78007900838986, -635.6588186919575, -25.417484569628115, -17.08999528681158, -874.413069343875, -99.34259826542532, -110.33228158484035, -326.03903131858095, -134.9921898191448, -42.59779121731714, -914.6597686655352, -171.83763617013994, -355.7546915128095, -80.9342762430352, -1103.6751220661606], "episode_lengths": [150, 64, 81, 76, 63, 61, 50, 112, 150, 58, 89, 65, 78, 150, 150, 60, 150, 34, 150, 147, 150, 130, 37, 38, 35, 48, 150, 82, 150, 64, 56, 60, 85, 150, 150, 69, 73, 86, 150, 46, 118, 148, 69, 76, 83, 150, 111, 59, 72, 70, 63, 150, 150, 150, 43, 150, 112, 98, 150, 106, 108, 55, 150, 45, 94, 88, 150, 150, 95, 150, 150, 54, 75, 150, 105, 94, 118, 101, 85, 51, 150, 61, 105, 150, 53, 124, 150, 49, 39, 150, 75, 69, 103, 75, 54, 150, 87, 136, 63, 150], "policy_policy_0_reward": [-786.4321092370297, -49.924257435737665, -171.55094419319087, -124.688931471481, -119.73613390871425, -103.18631009977477, -42.453637971926916, -218.07151931584508, -566.3041800634226, -50.64692696795181, -159.8544604977311, -97.8853198313573, -166.8972538644286, -885.4787975223115, -1040.480356164819, -68.26861149038585, -629.9074216954567, -36.623018519850234, -1473.0678391571203, -422.75491946901576, -706.1271951154048, -362.2708605007054, -10.13204776158987, -7.455283284225322, -7.67281010663301, -19.68801997335081, -665.8383247990233, -168.61658617971872, -1013.6266929858446, -119.56683387199159, -32.67488039499656, -41.93974585555205, -187.87407243680283, -743.2564527884363, -1045.1477598332801, -90.03231682884314, -115.15759002546537, -144.22232520346466, -867.5667462817144, -24.746942466014932, -277.0556023151011, -868.4765170628365, -103.07367054104832, -146.92982238189262, -149.0077751627851, -705.562346683459, -284.5258939900682, -72.83146630237373, -130.83729376999383, -96.01224441475081, -58.683470924607676, -550.5141938919406, -875.890084041819, -460.861153883112, -12.01448296065835, -884.3549268722439, -268.80503901107124, -266.19461323680025, -1148.4094925052427, -296.45409545554304, -245.43124910698583, -38.18036600706805, -558.306823128355, -25.460765125011505, -171.9904792297388, -144.05372240376104, -1109.413927501115, -508.45313504030065, -215.74857522815705, -448.4433947325959, -1185.0200080468603, -64.2905102795182, -141.64617853197475, -1091.12371106985, -258.56288405306776, -236.9749451731231, -275.0912070092667, -326.44198746143246, -169.9094167270013, -25.86098186085825, -1295.9117701823725, -55.35186612127308, -167.52776352754506, -1148.3694988010157, -37.81026870091612, -303.78007900838986, -635.6588186919575, -25.417484569628115, -17.08999528681158, -874.413069343875, -99.34259826542532, -110.33228158484035, -326.03903131858095, -134.9921898191448, -42.59779121731714, -914.6597686655352, -171.83763617013994, -355.7546915128095, -80.9342762430352, -1103.6751220661606]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.554689861860966, "mean_inference_ms": 1.7087399005561759, "mean_action_processing_ms": 0.2739710714239223, "mean_env_wait_ms": 3.3934944933810676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011875152587890625, "StateBufferConnector_ms": 0.00806117057800293, "ViewRequirementAgentConnector_ms": 0.20562744140625}, "num_episodes": 40, "episode_return_max": -7.455283284225322, "episode_return_min": -1473.0678391571203, "episode_return_mean": -363.86220889790775, "episodes_this_iter": 40}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 501.92208523578563, "num_env_steps_trained_throughput_per_sec": 501.92208523578563, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 11898.443, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11898.369, "sample_time_ms": 1141.345, "learn_time_ms": 10690.611, "learn_throughput": 374.16, "synch_weights_time_ms": 65.595}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "training_iteration": 49, "trial_id": "4b94b_00001", "date": "2024-08-05_12-10-32", "timestamp": 1722840032, "time_this_iter_s": 7.980538845062256, "time_total_s": 601.8573441505432, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd01b6290>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 601.8573441505432, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 23.099999999999998, "ram_util_percent": 28.745454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 114.11982987324397, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9542361933893214, "policy_loss": -0.0084434726498633, "vf_loss": 0.9573169908486306, "vf_explained_var": 0.9914032061273853, "kl": 0.009627220246814767, "entropy": 1.135698103470107, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": -12.01448296065835, "episode_reward_min": -1295.9117701823725, "episode_reward_mean": -401.5785135794327, "episode_len_mean": 105.37, "episode_media": {}, "episodes_timesteps_total": 10537, "policy_reward_min": {"policy_0": -1295.9117701823725}, "policy_reward_max": {"policy_0": -12.01448296065835}, "policy_reward_mean": {"policy_0": -401.5785135794327}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115.15759002546537, -144.22232520346466, -867.5667462817144, -24.746942466014932, -277.0556023151011, -868.4765170628365, -103.07367054104832, -146.92982238189262, -149.0077751627851, -705.562346683459, -284.5258939900682, -72.83146630237373, -130.83729376999383, -96.01224441475081, -58.683470924607676, -550.5141938919406, -875.890084041819, -460.861153883112, -12.01448296065835, -884.3549268722439, -268.80503901107124, -266.19461323680025, -1148.4094925052427, -296.45409545554304, -245.43124910698583, -38.18036600706805, -558.306823128355, -25.460765125011505, -171.9904792297388, -144.05372240376104, -1109.413927501115, -508.45313504030065, -215.74857522815705, -448.4433947325959, -1185.0200080468603, -64.2905102795182, -141.64617853197475, -1091.12371106985, -258.56288405306776, -236.9749451731231, -275.0912070092667, -326.44198746143246, -169.9094167270013, -25.86098186085825, -1295.9117701823725, -55.35186612127308, -167.52776352754506, -1148.3694988010157, -37.81026870091612, -303.78007900838986, -635.6588186919575, -25.417484569628115, -17.08999528681158, -874.413069343875, -99.34259826542532, -110.33228158484035, -326.03903131858095, -134.9921898191448, -42.59779121731714, -914.6597686655352, -171.83763617013994, -355.7546915128095, -80.9342762430352, -1103.6751220661606, -1187.9012201434443, -996.3988053020265, -61.7715982848923, -253.32008588521177, -1051.66252050073, -640.5995210178564, -733.6386847508725, -307.3090580965119, -204.38253624060607, -1252.408542563228, -572.8360393008142, -239.97010851587495, -302.77045586928244, -169.87402069899665, -868.8804183391943, -160.95784411060032, -156.97807143173344, -421.1281586897269, -618.0134817383591, -487.31578801096344, -998.3850971520397, -219.9355504937129, -169.50143836625202, -18.62054351630968, -222.96766979433536, -1058.102443863255, -148.0239474634928, -36.79144082426884, -551.3076956245797, -352.4917863885004, -721.8344163915649, -39.86858340436281, -237.9235659276112, -259.80470825097916, -53.36154908186074, -430.72590371239437], "episode_lengths": [73, 86, 150, 46, 118, 148, 69, 76, 83, 150, 111, 59, 72, 70, 63, 150, 150, 150, 43, 150, 112, 98, 150, 106, 108, 55, 150, 45, 94, 88, 150, 150, 95, 150, 150, 54, 75, 150, 105, 94, 118, 101, 85, 51, 150, 61, 105, 150, 53, 124, 150, 49, 39, 150, 75, 69, 103, 75, 54, 150, 87, 136, 63, 150, 150, 150, 67, 121, 150, 150, 150, 104, 88, 150, 150, 91, 118, 82, 150, 72, 81, 150, 150, 150, 150, 108, 77, 43, 95, 150, 74, 49, 109, 114, 150, 49, 102, 95, 59, 95], "policy_policy_0_reward": [-115.15759002546537, -144.22232520346466, -867.5667462817144, -24.746942466014932, -277.0556023151011, -868.4765170628365, -103.07367054104832, -146.92982238189262, -149.0077751627851, -705.562346683459, -284.5258939900682, -72.83146630237373, -130.83729376999383, -96.01224441475081, -58.683470924607676, -550.5141938919406, -875.890084041819, -460.861153883112, -12.01448296065835, -884.3549268722439, -268.80503901107124, -266.19461323680025, -1148.4094925052427, -296.45409545554304, -245.43124910698583, -38.18036600706805, -558.306823128355, -25.460765125011505, -171.9904792297388, -144.05372240376104, -1109.413927501115, -508.45313504030065, -215.74857522815705, -448.4433947325959, -1185.0200080468603, -64.2905102795182, -141.64617853197475, -1091.12371106985, -258.56288405306776, -236.9749451731231, -275.0912070092667, -326.44198746143246, -169.9094167270013, -25.86098186085825, -1295.9117701823725, -55.35186612127308, -167.52776352754506, -1148.3694988010157, -37.81026870091612, -303.78007900838986, -635.6588186919575, -25.417484569628115, -17.08999528681158, -874.413069343875, -99.34259826542532, -110.33228158484035, -326.03903131858095, -134.9921898191448, -42.59779121731714, -914.6597686655352, -171.83763617013994, -355.7546915128095, -80.9342762430352, -1103.6751220661606, -1187.9012201434443, -996.3988053020265, -61.7715982848923, -253.32008588521177, -1051.66252050073, -640.5995210178564, -733.6386847508725, -307.3090580965119, -204.38253624060607, -1252.408542563228, -572.8360393008142, -239.97010851587495, -302.77045586928244, -169.87402069899665, -868.8804183391943, -160.95784411060032, -156.97807143173344, -421.1281586897269, -618.0134817383591, -487.31578801096344, -998.3850971520397, -219.9355504937129, -169.50143836625202, -18.62054351630968, -222.96766979433536, -1058.102443863255, -148.0239474634928, -36.79144082426884, -551.3076956245797, -352.4917863885004, -721.8344163915649, -39.86858340436281, -237.9235659276112, -259.80470825097916, -53.36154908186074, -430.72590371239437]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5548811894568445, "mean_inference_ms": 1.7111263305961735, "mean_action_processing_ms": 0.2742167941719583, "mean_env_wait_ms": 3.394811410123999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012063741683959961, "StateBufferConnector_ms": 0.007941961288452148, "ViewRequirementAgentConnector_ms": 0.20348191261291504}, "num_episodes": 36, "episode_return_max": -12.01448296065835, "episode_return_min": -1295.9117701823725, "episode_return_mean": -401.5785135794327, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 455.344267534559, "num_env_steps_trained_throughput_per_sec": 455.344267534559, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 11559.476, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11559.403, "sample_time_ms": 1142.451, "learn_time_ms": 10352.626, "learn_throughput": 386.375, "synch_weights_time_ms": 63.52}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "training_iteration": 50, "trial_id": "4b94b_00001", "date": "2024-08-05_12-10-41", "timestamp": 1722840041, "time_this_iter_s": 8.795514822006226, "time_total_s": 610.6528589725494, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd01b55a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 610.6528589725494, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 20.63076923076923, "ram_util_percent": 28.792307692307688}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 113.52223414182663, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.8390337011932085, "policy_loss": -0.01883797362728122, "vf_loss": 0.8500532400173445, "vf_explained_var": 0.9983176973337928, "kl": 0.013102904899521187, "entropy": 1.026028250840803, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 48480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "env_runners": {"episode_reward_max": -3.959595009919802, "episode_reward_min": -1295.9117701823725, "episode_reward_mean": -370.9532720586334, "episode_len_mean": 102.11, "episode_media": {}, "episodes_timesteps_total": 10211, "policy_reward_min": {"policy_0": -1295.9117701823725}, "policy_reward_max": {"policy_0": -3.959595009919802}, "policy_reward_mean": {"policy_0": -370.9532720586334}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-236.9749451731231, -275.0912070092667, -326.44198746143246, -169.9094167270013, -25.86098186085825, -1295.9117701823725, -55.35186612127308, -167.52776352754506, -1148.3694988010157, -37.81026870091612, -303.78007900838986, -635.6588186919575, -25.417484569628115, -17.08999528681158, -874.413069343875, -99.34259826542532, -110.33228158484035, -326.03903131858095, -134.9921898191448, -42.59779121731714, -914.6597686655352, -171.83763617013994, -355.7546915128095, -80.9342762430352, -1103.6751220661606, -1187.9012201434443, -996.3988053020265, -61.7715982848923, -253.32008588521177, -1051.66252050073, -640.5995210178564, -733.6386847508725, -307.3090580965119, -204.38253624060607, -1252.408542563228, -572.8360393008142, -239.97010851587495, -302.77045586928244, -169.87402069899665, -868.8804183391943, -160.95784411060032, -156.97807143173344, -421.1281586897269, -618.0134817383591, -487.31578801096344, -998.3850971520397, -219.9355504937129, -169.50143836625202, -18.62054351630968, -222.96766979433536, -1058.102443863255, -148.0239474634928, -36.79144082426884, -551.3076956245797, -352.4917863885004, -721.8344163915649, -39.86858340436281, -237.9235659276112, -259.80470825097916, -53.36154908186074, -430.72590371239437, -950.8448120180473, -104.82899090774478, -268.50457826720344, -298.2947805503273, -96.67637330771979, -48.77917501874622, -303.6667538744945, -213.5643315204245, -1216.2993973661921, -64.2553529098946, -117.04303783332898, -371.8362635296712, -471.6866664259996, -618.6848297738857, -645.1621639781381, -3.959595009919802, -252.42875083418738, -103.83409683818407, -508.9903646309399, -151.7902198703822, -350.1172946014542, -155.70776548047095, -412.62214755025184, -124.62268979268444, -1086.8908742467577, -1025.7251841106072, -436.85600352465866, -35.10372497331623, -27.128978743130077, -66.21333771143746, -71.61164759497026, -150.25692685762135, -463.6224550408845, -102.69419038213319, -301.7039892971511, -15.32406251867232, -31.73234671510355, -71.29993568162438, -211.42527750007548], "episode_lengths": [94, 118, 101, 85, 51, 150, 61, 105, 150, 53, 124, 150, 49, 39, 150, 75, 69, 103, 75, 54, 150, 87, 136, 63, 150, 150, 150, 67, 121, 150, 150, 150, 104, 88, 150, 150, 91, 118, 82, 150, 72, 81, 150, 150, 150, 150, 108, 77, 43, 95, 150, 74, 49, 109, 114, 150, 49, 102, 95, 59, 95, 150, 69, 128, 83, 63, 63, 110, 90, 150, 58, 70, 150, 129, 149, 150, 33, 95, 69, 150, 84, 147, 82, 150, 73, 150, 150, 150, 51, 50, 55, 63, 75, 106, 67, 122, 38, 48, 65, 91], "policy_policy_0_reward": [-236.9749451731231, -275.0912070092667, -326.44198746143246, -169.9094167270013, -25.86098186085825, -1295.9117701823725, -55.35186612127308, -167.52776352754506, -1148.3694988010157, -37.81026870091612, -303.78007900838986, -635.6588186919575, -25.417484569628115, -17.08999528681158, -874.413069343875, -99.34259826542532, -110.33228158484035, -326.03903131858095, -134.9921898191448, -42.59779121731714, -914.6597686655352, -171.83763617013994, -355.7546915128095, -80.9342762430352, -1103.6751220661606, -1187.9012201434443, -996.3988053020265, -61.7715982848923, -253.32008588521177, -1051.66252050073, -640.5995210178564, -733.6386847508725, -307.3090580965119, -204.38253624060607, -1252.408542563228, -572.8360393008142, -239.97010851587495, -302.77045586928244, -169.87402069899665, -868.8804183391943, -160.95784411060032, -156.97807143173344, -421.1281586897269, -618.0134817383591, -487.31578801096344, -998.3850971520397, -219.9355504937129, -169.50143836625202, -18.62054351630968, -222.96766979433536, -1058.102443863255, -148.0239474634928, -36.79144082426884, -551.3076956245797, -352.4917863885004, -721.8344163915649, -39.86858340436281, -237.9235659276112, -259.80470825097916, -53.36154908186074, -430.72590371239437, -950.8448120180473, -104.82899090774478, -268.50457826720344, -298.2947805503273, -96.67637330771979, -48.77917501874622, -303.6667538744945, -213.5643315204245, -1216.2993973661921, -64.2553529098946, -117.04303783332898, -371.8362635296712, -471.6866664259996, -618.6848297738857, -645.1621639781381, -3.959595009919802, -252.42875083418738, -103.83409683818407, -508.9903646309399, -151.7902198703822, -350.1172946014542, -155.70776548047095, -412.62214755025184, -124.62268979268444, -1086.8908742467577, -1025.7251841106072, -436.85600352465866, -35.10372497331623, -27.128978743130077, -66.21333771143746, -71.61164759497026, -150.25692685762135, -463.6224550408845, -102.69419038213319, -301.7039892971511, -15.32406251867232, -31.73234671510355, -71.29993568162438, -211.42527750007548]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5554569845323947, "mean_inference_ms": 1.710148475047336, "mean_action_processing_ms": 0.2742863741729769, "mean_env_wait_ms": 3.395261915437106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01202082633972168, "StateBufferConnector_ms": 0.007856369018554688, "ViewRequirementAgentConnector_ms": 0.20161223411560059}, "num_episodes": 39, "episode_return_max": -3.959595009919802, "episode_return_min": -1295.9117701823725, "episode_return_mean": -370.9532720586334, "episodes_this_iter": 39}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.8824504624076, "num_env_steps_trained_throughput_per_sec": 306.8824504624076, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 11573.963, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11573.889, "sample_time_ms": 1146.808, "learn_time_ms": 10360.028, "learn_throughput": 386.099, "synch_weights_time_ms": 66.231}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "training_iteration": 51, "trial_id": "4b94b_00001", "date": "2024-08-05_12-10-54", "timestamp": 1722840054, "time_this_iter_s": 13.047420024871826, "time_total_s": 623.7002789974213, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd011ab90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 623.7002789974213, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 18.266666666666666, "ram_util_percent": 28.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 124.60166977445284, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.7209671372082085, "policy_loss": -0.013230034709946874, "vf_loss": 0.7256454506888985, "vf_explained_var": 0.9979620069886247, "kl": 0.014328177780741195, "entropy": 1.1197981055205066, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 49440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 4.342259147179007, "episode_reward_min": -1410.0667014052717, "episode_reward_mean": -355.9822144924133, "episode_len_mean": 100.02, "episode_media": {}, "episodes_timesteps_total": 10002, "policy_reward_min": {"policy_0": -1410.0667014052717}, "policy_reward_max": {"policy_0": 4.342259147179007}, "policy_reward_mean": {"policy_0": -355.9822144924133}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-169.87402069899665, -868.8804183391943, -160.95784411060032, -156.97807143173344, -421.1281586897269, -618.0134817383591, -487.31578801096344, -998.3850971520397, -219.9355504937129, -169.50143836625202, -18.62054351630968, -222.96766979433536, -1058.102443863255, -148.0239474634928, -36.79144082426884, -551.3076956245797, -352.4917863885004, -721.8344163915649, -39.86858340436281, -237.9235659276112, -259.80470825097916, -53.36154908186074, -430.72590371239437, -950.8448120180473, -104.82899090774478, -268.50457826720344, -298.2947805503273, -96.67637330771979, -48.77917501874622, -303.6667538744945, -213.5643315204245, -1216.2993973661921, -64.2553529098946, -117.04303783332898, -371.8362635296712, -471.6866664259996, -618.6848297738857, -645.1621639781381, -3.959595009919802, -252.42875083418738, -103.83409683818407, -508.9903646309399, -151.7902198703822, -350.1172946014542, -155.70776548047095, -412.62214755025184, -124.62268979268444, -1086.8908742467577, -1025.7251841106072, -436.85600352465866, -35.10372497331623, -27.128978743130077, -66.21333771143746, -71.61164759497026, -150.25692685762135, -463.6224550408845, -102.69419038213319, -301.7039892971511, -15.32406251867232, -31.73234671510355, -71.29993568162438, -211.42527750007548, -698.4654142083518, -208.0661324892594, -229.8222804387706, -61.06807362277628, -395.42943892518593, 4.342259147179007, -1137.9763995351798, -292.2695675475447, -410.60707119756836, -311.8136334692787, -103.98507251634672, -1060.5121153360265, -753.4085792484912, -162.2448734015801, -1234.347901941325, -46.10784237947585, -45.29025240180156, -402.51742861550395, -1071.872166393789, -1039.7527832246374, -107.52140241113729, -110.22108646486174, -63.06919725408279, -24.741711884406524, -14.856563240468544, -21.981078102750487, -256.90281831796744, -630.6616170014088, -139.11966160817786, -113.99390395245197, -179.22331180742998, -250.84702726982687, -846.8198435580396, -522.107551267331, -814.3080358127845, -1.535846915602606, -1410.0667014052717, -74.44583315807178], "episode_lengths": [82, 150, 72, 81, 150, 150, 150, 150, 108, 77, 43, 95, 150, 74, 49, 109, 114, 150, 49, 102, 95, 59, 95, 150, 69, 128, 83, 63, 63, 110, 90, 150, 58, 70, 150, 129, 149, 150, 33, 95, 69, 150, 84, 147, 82, 150, 73, 150, 150, 150, 51, 50, 55, 63, 75, 106, 67, 122, 38, 48, 65, 91, 150, 102, 107, 68, 150, 30, 150, 100, 138, 87, 67, 150, 150, 81, 150, 62, 60, 140, 150, 150, 68, 69, 70, 42, 45, 40, 115, 123, 75, 72, 87, 118, 150, 150, 150, 37, 150, 69], "policy_policy_0_reward": [-169.87402069899665, -868.8804183391943, -160.95784411060032, -156.97807143173344, -421.1281586897269, -618.0134817383591, -487.31578801096344, -998.3850971520397, -219.9355504937129, -169.50143836625202, -18.62054351630968, -222.96766979433536, -1058.102443863255, -148.0239474634928, -36.79144082426884, -551.3076956245797, -352.4917863885004, -721.8344163915649, -39.86858340436281, -237.9235659276112, -259.80470825097916, -53.36154908186074, -430.72590371239437, -950.8448120180473, -104.82899090774478, -268.50457826720344, -298.2947805503273, -96.67637330771979, -48.77917501874622, -303.6667538744945, -213.5643315204245, -1216.2993973661921, -64.2553529098946, -117.04303783332898, -371.8362635296712, -471.6866664259996, -618.6848297738857, -645.1621639781381, -3.959595009919802, -252.42875083418738, -103.83409683818407, -508.9903646309399, -151.7902198703822, -350.1172946014542, -155.70776548047095, -412.62214755025184, -124.62268979268444, -1086.8908742467577, -1025.7251841106072, -436.85600352465866, -35.10372497331623, -27.128978743130077, -66.21333771143746, -71.61164759497026, -150.25692685762135, -463.6224550408845, -102.69419038213319, -301.7039892971511, -15.32406251867232, -31.73234671510355, -71.29993568162438, -211.42527750007548, -698.4654142083518, -208.0661324892594, -229.8222804387706, -61.06807362277628, -395.42943892518593, 4.342259147179007, -1137.9763995351798, -292.2695675475447, -410.60707119756836, -311.8136334692787, -103.98507251634672, -1060.5121153360265, -753.4085792484912, -162.2448734015801, -1234.347901941325, -46.10784237947585, -45.29025240180156, -402.51742861550395, -1071.872166393789, -1039.7527832246374, -107.52140241113729, -110.22108646486174, -63.06919725408279, -24.741711884406524, -14.856563240468544, -21.981078102750487, -256.90281831796744, -630.6616170014088, -139.11966160817786, -113.99390395245197, -179.22331180742998, -250.84702726982687, -846.8198435580396, -522.107551267331, -814.3080358127845, -1.535846915602606, -1410.0667014052717, -74.44583315807178]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5551375520673935, "mean_inference_ms": 1.7077628529313384, "mean_action_processing_ms": 0.27394954158230306, "mean_env_wait_ms": 3.392458551847746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01237344741821289, "StateBufferConnector_ms": 0.007933855056762695, "ViewRequirementAgentConnector_ms": 0.19051671028137207}, "num_episodes": 38, "episode_return_max": 4.342259147179007, "episode_return_min": -1410.0667014052717, "episode_return_mean": -355.9822144924133, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.21198790061715, "num_env_steps_trained_throughput_per_sec": 309.21198790061715, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 11583.123, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11583.046, "sample_time_ms": 1144.175, "learn_time_ms": 10372.682, "learn_throughput": 385.628, "synch_weights_time_ms": 65.316}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 52, "trial_id": "4b94b_00001", "date": "2024-08-05_12-11-07", "timestamp": 1722840067, "time_this_iter_s": 12.95114016532898, "time_total_s": 636.6514191627502, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd01b6290>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 636.6514191627502, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 17.74736842105263, "ram_util_percent": 28.715789473684207}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 105.6952900648117, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.770783961218937, "policy_loss": -0.013170545953713978, "vf_loss": 0.7749285783153027, "vf_explained_var": 0.9982320021217068, "kl": 0.01467875262819689, "entropy": 0.8822290300702055, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 50400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "env_runners": {"episode_reward_max": 4.342259147179007, "episode_reward_min": -1410.0667014052717, "episode_reward_mean": -386.33939910439375, "episode_len_mean": 103.73, "episode_media": {}, "episodes_timesteps_total": 10373, "policy_reward_min": {"policy_0": -1410.0667014052717}, "policy_reward_max": {"policy_0": 4.342259147179007}, "policy_reward_mean": {"policy_0": -386.33939910439375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-618.6848297738857, -645.1621639781381, -3.959595009919802, -252.42875083418738, -103.83409683818407, -508.9903646309399, -151.7902198703822, -350.1172946014542, -155.70776548047095, -412.62214755025184, -124.62268979268444, -1086.8908742467577, -1025.7251841106072, -436.85600352465866, -35.10372497331623, -27.128978743130077, -66.21333771143746, -71.61164759497026, -150.25692685762135, -463.6224550408845, -102.69419038213319, -301.7039892971511, -15.32406251867232, -31.73234671510355, -71.29993568162438, -211.42527750007548, -698.4654142083518, -208.0661324892594, -229.8222804387706, -61.06807362277628, -395.42943892518593, 4.342259147179007, -1137.9763995351798, -292.2695675475447, -410.60707119756836, -311.8136334692787, -103.98507251634672, -1060.5121153360265, -753.4085792484912, -162.2448734015801, -1234.347901941325, -46.10784237947585, -45.29025240180156, -402.51742861550395, -1071.872166393789, -1039.7527832246374, -107.52140241113729, -110.22108646486174, -63.06919725408279, -24.741711884406524, -14.856563240468544, -21.981078102750487, -256.90281831796744, -630.6616170014088, -139.11966160817786, -113.99390395245197, -179.22331180742998, -250.84702726982687, -846.8198435580396, -522.107551267331, -814.3080358127845, -1.535846915602606, -1410.0667014052717, -74.44583315807178, -1330.4511524378756, -988.6553549946957, -233.2073989357678, -1108.2102651779412, -461.35145574951326, -130.59485243078865, -343.9629440936405, -1017.8447654802379, -120.0928522824399, -397.1556021860826, -342.9496641083721, -54.927677888556076, -804.0926725459415, -159.2417385314248, -269.59896357462316, -302.51333918855755, -219.78676604660936, -241.4456440030349, -232.11131760485813, -95.80283475710935, -329.55308885586743, -468.61960370244344, -48.392596251075794, -245.44822010722484, -99.50981730600779, -55.16570136075264, -770.8418273048111, -38.82708491972008, -771.0264343306045, -1278.1283849348147, -1144.851640192865, -261.44915244904973, -28.87872529368969, -373.05180714116045, -848.7773258282269, -348.27442600657], "episode_lengths": [149, 150, 33, 95, 69, 150, 84, 147, 82, 150, 73, 150, 150, 150, 51, 50, 55, 63, 75, 106, 67, 122, 38, 48, 65, 91, 150, 102, 107, 68, 150, 30, 150, 100, 138, 87, 67, 150, 150, 81, 150, 62, 60, 140, 150, 150, 68, 69, 70, 42, 45, 40, 115, 123, 75, 72, 87, 118, 150, 150, 150, 37, 150, 69, 150, 150, 102, 150, 150, 86, 135, 150, 72, 117, 113, 52, 150, 83, 150, 150, 93, 100, 98, 67, 121, 105, 46, 109, 72, 51, 150, 47, 150, 150, 150, 104, 48, 150, 150, 117], "policy_policy_0_reward": [-618.6848297738857, -645.1621639781381, -3.959595009919802, -252.42875083418738, -103.83409683818407, -508.9903646309399, -151.7902198703822, -350.1172946014542, -155.70776548047095, -412.62214755025184, -124.62268979268444, -1086.8908742467577, -1025.7251841106072, -436.85600352465866, -35.10372497331623, -27.128978743130077, -66.21333771143746, -71.61164759497026, -150.25692685762135, -463.6224550408845, -102.69419038213319, -301.7039892971511, -15.32406251867232, -31.73234671510355, -71.29993568162438, -211.42527750007548, -698.4654142083518, -208.0661324892594, -229.8222804387706, -61.06807362277628, -395.42943892518593, 4.342259147179007, -1137.9763995351798, -292.2695675475447, -410.60707119756836, -311.8136334692787, -103.98507251634672, -1060.5121153360265, -753.4085792484912, -162.2448734015801, -1234.347901941325, -46.10784237947585, -45.29025240180156, -402.51742861550395, -1071.872166393789, -1039.7527832246374, -107.52140241113729, -110.22108646486174, -63.06919725408279, -24.741711884406524, -14.856563240468544, -21.981078102750487, -256.90281831796744, -630.6616170014088, -139.11966160817786, -113.99390395245197, -179.22331180742998, -250.84702726982687, -846.8198435580396, -522.107551267331, -814.3080358127845, -1.535846915602606, -1410.0667014052717, -74.44583315807178, -1330.4511524378756, -988.6553549946957, -233.2073989357678, -1108.2102651779412, -461.35145574951326, -130.59485243078865, -343.9629440936405, -1017.8447654802379, -120.0928522824399, -397.1556021860826, -342.9496641083721, -54.927677888556076, -804.0926725459415, -159.2417385314248, -269.59896357462316, -302.51333918855755, -219.78676604660936, -241.4456440030349, -232.11131760485813, -95.80283475710935, -329.55308885586743, -468.61960370244344, -48.392596251075794, -245.44822010722484, -99.50981730600779, -55.16570136075264, -770.8418273048111, -38.82708491972008, -771.0264343306045, -1278.1283849348147, -1144.851640192865, -261.44915244904973, -28.87872529368969, -373.05180714116045, -848.7773258282269, -348.27442600657]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5552124803852739, "mean_inference_ms": 1.7071154208803765, "mean_action_processing_ms": 0.2743029463209011, "mean_env_wait_ms": 3.3935597401472224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012064456939697266, "StateBufferConnector_ms": 0.008196830749511719, "ViewRequirementAgentConnector_ms": 0.19341707229614258}, "num_episodes": 36, "episode_return_max": 4.342259147179007, "episode_return_min": -1410.0667014052717, "episode_return_mean": -386.33939910439375, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.47503198938165, "num_env_steps_trained_throughput_per_sec": 313.47503198938165, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 212000, "timers": {"training_iteration_time_ms": 11588.924, "restore_workers_time_ms": 0.033, "training_step_time_ms": 11588.843, "sample_time_ms": 1142.217, "learn_time_ms": 10381.849, "learn_throughput": 385.288, "synch_weights_time_ms": 63.897}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "done": false, "training_iteration": 53, "trial_id": "4b94b_00001", "date": "2024-08-05_12-11-20", "timestamp": 1722840080, "time_this_iter_s": 12.772275447845459, "time_total_s": 649.4236946105957, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd01b55a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 649.4236946105957, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 17.816666666666666, "ram_util_percent": 28.727777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 104.95431176175674, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.8287173997455587, "policy_loss": -0.015273666237771977, "vf_loss": 0.835740874769787, "vf_explained_var": 0.9975152661403021, "kl": 0.01366326234722995, "entropy": 0.9725078099717697, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 51360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "env_runners": {"episode_reward_max": 4.010625575679828, "episode_reward_min": -1410.0667014052717, "episode_reward_mean": -386.2168545694604, "episode_len_mean": 106.14, "episode_media": {}, "episodes_timesteps_total": 10614, "policy_reward_min": {"policy_0": -1410.0667014052717}, "policy_reward_max": {"policy_0": 4.010625575679828}, "policy_reward_mean": {"policy_0": -386.2168545694604}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-753.4085792484912, -162.2448734015801, -1234.347901941325, -46.10784237947585, -45.29025240180156, -402.51742861550395, -1071.872166393789, -1039.7527832246374, -107.52140241113729, -110.22108646486174, -63.06919725408279, -24.741711884406524, -14.856563240468544, -21.981078102750487, -256.90281831796744, -630.6616170014088, -139.11966160817786, -113.99390395245197, -179.22331180742998, -250.84702726982687, -846.8198435580396, -522.107551267331, -814.3080358127845, -1.535846915602606, -1410.0667014052717, -74.44583315807178, -1330.4511524378756, -988.6553549946957, -233.2073989357678, -1108.2102651779412, -461.35145574951326, -130.59485243078865, -343.9629440936405, -1017.8447654802379, -120.0928522824399, -397.1556021860826, -342.9496641083721, -54.927677888556076, -804.0926725459415, -159.2417385314248, -269.59896357462316, -302.51333918855755, -219.78676604660936, -241.4456440030349, -232.11131760485813, -95.80283475710935, -329.55308885586743, -468.61960370244344, -48.392596251075794, -245.44822010722484, -99.50981730600779, -55.16570136075264, -770.8418273048111, -38.82708491972008, -771.0264343306045, -1278.1283849348147, -1144.851640192865, -261.44915244904973, -28.87872529368969, -373.05180714116045, -848.7773258282269, -348.27442600657, -453.249232787815, -124.55842211500601, -1005.6075873381951, -423.9933465646793, -169.4700229335095, -233.7660912111106, -991.264055166814, -78.905742760202, -326.8610571415528, -362.60487276381645, -782.8775082224706, -413.7307332690312, -399.29246048605086, -1114.874689908572, -253.092849306387, -332.32060541043984, -39.956963923960885, -257.7858254302581, -419.5205149188443, -197.05048033970786, 4.010625575679828, -20.422203881456646, -36.11054681301933, -871.4547879593106, -207.46174281371572, -17.9588999906548, -236.91195138048693, -172.95344026456456, -268.6862291944816, -166.38060772698813, -368.4158192871793, -597.5594397128425, 3.7834813597272547, -189.81511524703325, -220.49685758054656, -148.90558535041427, -295.37475021033356, -127.03040742835948], "episode_lengths": [150, 81, 150, 62, 60, 140, 150, 150, 68, 69, 70, 42, 45, 40, 115, 123, 75, 72, 87, 118, 150, 150, 150, 37, 150, 69, 150, 150, 102, 150, 150, 86, 135, 150, 72, 117, 113, 52, 150, 83, 150, 150, 93, 100, 98, 67, 121, 105, 46, 109, 72, 51, 150, 47, 150, 150, 150, 104, 48, 150, 150, 117, 150, 73, 150, 150, 99, 98, 150, 58, 106, 145, 150, 95, 128, 150, 94, 150, 59, 102, 150, 150, 30, 48, 54, 150, 85, 46, 98, 79, 150, 89, 150, 150, 31, 99, 101, 68, 95, 73], "policy_policy_0_reward": [-753.4085792484912, -162.2448734015801, -1234.347901941325, -46.10784237947585, -45.29025240180156, -402.51742861550395, -1071.872166393789, -1039.7527832246374, -107.52140241113729, -110.22108646486174, -63.06919725408279, -24.741711884406524, -14.856563240468544, -21.981078102750487, -256.90281831796744, -630.6616170014088, -139.11966160817786, -113.99390395245197, -179.22331180742998, -250.84702726982687, -846.8198435580396, -522.107551267331, -814.3080358127845, -1.535846915602606, -1410.0667014052717, -74.44583315807178, -1330.4511524378756, -988.6553549946957, -233.2073989357678, -1108.2102651779412, -461.35145574951326, -130.59485243078865, -343.9629440936405, -1017.8447654802379, -120.0928522824399, -397.1556021860826, -342.9496641083721, -54.927677888556076, -804.0926725459415, -159.2417385314248, -269.59896357462316, -302.51333918855755, -219.78676604660936, -241.4456440030349, -232.11131760485813, -95.80283475710935, -329.55308885586743, -468.61960370244344, -48.392596251075794, -245.44822010722484, -99.50981730600779, -55.16570136075264, -770.8418273048111, -38.82708491972008, -771.0264343306045, -1278.1283849348147, -1144.851640192865, -261.44915244904973, -28.87872529368969, -373.05180714116045, -848.7773258282269, -348.27442600657, -453.249232787815, -124.55842211500601, -1005.6075873381951, -423.9933465646793, -169.4700229335095, -233.7660912111106, -991.264055166814, -78.905742760202, -326.8610571415528, -362.60487276381645, -782.8775082224706, -413.7307332690312, -399.29246048605086, -1114.874689908572, -253.092849306387, -332.32060541043984, -39.956963923960885, -257.7858254302581, -419.5205149188443, -197.05048033970786, 4.010625575679828, -20.422203881456646, -36.11054681301933, -871.4547879593106, -207.46174281371572, -17.9588999906548, -236.91195138048693, -172.95344026456456, -268.6862291944816, -166.38060772698813, -368.4158192871793, -597.5594397128425, 3.7834813597272547, -189.81511524703325, -220.49685758054656, -148.90558535041427, -295.37475021033356, -127.03040742835948]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5556309154389965, "mean_inference_ms": 1.705562215443435, "mean_action_processing_ms": 0.27423012377999223, "mean_env_wait_ms": 3.3941459752954857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012221336364746094, "StateBufferConnector_ms": 0.008176088333129883, "ViewRequirementAgentConnector_ms": 0.19968605041503906}, "num_episodes": 38, "episode_return_max": 4.010625575679828, "episode_return_min": -1410.0667014052717, "episode_return_mean": -386.2168545694604, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.78743980080304, "num_env_steps_trained_throughput_per_sec": 306.78743980080304, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 11622.58, "restore_workers_time_ms": 0.036, "training_step_time_ms": 11622.493, "sample_time_ms": 1153.451, "learn_time_ms": 10404.494, "learn_throughput": 384.449, "synch_weights_time_ms": 63.665}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "training_iteration": 54, "trial_id": "4b94b_00001", "date": "2024-08-05_12-11-33", "timestamp": 1722840093, "time_this_iter_s": 13.05132794380188, "time_total_s": 662.4750225543976, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75df2c746dd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 662.4750225543976, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 18.31111111111111, "ram_util_percent": 28.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 135.67731785476207, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9330321471517284, "policy_loss": -0.009595765052654314, "vf_loss": 0.9342386895790696, "vf_explained_var": 0.997706925868988, "kl": 0.014039386704947294, "entropy": 1.0873646158725023, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 52320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "env_runners": {"episode_reward_max": 4.010625575679828, "episode_reward_min": -1322.716052758578, "episode_reward_mean": -357.8384515924605, "episode_len_mean": 101.19, "episode_media": {}, "episodes_timesteps_total": 10119, "policy_reward_min": {"policy_0": -1322.716052758578}, "policy_reward_max": {"policy_0": 4.010625575679828}, "policy_reward_mean": {"policy_0": -357.8384515924605}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-302.51333918855755, -219.78676604660936, -241.4456440030349, -232.11131760485813, -95.80283475710935, -329.55308885586743, -468.61960370244344, -48.392596251075794, -245.44822010722484, -99.50981730600779, -55.16570136075264, -770.8418273048111, -38.82708491972008, -771.0264343306045, -1278.1283849348147, -1144.851640192865, -261.44915244904973, -28.87872529368969, -373.05180714116045, -848.7773258282269, -348.27442600657, -453.249232787815, -124.55842211500601, -1005.6075873381951, -423.9933465646793, -169.4700229335095, -233.7660912111106, -991.264055166814, -78.905742760202, -326.8610571415528, -362.60487276381645, -782.8775082224706, -413.7307332690312, -399.29246048605086, -1114.874689908572, -253.092849306387, -332.32060541043984, -39.956963923960885, -257.7858254302581, -419.5205149188443, -197.05048033970786, 4.010625575679828, -20.422203881456646, -36.11054681301933, -871.4547879593106, -207.46174281371572, -17.9588999906548, -236.91195138048693, -172.95344026456456, -268.6862291944816, -166.38060772698813, -368.4158192871793, -597.5594397128425, 3.7834813597272547, -189.81511524703325, -220.49685758054656, -148.90558535041427, -295.37475021033356, -127.03040742835948, -260.216879054802, -149.10558574597084, -196.08940075434052, -19.90056303084843, -956.4596468319393, -48.50907232319102, -1116.6390465132174, -57.47912557397552, -311.9044261407007, -94.55103115794566, -182.3171871538213, -93.9655131400349, -409.8944266968367, -69.26818522693765, -175.22702406045363, -100.05478675323846, -104.0239831903845, -36.88512114266192, -192.35149515779926, -1190.6940769072119, -1322.716052758578, -49.48086729696467, -154.65556549306788, -752.0186982979333, -171.16999676650403, -470.31560476063737, -170.69362247310974, -72.46768334937808, -986.9015396079046, -254.0902961709965, -293.70239962560265, -1073.8847225973695, -24.378235085887756, -145.7685078522744, -1076.2783976449793, -812.1741363111416, 3.6373092775238227, -322.8493404134422, -1109.5657317157481, -190.3532341806429, -47.09818207564596], "episode_lengths": [150, 93, 100, 98, 67, 121, 105, 46, 109, 72, 51, 150, 47, 150, 150, 150, 104, 48, 150, 150, 117, 150, 73, 150, 150, 99, 98, 150, 58, 106, 145, 150, 95, 128, 150, 94, 150, 59, 102, 150, 150, 30, 48, 54, 150, 85, 46, 98, 79, 150, 89, 150, 150, 31, 99, 101, 68, 95, 73, 102, 78, 91, 41, 150, 55, 150, 53, 143, 50, 61, 66, 91, 61, 71, 65, 67, 45, 106, 150, 150, 61, 89, 150, 74, 140, 81, 58, 150, 102, 108, 150, 49, 55, 150, 150, 38, 133, 150, 93, 61], "policy_policy_0_reward": [-302.51333918855755, -219.78676604660936, -241.4456440030349, -232.11131760485813, -95.80283475710935, -329.55308885586743, -468.61960370244344, -48.392596251075794, -245.44822010722484, -99.50981730600779, -55.16570136075264, -770.8418273048111, -38.82708491972008, -771.0264343306045, -1278.1283849348147, -1144.851640192865, -261.44915244904973, -28.87872529368969, -373.05180714116045, -848.7773258282269, -348.27442600657, -453.249232787815, -124.55842211500601, -1005.6075873381951, -423.9933465646793, -169.4700229335095, -233.7660912111106, -991.264055166814, -78.905742760202, -326.8610571415528, -362.60487276381645, -782.8775082224706, -413.7307332690312, -399.29246048605086, -1114.874689908572, -253.092849306387, -332.32060541043984, -39.956963923960885, -257.7858254302581, -419.5205149188443, -197.05048033970786, 4.010625575679828, -20.422203881456646, -36.11054681301933, -871.4547879593106, -207.46174281371572, -17.9588999906548, -236.91195138048693, -172.95344026456456, -268.6862291944816, -166.38060772698813, -368.4158192871793, -597.5594397128425, 3.7834813597272547, -189.81511524703325, -220.49685758054656, -148.90558535041427, -295.37475021033356, -127.03040742835948, -260.216879054802, -149.10558574597084, -196.08940075434052, -19.90056303084843, -956.4596468319393, -48.50907232319102, -1116.6390465132174, -57.47912557397552, -311.9044261407007, -94.55103115794566, -182.3171871538213, -93.9655131400349, -409.8944266968367, -69.26818522693765, -175.22702406045363, -100.05478675323846, -104.0239831903845, -36.88512114266192, -192.35149515779926, -1190.6940769072119, -1322.716052758578, -49.48086729696467, -154.65556549306788, -752.0186982979333, -171.16999676650403, -470.31560476063737, -170.69362247310974, -72.46768334937808, -986.9015396079046, -254.0902961709965, -293.70239962560265, -1073.8847225973695, -24.378235085887756, -145.7685078522744, -1076.2783976449793, -812.1741363111416, 3.6373092775238227, -322.8493404134422, -1109.5657317157481, -190.3532341806429, -47.09818207564596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5556131071868433, "mean_inference_ms": 1.7055527632692817, "mean_action_processing_ms": 0.27406562672551993, "mean_env_wait_ms": 3.3948311901472374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012410879135131836, "StateBufferConnector_ms": 0.008364677429199219, "ViewRequirementAgentConnector_ms": 0.20774126052856445}, "num_episodes": 41, "episode_return_max": 4.010625575679828, "episode_return_min": -1322.716052758578, "episode_return_mean": -357.8384515924605, "episodes_this_iter": 41}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 334.38697991156766, "num_env_steps_trained_throughput_per_sec": 334.38697991156766, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 11574.369, "restore_workers_time_ms": 0.036, "training_step_time_ms": 11574.283, "sample_time_ms": 1153.535, "learn_time_ms": 10358.695, "learn_throughput": 386.149, "synch_weights_time_ms": 61.18}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "done": false, "training_iteration": 55, "trial_id": "4b94b_00001", "date": "2024-08-05_12-11-45", "timestamp": 1722840105, "time_this_iter_s": 11.974332571029663, "time_total_s": 674.4493551254272, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75df2c7470a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 674.4493551254272, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 18.15, "ram_util_percent": 28.783333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 136.1057637919982, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9251317632539818, "policy_loss": -0.016557100024268342, "vf_loss": 0.933945982499669, "vf_explained_var": 0.9981225398058693, "kl": 0.01321127727254255, "entropy": 1.1747281736383834, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 53280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 4.010625575679828, "episode_reward_min": -1322.716052758578, "episode_reward_mean": -380.03995766412794, "episode_len_mean": 101.14, "episode_media": {}, "episodes_timesteps_total": 10114, "policy_reward_min": {"policy_0": -1322.716052758578}, "policy_reward_max": {"policy_0": 4.010625575679828}, "policy_reward_mean": {"policy_0": -380.03995766412794}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-253.092849306387, -332.32060541043984, -39.956963923960885, -257.7858254302581, -419.5205149188443, -197.05048033970786, 4.010625575679828, -20.422203881456646, -36.11054681301933, -871.4547879593106, -207.46174281371572, -17.9588999906548, -236.91195138048693, -172.95344026456456, -268.6862291944816, -166.38060772698813, -368.4158192871793, -597.5594397128425, 3.7834813597272547, -189.81511524703325, -220.49685758054656, -148.90558535041427, -295.37475021033356, -127.03040742835948, -260.216879054802, -149.10558574597084, -196.08940075434052, -19.90056303084843, -956.4596468319393, -48.50907232319102, -1116.6390465132174, -57.47912557397552, -311.9044261407007, -94.55103115794566, -182.3171871538213, -93.9655131400349, -409.8944266968367, -69.26818522693765, -175.22702406045363, -100.05478675323846, -104.0239831903845, -36.88512114266192, -192.35149515779926, -1190.6940769072119, -1322.716052758578, -49.48086729696467, -154.65556549306788, -752.0186982979333, -171.16999676650403, -470.31560476063737, -170.69362247310974, -72.46768334937808, -986.9015396079046, -254.0902961709965, -293.70239962560265, -1073.8847225973695, -24.378235085887756, -145.7685078522744, -1076.2783976449793, -812.1741363111416, 3.6373092775238227, -322.8493404134422, -1109.5657317157481, -190.3532341806429, -47.09818207564596, -151.2760919397165, -613.1684266956904, -359.43647113452766, -163.01794592056828, -585.2821565868338, -1078.6033701821032, -932.2822911689648, -998.2644274776052, -7.01188835728534, -159.19865731511678, -19.675599642084766, -446.9240129502891, -1000.6710842107009, -284.8167870577661, -1106.6337307261117, -540.0753073860499, -442.3928574876216, -18.699396681451184, -1141.8452495598076, -82.9242005673602, -611.7523219351514, -53.83467008227089, -230.23797881813036, -218.1348609228865, -295.1802999415705, -275.53158657067775, -1305.3210666745056, -1172.6218507944998, -822.1439479527919, -1051.150351913293, -507.0180832983083, -68.9838534830743, -154.49328234543216, -20.817838502198807, -384.2402211381703], "episode_lengths": [94, 150, 59, 102, 150, 150, 30, 48, 54, 150, 85, 46, 98, 79, 150, 89, 150, 150, 31, 99, 101, 68, 95, 73, 102, 78, 91, 41, 150, 55, 150, 53, 143, 50, 61, 66, 91, 61, 71, 65, 67, 45, 106, 150, 150, 61, 89, 150, 74, 140, 81, 58, 150, 102, 108, 150, 49, 55, 150, 150, 38, 133, 150, 93, 61, 72, 150, 150, 79, 150, 150, 150, 150, 39, 85, 38, 109, 150, 100, 150, 150, 148, 39, 150, 62, 150, 63, 83, 108, 100, 102, 150, 150, 150, 150, 134, 65, 58, 41, 150], "policy_policy_0_reward": [-253.092849306387, -332.32060541043984, -39.956963923960885, -257.7858254302581, -419.5205149188443, -197.05048033970786, 4.010625575679828, -20.422203881456646, -36.11054681301933, -871.4547879593106, -207.46174281371572, -17.9588999906548, -236.91195138048693, -172.95344026456456, -268.6862291944816, -166.38060772698813, -368.4158192871793, -597.5594397128425, 3.7834813597272547, -189.81511524703325, -220.49685758054656, -148.90558535041427, -295.37475021033356, -127.03040742835948, -260.216879054802, -149.10558574597084, -196.08940075434052, -19.90056303084843, -956.4596468319393, -48.50907232319102, -1116.6390465132174, -57.47912557397552, -311.9044261407007, -94.55103115794566, -182.3171871538213, -93.9655131400349, -409.8944266968367, -69.26818522693765, -175.22702406045363, -100.05478675323846, -104.0239831903845, -36.88512114266192, -192.35149515779926, -1190.6940769072119, -1322.716052758578, -49.48086729696467, -154.65556549306788, -752.0186982979333, -171.16999676650403, -470.31560476063737, -170.69362247310974, -72.46768334937808, -986.9015396079046, -254.0902961709965, -293.70239962560265, -1073.8847225973695, -24.378235085887756, -145.7685078522744, -1076.2783976449793, -812.1741363111416, 3.6373092775238227, -322.8493404134422, -1109.5657317157481, -190.3532341806429, -47.09818207564596, -151.2760919397165, -613.1684266956904, -359.43647113452766, -163.01794592056828, -585.2821565868338, -1078.6033701821032, -932.2822911689648, -998.2644274776052, -7.01188835728534, -159.19865731511678, -19.675599642084766, -446.9240129502891, -1000.6710842107009, -284.8167870577661, -1106.6337307261117, -540.0753073860499, -442.3928574876216, -18.699396681451184, -1141.8452495598076, -82.9242005673602, -611.7523219351514, -53.83467008227089, -230.23797881813036, -218.1348609228865, -295.1802999415705, -275.53158657067775, -1305.3210666745056, -1172.6218507944998, -822.1439479527919, -1051.150351913293, -507.0180832983083, -68.9838534830743, -154.49328234543216, -20.817838502198807, -384.2402211381703]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5555468963294382, "mean_inference_ms": 1.7037548555238629, "mean_action_processing_ms": 0.27366913697837203, "mean_env_wait_ms": 3.3917827847975905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012563467025756836, "StateBufferConnector_ms": 0.008130073547363281, "ViewRequirementAgentConnector_ms": 0.20246601104736328}, "num_episodes": 35, "episode_return_max": 4.010625575679828, "episode_return_min": -1322.716052758578, "episode_return_mean": -380.03995766412794, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.11546625284905, "num_env_steps_trained_throughput_per_sec": 315.11546625284905, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 11596.971, "restore_workers_time_ms": 0.036, "training_step_time_ms": 11596.885, "sample_time_ms": 1151.716, "learn_time_ms": 10382.109, "learn_throughput": 385.278, "synch_weights_time_ms": 62.185}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 56, "trial_id": "4b94b_00001", "date": "2024-08-05_12-11-57", "timestamp": 1722840117, "time_this_iter_s": 12.706361055374146, "time_total_s": 687.1557161808014, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd011a5f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 687.1557161808014, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 18.0, "ram_util_percent": 28.705555555555552}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 100.32646095653375, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.8190762335744997, "policy_loss": -0.017196518090592385, "vf_loss": 0.8276594538241625, "vf_explained_var": 0.9984247798720995, "kl": 0.014332659568268997, "entropy": 1.061245945406457, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 54240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "env_runners": {"episode_reward_max": 3.6373092775238227, "episode_reward_min": -1322.716052758578, "episode_reward_mean": -433.0854441517407, "episode_len_mean": 106.58, "episode_media": {}, "episodes_timesteps_total": 10658, "policy_reward_min": {"policy_0": -1322.716052758578}, "policy_reward_max": {"policy_0": 3.6373092775238227}, "policy_reward_mean": {"policy_0": -433.0854441517407}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1322.716052758578, -49.48086729696467, -154.65556549306788, -752.0186982979333, -171.16999676650403, -470.31560476063737, -170.69362247310974, -72.46768334937808, -986.9015396079046, -254.0902961709965, -293.70239962560265, -1073.8847225973695, -24.378235085887756, -145.7685078522744, -1076.2783976449793, -812.1741363111416, 3.6373092775238227, -322.8493404134422, -1109.5657317157481, -190.3532341806429, -47.09818207564596, -151.2760919397165, -613.1684266956904, -359.43647113452766, -163.01794592056828, -585.2821565868338, -1078.6033701821032, -932.2822911689648, -998.2644274776052, -7.01188835728534, -159.19865731511678, -19.675599642084766, -446.9240129502891, -1000.6710842107009, -284.8167870577661, -1106.6337307261117, -540.0753073860499, -442.3928574876216, -18.699396681451184, -1141.8452495598076, -82.9242005673602, -611.7523219351514, -53.83467008227089, -230.23797881813036, -218.1348609228865, -295.1802999415705, -275.53158657067775, -1305.3210666745056, -1172.6218507944998, -822.1439479527919, -1051.150351913293, -507.0180832983083, -68.9838534830743, -154.49328234543216, -20.817838502198807, -384.2402211381703, -163.36158782311662, -190.9483694276483, -550.4542184683413, -161.99537596586788, -644.0087130441202, -124.32280822283934, -1101.3909705285535, -207.1777930289191, -185.57465634645544, -25.807938387978595, -668.2221822576251, -183.33380045882762, -30.927746804674538, -38.671039504951324, -963.5634325350705, -114.9755651887266, -605.7816689910275, -1113.1932337423116, -632.4795857110307, -561.2715291194928, -5.956837827938975, -1149.3930916777801, -175.14520002272803, -10.872863836938448, -59.56545072727501, -259.4883636954759, -182.61660564188074, -175.40389470802197, -50.63073377000771, -109.51540577932154, -92.31978170039521, -809.0816646674019, -1184.1924631925217, -573.8773628189185, -155.74054823346933, -313.4250910073329, -186.09661809662268, -83.0130118166765, -163.8234288634314, -1159.6325798850505, -609.575665530656, -486.7220624335352, -21.371103380699676, -223.0346976815227], "episode_lengths": [150, 61, 89, 150, 74, 140, 81, 58, 150, 102, 108, 150, 49, 55, 150, 150, 38, 133, 150, 93, 61, 72, 150, 150, 79, 150, 150, 150, 150, 39, 85, 38, 109, 150, 100, 150, 150, 148, 39, 150, 62, 150, 63, 83, 108, 100, 102, 150, 150, 150, 150, 134, 65, 58, 41, 150, 89, 88, 150, 93, 150, 92, 150, 108, 88, 54, 150, 82, 54, 49, 150, 72, 150, 150, 150, 150, 39, 150, 91, 33, 65, 150, 101, 83, 60, 69, 65, 150, 150, 150, 62, 78, 66, 70, 83, 150, 150, 150, 52, 105], "policy_policy_0_reward": [-1322.716052758578, -49.48086729696467, -154.65556549306788, -752.0186982979333, -171.16999676650403, -470.31560476063737, -170.69362247310974, -72.46768334937808, -986.9015396079046, -254.0902961709965, -293.70239962560265, -1073.8847225973695, -24.378235085887756, -145.7685078522744, -1076.2783976449793, -812.1741363111416, 3.6373092775238227, -322.8493404134422, -1109.5657317157481, -190.3532341806429, -47.09818207564596, -151.2760919397165, -613.1684266956904, -359.43647113452766, -163.01794592056828, -585.2821565868338, -1078.6033701821032, -932.2822911689648, -998.2644274776052, -7.01188835728534, -159.19865731511678, -19.675599642084766, -446.9240129502891, -1000.6710842107009, -284.8167870577661, -1106.6337307261117, -540.0753073860499, -442.3928574876216, -18.699396681451184, -1141.8452495598076, -82.9242005673602, -611.7523219351514, -53.83467008227089, -230.23797881813036, -218.1348609228865, -295.1802999415705, -275.53158657067775, -1305.3210666745056, -1172.6218507944998, -822.1439479527919, -1051.150351913293, -507.0180832983083, -68.9838534830743, -154.49328234543216, -20.817838502198807, -384.2402211381703, -163.36158782311662, -190.9483694276483, -550.4542184683413, -161.99537596586788, -644.0087130441202, -124.32280822283934, -1101.3909705285535, -207.1777930289191, -185.57465634645544, -25.807938387978595, -668.2221822576251, -183.33380045882762, -30.927746804674538, -38.671039504951324, -963.5634325350705, -114.9755651887266, -605.7816689910275, -1113.1932337423116, -632.4795857110307, -561.2715291194928, -5.956837827938975, -1149.3930916777801, -175.14520002272803, -10.872863836938448, -59.56545072727501, -259.4883636954759, -182.61660564188074, -175.40389470802197, -50.63073377000771, -109.51540577932154, -92.31978170039521, -809.0816646674019, -1184.1924631925217, -573.8773628189185, -155.74054823346933, -313.4250910073329, -186.09661809662268, -83.0130118166765, -163.8234288634314, -1159.6325798850505, -609.575665530656, -486.7220624335352, -21.371103380699676, -223.0346976815227]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5550389341025203, "mean_inference_ms": 1.7042732258463786, "mean_action_processing_ms": 0.2738380564737939, "mean_env_wait_ms": 3.3918907588297005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012058019638061523, "StateBufferConnector_ms": 0.008083105087280273, "ViewRequirementAgentConnector_ms": 0.20246481895446777}, "num_episodes": 44, "episode_return_max": 3.6373092775238227, "episode_return_min": -1322.716052758578, "episode_return_mean": -433.0854441517407, "episodes_this_iter": 44}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.49478170702804, "num_env_steps_trained_throughput_per_sec": 314.49478170702804, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 11614.396, "restore_workers_time_ms": 0.036, "training_step_time_ms": 11614.31, "sample_time_ms": 1137.826, "learn_time_ms": 10414.836, "learn_throughput": 384.067, "synch_weights_time_ms": 60.738}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "training_iteration": 57, "trial_id": "4b94b_00001", "date": "2024-08-05_12-12-10", "timestamp": 1722840130, "time_this_iter_s": 12.730738162994385, "time_total_s": 699.8864543437958, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd011a200>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 699.8864543437958, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 18.12222222222222, "ram_util_percent": 28.76666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 113.75008255243301, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.8042929408450922, "policy_loss": -0.008526944475306664, "vf_loss": 0.8060293164725105, "vf_explained_var": 0.9962086839601397, "kl": 0.01141525914111605, "entropy": 0.914733114403983, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 55200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "env_runners": {"episode_reward_max": 2.2033402405889126, "episode_reward_min": -1305.3210666745056, "episode_reward_mean": -389.250775769934, "episode_len_mean": 104.82, "episode_media": {}, "episodes_timesteps_total": 10482, "policy_reward_min": {"policy_0": -1305.3210666745056}, "policy_reward_max": {"policy_0": 2.2033402405889126}, "policy_reward_mean": {"policy_0": -389.250775769934}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-540.0753073860499, -442.3928574876216, -18.699396681451184, -1141.8452495598076, -82.9242005673602, -611.7523219351514, -53.83467008227089, -230.23797881813036, -218.1348609228865, -295.1802999415705, -275.53158657067775, -1305.3210666745056, -1172.6218507944998, -822.1439479527919, -1051.150351913293, -507.0180832983083, -68.9838534830743, -154.49328234543216, -20.817838502198807, -384.2402211381703, -163.36158782311662, -190.9483694276483, -550.4542184683413, -161.99537596586788, -644.0087130441202, -124.32280822283934, -1101.3909705285535, -207.1777930289191, -185.57465634645544, -25.807938387978595, -668.2221822576251, -183.33380045882762, -30.927746804674538, -38.671039504951324, -963.5634325350705, -114.9755651887266, -605.7816689910275, -1113.1932337423116, -632.4795857110307, -561.2715291194928, -5.956837827938975, -1149.3930916777801, -175.14520002272803, -10.872863836938448, -59.56545072727501, -259.4883636954759, -182.61660564188074, -175.40389470802197, -50.63073377000771, -109.51540577932154, -92.31978170039521, -809.0816646674019, -1184.1924631925217, -573.8773628189185, -155.74054823346933, -313.4250910073329, -186.09661809662268, -83.0130118166765, -163.8234288634314, -1159.6325798850505, -609.575665530656, -486.7220624335352, -21.371103380699676, -223.0346976815227, -124.73954109732595, 2.2033402405889126, -313.08121669588235, -600.9161148897897, -19.47226330375952, -262.94948452245086, -646.2797021961427, -205.58002755419236, -123.94570963670486, -1243.0646680329949, -820.1536712959835, -1180.1826017541614, -455.4256516079023, -40.88705372399997, -216.06734665401487, -77.48472981426978, -318.0223785545728, -8.3383572047065, -601.5020083680951, -119.75207390651197, -51.67898839098589, -361.96782674252637, -350.14944090540354, -387.5680817618604, -167.74943963574762, -384.8189265707041, -484.83821149669023, -1084.4759109458453, -179.6064793598036, -43.62353568129402, -260.3975231215192, -129.31869414417355, -236.45455166090542, -232.49165092578136, -1231.3869915123191, -57.55409495654238], "episode_lengths": [150, 148, 39, 150, 62, 150, 63, 83, 108, 100, 102, 150, 150, 150, 150, 134, 65, 58, 41, 150, 89, 88, 150, 93, 150, 92, 150, 108, 88, 54, 150, 82, 54, 49, 150, 72, 150, 150, 150, 150, 39, 150, 91, 33, 65, 150, 101, 83, 60, 69, 65, 150, 150, 150, 62, 78, 66, 70, 83, 150, 150, 150, 52, 105, 75, 31, 127, 150, 45, 102, 119, 92, 83, 150, 150, 150, 126, 62, 113, 60, 83, 38, 150, 84, 51, 139, 109, 147, 79, 150, 150, 150, 87, 58, 150, 74, 95, 93, 150, 66], "policy_policy_0_reward": [-540.0753073860499, -442.3928574876216, -18.699396681451184, -1141.8452495598076, -82.9242005673602, -611.7523219351514, -53.83467008227089, -230.23797881813036, -218.1348609228865, -295.1802999415705, -275.53158657067775, -1305.3210666745056, -1172.6218507944998, -822.1439479527919, -1051.150351913293, -507.0180832983083, -68.9838534830743, -154.49328234543216, -20.817838502198807, -384.2402211381703, -163.36158782311662, -190.9483694276483, -550.4542184683413, -161.99537596586788, -644.0087130441202, -124.32280822283934, -1101.3909705285535, -207.1777930289191, -185.57465634645544, -25.807938387978595, -668.2221822576251, -183.33380045882762, -30.927746804674538, -38.671039504951324, -963.5634325350705, -114.9755651887266, -605.7816689910275, -1113.1932337423116, -632.4795857110307, -561.2715291194928, -5.956837827938975, -1149.3930916777801, -175.14520002272803, -10.872863836938448, -59.56545072727501, -259.4883636954759, -182.61660564188074, -175.40389470802197, -50.63073377000771, -109.51540577932154, -92.31978170039521, -809.0816646674019, -1184.1924631925217, -573.8773628189185, -155.74054823346933, -313.4250910073329, -186.09661809662268, -83.0130118166765, -163.8234288634314, -1159.6325798850505, -609.575665530656, -486.7220624335352, -21.371103380699676, -223.0346976815227, -124.73954109732595, 2.2033402405889126, -313.08121669588235, -600.9161148897897, -19.47226330375952, -262.94948452245086, -646.2797021961427, -205.58002755419236, -123.94570963670486, -1243.0646680329949, -820.1536712959835, -1180.1826017541614, -455.4256516079023, -40.88705372399997, -216.06734665401487, -77.48472981426978, -318.0223785545728, -8.3383572047065, -601.5020083680951, -119.75207390651197, -51.67898839098589, -361.96782674252637, -350.14944090540354, -387.5680817618604, -167.74943963574762, -384.8189265707041, -484.83821149669023, -1084.4759109458453, -179.6064793598036, -43.62353568129402, -260.3975231215192, -129.31869414417355, -236.45455166090542, -232.49165092578136, -1231.3869915123191, -57.55409495654238]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5552572781116394, "mean_inference_ms": 1.7032311980943673, "mean_action_processing_ms": 0.27378116178887835, "mean_env_wait_ms": 3.392601911692327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011775016784667969, "StateBufferConnector_ms": 0.007993221282958984, "ViewRequirementAgentConnector_ms": 0.19362831115722656}, "num_episodes": 36, "episode_return_max": 2.2033402405889126, "episode_return_min": -1305.3210666745056, "episode_return_mean": -389.250775769934, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.1415161979377, "num_env_steps_trained_throughput_per_sec": 315.1415161979377, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 11859.05, "restore_workers_time_ms": 0.037, "training_step_time_ms": 11858.963, "sample_time_ms": 1121.65, "learn_time_ms": 10674.842, "learn_throughput": 374.713, "synch_weights_time_ms": 61.557}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "training_iteration": 58, "trial_id": "4b94b_00001", "date": "2024-08-05_12-12-23", "timestamp": 1722840143, "time_this_iter_s": 12.704923868179321, "time_total_s": 712.5913782119751, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75df2c746d40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 712.5913782119751, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 17.96666666666667, "ram_util_percent": 28.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 108.27648985087872, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.8224004000580559, "policy_loss": -0.011598260236981635, "vf_loss": 0.827606282212461, "vf_explained_var": 0.9898332027097543, "kl": 0.010852735792529258, "entropy": 0.9332181715716918, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 56160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "env_runners": {"episode_reward_max": 3.4822726446749517, "episode_reward_min": -1243.0646680329949, "episode_reward_mean": -340.1704698381781, "episode_len_mean": 101.88, "episode_media": {}, "episodes_timesteps_total": 10188, "policy_reward_min": {"policy_0": -1243.0646680329949}, "policy_reward_max": {"policy_0": 3.4822726446749517}, "policy_reward_mean": {"policy_0": -340.1704698381781}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.956837827938975, -1149.3930916777801, -175.14520002272803, -10.872863836938448, -59.56545072727501, -259.4883636954759, -182.61660564188074, -175.40389470802197, -50.63073377000771, -109.51540577932154, -92.31978170039521, -809.0816646674019, -1184.1924631925217, -573.8773628189185, -155.74054823346933, -313.4250910073329, -186.09661809662268, -83.0130118166765, -163.8234288634314, -1159.6325798850505, -609.575665530656, -486.7220624335352, -21.371103380699676, -223.0346976815227, -124.73954109732595, 2.2033402405889126, -313.08121669588235, -600.9161148897897, -19.47226330375952, -262.94948452245086, -646.2797021961427, -205.58002755419236, -123.94570963670486, -1243.0646680329949, -820.1536712959835, -1180.1826017541614, -455.4256516079023, -40.88705372399997, -216.06734665401487, -77.48472981426978, -318.0223785545728, -8.3383572047065, -601.5020083680951, -119.75207390651197, -51.67898839098589, -361.96782674252637, -350.14944090540354, -387.5680817618604, -167.74943963574762, -384.8189265707041, -484.83821149669023, -1084.4759109458453, -179.6064793598036, -43.62353568129402, -260.3975231215192, -129.31869414417355, -236.45455166090542, -232.49165092578136, -1231.3869915123191, -57.55409495654238, -410.5106596045118, -105.10900732631421, 3.4822726446749517, -525.8929047213467, -106.11860755209725, -1169.5907919077952, -79.52121204253032, -122.26431795254665, -854.7357626627436, -302.5969483146042, -203.10946510407317, -236.5362522265967, -360.6930203487766, -252.27243395898702, -635.8368874304167, -884.5300748057409, -498.0125030077851, -315.26579159793823, -82.20626910127575, -333.7770130542396, -144.82788461878778, -231.17406236853085, -424.8942106270412, -457.39819455056363, -1.714654636417027, -116.18048984620762, -23.628321006237112, -459.8518805884717, -180.8348846884268, -51.589576352031884, -429.7448895530313, -24.222982697927918, -32.21565878639842, -436.9029037903082, -136.46809399122654, -670.466832200199, -128.58934779219908, -221.31884407524055, -201.1045982272953, -908.6048879650472], "episode_lengths": [39, 150, 91, 33, 65, 150, 101, 83, 60, 69, 65, 150, 150, 150, 62, 78, 66, 70, 83, 150, 150, 150, 52, 105, 75, 31, 127, 150, 45, 102, 119, 92, 83, 150, 150, 150, 126, 62, 113, 60, 83, 38, 150, 84, 51, 139, 109, 147, 79, 150, 150, 150, 87, 58, 150, 74, 95, 93, 150, 66, 139, 73, 31, 150, 67, 150, 64, 74, 150, 111, 150, 97, 131, 77, 118, 150, 141, 150, 64, 114, 80, 110, 150, 150, 35, 50, 50, 140, 91, 52, 102, 44, 51, 150, 85, 150, 88, 110, 89, 150], "policy_policy_0_reward": [-5.956837827938975, -1149.3930916777801, -175.14520002272803, -10.872863836938448, -59.56545072727501, -259.4883636954759, -182.61660564188074, -175.40389470802197, -50.63073377000771, -109.51540577932154, -92.31978170039521, -809.0816646674019, -1184.1924631925217, -573.8773628189185, -155.74054823346933, -313.4250910073329, -186.09661809662268, -83.0130118166765, -163.8234288634314, -1159.6325798850505, -609.575665530656, -486.7220624335352, -21.371103380699676, -223.0346976815227, -124.73954109732595, 2.2033402405889126, -313.08121669588235, -600.9161148897897, -19.47226330375952, -262.94948452245086, -646.2797021961427, -205.58002755419236, -123.94570963670486, -1243.0646680329949, -820.1536712959835, -1180.1826017541614, -455.4256516079023, -40.88705372399997, -216.06734665401487, -77.48472981426978, -318.0223785545728, -8.3383572047065, -601.5020083680951, -119.75207390651197, -51.67898839098589, -361.96782674252637, -350.14944090540354, -387.5680817618604, -167.74943963574762, -384.8189265707041, -484.83821149669023, -1084.4759109458453, -179.6064793598036, -43.62353568129402, -260.3975231215192, -129.31869414417355, -236.45455166090542, -232.49165092578136, -1231.3869915123191, -57.55409495654238, -410.5106596045118, -105.10900732631421, 3.4822726446749517, -525.8929047213467, -106.11860755209725, -1169.5907919077952, -79.52121204253032, -122.26431795254665, -854.7357626627436, -302.5969483146042, -203.10946510407317, -236.5362522265967, -360.6930203487766, -252.27243395898702, -635.8368874304167, -884.5300748057409, -498.0125030077851, -315.26579159793823, -82.20626910127575, -333.7770130542396, -144.82788461878778, -231.17406236853085, -424.8942106270412, -457.39819455056363, -1.714654636417027, -116.18048984620762, -23.628321006237112, -459.8518805884717, -180.8348846884268, -51.589576352031884, -429.7448895530313, -24.222982697927918, -32.21565878639842, -436.9029037903082, -136.46809399122654, -670.466832200199, -128.58934779219908, -221.31884407524055, -201.1045982272953, -908.6048879650472]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5553470669747952, "mean_inference_ms": 1.7027995408292573, "mean_action_processing_ms": 0.2739921093239149, "mean_env_wait_ms": 3.3924407036962765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01201009750366211, "StateBufferConnector_ms": 0.007969141006469727, "ViewRequirementAgentConnector_ms": 0.1911182403564453}, "num_episodes": 40, "episode_return_max": 3.4822726446749517, "episode_return_min": -1243.0646680329949, "episode_return_mean": -340.1704698381781, "episodes_this_iter": 40}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 324.1180001521946, "num_env_steps_trained_throughput_per_sec": 324.1180001521946, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 236000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 236000, "timers": {"training_iteration_time_ms": 12296.232, "restore_workers_time_ms": 0.037, "training_step_time_ms": 12296.144, "sample_time_ms": 1114.809, "learn_time_ms": 11115.823, "learn_throughput": 359.847, "synch_weights_time_ms": 64.577}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "done": false, "training_iteration": 59, "trial_id": "4b94b_00001", "date": "2024-08-05_12-12-35", "timestamp": 1722840155, "time_this_iter_s": 12.354136943817139, "time_total_s": 724.9455151557922, "pid": 682465, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75df2c745a20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 724.9455151557922, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 18.06666666666667, "ram_util_percent": 28.783333333333335}}
