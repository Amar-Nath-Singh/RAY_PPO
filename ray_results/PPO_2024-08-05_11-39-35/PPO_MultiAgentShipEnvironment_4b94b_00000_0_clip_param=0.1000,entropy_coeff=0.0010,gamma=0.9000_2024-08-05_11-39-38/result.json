{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.628993515235682, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.27446120629708, "policy_loss": -0.0039014996669720857, "vf_loss": 8.279015064736207, "vf_explained_var": 0.1970735886444648, "kl": 0.003878878408067976, "entropy": 1.4281448392818372, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -20.064232579795757, "episode_reward_min": -1263.9337193632773, "episode_reward_mean": -520.5810110713654, "episode_len_mean": 111.34615384615384, "episode_media": {}, "episodes_timesteps_total": 2895, "policy_reward_min": {"policy_0": -1263.9337193632773}, "policy_reward_max": {"policy_0": -20.064232579795757}, "policy_reward_mean": {"policy_0": -520.5810110713654}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-401.5502302778429, -508.05072617632663, -356.647018247311, -92.48241467559133, -83.39540963472734, -698.1436010959645, -971.2686834338302, -1263.9337193632773, -162.57618081158193, -349.88463623688517, -998.5967449910878, -603.2119755260617, -236.85127722404505, -20.064232579795757, -859.6702449070953, -902.4317050554224, -499.820225819103, -388.3459829769932, -997.1635291858252, -101.68458072022115, -290.3135688565873, -157.63025951672034, -184.14908065404973, -306.15999228723774, -1140.004225547035, -961.0760420548859], "episode_lengths": [150, 114, 111, 42, 53, 150, 150, 150, 56, 104, 150, 150, 98, 35, 150, 150, 150, 98, 150, 65, 93, 55, 69, 102, 150, 150], "policy_policy_0_reward": [-401.5502302778429, -508.05072617632663, -356.647018247311, -92.48241467559133, -83.39540963472734, -698.1436010959645, -971.2686834338302, -1263.9337193632773, -162.57618081158193, -349.88463623688517, -998.5967449910878, -603.2119755260617, -236.85127722404505, -20.064232579795757, -859.6702449070953, -902.4317050554224, -499.820225819103, -388.3459829769932, -997.1635291858252, -101.68458072022115, -290.3135688565873, -157.63025951672034, -184.14908065404973, -306.15999228723774, -1140.004225547035, -961.0760420548859]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5635049362081431, "mean_inference_ms": 1.6630003589925493, "mean_action_processing_ms": 0.28178321091050945, "mean_env_wait_ms": 3.3801056984263833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011785213763897236, "StateBufferConnector_ms": 0.008305219503549429, "ViewRequirementAgentConnector_ms": 0.17864062235905573}, "num_episodes": 26, "episode_return_max": -20.064232579795757, "episode_return_min": -1263.9337193632773, "episode_return_mean": -520.5810110713654, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 345.2543144863919, "num_env_steps_trained_throughput_per_sec": 345.2543144863919, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 11585.671, "restore_workers_time_ms": 0.024, "training_step_time_ms": 11585.611, "sample_time_ms": 1135.888, "learn_time_ms": 10392.39, "learn_throughput": 384.897, "synch_weights_time_ms": 56.619}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "4b94b_00000", "date": "2024-08-05_11-40-06", "timestamp": 1722838206, "time_this_iter_s": 11.597764730453491, "time_total_s": 11.597764730453491, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1114ad360>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11.597764730453491, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 18.65294117647059, "ram_util_percent": 29.15294117647059}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 41.26814220560094, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.439793199300766, "policy_loss": -0.00034127620553287366, "vf_loss": 5.441194990773996, "vf_explained_var": 0.6689439989005526, "kl": 0.0037956300787451874, "entropy": 1.4400837812572718, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -20.064232579795757, "episode_reward_min": -1263.9337193632773, "episode_reward_mean": -655.4528119044127, "episode_len_mean": 121.81481481481481, "episode_media": {}, "episodes_timesteps_total": 6578, "policy_reward_min": {"policy_0": -1263.9337193632773}, "policy_reward_max": {"policy_0": -20.064232579795757}, "policy_reward_mean": {"policy_0": -655.4528119044127}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-401.5502302778429, -508.05072617632663, -356.647018247311, -92.48241467559133, -83.39540963472734, -698.1436010959645, -971.2686834338302, -1263.9337193632773, -162.57618081158193, -349.88463623688517, -998.5967449910878, -603.2119755260617, -236.85127722404505, -20.064232579795757, -859.6702449070953, -902.4317050554224, -499.820225819103, -388.3459829769932, -997.1635291858252, -101.68458072022115, -290.3135688565873, -157.63025951672034, -184.14908065404973, -306.15999228723774, -1140.004225547035, -961.0760420548859, -363.5072760254801, -1112.215825794533, -1067.2851744884686, -842.1725270088425, -425.89962308927124, -1059.948852085317, -996.5968061538531, -980.6701762102454, -853.6817735026449, -1164.8088810625716, -234.70035395667836, -506.1896877113246, -1076.7889269453287, -470.73346641606736, -23.668064333403866, -1182.070415711769, -924.1762674045395, -1028.0264330058928, -739.8157090499623, -442.03550206838946, -931.8767198086761, -751.4834581920059, -857.9651608103442, -1013.1497974710151, -298.59293466141486, -1016.4158994208132, -994.0246988722804, -500.84514372165205], "episode_lengths": [150, 114, 111, 42, 53, 150, 150, 150, 56, 104, 150, 150, 98, 35, 150, 150, 150, 98, 150, 65, 93, 55, 69, 102, 150, 150, 90, 150, 150, 150, 101, 150, 150, 150, 150, 150, 82, 106, 150, 107, 47, 150, 150, 150, 150, 96, 150, 150, 150, 150, 96, 150, 150, 108], "policy_policy_0_reward": [-401.5502302778429, -508.05072617632663, -356.647018247311, -92.48241467559133, -83.39540963472734, -698.1436010959645, -971.2686834338302, -1263.9337193632773, -162.57618081158193, -349.88463623688517, -998.5967449910878, -603.2119755260617, -236.85127722404505, -20.064232579795757, -859.6702449070953, -902.4317050554224, -499.820225819103, -388.3459829769932, -997.1635291858252, -101.68458072022115, -290.3135688565873, -157.63025951672034, -184.14908065404973, -306.15999228723774, -1140.004225547035, -961.0760420548859, -363.5072760254801, -1112.215825794533, -1067.2851744884686, -842.1725270088425, -425.89962308927124, -1059.948852085317, -996.5968061538531, -980.6701762102454, -853.6817735026449, -1164.8088810625716, -234.70035395667836, -506.1896877113246, -1076.7889269453287, -470.73346641606736, -23.668064333403866, -1182.070415711769, -924.1762674045395, -1028.0264330058928, -739.8157090499623, -442.03550206838946, -931.8767198086761, -751.4834581920059, -857.9651608103442, -1013.1497974710151, -298.59293466141486, -1016.4158994208132, -994.0246988722804, -500.84514372165205]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.561254128963783, "mean_inference_ms": 1.6572178157682174, "mean_action_processing_ms": 0.27971400019051884, "mean_env_wait_ms": 3.3796276758499944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01395984932228371, "StateBufferConnector_ms": 0.008512867821587456, "ViewRequirementAgentConnector_ms": 0.1812824496516475}, "num_episodes": 28, "episode_return_max": -20.064232579795757, "episode_return_min": -1263.9337193632773, "episode_return_mean": -655.4528119044127, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.6683109852289, "num_env_steps_trained_throughput_per_sec": 316.6683109852289, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 12108.599, "restore_workers_time_ms": 0.024, "training_step_time_ms": 12108.533, "sample_time_ms": 1118.434, "learn_time_ms": 10918.95, "learn_throughput": 366.336, "synch_weights_time_ms": 70.308}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "4b94b_00000", "date": "2024-08-05_11-40-18", "timestamp": 1722838218, "time_this_iter_s": 12.643948554992676, "time_total_s": 24.241713285446167, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1113d0040>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 24.241713285446167, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 18.02777777777778, "ram_util_percent": 29.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 95.61967584987481, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.3170255930473407, "policy_loss": -0.003738573946854255, "vf_loss": 3.3219659260163703, "vf_explained_var": 0.9153348743915558, "kl": 0.004271422573947348, "entropy": 1.4153354257345199, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -20.064232579795757, "episode_reward_min": -1409.9532198290535, "episode_reward_mean": -710.1075855126242, "episode_len_mean": 125.90361445783132, "episode_media": {}, "episodes_timesteps_total": 10450, "policy_reward_min": {"policy_0": -1409.9532198290535}, "policy_reward_max": {"policy_0": -20.064232579795757}, "policy_reward_mean": {"policy_0": -710.1075855126242}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-401.5502302778429, -508.05072617632663, -356.647018247311, -92.48241467559133, -83.39540963472734, -698.1436010959645, -971.2686834338302, -1263.9337193632773, -162.57618081158193, -349.88463623688517, -998.5967449910878, -603.2119755260617, -236.85127722404505, -20.064232579795757, -859.6702449070953, -902.4317050554224, -499.820225819103, -388.3459829769932, -997.1635291858252, -101.68458072022115, -290.3135688565873, -157.63025951672034, -184.14908065404973, -306.15999228723774, -1140.004225547035, -961.0760420548859, -363.5072760254801, -1112.215825794533, -1067.2851744884686, -842.1725270088425, -425.89962308927124, -1059.948852085317, -996.5968061538531, -980.6701762102454, -853.6817735026449, -1164.8088810625716, -234.70035395667836, -506.1896877113246, -1076.7889269453287, -470.73346641606736, -23.668064333403866, -1182.070415711769, -924.1762674045395, -1028.0264330058928, -739.8157090499623, -442.03550206838946, -931.8767198086761, -751.4834581920059, -857.9651608103442, -1013.1497974710151, -298.59293466141486, -1016.4158994208132, -994.0246988722804, -500.84514372165205, -997.6131039494398, -989.9357338249761, -1121.3919406909897, -1107.7474562828925, -548.1378874046769, -523.2033479911561, -1270.0109058591552, -1409.9532198290535, -792.6248552393955, -782.596158253321, -328.4779565687313, -234.45051855404597, -487.4101091206187, -904.4326217863156, -1188.9514550826123, -836.2824794545177, -169.1212141219287, -894.7031225446583, -1106.3740589430663, -552.2575803370203, -1163.201282925668, -1276.2730800149434, -330.7198809355306, -125.4547996952486, -686.8738910819607, -600.7582658905274, -1030.3591728279137, -1064.2769454551624, -1020.8847100439865], "episode_lengths": [150, 114, 111, 42, 53, 150, 150, 150, 56, 104, 150, 150, 98, 35, 150, 150, 150, 98, 150, 65, 93, 55, 69, 102, 150, 150, 90, 150, 150, 150, 101, 150, 150, 150, 150, 150, 82, 106, 150, 107, 47, 150, 150, 150, 150, 96, 150, 150, 150, 150, 96, 150, 150, 108, 150, 150, 150, 150, 150, 110, 150, 150, 140, 150, 110, 69, 108, 150, 150, 150, 75, 150, 150, 150, 150, 150, 85, 53, 150, 122, 150, 150, 150], "policy_policy_0_reward": [-401.5502302778429, -508.05072617632663, -356.647018247311, -92.48241467559133, -83.39540963472734, -698.1436010959645, -971.2686834338302, -1263.9337193632773, -162.57618081158193, -349.88463623688517, -998.5967449910878, -603.2119755260617, -236.85127722404505, -20.064232579795757, -859.6702449070953, -902.4317050554224, -499.820225819103, -388.3459829769932, -997.1635291858252, -101.68458072022115, -290.3135688565873, -157.63025951672034, -184.14908065404973, -306.15999228723774, -1140.004225547035, -961.0760420548859, -363.5072760254801, -1112.215825794533, -1067.2851744884686, -842.1725270088425, -425.89962308927124, -1059.948852085317, -996.5968061538531, -980.6701762102454, -853.6817735026449, -1164.8088810625716, -234.70035395667836, -506.1896877113246, -1076.7889269453287, -470.73346641606736, -23.668064333403866, -1182.070415711769, -924.1762674045395, -1028.0264330058928, -739.8157090499623, -442.03550206838946, -931.8767198086761, -751.4834581920059, -857.9651608103442, -1013.1497974710151, -298.59293466141486, -1016.4158994208132, -994.0246988722804, -500.84514372165205, -997.6131039494398, -989.9357338249761, -1121.3919406909897, -1107.7474562828925, -548.1378874046769, -523.2033479911561, -1270.0109058591552, -1409.9532198290535, -792.6248552393955, -782.596158253321, -328.4779565687313, -234.45051855404597, -487.4101091206187, -904.4326217863156, -1188.9514550826123, -836.2824794545177, -169.1212141219287, -894.7031225446583, -1106.3740589430663, -552.2575803370203, -1163.201282925668, -1276.2730800149434, -330.7198809355306, -125.4547996952486, -686.8738910819607, -600.7582658905274, -1030.3591728279137, -1064.2769454551624, -1020.8847100439865]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5625466397187036, "mean_inference_ms": 1.6592813467870546, "mean_action_processing_ms": 0.2791723698785147, "mean_env_wait_ms": 3.386037426916089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01356027212487646, "StateBufferConnector_ms": 0.008628167301775461, "ViewRequirementAgentConnector_ms": 0.18512398363595986}, "num_episodes": 29, "episode_return_max": -20.064232579795757, "episode_return_min": -1409.9532198290535, "episode_return_mean": -710.1075855126242, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 330.7864465305982, "num_env_steps_trained_throughput_per_sec": 330.7864465305982, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 12103.202, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12103.129, "sample_time_ms": 1110.463, "learn_time_ms": 10919.05, "learn_throughput": 366.332, "synch_weights_time_ms": 72.768}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "4b94b_00000", "date": "2024-08-05_11-40-30", "timestamp": 1722838230, "time_this_iter_s": 12.102702140808105, "time_total_s": 36.34441542625427, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e11156bf40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 36.34441542625427, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 19.599999999999998, "ram_util_percent": 29.10588235294118}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 108.60745257337888, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0010000000000000005, "total_loss": 2.3277821742619076, "policy_loss": -0.004648282446093314, "vf_loss": 2.3337056347479423, "vf_explained_var": 0.9553988854090373, "kl": 0.006082098179467725, "entropy": 1.4272392511367797, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -16.635399950243492, "episode_reward_min": -1409.9532198290535, "episode_reward_mean": -689.7878280979996, "episode_len_mean": 123.22, "episode_media": {}, "episodes_timesteps_total": 12322, "policy_reward_min": {"policy_0": -1409.9532198290535}, "policy_reward_max": {"policy_0": -16.635399950243492}, "policy_reward_mean": {"policy_0": -689.7878280979996}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-101.68458072022115, -290.3135688565873, -157.63025951672034, -184.14908065404973, -306.15999228723774, -1140.004225547035, -961.0760420548859, -363.5072760254801, -1112.215825794533, -1067.2851744884686, -842.1725270088425, -425.89962308927124, -1059.948852085317, -996.5968061538531, -980.6701762102454, -853.6817735026449, -1164.8088810625716, -234.70035395667836, -506.1896877113246, -1076.7889269453287, -470.73346641606736, -23.668064333403866, -1182.070415711769, -924.1762674045395, -1028.0264330058928, -739.8157090499623, -442.03550206838946, -931.8767198086761, -751.4834581920059, -857.9651608103442, -1013.1497974710151, -298.59293466141486, -1016.4158994208132, -994.0246988722804, -500.84514372165205, -997.6131039494398, -989.9357338249761, -1121.3919406909897, -1107.7474562828925, -548.1378874046769, -523.2033479911561, -1270.0109058591552, -1409.9532198290535, -792.6248552393955, -782.596158253321, -328.4779565687313, -234.45051855404597, -487.4101091206187, -904.4326217863156, -1188.9514550826123, -836.2824794545177, -169.1212141219287, -894.7031225446583, -1106.3740589430663, -552.2575803370203, -1163.201282925668, -1276.2730800149434, -330.7198809355306, -125.4547996952486, -686.8738910819607, -600.7582658905274, -1030.3591728279137, -1064.2769454551624, -1020.8847100439865, -794.2290855717381, -265.1641405676897, -1074.8740784541055, -124.19470823301948, -800.8288512442418, -144.2425619940537, -805.080178580721, -861.8033239060835, -597.3856265651224, -316.00482921771913, -160.30588535481127, -105.72501173428512, -509.3824671135449, -372.63195927020274, -615.209245095263, -1027.7809869174766, -933.6360234563123, -1162.7633346860073, -367.30369484198945, -900.5647861993402, -16.635399950243492, -843.4442174372281, -17.732588886958226, -314.9928091637512, -1137.730680689692, -944.9976431822245, -392.86311072969363, -99.89722690600878, -432.76729942383236, -617.5404346625049, -505.1024034068743, -1358.8691189490885, -767.1840573188875, -946.2961041261805, -65.70731105535896, -33.070565578669004], "episode_lengths": [65, 93, 55, 69, 102, 150, 150, 90, 150, 150, 150, 101, 150, 150, 150, 150, 150, 82, 106, 150, 107, 47, 150, 150, 150, 150, 96, 150, 150, 150, 150, 96, 150, 150, 108, 150, 150, 150, 150, 150, 110, 150, 150, 140, 150, 110, 69, 108, 150, 150, 150, 75, 150, 150, 150, 150, 150, 85, 53, 150, 122, 150, 150, 150, 150, 88, 150, 66, 150, 51, 150, 150, 150, 97, 68, 63, 108, 88, 150, 150, 150, 150, 89, 150, 40, 150, 35, 85, 150, 150, 115, 66, 117, 150, 129, 150, 150, 150, 39, 39], "policy_policy_0_reward": [-101.68458072022115, -290.3135688565873, -157.63025951672034, -184.14908065404973, -306.15999228723774, -1140.004225547035, -961.0760420548859, -363.5072760254801, -1112.215825794533, -1067.2851744884686, -842.1725270088425, -425.89962308927124, -1059.948852085317, -996.5968061538531, -980.6701762102454, -853.6817735026449, -1164.8088810625716, -234.70035395667836, -506.1896877113246, -1076.7889269453287, -470.73346641606736, -23.668064333403866, -1182.070415711769, -924.1762674045395, -1028.0264330058928, -739.8157090499623, -442.03550206838946, -931.8767198086761, -751.4834581920059, -857.9651608103442, -1013.1497974710151, -298.59293466141486, -1016.4158994208132, -994.0246988722804, -500.84514372165205, -997.6131039494398, -989.9357338249761, -1121.3919406909897, -1107.7474562828925, -548.1378874046769, -523.2033479911561, -1270.0109058591552, -1409.9532198290535, -792.6248552393955, -782.596158253321, -328.4779565687313, -234.45051855404597, -487.4101091206187, -904.4326217863156, -1188.9514550826123, -836.2824794545177, -169.1212141219287, -894.7031225446583, -1106.3740589430663, -552.2575803370203, -1163.201282925668, -1276.2730800149434, -330.7198809355306, -125.4547996952486, -686.8738910819607, -600.7582658905274, -1030.3591728279137, -1064.2769454551624, -1020.8847100439865, -794.2290855717381, -265.1641405676897, -1074.8740784541055, -124.19470823301948, -800.8288512442418, -144.2425619940537, -805.080178580721, -861.8033239060835, -597.3856265651224, -316.00482921771913, -160.30588535481127, -105.72501173428512, -509.3824671135449, -372.63195927020274, -615.209245095263, -1027.7809869174766, -933.6360234563123, -1162.7633346860073, -367.30369484198945, -900.5647861993402, -16.635399950243492, -843.4442174372281, -17.732588886958226, -314.9928091637512, -1137.730680689692, -944.9976431822245, -392.86311072969363, -99.89722690600878, -432.76729942383236, -617.5404346625049, -505.1024034068743, -1358.8691189490885, -767.1840573188875, -946.2961041261805, -65.70731105535896, -33.070565578669004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5634940593147618, "mean_inference_ms": 1.658291328385404, "mean_action_processing_ms": 0.2785788560641741, "mean_env_wait_ms": 3.385622657363699, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013992547988891602, "StateBufferConnector_ms": 0.008659601211547852, "ViewRequirementAgentConnector_ms": 0.18595409393310547}, "num_episodes": 36, "episode_return_max": -16.635399950243492, "episode_return_min": -1409.9532198290535, "episode_return_mean": -689.7878280979996, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 322.8291949980418, "num_env_steps_trained_throughput_per_sec": 322.8291949980418, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12175.017, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12174.948, "sample_time_ms": 1105.896, "learn_time_ms": 10999.687, "learn_throughput": 363.647, "synch_weights_time_ms": 68.542}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "4b94b_00000", "date": "2024-08-05_11-40-43", "timestamp": 1722838243, "time_this_iter_s": 12.400176763534546, "time_total_s": 48.74459218978882, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1113d1750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 48.74459218978882, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 19.694444444444443, "ram_util_percent": 29.116666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 127.38590993086497, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0010000000000000005, "total_loss": 2.297252674338718, "policy_loss": -0.0030490982399593728, "vf_loss": 2.3015053257346154, "vf_explained_var": 0.9631864999731382, "kl": 0.007398045890370975, "entropy": 1.3885101709514855, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -8.610210069118837, "episode_reward_min": -1409.9532198290535, "episode_reward_mean": -678.8549454808266, "episode_len_mean": 124.37, "episode_media": {}, "episodes_timesteps_total": 12437, "policy_reward_min": {"policy_0": -1409.9532198290535}, "policy_reward_max": {"policy_0": -8.610210069118837}, "policy_reward_mean": {"policy_0": -678.8549454808266}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-857.9651608103442, -1013.1497974710151, -298.59293466141486, -1016.4158994208132, -994.0246988722804, -500.84514372165205, -997.6131039494398, -989.9357338249761, -1121.3919406909897, -1107.7474562828925, -548.1378874046769, -523.2033479911561, -1270.0109058591552, -1409.9532198290535, -792.6248552393955, -782.596158253321, -328.4779565687313, -234.45051855404597, -487.4101091206187, -904.4326217863156, -1188.9514550826123, -836.2824794545177, -169.1212141219287, -894.7031225446583, -1106.3740589430663, -552.2575803370203, -1163.201282925668, -1276.2730800149434, -330.7198809355306, -125.4547996952486, -686.8738910819607, -600.7582658905274, -1030.3591728279137, -1064.2769454551624, -1020.8847100439865, -794.2290855717381, -265.1641405676897, -1074.8740784541055, -124.19470823301948, -800.8288512442418, -144.2425619940537, -805.080178580721, -861.8033239060835, -597.3856265651224, -316.00482921771913, -160.30588535481127, -105.72501173428512, -509.3824671135449, -372.63195927020274, -615.209245095263, -1027.7809869174766, -933.6360234563123, -1162.7633346860073, -367.30369484198945, -900.5647861993402, -16.635399950243492, -843.4442174372281, -17.732588886958226, -314.9928091637512, -1137.730680689692, -944.9976431822245, -392.86311072969363, -99.89722690600878, -432.76729942383236, -617.5404346625049, -505.1024034068743, -1358.8691189490885, -767.1840573188875, -946.2961041261805, -65.70731105535896, -33.070565578669004, -935.1579867837238, -423.98819386933286, -818.8264002555109, -676.0824005045718, -913.9448748344614, -1125.618114110398, -1148.0507115628334, -334.41227365001976, -431.23299208889046, -984.2099440888804, -53.57732287028478, -430.8591076612927, -595.2321131875868, -649.8057849823558, -480.8881933032401, -630.9430025103924, -1010.5688168645625, -136.00177595125453, -226.25691543752984, -572.5270579765345, -937.524952089255, -797.2305157108566, -835.3731838667987, -1158.3708532462488, -97.15040164491587, -1017.8412453917756, -8.610210069118837, -954.2932545707098, -841.5028088613603], "episode_lengths": [150, 150, 96, 150, 150, 108, 150, 150, 150, 150, 150, 110, 150, 150, 140, 150, 110, 69, 108, 150, 150, 150, 75, 150, 150, 150, 150, 150, 85, 53, 150, 122, 150, 150, 150, 150, 88, 150, 66, 150, 51, 150, 150, 150, 97, 68, 63, 108, 88, 150, 150, 150, 150, 89, 150, 40, 150, 35, 85, 150, 150, 115, 66, 117, 150, 129, 150, 150, 150, 39, 39, 150, 102, 150, 135, 150, 150, 150, 97, 108, 150, 49, 102, 121, 150, 150, 150, 150, 80, 71, 150, 150, 150, 150, 150, 74, 150, 39, 150, 150], "policy_policy_0_reward": [-857.9651608103442, -1013.1497974710151, -298.59293466141486, -1016.4158994208132, -994.0246988722804, -500.84514372165205, -997.6131039494398, -989.9357338249761, -1121.3919406909897, -1107.7474562828925, -548.1378874046769, -523.2033479911561, -1270.0109058591552, -1409.9532198290535, -792.6248552393955, -782.596158253321, -328.4779565687313, -234.45051855404597, -487.4101091206187, -904.4326217863156, -1188.9514550826123, -836.2824794545177, -169.1212141219287, -894.7031225446583, -1106.3740589430663, -552.2575803370203, -1163.201282925668, -1276.2730800149434, -330.7198809355306, -125.4547996952486, -686.8738910819607, -600.7582658905274, -1030.3591728279137, -1064.2769454551624, -1020.8847100439865, -794.2290855717381, -265.1641405676897, -1074.8740784541055, -124.19470823301948, -800.8288512442418, -144.2425619940537, -805.080178580721, -861.8033239060835, -597.3856265651224, -316.00482921771913, -160.30588535481127, -105.72501173428512, -509.3824671135449, -372.63195927020274, -615.209245095263, -1027.7809869174766, -933.6360234563123, -1162.7633346860073, -367.30369484198945, -900.5647861993402, -16.635399950243492, -843.4442174372281, -17.732588886958226, -314.9928091637512, -1137.730680689692, -944.9976431822245, -392.86311072969363, -99.89722690600878, -432.76729942383236, -617.5404346625049, -505.1024034068743, -1358.8691189490885, -767.1840573188875, -946.2961041261805, -65.70731105535896, -33.070565578669004, -935.1579867837238, -423.98819386933286, -818.8264002555109, -676.0824005045718, -913.9448748344614, -1125.618114110398, -1148.0507115628334, -334.41227365001976, -431.23299208889046, -984.2099440888804, -53.57732287028478, -430.8591076612927, -595.2321131875868, -649.8057849823558, -480.8881933032401, -630.9430025103924, -1010.5688168645625, -136.00177595125453, -226.25691543752984, -572.5270579765345, -937.524952089255, -797.2305157108566, -835.3731838667987, -1158.3708532462488, -97.15040164491587, -1017.8412453917756, -8.610210069118837, -954.2932545707098, -841.5028088613603]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5638726766563071, "mean_inference_ms": 1.6638442671984432, "mean_action_processing_ms": 0.2792875870489943, "mean_env_wait_ms": 3.391105287090194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013143539428710938, "StateBufferConnector_ms": 0.008594274520874023, "ViewRequirementAgentConnector_ms": 0.18515729904174805}, "num_episodes": 29, "episode_return_max": -8.610210069118837, "episode_return_min": -1409.9532198290535, "episode_return_mean": -678.8549454808266, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 360.19418761798556, "num_env_steps_trained_throughput_per_sec": 360.19418761798556, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 11961.04, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11960.971, "sample_time_ms": 1121.695, "learn_time_ms": 10771.333, "learn_throughput": 371.356, "synch_weights_time_ms": 67.132}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "4b94b_00000", "date": "2024-08-05_11-40-54", "timestamp": 1722838254, "time_this_iter_s": 11.114949941635132, "time_total_s": 59.85954213142395, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1114ad360>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 59.85954213142395, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 23.09375, "ram_util_percent": 29.18125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 154.5287748893102, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0010000000000000005, "total_loss": 1.2493415997363626, "policy_loss": -7.643582260546585e-05, "vf_loss": 1.2506675442059836, "vf_explained_var": 0.9812066596001386, "kl": 0.004585681787852991, "entropy": 1.3641520195951065, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -8.610210069118837, "episode_reward_min": -1358.8691189490885, "episode_reward_mean": -697.2743660846322, "episode_len_mean": 126.59, "episode_media": {}, "episodes_timesteps_total": 12659, "policy_reward_min": {"policy_0": -1358.8691189490885}, "policy_reward_max": {"policy_0": -8.610210069118837}, "policy_reward_mean": {"policy_0": -697.2743660846322}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-686.8738910819607, -600.7582658905274, -1030.3591728279137, -1064.2769454551624, -1020.8847100439865, -794.2290855717381, -265.1641405676897, -1074.8740784541055, -124.19470823301948, -800.8288512442418, -144.2425619940537, -805.080178580721, -861.8033239060835, -597.3856265651224, -316.00482921771913, -160.30588535481127, -105.72501173428512, -509.3824671135449, -372.63195927020274, -615.209245095263, -1027.7809869174766, -933.6360234563123, -1162.7633346860073, -367.30369484198945, -900.5647861993402, -16.635399950243492, -843.4442174372281, -17.732588886958226, -314.9928091637512, -1137.730680689692, -944.9976431822245, -392.86311072969363, -99.89722690600878, -432.76729942383236, -617.5404346625049, -505.1024034068743, -1358.8691189490885, -767.1840573188875, -946.2961041261805, -65.70731105535896, -33.070565578669004, -935.1579867837238, -423.98819386933286, -818.8264002555109, -676.0824005045718, -913.9448748344614, -1125.618114110398, -1148.0507115628334, -334.41227365001976, -431.23299208889046, -984.2099440888804, -53.57732287028478, -430.8591076612927, -595.2321131875868, -649.8057849823558, -480.8881933032401, -630.9430025103924, -1010.5688168645625, -136.00177595125453, -226.25691543752984, -572.5270579765345, -937.524952089255, -797.2305157108566, -835.3731838667987, -1158.3708532462488, -97.15040164491587, -1017.8412453917756, -8.610210069118837, -954.2932545707098, -841.5028088613603, -1053.2271007671895, -324.17079395931717, -1039.07984347231, -748.6949366189519, -756.5017948019631, -1201.9963405511432, -966.1618004202139, -1055.407684059419, -197.54866615134554, -809.3275692969024, -1141.0226783225007, -1108.5408799200236, -1001.5972536159203, -1206.1618678804716, -1117.9209340460345, -687.2457339208514, -951.6761613833357, -475.59368014619264, -1346.96989358292, -523.0934226718275, -715.7213317211435, -1192.1706834166082, -1334.1279475250833, -944.6974412458973, -643.9964403720645, -22.915492999804016, -452.49681226611517, -892.4681428839335, -671.1043484793661, -1082.6227882492065], "episode_lengths": [150, 122, 150, 150, 150, 150, 88, 150, 66, 150, 51, 150, 150, 150, 97, 68, 63, 108, 88, 150, 150, 150, 150, 89, 150, 40, 150, 35, 85, 150, 150, 115, 66, 117, 150, 129, 150, 150, 150, 39, 39, 150, 102, 150, 135, 150, 150, 150, 97, 108, 150, 49, 102, 121, 150, 150, 150, 150, 80, 71, 150, 150, 150, 150, 150, 74, 150, 39, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 95, 138, 150, 150, 150, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 121, 39, 101, 150, 150, 150], "policy_policy_0_reward": [-686.8738910819607, -600.7582658905274, -1030.3591728279137, -1064.2769454551624, -1020.8847100439865, -794.2290855717381, -265.1641405676897, -1074.8740784541055, -124.19470823301948, -800.8288512442418, -144.2425619940537, -805.080178580721, -861.8033239060835, -597.3856265651224, -316.00482921771913, -160.30588535481127, -105.72501173428512, -509.3824671135449, -372.63195927020274, -615.209245095263, -1027.7809869174766, -933.6360234563123, -1162.7633346860073, -367.30369484198945, -900.5647861993402, -16.635399950243492, -843.4442174372281, -17.732588886958226, -314.9928091637512, -1137.730680689692, -944.9976431822245, -392.86311072969363, -99.89722690600878, -432.76729942383236, -617.5404346625049, -505.1024034068743, -1358.8691189490885, -767.1840573188875, -946.2961041261805, -65.70731105535896, -33.070565578669004, -935.1579867837238, -423.98819386933286, -818.8264002555109, -676.0824005045718, -913.9448748344614, -1125.618114110398, -1148.0507115628334, -334.41227365001976, -431.23299208889046, -984.2099440888804, -53.57732287028478, -430.8591076612927, -595.2321131875868, -649.8057849823558, -480.8881933032401, -630.9430025103924, -1010.5688168645625, -136.00177595125453, -226.25691543752984, -572.5270579765345, -937.524952089255, -797.2305157108566, -835.3731838667987, -1158.3708532462488, -97.15040164491587, -1017.8412453917756, -8.610210069118837, -954.2932545707098, -841.5028088613603, -1053.2271007671895, -324.17079395931717, -1039.07984347231, -748.6949366189519, -756.5017948019631, -1201.9963405511432, -966.1618004202139, -1055.407684059419, -197.54866615134554, -809.3275692969024, -1141.0226783225007, -1108.5408799200236, -1001.5972536159203, -1206.1618678804716, -1117.9209340460345, -687.2457339208514, -951.6761613833357, -475.59368014619264, -1346.96989358292, -523.0934226718275, -715.7213317211435, -1192.1706834166082, -1334.1279475250833, -944.6974412458973, -643.9964403720645, -22.915492999804016, -452.49681226611517, -892.4681428839335, -671.1043484793661, -1082.6227882492065]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5631232771496814, "mean_inference_ms": 1.668989296828901, "mean_action_processing_ms": 0.28038098586126226, "mean_env_wait_ms": 3.394155506324539, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013094902038574219, "StateBufferConnector_ms": 0.008535385131835938, "ViewRequirementAgentConnector_ms": 0.18306660652160645}, "num_episodes": 30, "episode_return_max": -8.610210069118837, "episode_return_min": -1358.8691189490885, "episode_return_mean": -697.2743660846322, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 334.53570155053916, "num_env_steps_trained_throughput_per_sec": 334.53570155053916, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 11960.348, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11960.277, "sample_time_ms": 1142.467, "learn_time_ms": 10750.901, "learn_throughput": 372.062, "synch_weights_time_ms": 66.105}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "4b94b_00000", "date": "2024-08-05_11-41-06", "timestamp": 1722838266, "time_this_iter_s": 11.969563245773315, "time_total_s": 71.82910537719727, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e11156b6d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 71.82910537719727, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 22.341176470588238, "ram_util_percent": 29.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 148.77294610540073, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.4111412727584443, "policy_loss": -0.006009643749469736, "vf_loss": 1.4184225221474966, "vf_explained_var": 0.9799622775365909, "kl": 0.006549894858532453, "entropy": 1.3534796953201294, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -8.610210069118837, "episode_reward_min": -1358.8691189490885, "episode_reward_mean": -708.5154784047306, "episode_len_mean": 127.29, "episode_media": {}, "episodes_timesteps_total": 12729, "policy_reward_min": {"policy_0": -1358.8691189490885}, "policy_reward_max": {"policy_0": -8.610210069118837}, "policy_reward_mean": {"policy_0": -708.5154784047306}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-617.5404346625049, -505.1024034068743, -1358.8691189490885, -767.1840573188875, -946.2961041261805, -65.70731105535896, -33.070565578669004, -935.1579867837238, -423.98819386933286, -818.8264002555109, -676.0824005045718, -913.9448748344614, -1125.618114110398, -1148.0507115628334, -334.41227365001976, -431.23299208889046, -984.2099440888804, -53.57732287028478, -430.8591076612927, -595.2321131875868, -649.8057849823558, -480.8881933032401, -630.9430025103924, -1010.5688168645625, -136.00177595125453, -226.25691543752984, -572.5270579765345, -937.524952089255, -797.2305157108566, -835.3731838667987, -1158.3708532462488, -97.15040164491587, -1017.8412453917756, -8.610210069118837, -954.2932545707098, -841.5028088613603, -1053.2271007671895, -324.17079395931717, -1039.07984347231, -748.6949366189519, -756.5017948019631, -1201.9963405511432, -966.1618004202139, -1055.407684059419, -197.54866615134554, -809.3275692969024, -1141.0226783225007, -1108.5408799200236, -1001.5972536159203, -1206.1618678804716, -1117.9209340460345, -687.2457339208514, -951.6761613833357, -475.59368014619264, -1346.96989358292, -523.0934226718275, -715.7213317211435, -1192.1706834166082, -1334.1279475250833, -944.6974412458973, -643.9964403720645, -22.915492999804016, -452.49681226611517, -892.4681428839335, -671.1043484793661, -1082.6227882492065, -628.4268680885223, -28.93694028689412, -126.07047622471589, -45.840630803471555, -1111.110074313855, -502.6844335624201, -899.1218344590601, -946.6050304269739, -1010.672838705076, -1283.255040119489, -1048.0456263316448, -959.4608480555761, -1122.9577071133087, -691.0917341898272, -1176.60631770771, -441.73239444241625, -547.7533430474851, -468.68671890949093, -1207.3802898636134, -626.3085992060167, -726.7488736459195, -114.34330148393543, -14.299988099310593, -231.3112410038771, -644.835915231674, -334.85134526369956, -934.8141019672829, -53.076528587963836, -347.34393554699574, -191.44728275861502, -732.752507287269, -820.6623796631208, -594.185442542896, -1054.0153837426362], "episode_lengths": [150, 129, 150, 150, 150, 39, 39, 150, 102, 150, 135, 150, 150, 150, 97, 108, 150, 49, 102, 121, 150, 150, 150, 150, 80, 71, 150, 150, 150, 150, 150, 74, 150, 39, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 95, 138, 150, 150, 150, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 121, 39, 101, 150, 150, 150, 126, 35, 56, 46, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 141, 146, 73, 40, 71, 130, 90, 150, 49, 97, 90, 150, 150, 121, 150], "policy_policy_0_reward": [-617.5404346625049, -505.1024034068743, -1358.8691189490885, -767.1840573188875, -946.2961041261805, -65.70731105535896, -33.070565578669004, -935.1579867837238, -423.98819386933286, -818.8264002555109, -676.0824005045718, -913.9448748344614, -1125.618114110398, -1148.0507115628334, -334.41227365001976, -431.23299208889046, -984.2099440888804, -53.57732287028478, -430.8591076612927, -595.2321131875868, -649.8057849823558, -480.8881933032401, -630.9430025103924, -1010.5688168645625, -136.00177595125453, -226.25691543752984, -572.5270579765345, -937.524952089255, -797.2305157108566, -835.3731838667987, -1158.3708532462488, -97.15040164491587, -1017.8412453917756, -8.610210069118837, -954.2932545707098, -841.5028088613603, -1053.2271007671895, -324.17079395931717, -1039.07984347231, -748.6949366189519, -756.5017948019631, -1201.9963405511432, -966.1618004202139, -1055.407684059419, -197.54866615134554, -809.3275692969024, -1141.0226783225007, -1108.5408799200236, -1001.5972536159203, -1206.1618678804716, -1117.9209340460345, -687.2457339208514, -951.6761613833357, -475.59368014619264, -1346.96989358292, -523.0934226718275, -715.7213317211435, -1192.1706834166082, -1334.1279475250833, -944.6974412458973, -643.9964403720645, -22.915492999804016, -452.49681226611517, -892.4681428839335, -671.1043484793661, -1082.6227882492065, -628.4268680885223, -28.93694028689412, -126.07047622471589, -45.840630803471555, -1111.110074313855, -502.6844335624201, -899.1218344590601, -946.6050304269739, -1010.672838705076, -1283.255040119489, -1048.0456263316448, -959.4608480555761, -1122.9577071133087, -691.0917341898272, -1176.60631770771, -441.73239444241625, -547.7533430474851, -468.68671890949093, -1207.3802898636134, -626.3085992060167, -726.7488736459195, -114.34330148393543, -14.299988099310593, -231.3112410038771, -644.835915231674, -334.85134526369956, -934.8141019672829, -53.076528587963836, -347.34393554699574, -191.44728275861502, -732.752507287269, -820.6623796631208, -594.185442542896, -1054.0153837426362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5610751541315045, "mean_inference_ms": 1.6733311662266734, "mean_action_processing_ms": 0.28029497227168265, "mean_env_wait_ms": 3.3954734439140832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016340255737304688, "StateBufferConnector_ms": 0.008297443389892578, "ViewRequirementAgentConnector_ms": 0.18258190155029297}, "num_episodes": 34, "episode_return_max": -8.610210069118837, "episode_return_min": -1358.8691189490885, "episode_return_mean": -708.5154784047306, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.05018846126796, "num_env_steps_trained_throughput_per_sec": 326.05018846126796, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12004.307, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12004.237, "sample_time_ms": 1136.732, "learn_time_ms": 10801.302, "learn_throughput": 370.326, "synch_weights_time_ms": 65.407}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "4b94b_00000", "date": "2024-08-05_11-41-18", "timestamp": 1722838278, "time_this_iter_s": 12.280820608139038, "time_total_s": 84.1099259853363, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e11156bac0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 84.1099259853363, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 20.11764705882353, "ram_util_percent": 29.211764705882352}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 177.8828219850858, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.0308860106704136, "policy_loss": -0.0008053451131369608, "vf_loss": 1.0329862081445753, "vf_explained_var": 0.9885933644448718, "kl": 0.006241293543858247, "entropy": 1.372868878642718, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -6.41475912063954, "episode_reward_min": -1346.96989358292, "episode_reward_mean": -739.9167076749204, "episode_len_mean": 129.0, "episode_media": {}, "episodes_timesteps_total": 12900, "policy_reward_min": {"policy_0": -1346.96989358292}, "policy_reward_max": {"policy_0": -6.41475912063954}, "policy_reward_mean": {"policy_0": -739.9167076749204}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1158.3708532462488, -97.15040164491587, -1017.8412453917756, -8.610210069118837, -954.2932545707098, -841.5028088613603, -1053.2271007671895, -324.17079395931717, -1039.07984347231, -748.6949366189519, -756.5017948019631, -1201.9963405511432, -966.1618004202139, -1055.407684059419, -197.54866615134554, -809.3275692969024, -1141.0226783225007, -1108.5408799200236, -1001.5972536159203, -1206.1618678804716, -1117.9209340460345, -687.2457339208514, -951.6761613833357, -475.59368014619264, -1346.96989358292, -523.0934226718275, -715.7213317211435, -1192.1706834166082, -1334.1279475250833, -944.6974412458973, -643.9964403720645, -22.915492999804016, -452.49681226611517, -892.4681428839335, -671.1043484793661, -1082.6227882492065, -628.4268680885223, -28.93694028689412, -126.07047622471589, -45.840630803471555, -1111.110074313855, -502.6844335624201, -899.1218344590601, -946.6050304269739, -1010.672838705076, -1283.255040119489, -1048.0456263316448, -959.4608480555761, -1122.9577071133087, -691.0917341898272, -1176.60631770771, -441.73239444241625, -547.7533430474851, -468.68671890949093, -1207.3802898636134, -626.3085992060167, -726.7488736459195, -114.34330148393543, -14.299988099310593, -231.3112410038771, -644.835915231674, -334.85134526369956, -934.8141019672829, -53.076528587963836, -347.34393554699574, -191.44728275861502, -732.752507287269, -820.6623796631208, -594.185442542896, -1054.0153837426362, -1020.8657596671812, -831.8472834219915, -1044.3337370214347, -1181.3580846046675, -1093.296902287266, -153.6655369452455, -1320.7613954732387, -901.9614771901796, -727.6532033249949, -1078.8374577653967, -795.914581686017, -1012.3363810076305, -1069.2897639720943, -442.92223782194, -6.41475912063954, -579.8705004535722, -611.6454124988661, -346.31368955149316, -913.5346374775092, -1198.0593445884788, -705.1039286675193, -1151.9388946538936, -374.61112461680773, -966.2424734828923, -88.45322093922718, -900.2959853799604, -603.8631485741106, -29.99298046317776, -1080.443068738498, -350.3785848811687], "episode_lengths": [150, 74, 150, 39, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 95, 138, 150, 150, 150, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 121, 39, 101, 150, 150, 150, 126, 35, 56, 46, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 141, 146, 73, 40, 71, 130, 90, 150, 49, 97, 90, 150, 150, 121, 150, 150, 150, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 35, 113, 150, 103, 150, 150, 150, 150, 132, 150, 69, 150, 130, 42, 150, 91], "policy_policy_0_reward": [-1158.3708532462488, -97.15040164491587, -1017.8412453917756, -8.610210069118837, -954.2932545707098, -841.5028088613603, -1053.2271007671895, -324.17079395931717, -1039.07984347231, -748.6949366189519, -756.5017948019631, -1201.9963405511432, -966.1618004202139, -1055.407684059419, -197.54866615134554, -809.3275692969024, -1141.0226783225007, -1108.5408799200236, -1001.5972536159203, -1206.1618678804716, -1117.9209340460345, -687.2457339208514, -951.6761613833357, -475.59368014619264, -1346.96989358292, -523.0934226718275, -715.7213317211435, -1192.1706834166082, -1334.1279475250833, -944.6974412458973, -643.9964403720645, -22.915492999804016, -452.49681226611517, -892.4681428839335, -671.1043484793661, -1082.6227882492065, -628.4268680885223, -28.93694028689412, -126.07047622471589, -45.840630803471555, -1111.110074313855, -502.6844335624201, -899.1218344590601, -946.6050304269739, -1010.672838705076, -1283.255040119489, -1048.0456263316448, -959.4608480555761, -1122.9577071133087, -691.0917341898272, -1176.60631770771, -441.73239444241625, -547.7533430474851, -468.68671890949093, -1207.3802898636134, -626.3085992060167, -726.7488736459195, -114.34330148393543, -14.299988099310593, -231.3112410038771, -644.835915231674, -334.85134526369956, -934.8141019672829, -53.076528587963836, -347.34393554699574, -191.44728275861502, -732.752507287269, -820.6623796631208, -594.185442542896, -1054.0153837426362, -1020.8657596671812, -831.8472834219915, -1044.3337370214347, -1181.3580846046675, -1093.296902287266, -153.6655369452455, -1320.7613954732387, -901.9614771901796, -727.6532033249949, -1078.8374577653967, -795.914581686017, -1012.3363810076305, -1069.2897639720943, -442.92223782194, -6.41475912063954, -579.8705004535722, -611.6454124988661, -346.31368955149316, -913.5346374775092, -1198.0593445884788, -705.1039286675193, -1151.9388946538936, -374.61112461680773, -966.2424734828923, -88.45322093922718, -900.2959853799604, -603.8631485741106, -29.99298046317776, -1080.443068738498, -350.3785848811687]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5613187663260168, "mean_inference_ms": 1.6767746050375778, "mean_action_processing_ms": 0.2802142095236221, "mean_env_wait_ms": 3.400602722254374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01655411720275879, "StateBufferConnector_ms": 0.00826406478881836, "ViewRequirementAgentConnector_ms": 0.18702936172485352}, "num_episodes": 30, "episode_return_max": -6.41475912063954, "episode_return_min": -1346.96989358292, "episode_return_mean": -739.9167076749204, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.20287011704005, "num_env_steps_trained_throughput_per_sec": 323.20287011704005, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12050.786, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12050.716, "sample_time_ms": 1132.857, "learn_time_ms": 10851.816, "learn_throughput": 368.602, "synch_weights_time_ms": 65.252}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "4b94b_00000", "date": "2024-08-05_11-41-31", "timestamp": 1722838291, "time_this_iter_s": 12.387528419494629, "time_total_s": 96.49745440483093, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1113d2710>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 96.49745440483093, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 18.06666666666667, "ram_util_percent": 29.200000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 179.05383485953013, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9908835884649306, "policy_loss": -0.003489436516247224, "vf_loss": 0.9956718017191937, "vf_explained_var": 0.9945912565415104, "kl": 0.006382954554283065, "entropy": 1.3785626442482075, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -6.41475912063954, "episode_reward_min": -1400.7981290498522, "episode_reward_mean": -728.1847639647631, "episode_len_mean": 128.63, "episode_media": {}, "episodes_timesteps_total": 12863, "policy_reward_min": {"policy_0": -1400.7981290498522}, "policy_reward_max": {"policy_0": -6.41475912063954}, "policy_reward_mean": {"policy_0": -728.1847639647631}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-944.6974412458973, -643.9964403720645, -22.915492999804016, -452.49681226611517, -892.4681428839335, -671.1043484793661, -1082.6227882492065, -628.4268680885223, -28.93694028689412, -126.07047622471589, -45.840630803471555, -1111.110074313855, -502.6844335624201, -899.1218344590601, -946.6050304269739, -1010.672838705076, -1283.255040119489, -1048.0456263316448, -959.4608480555761, -1122.9577071133087, -691.0917341898272, -1176.60631770771, -441.73239444241625, -547.7533430474851, -468.68671890949093, -1207.3802898636134, -626.3085992060167, -726.7488736459195, -114.34330148393543, -14.299988099310593, -231.3112410038771, -644.835915231674, -334.85134526369956, -934.8141019672829, -53.076528587963836, -347.34393554699574, -191.44728275861502, -732.752507287269, -820.6623796631208, -594.185442542896, -1054.0153837426362, -1020.8657596671812, -831.8472834219915, -1044.3337370214347, -1181.3580846046675, -1093.296902287266, -153.6655369452455, -1320.7613954732387, -901.9614771901796, -727.6532033249949, -1078.8374577653967, -795.914581686017, -1012.3363810076305, -1069.2897639720943, -442.92223782194, -6.41475912063954, -579.8705004535722, -611.6454124988661, -346.31368955149316, -913.5346374775092, -1198.0593445884788, -705.1039286675193, -1151.9388946538936, -374.61112461680773, -966.2424734828923, -88.45322093922718, -900.2959853799604, -603.8631485741106, -29.99298046317776, -1080.443068738498, -350.3785848811687, -777.1341653914046, -426.5919013639423, -733.7654911757278, -1157.742737803846, -985.6269427710537, -464.40651353330964, -735.7348163251984, -920.9814137587683, -716.4252438297738, -843.7626801498338, -1400.7981290498522, -1040.5146617647633, -884.0924791564988, -1280.7887930804081, -1035.484743325263, -837.2393244734106, -555.1595355804286, -1036.5270238670562, -1047.7188901045395, -519.0934141331373, -91.74658445360267, -430.9751525628529, -896.4624304315535, -1067.289700729554, -888.6208928745225, -1309.3318112738332, -95.70085450412648, -1400.3236678823264, -278.4934056694764], "episode_lengths": [150, 121, 39, 101, 150, 150, 150, 126, 35, 56, 46, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 141, 146, 73, 40, 71, 130, 90, 150, 49, 97, 90, 150, 150, 121, 150, 150, 150, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 35, 113, 150, 103, 150, 150, 150, 150, 132, 150, 69, 150, 130, 42, 150, 91, 150, 124, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 127, 76, 150, 150, 150, 150, 150, 54, 150, 82], "policy_policy_0_reward": [-944.6974412458973, -643.9964403720645, -22.915492999804016, -452.49681226611517, -892.4681428839335, -671.1043484793661, -1082.6227882492065, -628.4268680885223, -28.93694028689412, -126.07047622471589, -45.840630803471555, -1111.110074313855, -502.6844335624201, -899.1218344590601, -946.6050304269739, -1010.672838705076, -1283.255040119489, -1048.0456263316448, -959.4608480555761, -1122.9577071133087, -691.0917341898272, -1176.60631770771, -441.73239444241625, -547.7533430474851, -468.68671890949093, -1207.3802898636134, -626.3085992060167, -726.7488736459195, -114.34330148393543, -14.299988099310593, -231.3112410038771, -644.835915231674, -334.85134526369956, -934.8141019672829, -53.076528587963836, -347.34393554699574, -191.44728275861502, -732.752507287269, -820.6623796631208, -594.185442542896, -1054.0153837426362, -1020.8657596671812, -831.8472834219915, -1044.3337370214347, -1181.3580846046675, -1093.296902287266, -153.6655369452455, -1320.7613954732387, -901.9614771901796, -727.6532033249949, -1078.8374577653967, -795.914581686017, -1012.3363810076305, -1069.2897639720943, -442.92223782194, -6.41475912063954, -579.8705004535722, -611.6454124988661, -346.31368955149316, -913.5346374775092, -1198.0593445884788, -705.1039286675193, -1151.9388946538936, -374.61112461680773, -966.2424734828923, -88.45322093922718, -900.2959853799604, -603.8631485741106, -29.99298046317776, -1080.443068738498, -350.3785848811687, -777.1341653914046, -426.5919013639423, -733.7654911757278, -1157.742737803846, -985.6269427710537, -464.40651353330964, -735.7348163251984, -920.9814137587683, -716.4252438297738, -843.7626801498338, -1400.7981290498522, -1040.5146617647633, -884.0924791564988, -1280.7887930804081, -1035.484743325263, -837.2393244734106, -555.1595355804286, -1036.5270238670562, -1047.7188901045395, -519.0934141331373, -91.74658445360267, -430.9751525628529, -896.4624304315535, -1067.289700729554, -888.6208928745225, -1309.3318112738332, -95.70085450412648, -1400.3236678823264, -278.4934056694764]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5606371731015991, "mean_inference_ms": 1.6780410716260477, "mean_action_processing_ms": 0.2793357058472826, "mean_env_wait_ms": 3.405883096026033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0164029598236084, "StateBufferConnector_ms": 0.008232831954956055, "ViewRequirementAgentConnector_ms": 0.18924760818481445}, "num_episodes": 29, "episode_return_max": -6.41475912063954, "episode_return_min": -1400.7981290498522, "episode_return_mean": -728.1847639647631, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 357.84951696909434, "num_env_steps_trained_throughput_per_sec": 357.84951696909434, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 11953.798, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11953.729, "sample_time_ms": 1127.432, "learn_time_ms": 10761.011, "learn_throughput": 371.712, "synch_weights_time_ms": 64.497}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "4b94b_00000", "date": "2024-08-05_11-41-42", "timestamp": 1722838302, "time_this_iter_s": 11.18964147567749, "time_total_s": 107.68709588050842, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e11156a710>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 107.68709588050842, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 18.84375, "ram_util_percent": 29.2125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 177.34971344470978, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9019889075309038, "policy_loss": -0.003847664718341548, "vf_loss": 0.9070831933369239, "vf_explained_var": 0.9902285113930702, "kl": 0.0072710607538662465, "entropy": 1.3375062922636667, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -6.41475912063954, "episode_reward_min": -1400.7981290498522, "episode_reward_mean": -765.2881852212424, "episode_len_mean": 131.67, "episode_media": {}, "episodes_timesteps_total": 13167, "policy_reward_min": {"policy_0": -1400.7981290498522}, "policy_reward_max": {"policy_0": -6.41475912063954}, "policy_reward_mean": {"policy_0": -765.2881852212424}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-231.3112410038771, -644.835915231674, -334.85134526369956, -934.8141019672829, -53.076528587963836, -347.34393554699574, -191.44728275861502, -732.752507287269, -820.6623796631208, -594.185442542896, -1054.0153837426362, -1020.8657596671812, -831.8472834219915, -1044.3337370214347, -1181.3580846046675, -1093.296902287266, -153.6655369452455, -1320.7613954732387, -901.9614771901796, -727.6532033249949, -1078.8374577653967, -795.914581686017, -1012.3363810076305, -1069.2897639720943, -442.92223782194, -6.41475912063954, -579.8705004535722, -611.6454124988661, -346.31368955149316, -913.5346374775092, -1198.0593445884788, -705.1039286675193, -1151.9388946538936, -374.61112461680773, -966.2424734828923, -88.45322093922718, -900.2959853799604, -603.8631485741106, -29.99298046317776, -1080.443068738498, -350.3785848811687, -777.1341653914046, -426.5919013639423, -733.7654911757278, -1157.742737803846, -985.6269427710537, -464.40651353330964, -735.7348163251984, -920.9814137587683, -716.4252438297738, -843.7626801498338, -1400.7981290498522, -1040.5146617647633, -884.0924791564988, -1280.7887930804081, -1035.484743325263, -837.2393244734106, -555.1595355804286, -1036.5270238670562, -1047.7188901045395, -519.0934141331373, -91.74658445360267, -430.9751525628529, -896.4624304315535, -1067.289700729554, -888.6208928745225, -1309.3318112738332, -95.70085450412648, -1400.3236678823264, -278.4934056694764, -1058.157138682812, -445.6721114160856, -1071.8727048113728, -865.094633831145, -77.64599475087036, -475.9875117196826, -449.0627386791704, -1159.0875592849663, -706.7638026773874, -1215.066097536628, -900.9272554414312, -597.9319077695129, -609.5065952214256, -448.1756987256707, -1039.7101934813254, -1229.494553514304, -688.989446738866, -1357.5239021583477, -777.924384329152, -1121.664436143072, -1145.850013544105, -108.46143123417994, -946.7611115907878, -853.0652037644973, -46.087871625087764, -1054.0357445315078, -37.66854450109397, -1255.3792485814085, -1247.2336283939408, -1157.9820365512235], "episode_lengths": [71, 130, 90, 150, 49, 97, 90, 150, 150, 121, 150, 150, 150, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 35, 113, 150, 103, 150, 150, 150, 150, 132, 150, 69, 150, 130, 42, 150, 91, 150, 124, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 127, 76, 150, 150, 150, 150, 150, 54, 150, 82, 150, 99, 150, 150, 64, 113, 150, 150, 150, 150, 150, 150, 127, 109, 150, 150, 150, 150, 150, 150, 150, 75, 150, 150, 56, 150, 42, 150, 150, 150], "policy_policy_0_reward": [-231.3112410038771, -644.835915231674, -334.85134526369956, -934.8141019672829, -53.076528587963836, -347.34393554699574, -191.44728275861502, -732.752507287269, -820.6623796631208, -594.185442542896, -1054.0153837426362, -1020.8657596671812, -831.8472834219915, -1044.3337370214347, -1181.3580846046675, -1093.296902287266, -153.6655369452455, -1320.7613954732387, -901.9614771901796, -727.6532033249949, -1078.8374577653967, -795.914581686017, -1012.3363810076305, -1069.2897639720943, -442.92223782194, -6.41475912063954, -579.8705004535722, -611.6454124988661, -346.31368955149316, -913.5346374775092, -1198.0593445884788, -705.1039286675193, -1151.9388946538936, -374.61112461680773, -966.2424734828923, -88.45322093922718, -900.2959853799604, -603.8631485741106, -29.99298046317776, -1080.443068738498, -350.3785848811687, -777.1341653914046, -426.5919013639423, -733.7654911757278, -1157.742737803846, -985.6269427710537, -464.40651353330964, -735.7348163251984, -920.9814137587683, -716.4252438297738, -843.7626801498338, -1400.7981290498522, -1040.5146617647633, -884.0924791564988, -1280.7887930804081, -1035.484743325263, -837.2393244734106, -555.1595355804286, -1036.5270238670562, -1047.7188901045395, -519.0934141331373, -91.74658445360267, -430.9751525628529, -896.4624304315535, -1067.289700729554, -888.6208928745225, -1309.3318112738332, -95.70085450412648, -1400.3236678823264, -278.4934056694764, -1058.157138682812, -445.6721114160856, -1071.8727048113728, -865.094633831145, -77.64599475087036, -475.9875117196826, -449.0627386791704, -1159.0875592849663, -706.7638026773874, -1215.066097536628, -900.9272554414312, -597.9319077695129, -609.5065952214256, -448.1756987256707, -1039.7101934813254, -1229.494553514304, -688.989446738866, -1357.5239021583477, -777.924384329152, -1121.664436143072, -1145.850013544105, -108.46143123417994, -946.7611115907878, -853.0652037644973, -46.087871625087764, -1054.0357445315078, -37.66854450109397, -1255.3792485814085, -1247.2336283939408, -1157.9820365512235]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5593476973108448, "mean_inference_ms": 1.6758546265510461, "mean_action_processing_ms": 0.27853585849533735, "mean_env_wait_ms": 3.4048713038513565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012527942657470703, "StateBufferConnector_ms": 0.008133411407470703, "ViewRequirementAgentConnector_ms": 0.19200491905212402}, "num_episodes": 30, "episode_return_max": -6.41475912063954, "episode_return_min": -1400.7981290498522, "episode_return_mean": -765.2881852212424, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 327.42222534216177, "num_env_steps_trained_throughput_per_sec": 327.42222534216177, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 11980.084, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11980.014, "sample_time_ms": 1122.095, "learn_time_ms": 10792.187, "learn_throughput": 370.638, "synch_weights_time_ms": 64.933}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "4b94b_00000", "date": "2024-08-05_11-41-54", "timestamp": 1722838314, "time_this_iter_s": 12.229850053787231, "time_total_s": 119.91694593429565, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e11156bac0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 119.91694593429565, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 18.370588235294118, "ram_util_percent": 29.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 162.54723861813545, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.8498927513680731, "policy_loss": -0.004157439546543173, "vf_loss": 0.855353148219486, "vf_explained_var": 0.9954554557179411, "kl": 0.007694121771085829, "entropy": 1.3991334068278471, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -24.03189659792796, "episode_reward_min": -1400.7981290498522, "episode_reward_mean": -765.3362471111295, "episode_len_mean": 132.72, "episode_media": {}, "episodes_timesteps_total": 13272, "policy_reward_min": {"policy_0": -1400.7981290498522}, "policy_reward_max": {"policy_0": -24.03189659792796}, "policy_reward_mean": {"policy_0": -765.3362471111295}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-705.1039286675193, -1151.9388946538936, -374.61112461680773, -966.2424734828923, -88.45322093922718, -900.2959853799604, -603.8631485741106, -29.99298046317776, -1080.443068738498, -350.3785848811687, -777.1341653914046, -426.5919013639423, -733.7654911757278, -1157.742737803846, -985.6269427710537, -464.40651353330964, -735.7348163251984, -920.9814137587683, -716.4252438297738, -843.7626801498338, -1400.7981290498522, -1040.5146617647633, -884.0924791564988, -1280.7887930804081, -1035.484743325263, -837.2393244734106, -555.1595355804286, -1036.5270238670562, -1047.7188901045395, -519.0934141331373, -91.74658445360267, -430.9751525628529, -896.4624304315535, -1067.289700729554, -888.6208928745225, -1309.3318112738332, -95.70085450412648, -1400.3236678823264, -278.4934056694764, -1058.157138682812, -445.6721114160856, -1071.8727048113728, -865.094633831145, -77.64599475087036, -475.9875117196826, -449.0627386791704, -1159.0875592849663, -706.7638026773874, -1215.066097536628, -900.9272554414312, -597.9319077695129, -609.5065952214256, -448.1756987256707, -1039.7101934813254, -1229.494553514304, -688.989446738866, -1357.5239021583477, -777.924384329152, -1121.664436143072, -1145.850013544105, -108.46143123417994, -946.7611115907878, -853.0652037644973, -46.087871625087764, -1054.0357445315078, -37.66854450109397, -1255.3792485814085, -1247.2336283939408, -1157.9820365512235, -457.2939423240861, -1022.2659850140285, -687.7392731625939, -919.4814843257585, -304.3114429895158, -1148.1209239575567, -804.1598503420583, -1019.2286703032461, -614.6068243373254, -1058.0786560155952, -1139.6297347663733, -979.7632911229427, -972.5479108824023, -1239.50766936529, -1041.972065907568, -450.5522631565141, -1348.7031369579768, -961.2841193572459, -769.4132146267247, -564.5682171864338, -24.03189659792796, -75.904340479175, -65.15446030571209, -773.7916718425774, -523.6537650464139, -33.784513622294746, -754.71356878471, -646.7910758501333, -174.65236707539128, -680.188370346026, -1019.0896924129581], "episode_lengths": [150, 150, 132, 150, 69, 150, 130, 42, 150, 91, 150, 124, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 127, 76, 150, 150, 150, 150, 150, 54, 150, 82, 150, 99, 150, 150, 64, 113, 150, 150, 150, 150, 150, 150, 127, 109, 150, 150, 150, 150, 150, 150, 150, 75, 150, 150, 56, 150, 42, 150, 150, 150, 130, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 37, 65, 56, 141, 150, 41, 150, 150, 63, 150, 150], "policy_policy_0_reward": [-705.1039286675193, -1151.9388946538936, -374.61112461680773, -966.2424734828923, -88.45322093922718, -900.2959853799604, -603.8631485741106, -29.99298046317776, -1080.443068738498, -350.3785848811687, -777.1341653914046, -426.5919013639423, -733.7654911757278, -1157.742737803846, -985.6269427710537, -464.40651353330964, -735.7348163251984, -920.9814137587683, -716.4252438297738, -843.7626801498338, -1400.7981290498522, -1040.5146617647633, -884.0924791564988, -1280.7887930804081, -1035.484743325263, -837.2393244734106, -555.1595355804286, -1036.5270238670562, -1047.7188901045395, -519.0934141331373, -91.74658445360267, -430.9751525628529, -896.4624304315535, -1067.289700729554, -888.6208928745225, -1309.3318112738332, -95.70085450412648, -1400.3236678823264, -278.4934056694764, -1058.157138682812, -445.6721114160856, -1071.8727048113728, -865.094633831145, -77.64599475087036, -475.9875117196826, -449.0627386791704, -1159.0875592849663, -706.7638026773874, -1215.066097536628, -900.9272554414312, -597.9319077695129, -609.5065952214256, -448.1756987256707, -1039.7101934813254, -1229.494553514304, -688.989446738866, -1357.5239021583477, -777.924384329152, -1121.664436143072, -1145.850013544105, -108.46143123417994, -946.7611115907878, -853.0652037644973, -46.087871625087764, -1054.0357445315078, -37.66854450109397, -1255.3792485814085, -1247.2336283939408, -1157.9820365512235, -457.2939423240861, -1022.2659850140285, -687.7392731625939, -919.4814843257585, -304.3114429895158, -1148.1209239575567, -804.1598503420583, -1019.2286703032461, -614.6068243373254, -1058.0786560155952, -1139.6297347663733, -979.7632911229427, -972.5479108824023, -1239.50766936529, -1041.972065907568, -450.5522631565141, -1348.7031369579768, -961.2841193572459, -769.4132146267247, -564.5682171864338, -24.03189659792796, -75.904340479175, -65.15446030571209, -773.7916718425774, -523.6537650464139, -33.784513622294746, -754.71356878471, -646.7910758501333, -174.65236707539128, -680.188370346026, -1019.0896924129581]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5573568951953534, "mean_inference_ms": 1.6750671963932808, "mean_action_processing_ms": 0.27824641941041794, "mean_env_wait_ms": 3.4098486482070225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012427806854248047, "StateBufferConnector_ms": 0.008074045181274414, "ViewRequirementAgentConnector_ms": 0.19028401374816895}, "num_episodes": 31, "episode_return_max": -24.03189659792796, "episode_return_min": -1400.7981290498522, "episode_return_mean": -765.3362471111295, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.6230336718993, "num_env_steps_trained_throughput_per_sec": 315.6230336718993, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12088.852, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12088.782, "sample_time_ms": 1134.155, "learn_time_ms": 10887.207, "learn_throughput": 367.404, "synch_weights_time_ms": 66.615}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "4b94b_00000", "date": "2024-08-05_11-42-07", "timestamp": 1722838327, "time_this_iter_s": 12.685235738754272, "time_total_s": 132.60218167304993, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1113d37f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 132.60218167304993, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 17.961111111111112, "ram_util_percent": 29.200000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 171.60788832505543, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9416932319290936, "policy_loss": -0.002400103849261844, "vf_loss": 0.9454432215541602, "vf_explained_var": 0.9939757294331988, "kl": 0.006554489384734552, "entropy": 1.4318141070504984, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -8.4350052504056, "episode_reward_min": -1400.3236678823264, "episode_reward_mean": -726.8139356017346, "episode_len_mean": 129.73, "episode_media": {}, "episodes_timesteps_total": 12973, "policy_reward_min": {"policy_0": -1400.3236678823264}, "policy_reward_max": {"policy_0": -8.4350052504056}, "policy_reward_mean": {"policy_0": -726.8139356017346}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-896.4624304315535, -1067.289700729554, -888.6208928745225, -1309.3318112738332, -95.70085450412648, -1400.3236678823264, -278.4934056694764, -1058.157138682812, -445.6721114160856, -1071.8727048113728, -865.094633831145, -77.64599475087036, -475.9875117196826, -449.0627386791704, -1159.0875592849663, -706.7638026773874, -1215.066097536628, -900.9272554414312, -597.9319077695129, -609.5065952214256, -448.1756987256707, -1039.7101934813254, -1229.494553514304, -688.989446738866, -1357.5239021583477, -777.924384329152, -1121.664436143072, -1145.850013544105, -108.46143123417994, -946.7611115907878, -853.0652037644973, -46.087871625087764, -1054.0357445315078, -37.66854450109397, -1255.3792485814085, -1247.2336283939408, -1157.9820365512235, -457.2939423240861, -1022.2659850140285, -687.7392731625939, -919.4814843257585, -304.3114429895158, -1148.1209239575567, -804.1598503420583, -1019.2286703032461, -614.6068243373254, -1058.0786560155952, -1139.6297347663733, -979.7632911229427, -972.5479108824023, -1239.50766936529, -1041.972065907568, -450.5522631565141, -1348.7031369579768, -961.2841193572459, -769.4132146267247, -564.5682171864338, -24.03189659792796, -75.904340479175, -65.15446030571209, -773.7916718425774, -523.6537650464139, -33.784513622294746, -754.71356878471, -646.7910758501333, -174.65236707539128, -680.188370346026, -1019.0896924129581, -945.1818971121317, -423.9978150652128, -956.0337134851427, -74.90659230209646, -199.85192446804922, -1014.0908248571116, -586.5384161691342, -891.414773716781, -398.39005916744753, -805.4145612543094, -927.6996100249096, -8.4350052504056, -199.41196630367108, -446.45988194813015, -113.58588513887399, -1148.3506495394781, -772.0386262596434, -901.9876685257354, -356.4408820504454, -845.0632174060273, -1016.3747305462872, -1190.9336999797708, -1005.5936196415868, -360.35142797902165, -646.8027998478061, -1007.4269313493528, -240.50917617723496, -436.0866151229443, -851.6989219570252, -44.81945664648542, -1091.2610293071025, -414.25051851310536], "episode_lengths": [150, 150, 150, 150, 54, 150, 82, 150, 99, 150, 150, 64, 113, 150, 150, 150, 150, 150, 150, 127, 109, 150, 150, 150, 150, 150, 150, 150, 75, 150, 150, 56, 150, 42, 150, 150, 150, 130, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 37, 65, 56, 141, 150, 41, 150, 150, 63, 150, 150, 150, 142, 150, 56, 77, 150, 150, 150, 150, 150, 150, 41, 78, 144, 81, 150, 150, 150, 108, 150, 150, 150, 150, 92, 150, 150, 101, 106, 150, 49, 150, 95], "policy_policy_0_reward": [-896.4624304315535, -1067.289700729554, -888.6208928745225, -1309.3318112738332, -95.70085450412648, -1400.3236678823264, -278.4934056694764, -1058.157138682812, -445.6721114160856, -1071.8727048113728, -865.094633831145, -77.64599475087036, -475.9875117196826, -449.0627386791704, -1159.0875592849663, -706.7638026773874, -1215.066097536628, -900.9272554414312, -597.9319077695129, -609.5065952214256, -448.1756987256707, -1039.7101934813254, -1229.494553514304, -688.989446738866, -1357.5239021583477, -777.924384329152, -1121.664436143072, -1145.850013544105, -108.46143123417994, -946.7611115907878, -853.0652037644973, -46.087871625087764, -1054.0357445315078, -37.66854450109397, -1255.3792485814085, -1247.2336283939408, -1157.9820365512235, -457.2939423240861, -1022.2659850140285, -687.7392731625939, -919.4814843257585, -304.3114429895158, -1148.1209239575567, -804.1598503420583, -1019.2286703032461, -614.6068243373254, -1058.0786560155952, -1139.6297347663733, -979.7632911229427, -972.5479108824023, -1239.50766936529, -1041.972065907568, -450.5522631565141, -1348.7031369579768, -961.2841193572459, -769.4132146267247, -564.5682171864338, -24.03189659792796, -75.904340479175, -65.15446030571209, -773.7916718425774, -523.6537650464139, -33.784513622294746, -754.71356878471, -646.7910758501333, -174.65236707539128, -680.188370346026, -1019.0896924129581, -945.1818971121317, -423.9978150652128, -956.0337134851427, -74.90659230209646, -199.85192446804922, -1014.0908248571116, -586.5384161691342, -891.414773716781, -398.39005916744753, -805.4145612543094, -927.6996100249096, -8.4350052504056, -199.41196630367108, -446.45988194813015, -113.58588513887399, -1148.3506495394781, -772.0386262596434, -901.9876685257354, -356.4408820504454, -845.0632174060273, -1016.3747305462872, -1190.9336999797708, -1005.5936196415868, -360.35142797902165, -646.8027998478061, -1007.4269313493528, -240.50917617723496, -436.0866151229443, -851.6989219570252, -44.81945664648542, -1091.2610293071025, -414.25051851310536]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5557885773325917, "mean_inference_ms": 1.6707220960890645, "mean_action_processing_ms": 0.2771159683069643, "mean_env_wait_ms": 3.40210981009737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011938095092773438, "StateBufferConnector_ms": 0.007829427719116211, "ViewRequirementAgentConnector_ms": 0.18821120262145996}, "num_episodes": 32, "episode_return_max": -8.4350052504056, "episode_return_min": -1400.3236678823264, "episode_return_mean": -726.8139356017346, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.97169778526643, "num_env_steps_trained_throughput_per_sec": 320.97169778526643, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12071.917, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12071.848, "sample_time_ms": 1130.646, "learn_time_ms": 10875.046, "learn_throughput": 367.815, "synch_weights_time_ms": 65.37}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "4b94b_00000", "date": "2024-08-05_11-42-19", "timestamp": 1722838339, "time_this_iter_s": 12.474950551986694, "time_total_s": 145.07713222503662, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e11156bb50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 145.07713222503662, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 17.705555555555556, "ram_util_percent": 29.200000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 150.067689666152, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.908863693382591, "policy_loss": -0.001354198379946562, "vf_loss": 0.9115440185181797, "vf_explained_var": 0.9899018310631315, "kl": 0.008207884125507318, "entropy": 1.4287251934409142, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -8.4350052504056, "episode_reward_min": -1407.161003207311, "episode_reward_mean": -711.5680902595033, "episode_len_mean": 127.9, "episode_media": {}, "episodes_timesteps_total": 12790, "policy_reward_min": {"policy_0": -1407.161003207311}, "policy_reward_max": {"policy_0": -8.4350052504056}, "policy_reward_mean": {"policy_0": -711.5680902595033}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-853.0652037644973, -46.087871625087764, -1054.0357445315078, -37.66854450109397, -1255.3792485814085, -1247.2336283939408, -1157.9820365512235, -457.2939423240861, -1022.2659850140285, -687.7392731625939, -919.4814843257585, -304.3114429895158, -1148.1209239575567, -804.1598503420583, -1019.2286703032461, -614.6068243373254, -1058.0786560155952, -1139.6297347663733, -979.7632911229427, -972.5479108824023, -1239.50766936529, -1041.972065907568, -450.5522631565141, -1348.7031369579768, -961.2841193572459, -769.4132146267247, -564.5682171864338, -24.03189659792796, -75.904340479175, -65.15446030571209, -773.7916718425774, -523.6537650464139, -33.784513622294746, -754.71356878471, -646.7910758501333, -174.65236707539128, -680.188370346026, -1019.0896924129581, -945.1818971121317, -423.9978150652128, -956.0337134851427, -74.90659230209646, -199.85192446804922, -1014.0908248571116, -586.5384161691342, -891.414773716781, -398.39005916744753, -805.4145612543094, -927.6996100249096, -8.4350052504056, -199.41196630367108, -446.45988194813015, -113.58588513887399, -1148.3506495394781, -772.0386262596434, -901.9876685257354, -356.4408820504454, -845.0632174060273, -1016.3747305462872, -1190.9336999797708, -1005.5936196415868, -360.35142797902165, -646.8027998478061, -1007.4269313493528, -240.50917617723496, -436.0866151229443, -851.6989219570252, -44.81945664648542, -1091.2610293071025, -414.25051851310536, -1003.8677714338419, -179.4671093369831, -305.69554334741815, -815.085589197912, -319.4242800372414, -1407.161003207311, -968.8241425646062, -1276.4913375413935, -1206.8989395257806, -97.7135177952061, -451.9947369911801, -527.9863946028295, -65.48899958842696, -646.143261980891, -1228.212599403149, -97.68372000062506, -943.1928607939664, -741.917458706456, -1384.7532110162579, -142.02382390556582, -1282.841942553726, -931.9884582215824, -980.3728720993668, -1125.9007991529206, -329.19937182987263, -515.5472349699006, -1118.143468183855, -490.55381697745094, -1010.8458431807932, -1313.5493442780298], "episode_lengths": [150, 56, 150, 42, 150, 150, 150, 130, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 37, 65, 56, 141, 150, 41, 150, 150, 63, 150, 150, 150, 142, 150, 56, 77, 150, 150, 150, 150, 150, 150, 41, 78, 144, 81, 150, 150, 150, 108, 150, 150, 150, 150, 92, 150, 150, 101, 106, 150, 49, 150, 95, 150, 87, 104, 138, 80, 150, 150, 150, 150, 54, 106, 150, 41, 119, 150, 63, 150, 150, 150, 67, 150, 150, 150, 150, 150, 136, 150, 145, 150, 150], "policy_policy_0_reward": [-853.0652037644973, -46.087871625087764, -1054.0357445315078, -37.66854450109397, -1255.3792485814085, -1247.2336283939408, -1157.9820365512235, -457.2939423240861, -1022.2659850140285, -687.7392731625939, -919.4814843257585, -304.3114429895158, -1148.1209239575567, -804.1598503420583, -1019.2286703032461, -614.6068243373254, -1058.0786560155952, -1139.6297347663733, -979.7632911229427, -972.5479108824023, -1239.50766936529, -1041.972065907568, -450.5522631565141, -1348.7031369579768, -961.2841193572459, -769.4132146267247, -564.5682171864338, -24.03189659792796, -75.904340479175, -65.15446030571209, -773.7916718425774, -523.6537650464139, -33.784513622294746, -754.71356878471, -646.7910758501333, -174.65236707539128, -680.188370346026, -1019.0896924129581, -945.1818971121317, -423.9978150652128, -956.0337134851427, -74.90659230209646, -199.85192446804922, -1014.0908248571116, -586.5384161691342, -891.414773716781, -398.39005916744753, -805.4145612543094, -927.6996100249096, -8.4350052504056, -199.41196630367108, -446.45988194813015, -113.58588513887399, -1148.3506495394781, -772.0386262596434, -901.9876685257354, -356.4408820504454, -845.0632174060273, -1016.3747305462872, -1190.9336999797708, -1005.5936196415868, -360.35142797902165, -646.8027998478061, -1007.4269313493528, -240.50917617723496, -436.0866151229443, -851.6989219570252, -44.81945664648542, -1091.2610293071025, -414.25051851310536, -1003.8677714338419, -179.4671093369831, -305.69554334741815, -815.085589197912, -319.4242800372414, -1407.161003207311, -968.8241425646062, -1276.4913375413935, -1206.8989395257806, -97.7135177952061, -451.9947369911801, -527.9863946028295, -65.48899958842696, -646.143261980891, -1228.212599403149, -97.68372000062506, -943.1928607939664, -741.917458706456, -1384.7532110162579, -142.02382390556582, -1282.841942553726, -931.9884582215824, -980.3728720993668, -1125.9007991529206, -329.19937182987263, -515.5472349699006, -1118.143468183855, -490.55381697745094, -1010.8458431807932, -1313.5493442780298]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5550789761403726, "mean_inference_ms": 1.668524485477613, "mean_action_processing_ms": 0.2763275723807357, "mean_env_wait_ms": 3.399635911799689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01192784309387207, "StateBufferConnector_ms": 0.007837772369384766, "ViewRequirementAgentConnector_ms": 0.18722224235534668}, "num_episodes": 30, "episode_return_max": -8.4350052504056, "episode_return_min": -1407.161003207311, "episode_return_mean": -711.5680902595033, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 339.85112415296334, "num_env_steps_trained_throughput_per_sec": 339.85112415296334, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12039.663, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12039.594, "sample_time_ms": 1130.1, "learn_time_ms": 10843.215, "learn_throughput": 368.894, "synch_weights_time_ms": 65.505}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "4b94b_00000", "date": "2024-08-05_11-42-31", "timestamp": 1722838351, "time_this_iter_s": 11.782217741012573, "time_total_s": 156.8593499660492, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e11156be20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 156.8593499660492, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 18.47058823529412, "ram_util_percent": 29.211764705882352}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 156.51489215592542, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9761064516380429, "policy_loss": -0.003016712856090938, "vf_loss": 0.9804120571352541, "vf_explained_var": 0.9899905394141872, "kl": 0.006075097582258119, "entropy": 1.3648353012899557, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -8.4350052504056, "episode_reward_min": -1407.161003207311, "episode_reward_mean": -690.2567232187034, "episode_len_mean": 126.8, "episode_media": {}, "episodes_timesteps_total": 12680, "policy_reward_min": {"policy_0": -1407.161003207311}, "policy_reward_max": {"policy_0": -8.4350052504056}, "policy_reward_mean": {"policy_0": -690.2567232187034}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-680.188370346026, -1019.0896924129581, -945.1818971121317, -423.9978150652128, -956.0337134851427, -74.90659230209646, -199.85192446804922, -1014.0908248571116, -586.5384161691342, -891.414773716781, -398.39005916744753, -805.4145612543094, -927.6996100249096, -8.4350052504056, -199.41196630367108, -446.45988194813015, -113.58588513887399, -1148.3506495394781, -772.0386262596434, -901.9876685257354, -356.4408820504454, -845.0632174060273, -1016.3747305462872, -1190.9336999797708, -1005.5936196415868, -360.35142797902165, -646.8027998478061, -1007.4269313493528, -240.50917617723496, -436.0866151229443, -851.6989219570252, -44.81945664648542, -1091.2610293071025, -414.25051851310536, -1003.8677714338419, -179.4671093369831, -305.69554334741815, -815.085589197912, -319.4242800372414, -1407.161003207311, -968.8241425646062, -1276.4913375413935, -1206.8989395257806, -97.7135177952061, -451.9947369911801, -527.9863946028295, -65.48899958842696, -646.143261980891, -1228.212599403149, -97.68372000062506, -943.1928607939664, -741.917458706456, -1384.7532110162579, -142.02382390556582, -1282.841942553726, -931.9884582215824, -980.3728720993668, -1125.9007991529206, -329.19937182987263, -515.5472349699006, -1118.143468183855, -490.55381697745094, -1010.8458431807932, -1313.5493442780298, -845.7283108605725, -1009.118799473071, -58.297293067468296, -1067.5447244402494, -1280.2343099963266, -226.5630714920173, -46.74527831777857, -529.4654708209279, -1003.333344317798, -212.51087072919705, -850.0432651576841, -551.3003950110535, -25.389939937119745, -883.3365362661864, -1061.3524019522367, -861.437909302766, -911.3407101789766, -1156.191865183389, -760.3581927552365, -391.37569617803894, -413.3087157313374, -1325.298359898847, -1039.4569727186383, -718.7115238402799, -157.839833861855, -440.3670707431349, -948.0048793236072, -1094.873811694945, -245.20844066194925, -584.433184165655, -572.0282401512175, -223.14991459147635, -655.6471040129156, -569.3659435177598, -1204.4479795621837, -172.2115496604622], "episode_lengths": [150, 150, 150, 142, 150, 56, 77, 150, 150, 150, 150, 150, 150, 41, 78, 144, 81, 150, 150, 150, 108, 150, 150, 150, 150, 92, 150, 150, 101, 106, 150, 49, 150, 95, 150, 87, 104, 138, 80, 150, 150, 150, 150, 54, 106, 150, 41, 119, 150, 63, 150, 150, 150, 67, 150, 150, 150, 150, 150, 136, 150, 145, 150, 150, 150, 150, 59, 150, 150, 65, 58, 150, 150, 88, 150, 112, 45, 150, 150, 150, 150, 150, 150, 112, 93, 150, 150, 124, 64, 150, 150, 150, 74, 150, 150, 97, 150, 150, 150, 79], "policy_policy_0_reward": [-680.188370346026, -1019.0896924129581, -945.1818971121317, -423.9978150652128, -956.0337134851427, -74.90659230209646, -199.85192446804922, -1014.0908248571116, -586.5384161691342, -891.414773716781, -398.39005916744753, -805.4145612543094, -927.6996100249096, -8.4350052504056, -199.41196630367108, -446.45988194813015, -113.58588513887399, -1148.3506495394781, -772.0386262596434, -901.9876685257354, -356.4408820504454, -845.0632174060273, -1016.3747305462872, -1190.9336999797708, -1005.5936196415868, -360.35142797902165, -646.8027998478061, -1007.4269313493528, -240.50917617723496, -436.0866151229443, -851.6989219570252, -44.81945664648542, -1091.2610293071025, -414.25051851310536, -1003.8677714338419, -179.4671093369831, -305.69554334741815, -815.085589197912, -319.4242800372414, -1407.161003207311, -968.8241425646062, -1276.4913375413935, -1206.8989395257806, -97.7135177952061, -451.9947369911801, -527.9863946028295, -65.48899958842696, -646.143261980891, -1228.212599403149, -97.68372000062506, -943.1928607939664, -741.917458706456, -1384.7532110162579, -142.02382390556582, -1282.841942553726, -931.9884582215824, -980.3728720993668, -1125.9007991529206, -329.19937182987263, -515.5472349699006, -1118.143468183855, -490.55381697745094, -1010.8458431807932, -1313.5493442780298, -845.7283108605725, -1009.118799473071, -58.297293067468296, -1067.5447244402494, -1280.2343099963266, -226.5630714920173, -46.74527831777857, -529.4654708209279, -1003.333344317798, -212.51087072919705, -850.0432651576841, -551.3003950110535, -25.389939937119745, -883.3365362661864, -1061.3524019522367, -861.437909302766, -911.3407101789766, -1156.191865183389, -760.3581927552365, -391.37569617803894, -413.3087157313374, -1325.298359898847, -1039.4569727186383, -718.7115238402799, -157.839833861855, -440.3670707431349, -948.0048793236072, -1094.873811694945, -245.20844066194925, -584.433184165655, -572.0282401512175, -223.14991459147635, -655.6471040129156, -569.3659435177598, -1204.4479795621837, -172.2115496604622]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5548903138668896, "mean_inference_ms": 1.6663042261476133, "mean_action_processing_ms": 0.27562088411285507, "mean_env_wait_ms": 3.3982788584463735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011936187744140625, "StateBufferConnector_ms": 0.007946252822875977, "ViewRequirementAgentConnector_ms": 0.18935346603393555}, "num_episodes": 36, "episode_return_max": -8.4350052504056, "episode_return_min": -1407.161003207311, "episode_return_mean": -690.2567232187034, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.42330579088855, "num_env_steps_trained_throughput_per_sec": 309.42330579088855, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12093.345, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12093.275, "sample_time_ms": 1130.191, "learn_time_ms": 10896.814, "learn_throughput": 367.08, "synch_weights_time_ms": 65.493}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "4b94b_00000", "date": "2024-08-05_11-42-44", "timestamp": 1722838364, "time_this_iter_s": 12.940469741821289, "time_total_s": 169.79981970787048, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1113d37f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 169.79981970787048, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 17.844444444444445, "ram_util_percent": 29.200000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 171.23985518018404, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9566309107157092, "policy_loss": -0.0006666127791201385, "vf_loss": 0.9586284449944894, "vf_explained_var": 0.9937936554352442, "kl": 0.00793549510435696, "entropy": 1.4301158492763837, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -9.254082623575716, "episode_reward_min": -1407.161003207311, "episode_reward_mean": -660.3141490574276, "episode_len_mean": 121.87, "episode_media": {}, "episodes_timesteps_total": 12187, "policy_reward_min": {"policy_0": -1407.161003207311}, "policy_reward_max": {"policy_0": -9.254082623575716}, "policy_reward_mean": {"policy_0": -660.3141490574276}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-44.81945664648542, -1091.2610293071025, -414.25051851310536, -1003.8677714338419, -179.4671093369831, -305.69554334741815, -815.085589197912, -319.4242800372414, -1407.161003207311, -968.8241425646062, -1276.4913375413935, -1206.8989395257806, -97.7135177952061, -451.9947369911801, -527.9863946028295, -65.48899958842696, -646.143261980891, -1228.212599403149, -97.68372000062506, -943.1928607939664, -741.917458706456, -1384.7532110162579, -142.02382390556582, -1282.841942553726, -931.9884582215824, -980.3728720993668, -1125.9007991529206, -329.19937182987263, -515.5472349699006, -1118.143468183855, -490.55381697745094, -1010.8458431807932, -1313.5493442780298, -845.7283108605725, -1009.118799473071, -58.297293067468296, -1067.5447244402494, -1280.2343099963266, -226.5630714920173, -46.74527831777857, -529.4654708209279, -1003.333344317798, -212.51087072919705, -850.0432651576841, -551.3003950110535, -25.389939937119745, -883.3365362661864, -1061.3524019522367, -861.437909302766, -911.3407101789766, -1156.191865183389, -760.3581927552365, -391.37569617803894, -413.3087157313374, -1325.298359898847, -1039.4569727186383, -718.7115238402799, -157.839833861855, -440.3670707431349, -948.0048793236072, -1094.873811694945, -245.20844066194925, -584.433184165655, -572.0282401512175, -223.14991459147635, -655.6471040129156, -569.3659435177598, -1204.4479795621837, -172.2115496604622, -1185.3961904514633, -955.2786848956758, -224.11123061549569, -419.05144006367414, -196.96615797764179, -717.0898443093191, -100.96748546730231, -50.99883930441045, -1076.2660964716097, -9.254082623575716, -216.9153398534931, -41.94770882567822, -576.6462557992385, -693.4859809550719, -830.2763886444602, -893.3253488284872, -433.0786513966377, -936.3273285825097, -1248.3723030279375, -431.8159885059896, -749.8847345900022, -976.962011876575, -293.6858096346238, -483.2781694587122, -238.7554012156376, -1076.964058338705, -165.2030999583584, -1229.7843727812983, -123.20475950004963, -708.3856375025754, -192.413137820955], "episode_lengths": [49, 150, 95, 150, 87, 104, 138, 80, 150, 150, 150, 150, 54, 106, 150, 41, 119, 150, 63, 150, 150, 150, 67, 150, 150, 150, 150, 150, 136, 150, 145, 150, 150, 150, 150, 59, 150, 150, 65, 58, 150, 150, 88, 150, 112, 45, 150, 150, 150, 150, 150, 150, 112, 93, 150, 150, 124, 64, 150, 150, 150, 74, 150, 150, 97, 150, 150, 150, 79, 150, 150, 77, 150, 73, 150, 44, 50, 150, 35, 63, 49, 121, 150, 150, 150, 112, 150, 150, 131, 150, 150, 93, 150, 88, 150, 60, 150, 69, 150, 68], "policy_policy_0_reward": [-44.81945664648542, -1091.2610293071025, -414.25051851310536, -1003.8677714338419, -179.4671093369831, -305.69554334741815, -815.085589197912, -319.4242800372414, -1407.161003207311, -968.8241425646062, -1276.4913375413935, -1206.8989395257806, -97.7135177952061, -451.9947369911801, -527.9863946028295, -65.48899958842696, -646.143261980891, -1228.212599403149, -97.68372000062506, -943.1928607939664, -741.917458706456, -1384.7532110162579, -142.02382390556582, -1282.841942553726, -931.9884582215824, -980.3728720993668, -1125.9007991529206, -329.19937182987263, -515.5472349699006, -1118.143468183855, -490.55381697745094, -1010.8458431807932, -1313.5493442780298, -845.7283108605725, -1009.118799473071, -58.297293067468296, -1067.5447244402494, -1280.2343099963266, -226.5630714920173, -46.74527831777857, -529.4654708209279, -1003.333344317798, -212.51087072919705, -850.0432651576841, -551.3003950110535, -25.389939937119745, -883.3365362661864, -1061.3524019522367, -861.437909302766, -911.3407101789766, -1156.191865183389, -760.3581927552365, -391.37569617803894, -413.3087157313374, -1325.298359898847, -1039.4569727186383, -718.7115238402799, -157.839833861855, -440.3670707431349, -948.0048793236072, -1094.873811694945, -245.20844066194925, -584.433184165655, -572.0282401512175, -223.14991459147635, -655.6471040129156, -569.3659435177598, -1204.4479795621837, -172.2115496604622, -1185.3961904514633, -955.2786848956758, -224.11123061549569, -419.05144006367414, -196.96615797764179, -717.0898443093191, -100.96748546730231, -50.99883930441045, -1076.2660964716097, -9.254082623575716, -216.9153398534931, -41.94770882567822, -576.6462557992385, -693.4859809550719, -830.2763886444602, -893.3253488284872, -433.0786513966377, -936.3273285825097, -1248.3723030279375, -431.8159885059896, -749.8847345900022, -976.962011876575, -293.6858096346238, -483.2781694587122, -238.7554012156376, -1076.964058338705, -165.2030999583584, -1229.7843727812983, -123.20475950004963, -708.3856375025754, -192.413137820955]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5550918278181162, "mean_inference_ms": 1.6668202898084854, "mean_action_processing_ms": 0.275416179546738, "mean_env_wait_ms": 3.402813671317284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01216745376586914, "StateBufferConnector_ms": 0.008059978485107422, "ViewRequirementAgentConnector_ms": 0.19223308563232422}, "num_episodes": 31, "episode_return_max": -9.254082623575716, "episode_return_min": -1407.161003207311, "episode_return_mean": -660.3141490574276, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.6339786143494, "num_env_steps_trained_throughput_per_sec": 311.6339786143494, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12266.391, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12266.319, "sample_time_ms": 1120.399, "learn_time_ms": 11079.217, "learn_throughput": 361.036, "synch_weights_time_ms": 65.928}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "4b94b_00000", "date": "2024-08-05_11-42-57", "timestamp": 1722838377, "time_this_iter_s": 12.84803295135498, "time_total_s": 182.64785265922546, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e11156bb50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 182.64785265922546, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 18.038888888888888, "ram_util_percent": 29.200000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 142.61151342789333, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.8130993157314758, "policy_loss": -0.0057502866062956555, "vf_loss": 0.8201867653056979, "vf_explained_var": 0.9953833673770229, "kl": 0.008440193263713052, "entropy": 1.4426630649715662, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -9.254082623575716, "episode_reward_min": -1423.7390051129385, "episode_reward_mean": -674.1273357016121, "episode_len_mean": 122.41, "episode_media": {}, "episodes_timesteps_total": 12241, "policy_reward_min": {"policy_0": -1423.7390051129385}, "policy_reward_max": {"policy_0": -9.254082623575716}, "policy_reward_mean": {"policy_0": -674.1273357016121}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1313.5493442780298, -845.7283108605725, -1009.118799473071, -58.297293067468296, -1067.5447244402494, -1280.2343099963266, -226.5630714920173, -46.74527831777857, -529.4654708209279, -1003.333344317798, -212.51087072919705, -850.0432651576841, -551.3003950110535, -25.389939937119745, -883.3365362661864, -1061.3524019522367, -861.437909302766, -911.3407101789766, -1156.191865183389, -760.3581927552365, -391.37569617803894, -413.3087157313374, -1325.298359898847, -1039.4569727186383, -718.7115238402799, -157.839833861855, -440.3670707431349, -948.0048793236072, -1094.873811694945, -245.20844066194925, -584.433184165655, -572.0282401512175, -223.14991459147635, -655.6471040129156, -569.3659435177598, -1204.4479795621837, -172.2115496604622, -1185.3961904514633, -955.2786848956758, -224.11123061549569, -419.05144006367414, -196.96615797764179, -717.0898443093191, -100.96748546730231, -50.99883930441045, -1076.2660964716097, -9.254082623575716, -216.9153398534931, -41.94770882567822, -576.6462557992385, -693.4859809550719, -830.2763886444602, -893.3253488284872, -433.0786513966377, -936.3273285825097, -1248.3723030279375, -431.8159885059896, -749.8847345900022, -976.962011876575, -293.6858096346238, -483.2781694587122, -238.7554012156376, -1076.964058338705, -165.2030999583584, -1229.7843727812983, -123.20475950004963, -708.3856375025754, -192.413137820955, -1423.7390051129385, -1099.7952276015587, -966.4784021941305, -926.3228448436384, -108.04706329057497, -1109.494256396872, -893.4177040375802, -1013.5382406622937, -1114.419383236773, -529.2448069993511, -783.914734773168, -859.7162851186656, -196.06591820500608, -179.8215911839854, -1039.8256111939447, -414.941482949926, -1000.4419869555679, -1199.1454307878814, -1169.9836707735149, -630.8347841980361, -196.5973746697371, -950.04661019873, -607.4902249515694, -1233.2312237188025, -934.1360518389313, -113.65652613971842, -22.13831087434714, -1346.0263551545802, -1220.7322114090878, -46.71806736308023, -162.7095448690344, -1034.3988453286217], "episode_lengths": [150, 150, 150, 59, 150, 150, 65, 58, 150, 150, 88, 150, 112, 45, 150, 150, 150, 150, 150, 150, 112, 93, 150, 150, 124, 64, 150, 150, 150, 74, 150, 150, 97, 150, 150, 150, 79, 150, 150, 77, 150, 73, 150, 44, 50, 150, 35, 63, 49, 121, 150, 150, 150, 112, 150, 150, 131, 150, 150, 93, 150, 88, 150, 60, 150, 69, 150, 68, 150, 150, 150, 150, 49, 150, 150, 150, 150, 146, 150, 150, 95, 77, 150, 96, 150, 150, 150, 150, 66, 150, 150, 150, 150, 52, 46, 150, 150, 57, 54, 150], "policy_policy_0_reward": [-1313.5493442780298, -845.7283108605725, -1009.118799473071, -58.297293067468296, -1067.5447244402494, -1280.2343099963266, -226.5630714920173, -46.74527831777857, -529.4654708209279, -1003.333344317798, -212.51087072919705, -850.0432651576841, -551.3003950110535, -25.389939937119745, -883.3365362661864, -1061.3524019522367, -861.437909302766, -911.3407101789766, -1156.191865183389, -760.3581927552365, -391.37569617803894, -413.3087157313374, -1325.298359898847, -1039.4569727186383, -718.7115238402799, -157.839833861855, -440.3670707431349, -948.0048793236072, -1094.873811694945, -245.20844066194925, -584.433184165655, -572.0282401512175, -223.14991459147635, -655.6471040129156, -569.3659435177598, -1204.4479795621837, -172.2115496604622, -1185.3961904514633, -955.2786848956758, -224.11123061549569, -419.05144006367414, -196.96615797764179, -717.0898443093191, -100.96748546730231, -50.99883930441045, -1076.2660964716097, -9.254082623575716, -216.9153398534931, -41.94770882567822, -576.6462557992385, -693.4859809550719, -830.2763886444602, -893.3253488284872, -433.0786513966377, -936.3273285825097, -1248.3723030279375, -431.8159885059896, -749.8847345900022, -976.962011876575, -293.6858096346238, -483.2781694587122, -238.7554012156376, -1076.964058338705, -165.2030999583584, -1229.7843727812983, -123.20475950004963, -708.3856375025754, -192.413137820955, -1423.7390051129385, -1099.7952276015587, -966.4784021941305, -926.3228448436384, -108.04706329057497, -1109.494256396872, -893.4177040375802, -1013.5382406622937, -1114.419383236773, -529.2448069993511, -783.914734773168, -859.7162851186656, -196.06591820500608, -179.8215911839854, -1039.8256111939447, -414.941482949926, -1000.4419869555679, -1199.1454307878814, -1169.9836707735149, -630.8347841980361, -196.5973746697371, -950.04661019873, -607.4902249515694, -1233.2312237188025, -934.1360518389313, -113.65652613971842, -22.13831087434714, -1346.0263551545802, -1220.7322114090878, -46.71806736308023, -162.7095448690344, -1034.3988453286217]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5553266466558779, "mean_inference_ms": 1.6661937407754772, "mean_action_processing_ms": 0.27517014396683104, "mean_env_wait_ms": 3.402720516540866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012498617172241211, "StateBufferConnector_ms": 0.008209228515625, "ViewRequirementAgentConnector_ms": 0.19611358642578125}, "num_episodes": 32, "episode_return_max": -9.254082623575716, "episode_return_min": -1423.7390051129385, "episode_return_mean": -674.1273357016121, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 333.9339568863115, "num_env_steps_trained_throughput_per_sec": 333.9339568863115, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12268.545, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12268.475, "sample_time_ms": 1106.155, "learn_time_ms": 11095.36, "learn_throughput": 360.511, "synch_weights_time_ms": 66.176}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "4b94b_00000", "date": "2024-08-05_11-43-09", "timestamp": 1722838389, "time_this_iter_s": 11.989989757537842, "time_total_s": 194.6378424167633, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e11156be20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 194.6378424167633, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 18.13888888888889, "ram_util_percent": 29.200000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 146.8718250731627, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.6495268323924392, "policy_loss": -0.005651322716342596, "vf_loss": 0.656522311316803, "vf_explained_var": 0.9946955430631836, "kl": 0.007331072381566633, "entropy": 1.4357950434088707, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -9.254082623575716, "episode_reward_min": -1423.7390051129385, "episode_reward_mean": -703.666988694778, "episode_len_mean": 126.57, "episode_media": {}, "episodes_timesteps_total": 12657, "policy_reward_min": {"policy_0": -1423.7390051129385}, "policy_reward_max": {"policy_0": -9.254082623575716}, "policy_reward_mean": {"policy_0": -703.666988694778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-584.433184165655, -572.0282401512175, -223.14991459147635, -655.6471040129156, -569.3659435177598, -1204.4479795621837, -172.2115496604622, -1185.3961904514633, -955.2786848956758, -224.11123061549569, -419.05144006367414, -196.96615797764179, -717.0898443093191, -100.96748546730231, -50.99883930441045, -1076.2660964716097, -9.254082623575716, -216.9153398534931, -41.94770882567822, -576.6462557992385, -693.4859809550719, -830.2763886444602, -893.3253488284872, -433.0786513966377, -936.3273285825097, -1248.3723030279375, -431.8159885059896, -749.8847345900022, -976.962011876575, -293.6858096346238, -483.2781694587122, -238.7554012156376, -1076.964058338705, -165.2030999583584, -1229.7843727812983, -123.20475950004963, -708.3856375025754, -192.413137820955, -1423.7390051129385, -1099.7952276015587, -966.4784021941305, -926.3228448436384, -108.04706329057497, -1109.494256396872, -893.4177040375802, -1013.5382406622937, -1114.419383236773, -529.2448069993511, -783.914734773168, -859.7162851186656, -196.06591820500608, -179.8215911839854, -1039.8256111939447, -414.941482949926, -1000.4419869555679, -1199.1454307878814, -1169.9836707735149, -630.8347841980361, -196.5973746697371, -950.04661019873, -607.4902249515694, -1233.2312237188025, -934.1360518389313, -113.65652613971842, -22.13831087434714, -1346.0263551545802, -1220.7322114090878, -46.71806736308023, -162.7095448690344, -1034.3988453286217, -920.3455787953822, -845.5057502615143, -351.9529183134788, -1265.4575006205796, -670.4187392889299, -879.737453990138, -1077.5755737658044, -987.6320539956603, -588.4063251984919, -993.5407442224445, -586.7144882504338, -1317.1809207364806, -1396.402611859936, -566.1856291060082, -919.7165866830134, -1042.6108879624396, -736.0354889255683, -713.4567337089428, -48.54437902314434, -1205.8399235661877, -1041.7879963829453, -614.9270214271978, -285.5299862332555, -843.1996520939493, -857.1116586984197, -937.8877452074336, -1027.2127284883757, -1235.262822614374, -324.42732365386905, -101.64541443292379], "episode_lengths": [150, 150, 97, 150, 150, 150, 79, 150, 150, 77, 150, 73, 150, 44, 50, 150, 35, 63, 49, 121, 150, 150, 150, 112, 150, 150, 131, 150, 150, 93, 150, 88, 150, 60, 150, 69, 150, 68, 150, 150, 150, 150, 49, 150, 150, 150, 150, 146, 150, 150, 95, 77, 150, 96, 150, 150, 150, 150, 66, 150, 150, 150, 150, 52, 46, 150, 150, 57, 54, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 60, 150, 150, 150, 80, 150, 150, 150, 150, 150, 105, 70], "policy_policy_0_reward": [-584.433184165655, -572.0282401512175, -223.14991459147635, -655.6471040129156, -569.3659435177598, -1204.4479795621837, -172.2115496604622, -1185.3961904514633, -955.2786848956758, -224.11123061549569, -419.05144006367414, -196.96615797764179, -717.0898443093191, -100.96748546730231, -50.99883930441045, -1076.2660964716097, -9.254082623575716, -216.9153398534931, -41.94770882567822, -576.6462557992385, -693.4859809550719, -830.2763886444602, -893.3253488284872, -433.0786513966377, -936.3273285825097, -1248.3723030279375, -431.8159885059896, -749.8847345900022, -976.962011876575, -293.6858096346238, -483.2781694587122, -238.7554012156376, -1076.964058338705, -165.2030999583584, -1229.7843727812983, -123.20475950004963, -708.3856375025754, -192.413137820955, -1423.7390051129385, -1099.7952276015587, -966.4784021941305, -926.3228448436384, -108.04706329057497, -1109.494256396872, -893.4177040375802, -1013.5382406622937, -1114.419383236773, -529.2448069993511, -783.914734773168, -859.7162851186656, -196.06591820500608, -179.8215911839854, -1039.8256111939447, -414.941482949926, -1000.4419869555679, -1199.1454307878814, -1169.9836707735149, -630.8347841980361, -196.5973746697371, -950.04661019873, -607.4902249515694, -1233.2312237188025, -934.1360518389313, -113.65652613971842, -22.13831087434714, -1346.0263551545802, -1220.7322114090878, -46.71806736308023, -162.7095448690344, -1034.3988453286217, -920.3455787953822, -845.5057502615143, -351.9529183134788, -1265.4575006205796, -670.4187392889299, -879.737453990138, -1077.5755737658044, -987.6320539956603, -588.4063251984919, -993.5407442224445, -586.7144882504338, -1317.1809207364806, -1396.402611859936, -566.1856291060082, -919.7165866830134, -1042.6108879624396, -736.0354889255683, -713.4567337089428, -48.54437902314434, -1205.8399235661877, -1041.7879963829453, -614.9270214271978, -285.5299862332555, -843.1996520939493, -857.1116586984197, -937.8877452074336, -1027.2127284883757, -1235.262822614374, -324.42732365386905, -101.64541443292379]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5545797712137149, "mean_inference_ms": 1.6655731005747585, "mean_action_processing_ms": 0.2746494176500069, "mean_env_wait_ms": 3.3995416245417647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012537002563476562, "StateBufferConnector_ms": 0.008074522018432617, "ViewRequirementAgentConnector_ms": 0.19579267501831055}, "num_episodes": 30, "episode_return_max": -9.254082623575716, "episode_return_min": -1423.7390051129385, "episode_return_mean": -703.666988694778, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.110950195856, "num_env_steps_trained_throughput_per_sec": 307.110950195856, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12344.201, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12344.13, "sample_time_ms": 1105.935, "learn_time_ms": 11170.926, "learn_throughput": 358.072, "synch_weights_time_ms": 66.484}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "4b94b_00000", "date": "2024-08-05_11-43-22", "timestamp": 1722838402, "time_this_iter_s": 13.036484718322754, "time_total_s": 207.67432713508606, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1113d2680>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 207.67432713508606, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 17.822222222222223, "ram_util_percent": 29.21111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 157.66515698830287, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9954506603690485, "policy_loss": -0.0028085951053071767, "vf_loss": 0.9995458780167004, "vf_explained_var": 0.9934411822507779, "kl": 0.006750909027808423, "entropy": 1.3710081743697324, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -22.13831087434714, "episode_reward_min": -1461.087134757752, "episode_reward_mean": -759.4980180997684, "episode_len_mean": 128.72, "episode_media": {}, "episodes_timesteps_total": 12872, "policy_reward_min": {"policy_0": -1461.087134757752}, "policy_reward_max": {"policy_0": -22.13831087434714}, "policy_reward_mean": {"policy_0": -759.4980180997684}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-238.7554012156376, -1076.964058338705, -165.2030999583584, -1229.7843727812983, -123.20475950004963, -708.3856375025754, -192.413137820955, -1423.7390051129385, -1099.7952276015587, -966.4784021941305, -926.3228448436384, -108.04706329057497, -1109.494256396872, -893.4177040375802, -1013.5382406622937, -1114.419383236773, -529.2448069993511, -783.914734773168, -859.7162851186656, -196.06591820500608, -179.8215911839854, -1039.8256111939447, -414.941482949926, -1000.4419869555679, -1199.1454307878814, -1169.9836707735149, -630.8347841980361, -196.5973746697371, -950.04661019873, -607.4902249515694, -1233.2312237188025, -934.1360518389313, -113.65652613971842, -22.13831087434714, -1346.0263551545802, -1220.7322114090878, -46.71806736308023, -162.7095448690344, -1034.3988453286217, -920.3455787953822, -845.5057502615143, -351.9529183134788, -1265.4575006205796, -670.4187392889299, -879.737453990138, -1077.5755737658044, -987.6320539956603, -588.4063251984919, -993.5407442224445, -586.7144882504338, -1317.1809207364806, -1396.402611859936, -566.1856291060082, -919.7165866830134, -1042.6108879624396, -736.0354889255683, -713.4567337089428, -48.54437902314434, -1205.8399235661877, -1041.7879963829453, -614.9270214271978, -285.5299862332555, -843.1996520939493, -857.1116586984197, -937.8877452074336, -1027.2127284883757, -1235.262822614374, -324.42732365386905, -101.64541443292379, -1350.0637844467785, -970.780865810783, -308.90945151462654, -753.9427734625085, -472.2512439298431, -1342.5995947018052, -1461.087134757752, -1200.1847462932253, -366.85088402290165, -969.2858296315859, -523.7823674555784, -454.8515648240335, -146.8933323375687, -1002.7074747770357, -1412.5165876297535, -89.35613042338173, -1081.7787805246944, -281.6572654352038, -1113.5421327944532, -416.17668866252905, -376.6138002193296, -979.9902257867843, -307.2158196335317, -1099.22728913802, -937.1469206353255, -150.60213649586134, -904.9825889314999, -764.7438033736191, -843.3432685887212, -1100.8838316681288, -121.80061041340461], "episode_lengths": [88, 150, 60, 150, 69, 150, 68, 150, 150, 150, 150, 49, 150, 150, 150, 150, 146, 150, 150, 95, 77, 150, 96, 150, 150, 150, 150, 66, 150, 150, 150, 150, 52, 46, 150, 150, 57, 54, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 60, 150, 150, 150, 80, 150, 150, 150, 150, 150, 105, 70, 150, 150, 78, 150, 108, 150, 150, 150, 86, 150, 149, 150, 79, 150, 150, 70, 150, 77, 150, 150, 89, 150, 86, 150, 150, 57, 150, 150, 150, 150, 60], "policy_policy_0_reward": [-238.7554012156376, -1076.964058338705, -165.2030999583584, -1229.7843727812983, -123.20475950004963, -708.3856375025754, -192.413137820955, -1423.7390051129385, -1099.7952276015587, -966.4784021941305, -926.3228448436384, -108.04706329057497, -1109.494256396872, -893.4177040375802, -1013.5382406622937, -1114.419383236773, -529.2448069993511, -783.914734773168, -859.7162851186656, -196.06591820500608, -179.8215911839854, -1039.8256111939447, -414.941482949926, -1000.4419869555679, -1199.1454307878814, -1169.9836707735149, -630.8347841980361, -196.5973746697371, -950.04661019873, -607.4902249515694, -1233.2312237188025, -934.1360518389313, -113.65652613971842, -22.13831087434714, -1346.0263551545802, -1220.7322114090878, -46.71806736308023, -162.7095448690344, -1034.3988453286217, -920.3455787953822, -845.5057502615143, -351.9529183134788, -1265.4575006205796, -670.4187392889299, -879.737453990138, -1077.5755737658044, -987.6320539956603, -588.4063251984919, -993.5407442224445, -586.7144882504338, -1317.1809207364806, -1396.402611859936, -566.1856291060082, -919.7165866830134, -1042.6108879624396, -736.0354889255683, -713.4567337089428, -48.54437902314434, -1205.8399235661877, -1041.7879963829453, -614.9270214271978, -285.5299862332555, -843.1996520939493, -857.1116586984197, -937.8877452074336, -1027.2127284883757, -1235.262822614374, -324.42732365386905, -101.64541443292379, -1350.0637844467785, -970.780865810783, -308.90945151462654, -753.9427734625085, -472.2512439298431, -1342.5995947018052, -1461.087134757752, -1200.1847462932253, -366.85088402290165, -969.2858296315859, -523.7823674555784, -454.8515648240335, -146.8933323375687, -1002.7074747770357, -1412.5165876297535, -89.35613042338173, -1081.7787805246944, -281.6572654352038, -1113.5421327944532, -416.17668866252905, -376.6138002193296, -979.9902257867843, -307.2158196335317, -1099.22728913802, -937.1469206353255, -150.60213649586134, -904.9825889314999, -764.7438033736191, -843.3432685887212, -1100.8838316681288, -121.80061041340461]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5547015935626942, "mean_inference_ms": 1.6640750719647632, "mean_action_processing_ms": 0.27437634074501743, "mean_env_wait_ms": 3.3979487580437047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012728691101074219, "StateBufferConnector_ms": 0.008017778396606445, "ViewRequirementAgentConnector_ms": 0.1947014331817627}, "num_episodes": 31, "episode_return_max": -22.13831087434714, "episode_return_min": -1461.087134757752, "episode_return_mean": -759.4980180997684, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 398.7414316674671, "num_env_steps_trained_throughput_per_sec": 398.7414316674671, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12109.745, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12109.671, "sample_time_ms": 1110.32, "learn_time_ms": 10932.201, "learn_throughput": 365.892, "synch_weights_time_ms": 66.355}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "4b94b_00000", "date": "2024-08-05_11-43-32", "timestamp": 1722838412, "time_this_iter_s": 10.044527530670166, "time_total_s": 217.71885466575623, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e11156aa70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 217.71885466575623, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 20.285714285714285, "ram_util_percent": 29.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 175.1165094643831, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.7944110564732303, "policy_loss": -0.001321782539889682, "vf_loss": 0.7969976240148147, "vf_explained_var": 0.9930334096153577, "kl": 0.006517185253824209, "entropy": 1.3462505514423053, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -22.13831087434714, "episode_reward_min": -1461.087134757752, "episode_reward_mean": -776.5528472367492, "episode_len_mean": 131.31, "episode_media": {}, "episodes_timesteps_total": 13131, "policy_reward_min": {"policy_0": -1461.087134757752}, "policy_reward_max": {"policy_0": -22.13831087434714}, "policy_reward_mean": {"policy_0": -776.5528472367492}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1233.2312237188025, -934.1360518389313, -113.65652613971842, -22.13831087434714, -1346.0263551545802, -1220.7322114090878, -46.71806736308023, -162.7095448690344, -1034.3988453286217, -920.3455787953822, -845.5057502615143, -351.9529183134788, -1265.4575006205796, -670.4187392889299, -879.737453990138, -1077.5755737658044, -987.6320539956603, -588.4063251984919, -993.5407442224445, -586.7144882504338, -1317.1809207364806, -1396.402611859936, -566.1856291060082, -919.7165866830134, -1042.6108879624396, -736.0354889255683, -713.4567337089428, -48.54437902314434, -1205.8399235661877, -1041.7879963829453, -614.9270214271978, -285.5299862332555, -843.1996520939493, -857.1116586984197, -937.8877452074336, -1027.2127284883757, -1235.262822614374, -324.42732365386905, -101.64541443292379, -1350.0637844467785, -970.780865810783, -308.90945151462654, -753.9427734625085, -472.2512439298431, -1342.5995947018052, -1461.087134757752, -1200.1847462932253, -366.85088402290165, -969.2858296315859, -523.7823674555784, -454.8515648240335, -146.8933323375687, -1002.7074747770357, -1412.5165876297535, -89.35613042338173, -1081.7787805246944, -281.6572654352038, -1113.5421327944532, -416.17668866252905, -376.6138002193296, -979.9902257867843, -307.2158196335317, -1099.22728913802, -937.1469206353255, -150.60213649586134, -904.9825889314999, -764.7438033736191, -843.3432685887212, -1100.8838316681288, -121.80061041340461, -1166.1054793210965, -1366.3267931195403, -676.8306302703173, -540.4019312452849, -362.496216867923, -1071.0764483344997, -886.320991778684, -214.7409282181159, -1313.4463585358685, -1077.464887110179, -1238.304314916648, -727.6489979823568, -911.8470180707603, -851.8943712601656, -224.09568011018257, -201.5075821974752, -476.29526361118974, -1408.5342063694172, -1031.9999537374993, -733.2786151613946, -43.997897819037014, -285.97489827370396, -394.75082619485494, -810.3175393828308, -1192.161054125845, -1089.293106407713, -1212.339004984258, -1028.1809344759736, -343.1341399934389, -972.749951274887], "episode_lengths": [150, 150, 52, 46, 150, 150, 57, 54, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 60, 150, 150, 150, 80, 150, 150, 150, 150, 150, 105, 70, 150, 150, 78, 150, 108, 150, 150, 150, 86, 150, 149, 150, 79, 150, 150, 70, 150, 77, 150, 150, 89, 150, 86, 150, 150, 57, 150, 150, 150, 150, 60, 150, 150, 129, 150, 116, 150, 150, 107, 150, 150, 150, 150, 150, 150, 150, 102, 103, 150, 150, 150, 57, 112, 110, 150, 150, 150, 150, 150, 87, 150], "policy_policy_0_reward": [-1233.2312237188025, -934.1360518389313, -113.65652613971842, -22.13831087434714, -1346.0263551545802, -1220.7322114090878, -46.71806736308023, -162.7095448690344, -1034.3988453286217, -920.3455787953822, -845.5057502615143, -351.9529183134788, -1265.4575006205796, -670.4187392889299, -879.737453990138, -1077.5755737658044, -987.6320539956603, -588.4063251984919, -993.5407442224445, -586.7144882504338, -1317.1809207364806, -1396.402611859936, -566.1856291060082, -919.7165866830134, -1042.6108879624396, -736.0354889255683, -713.4567337089428, -48.54437902314434, -1205.8399235661877, -1041.7879963829453, -614.9270214271978, -285.5299862332555, -843.1996520939493, -857.1116586984197, -937.8877452074336, -1027.2127284883757, -1235.262822614374, -324.42732365386905, -101.64541443292379, -1350.0637844467785, -970.780865810783, -308.90945151462654, -753.9427734625085, -472.2512439298431, -1342.5995947018052, -1461.087134757752, -1200.1847462932253, -366.85088402290165, -969.2858296315859, -523.7823674555784, -454.8515648240335, -146.8933323375687, -1002.7074747770357, -1412.5165876297535, -89.35613042338173, -1081.7787805246944, -281.6572654352038, -1113.5421327944532, -416.17668866252905, -376.6138002193296, -979.9902257867843, -307.2158196335317, -1099.22728913802, -937.1469206353255, -150.60213649586134, -904.9825889314999, -764.7438033736191, -843.3432685887212, -1100.8838316681288, -121.80061041340461, -1166.1054793210965, -1366.3267931195403, -676.8306302703173, -540.4019312452849, -362.496216867923, -1071.0764483344997, -886.320991778684, -214.7409282181159, -1313.4463585358685, -1077.464887110179, -1238.304314916648, -727.6489979823568, -911.8470180707603, -851.8943712601656, -224.09568011018257, -201.5075821974752, -476.29526361118974, -1408.5342063694172, -1031.9999537374993, -733.2786151613946, -43.997897819037014, -285.97489827370396, -394.75082619485494, -810.3175393828308, -1192.161054125845, -1089.293106407713, -1212.339004984258, -1028.1809344759736, -343.1341399934389, -972.749951274887]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.555159491386063, "mean_inference_ms": 1.6641953280196384, "mean_action_processing_ms": 0.2746912283548417, "mean_env_wait_ms": 3.3996236290349717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012830495834350586, "StateBufferConnector_ms": 0.007967472076416016, "ViewRequirementAgentConnector_ms": 0.1925358772277832}, "num_episodes": 30, "episode_return_max": -22.13831087434714, "episode_return_min": -1461.087134757752, "episode_return_mean": -776.5528472367492, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.5792960624637, "num_env_steps_trained_throughput_per_sec": 314.5792960624637, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12263.496, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12263.421, "sample_time_ms": 1114.709, "learn_time_ms": 11080.073, "learn_throughput": 361.008, "synch_weights_time_ms": 67.834}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "4b94b_00000", "date": "2024-08-05_11-43-45", "timestamp": 1722838425, "time_this_iter_s": 12.728420734405518, "time_total_s": 230.44727540016174, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e11156be20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 230.44727540016174, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 17.721052631578946, "ram_util_percent": 29.200000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 125.83244384527207, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.2009230091546972, "policy_loss": -0.0014268355453774953, "vf_loss": 1.2035999617539346, "vf_explained_var": 0.9825072572256128, "kl": 0.007501510249085186, "entropy": 1.343887242426475, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -12.970614595696386, "episode_reward_min": -1461.087134757752, "episode_reward_mean": -692.4126407397599, "episode_len_mean": 123.34, "episode_media": {}, "episodes_timesteps_total": 12334, "policy_reward_min": {"policy_0": -1461.087134757752}, "policy_reward_max": {"policy_0": -12.970614595696386}, "policy_reward_mean": {"policy_0": -692.4126407397599}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1027.2127284883757, -1235.262822614374, -324.42732365386905, -101.64541443292379, -1350.0637844467785, -970.780865810783, -308.90945151462654, -753.9427734625085, -472.2512439298431, -1342.5995947018052, -1461.087134757752, -1200.1847462932253, -366.85088402290165, -969.2858296315859, -523.7823674555784, -454.8515648240335, -146.8933323375687, -1002.7074747770357, -1412.5165876297535, -89.35613042338173, -1081.7787805246944, -281.6572654352038, -1113.5421327944532, -416.17668866252905, -376.6138002193296, -979.9902257867843, -307.2158196335317, -1099.22728913802, -937.1469206353255, -150.60213649586134, -904.9825889314999, -764.7438033736191, -843.3432685887212, -1100.8838316681288, -121.80061041340461, -1166.1054793210965, -1366.3267931195403, -676.8306302703173, -540.4019312452849, -362.496216867923, -1071.0764483344997, -886.320991778684, -214.7409282181159, -1313.4463585358685, -1077.464887110179, -1238.304314916648, -727.6489979823568, -911.8470180707603, -851.8943712601656, -224.09568011018257, -201.5075821974752, -476.29526361118974, -1408.5342063694172, -1031.9999537374993, -733.2786151613946, -43.997897819037014, -285.97489827370396, -394.75082619485494, -810.3175393828308, -1192.161054125845, -1089.293106407713, -1212.339004984258, -1028.1809344759736, -343.1341399934389, -972.749951274887, -408.1785531368298, -37.01420547172523, -1020.9033913626889, -180.25130815111848, -734.7594302755074, -21.31297276079482, -221.20114937030377, -837.1806373843947, -694.2514885193472, -1034.572329856786, -634.1311838026535, -820.4790137389939, -140.89447517701737, -332.3386138787772, -1250.3818773322678, -54.523792425030415, -972.4740085002003, -807.1820417063451, -100.07108996198829, -491.9421723074122, -614.5329955536127, -88.35196764153577, -676.6138727612531, -391.1418236116776, -607.3385140343843, -1264.239885375655, -777.2481638699932, -313.5777596922913, -150.61899432805083, -1173.9298869210527, -1128.2382942138001, -118.53231633456394, -12.970614595696386, -1103.1183268701363, -178.9336843911374], "episode_lengths": [150, 150, 105, 70, 150, 150, 78, 150, 108, 150, 150, 150, 86, 150, 149, 150, 79, 150, 150, 70, 150, 77, 150, 150, 89, 150, 86, 150, 150, 57, 150, 150, 150, 150, 60, 150, 150, 129, 150, 116, 150, 150, 107, 150, 150, 150, 150, 150, 150, 150, 102, 103, 150, 150, 150, 57, 112, 110, 150, 150, 150, 150, 150, 87, 150, 94, 46, 150, 77, 150, 38, 76, 150, 150, 150, 124, 150, 70, 90, 150, 41, 150, 150, 47, 111, 150, 58, 150, 102, 150, 150, 142, 102, 52, 150, 150, 50, 38, 150, 89], "policy_policy_0_reward": [-1027.2127284883757, -1235.262822614374, -324.42732365386905, -101.64541443292379, -1350.0637844467785, -970.780865810783, -308.90945151462654, -753.9427734625085, -472.2512439298431, -1342.5995947018052, -1461.087134757752, -1200.1847462932253, -366.85088402290165, -969.2858296315859, -523.7823674555784, -454.8515648240335, -146.8933323375687, -1002.7074747770357, -1412.5165876297535, -89.35613042338173, -1081.7787805246944, -281.6572654352038, -1113.5421327944532, -416.17668866252905, -376.6138002193296, -979.9902257867843, -307.2158196335317, -1099.22728913802, -937.1469206353255, -150.60213649586134, -904.9825889314999, -764.7438033736191, -843.3432685887212, -1100.8838316681288, -121.80061041340461, -1166.1054793210965, -1366.3267931195403, -676.8306302703173, -540.4019312452849, -362.496216867923, -1071.0764483344997, -886.320991778684, -214.7409282181159, -1313.4463585358685, -1077.464887110179, -1238.304314916648, -727.6489979823568, -911.8470180707603, -851.8943712601656, -224.09568011018257, -201.5075821974752, -476.29526361118974, -1408.5342063694172, -1031.9999537374993, -733.2786151613946, -43.997897819037014, -285.97489827370396, -394.75082619485494, -810.3175393828308, -1192.161054125845, -1089.293106407713, -1212.339004984258, -1028.1809344759736, -343.1341399934389, -972.749951274887, -408.1785531368298, -37.01420547172523, -1020.9033913626889, -180.25130815111848, -734.7594302755074, -21.31297276079482, -221.20114937030377, -837.1806373843947, -694.2514885193472, -1034.572329856786, -634.1311838026535, -820.4790137389939, -140.89447517701737, -332.3386138787772, -1250.3818773322678, -54.523792425030415, -972.4740085002003, -807.1820417063451, -100.07108996198829, -491.9421723074122, -614.5329955536127, -88.35196764153577, -676.6138727612531, -391.1418236116776, -607.3385140343843, -1264.239885375655, -777.2481638699932, -313.5777596922913, -150.61899432805083, -1173.9298869210527, -1128.2382942138001, -118.53231633456394, -12.970614595696386, -1103.1183268701363, -178.9336843911374]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5556776952018295, "mean_inference_ms": 1.6629402266281852, "mean_action_processing_ms": 0.27465271140221376, "mean_env_wait_ms": 3.3987605609868443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01257014274597168, "StateBufferConnector_ms": 0.007875680923461914, "ViewRequirementAgentConnector_ms": 0.1893775463104248}, "num_episodes": 35, "episode_return_max": -12.970614595696386, "episode_return_min": -1461.087134757752, "episode_return_mean": -692.4126407397599, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.444492558369, "num_env_steps_trained_throughput_per_sec": 312.444492558369, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12322.059, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12321.984, "sample_time_ms": 1118.591, "learn_time_ms": 11134.846, "learn_throughput": 359.233, "synch_weights_time_ms": 67.754}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "4b94b_00000", "date": "2024-08-05_11-43-58", "timestamp": 1722838438, "time_this_iter_s": 12.814366340637207, "time_total_s": 243.26164174079895, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1113d2680>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 243.26164174079895, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 17.994444444444444, "ram_util_percent": 29.200000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 143.60938339928785, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.7869201509281993, "policy_loss": -0.0047935096479098625, "vf_loss": 0.7929629717953504, "vf_explained_var": 0.9788984087606271, "kl": 0.009803877675115777, "entropy": 1.3718617948393026, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -12.970614595696386, "episode_reward_min": -1408.5342063694172, "episode_reward_mean": -656.2659979977028, "episode_len_mean": 125.74, "episode_media": {}, "episodes_timesteps_total": 12574, "policy_reward_min": {"policy_0": -1408.5342063694172}, "policy_reward_max": {"policy_0": -12.970614595696386}, "policy_reward_mean": {"policy_0": -656.2659979977028}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-150.60213649586134, -904.9825889314999, -764.7438033736191, -843.3432685887212, -1100.8838316681288, -121.80061041340461, -1166.1054793210965, -1366.3267931195403, -676.8306302703173, -540.4019312452849, -362.496216867923, -1071.0764483344997, -886.320991778684, -214.7409282181159, -1313.4463585358685, -1077.464887110179, -1238.304314916648, -727.6489979823568, -911.8470180707603, -851.8943712601656, -224.09568011018257, -201.5075821974752, -476.29526361118974, -1408.5342063694172, -1031.9999537374993, -733.2786151613946, -43.997897819037014, -285.97489827370396, -394.75082619485494, -810.3175393828308, -1192.161054125845, -1089.293106407713, -1212.339004984258, -1028.1809344759736, -343.1341399934389, -972.749951274887, -408.1785531368298, -37.01420547172523, -1020.9033913626889, -180.25130815111848, -734.7594302755074, -21.31297276079482, -221.20114937030377, -837.1806373843947, -694.2514885193472, -1034.572329856786, -634.1311838026535, -820.4790137389939, -140.89447517701737, -332.3386138787772, -1250.3818773322678, -54.523792425030415, -972.4740085002003, -807.1820417063451, -100.07108996198829, -491.9421723074122, -614.5329955536127, -88.35196764153577, -676.6138727612531, -391.1418236116776, -607.3385140343843, -1264.239885375655, -777.2481638699932, -313.5777596922913, -150.61899432805083, -1173.9298869210527, -1128.2382942138001, -118.53231633456394, -12.970614595696386, -1103.1183268701363, -178.9336843911374, -806.1040550186225, -1090.130835567344, -762.5981818866998, -162.9375394683638, -66.49883892511303, -441.20100973116405, -618.7528955712772, -469.77629627991763, -885.573697612119, -80.62815021479325, -582.5904316899201, -974.698689975564, -626.3501664055216, -998.5450848051702, -892.5221076986563, -647.6547690970428, -535.3703967107976, -962.5586652906048, -654.0941455367579, -386.7912229440364, -754.496950494711, -737.1170198888693, -283.5692327677051, -740.4600922733497, -920.9383261080452, -971.0445855903808, -123.27269846844145, -760.5261075513524, -556.4945102605293], "episode_lengths": [57, 150, 150, 150, 150, 60, 150, 150, 129, 150, 116, 150, 150, 107, 150, 150, 150, 150, 150, 150, 150, 102, 103, 150, 150, 150, 57, 112, 110, 150, 150, 150, 150, 150, 87, 150, 94, 46, 150, 77, 150, 38, 76, 150, 150, 150, 124, 150, 70, 90, 150, 41, 150, 150, 47, 111, 150, 58, 150, 102, 150, 150, 142, 102, 52, 150, 150, 50, 38, 150, 89, 150, 150, 150, 92, 53, 134, 150, 110, 150, 55, 150, 150, 150, 150, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 150, 150, 75, 137, 150], "policy_policy_0_reward": [-150.60213649586134, -904.9825889314999, -764.7438033736191, -843.3432685887212, -1100.8838316681288, -121.80061041340461, -1166.1054793210965, -1366.3267931195403, -676.8306302703173, -540.4019312452849, -362.496216867923, -1071.0764483344997, -886.320991778684, -214.7409282181159, -1313.4463585358685, -1077.464887110179, -1238.304314916648, -727.6489979823568, -911.8470180707603, -851.8943712601656, -224.09568011018257, -201.5075821974752, -476.29526361118974, -1408.5342063694172, -1031.9999537374993, -733.2786151613946, -43.997897819037014, -285.97489827370396, -394.75082619485494, -810.3175393828308, -1192.161054125845, -1089.293106407713, -1212.339004984258, -1028.1809344759736, -343.1341399934389, -972.749951274887, -408.1785531368298, -37.01420547172523, -1020.9033913626889, -180.25130815111848, -734.7594302755074, -21.31297276079482, -221.20114937030377, -837.1806373843947, -694.2514885193472, -1034.572329856786, -634.1311838026535, -820.4790137389939, -140.89447517701737, -332.3386138787772, -1250.3818773322678, -54.523792425030415, -972.4740085002003, -807.1820417063451, -100.07108996198829, -491.9421723074122, -614.5329955536127, -88.35196764153577, -676.6138727612531, -391.1418236116776, -607.3385140343843, -1264.239885375655, -777.2481638699932, -313.5777596922913, -150.61899432805083, -1173.9298869210527, -1128.2382942138001, -118.53231633456394, -12.970614595696386, -1103.1183268701363, -178.9336843911374, -806.1040550186225, -1090.130835567344, -762.5981818866998, -162.9375394683638, -66.49883892511303, -441.20100973116405, -618.7528955712772, -469.77629627991763, -885.573697612119, -80.62815021479325, -582.5904316899201, -974.698689975564, -626.3501664055216, -998.5450848051702, -892.5221076986563, -647.6547690970428, -535.3703967107976, -962.5586652906048, -654.0941455367579, -386.7912229440364, -754.496950494711, -737.1170198888693, -283.5692327677051, -740.4600922733497, -920.9383261080452, -971.0445855903808, -123.27269846844145, -760.5261075513524, -556.4945102605293]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5556411242508259, "mean_inference_ms": 1.6635467228350864, "mean_action_processing_ms": 0.27466838122155113, "mean_env_wait_ms": 3.3990987618219832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012358665466308594, "StateBufferConnector_ms": 0.007860898971557617, "ViewRequirementAgentConnector_ms": 0.19048643112182617}, "num_episodes": 29, "episode_return_max": -12.970614595696386, "episode_return_min": -1408.5342063694172, "episode_return_mean": -656.2659979977028, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.21096264953684, "num_env_steps_trained_throughput_per_sec": 313.21096264953684, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12331.819, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12331.744, "sample_time_ms": 1101.561, "learn_time_ms": 11163.105, "learn_throughput": 358.323, "synch_weights_time_ms": 66.282}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "4b94b_00000", "date": "2024-08-05_11-44-11", "timestamp": 1722838451, "time_this_iter_s": 12.783141851425171, "time_total_s": 256.0447835922241, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1110a27a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 256.0447835922241, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 17.75, "ram_util_percent": 29.200000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 139.61354255179563, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.8832565024339905, "policy_loss": -0.004928453024573779, "vf_loss": 0.8893702671242257, "vf_explained_var": 0.9933403022587299, "kl": 0.011365447736867899, "entropy": 1.3273786390821138, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -12.970614595696386, "episode_reward_min": -1288.3259224540595, "episode_reward_mean": -604.9626908541093, "episode_len_mean": 120.79, "episode_media": {}, "episodes_timesteps_total": 12079, "policy_reward_min": {"policy_0": -1288.3259224540595}, "policy_reward_max": {"policy_0": -12.970614595696386}, "policy_reward_mean": {"policy_0": -604.9626908541093}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-972.749951274887, -408.1785531368298, -37.01420547172523, -1020.9033913626889, -180.25130815111848, -734.7594302755074, -21.31297276079482, -221.20114937030377, -837.1806373843947, -694.2514885193472, -1034.572329856786, -634.1311838026535, -820.4790137389939, -140.89447517701737, -332.3386138787772, -1250.3818773322678, -54.523792425030415, -972.4740085002003, -807.1820417063451, -100.07108996198829, -491.9421723074122, -614.5329955536127, -88.35196764153577, -676.6138727612531, -391.1418236116776, -607.3385140343843, -1264.239885375655, -777.2481638699932, -313.5777596922913, -150.61899432805083, -1173.9298869210527, -1128.2382942138001, -118.53231633456394, -12.970614595696386, -1103.1183268701363, -178.9336843911374, -806.1040550186225, -1090.130835567344, -762.5981818866998, -162.9375394683638, -66.49883892511303, -441.20100973116405, -618.7528955712772, -469.77629627991763, -885.573697612119, -80.62815021479325, -582.5904316899201, -974.698689975564, -626.3501664055216, -998.5450848051702, -892.5221076986563, -647.6547690970428, -535.3703967107976, -962.5586652906048, -654.0941455367579, -386.7912229440364, -754.496950494711, -737.1170198888693, -283.5692327677051, -740.4600922733497, -920.9383261080452, -971.0445855903808, -123.27269846844145, -760.5261075513524, -556.4945102605293, -1103.8683231725647, -842.6871130588759, -1146.821100897305, -635.6133509238889, -212.48517071968178, -140.93819258104645, -97.2944187346677, -761.7062238807409, -1029.702751734024, -1118.0214656548076, -541.7056172930177, -1052.4925745240987, -111.04670475256586, -926.5392536403963, -1288.3259224540595, -765.911172974284, -80.86404851346246, -1008.4287656026781, -932.3475503056935, -626.8151649998183, -401.3610841763315, -135.3745705259493, -798.7778122560899, -570.8885857545927, -455.59612687455365, -512.829986297891, -1097.5778368680644, -108.93481922863683, -147.1545317797874, -871.4471760265994, -72.87733430141112, -102.45236823026492, -111.99561840104793, -944.3210853661144, -881.5877724831372], "episode_lengths": [150, 94, 46, 150, 77, 150, 38, 76, 150, 150, 150, 124, 150, 70, 90, 150, 41, 150, 150, 47, 111, 150, 58, 150, 102, 150, 150, 142, 102, 52, 150, 150, 50, 38, 150, 89, 150, 150, 150, 92, 53, 134, 150, 110, 150, 55, 150, 150, 150, 150, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 150, 150, 75, 137, 150, 150, 150, 150, 150, 69, 61, 57, 150, 150, 150, 150, 150, 66, 150, 150, 150, 68, 150, 150, 150, 98, 62, 150, 150, 103, 106, 150, 65, 80, 140, 41, 60, 69, 150, 150], "policy_policy_0_reward": [-972.749951274887, -408.1785531368298, -37.01420547172523, -1020.9033913626889, -180.25130815111848, -734.7594302755074, -21.31297276079482, -221.20114937030377, -837.1806373843947, -694.2514885193472, -1034.572329856786, -634.1311838026535, -820.4790137389939, -140.89447517701737, -332.3386138787772, -1250.3818773322678, -54.523792425030415, -972.4740085002003, -807.1820417063451, -100.07108996198829, -491.9421723074122, -614.5329955536127, -88.35196764153577, -676.6138727612531, -391.1418236116776, -607.3385140343843, -1264.239885375655, -777.2481638699932, -313.5777596922913, -150.61899432805083, -1173.9298869210527, -1128.2382942138001, -118.53231633456394, -12.970614595696386, -1103.1183268701363, -178.9336843911374, -806.1040550186225, -1090.130835567344, -762.5981818866998, -162.9375394683638, -66.49883892511303, -441.20100973116405, -618.7528955712772, -469.77629627991763, -885.573697612119, -80.62815021479325, -582.5904316899201, -974.698689975564, -626.3501664055216, -998.5450848051702, -892.5221076986563, -647.6547690970428, -535.3703967107976, -962.5586652906048, -654.0941455367579, -386.7912229440364, -754.496950494711, -737.1170198888693, -283.5692327677051, -740.4600922733497, -920.9383261080452, -971.0445855903808, -123.27269846844145, -760.5261075513524, -556.4945102605293, -1103.8683231725647, -842.6871130588759, -1146.821100897305, -635.6133509238889, -212.48517071968178, -140.93819258104645, -97.2944187346677, -761.7062238807409, -1029.702751734024, -1118.0214656548076, -541.7056172930177, -1052.4925745240987, -111.04670475256586, -926.5392536403963, -1288.3259224540595, -765.911172974284, -80.86404851346246, -1008.4287656026781, -932.3475503056935, -626.8151649998183, -401.3610841763315, -135.3745705259493, -798.7778122560899, -570.8885857545927, -455.59612687455365, -512.829986297891, -1097.5778368680644, -108.93481922863683, -147.1545317797874, -871.4471760265994, -72.87733430141112, -102.45236823026492, -111.99561840104793, -944.3210853661144, -881.5877724831372]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5558315972169849, "mean_inference_ms": 1.664080245113955, "mean_action_processing_ms": 0.2746729110537781, "mean_env_wait_ms": 3.399248328722503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012228727340698242, "StateBufferConnector_ms": 0.007896900177001953, "ViewRequirementAgentConnector_ms": 0.19227147102355957}, "num_episodes": 35, "episode_return_max": -12.970614595696386, "episode_return_min": -1288.3259224540595, "episode_return_mean": -604.9626908541093, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.6031151243739, "num_env_steps_trained_throughput_per_sec": 312.6031151243739, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12365.181, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12365.105, "sample_time_ms": 1107.23, "learn_time_ms": 11191.818, "learn_throughput": 357.404, "synch_weights_time_ms": 65.248}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "4b94b_00000", "date": "2024-08-05_11-44-24", "timestamp": 1722838464, "time_this_iter_s": 12.807745218276978, "time_total_s": 268.8525288105011, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1110a3400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 268.8525288105011, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 18.116666666666664, "ram_util_percent": 29.21111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 139.80493797560533, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.7846375114284456, "policy_loss": -0.00022747876403930907, "vf_loss": 0.7860881205958624, "vf_explained_var": 0.9751735311622421, "kl": 0.009193092663190341, "entropy": 1.3380433252702157, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -12.970614595696386, "episode_reward_min": -1383.9516969464203, "episode_reward_mean": -656.2233890102067, "episode_len_mean": 126.65, "episode_media": {}, "episodes_timesteps_total": 12665, "policy_reward_min": {"policy_0": -1383.9516969464203}, "policy_reward_max": {"policy_0": -12.970614595696386}, "policy_reward_mean": {"policy_0": -656.2233890102067}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-777.2481638699932, -313.5777596922913, -150.61899432805083, -1173.9298869210527, -1128.2382942138001, -118.53231633456394, -12.970614595696386, -1103.1183268701363, -178.9336843911374, -806.1040550186225, -1090.130835567344, -762.5981818866998, -162.9375394683638, -66.49883892511303, -441.20100973116405, -618.7528955712772, -469.77629627991763, -885.573697612119, -80.62815021479325, -582.5904316899201, -974.698689975564, -626.3501664055216, -998.5450848051702, -892.5221076986563, -647.6547690970428, -535.3703967107976, -962.5586652906048, -654.0941455367579, -386.7912229440364, -754.496950494711, -737.1170198888693, -283.5692327677051, -740.4600922733497, -920.9383261080452, -971.0445855903808, -123.27269846844145, -760.5261075513524, -556.4945102605293, -1103.8683231725647, -842.6871130588759, -1146.821100897305, -635.6133509238889, -212.48517071968178, -140.93819258104645, -97.2944187346677, -761.7062238807409, -1029.702751734024, -1118.0214656548076, -541.7056172930177, -1052.4925745240987, -111.04670475256586, -926.5392536403963, -1288.3259224540595, -765.911172974284, -80.86404851346246, -1008.4287656026781, -932.3475503056935, -626.8151649998183, -401.3610841763315, -135.3745705259493, -798.7778122560899, -570.8885857545927, -455.59612687455365, -512.829986297891, -1097.5778368680644, -108.93481922863683, -147.1545317797874, -871.4471760265994, -72.87733430141112, -102.45236823026492, -111.99561840104793, -944.3210853661144, -881.5877724831372, -813.4154851753952, -504.82454576872436, -431.39490234656097, -891.3076261870806, -945.5286052744696, -949.7286730838333, -866.0222347249339, -1170.9661799040678, -861.7143253868034, -948.6807140210936, -36.94012886286547, -1029.3808064832704, -1383.9516969464203, -99.93701406809305, -971.0029829315909, -883.8162320447385, -994.6713530460386, -330.7982576489976, -761.122308688362, -443.4810562891273, -697.8381711000205, -381.25843100894457, -1032.1041177778948, -653.1396801972002, -840.6139569231223, -1033.5049698471291, -577.9381052461599], "episode_lengths": [142, 102, 52, 150, 150, 50, 38, 150, 89, 150, 150, 150, 92, 53, 134, 150, 110, 150, 55, 150, 150, 150, 150, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 150, 150, 75, 137, 150, 150, 150, 150, 150, 69, 61, 57, 150, 150, 150, 150, 150, 66, 150, 150, 150, 68, 150, 150, 150, 98, 62, 150, 150, 103, 106, 150, 65, 80, 140, 41, 60, 69, 150, 150, 150, 106, 150, 146, 150, 150, 150, 150, 150, 150, 53, 150, 150, 66, 150, 150, 150, 89, 150, 150, 150, 88, 150, 150, 149, 150, 113], "policy_policy_0_reward": [-777.2481638699932, -313.5777596922913, -150.61899432805083, -1173.9298869210527, -1128.2382942138001, -118.53231633456394, -12.970614595696386, -1103.1183268701363, -178.9336843911374, -806.1040550186225, -1090.130835567344, -762.5981818866998, -162.9375394683638, -66.49883892511303, -441.20100973116405, -618.7528955712772, -469.77629627991763, -885.573697612119, -80.62815021479325, -582.5904316899201, -974.698689975564, -626.3501664055216, -998.5450848051702, -892.5221076986563, -647.6547690970428, -535.3703967107976, -962.5586652906048, -654.0941455367579, -386.7912229440364, -754.496950494711, -737.1170198888693, -283.5692327677051, -740.4600922733497, -920.9383261080452, -971.0445855903808, -123.27269846844145, -760.5261075513524, -556.4945102605293, -1103.8683231725647, -842.6871130588759, -1146.821100897305, -635.6133509238889, -212.48517071968178, -140.93819258104645, -97.2944187346677, -761.7062238807409, -1029.702751734024, -1118.0214656548076, -541.7056172930177, -1052.4925745240987, -111.04670475256586, -926.5392536403963, -1288.3259224540595, -765.911172974284, -80.86404851346246, -1008.4287656026781, -932.3475503056935, -626.8151649998183, -401.3610841763315, -135.3745705259493, -798.7778122560899, -570.8885857545927, -455.59612687455365, -512.829986297891, -1097.5778368680644, -108.93481922863683, -147.1545317797874, -871.4471760265994, -72.87733430141112, -102.45236823026492, -111.99561840104793, -944.3210853661144, -881.5877724831372, -813.4154851753952, -504.82454576872436, -431.39490234656097, -891.3076261870806, -945.5286052744696, -949.7286730838333, -866.0222347249339, -1170.9661799040678, -861.7143253868034, -948.6807140210936, -36.94012886286547, -1029.3808064832704, -1383.9516969464203, -99.93701406809305, -971.0029829315909, -883.8162320447385, -994.6713530460386, -330.7982576489976, -761.122308688362, -443.4810562891273, -697.8381711000205, -381.25843100894457, -1032.1041177778948, -653.1396801972002, -840.6139569231223, -1033.5049698471291, -577.9381052461599]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5557689724594936, "mean_inference_ms": 1.664523611428082, "mean_action_processing_ms": 0.27428524534982346, "mean_env_wait_ms": 3.399539371358754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01256561279296875, "StateBufferConnector_ms": 0.007905960083007812, "ViewRequirementAgentConnector_ms": 0.19151067733764648}, "num_episodes": 27, "episode_return_max": -12.970614595696386, "episode_return_min": -1383.9516969464203, "episode_return_mean": -656.2233890102067, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 429.3092238165111, "num_env_steps_trained_throughput_per_sec": 429.3092238165111, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12119.924, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12119.85, "sample_time_ms": 1109.384, "learn_time_ms": 10945.159, "learn_throughput": 365.458, "synch_weights_time_ms": 64.488}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "4b94b_00000", "date": "2024-08-05_11-44-33", "timestamp": 1722838473, "time_this_iter_s": 9.329082012176514, "time_total_s": 278.1816108226776, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1113d2680>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 278.1816108226776, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 20.484615384615385, "ram_util_percent": 29.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 149.64928598900636, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.7307512941304595, "policy_loss": -0.004882308390612404, "vf_loss": 0.7369416031055153, "vf_explained_var": 0.9969054334486525, "kl": 0.009329791962287963, "entropy": 1.424619942655166, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -2.512407332708518, "episode_reward_min": -1383.9516969464203, "episode_reward_mean": -695.5755704400488, "episode_len_mean": 129.01, "episode_media": {}, "episodes_timesteps_total": 12901, "policy_reward_min": {"policy_0": -1383.9516969464203}, "policy_reward_max": {"policy_0": -2.512407332708518}, "policy_reward_mean": {"policy_0": -695.5755704400488}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-740.4600922733497, -920.9383261080452, -971.0445855903808, -123.27269846844145, -760.5261075513524, -556.4945102605293, -1103.8683231725647, -842.6871130588759, -1146.821100897305, -635.6133509238889, -212.48517071968178, -140.93819258104645, -97.2944187346677, -761.7062238807409, -1029.702751734024, -1118.0214656548076, -541.7056172930177, -1052.4925745240987, -111.04670475256586, -926.5392536403963, -1288.3259224540595, -765.911172974284, -80.86404851346246, -1008.4287656026781, -932.3475503056935, -626.8151649998183, -401.3610841763315, -135.3745705259493, -798.7778122560899, -570.8885857545927, -455.59612687455365, -512.829986297891, -1097.5778368680644, -108.93481922863683, -147.1545317797874, -871.4471760265994, -72.87733430141112, -102.45236823026492, -111.99561840104793, -944.3210853661144, -881.5877724831372, -813.4154851753952, -504.82454576872436, -431.39490234656097, -891.3076261870806, -945.5286052744696, -949.7286730838333, -866.0222347249339, -1170.9661799040678, -861.7143253868034, -948.6807140210936, -36.94012886286547, -1029.3808064832704, -1383.9516969464203, -99.93701406809305, -971.0029829315909, -883.8162320447385, -994.6713530460386, -330.7982576489976, -761.122308688362, -443.4810562891273, -697.8381711000205, -381.25843100894457, -1032.1041177778948, -653.1396801972002, -840.6139569231223, -1033.5049698471291, -577.9381052461599, -1108.35491278744, -748.9223103599147, -477.891255692615, -760.2725299778575, -632.9512675404069, -606.5771566136965, -463.532475739201, -859.506075999478, -788.5935817253171, -1125.104154676474, -469.475956138786, -8.050984883708859, -765.2941288893069, -255.99639221821542, -610.614449178008, -992.8428046868355, -735.3002930974624, -1326.7067398545364, -1156.8689722562378, -1126.7501851239035, -1284.279117689912, -980.8131595433675, -271.86125686906314, -791.663343140156, -2.512407332708518, -967.1005228305772, -777.5045648806282, -1018.7140319529037, -646.8276391305347, -473.80414502820844, -131.52244979360577, -946.7373021506236], "episode_lengths": [150, 150, 150, 75, 137, 150, 150, 150, 150, 150, 69, 61, 57, 150, 150, 150, 150, 150, 66, 150, 150, 150, 68, 150, 150, 150, 98, 62, 150, 150, 103, 106, 150, 65, 80, 140, 41, 60, 69, 150, 150, 150, 106, 150, 146, 150, 150, 150, 150, 150, 150, 53, 150, 150, 66, 150, 150, 150, 89, 150, 150, 150, 88, 150, 150, 149, 150, 113, 150, 150, 143, 150, 128, 150, 150, 150, 150, 150, 150, 31, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 33, 150, 150, 150, 150, 100, 66, 150], "policy_policy_0_reward": [-740.4600922733497, -920.9383261080452, -971.0445855903808, -123.27269846844145, -760.5261075513524, -556.4945102605293, -1103.8683231725647, -842.6871130588759, -1146.821100897305, -635.6133509238889, -212.48517071968178, -140.93819258104645, -97.2944187346677, -761.7062238807409, -1029.702751734024, -1118.0214656548076, -541.7056172930177, -1052.4925745240987, -111.04670475256586, -926.5392536403963, -1288.3259224540595, -765.911172974284, -80.86404851346246, -1008.4287656026781, -932.3475503056935, -626.8151649998183, -401.3610841763315, -135.3745705259493, -798.7778122560899, -570.8885857545927, -455.59612687455365, -512.829986297891, -1097.5778368680644, -108.93481922863683, -147.1545317797874, -871.4471760265994, -72.87733430141112, -102.45236823026492, -111.99561840104793, -944.3210853661144, -881.5877724831372, -813.4154851753952, -504.82454576872436, -431.39490234656097, -891.3076261870806, -945.5286052744696, -949.7286730838333, -866.0222347249339, -1170.9661799040678, -861.7143253868034, -948.6807140210936, -36.94012886286547, -1029.3808064832704, -1383.9516969464203, -99.93701406809305, -971.0029829315909, -883.8162320447385, -994.6713530460386, -330.7982576489976, -761.122308688362, -443.4810562891273, -697.8381711000205, -381.25843100894457, -1032.1041177778948, -653.1396801972002, -840.6139569231223, -1033.5049698471291, -577.9381052461599, -1108.35491278744, -748.9223103599147, -477.891255692615, -760.2725299778575, -632.9512675404069, -606.5771566136965, -463.532475739201, -859.506075999478, -788.5935817253171, -1125.104154676474, -469.475956138786, -8.050984883708859, -765.2941288893069, -255.99639221821542, -610.614449178008, -992.8428046868355, -735.3002930974624, -1326.7067398545364, -1156.8689722562378, -1126.7501851239035, -1284.279117689912, -980.8131595433675, -271.86125686906314, -791.663343140156, -2.512407332708518, -967.1005228305772, -777.5045648806282, -1018.7140319529037, -646.8276391305347, -473.80414502820844, -131.52244979360577, -946.7373021506236]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5558508925861902, "mean_inference_ms": 1.6649561528295638, "mean_action_processing_ms": 0.27419443759048323, "mean_env_wait_ms": 3.399427460830675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01507258415222168, "StateBufferConnector_ms": 0.007880926132202148, "ViewRequirementAgentConnector_ms": 0.18974637985229492}, "num_episodes": 32, "episode_return_max": -2.512407332708518, "episode_return_min": -1383.9516969464203, "episode_return_mean": -695.5755704400488, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 337.60117541730045, "num_env_steps_trained_throughput_per_sec": 337.60117541730045, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12012.028, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12011.953, "sample_time_ms": 1116.519, "learn_time_ms": 10829.339, "learn_throughput": 369.367, "synch_weights_time_ms": 65.267}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "4b94b_00000", "date": "2024-08-05_11-44-45", "timestamp": 1722838485, "time_this_iter_s": 11.861637115478516, "time_total_s": 290.0432479381561, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1113d3b50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 290.0432479381561, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 18.41764705882353, "ram_util_percent": 29.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 124.70653261144956, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9968104032489161, "policy_loss": -0.003926466997654643, "vf_loss": 1.002016755907486, "vf_explained_var": 0.9927485764647523, "kl": 0.010156980470947033, "entropy": 1.4068487737327815, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -2.512407332708518, "episode_reward_min": -1514.9258182107635, "episode_reward_mean": -693.7912247105477, "episode_len_mean": 129.82, "episode_media": {}, "episodes_timesteps_total": 12982, "policy_reward_min": {"policy_0": -1514.9258182107635}, "policy_reward_max": {"policy_0": -2.512407332708518}, "policy_reward_mean": {"policy_0": -693.7912247105477}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-108.93481922863683, -147.1545317797874, -871.4471760265994, -72.87733430141112, -102.45236823026492, -111.99561840104793, -944.3210853661144, -881.5877724831372, -813.4154851753952, -504.82454576872436, -431.39490234656097, -891.3076261870806, -945.5286052744696, -949.7286730838333, -866.0222347249339, -1170.9661799040678, -861.7143253868034, -948.6807140210936, -36.94012886286547, -1029.3808064832704, -1383.9516969464203, -99.93701406809305, -971.0029829315909, -883.8162320447385, -994.6713530460386, -330.7982576489976, -761.122308688362, -443.4810562891273, -697.8381711000205, -381.25843100894457, -1032.1041177778948, -653.1396801972002, -840.6139569231223, -1033.5049698471291, -577.9381052461599, -1108.35491278744, -748.9223103599147, -477.891255692615, -760.2725299778575, -632.9512675404069, -606.5771566136965, -463.532475739201, -859.506075999478, -788.5935817253171, -1125.104154676474, -469.475956138786, -8.050984883708859, -765.2941288893069, -255.99639221821542, -610.614449178008, -992.8428046868355, -735.3002930974624, -1326.7067398545364, -1156.8689722562378, -1126.7501851239035, -1284.279117689912, -980.8131595433675, -271.86125686906314, -791.663343140156, -2.512407332708518, -967.1005228305772, -777.5045648806282, -1018.7140319529037, -646.8276391305347, -473.80414502820844, -131.52244979360577, -946.7373021506236, -934.1216222868087, -776.9826597731197, -783.9865110441202, -336.79963165375517, -403.13304591510104, -1301.4719333183562, -1085.3200722912056, -604.0534411515409, -929.8187673111731, -1044.765254944317, -310.14092601391104, -662.8646697794301, -595.7512691326492, -797.0992685350358, -666.0660316758322, -930.4483939281694, -104.43575315821202, -988.2287637734232, -1226.066136137628, -82.54306788429383, -1095.1813073569633, -284.47534384174406, -304.3970969512079, -909.7823186575274, -17.657919718000873, -944.7444713603951, -113.42286807643869, -823.9118679798453, -216.61899795929702, -516.381222652894, -68.38546237614925, -916.3407216238304, -1514.9258182107635], "episode_lengths": [65, 80, 140, 41, 60, 69, 150, 150, 150, 106, 150, 146, 150, 150, 150, 150, 150, 150, 53, 150, 150, 66, 150, 150, 150, 89, 150, 150, 150, 88, 150, 150, 149, 150, 113, 150, 150, 143, 150, 128, 150, 150, 150, 150, 150, 150, 31, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 33, 150, 150, 150, 150, 100, 66, 150, 150, 150, 150, 124, 94, 150, 150, 123, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 72, 150, 95, 134, 150, 41, 150, 74, 150, 100, 150, 55, 150, 150], "policy_policy_0_reward": [-108.93481922863683, -147.1545317797874, -871.4471760265994, -72.87733430141112, -102.45236823026492, -111.99561840104793, -944.3210853661144, -881.5877724831372, -813.4154851753952, -504.82454576872436, -431.39490234656097, -891.3076261870806, -945.5286052744696, -949.7286730838333, -866.0222347249339, -1170.9661799040678, -861.7143253868034, -948.6807140210936, -36.94012886286547, -1029.3808064832704, -1383.9516969464203, -99.93701406809305, -971.0029829315909, -883.8162320447385, -994.6713530460386, -330.7982576489976, -761.122308688362, -443.4810562891273, -697.8381711000205, -381.25843100894457, -1032.1041177778948, -653.1396801972002, -840.6139569231223, -1033.5049698471291, -577.9381052461599, -1108.35491278744, -748.9223103599147, -477.891255692615, -760.2725299778575, -632.9512675404069, -606.5771566136965, -463.532475739201, -859.506075999478, -788.5935817253171, -1125.104154676474, -469.475956138786, -8.050984883708859, -765.2941288893069, -255.99639221821542, -610.614449178008, -992.8428046868355, -735.3002930974624, -1326.7067398545364, -1156.8689722562378, -1126.7501851239035, -1284.279117689912, -980.8131595433675, -271.86125686906314, -791.663343140156, -2.512407332708518, -967.1005228305772, -777.5045648806282, -1018.7140319529037, -646.8276391305347, -473.80414502820844, -131.52244979360577, -946.7373021506236, -934.1216222868087, -776.9826597731197, -783.9865110441202, -336.79963165375517, -403.13304591510104, -1301.4719333183562, -1085.3200722912056, -604.0534411515409, -929.8187673111731, -1044.765254944317, -310.14092601391104, -662.8646697794301, -595.7512691326492, -797.0992685350358, -666.0660316758322, -930.4483939281694, -104.43575315821202, -988.2287637734232, -1226.066136137628, -82.54306788429383, -1095.1813073569633, -284.47534384174406, -304.3970969512079, -909.7823186575274, -17.657919718000873, -944.7444713603951, -113.42286807643869, -823.9118679798453, -216.61899795929702, -516.381222652894, -68.38546237614925, -916.3407216238304, -1514.9258182107635]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5559425928657796, "mean_inference_ms": 1.6645036477550377, "mean_action_processing_ms": 0.2741032115675415, "mean_env_wait_ms": 3.3979530282085992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014695167541503906, "StateBufferConnector_ms": 0.007883548736572266, "ViewRequirementAgentConnector_ms": 0.19052839279174805}, "num_episodes": 33, "episode_return_max": -2.512407332708518, "episode_return_min": -1514.9258182107635, "episode_return_mean": -693.7912247105477, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.28920127482434, "num_env_steps_trained_throughput_per_sec": 313.28920127482434, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12005.246, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12005.173, "sample_time_ms": 1124.712, "learn_time_ms": 10814.758, "learn_throughput": 369.865, "synch_weights_time_ms": 64.873}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "training_iteration": 25, "trial_id": "4b94b_00000", "date": "2024-08-05_11-44-58", "timestamp": 1722838498, "time_this_iter_s": 12.780130386352539, "time_total_s": 302.82337832450867, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e11156aa70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 302.82337832450867, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 17.61578947368421, "ram_util_percent": 29.200000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 133.79031308591365, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.976704520949473, "policy_loss": -0.0019983036094345153, "vf_loss": 0.9799780489876866, "vf_explained_var": 0.9944027158121268, "kl": 0.007815162397203809, "entropy": 1.3729118026793004, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "env_runners": {"episode_reward_max": -2.512407332708518, "episode_reward_min": -1514.9258182107635, "episode_reward_mean": -681.4411570428651, "episode_len_mean": 127.35, "episode_media": {}, "episodes_timesteps_total": 12735, "policy_reward_min": {"policy_0": -1514.9258182107635}, "policy_reward_max": {"policy_0": -2.512407332708518}, "policy_reward_mean": {"policy_0": -681.4411570428651}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-653.1396801972002, -840.6139569231223, -1033.5049698471291, -577.9381052461599, -1108.35491278744, -748.9223103599147, -477.891255692615, -760.2725299778575, -632.9512675404069, -606.5771566136965, -463.532475739201, -859.506075999478, -788.5935817253171, -1125.104154676474, -469.475956138786, -8.050984883708859, -765.2941288893069, -255.99639221821542, -610.614449178008, -992.8428046868355, -735.3002930974624, -1326.7067398545364, -1156.8689722562378, -1126.7501851239035, -1284.279117689912, -980.8131595433675, -271.86125686906314, -791.663343140156, -2.512407332708518, -967.1005228305772, -777.5045648806282, -1018.7140319529037, -646.8276391305347, -473.80414502820844, -131.52244979360577, -946.7373021506236, -934.1216222868087, -776.9826597731197, -783.9865110441202, -336.79963165375517, -403.13304591510104, -1301.4719333183562, -1085.3200722912056, -604.0534411515409, -929.8187673111731, -1044.765254944317, -310.14092601391104, -662.8646697794301, -595.7512691326492, -797.0992685350358, -666.0660316758322, -930.4483939281694, -104.43575315821202, -988.2287637734232, -1226.066136137628, -82.54306788429383, -1095.1813073569633, -284.47534384174406, -304.3970969512079, -909.7823186575274, -17.657919718000873, -944.7444713603951, -113.42286807643869, -823.9118679798453, -216.61899795929702, -516.381222652894, -68.38546237614925, -916.3407216238304, -1514.9258182107635, -932.8450514863689, -105.65390869089967, -955.6628635700908, -342.3715608848682, -298.75815013968395, -47.69949027458989, -176.54976521314725, -1106.8863961429856, -450.31919010050706, -894.9045919979817, -158.37307884115427, -1292.5933679105376, -1257.487727236947, -152.55562560251133, -1283.8033073862307, -1348.257309226002, -1229.6003204735962, -627.3843079168802, -130.44001525762326, -300.75554104532665, -1088.3334741884091, -916.5634115817519, -1116.4773690942748, -551.0837331140835, -18.74487470802145, -316.06984115419334, -729.491431919309, -570.3370218234724, -96.11208004566339, -761.0216894893457, -178.5132913015992], "episode_lengths": [150, 149, 150, 113, 150, 150, 143, 150, 128, 150, 150, 150, 150, 150, 150, 31, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 33, 150, 150, 150, 150, 100, 66, 150, 150, 150, 150, 124, 94, 150, 150, 123, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 72, 150, 95, 134, 150, 41, 150, 74, 150, 100, 150, 55, 150, 150, 150, 46, 150, 122, 77, 61, 81, 150, 150, 150, 56, 150, 150, 79, 150, 150, 150, 150, 59, 110, 150, 150, 150, 121, 43, 82, 150, 110, 70, 150, 89], "policy_policy_0_reward": [-653.1396801972002, -840.6139569231223, -1033.5049698471291, -577.9381052461599, -1108.35491278744, -748.9223103599147, -477.891255692615, -760.2725299778575, -632.9512675404069, -606.5771566136965, -463.532475739201, -859.506075999478, -788.5935817253171, -1125.104154676474, -469.475956138786, -8.050984883708859, -765.2941288893069, -255.99639221821542, -610.614449178008, -992.8428046868355, -735.3002930974624, -1326.7067398545364, -1156.8689722562378, -1126.7501851239035, -1284.279117689912, -980.8131595433675, -271.86125686906314, -791.663343140156, -2.512407332708518, -967.1005228305772, -777.5045648806282, -1018.7140319529037, -646.8276391305347, -473.80414502820844, -131.52244979360577, -946.7373021506236, -934.1216222868087, -776.9826597731197, -783.9865110441202, -336.79963165375517, -403.13304591510104, -1301.4719333183562, -1085.3200722912056, -604.0534411515409, -929.8187673111731, -1044.765254944317, -310.14092601391104, -662.8646697794301, -595.7512691326492, -797.0992685350358, -666.0660316758322, -930.4483939281694, -104.43575315821202, -988.2287637734232, -1226.066136137628, -82.54306788429383, -1095.1813073569633, -284.47534384174406, -304.3970969512079, -909.7823186575274, -17.657919718000873, -944.7444713603951, -113.42286807643869, -823.9118679798453, -216.61899795929702, -516.381222652894, -68.38546237614925, -916.3407216238304, -1514.9258182107635, -932.8450514863689, -105.65390869089967, -955.6628635700908, -342.3715608848682, -298.75815013968395, -47.69949027458989, -176.54976521314725, -1106.8863961429856, -450.31919010050706, -894.9045919979817, -158.37307884115427, -1292.5933679105376, -1257.487727236947, -152.55562560251133, -1283.8033073862307, -1348.257309226002, -1229.6003204735962, -627.3843079168802, -130.44001525762326, -300.75554104532665, -1088.3334741884091, -916.5634115817519, -1116.4773690942748, -551.0837331140835, -18.74487470802145, -316.06984115419334, -729.491431919309, -570.3370218234724, -96.11208004566339, -761.0216894893457, -178.5132913015992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5553290276501113, "mean_inference_ms": 1.6640943114289501, "mean_action_processing_ms": 0.2739949117851946, "mean_env_wait_ms": 3.399243132357979, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014314889907836914, "StateBufferConnector_ms": 0.007869720458984375, "ViewRequirementAgentConnector_ms": 0.19248533248901367}, "num_episodes": 31, "episode_return_max": -2.512407332708518, "episode_return_min": -1514.9258182107635, "episode_return_mean": -681.4411570428651, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 353.3647294600997, "num_env_steps_trained_throughput_per_sec": 353.3647294600997, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 11939.38, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11939.306, "sample_time_ms": 1126.355, "learn_time_ms": 10746.905, "learn_throughput": 372.2, "synch_weights_time_ms": 65.225}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "training_iteration": 26, "trial_id": "4b94b_00000", "date": "2024-08-05_11-45-09", "timestamp": 1722838509, "time_this_iter_s": 11.333467960357666, "time_total_s": 314.15684628486633, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1110a0ee0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 314.15684628486633, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 18.76875, "ram_util_percent": 29.21875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 121.31493554313978, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9189823947070788, "policy_loss": -0.0037823996453274352, "vf_loss": 0.9239845709254344, "vf_explained_var": 0.9950029941275715, "kl": 0.009593628518086917, "entropy": 1.3396970773736636, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "env_runners": {"episode_reward_max": -4.289353575744063, "episode_reward_min": -1514.9258182107635, "episode_reward_mean": -613.7981394232052, "episode_len_mean": 120.26, "episode_media": {}, "episodes_timesteps_total": 12026, "policy_reward_min": {"policy_0": -1514.9258182107635}, "policy_reward_max": {"policy_0": -4.289353575744063}, "policy_reward_mean": {"policy_0": -613.7981394232052}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-646.8276391305347, -473.80414502820844, -131.52244979360577, -946.7373021506236, -934.1216222868087, -776.9826597731197, -783.9865110441202, -336.79963165375517, -403.13304591510104, -1301.4719333183562, -1085.3200722912056, -604.0534411515409, -929.8187673111731, -1044.765254944317, -310.14092601391104, -662.8646697794301, -595.7512691326492, -797.0992685350358, -666.0660316758322, -930.4483939281694, -104.43575315821202, -988.2287637734232, -1226.066136137628, -82.54306788429383, -1095.1813073569633, -284.47534384174406, -304.3970969512079, -909.7823186575274, -17.657919718000873, -944.7444713603951, -113.42286807643869, -823.9118679798453, -216.61899795929702, -516.381222652894, -68.38546237614925, -916.3407216238304, -1514.9258182107635, -932.8450514863689, -105.65390869089967, -955.6628635700908, -342.3715608848682, -298.75815013968395, -47.69949027458989, -176.54976521314725, -1106.8863961429856, -450.31919010050706, -894.9045919979817, -158.37307884115427, -1292.5933679105376, -1257.487727236947, -152.55562560251133, -1283.8033073862307, -1348.257309226002, -1229.6003204735962, -627.3843079168802, -130.44001525762326, -300.75554104532665, -1088.3334741884091, -916.5634115817519, -1116.4773690942748, -551.0837331140835, -18.74487470802145, -316.06984115419334, -729.491431919309, -570.3370218234724, -96.11208004566339, -761.0216894893457, -178.5132913015992, -305.1018079514567, -532.767524986947, -111.75983866282097, -4.289353575744063, -785.4648733716151, -1165.4190208101681, -624.8191036842484, -367.7568893508409, -360.632950732151, -922.6404646408561, -719.4381361933013, -20.36962084028984, -914.8374720142295, -121.8327211227839, -73.31911977034542, -209.02282198613995, -845.3558693903282, -734.9722407565382, -121.84576061440133, -89.83165832716972, -952.4737907922339, -778.0129548569892, -53.69660889508631, -668.8009764483764, -167.36126505819354, -333.41962995661237, -1364.1232993067622, -142.35688983284027, -1204.320322448722, -1058.133349454934, -432.31916231495785, -1268.4544837782637], "episode_lengths": [150, 100, 66, 150, 150, 150, 150, 124, 94, 150, 150, 123, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 72, 150, 95, 134, 150, 41, 150, 74, 150, 100, 150, 55, 150, 150, 150, 46, 150, 122, 77, 61, 81, 150, 150, 150, 56, 150, 150, 79, 150, 150, 150, 150, 59, 110, 150, 150, 150, 121, 43, 82, 150, 110, 70, 150, 89, 127, 150, 83, 35, 150, 150, 150, 88, 150, 150, 150, 47, 150, 65, 63, 73, 150, 150, 78, 76, 150, 150, 52, 149, 58, 89, 150, 81, 150, 150, 107, 150], "policy_policy_0_reward": [-646.8276391305347, -473.80414502820844, -131.52244979360577, -946.7373021506236, -934.1216222868087, -776.9826597731197, -783.9865110441202, -336.79963165375517, -403.13304591510104, -1301.4719333183562, -1085.3200722912056, -604.0534411515409, -929.8187673111731, -1044.765254944317, -310.14092601391104, -662.8646697794301, -595.7512691326492, -797.0992685350358, -666.0660316758322, -930.4483939281694, -104.43575315821202, -988.2287637734232, -1226.066136137628, -82.54306788429383, -1095.1813073569633, -284.47534384174406, -304.3970969512079, -909.7823186575274, -17.657919718000873, -944.7444713603951, -113.42286807643869, -823.9118679798453, -216.61899795929702, -516.381222652894, -68.38546237614925, -916.3407216238304, -1514.9258182107635, -932.8450514863689, -105.65390869089967, -955.6628635700908, -342.3715608848682, -298.75815013968395, -47.69949027458989, -176.54976521314725, -1106.8863961429856, -450.31919010050706, -894.9045919979817, -158.37307884115427, -1292.5933679105376, -1257.487727236947, -152.55562560251133, -1283.8033073862307, -1348.257309226002, -1229.6003204735962, -627.3843079168802, -130.44001525762326, -300.75554104532665, -1088.3334741884091, -916.5634115817519, -1116.4773690942748, -551.0837331140835, -18.74487470802145, -316.06984115419334, -729.491431919309, -570.3370218234724, -96.11208004566339, -761.0216894893457, -178.5132913015992, -305.1018079514567, -532.767524986947, -111.75983866282097, -4.289353575744063, -785.4648733716151, -1165.4190208101681, -624.8191036842484, -367.7568893508409, -360.632950732151, -922.6404646408561, -719.4381361933013, -20.36962084028984, -914.8374720142295, -121.8327211227839, -73.31911977034542, -209.02282198613995, -845.3558693903282, -734.9722407565382, -121.84576061440133, -89.83165832716972, -952.4737907922339, -778.0129548569892, -53.69660889508631, -668.8009764483764, -167.36126505819354, -333.41962995661237, -1364.1232993067622, -142.35688983284027, -1204.320322448722, -1058.133349454934, -432.31916231495785, -1268.4544837782637]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5555501167947505, "mean_inference_ms": 1.6636145281669519, "mean_action_processing_ms": 0.2739398901524023, "mean_env_wait_ms": 3.399043404245883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011740922927856445, "StateBufferConnector_ms": 0.007968902587890625, "ViewRequirementAgentConnector_ms": 0.1919407844543457}, "num_episodes": 32, "episode_return_max": -4.289353575744063, "episode_return_min": -1514.9258182107635, "episode_return_mean": -613.7981394232052, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 341.68960063360333, "num_env_steps_trained_throughput_per_sec": 341.68960063360333, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 11807.572, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11807.497, "sample_time_ms": 1125.203, "learn_time_ms": 10616.353, "learn_throughput": 376.777, "synch_weights_time_ms": 65.12}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "training_iteration": 27, "trial_id": "4b94b_00000", "date": "2024-08-05_11-45-21", "timestamp": 1722838521, "time_this_iter_s": 11.71855115890503, "time_total_s": 325.87539744377136, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1110a23b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 325.87539744377136, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 19.0, "ram_util_percent": 29.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 131.22807131508986, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.7826216062608485, "policy_loss": -0.006273614122134555, "vf_loss": 0.7901947295603653, "vf_explained_var": 0.9965251770491401, "kl": 0.009590395984954148, "entropy": 1.4193888805806636, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": -4.289353575744063, "episode_reward_min": -1514.9258182107635, "episode_reward_mean": -620.6309804901791, "episode_len_mean": 118.5, "episode_media": {}, "episodes_timesteps_total": 11850, "policy_reward_min": {"policy_0": -1514.9258182107635}, "policy_reward_max": {"policy_0": -4.289353575744063}, "policy_reward_mean": {"policy_0": -620.6309804901791}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1514.9258182107635, -932.8450514863689, -105.65390869089967, -955.6628635700908, -342.3715608848682, -298.75815013968395, -47.69949027458989, -176.54976521314725, -1106.8863961429856, -450.31919010050706, -894.9045919979817, -158.37307884115427, -1292.5933679105376, -1257.487727236947, -152.55562560251133, -1283.8033073862307, -1348.257309226002, -1229.6003204735962, -627.3843079168802, -130.44001525762326, -300.75554104532665, -1088.3334741884091, -916.5634115817519, -1116.4773690942748, -551.0837331140835, -18.74487470802145, -316.06984115419334, -729.491431919309, -570.3370218234724, -96.11208004566339, -761.0216894893457, -178.5132913015992, -305.1018079514567, -532.767524986947, -111.75983866282097, -4.289353575744063, -785.4648733716151, -1165.4190208101681, -624.8191036842484, -367.7568893508409, -360.632950732151, -922.6404646408561, -719.4381361933013, -20.36962084028984, -914.8374720142295, -121.8327211227839, -73.31911977034542, -209.02282198613995, -845.3558693903282, -734.9722407565382, -121.84576061440133, -89.83165832716972, -952.4737907922339, -778.0129548569892, -53.69660889508631, -668.8009764483764, -167.36126505819354, -333.41962995661237, -1364.1232993067622, -142.35688983284027, -1204.320322448722, -1058.133349454934, -432.31916231495785, -1268.4544837782637, -839.0904676527597, -196.06371392549212, -224.03983425022753, -422.7007439418628, -1083.443598920923, -178.53030328330496, -1087.772720622821, -97.25829886672953, -1011.1448543545547, -919.2202947326305, -776.1099166604208, -208.3768521169022, -568.2234925832029, -1188.8532943755304, -12.439626096194706, -727.3593450012062, -939.3915145470821, -165.91542551674232, -1330.5791901317398, -960.6371601266659, -85.76382185659175, -1242.8269062405107, -27.086119233709137, -1136.8270917696489, -1032.6389226808956, -780.5208619210275, -351.0852479361273, -1024.1027204518753, -1000.2738377871951, -18.957426005686322, -1083.1993787441374, -405.1215516079251, -1122.6456662587793, -355.19438073295726, -666.024364499229, -388.1535156294514], "episode_lengths": [150, 150, 46, 150, 122, 77, 61, 81, 150, 150, 150, 56, 150, 150, 79, 150, 150, 150, 150, 59, 110, 150, 150, 150, 121, 43, 82, 150, 110, 70, 150, 89, 127, 150, 83, 35, 150, 150, 150, 88, 150, 150, 150, 47, 150, 65, 63, 73, 150, 150, 78, 76, 150, 150, 52, 149, 58, 89, 150, 81, 150, 150, 107, 150, 150, 94, 81, 117, 150, 79, 150, 76, 150, 150, 150, 70, 150, 150, 43, 150, 150, 89, 150, 150, 54, 150, 43, 150, 150, 150, 150, 150, 150, 41, 150, 150, 150, 90, 150, 96], "policy_policy_0_reward": [-1514.9258182107635, -932.8450514863689, -105.65390869089967, -955.6628635700908, -342.3715608848682, -298.75815013968395, -47.69949027458989, -176.54976521314725, -1106.8863961429856, -450.31919010050706, -894.9045919979817, -158.37307884115427, -1292.5933679105376, -1257.487727236947, -152.55562560251133, -1283.8033073862307, -1348.257309226002, -1229.6003204735962, -627.3843079168802, -130.44001525762326, -300.75554104532665, -1088.3334741884091, -916.5634115817519, -1116.4773690942748, -551.0837331140835, -18.74487470802145, -316.06984115419334, -729.491431919309, -570.3370218234724, -96.11208004566339, -761.0216894893457, -178.5132913015992, -305.1018079514567, -532.767524986947, -111.75983866282097, -4.289353575744063, -785.4648733716151, -1165.4190208101681, -624.8191036842484, -367.7568893508409, -360.632950732151, -922.6404646408561, -719.4381361933013, -20.36962084028984, -914.8374720142295, -121.8327211227839, -73.31911977034542, -209.02282198613995, -845.3558693903282, -734.9722407565382, -121.84576061440133, -89.83165832716972, -952.4737907922339, -778.0129548569892, -53.69660889508631, -668.8009764483764, -167.36126505819354, -333.41962995661237, -1364.1232993067622, -142.35688983284027, -1204.320322448722, -1058.133349454934, -432.31916231495785, -1268.4544837782637, -839.0904676527597, -196.06371392549212, -224.03983425022753, -422.7007439418628, -1083.443598920923, -178.53030328330496, -1087.772720622821, -97.25829886672953, -1011.1448543545547, -919.2202947326305, -776.1099166604208, -208.3768521169022, -568.2234925832029, -1188.8532943755304, -12.439626096194706, -727.3593450012062, -939.3915145470821, -165.91542551674232, -1330.5791901317398, -960.6371601266659, -85.76382185659175, -1242.8269062405107, -27.086119233709137, -1136.8270917696489, -1032.6389226808956, -780.5208619210275, -351.0852479361273, -1024.1027204518753, -1000.2738377871951, -18.957426005686322, -1083.1993787441374, -405.1215516079251, -1122.6456662587793, -355.19438073295726, -666.024364499229, -388.1535156294514]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5550684273161236, "mean_inference_ms": 1.6626689394923113, "mean_action_processing_ms": 0.27388553410884237, "mean_env_wait_ms": 3.3974668772747716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01192474365234375, "StateBufferConnector_ms": 0.008040666580200195, "ViewRequirementAgentConnector_ms": 0.19316744804382324}, "num_episodes": 36, "episode_return_max": -4.289353575744063, "episode_return_min": -1514.9258182107635, "episode_return_mean": -620.6309804901791, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 332.6776763839209, "num_env_steps_trained_throughput_per_sec": 332.6776763839209, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 12006.78, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12006.709, "sample_time_ms": 1141.159, "learn_time_ms": 10799.654, "learn_throughput": 370.382, "synch_weights_time_ms": 65.081}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 28, "trial_id": "4b94b_00000", "date": "2024-08-05_11-45-33", "timestamp": 1722838533, "time_this_iter_s": 12.03730034828186, "time_total_s": 337.9126977920532, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1110a2440>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 337.9126977920532, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 18.005555555555553, "ram_util_percent": 29.200000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 138.82562183638413, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.8699152576116224, "policy_loss": -0.0008384107384093416, "vf_loss": 0.8721176352972786, "vf_explained_var": 0.9851911930988232, "kl": 0.009665232646254178, "entropy": 1.4847826631118854, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "env_runners": {"episode_reward_max": -4.289353575744063, "episode_reward_min": -1364.1232993067622, "episode_reward_mean": -622.424637320029, "episode_len_mean": 120.74, "episode_media": {}, "episodes_timesteps_total": 12074, "policy_reward_min": {"policy_0": -1364.1232993067622}, "policy_reward_max": {"policy_0": -4.289353575744063}, "policy_reward_mean": {"policy_0": -622.424637320029}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-532.767524986947, -111.75983866282097, -4.289353575744063, -785.4648733716151, -1165.4190208101681, -624.8191036842484, -367.7568893508409, -360.632950732151, -922.6404646408561, -719.4381361933013, -20.36962084028984, -914.8374720142295, -121.8327211227839, -73.31911977034542, -209.02282198613995, -845.3558693903282, -734.9722407565382, -121.84576061440133, -89.83165832716972, -952.4737907922339, -778.0129548569892, -53.69660889508631, -668.8009764483764, -167.36126505819354, -333.41962995661237, -1364.1232993067622, -142.35688983284027, -1204.320322448722, -1058.133349454934, -432.31916231495785, -1268.4544837782637, -839.0904676527597, -196.06371392549212, -224.03983425022753, -422.7007439418628, -1083.443598920923, -178.53030328330496, -1087.772720622821, -97.25829886672953, -1011.1448543545547, -919.2202947326305, -776.1099166604208, -208.3768521169022, -568.2234925832029, -1188.8532943755304, -12.439626096194706, -727.3593450012062, -939.3915145470821, -165.91542551674232, -1330.5791901317398, -960.6371601266659, -85.76382185659175, -1242.8269062405107, -27.086119233709137, -1136.8270917696489, -1032.6389226808956, -780.5208619210275, -351.0852479361273, -1024.1027204518753, -1000.2738377871951, -18.957426005686322, -1083.1993787441374, -405.1215516079251, -1122.6456662587793, -355.19438073295726, -666.024364499229, -388.1535156294514, -342.664141741784, -110.01099451204757, -191.0054868360076, -602.0413777237228, -118.99015075923187, -762.5351045306688, -598.2326620955251, -65.42992546806188, -1202.4954372003685, -330.75949417459873, -1156.0322370822041, -884.3465742046577, -249.6065247051609, -905.2964813737702, -1056.5747494693978, -609.1704118227556, -1068.5451800691453, -586.1613266778903, -77.56163149885023, -943.1664102169472, -1147.2324336992258, -871.1709087066641, -468.66151344198795, -1091.744564143411, -842.3429001317975, -73.08678926867576, -967.4585932182343, -42.64183406344509, -996.3787106902805, -858.4815956339452, -232.41427449851207, -818.9753283523353, -1163.82734895394], "episode_lengths": [150, 83, 35, 150, 150, 150, 88, 150, 150, 150, 47, 150, 65, 63, 73, 150, 150, 78, 76, 150, 150, 52, 149, 58, 89, 150, 81, 150, 150, 107, 150, 150, 94, 81, 117, 150, 79, 150, 76, 150, 150, 150, 70, 150, 150, 43, 150, 150, 89, 150, 150, 54, 150, 43, 150, 150, 150, 150, 150, 150, 41, 150, 150, 150, 90, 150, 96, 88, 45, 108, 118, 81, 150, 139, 60, 150, 121, 150, 150, 85, 150, 150, 150, 150, 150, 115, 150, 150, 150, 105, 150, 141, 64, 150, 64, 150, 150, 73, 150, 150], "policy_policy_0_reward": [-532.767524986947, -111.75983866282097, -4.289353575744063, -785.4648733716151, -1165.4190208101681, -624.8191036842484, -367.7568893508409, -360.632950732151, -922.6404646408561, -719.4381361933013, -20.36962084028984, -914.8374720142295, -121.8327211227839, -73.31911977034542, -209.02282198613995, -845.3558693903282, -734.9722407565382, -121.84576061440133, -89.83165832716972, -952.4737907922339, -778.0129548569892, -53.69660889508631, -668.8009764483764, -167.36126505819354, -333.41962995661237, -1364.1232993067622, -142.35688983284027, -1204.320322448722, -1058.133349454934, -432.31916231495785, -1268.4544837782637, -839.0904676527597, -196.06371392549212, -224.03983425022753, -422.7007439418628, -1083.443598920923, -178.53030328330496, -1087.772720622821, -97.25829886672953, -1011.1448543545547, -919.2202947326305, -776.1099166604208, -208.3768521169022, -568.2234925832029, -1188.8532943755304, -12.439626096194706, -727.3593450012062, -939.3915145470821, -165.91542551674232, -1330.5791901317398, -960.6371601266659, -85.76382185659175, -1242.8269062405107, -27.086119233709137, -1136.8270917696489, -1032.6389226808956, -780.5208619210275, -351.0852479361273, -1024.1027204518753, -1000.2738377871951, -18.957426005686322, -1083.1993787441374, -405.1215516079251, -1122.6456662587793, -355.19438073295726, -666.024364499229, -388.1535156294514, -342.664141741784, -110.01099451204757, -191.0054868360076, -602.0413777237228, -118.99015075923187, -762.5351045306688, -598.2326620955251, -65.42992546806188, -1202.4954372003685, -330.75949417459873, -1156.0322370822041, -884.3465742046577, -249.6065247051609, -905.2964813737702, -1056.5747494693978, -609.1704118227556, -1068.5451800691453, -586.1613266778903, -77.56163149885023, -943.1664102169472, -1147.2324336992258, -871.1709087066641, -468.66151344198795, -1091.744564143411, -842.3429001317975, -73.08678926867576, -967.4585932182343, -42.64183406344509, -996.3787106902805, -858.4815956339452, -232.41427449851207, -818.9753283523353, -1163.82734895394]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5549485540972405, "mean_inference_ms": 1.6642881954741944, "mean_action_processing_ms": 0.2739536714544441, "mean_env_wait_ms": 3.39803616414064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012068033218383789, "StateBufferConnector_ms": 0.008110761642456055, "ViewRequirementAgentConnector_ms": 0.19373345375061035}, "num_episodes": 33, "episode_return_max": -4.289353575744063, "episode_return_min": -1364.1232993067622, "episode_return_mean": -622.424637320029, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 333.5560789380309, "num_env_steps_trained_throughput_per_sec": 333.5560789380309, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 11934.439, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11934.369, "sample_time_ms": 1148.343, "learn_time_ms": 10721.672, "learn_throughput": 373.076, "synch_weights_time_ms": 63.551}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "training_iteration": 29, "trial_id": "4b94b_00000", "date": "2024-08-05_11-45-45", "timestamp": 1722838545, "time_this_iter_s": 12.003207206726074, "time_total_s": 349.9159049987793, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1110a3d90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 349.9159049987793, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 18.64705882352941, "ram_util_percent": 29.211764705882352}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 97.23379383186499, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.7705385105994841, "policy_loss": -0.0013081850944824207, "vf_loss": 0.7732204718204836, "vf_explained_var": 0.9944454447676738, "kl": 0.011120790260823318, "entropy": 1.512782712529103, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": -12.439626096194706, "episode_reward_min": -1330.5791901317398, "episode_reward_mean": -655.8481485945721, "episode_len_mean": 124.79, "episode_media": {}, "episodes_timesteps_total": 12479, "policy_reward_min": {"policy_0": -1330.5791901317398}, "policy_reward_max": {"policy_0": -12.439626096194706}, "policy_reward_mean": {"policy_0": -655.8481485945721}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1268.4544837782637, -839.0904676527597, -196.06371392549212, -224.03983425022753, -422.7007439418628, -1083.443598920923, -178.53030328330496, -1087.772720622821, -97.25829886672953, -1011.1448543545547, -919.2202947326305, -776.1099166604208, -208.3768521169022, -568.2234925832029, -1188.8532943755304, -12.439626096194706, -727.3593450012062, -939.3915145470821, -165.91542551674232, -1330.5791901317398, -960.6371601266659, -85.76382185659175, -1242.8269062405107, -27.086119233709137, -1136.8270917696489, -1032.6389226808956, -780.5208619210275, -351.0852479361273, -1024.1027204518753, -1000.2738377871951, -18.957426005686322, -1083.1993787441374, -405.1215516079251, -1122.6456662587793, -355.19438073295726, -666.024364499229, -388.1535156294514, -342.664141741784, -110.01099451204757, -191.0054868360076, -602.0413777237228, -118.99015075923187, -762.5351045306688, -598.2326620955251, -65.42992546806188, -1202.4954372003685, -330.75949417459873, -1156.0322370822041, -884.3465742046577, -249.6065247051609, -905.2964813737702, -1056.5747494693978, -609.1704118227556, -1068.5451800691453, -586.1613266778903, -77.56163149885023, -943.1664102169472, -1147.2324336992258, -871.1709087066641, -468.66151344198795, -1091.744564143411, -842.3429001317975, -73.08678926867576, -967.4585932182343, -42.64183406344509, -996.3787106902805, -858.4815956339452, -232.41427449851207, -818.9753283523353, -1163.82734895394, -622.9779467300928, -786.8016857105875, -864.3707966211658, -599.1137940850716, -783.3527678990553, -1065.6008120987337, -1168.0144758628114, -315.1991844725427, -547.1690683902045, -1262.1287395798608, -902.2469325665913, -1111.8059625450537, -1142.0012634505913, -163.62826803870888, -1287.7574306949825, -375.97008110563763, -203.9747542328216, -26.597501462343054, -109.35934967133728, -981.1976673299857, -372.88409681929215, -846.0863751749041, -148.74358388495887, -99.68508266545048, -799.235549521539, -651.9565609699594, -393.9163845806861, -757.998830230312, -198.7153526000967, -635.254518655595], "episode_lengths": [150, 150, 94, 81, 117, 150, 79, 150, 76, 150, 150, 150, 70, 150, 150, 43, 150, 150, 89, 150, 150, 54, 150, 43, 150, 150, 150, 150, 150, 150, 41, 150, 150, 150, 90, 150, 96, 88, 45, 108, 118, 81, 150, 139, 60, 150, 121, 150, 150, 85, 150, 150, 150, 150, 150, 115, 150, 150, 150, 105, 150, 141, 64, 150, 64, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 137, 150, 150, 150, 150, 83, 150, 150, 67, 55, 62, 150, 150, 150, 58, 76, 150, 150, 93, 150, 65, 150], "policy_policy_0_reward": [-1268.4544837782637, -839.0904676527597, -196.06371392549212, -224.03983425022753, -422.7007439418628, -1083.443598920923, -178.53030328330496, -1087.772720622821, -97.25829886672953, -1011.1448543545547, -919.2202947326305, -776.1099166604208, -208.3768521169022, -568.2234925832029, -1188.8532943755304, -12.439626096194706, -727.3593450012062, -939.3915145470821, -165.91542551674232, -1330.5791901317398, -960.6371601266659, -85.76382185659175, -1242.8269062405107, -27.086119233709137, -1136.8270917696489, -1032.6389226808956, -780.5208619210275, -351.0852479361273, -1024.1027204518753, -1000.2738377871951, -18.957426005686322, -1083.1993787441374, -405.1215516079251, -1122.6456662587793, -355.19438073295726, -666.024364499229, -388.1535156294514, -342.664141741784, -110.01099451204757, -191.0054868360076, -602.0413777237228, -118.99015075923187, -762.5351045306688, -598.2326620955251, -65.42992546806188, -1202.4954372003685, -330.75949417459873, -1156.0322370822041, -884.3465742046577, -249.6065247051609, -905.2964813737702, -1056.5747494693978, -609.1704118227556, -1068.5451800691453, -586.1613266778903, -77.56163149885023, -943.1664102169472, -1147.2324336992258, -871.1709087066641, -468.66151344198795, -1091.744564143411, -842.3429001317975, -73.08678926867576, -967.4585932182343, -42.64183406344509, -996.3787106902805, -858.4815956339452, -232.41427449851207, -818.9753283523353, -1163.82734895394, -622.9779467300928, -786.8016857105875, -864.3707966211658, -599.1137940850716, -783.3527678990553, -1065.6008120987337, -1168.0144758628114, -315.1991844725427, -547.1690683902045, -1262.1287395798608, -902.2469325665913, -1111.8059625450537, -1142.0012634505913, -163.62826803870888, -1287.7574306949825, -375.97008110563763, -203.9747542328216, -26.597501462343054, -109.35934967133728, -981.1976673299857, -372.88409681929215, -846.0863751749041, -148.74358388495887, -99.68508266545048, -799.235549521539, -651.9565609699594, -393.9163845806861, -757.998830230312, -198.7153526000967, -635.254518655595]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5548336539150476, "mean_inference_ms": 1.6648335184879302, "mean_action_processing_ms": 0.2736829184749543, "mean_env_wait_ms": 3.399309564822017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012176036834716797, "StateBufferConnector_ms": 0.008077383041381836, "ViewRequirementAgentConnector_ms": 0.20302319526672363}, "num_episodes": 30, "episode_return_max": -12.439626096194706, "episode_return_min": -1330.5791901317398, "episode_return_mean": -655.8481485945721, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 335.53356279397684, "num_env_steps_trained_throughput_per_sec": 335.53356279397684, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 11846.343, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11846.273, "sample_time_ms": 1157.481, "learn_time_ms": 10625.733, "learn_throughput": 376.445, "synch_weights_time_ms": 62.253}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 30, "trial_id": "4b94b_00000", "date": "2024-08-05_11-45-57", "timestamp": 1722838557, "time_this_iter_s": 11.933679103851318, "time_total_s": 361.8495841026306, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1110a1090>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 361.8495841026306, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 18.48235294117647, "ram_util_percent": 29.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 135.61205510099728, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.7242691191999863, "policy_loss": -0.0012379310826266495, "vf_loss": 0.7269040030427277, "vf_explained_var": 0.9943724808593591, "kl": 0.010685786868816662, "entropy": 1.5305247123042742, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "env_runners": {"episode_reward_max": -20.859246106519112, "episode_reward_min": -1343.537061950642, "episode_reward_mean": -656.2097832221652, "episode_len_mean": 126.32, "episode_media": {}, "episodes_timesteps_total": 12632, "policy_reward_min": {"policy_0": -1343.537061950642}, "policy_reward_max": {"policy_0": -20.859246106519112}, "policy_reward_mean": {"policy_0": -656.2097832221652}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1083.1993787441374, -405.1215516079251, -1122.6456662587793, -355.19438073295726, -666.024364499229, -388.1535156294514, -342.664141741784, -110.01099451204757, -191.0054868360076, -602.0413777237228, -118.99015075923187, -762.5351045306688, -598.2326620955251, -65.42992546806188, -1202.4954372003685, -330.75949417459873, -1156.0322370822041, -884.3465742046577, -249.6065247051609, -905.2964813737702, -1056.5747494693978, -609.1704118227556, -1068.5451800691453, -586.1613266778903, -77.56163149885023, -943.1664102169472, -1147.2324336992258, -871.1709087066641, -468.66151344198795, -1091.744564143411, -842.3429001317975, -73.08678926867576, -967.4585932182343, -42.64183406344509, -996.3787106902805, -858.4815956339452, -232.41427449851207, -818.9753283523353, -1163.82734895394, -622.9779467300928, -786.8016857105875, -864.3707966211658, -599.1137940850716, -783.3527678990553, -1065.6008120987337, -1168.0144758628114, -315.1991844725427, -547.1690683902045, -1262.1287395798608, -902.2469325665913, -1111.8059625450537, -1142.0012634505913, -163.62826803870888, -1287.7574306949825, -375.97008110563763, -203.9747542328216, -26.597501462343054, -109.35934967133728, -981.1976673299857, -372.88409681929215, -846.0863751749041, -148.74358388495887, -99.68508266545048, -799.235549521539, -651.9565609699594, -393.9163845806861, -757.998830230312, -198.7153526000967, -635.254518655595, -228.26248734711123, -1302.8316531216226, -1085.4571788946819, -195.34504233837404, -22.88914826053446, -743.5984306183517, -1181.6601263641937, -65.91822282549909, -535.2742775405237, -1131.5740971600208, -537.3173765900493, -405.2340412974273, -506.966138771816, -1152.9994450578035, -692.9146677634333, -306.21414414890114, -910.1551999328784, -1030.3384517823833, -560.9430918128576, -99.00112278370842, -207.54041051683026, -184.4790304758686, -755.729777139199, -1343.537061950642, -1078.641343092752, -664.8644862160905, -1042.744188157816, -20.859246106519112, -1119.0572742579993, -896.1697080138524, -933.3346797880929], "episode_lengths": [150, 150, 150, 90, 150, 96, 88, 45, 108, 118, 81, 150, 139, 60, 150, 121, 150, 150, 85, 150, 150, 150, 150, 150, 115, 150, 150, 150, 105, 150, 141, 64, 150, 64, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 137, 150, 150, 150, 150, 83, 150, 150, 67, 55, 62, 150, 150, 150, 58, 76, 150, 150, 93, 150, 65, 150, 120, 150, 150, 63, 38, 127, 150, 71, 150, 150, 150, 150, 150, 150, 150, 78, 150, 150, 128, 45, 78, 150, 150, 150, 150, 150, 150, 42, 150, 150, 150], "policy_policy_0_reward": [-1083.1993787441374, -405.1215516079251, -1122.6456662587793, -355.19438073295726, -666.024364499229, -388.1535156294514, -342.664141741784, -110.01099451204757, -191.0054868360076, -602.0413777237228, -118.99015075923187, -762.5351045306688, -598.2326620955251, -65.42992546806188, -1202.4954372003685, -330.75949417459873, -1156.0322370822041, -884.3465742046577, -249.6065247051609, -905.2964813737702, -1056.5747494693978, -609.1704118227556, -1068.5451800691453, -586.1613266778903, -77.56163149885023, -943.1664102169472, -1147.2324336992258, -871.1709087066641, -468.66151344198795, -1091.744564143411, -842.3429001317975, -73.08678926867576, -967.4585932182343, -42.64183406344509, -996.3787106902805, -858.4815956339452, -232.41427449851207, -818.9753283523353, -1163.82734895394, -622.9779467300928, -786.8016857105875, -864.3707966211658, -599.1137940850716, -783.3527678990553, -1065.6008120987337, -1168.0144758628114, -315.1991844725427, -547.1690683902045, -1262.1287395798608, -902.2469325665913, -1111.8059625450537, -1142.0012634505913, -163.62826803870888, -1287.7574306949825, -375.97008110563763, -203.9747542328216, -26.597501462343054, -109.35934967133728, -981.1976673299857, -372.88409681929215, -846.0863751749041, -148.74358388495887, -99.68508266545048, -799.235549521539, -651.9565609699594, -393.9163845806861, -757.998830230312, -198.7153526000967, -635.254518655595, -228.26248734711123, -1302.8316531216226, -1085.4571788946819, -195.34504233837404, -22.88914826053446, -743.5984306183517, -1181.6601263641937, -65.91822282549909, -535.2742775405237, -1131.5740971600208, -537.3173765900493, -405.2340412974273, -506.966138771816, -1152.9994450578035, -692.9146677634333, -306.21414414890114, -910.1551999328784, -1030.3384517823833, -560.9430918128576, -99.00112278370842, -207.54041051683026, -184.4790304758686, -755.729777139199, -1343.537061950642, -1078.641343092752, -664.8644862160905, -1042.744188157816, -20.859246106519112, -1119.0572742579993, -896.1697080138524, -933.3346797880929]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5569619641615504, "mean_inference_ms": 1.68461261878431, "mean_action_processing_ms": 0.2736304571717568, "mean_env_wait_ms": 3.401877313191846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012289285659790039, "StateBufferConnector_ms": 0.008108139038085938, "ViewRequirementAgentConnector_ms": 0.20061898231506348}, "num_episodes": 31, "episode_return_max": -20.859246106519112, "episode_return_min": -1343.537061950642, "episode_return_mean": -656.2097832221652, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.336011317504, "num_env_steps_trained_throughput_per_sec": 303.336011317504, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 11887.918, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11887.849, "sample_time_ms": 1196.595, "learn_time_ms": 10628.393, "learn_throughput": 376.35, "synch_weights_time_ms": 62.059}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "training_iteration": 31, "trial_id": "4b94b_00000", "date": "2024-08-05_11-46-10", "timestamp": 1722838570, "time_this_iter_s": 13.199525833129883, "time_total_s": 375.0491099357605, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1110a1cf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 375.0491099357605, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 20.216666666666665, "ram_util_percent": 29.200000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 107.24609279036522, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.0851663044653832, "policy_loss": -0.0018550993413858426, "vf_loss": 1.0882969781756402, "vf_explained_var": 0.9820657702783744, "kl": 0.00878555147097967, "entropy": 1.3853919287522634, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": -20.859246106519112, "episode_reward_min": -1343.537061950642, "episode_reward_mean": -662.6417947856653, "episode_len_mean": 125.1, "episode_media": {}, "episodes_timesteps_total": 12510, "policy_reward_min": {"policy_0": -1343.537061950642}, "policy_reward_max": {"policy_0": -20.859246106519112}, "policy_reward_mean": {"policy_0": -662.6417947856653}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-996.3787106902805, -858.4815956339452, -232.41427449851207, -818.9753283523353, -1163.82734895394, -622.9779467300928, -786.8016857105875, -864.3707966211658, -599.1137940850716, -783.3527678990553, -1065.6008120987337, -1168.0144758628114, -315.1991844725427, -547.1690683902045, -1262.1287395798608, -902.2469325665913, -1111.8059625450537, -1142.0012634505913, -163.62826803870888, -1287.7574306949825, -375.97008110563763, -203.9747542328216, -26.597501462343054, -109.35934967133728, -981.1976673299857, -372.88409681929215, -846.0863751749041, -148.74358388495887, -99.68508266545048, -799.235549521539, -651.9565609699594, -393.9163845806861, -757.998830230312, -198.7153526000967, -635.254518655595, -228.26248734711123, -1302.8316531216226, -1085.4571788946819, -195.34504233837404, -22.88914826053446, -743.5984306183517, -1181.6601263641937, -65.91822282549909, -535.2742775405237, -1131.5740971600208, -537.3173765900493, -405.2340412974273, -506.966138771816, -1152.9994450578035, -692.9146677634333, -306.21414414890114, -910.1551999328784, -1030.3384517823833, -560.9430918128576, -99.00112278370842, -207.54041051683026, -184.4790304758686, -755.729777139199, -1343.537061950642, -1078.641343092752, -664.8644862160905, -1042.744188157816, -20.859246106519112, -1119.0572742579993, -896.1697080138524, -933.3346797880929, -924.1624635379084, -395.2175049020841, -347.06807619028876, -626.480348660393, -382.41880479731196, -636.2428085290303, -508.6160014770191, -1045.1870063426838, -45.71687081008775, -1201.1037543372224, -221.2568702575813, -124.80989378691442, -179.41440737451325, -389.25134887726995, -720.8753063997838, -1022.2234539621195, -1027.2114076470511, -878.7042844322959, -499.22528703555014, -1027.1555432157397, -844.5790101497075, -344.75151058721525, -682.6101165636853, -883.2393864285035, -705.5065023733098, -641.916265545712, -329.1972814915991, -1027.5512401762744, -1317.7523121571057, -131.2685068350499, -998.6710198062509, -352.0897762313997, -401.30202316078044, -1165.7294585792624], "episode_lengths": [150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 137, 150, 150, 150, 150, 83, 150, 150, 67, 55, 62, 150, 150, 150, 58, 76, 150, 150, 93, 150, 65, 150, 120, 150, 150, 63, 38, 127, 150, 71, 150, 150, 150, 150, 150, 150, 150, 78, 150, 150, 128, 45, 78, 150, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 90, 86, 144, 110, 150, 111, 150, 58, 150, 68, 50, 62, 94, 150, 150, 150, 150, 107, 150, 150, 107, 150, 150, 150, 128, 89, 150, 150, 74, 150, 82, 88, 150], "policy_policy_0_reward": [-996.3787106902805, -858.4815956339452, -232.41427449851207, -818.9753283523353, -1163.82734895394, -622.9779467300928, -786.8016857105875, -864.3707966211658, -599.1137940850716, -783.3527678990553, -1065.6008120987337, -1168.0144758628114, -315.1991844725427, -547.1690683902045, -1262.1287395798608, -902.2469325665913, -1111.8059625450537, -1142.0012634505913, -163.62826803870888, -1287.7574306949825, -375.97008110563763, -203.9747542328216, -26.597501462343054, -109.35934967133728, -981.1976673299857, -372.88409681929215, -846.0863751749041, -148.74358388495887, -99.68508266545048, -799.235549521539, -651.9565609699594, -393.9163845806861, -757.998830230312, -198.7153526000967, -635.254518655595, -228.26248734711123, -1302.8316531216226, -1085.4571788946819, -195.34504233837404, -22.88914826053446, -743.5984306183517, -1181.6601263641937, -65.91822282549909, -535.2742775405237, -1131.5740971600208, -537.3173765900493, -405.2340412974273, -506.966138771816, -1152.9994450578035, -692.9146677634333, -306.21414414890114, -910.1551999328784, -1030.3384517823833, -560.9430918128576, -99.00112278370842, -207.54041051683026, -184.4790304758686, -755.729777139199, -1343.537061950642, -1078.641343092752, -664.8644862160905, -1042.744188157816, -20.859246106519112, -1119.0572742579993, -896.1697080138524, -933.3346797880929, -924.1624635379084, -395.2175049020841, -347.06807619028876, -626.480348660393, -382.41880479731196, -636.2428085290303, -508.6160014770191, -1045.1870063426838, -45.71687081008775, -1201.1037543372224, -221.2568702575813, -124.80989378691442, -179.41440737451325, -389.25134887726995, -720.8753063997838, -1022.2234539621195, -1027.2114076470511, -878.7042844322959, -499.22528703555014, -1027.1555432157397, -844.5790101497075, -344.75151058721525, -682.6101165636853, -883.2393864285035, -705.5065023733098, -641.916265545712, -329.1972814915991, -1027.5512401762744, -1317.7523121571057, -131.2685068350499, -998.6710198062509, -352.0897762313997, -401.30202316078044, -1165.7294585792624]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.55960553378395, "mean_inference_ms": 1.702627283188209, "mean_action_processing_ms": 0.2734179799302901, "mean_env_wait_ms": 3.402992307014742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012060880661010742, "StateBufferConnector_ms": 0.008083105087280273, "ViewRequirementAgentConnector_ms": 0.19935011863708496}, "num_episodes": 34, "episode_return_max": -20.859246106519112, "episode_return_min": -1343.537061950642, "episode_return_mean": -662.6417947856653, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.02375121666216, "num_env_steps_trained_throughput_per_sec": 312.02375121666216, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 11890.294, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11890.22, "sample_time_ms": 1210.258, "learn_time_ms": 10615.896, "learn_throughput": 376.793, "synch_weights_time_ms": 63.266}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 32, "trial_id": "4b94b_00000", "date": "2024-08-05_11-46-23", "timestamp": 1722838583, "time_this_iter_s": 12.83371090888977, "time_total_s": 387.88282084465027, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1113d3b50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 387.88282084465027, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 17.93157894736842, "ram_util_percent": 29.22105263157895}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 114.11588887174925, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.124314619631817, "policy_loss": -0.0009790599040570668, "vf_loss": 1.1265690154085557, "vf_explained_var": 0.9903671459605297, "kl": 0.012325397562532696, "entropy": 1.4294019363820554, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "env_runners": {"episode_reward_max": -20.859246106519112, "episode_reward_min": -1434.0001017361699, "episode_reward_mean": -622.9937437308114, "episode_len_mean": 122.68, "episode_media": {}, "episodes_timesteps_total": 12268, "policy_reward_min": {"policy_0": -1434.0001017361699}, "policy_reward_max": {"policy_0": -20.859246106519112}, "policy_reward_mean": {"policy_0": -622.9937437308114}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-635.254518655595, -228.26248734711123, -1302.8316531216226, -1085.4571788946819, -195.34504233837404, -22.88914826053446, -743.5984306183517, -1181.6601263641937, -65.91822282549909, -535.2742775405237, -1131.5740971600208, -537.3173765900493, -405.2340412974273, -506.966138771816, -1152.9994450578035, -692.9146677634333, -306.21414414890114, -910.1551999328784, -1030.3384517823833, -560.9430918128576, -99.00112278370842, -207.54041051683026, -184.4790304758686, -755.729777139199, -1343.537061950642, -1078.641343092752, -664.8644862160905, -1042.744188157816, -20.859246106519112, -1119.0572742579993, -896.1697080138524, -933.3346797880929, -924.1624635379084, -395.2175049020841, -347.06807619028876, -626.480348660393, -382.41880479731196, -636.2428085290303, -508.6160014770191, -1045.1870063426838, -45.71687081008775, -1201.1037543372224, -221.2568702575813, -124.80989378691442, -179.41440737451325, -389.25134887726995, -720.8753063997838, -1022.2234539621195, -1027.2114076470511, -878.7042844322959, -499.22528703555014, -1027.1555432157397, -844.5790101497075, -344.75151058721525, -682.6101165636853, -883.2393864285035, -705.5065023733098, -641.916265545712, -329.1972814915991, -1027.5512401762744, -1317.7523121571057, -131.2685068350499, -998.6710198062509, -352.0897762313997, -401.30202316078044, -1165.7294585792624, -1434.0001017361699, -187.72193527150995, -810.6281851339909, -947.6276607848066, -584.8599593883356, -111.44172223681548, -135.94299508748625, -934.056689053503, -1185.187311778495, -197.45112059053312, -815.576115214909, -26.76072763451006, -396.45464415380576, -645.1853999356406, -267.12604241470393, -1164.5638974983583, -677.7339697855131, -751.7456927139001, -617.1491972117856, -76.01563916748394, -1109.231805866027, -230.66581235260165, -530.771381562287, -272.5573183840092, -464.86688872759726, -151.82271366005142, -443.5907216177766, -774.1630882881038, -926.9219047967338, -191.14219112249782, -44.053804655163646, -361.3081101304678, -503.3161450972632, -722.121558586172], "episode_lengths": [150, 120, 150, 150, 63, 38, 127, 150, 71, 150, 150, 150, 150, 150, 150, 150, 78, 150, 150, 128, 45, 78, 150, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 90, 86, 144, 110, 150, 111, 150, 58, 150, 68, 50, 62, 94, 150, 150, 150, 150, 107, 150, 150, 107, 150, 150, 150, 128, 89, 150, 150, 74, 150, 82, 88, 150, 150, 117, 150, 150, 128, 72, 53, 150, 150, 62, 150, 45, 150, 150, 117, 150, 150, 150, 124, 63, 150, 65, 127, 104, 132, 62, 104, 150, 150, 92, 63, 150, 150, 150], "policy_policy_0_reward": [-635.254518655595, -228.26248734711123, -1302.8316531216226, -1085.4571788946819, -195.34504233837404, -22.88914826053446, -743.5984306183517, -1181.6601263641937, -65.91822282549909, -535.2742775405237, -1131.5740971600208, -537.3173765900493, -405.2340412974273, -506.966138771816, -1152.9994450578035, -692.9146677634333, -306.21414414890114, -910.1551999328784, -1030.3384517823833, -560.9430918128576, -99.00112278370842, -207.54041051683026, -184.4790304758686, -755.729777139199, -1343.537061950642, -1078.641343092752, -664.8644862160905, -1042.744188157816, -20.859246106519112, -1119.0572742579993, -896.1697080138524, -933.3346797880929, -924.1624635379084, -395.2175049020841, -347.06807619028876, -626.480348660393, -382.41880479731196, -636.2428085290303, -508.6160014770191, -1045.1870063426838, -45.71687081008775, -1201.1037543372224, -221.2568702575813, -124.80989378691442, -179.41440737451325, -389.25134887726995, -720.8753063997838, -1022.2234539621195, -1027.2114076470511, -878.7042844322959, -499.22528703555014, -1027.1555432157397, -844.5790101497075, -344.75151058721525, -682.6101165636853, -883.2393864285035, -705.5065023733098, -641.916265545712, -329.1972814915991, -1027.5512401762744, -1317.7523121571057, -131.2685068350499, -998.6710198062509, -352.0897762313997, -401.30202316078044, -1165.7294585792624, -1434.0001017361699, -187.72193527150995, -810.6281851339909, -947.6276607848066, -584.8599593883356, -111.44172223681548, -135.94299508748625, -934.056689053503, -1185.187311778495, -197.45112059053312, -815.576115214909, -26.76072763451006, -396.45464415380576, -645.1853999356406, -267.12604241470393, -1164.5638974983583, -677.7339697855131, -751.7456927139001, -617.1491972117856, -76.01563916748394, -1109.231805866027, -230.66581235260165, -530.771381562287, -272.5573183840092, -464.86688872759726, -151.82271366005142, -443.5907216177766, -774.1630882881038, -926.9219047967338, -191.14219112249782, -44.053804655163646, -361.3081101304678, -503.3161450972632, -722.121558586172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5613817954336454, "mean_inference_ms": 1.72144013058577, "mean_action_processing_ms": 0.27373922420941865, "mean_env_wait_ms": 3.4022738442200136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012129545211791992, "StateBufferConnector_ms": 0.008041620254516602, "ViewRequirementAgentConnector_ms": 0.18902969360351562}, "num_episodes": 34, "episode_return_max": -20.859246106519112, "episode_return_min": -1434.0001017361699, "episode_return_mean": -622.9937437308114, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.3577285172057, "num_env_steps_trained_throughput_per_sec": 326.3577285172057, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 12184.214, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12184.139, "sample_time_ms": 1218.078, "learn_time_ms": 10902.907, "learn_throughput": 366.875, "synch_weights_time_ms": 62.352}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "training_iteration": 33, "trial_id": "4b94b_00000", "date": "2024-08-05_11-46-35", "timestamp": 1722838595, "time_this_iter_s": 12.269575595855713, "time_total_s": 400.152396440506, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e11156aa70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 400.152396440506, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 20.647058823529413, "ram_util_percent": 29.25294117647059}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 101.0635557681322, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.956907507777214, "policy_loss": -0.00450520332136269, "vf_loss": 0.9627843057426314, "vf_explained_var": 0.9963063192243378, "kl": 0.008742393369114643, "entropy": 1.4808763620754084, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "env_runners": {"episode_reward_max": -4.207592668439881, "episode_reward_min": -1468.4693766503756, "episode_reward_mean": -608.9660941922762, "episode_len_mean": 120.71, "episode_media": {}, "episodes_timesteps_total": 12071, "policy_reward_min": {"policy_0": -1468.4693766503756}, "policy_reward_max": {"policy_0": -4.207592668439881}, "policy_reward_mean": {"policy_0": -608.9660941922762}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-924.1624635379084, -395.2175049020841, -347.06807619028876, -626.480348660393, -382.41880479731196, -636.2428085290303, -508.6160014770191, -1045.1870063426838, -45.71687081008775, -1201.1037543372224, -221.2568702575813, -124.80989378691442, -179.41440737451325, -389.25134887726995, -720.8753063997838, -1022.2234539621195, -1027.2114076470511, -878.7042844322959, -499.22528703555014, -1027.1555432157397, -844.5790101497075, -344.75151058721525, -682.6101165636853, -883.2393864285035, -705.5065023733098, -641.916265545712, -329.1972814915991, -1027.5512401762744, -1317.7523121571057, -131.2685068350499, -998.6710198062509, -352.0897762313997, -401.30202316078044, -1165.7294585792624, -1434.0001017361699, -187.72193527150995, -810.6281851339909, -947.6276607848066, -584.8599593883356, -111.44172223681548, -135.94299508748625, -934.056689053503, -1185.187311778495, -197.45112059053312, -815.576115214909, -26.76072763451006, -396.45464415380576, -645.1853999356406, -267.12604241470393, -1164.5638974983583, -677.7339697855131, -751.7456927139001, -617.1491972117856, -76.01563916748394, -1109.231805866027, -230.66581235260165, -530.771381562287, -272.5573183840092, -464.86688872759726, -151.82271366005142, -443.5907216177766, -774.1630882881038, -926.9219047967338, -191.14219112249782, -44.053804655163646, -361.3081101304678, -503.3161450972632, -722.121558586172, -1152.4712600354692, -1215.034181551628, -1020.6145063633653, -1071.5493040098247, -1468.4693766503756, -1204.5896727793468, -1338.3571747463639, -509.1291736997397, -27.18904458820701, -297.4414476292876, -373.46675920930426, -745.6233950270221, -218.5043913684005, -218.0303923982537, -306.7332951531924, -1020.0171587299398, -4.207592668439881, -657.9938960281421, -36.57597883084452, -1433.2190596826533, -254.89133288605396, -814.7812384387656, -117.34525083985612, -245.02663328634705, -182.65499178819027, -361.8116976726568, -383.31240890187155, -1096.4196547053343, -408.08346790985354, -874.435680440583, -365.13337907479547, -751.228317835789], "episode_lengths": [150, 90, 86, 144, 110, 150, 111, 150, 58, 150, 68, 50, 62, 94, 150, 150, 150, 150, 107, 150, 150, 107, 150, 150, 150, 128, 89, 150, 150, 74, 150, 82, 88, 150, 150, 117, 150, 150, 128, 72, 53, 150, 150, 62, 150, 45, 150, 150, 117, 150, 150, 150, 124, 63, 150, 65, 127, 104, 132, 62, 104, 150, 150, 92, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 119, 47, 116, 88, 150, 74, 148, 84, 150, 32, 150, 45, 150, 92, 150, 68, 117, 59, 129, 138, 150, 144, 150, 143, 150], "policy_policy_0_reward": [-924.1624635379084, -395.2175049020841, -347.06807619028876, -626.480348660393, -382.41880479731196, -636.2428085290303, -508.6160014770191, -1045.1870063426838, -45.71687081008775, -1201.1037543372224, -221.2568702575813, -124.80989378691442, -179.41440737451325, -389.25134887726995, -720.8753063997838, -1022.2234539621195, -1027.2114076470511, -878.7042844322959, -499.22528703555014, -1027.1555432157397, -844.5790101497075, -344.75151058721525, -682.6101165636853, -883.2393864285035, -705.5065023733098, -641.916265545712, -329.1972814915991, -1027.5512401762744, -1317.7523121571057, -131.2685068350499, -998.6710198062509, -352.0897762313997, -401.30202316078044, -1165.7294585792624, -1434.0001017361699, -187.72193527150995, -810.6281851339909, -947.6276607848066, -584.8599593883356, -111.44172223681548, -135.94299508748625, -934.056689053503, -1185.187311778495, -197.45112059053312, -815.576115214909, -26.76072763451006, -396.45464415380576, -645.1853999356406, -267.12604241470393, -1164.5638974983583, -677.7339697855131, -751.7456927139001, -617.1491972117856, -76.01563916748394, -1109.231805866027, -230.66581235260165, -530.771381562287, -272.5573183840092, -464.86688872759726, -151.82271366005142, -443.5907216177766, -774.1630882881038, -926.9219047967338, -191.14219112249782, -44.053804655163646, -361.3081101304678, -503.3161450972632, -722.121558586172, -1152.4712600354692, -1215.034181551628, -1020.6145063633653, -1071.5493040098247, -1468.4693766503756, -1204.5896727793468, -1338.3571747463639, -509.1291736997397, -27.18904458820701, -297.4414476292876, -373.46675920930426, -745.6233950270221, -218.5043913684005, -218.0303923982537, -306.7332951531924, -1020.0171587299398, -4.207592668439881, -657.9938960281421, -36.57597883084452, -1433.2190596826533, -254.89133288605396, -814.7812384387656, -117.34525083985612, -245.02663328634705, -182.65499178819027, -361.8116976726568, -383.31240890187155, -1096.4196547053343, -408.08346790985354, -874.435680440583, -365.13337907479547, -751.228317835789]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5611869195360267, "mean_inference_ms": 1.7200116233351381, "mean_action_processing_ms": 0.2736545565871958, "mean_env_wait_ms": 3.401029425707913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011916637420654297, "StateBufferConnector_ms": 0.007903337478637695, "ViewRequirementAgentConnector_ms": 0.18828201293945312}, "num_episodes": 32, "episode_return_max": -4.207592668439881, "episode_return_min": -1468.4693766503756, "episode_return_mean": -608.9660941922762, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.507337756161, "num_env_steps_trained_throughput_per_sec": 317.507337756161, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 12259.196, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12259.122, "sample_time_ms": 1211.248, "learn_time_ms": 10984.153, "learn_throughput": 364.161, "synch_weights_time_ms": 62.928}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "training_iteration": 34, "trial_id": "4b94b_00000", "date": "2024-08-05_11-46-48", "timestamp": 1722838608, "time_this_iter_s": 12.610778093338013, "time_total_s": 412.763174533844, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1110a1cf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 412.763174533844, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 18.09444444444445, "ram_util_percent": 29.200000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 110.75227513809999, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9968095100174348, "policy_loss": -0.007004837586039988, "vf_loss": 1.0051695939774314, "vf_explained_var": 0.983401613496244, "kl": 0.008277982256762108, "entropy": 1.4587192416191102, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "env_runners": {"episode_reward_max": -4.207592668439881, "episode_reward_min": -1468.4693766503756, "episode_reward_mean": -547.8362724628463, "episode_len_mean": 118.57, "episode_media": {}, "episodes_timesteps_total": 11857, "policy_reward_min": {"policy_0": -1468.4693766503756}, "policy_reward_max": {"policy_0": -4.207592668439881}, "policy_reward_mean": {"policy_0": -547.8362724628463}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-810.6281851339909, -947.6276607848066, -584.8599593883356, -111.44172223681548, -135.94299508748625, -934.056689053503, -1185.187311778495, -197.45112059053312, -815.576115214909, -26.76072763451006, -396.45464415380576, -645.1853999356406, -267.12604241470393, -1164.5638974983583, -677.7339697855131, -751.7456927139001, -617.1491972117856, -76.01563916748394, -1109.231805866027, -230.66581235260165, -530.771381562287, -272.5573183840092, -464.86688872759726, -151.82271366005142, -443.5907216177766, -774.1630882881038, -926.9219047967338, -191.14219112249782, -44.053804655163646, -361.3081101304678, -503.3161450972632, -722.121558586172, -1152.4712600354692, -1215.034181551628, -1020.6145063633653, -1071.5493040098247, -1468.4693766503756, -1204.5896727793468, -1338.3571747463639, -509.1291736997397, -27.18904458820701, -297.4414476292876, -373.46675920930426, -745.6233950270221, -218.5043913684005, -218.0303923982537, -306.7332951531924, -1020.0171587299398, -4.207592668439881, -657.9938960281421, -36.57597883084452, -1433.2190596826533, -254.89133288605396, -814.7812384387656, -117.34525083985612, -245.02663328634705, -182.65499178819027, -361.8116976726568, -383.31240890187155, -1096.4196547053343, -408.08346790985354, -874.435680440583, -365.13337907479547, -751.228317835789, -149.28597136041336, -33.40464458746264, -465.4097022736693, -708.6619530024288, -605.7150228680377, -333.2606297701574, -360.06833838101846, -988.5619038235853, -980.6419384664836, -36.749991608021816, -143.15421516657236, -466.3273831200943, -67.06188841274859, -215.7171409712008, -262.0187219344119, -274.2521263220236, -273.9489772113415, -307.6175181152802, -364.1244853185255, -302.38271987233486, -1098.217914298494, -264.6105056360183, -959.0419945488579, -630.1837844226561, -521.1182192600211, -263.05794108148507, -342.4275465543829, -1016.5403052251121, -206.45278193966666, -1235.4534649388847, -243.01264250537537, -389.4574129185302, -560.6478511441065, -766.6897391231867, -903.7191720033472, -798.2491685374633], "episode_lengths": [150, 150, 128, 72, 53, 150, 150, 62, 150, 45, 150, 150, 117, 150, 150, 150, 124, 63, 150, 65, 127, 104, 132, 62, 104, 150, 150, 92, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 119, 47, 116, 88, 150, 74, 148, 84, 150, 32, 150, 45, 150, 92, 150, 68, 117, 59, 129, 138, 150, 144, 150, 143, 150, 54, 54, 100, 132, 150, 122, 84, 150, 150, 51, 61, 150, 63, 99, 99, 88, 77, 80, 88, 150, 150, 99, 150, 150, 114, 103, 93, 150, 90, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-810.6281851339909, -947.6276607848066, -584.8599593883356, -111.44172223681548, -135.94299508748625, -934.056689053503, -1185.187311778495, -197.45112059053312, -815.576115214909, -26.76072763451006, -396.45464415380576, -645.1853999356406, -267.12604241470393, -1164.5638974983583, -677.7339697855131, -751.7456927139001, -617.1491972117856, -76.01563916748394, -1109.231805866027, -230.66581235260165, -530.771381562287, -272.5573183840092, -464.86688872759726, -151.82271366005142, -443.5907216177766, -774.1630882881038, -926.9219047967338, -191.14219112249782, -44.053804655163646, -361.3081101304678, -503.3161450972632, -722.121558586172, -1152.4712600354692, -1215.034181551628, -1020.6145063633653, -1071.5493040098247, -1468.4693766503756, -1204.5896727793468, -1338.3571747463639, -509.1291736997397, -27.18904458820701, -297.4414476292876, -373.46675920930426, -745.6233950270221, -218.5043913684005, -218.0303923982537, -306.7332951531924, -1020.0171587299398, -4.207592668439881, -657.9938960281421, -36.57597883084452, -1433.2190596826533, -254.89133288605396, -814.7812384387656, -117.34525083985612, -245.02663328634705, -182.65499178819027, -361.8116976726568, -383.31240890187155, -1096.4196547053343, -408.08346790985354, -874.435680440583, -365.13337907479547, -751.228317835789, -149.28597136041336, -33.40464458746264, -465.4097022736693, -708.6619530024288, -605.7150228680377, -333.2606297701574, -360.06833838101846, -988.5619038235853, -980.6419384664836, -36.749991608021816, -143.15421516657236, -466.3273831200943, -67.06188841274859, -215.7171409712008, -262.0187219344119, -274.2521263220236, -273.9489772113415, -307.6175181152802, -364.1244853185255, -302.38271987233486, -1098.217914298494, -264.6105056360183, -959.0419945488579, -630.1837844226561, -521.1182192600211, -263.05794108148507, -342.4275465543829, -1016.5403052251121, -206.45278193966666, -1235.4534649388847, -243.01264250537537, -389.4574129185302, -560.6478511441065, -766.6897391231867, -903.7191720033472, -798.2491685374633]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.559713248401321, "mean_inference_ms": 1.719733339611884, "mean_action_processing_ms": 0.273823466034091, "mean_env_wait_ms": 3.404404450864513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012089252471923828, "StateBufferConnector_ms": 0.007999181747436523, "ViewRequirementAgentConnector_ms": 0.19017839431762695}, "num_episodes": 36, "episode_return_max": -4.207592668439881, "episode_return_min": -1468.4693766503756, "episode_return_mean": -547.8362724628463, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.31745445404806, "num_env_steps_trained_throughput_per_sec": 313.31745445404806, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 12259.081, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12259.006, "sample_time_ms": 1205.823, "learn_time_ms": 10988.855, "learn_throughput": 364.005, "synch_weights_time_ms": 63.525}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "training_iteration": 35, "trial_id": "4b94b_00000", "date": "2024-08-05_11-47-01", "timestamp": 1722838621, "time_this_iter_s": 12.778515100479126, "time_total_s": 425.5416896343231, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e111568b80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 425.5416896343231, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 17.944444444444443, "ram_util_percent": 29.205555555555552}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 123.66181209484736, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.8161598088685423, "policy_loss": -0.0021485985305237892, "vf_loss": 0.8196831398333112, "vf_explained_var": 0.9982974310715993, "kl": 0.010950573966313944, "entropy": 1.5116150143245857, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": -4.207592668439881, "episode_reward_min": -1526.700551529837, "episode_reward_mean": -595.7532922385122, "episode_len_mean": 119.13, "episode_media": {}, "episodes_timesteps_total": 11913, "policy_reward_min": {"policy_0": -1526.700551529837}, "policy_reward_max": {"policy_0": -4.207592668439881}, "policy_reward_mean": {"policy_0": -595.7532922385122}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1215.034181551628, -1020.6145063633653, -1071.5493040098247, -1468.4693766503756, -1204.5896727793468, -1338.3571747463639, -509.1291736997397, -27.18904458820701, -297.4414476292876, -373.46675920930426, -745.6233950270221, -218.5043913684005, -218.0303923982537, -306.7332951531924, -1020.0171587299398, -4.207592668439881, -657.9938960281421, -36.57597883084452, -1433.2190596826533, -254.89133288605396, -814.7812384387656, -117.34525083985612, -245.02663328634705, -182.65499178819027, -361.8116976726568, -383.31240890187155, -1096.4196547053343, -408.08346790985354, -874.435680440583, -365.13337907479547, -751.228317835789, -149.28597136041336, -33.40464458746264, -465.4097022736693, -708.6619530024288, -605.7150228680377, -333.2606297701574, -360.06833838101846, -988.5619038235853, -980.6419384664836, -36.749991608021816, -143.15421516657236, -466.3273831200943, -67.06188841274859, -215.7171409712008, -262.0187219344119, -274.2521263220236, -273.9489772113415, -307.6175181152802, -364.1244853185255, -302.38271987233486, -1098.217914298494, -264.6105056360183, -959.0419945488579, -630.1837844226561, -521.1182192600211, -263.05794108148507, -342.4275465543829, -1016.5403052251121, -206.45278193966666, -1235.4534649388847, -243.01264250537537, -389.4574129185302, -560.6478511441065, -766.6897391231867, -903.7191720033472, -798.2491685374633, -382.2640460891314, -206.77320913684358, -1329.1792381098173, -61.68215331004377, -822.5600502728176, -894.7169464971016, -162.033145715879, -484.58573585514483, -1063.151007784806, -157.88903692504437, -1025.4528707790475, -293.8018413743356, -1526.700551529837, -1099.0465129215522, -39.47702266701205, -1275.0961999288832, -611.5321554035531, -19.0668615727078, -893.0990928455121, -1101.1223972020202, -861.6709562214878, -222.6613468509731, -1019.9193230792919, -162.61573734823793, -1216.210403623803, -1005.9182006593009, -970.4126616394582, -1134.333565903287, -22.627157161476493, -245.0703480261499, -944.2912898902777, -945.7634853967867, -815.489100511776], "episode_lengths": [150, 150, 150, 150, 150, 150, 119, 47, 116, 88, 150, 74, 148, 84, 150, 32, 150, 45, 150, 92, 150, 68, 117, 59, 129, 138, 150, 144, 150, 143, 150, 54, 54, 100, 132, 150, 122, 84, 150, 150, 51, 61, 150, 63, 99, 99, 88, 77, 80, 88, 150, 150, 99, 150, 150, 114, 103, 93, 150, 90, 150, 150, 150, 150, 150, 150, 150, 92, 105, 150, 65, 150, 150, 56, 150, 150, 67, 150, 78, 150, 150, 45, 150, 150, 39, 150, 150, 150, 111, 150, 67, 150, 150, 150, 150, 43, 101, 150, 150, 150], "policy_policy_0_reward": [-1215.034181551628, -1020.6145063633653, -1071.5493040098247, -1468.4693766503756, -1204.5896727793468, -1338.3571747463639, -509.1291736997397, -27.18904458820701, -297.4414476292876, -373.46675920930426, -745.6233950270221, -218.5043913684005, -218.0303923982537, -306.7332951531924, -1020.0171587299398, -4.207592668439881, -657.9938960281421, -36.57597883084452, -1433.2190596826533, -254.89133288605396, -814.7812384387656, -117.34525083985612, -245.02663328634705, -182.65499178819027, -361.8116976726568, -383.31240890187155, -1096.4196547053343, -408.08346790985354, -874.435680440583, -365.13337907479547, -751.228317835789, -149.28597136041336, -33.40464458746264, -465.4097022736693, -708.6619530024288, -605.7150228680377, -333.2606297701574, -360.06833838101846, -988.5619038235853, -980.6419384664836, -36.749991608021816, -143.15421516657236, -466.3273831200943, -67.06188841274859, -215.7171409712008, -262.0187219344119, -274.2521263220236, -273.9489772113415, -307.6175181152802, -364.1244853185255, -302.38271987233486, -1098.217914298494, -264.6105056360183, -959.0419945488579, -630.1837844226561, -521.1182192600211, -263.05794108148507, -342.4275465543829, -1016.5403052251121, -206.45278193966666, -1235.4534649388847, -243.01264250537537, -389.4574129185302, -560.6478511441065, -766.6897391231867, -903.7191720033472, -798.2491685374633, -382.2640460891314, -206.77320913684358, -1329.1792381098173, -61.68215331004377, -822.5600502728176, -894.7169464971016, -162.033145715879, -484.58573585514483, -1063.151007784806, -157.88903692504437, -1025.4528707790475, -293.8018413743356, -1526.700551529837, -1099.0465129215522, -39.47702266701205, -1275.0961999288832, -611.5321554035531, -19.0668615727078, -893.0990928455121, -1101.1223972020202, -861.6709562214878, -222.6613468509731, -1019.9193230792919, -162.61573734823793, -1216.210403623803, -1005.9182006593009, -970.4126616394582, -1134.333565903287, -22.627157161476493, -245.0703480261499, -944.2912898902777, -945.7634853967867, -815.489100511776]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5596714427189416, "mean_inference_ms": 1.718315772707678, "mean_action_processing_ms": 0.2734084662707517, "mean_env_wait_ms": 3.4052937893349804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011907577514648438, "StateBufferConnector_ms": 0.007899999618530273, "ViewRequirementAgentConnector_ms": 0.19006037712097168}, "num_episodes": 33, "episode_return_max": -4.207592668439881, "episode_return_min": -1526.700551529837, "episode_return_mean": -595.7532922385122, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 354.8228458134711, "num_env_steps_trained_throughput_per_sec": 354.8228458134711, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 12254.429, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12254.353, "sample_time_ms": 1205.55, "learn_time_ms": 10983.877, "learn_throughput": 364.17, "synch_weights_time_ms": 64.124}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 36, "trial_id": "4b94b_00000", "date": "2024-08-05_11-47-12", "timestamp": 1722838632, "time_this_iter_s": 11.286376476287842, "time_total_s": 436.82806611061096, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1110a3e20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 436.82806611061096, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 18.91875, "ram_util_percent": 29.2125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 96.61684648096562, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9997040741145611, "policy_loss": -0.00303026744707798, "vf_loss": 1.0040557531950374, "vf_explained_var": 0.9904898531114061, "kl": 0.010404763146349675, "entropy": 1.451469201222062, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "env_runners": {"episode_reward_max": -4.251215111753544, "episode_reward_min": -1526.700551529837, "episode_reward_mean": -551.1522562386084, "episode_len_mean": 114.64, "episode_media": {}, "episodes_timesteps_total": 11464, "policy_reward_min": {"policy_0": -1526.700551529837}, "policy_reward_max": {"policy_0": -4.251215111753544}, "policy_reward_mean": {"policy_0": -551.1522562386084}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-36.749991608021816, -143.15421516657236, -466.3273831200943, -67.06188841274859, -215.7171409712008, -262.0187219344119, -274.2521263220236, -273.9489772113415, -307.6175181152802, -364.1244853185255, -302.38271987233486, -1098.217914298494, -264.6105056360183, -959.0419945488579, -630.1837844226561, -521.1182192600211, -263.05794108148507, -342.4275465543829, -1016.5403052251121, -206.45278193966666, -1235.4534649388847, -243.01264250537537, -389.4574129185302, -560.6478511441065, -766.6897391231867, -903.7191720033472, -798.2491685374633, -382.2640460891314, -206.77320913684358, -1329.1792381098173, -61.68215331004377, -822.5600502728176, -894.7169464971016, -162.033145715879, -484.58573585514483, -1063.151007784806, -157.88903692504437, -1025.4528707790475, -293.8018413743356, -1526.700551529837, -1099.0465129215522, -39.47702266701205, -1275.0961999288832, -611.5321554035531, -19.0668615727078, -893.0990928455121, -1101.1223972020202, -861.6709562214878, -222.6613468509731, -1019.9193230792919, -162.61573734823793, -1216.210403623803, -1005.9182006593009, -970.4126616394582, -1134.333565903287, -22.627157161476493, -245.0703480261499, -944.2912898902777, -945.7634853967867, -815.489100511776, -363.3910942538985, -258.5375786816185, -789.9518186670549, -789.1914800341665, -986.7189900268025, -180.89646709998104, -4.251215111753544, -989.789402645989, -178.35979851152143, -545.2237885674548, -494.4475678414989, -937.3736709052037, -329.1162844809922, -654.1744981758048, -216.7754276057737, -211.47439447055086, -73.79491914777489, -61.88970226920064, -52.32014344547007, -431.55610157998007, -776.0230277677208, -1204.6119641904477, -982.6916458685873, -235.33389465435275, -267.7536993383707, -938.9836284826366, -532.5852183577354, -74.56715717976, -36.61450140835321, -359.58676336861606, -1394.0542890041168, -144.95176812379285, -939.1625532049994, -148.93115771071945, -214.4306907536909, -69.83838000048712, -214.3669797357279, -1035.7159612896094, -432.78042356699893, -634.5583119080925], "episode_lengths": [51, 61, 150, 63, 99, 99, 88, 77, 80, 88, 150, 150, 99, 150, 150, 114, 103, 93, 150, 90, 150, 150, 150, 150, 150, 150, 150, 92, 105, 150, 65, 150, 150, 56, 150, 150, 67, 150, 78, 150, 150, 45, 150, 150, 39, 150, 150, 150, 111, 150, 67, 150, 150, 150, 150, 43, 101, 150, 150, 150, 109, 92, 150, 150, 150, 82, 35, 150, 95, 150, 150, 150, 82, 133, 65, 98, 48, 51, 53, 146, 150, 150, 150, 79, 77, 150, 150, 50, 50, 94, 150, 58, 150, 54, 95, 66, 73, 150, 105, 150], "policy_policy_0_reward": [-36.749991608021816, -143.15421516657236, -466.3273831200943, -67.06188841274859, -215.7171409712008, -262.0187219344119, -274.2521263220236, -273.9489772113415, -307.6175181152802, -364.1244853185255, -302.38271987233486, -1098.217914298494, -264.6105056360183, -959.0419945488579, -630.1837844226561, -521.1182192600211, -263.05794108148507, -342.4275465543829, -1016.5403052251121, -206.45278193966666, -1235.4534649388847, -243.01264250537537, -389.4574129185302, -560.6478511441065, -766.6897391231867, -903.7191720033472, -798.2491685374633, -382.2640460891314, -206.77320913684358, -1329.1792381098173, -61.68215331004377, -822.5600502728176, -894.7169464971016, -162.033145715879, -484.58573585514483, -1063.151007784806, -157.88903692504437, -1025.4528707790475, -293.8018413743356, -1526.700551529837, -1099.0465129215522, -39.47702266701205, -1275.0961999288832, -611.5321554035531, -19.0668615727078, -893.0990928455121, -1101.1223972020202, -861.6709562214878, -222.6613468509731, -1019.9193230792919, -162.61573734823793, -1216.210403623803, -1005.9182006593009, -970.4126616394582, -1134.333565903287, -22.627157161476493, -245.0703480261499, -944.2912898902777, -945.7634853967867, -815.489100511776, -363.3910942538985, -258.5375786816185, -789.9518186670549, -789.1914800341665, -986.7189900268025, -180.89646709998104, -4.251215111753544, -989.789402645989, -178.35979851152143, -545.2237885674548, -494.4475678414989, -937.3736709052037, -329.1162844809922, -654.1744981758048, -216.7754276057737, -211.47439447055086, -73.79491914777489, -61.88970226920064, -52.32014344547007, -431.55610157998007, -776.0230277677208, -1204.6119641904477, -982.6916458685873, -235.33389465435275, -267.7536993383707, -938.9836284826366, -532.5852183577354, -74.56715717976, -36.61450140835321, -359.58676336861606, -1394.0542890041168, -144.95176812379285, -939.1625532049994, -148.93115771071945, -214.4306907536909, -69.83838000048712, -214.3669797357279, -1035.7159612896094, -432.78042356699893, -634.5583119080925]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5596009102950823, "mean_inference_ms": 1.7170251064099231, "mean_action_processing_ms": 0.2733362170928314, "mean_env_wait_ms": 3.4063988263059435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011925458908081055, "StateBufferConnector_ms": 0.007990837097167969, "ViewRequirementAgentConnector_ms": 0.19052648544311523}, "num_episodes": 40, "episode_return_max": -4.251215111753544, "episode_return_min": -1526.700551529837, "episode_return_mean": -551.1522562386084, "episodes_this_iter": 40}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.89282182739584, "num_env_steps_trained_throughput_per_sec": 313.89282182739584, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 12358.097, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12358.019, "sample_time_ms": 1209.902, "learn_time_ms": 11083.068, "learn_throughput": 360.911, "synch_weights_time_ms": 64.243}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "training_iteration": 37, "trial_id": "4b94b_00000", "date": "2024-08-05_11-47-25", "timestamp": 1722838645, "time_this_iter_s": 12.756958246231079, "time_total_s": 449.58502435684204, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1110a1cf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 449.58502435684204, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 17.83157894736842, "ram_util_percent": 29.200000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 108.43876083393891, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.7803621480008587, "policy_loss": -0.0030826535488207205, "vf_loss": 0.7846553975095352, "vf_explained_var": 0.9967567830656966, "kl": 0.011696509809007716, "entropy": 1.3568001041809719, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "env_runners": {"episode_reward_max": 7.120897905855529, "episode_reward_min": -1526.700551529837, "episode_reward_mean": -571.8195180580215, "episode_len_mean": 114.78, "episode_media": {}, "episodes_timesteps_total": 11478, "policy_reward_min": {"policy_0": -1526.700551529837}, "policy_reward_max": {"policy_0": 7.120897905855529}, "policy_reward_mean": {"policy_0": -571.8195180580215}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-822.5600502728176, -894.7169464971016, -162.033145715879, -484.58573585514483, -1063.151007784806, -157.88903692504437, -1025.4528707790475, -293.8018413743356, -1526.700551529837, -1099.0465129215522, -39.47702266701205, -1275.0961999288832, -611.5321554035531, -19.0668615727078, -893.0990928455121, -1101.1223972020202, -861.6709562214878, -222.6613468509731, -1019.9193230792919, -162.61573734823793, -1216.210403623803, -1005.9182006593009, -970.4126616394582, -1134.333565903287, -22.627157161476493, -245.0703480261499, -944.2912898902777, -945.7634853967867, -815.489100511776, -363.3910942538985, -258.5375786816185, -789.9518186670549, -789.1914800341665, -986.7189900268025, -180.89646709998104, -4.251215111753544, -989.789402645989, -178.35979851152143, -545.2237885674548, -494.4475678414989, -937.3736709052037, -329.1162844809922, -654.1744981758048, -216.7754276057737, -211.47439447055086, -73.79491914777489, -61.88970226920064, -52.32014344547007, -431.55610157998007, -776.0230277677208, -1204.6119641904477, -982.6916458685873, -235.33389465435275, -267.7536993383707, -938.9836284826366, -532.5852183577354, -74.56715717976, -36.61450140835321, -359.58676336861606, -1394.0542890041168, -144.95176812379285, -939.1625532049994, -148.93115771071945, -214.4306907536909, -69.83838000048712, -214.3669797357279, -1035.7159612896094, -432.78042356699893, -634.5583119080925, -444.57327794174535, -9.763330009289401, -960.7818530690154, -228.68418580117486, -21.803754526318176, 7.120897905855529, -21.885926186574316, -860.4064175974635, -247.6213175032269, -326.8023722806338, -0.9719999851711587, -255.26572796363732, -59.2453738372816, -123.09369595323551, -1021.4487716259312, -1170.0496486712875, -1034.5360072347103, -262.16942878992745, -39.55249451918284, -818.6941262144867, -1242.3181335167044, -1177.7945179160588, -864.8164318758904, -114.0883262989129, -1150.799671255828, -909.5136375284678, -636.1921361411834, -1024.140670690822, -218.12257170116513, -921.7879185660356, -799.057613481784], "episode_lengths": [150, 150, 56, 150, 150, 67, 150, 78, 150, 150, 45, 150, 150, 39, 150, 150, 150, 111, 150, 67, 150, 150, 150, 150, 43, 101, 150, 150, 150, 109, 92, 150, 150, 150, 82, 35, 150, 95, 150, 150, 150, 82, 133, 65, 98, 48, 51, 53, 146, 150, 150, 150, 79, 77, 150, 150, 50, 50, 94, 150, 58, 150, 54, 95, 66, 73, 150, 105, 150, 114, 39, 150, 150, 44, 29, 44, 150, 90, 103, 30, 113, 62, 121, 150, 150, 150, 150, 54, 150, 150, 150, 150, 73, 150, 150, 150, 150, 115, 150, 150], "policy_policy_0_reward": [-822.5600502728176, -894.7169464971016, -162.033145715879, -484.58573585514483, -1063.151007784806, -157.88903692504437, -1025.4528707790475, -293.8018413743356, -1526.700551529837, -1099.0465129215522, -39.47702266701205, -1275.0961999288832, -611.5321554035531, -19.0668615727078, -893.0990928455121, -1101.1223972020202, -861.6709562214878, -222.6613468509731, -1019.9193230792919, -162.61573734823793, -1216.210403623803, -1005.9182006593009, -970.4126616394582, -1134.333565903287, -22.627157161476493, -245.0703480261499, -944.2912898902777, -945.7634853967867, -815.489100511776, -363.3910942538985, -258.5375786816185, -789.9518186670549, -789.1914800341665, -986.7189900268025, -180.89646709998104, -4.251215111753544, -989.789402645989, -178.35979851152143, -545.2237885674548, -494.4475678414989, -937.3736709052037, -329.1162844809922, -654.1744981758048, -216.7754276057737, -211.47439447055086, -73.79491914777489, -61.88970226920064, -52.32014344547007, -431.55610157998007, -776.0230277677208, -1204.6119641904477, -982.6916458685873, -235.33389465435275, -267.7536993383707, -938.9836284826366, -532.5852183577354, -74.56715717976, -36.61450140835321, -359.58676336861606, -1394.0542890041168, -144.95176812379285, -939.1625532049994, -148.93115771071945, -214.4306907536909, -69.83838000048712, -214.3669797357279, -1035.7159612896094, -432.78042356699893, -634.5583119080925, -444.57327794174535, -9.763330009289401, -960.7818530690154, -228.68418580117486, -21.803754526318176, 7.120897905855529, -21.885926186574316, -860.4064175974635, -247.6213175032269, -326.8023722806338, -0.9719999851711587, -255.26572796363732, -59.2453738372816, -123.09369595323551, -1021.4487716259312, -1170.0496486712875, -1034.5360072347103, -262.16942878992745, -39.55249451918284, -818.6941262144867, -1242.3181335167044, -1177.7945179160588, -864.8164318758904, -114.0883262989129, -1150.799671255828, -909.5136375284678, -636.1921361411834, -1024.140670690822, -218.12257170116513, -921.7879185660356, -799.057613481784]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5605911961956945, "mean_inference_ms": 1.7145278293889625, "mean_action_processing_ms": 0.27314837401259323, "mean_env_wait_ms": 3.4043858034674948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01187276840209961, "StateBufferConnector_ms": 0.0079193115234375, "ViewRequirementAgentConnector_ms": 0.1891317367553711}, "num_episodes": 31, "episode_return_max": 7.120897905855529, "episode_return_min": -1526.700551529837, "episode_return_mean": -571.8195180580215, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.5635354005731, "num_env_steps_trained_throughput_per_sec": 326.5635354005731, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 12380.609, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12380.53, "sample_time_ms": 1188.864, "learn_time_ms": 11126.947, "learn_throughput": 359.488, "synch_weights_time_ms": 63.915}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "training_iteration": 38, "trial_id": "4b94b_00000", "date": "2024-08-05_11-47-37", "timestamp": 1722838657, "time_this_iter_s": 12.260478973388672, "time_total_s": 461.8455033302307, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e111568b80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 461.8455033302307, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 18.252941176470593, "ram_util_percent": 29.211764705882352}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 103.91925903260707, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.0919142826149861, "policy_loss": -0.0019052446383284404, "vf_loss": 1.0951428210983674, "vf_explained_var": 0.9956388652945558, "kl": 0.00987469137435255, "entropy": 1.4467262881497542, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "env_runners": {"episode_reward_max": 7.120897905855529, "episode_reward_min": -1394.0542890041168, "episode_reward_mean": -512.1459499550671, "episode_len_mean": 112.41, "episode_media": {}, "episodes_timesteps_total": 11241, "policy_reward_min": {"policy_0": -1394.0542890041168}, "policy_reward_max": {"policy_0": 7.120897905855529}, "policy_reward_mean": {"policy_0": -512.1459499550671}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.251215111753544, -989.789402645989, -178.35979851152143, -545.2237885674548, -494.4475678414989, -937.3736709052037, -329.1162844809922, -654.1744981758048, -216.7754276057737, -211.47439447055086, -73.79491914777489, -61.88970226920064, -52.32014344547007, -431.55610157998007, -776.0230277677208, -1204.6119641904477, -982.6916458685873, -235.33389465435275, -267.7536993383707, -938.9836284826366, -532.5852183577354, -74.56715717976, -36.61450140835321, -359.58676336861606, -1394.0542890041168, -144.95176812379285, -939.1625532049994, -148.93115771071945, -214.4306907536909, -69.83838000048712, -214.3669797357279, -1035.7159612896094, -432.78042356699893, -634.5583119080925, -444.57327794174535, -9.763330009289401, -960.7818530690154, -228.68418580117486, -21.803754526318176, 7.120897905855529, -21.885926186574316, -860.4064175974635, -247.6213175032269, -326.8023722806338, -0.9719999851711587, -255.26572796363732, -59.2453738372816, -123.09369595323551, -1021.4487716259312, -1170.0496486712875, -1034.5360072347103, -262.16942878992745, -39.55249451918284, -818.6941262144867, -1242.3181335167044, -1177.7945179160588, -864.8164318758904, -114.0883262989129, -1150.799671255828, -909.5136375284678, -636.1921361411834, -1024.140670690822, -218.12257170116513, -921.7879185660356, -799.057613481784, -704.9832926082979, -668.5565607462736, -871.1745538599353, -515.5284645358062, -334.267491149532, -234.03033442660376, -272.87009623087954, -840.1231512399936, -387.3053262537899, -1044.5279623823271, -798.511744511059, -84.35628811190607, -479.3953062084537, -305.1423797726218, -334.6983117555173, -28.78430270149312, -927.7523382502555, -281.1384849653129, -486.87786554244923, -924.3253368154658, -1283.5201086977586, -691.1232471970089, -1164.427036742368, -22.88052316678514, -921.4816426095815, -11.609069342521355, -107.21820982182548, -882.3391863438161, -1088.2098910256884, -340.43458618323655, -356.1458006074256, -148.68413690599982, -387.3819474684853, -369.79718260188105, -138.04346327327963], "episode_lengths": [35, 150, 95, 150, 150, 150, 82, 133, 65, 98, 48, 51, 53, 146, 150, 150, 150, 79, 77, 150, 150, 50, 50, 94, 150, 58, 150, 54, 95, 66, 73, 150, 105, 150, 114, 39, 150, 150, 44, 29, 44, 150, 90, 103, 30, 113, 62, 121, 150, 150, 150, 150, 54, 150, 150, 150, 150, 73, 150, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 86, 87, 86, 150, 95, 150, 150, 71, 150, 93, 124, 33, 150, 150, 135, 150, 150, 150, 150, 44, 150, 37, 78, 150, 150, 95, 150, 51, 87, 124, 77], "policy_policy_0_reward": [-4.251215111753544, -989.789402645989, -178.35979851152143, -545.2237885674548, -494.4475678414989, -937.3736709052037, -329.1162844809922, -654.1744981758048, -216.7754276057737, -211.47439447055086, -73.79491914777489, -61.88970226920064, -52.32014344547007, -431.55610157998007, -776.0230277677208, -1204.6119641904477, -982.6916458685873, -235.33389465435275, -267.7536993383707, -938.9836284826366, -532.5852183577354, -74.56715717976, -36.61450140835321, -359.58676336861606, -1394.0542890041168, -144.95176812379285, -939.1625532049994, -148.93115771071945, -214.4306907536909, -69.83838000048712, -214.3669797357279, -1035.7159612896094, -432.78042356699893, -634.5583119080925, -444.57327794174535, -9.763330009289401, -960.7818530690154, -228.68418580117486, -21.803754526318176, 7.120897905855529, -21.885926186574316, -860.4064175974635, -247.6213175032269, -326.8023722806338, -0.9719999851711587, -255.26572796363732, -59.2453738372816, -123.09369595323551, -1021.4487716259312, -1170.0496486712875, -1034.5360072347103, -262.16942878992745, -39.55249451918284, -818.6941262144867, -1242.3181335167044, -1177.7945179160588, -864.8164318758904, -114.0883262989129, -1150.799671255828, -909.5136375284678, -636.1921361411834, -1024.140670690822, -218.12257170116513, -921.7879185660356, -799.057613481784, -704.9832926082979, -668.5565607462736, -871.1745538599353, -515.5284645358062, -334.267491149532, -234.03033442660376, -272.87009623087954, -840.1231512399936, -387.3053262537899, -1044.5279623823271, -798.511744511059, -84.35628811190607, -479.3953062084537, -305.1423797726218, -334.6983117555173, -28.78430270149312, -927.7523382502555, -281.1384849653129, -486.87786554244923, -924.3253368154658, -1283.5201086977586, -691.1232471970089, -1164.427036742368, -22.88052316678514, -921.4816426095815, -11.609069342521355, -107.21820982182548, -882.3391863438161, -1088.2098910256884, -340.43458618323655, -356.1458006074256, -148.68413690599982, -387.3819474684853, -369.79718260188105, -138.04346327327963]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5597111766689357, "mean_inference_ms": 1.711212188355364, "mean_action_processing_ms": 0.27312827647140986, "mean_env_wait_ms": 3.402334481642188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011919975280761719, "StateBufferConnector_ms": 0.007949590682983398, "ViewRequirementAgentConnector_ms": 0.1905817985534668}, "num_episodes": 35, "episode_return_max": 7.120897905855529, "episode_return_min": -1394.0542890041168, "episode_return_mean": -512.1459499550671, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 337.43773713309173, "num_env_steps_trained_throughput_per_sec": 337.43773713309173, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 12366.814, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12366.735, "sample_time_ms": 1180.29, "learn_time_ms": 11121.72, "learn_throughput": 359.657, "synch_weights_time_ms": 63.92}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "training_iteration": 39, "trial_id": "4b94b_00000", "date": "2024-08-05_11-47-49", "timestamp": 1722838669, "time_this_iter_s": 11.86741590499878, "time_total_s": 473.7129192352295, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e111110280>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 473.7129192352295, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 18.641176470588235, "ram_util_percent": 29.21764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 100.83583208620549, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.064964992615084, "policy_loss": -0.004224546448676847, "vf_loss": 1.070533314316223, "vf_explained_var": 0.9864199336618185, "kl": 0.009933422006542987, "entropy": 1.467943433051308, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 7.120897905855529, "episode_reward_min": -1416.8366103808262, "episode_reward_mean": -526.9486865346745, "episode_len_mean": 114.74, "episode_media": {}, "episodes_timesteps_total": 11474, "policy_reward_min": {"policy_0": -1416.8366103808262}, "policy_reward_max": {"policy_0": 7.120897905855529}, "policy_reward_mean": {"policy_0": -526.9486865346745}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-960.7818530690154, -228.68418580117486, -21.803754526318176, 7.120897905855529, -21.885926186574316, -860.4064175974635, -247.6213175032269, -326.8023722806338, -0.9719999851711587, -255.26572796363732, -59.2453738372816, -123.09369595323551, -1021.4487716259312, -1170.0496486712875, -1034.5360072347103, -262.16942878992745, -39.55249451918284, -818.6941262144867, -1242.3181335167044, -1177.7945179160588, -864.8164318758904, -114.0883262989129, -1150.799671255828, -909.5136375284678, -636.1921361411834, -1024.140670690822, -218.12257170116513, -921.7879185660356, -799.057613481784, -704.9832926082979, -668.5565607462736, -871.1745538599353, -515.5284645358062, -334.267491149532, -234.03033442660376, -272.87009623087954, -840.1231512399936, -387.3053262537899, -1044.5279623823271, -798.511744511059, -84.35628811190607, -479.3953062084537, -305.1423797726218, -334.6983117555173, -28.78430270149312, -927.7523382502555, -281.1384849653129, -486.87786554244923, -924.3253368154658, -1283.5201086977586, -691.1232471970089, -1164.427036742368, -22.88052316678514, -921.4816426095815, -11.609069342521355, -107.21820982182548, -882.3391863438161, -1088.2098910256884, -340.43458618323655, -356.1458006074256, -148.68413690599982, -387.3819474684853, -369.79718260188105, -138.04346327327963, -780.8972054414505, -1416.8366103808262, -761.8655198028111, -613.8653335716922, -67.71873081903024, -134.48667460471623, -184.9961877187712, -1159.5192008136337, -13.77170571271086, -115.40801353128738, -466.4887649659945, -369.5153720319211, -442.5681732488033, -279.90438676316114, -28.034802019934695, -579.0632079741974, -2.4604459705620414, -691.9512096079445, -946.4120086696959, -1317.9251071248066, -322.1183407471592, -66.87413299974259, -79.06642988238083, -104.63049102175633, -296.78483387470317, -671.8319018804362, -769.851903863014, -92.10325146785536, -686.5284766966253, -156.45785411160085, -877.3079599354579, -316.29476021120416, -270.84053291367695, -814.4586491638375, -773.9681549821253, -1079.8928620600352], "episode_lengths": [150, 150, 44, 29, 44, 150, 90, 103, 30, 113, 62, 121, 150, 150, 150, 150, 54, 150, 150, 150, 150, 73, 150, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 86, 87, 86, 150, 95, 150, 150, 71, 150, 93, 124, 33, 150, 150, 135, 150, 150, 150, 150, 44, 150, 37, 78, 150, 150, 95, 150, 51, 87, 124, 77, 150, 150, 150, 133, 57, 89, 65, 150, 45, 70, 125, 93, 114, 82, 50, 150, 36, 150, 150, 150, 79, 54, 63, 52, 150, 150, 130, 68, 150, 96, 150, 86, 116, 150, 140, 150], "policy_policy_0_reward": [-960.7818530690154, -228.68418580117486, -21.803754526318176, 7.120897905855529, -21.885926186574316, -860.4064175974635, -247.6213175032269, -326.8023722806338, -0.9719999851711587, -255.26572796363732, -59.2453738372816, -123.09369595323551, -1021.4487716259312, -1170.0496486712875, -1034.5360072347103, -262.16942878992745, -39.55249451918284, -818.6941262144867, -1242.3181335167044, -1177.7945179160588, -864.8164318758904, -114.0883262989129, -1150.799671255828, -909.5136375284678, -636.1921361411834, -1024.140670690822, -218.12257170116513, -921.7879185660356, -799.057613481784, -704.9832926082979, -668.5565607462736, -871.1745538599353, -515.5284645358062, -334.267491149532, -234.03033442660376, -272.87009623087954, -840.1231512399936, -387.3053262537899, -1044.5279623823271, -798.511744511059, -84.35628811190607, -479.3953062084537, -305.1423797726218, -334.6983117555173, -28.78430270149312, -927.7523382502555, -281.1384849653129, -486.87786554244923, -924.3253368154658, -1283.5201086977586, -691.1232471970089, -1164.427036742368, -22.88052316678514, -921.4816426095815, -11.609069342521355, -107.21820982182548, -882.3391863438161, -1088.2098910256884, -340.43458618323655, -356.1458006074256, -148.68413690599982, -387.3819474684853, -369.79718260188105, -138.04346327327963, -780.8972054414505, -1416.8366103808262, -761.8655198028111, -613.8653335716922, -67.71873081903024, -134.48667460471623, -184.9961877187712, -1159.5192008136337, -13.77170571271086, -115.40801353128738, -466.4887649659945, -369.5153720319211, -442.5681732488033, -279.90438676316114, -28.034802019934695, -579.0632079741974, -2.4604459705620414, -691.9512096079445, -946.4120086696959, -1317.9251071248066, -322.1183407471592, -66.87413299974259, -79.06642988238083, -104.63049102175633, -296.78483387470317, -671.8319018804362, -769.851903863014, -92.10325146785536, -686.5284766966253, -156.45785411160085, -877.3079599354579, -316.29476021120416, -270.84053291367695, -814.4586491638375, -773.9681549821253, -1079.8928620600352]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5595315742544471, "mean_inference_ms": 1.7092543993984015, "mean_action_processing_ms": 0.27290535947751915, "mean_env_wait_ms": 3.4073190634724075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011826276779174805, "StateBufferConnector_ms": 0.007955074310302734, "ViewRequirementAgentConnector_ms": 0.19173860549926758}, "num_episodes": 36, "episode_return_max": 7.120897905855529, "episode_return_min": -1416.8366103808262, "episode_return_mean": -526.9486865346745, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 509.26158445912836, "num_env_steps_trained_throughput_per_sec": 509.26158445912836, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 11960.134, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11960.053, "sample_time_ms": 1170.215, "learn_time_ms": 10726.272, "learn_throughput": 372.916, "synch_weights_time_ms": 62.769}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 40, "trial_id": "4b94b_00000", "date": "2024-08-05_11-47-57", "timestamp": 1722838677, "time_this_iter_s": 7.8684916496276855, "time_total_s": 481.5814108848572, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e111111870>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 481.5814108848572, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 22.872727272727275, "ram_util_percent": 29.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 110.79386343757311, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.0728538190635541, "policy_loss": 5.709801043849438e-05, "vf_loss": 1.0741664045179884, "vf_explained_var": 0.9884624981631835, "kl": 0.01108192128531302, "entropy": 1.5082068187495072, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "env_runners": {"episode_reward_max": -2.4604459705620414, "episode_reward_min": -1416.8366103808262, "episode_reward_mean": -508.26309328691497, "episode_len_mean": 112.4, "episode_media": {}, "episodes_timesteps_total": 11240, "policy_reward_min": {"policy_0": -1416.8366103808262}, "policy_reward_max": {"policy_0": -2.4604459705620414}, "policy_reward_mean": {"policy_0": -508.26309328691497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-387.3053262537899, -1044.5279623823271, -798.511744511059, -84.35628811190607, -479.3953062084537, -305.1423797726218, -334.6983117555173, -28.78430270149312, -927.7523382502555, -281.1384849653129, -486.87786554244923, -924.3253368154658, -1283.5201086977586, -691.1232471970089, -1164.427036742368, -22.88052316678514, -921.4816426095815, -11.609069342521355, -107.21820982182548, -882.3391863438161, -1088.2098910256884, -340.43458618323655, -356.1458006074256, -148.68413690599982, -387.3819474684853, -369.79718260188105, -138.04346327327963, -780.8972054414505, -1416.8366103808262, -761.8655198028111, -613.8653335716922, -67.71873081903024, -134.48667460471623, -184.9961877187712, -1159.5192008136337, -13.77170571271086, -115.40801353128738, -466.4887649659945, -369.5153720319211, -442.5681732488033, -279.90438676316114, -28.034802019934695, -579.0632079741974, -2.4604459705620414, -691.9512096079445, -946.4120086696959, -1317.9251071248066, -322.1183407471592, -66.87413299974259, -79.06642988238083, -104.63049102175633, -296.78483387470317, -671.8319018804362, -769.851903863014, -92.10325146785536, -686.5284766966253, -156.45785411160085, -877.3079599354579, -316.29476021120416, -270.84053291367695, -814.4586491638375, -773.9681549821253, -1079.8928620600352, -1196.169591054079, -131.38578108845223, -157.8039918027446, -398.6910185295813, -424.5345484446391, -295.6602129319302, -445.4114868167247, -1308.6665413562066, -560.0695914641437, -247.0510893982161, -141.01558508946613, -893.6491954264297, -496.6987444720876, -124.9000792949723, -322.9071373366954, -953.0801701588581, -1380.5276905852254, -465.8551670706993, -243.13477991873933, -1184.7010782570962, -1053.2898144886774, -248.78926892127703, -541.1828414066189, -349.00474083094576, -307.26455017597465, -969.9042059124296, -752.8557834706842, -514.8055409762515, -269.1466902857012, -312.69039927918266, -359.5777786985728, -937.3878952037655, -82.89055756408246, -671.6768168967104, -6.39531507890033, -208.9572037545972, -119.76556940626105], "episode_lengths": [95, 150, 150, 71, 150, 93, 124, 33, 150, 150, 135, 150, 150, 150, 150, 44, 150, 37, 78, 150, 150, 95, 150, 51, 87, 124, 77, 150, 150, 150, 133, 57, 89, 65, 150, 45, 70, 125, 93, 114, 82, 50, 150, 36, 150, 150, 150, 79, 54, 63, 52, 150, 150, 130, 68, 150, 96, 150, 86, 116, 150, 140, 150, 150, 55, 92, 87, 106, 108, 127, 150, 135, 150, 150, 150, 150, 75, 80, 150, 150, 97, 130, 150, 150, 88, 107, 100, 105, 150, 150, 105, 71, 83, 82, 150, 69, 150, 32, 96, 73], "policy_policy_0_reward": [-387.3053262537899, -1044.5279623823271, -798.511744511059, -84.35628811190607, -479.3953062084537, -305.1423797726218, -334.6983117555173, -28.78430270149312, -927.7523382502555, -281.1384849653129, -486.87786554244923, -924.3253368154658, -1283.5201086977586, -691.1232471970089, -1164.427036742368, -22.88052316678514, -921.4816426095815, -11.609069342521355, -107.21820982182548, -882.3391863438161, -1088.2098910256884, -340.43458618323655, -356.1458006074256, -148.68413690599982, -387.3819474684853, -369.79718260188105, -138.04346327327963, -780.8972054414505, -1416.8366103808262, -761.8655198028111, -613.8653335716922, -67.71873081903024, -134.48667460471623, -184.9961877187712, -1159.5192008136337, -13.77170571271086, -115.40801353128738, -466.4887649659945, -369.5153720319211, -442.5681732488033, -279.90438676316114, -28.034802019934695, -579.0632079741974, -2.4604459705620414, -691.9512096079445, -946.4120086696959, -1317.9251071248066, -322.1183407471592, -66.87413299974259, -79.06642988238083, -104.63049102175633, -296.78483387470317, -671.8319018804362, -769.851903863014, -92.10325146785536, -686.5284766966253, -156.45785411160085, -877.3079599354579, -316.29476021120416, -270.84053291367695, -814.4586491638375, -773.9681549821253, -1079.8928620600352, -1196.169591054079, -131.38578108845223, -157.8039918027446, -398.6910185295813, -424.5345484446391, -295.6602129319302, -445.4114868167247, -1308.6665413562066, -560.0695914641437, -247.0510893982161, -141.01558508946613, -893.6491954264297, -496.6987444720876, -124.9000792949723, -322.9071373366954, -953.0801701588581, -1380.5276905852254, -465.8551670706993, -243.13477991873933, -1184.7010782570962, -1053.2898144886774, -248.78926892127703, -541.1828414066189, -349.00474083094576, -307.26455017597465, -969.9042059124296, -752.8557834706842, -514.8055409762515, -269.1466902857012, -312.69039927918266, -359.5777786985728, -937.3878952037655, -82.89055756408246, -671.6768168967104, -6.39531507890033, -208.9572037545972, -119.76556940626105]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5578218792422257, "mean_inference_ms": 1.709141604808703, "mean_action_processing_ms": 0.27289438482596706, "mean_env_wait_ms": 3.410216692570002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01185297966003418, "StateBufferConnector_ms": 0.007988691329956055, "ViewRequirementAgentConnector_ms": 0.2022533416748047}, "num_episodes": 37, "episode_return_max": -2.4604459705620414, "episode_return_min": -1416.8366103808262, "episode_return_mean": -508.26309328691497, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 336.81648935294567, "num_env_steps_trained_throughput_per_sec": 336.81648935294567, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 11829.055, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11828.973, "sample_time_ms": 1144.165, "learn_time_ms": 10620.536, "learn_throughput": 376.629, "synch_weights_time_ms": 63.471}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "training_iteration": 41, "trial_id": "4b94b_00000", "date": "2024-08-05_11-48-09", "timestamp": 1722838689, "time_this_iter_s": 11.888065814971924, "time_total_s": 493.4694766998291, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1110a3f40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 493.4694766998291, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 18.54705882352941, "ram_util_percent": 29.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 112.53616335690022, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.0375884742786488, "policy_loss": 0.001364786347039626, "vf_loss": 1.0374352623863767, "vf_explained_var": 0.9831462580089768, "kl": 0.014446229248945505, "entropy": 1.3921512169142565, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "env_runners": {"episode_reward_max": -2.4604459705620414, "episode_reward_min": -1380.5276905852254, "episode_reward_mean": -514.0928420004349, "episode_len_mean": 112.26, "episode_media": {}, "episodes_timesteps_total": 11226, "policy_reward_min": {"policy_0": -1380.5276905852254}, "policy_reward_max": {"policy_0": -2.4604459705620414}, "policy_reward_mean": {"policy_0": -514.0928420004349}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.71873081903024, -134.48667460471623, -184.9961877187712, -1159.5192008136337, -13.77170571271086, -115.40801353128738, -466.4887649659945, -369.5153720319211, -442.5681732488033, -279.90438676316114, -28.034802019934695, -579.0632079741974, -2.4604459705620414, -691.9512096079445, -946.4120086696959, -1317.9251071248066, -322.1183407471592, -66.87413299974259, -79.06642988238083, -104.63049102175633, -296.78483387470317, -671.8319018804362, -769.851903863014, -92.10325146785536, -686.5284766966253, -156.45785411160085, -877.3079599354579, -316.29476021120416, -270.84053291367695, -814.4586491638375, -773.9681549821253, -1079.8928620600352, -1196.169591054079, -131.38578108845223, -157.8039918027446, -398.6910185295813, -424.5345484446391, -295.6602129319302, -445.4114868167247, -1308.6665413562066, -560.0695914641437, -247.0510893982161, -141.01558508946613, -893.6491954264297, -496.6987444720876, -124.9000792949723, -322.9071373366954, -953.0801701588581, -1380.5276905852254, -465.8551670706993, -243.13477991873933, -1184.7010782570962, -1053.2898144886774, -248.78926892127703, -541.1828414066189, -349.00474083094576, -307.26455017597465, -969.9042059124296, -752.8557834706842, -514.8055409762515, -269.1466902857012, -312.69039927918266, -359.5777786985728, -937.3878952037655, -82.89055756408246, -671.6768168967104, -6.39531507890033, -208.9572037545972, -119.76556940626105, -1044.6222387108085, -347.1839500008516, -1004.0668665348917, -487.91102794505986, -61.29809072450465, -85.24019271270456, -1186.85789354346, -860.6549931577063, -646.88962683448, -892.9656972999215, -216.7201156842978, -419.2270366098028, -47.167081303318064, -886.1055959782062, -1254.2243204865506, -482.9376779061458, -85.59135349519738, -373.0033675774961, -1044.7098727858208, -447.4622407712069, -948.8150034371702, -101.18906709348664, -950.7805694434187, -196.87527587184977, -508.9458077750746, -369.0749992162595, -1326.9528628379683, -170.82124133826196, -582.2313078307776, -1067.8313948234747, -54.19445007692376], "episode_lengths": [57, 89, 65, 150, 45, 70, 125, 93, 114, 82, 50, 150, 36, 150, 150, 150, 79, 54, 63, 52, 150, 150, 130, 68, 150, 96, 150, 86, 116, 150, 140, 150, 150, 55, 92, 87, 106, 108, 127, 150, 135, 150, 150, 150, 150, 75, 80, 150, 150, 97, 130, 150, 150, 88, 107, 100, 105, 150, 150, 105, 71, 83, 82, 150, 69, 150, 32, 96, 73, 150, 93, 150, 150, 67, 66, 150, 150, 118, 150, 88, 150, 63, 146, 150, 105, 77, 84, 150, 150, 150, 50, 150, 80, 127, 90, 150, 83, 150, 150, 76], "policy_policy_0_reward": [-67.71873081903024, -134.48667460471623, -184.9961877187712, -1159.5192008136337, -13.77170571271086, -115.40801353128738, -466.4887649659945, -369.5153720319211, -442.5681732488033, -279.90438676316114, -28.034802019934695, -579.0632079741974, -2.4604459705620414, -691.9512096079445, -946.4120086696959, -1317.9251071248066, -322.1183407471592, -66.87413299974259, -79.06642988238083, -104.63049102175633, -296.78483387470317, -671.8319018804362, -769.851903863014, -92.10325146785536, -686.5284766966253, -156.45785411160085, -877.3079599354579, -316.29476021120416, -270.84053291367695, -814.4586491638375, -773.9681549821253, -1079.8928620600352, -1196.169591054079, -131.38578108845223, -157.8039918027446, -398.6910185295813, -424.5345484446391, -295.6602129319302, -445.4114868167247, -1308.6665413562066, -560.0695914641437, -247.0510893982161, -141.01558508946613, -893.6491954264297, -496.6987444720876, -124.9000792949723, -322.9071373366954, -953.0801701588581, -1380.5276905852254, -465.8551670706993, -243.13477991873933, -1184.7010782570962, -1053.2898144886774, -248.78926892127703, -541.1828414066189, -349.00474083094576, -307.26455017597465, -969.9042059124296, -752.8557834706842, -514.8055409762515, -269.1466902857012, -312.69039927918266, -359.5777786985728, -937.3878952037655, -82.89055756408246, -671.6768168967104, -6.39531507890033, -208.9572037545972, -119.76556940626105, -1044.6222387108085, -347.1839500008516, -1004.0668665348917, -487.91102794505986, -61.29809072450465, -85.24019271270456, -1186.85789354346, -860.6549931577063, -646.88962683448, -892.9656972999215, -216.7201156842978, -419.2270366098028, -47.167081303318064, -886.1055959782062, -1254.2243204865506, -482.9376779061458, -85.59135349519738, -373.0033675774961, -1044.7098727858208, -447.4622407712069, -948.8150034371702, -101.18906709348664, -950.7805694434187, -196.87527587184977, -508.9458077750746, -369.0749992162595, -1326.9528628379683, -170.82124133826196, -582.2313078307776, -1067.8313948234747, -54.19445007692376]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5585444370456976, "mean_inference_ms": 1.7077088702145378, "mean_action_processing_ms": 0.2729897406981123, "mean_env_wait_ms": 3.4115645897578717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012070655822753906, "StateBufferConnector_ms": 0.008249998092651367, "ViewRequirementAgentConnector_ms": 0.20115971565246582}, "num_episodes": 31, "episode_return_max": -2.4604459705620414, "episode_return_min": -1380.5276905852254, "episode_return_mean": -514.0928420004349, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.1776955886327, "num_env_steps_trained_throughput_per_sec": 309.1776955886327, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 11840.855, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11840.779, "sample_time_ms": 1126.316, "learn_time_ms": 10651.004, "learn_throughput": 375.551, "synch_weights_time_ms": 62.663}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "training_iteration": 42, "trial_id": "4b94b_00000", "date": "2024-08-05_11-48-22", "timestamp": 1722838702, "time_this_iter_s": 12.950576305389404, "time_total_s": 506.4200530052185, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1110a2440>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 506.4200530052185, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 17.673684210526318, "ram_util_percent": 29.21578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 84.47601453463237, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9846613383851945, "policy_loss": -0.0038808036309395297, "vf_loss": 0.9897951410462459, "vf_explained_var": 0.9959641104564071, "kl": 0.012198862993227536, "entropy": 1.4054857404281695, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "env_runners": {"episode_reward_max": -6.39531507890033, "episode_reward_min": -1416.2430288070634, "episode_reward_mean": -529.3112927035141, "episode_len_mean": 116.43, "episode_media": {}, "episodes_timesteps_total": 11643, "policy_reward_min": {"policy_0": -1416.2430288070634}, "policy_reward_max": {"policy_0": -6.39531507890033}, "policy_reward_mean": {"policy_0": -529.3112927035141}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-445.4114868167247, -1308.6665413562066, -560.0695914641437, -247.0510893982161, -141.01558508946613, -893.6491954264297, -496.6987444720876, -124.9000792949723, -322.9071373366954, -953.0801701588581, -1380.5276905852254, -465.8551670706993, -243.13477991873933, -1184.7010782570962, -1053.2898144886774, -248.78926892127703, -541.1828414066189, -349.00474083094576, -307.26455017597465, -969.9042059124296, -752.8557834706842, -514.8055409762515, -269.1466902857012, -312.69039927918266, -359.5777786985728, -937.3878952037655, -82.89055756408246, -671.6768168967104, -6.39531507890033, -208.9572037545972, -119.76556940626105, -1044.6222387108085, -347.1839500008516, -1004.0668665348917, -487.91102794505986, -61.29809072450465, -85.24019271270456, -1186.85789354346, -860.6549931577063, -646.88962683448, -892.9656972999215, -216.7201156842978, -419.2270366098028, -47.167081303318064, -886.1055959782062, -1254.2243204865506, -482.9376779061458, -85.59135349519738, -373.0033675774961, -1044.7098727858208, -447.4622407712069, -948.8150034371702, -101.18906709348664, -950.7805694434187, -196.87527587184977, -508.9458077750746, -369.0749992162595, -1326.9528628379683, -170.82124133826196, -582.2313078307776, -1067.8313948234747, -54.19445007692376, -364.1080664789847, -411.978229839494, -172.1443931529042, -252.73235815325455, -813.4219299817208, -110.98677106406741, -255.81033670285254, -968.4824725666788, -235.77158245580605, -503.5630583497171, -74.40020049348557, -81.2921907345248, -717.9442435495985, -181.35488744003558, -607.3800127812108, -1020.0397008107318, -127.11674653483095, -666.8629659223873, -1075.624751007064, -224.09647612520354, -301.2629948170721, -1416.2430288070634, -308.0417010553613, -361.35421049945984, -435.04702313172777, -114.5685823070244, -1320.644725913042, -1078.4721180177216, -14.261480948034734, -315.1802375475006, -226.2761023404679, -63.846975966679786, -559.9532260680768, -1058.2651465566455, -132.82636893836712, -775.3584755331918, -19.707469531987606, -938.9034994241493], "episode_lengths": [127, 150, 135, 150, 150, 150, 150, 75, 80, 150, 150, 97, 130, 150, 150, 88, 107, 100, 105, 150, 150, 105, 71, 83, 82, 150, 69, 150, 32, 96, 73, 150, 93, 150, 150, 67, 66, 150, 150, 118, 150, 88, 150, 63, 146, 150, 105, 77, 84, 150, 150, 150, 50, 150, 80, 127, 90, 150, 83, 150, 150, 76, 150, 118, 61, 103, 150, 67, 150, 150, 150, 112, 63, 62, 150, 106, 150, 150, 126, 150, 150, 85, 76, 150, 125, 96, 150, 52, 150, 150, 38, 111, 80, 69, 150, 150, 76, 150, 49, 150], "policy_policy_0_reward": [-445.4114868167247, -1308.6665413562066, -560.0695914641437, -247.0510893982161, -141.01558508946613, -893.6491954264297, -496.6987444720876, -124.9000792949723, -322.9071373366954, -953.0801701588581, -1380.5276905852254, -465.8551670706993, -243.13477991873933, -1184.7010782570962, -1053.2898144886774, -248.78926892127703, -541.1828414066189, -349.00474083094576, -307.26455017597465, -969.9042059124296, -752.8557834706842, -514.8055409762515, -269.1466902857012, -312.69039927918266, -359.5777786985728, -937.3878952037655, -82.89055756408246, -671.6768168967104, -6.39531507890033, -208.9572037545972, -119.76556940626105, -1044.6222387108085, -347.1839500008516, -1004.0668665348917, -487.91102794505986, -61.29809072450465, -85.24019271270456, -1186.85789354346, -860.6549931577063, -646.88962683448, -892.9656972999215, -216.7201156842978, -419.2270366098028, -47.167081303318064, -886.1055959782062, -1254.2243204865506, -482.9376779061458, -85.59135349519738, -373.0033675774961, -1044.7098727858208, -447.4622407712069, -948.8150034371702, -101.18906709348664, -950.7805694434187, -196.87527587184977, -508.9458077750746, -369.0749992162595, -1326.9528628379683, -170.82124133826196, -582.2313078307776, -1067.8313948234747, -54.19445007692376, -364.1080664789847, -411.978229839494, -172.1443931529042, -252.73235815325455, -813.4219299817208, -110.98677106406741, -255.81033670285254, -968.4824725666788, -235.77158245580605, -503.5630583497171, -74.40020049348557, -81.2921907345248, -717.9442435495985, -181.35488744003558, -607.3800127812108, -1020.0397008107318, -127.11674653483095, -666.8629659223873, -1075.624751007064, -224.09647612520354, -301.2629948170721, -1416.2430288070634, -308.0417010553613, -361.35421049945984, -435.04702313172777, -114.5685823070244, -1320.644725913042, -1078.4721180177216, -14.261480948034734, -315.1802375475006, -226.2761023404679, -63.846975966679786, -559.9532260680768, -1058.2651465566455, -132.82636893836712, -775.3584755331918, -19.707469531987606, -938.9034994241493]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5578969851091213, "mean_inference_ms": 1.7094789134017514, "mean_action_processing_ms": 0.2730492957816383, "mean_env_wait_ms": 3.4114313616146363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01230168342590332, "StateBufferConnector_ms": 0.008293628692626953, "ViewRequirementAgentConnector_ms": 0.20314526557922363}, "num_episodes": 38, "episode_return_max": -6.39531507890033, "episode_return_min": -1416.2430288070634, "episode_return_mean": -529.3112927035141, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 431.2906779996514, "num_env_steps_trained_throughput_per_sec": 431.2906779996514, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 11542.655, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11542.579, "sample_time_ms": 1121.061, "learn_time_ms": 10358.379, "learn_throughput": 386.161, "synch_weights_time_ms": 62.311}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "training_iteration": 43, "trial_id": "4b94b_00000", "date": "2024-08-05_11-48-32", "timestamp": 1722838712, "time_this_iter_s": 9.286142349243164, "time_total_s": 515.7061953544617, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1110a2830>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 515.7061953544617, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 20.730769230769226, "ram_util_percent": 29.2076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 98.12739112973213, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.0525644420025249, "policy_loss": -0.004742658867326099, "vf_loss": 1.0585754317852358, "vf_explained_var": 0.9970385324209928, "kl": 0.011486295075004212, "entropy": 1.4119046370188395, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": -2.3677036773660447, "episode_reward_min": -1479.544518228056, "episode_reward_mean": -475.9839140574144, "episode_len_mean": 110.31, "episode_media": {}, "episodes_timesteps_total": 11031, "policy_reward_min": {"policy_0": -1479.544518228056}, "policy_reward_max": {"policy_0": -2.3677036773660447}, "policy_reward_mean": {"policy_0": -475.9839140574144}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-216.7201156842978, -419.2270366098028, -47.167081303318064, -886.1055959782062, -1254.2243204865506, -482.9376779061458, -85.59135349519738, -373.0033675774961, -1044.7098727858208, -447.4622407712069, -948.8150034371702, -101.18906709348664, -950.7805694434187, -196.87527587184977, -508.9458077750746, -369.0749992162595, -1326.9528628379683, -170.82124133826196, -582.2313078307776, -1067.8313948234747, -54.19445007692376, -364.1080664789847, -411.978229839494, -172.1443931529042, -252.73235815325455, -813.4219299817208, -110.98677106406741, -255.81033670285254, -968.4824725666788, -235.77158245580605, -503.5630583497171, -74.40020049348557, -81.2921907345248, -717.9442435495985, -181.35488744003558, -607.3800127812108, -1020.0397008107318, -127.11674653483095, -666.8629659223873, -1075.624751007064, -224.09647612520354, -301.2629948170721, -1416.2430288070634, -308.0417010553613, -361.35421049945984, -435.04702313172777, -114.5685823070244, -1320.644725913042, -1078.4721180177216, -14.261480948034734, -315.1802375475006, -226.2761023404679, -63.846975966679786, -559.9532260680768, -1058.2651465566455, -132.82636893836712, -775.3584755331918, -19.707469531987606, -938.9034994241493, -1305.3058231601444, -877.9220843633847, -397.6225238845144, -1000.069816391888, -130.4569252741757, -432.60919010956985, -82.11991329737398, -1398.4681707132245, -205.09291845446853, -57.12631043147219, -241.9839365518394, -297.63846970501305, -1003.8854696358522, -576.6378009239252, -24.543802514990322, -223.72171079705575, -140.4049677755065, -26.558757254601012, -121.70871719760254, -777.4923770430973, -122.2407422851946, -2.3677036773660447, -180.67252979843786, -195.77474263668017, -237.38516719469732, -268.378665340468, -24.318597195703212, -864.7534030364299, -320.2972080070794, -65.19830275451316, -33.89165208104799, -381.3389090682742, -107.4414726763547, -700.6962140909816, -462.64201696655937, -1242.0913041104723, -25.32541479258809, -89.02134213390815, -822.0664200255394, -811.3900102705544, -1479.544518228056], "episode_lengths": [88, 150, 63, 146, 150, 105, 77, 84, 150, 150, 150, 50, 150, 80, 127, 90, 150, 83, 150, 150, 76, 150, 118, 61, 103, 150, 67, 150, 150, 150, 112, 63, 62, 150, 106, 150, 150, 126, 150, 150, 85, 76, 150, 125, 96, 150, 52, 150, 150, 38, 111, 80, 69, 150, 150, 76, 150, 49, 150, 150, 150, 140, 150, 68, 130, 69, 150, 82, 57, 105, 96, 150, 114, 56, 67, 66, 46, 71, 150, 67, 32, 59, 107, 88, 77, 50, 150, 150, 58, 39, 125, 150, 150, 150, 150, 45, 73, 150, 150, 150], "policy_policy_0_reward": [-216.7201156842978, -419.2270366098028, -47.167081303318064, -886.1055959782062, -1254.2243204865506, -482.9376779061458, -85.59135349519738, -373.0033675774961, -1044.7098727858208, -447.4622407712069, -948.8150034371702, -101.18906709348664, -950.7805694434187, -196.87527587184977, -508.9458077750746, -369.0749992162595, -1326.9528628379683, -170.82124133826196, -582.2313078307776, -1067.8313948234747, -54.19445007692376, -364.1080664789847, -411.978229839494, -172.1443931529042, -252.73235815325455, -813.4219299817208, -110.98677106406741, -255.81033670285254, -968.4824725666788, -235.77158245580605, -503.5630583497171, -74.40020049348557, -81.2921907345248, -717.9442435495985, -181.35488744003558, -607.3800127812108, -1020.0397008107318, -127.11674653483095, -666.8629659223873, -1075.624751007064, -224.09647612520354, -301.2629948170721, -1416.2430288070634, -308.0417010553613, -361.35421049945984, -435.04702313172777, -114.5685823070244, -1320.644725913042, -1078.4721180177216, -14.261480948034734, -315.1802375475006, -226.2761023404679, -63.846975966679786, -559.9532260680768, -1058.2651465566455, -132.82636893836712, -775.3584755331918, -19.707469531987606, -938.9034994241493, -1305.3058231601444, -877.9220843633847, -397.6225238845144, -1000.069816391888, -130.4569252741757, -432.60919010956985, -82.11991329737398, -1398.4681707132245, -205.09291845446853, -57.12631043147219, -241.9839365518394, -297.63846970501305, -1003.8854696358522, -576.6378009239252, -24.543802514990322, -223.72171079705575, -140.4049677755065, -26.558757254601012, -121.70871719760254, -777.4923770430973, -122.2407422851946, -2.3677036773660447, -180.67252979843786, -195.77474263668017, -237.38516719469732, -268.378665340468, -24.318597195703212, -864.7534030364299, -320.2972080070794, -65.19830275451316, -33.89165208104799, -381.3389090682742, -107.4414726763547, -700.6962140909816, -462.64201696655937, -1242.0913041104723, -25.32541479258809, -89.02134213390815, -822.0664200255394, -811.3900102705544, -1479.544518228056]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5577412320569515, "mean_inference_ms": 1.7087051013004169, "mean_action_processing_ms": 0.2732698829715127, "mean_env_wait_ms": 3.4124578109111408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012035846710205078, "StateBufferConnector_ms": 0.008334159851074219, "ViewRequirementAgentConnector_ms": 0.1979074478149414}, "num_episodes": 41, "episode_return_max": -2.3677036773660447, "episode_return_min": -1479.544518228056, "episode_return_mean": -475.9839140574144, "episodes_this_iter": 41}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.3842796972449, "num_env_steps_trained_throughput_per_sec": 318.3842796972449, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 11539.185, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11539.11, "sample_time_ms": 1121.585, "learn_time_ms": 10355.432, "learn_throughput": 386.271, "synch_weights_time_ms": 61.254}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 44, "trial_id": "4b94b_00000", "date": "2024-08-05_11-48-44", "timestamp": 1722838724, "time_this_iter_s": 12.57788896560669, "time_total_s": 528.2840843200684, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e111111630>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 528.2840843200684, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 18.083333333333332, "ram_util_percent": 29.216666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 100.07953893641631, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9890735585863392, "policy_loss": -0.002915015793890537, "vf_loss": 0.9932115575298667, "vf_explained_var": 0.994604845593373, "kl": 0.012633669281134064, "entropy": 1.3809035872419675, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "env_runners": {"episode_reward_max": -2.3677036773660447, "episode_reward_min": -1479.544518228056, "episode_reward_mean": -447.6772139220695, "episode_len_mean": 108.27, "episode_media": {}, "episodes_timesteps_total": 10827, "policy_reward_min": {"policy_0": -1479.544518228056}, "policy_reward_max": {"policy_0": -2.3677036773660447}, "policy_reward_mean": {"policy_0": -447.6772139220695}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-74.40020049348557, -81.2921907345248, -717.9442435495985, -181.35488744003558, -607.3800127812108, -1020.0397008107318, -127.11674653483095, -666.8629659223873, -1075.624751007064, -224.09647612520354, -301.2629948170721, -1416.2430288070634, -308.0417010553613, -361.35421049945984, -435.04702313172777, -114.5685823070244, -1320.644725913042, -1078.4721180177216, -14.261480948034734, -315.1802375475006, -226.2761023404679, -63.846975966679786, -559.9532260680768, -1058.2651465566455, -132.82636893836712, -775.3584755331918, -19.707469531987606, -938.9034994241493, -1305.3058231601444, -877.9220843633847, -397.6225238845144, -1000.069816391888, -130.4569252741757, -432.60919010956985, -82.11991329737398, -1398.4681707132245, -205.09291845446853, -57.12631043147219, -241.9839365518394, -297.63846970501305, -1003.8854696358522, -576.6378009239252, -24.543802514990322, -223.72171079705575, -140.4049677755065, -26.558757254601012, -121.70871719760254, -777.4923770430973, -122.2407422851946, -2.3677036773660447, -180.67252979843786, -195.77474263668017, -237.38516719469732, -268.378665340468, -24.318597195703212, -864.7534030364299, -320.2972080070794, -65.19830275451316, -33.89165208104799, -381.3389090682742, -107.4414726763547, -700.6962140909816, -462.64201696655937, -1242.0913041104723, -25.32541479258809, -89.02134213390815, -822.0664200255394, -811.3900102705544, -1479.544518228056, -459.75750258423864, -144.45915852263497, -862.9002881672892, -643.0708698854447, -538.8002577223215, -300.5890696237008, -1072.432837076961, -1207.3193064170266, -866.4322528093078, -115.81959829739529, -862.1598742379696, -301.6405042370695, -36.53248063047314, -817.6887711968513, -323.9500065143589, -110.47748288521082, -172.73111531833763, -124.69683667541825, -64.96774361468644, -83.1465518129765, -478.52845160338296, -96.64412110588214, -299.1668488443839, -143.96021162261414, -155.0137503096869, -560.5332408726805, -35.51888309140322, -617.1070330682131, -315.48543527758716, -39.67589676717782, -941.9834467610146], "episode_lengths": [63, 62, 150, 106, 150, 150, 126, 150, 150, 85, 76, 150, 125, 96, 150, 52, 150, 150, 38, 111, 80, 69, 150, 150, 76, 150, 49, 150, 150, 150, 140, 150, 68, 130, 69, 150, 82, 57, 105, 96, 150, 114, 56, 67, 66, 46, 71, 150, 67, 32, 59, 107, 88, 77, 50, 150, 150, 58, 39, 125, 150, 150, 150, 150, 45, 73, 150, 150, 150, 150, 70, 150, 150, 104, 121, 150, 150, 150, 103, 150, 123, 42, 150, 119, 76, 65, 114, 62, 150, 150, 59, 96, 76, 60, 150, 54, 150, 83, 49, 150], "policy_policy_0_reward": [-74.40020049348557, -81.2921907345248, -717.9442435495985, -181.35488744003558, -607.3800127812108, -1020.0397008107318, -127.11674653483095, -666.8629659223873, -1075.624751007064, -224.09647612520354, -301.2629948170721, -1416.2430288070634, -308.0417010553613, -361.35421049945984, -435.04702313172777, -114.5685823070244, -1320.644725913042, -1078.4721180177216, -14.261480948034734, -315.1802375475006, -226.2761023404679, -63.846975966679786, -559.9532260680768, -1058.2651465566455, -132.82636893836712, -775.3584755331918, -19.707469531987606, -938.9034994241493, -1305.3058231601444, -877.9220843633847, -397.6225238845144, -1000.069816391888, -130.4569252741757, -432.60919010956985, -82.11991329737398, -1398.4681707132245, -205.09291845446853, -57.12631043147219, -241.9839365518394, -297.63846970501305, -1003.8854696358522, -576.6378009239252, -24.543802514990322, -223.72171079705575, -140.4049677755065, -26.558757254601012, -121.70871719760254, -777.4923770430973, -122.2407422851946, -2.3677036773660447, -180.67252979843786, -195.77474263668017, -237.38516719469732, -268.378665340468, -24.318597195703212, -864.7534030364299, -320.2972080070794, -65.19830275451316, -33.89165208104799, -381.3389090682742, -107.4414726763547, -700.6962140909816, -462.64201696655937, -1242.0913041104723, -25.32541479258809, -89.02134213390815, -822.0664200255394, -811.3900102705544, -1479.544518228056, -459.75750258423864, -144.45915852263497, -862.9002881672892, -643.0708698854447, -538.8002577223215, -300.5890696237008, -1072.432837076961, -1207.3193064170266, -866.4322528093078, -115.81959829739529, -862.1598742379696, -301.6405042370695, -36.53248063047314, -817.6887711968513, -323.9500065143589, -110.47748288521082, -172.73111531833763, -124.69683667541825, -64.96774361468644, -83.1465518129765, -478.52845160338296, -96.64412110588214, -299.1668488443839, -143.96021162261414, -155.0137503096869, -560.5332408726805, -35.51888309140322, -617.1070330682131, -315.48543527758716, -39.67589676717782, -941.9834467610146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5588544408398665, "mean_inference_ms": 1.7076321962592598, "mean_action_processing_ms": 0.27315385207923104, "mean_env_wait_ms": 3.4121895769183017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01173710823059082, "StateBufferConnector_ms": 0.008031845092773438, "ViewRequirementAgentConnector_ms": 0.19650745391845703}, "num_episodes": 31, "episode_return_max": -2.3677036773660447, "episode_return_min": -1479.544518228056, "episode_return_mean": -447.6772139220695, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.31584661090517, "num_env_steps_trained_throughput_per_sec": 316.31584661090517, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 11527.084, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11527.009, "sample_time_ms": 1121.53, "learn_time_ms": 10342.932, "learn_throughput": 386.738, "synch_weights_time_ms": 61.717}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "training_iteration": 45, "trial_id": "4b94b_00000", "date": "2024-08-05_11-48-57", "timestamp": 1722838737, "time_this_iter_s": 12.657915115356445, "time_total_s": 540.9419994354248, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e111110700>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 540.9419994354248, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 17.972222222222218, "ram_util_percent": 29.216666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 90.9658620506525, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.1363598114500444, "policy_loss": -0.003171423894915885, "vf_loss": 1.140828653673331, "vf_explained_var": 0.9926918165137371, "kl": 0.010654591983014446, "entropy": 1.4305999216934044, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "env_runners": {"episode_reward_max": -2.3677036773660447, "episode_reward_min": -1479.544518228056, "episode_reward_mean": -410.10305402648584, "episode_len_mean": 107.65, "episode_media": {}, "episodes_timesteps_total": 10765, "policy_reward_min": {"policy_0": -1479.544518228056}, "policy_reward_max": {"policy_0": -2.3677036773660447}, "policy_reward_mean": {"policy_0": -410.10305402648584}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-57.12631043147219, -241.9839365518394, -297.63846970501305, -1003.8854696358522, -576.6378009239252, -24.543802514990322, -223.72171079705575, -140.4049677755065, -26.558757254601012, -121.70871719760254, -777.4923770430973, -122.2407422851946, -2.3677036773660447, -180.67252979843786, -195.77474263668017, -237.38516719469732, -268.378665340468, -24.318597195703212, -864.7534030364299, -320.2972080070794, -65.19830275451316, -33.89165208104799, -381.3389090682742, -107.4414726763547, -700.6962140909816, -462.64201696655937, -1242.0913041104723, -25.32541479258809, -89.02134213390815, -822.0664200255394, -811.3900102705544, -1479.544518228056, -459.75750258423864, -144.45915852263497, -862.9002881672892, -643.0708698854447, -538.8002577223215, -300.5890696237008, -1072.432837076961, -1207.3193064170266, -866.4322528093078, -115.81959829739529, -862.1598742379696, -301.6405042370695, -36.53248063047314, -817.6887711968513, -323.9500065143589, -110.47748288521082, -172.73111531833763, -124.69683667541825, -64.96774361468644, -83.1465518129765, -478.52845160338296, -96.64412110588214, -299.1668488443839, -143.96021162261414, -155.0137503096869, -560.5332408726805, -35.51888309140322, -617.1070330682131, -315.48543527758716, -39.67589676717782, -941.9834467610146, -545.745363740366, -233.30623392183435, -251.75246971946004, -166.15252825753578, -1057.3372968518972, -55.35003797022921, -367.8242157447591, -75.10615321547574, -711.3014706569651, -74.41870004870538, -676.1341484288362, -394.55413888932, -113.02890402959804, -1342.0581197688437, -1348.9866798618525, -493.7245589115087, -813.5235790118993, -138.56821424860607, -216.3570607110541, -335.2659049275922, -224.17713251455228, -124.83076387668606, -1138.4751158407273, -194.51284761132658, -946.9858024048431, -269.6276933355797, -251.15482340849593, -799.7615541769785, -461.65129701468777, -79.64890619487122, -279.6455786476044, -613.5737240796569, -304.3274495740772, -327.16709421495455, -232.94716743884533, -522.9987714834988, -106.59541815928712], "episode_lengths": [57, 105, 96, 150, 114, 56, 67, 66, 46, 71, 150, 67, 32, 59, 107, 88, 77, 50, 150, 150, 58, 39, 125, 150, 150, 150, 150, 45, 73, 150, 150, 150, 150, 70, 150, 150, 104, 121, 150, 150, 150, 103, 150, 123, 42, 150, 119, 76, 65, 114, 62, 150, 150, 59, 96, 76, 60, 150, 54, 150, 83, 49, 150, 150, 119, 112, 60, 150, 66, 121, 41, 150, 63, 150, 150, 76, 150, 150, 104, 150, 67, 150, 150, 65, 79, 150, 72, 150, 103, 114, 150, 117, 72, 82, 150, 130, 131, 100, 150, 47], "policy_policy_0_reward": [-57.12631043147219, -241.9839365518394, -297.63846970501305, -1003.8854696358522, -576.6378009239252, -24.543802514990322, -223.72171079705575, -140.4049677755065, -26.558757254601012, -121.70871719760254, -777.4923770430973, -122.2407422851946, -2.3677036773660447, -180.67252979843786, -195.77474263668017, -237.38516719469732, -268.378665340468, -24.318597195703212, -864.7534030364299, -320.2972080070794, -65.19830275451316, -33.89165208104799, -381.3389090682742, -107.4414726763547, -700.6962140909816, -462.64201696655937, -1242.0913041104723, -25.32541479258809, -89.02134213390815, -822.0664200255394, -811.3900102705544, -1479.544518228056, -459.75750258423864, -144.45915852263497, -862.9002881672892, -643.0708698854447, -538.8002577223215, -300.5890696237008, -1072.432837076961, -1207.3193064170266, -866.4322528093078, -115.81959829739529, -862.1598742379696, -301.6405042370695, -36.53248063047314, -817.6887711968513, -323.9500065143589, -110.47748288521082, -172.73111531833763, -124.69683667541825, -64.96774361468644, -83.1465518129765, -478.52845160338296, -96.64412110588214, -299.1668488443839, -143.96021162261414, -155.0137503096869, -560.5332408726805, -35.51888309140322, -617.1070330682131, -315.48543527758716, -39.67589676717782, -941.9834467610146, -545.745363740366, -233.30623392183435, -251.75246971946004, -166.15252825753578, -1057.3372968518972, -55.35003797022921, -367.8242157447591, -75.10615321547574, -711.3014706569651, -74.41870004870538, -676.1341484288362, -394.55413888932, -113.02890402959804, -1342.0581197688437, -1348.9866798618525, -493.7245589115087, -813.5235790118993, -138.56821424860607, -216.3570607110541, -335.2659049275922, -224.17713251455228, -124.83076387668606, -1138.4751158407273, -194.51284761132658, -946.9858024048431, -269.6276933355797, -251.15482340849593, -799.7615541769785, -461.65129701468777, -79.64890619487122, -279.6455786476044, -613.5737240796569, -304.3274495740772, -327.16709421495455, -232.94716743884533, -522.9987714834988, -106.59541815928712]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5584475753826703, "mean_inference_ms": 1.7058637831469445, "mean_action_processing_ms": 0.2731335587550731, "mean_env_wait_ms": 3.4132106340163504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01238703727722168, "StateBufferConnector_ms": 0.007909774780273438, "ViewRequirementAgentConnector_ms": 0.1900951862335205}, "num_episodes": 37, "episode_return_max": -2.3677036773660447, "episode_return_min": -1479.544518228056, "episode_return_mean": -410.10305402648584, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.1120020783639, "num_env_steps_trained_throughput_per_sec": 320.1120020783639, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 11649.323, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11649.249, "sample_time_ms": 1119.356, "learn_time_ms": 10468.63, "learn_throughput": 382.094, "synch_weights_time_ms": 60.434}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "training_iteration": 46, "trial_id": "4b94b_00000", "date": "2024-08-05_11-49-09", "timestamp": 1722838749, "time_this_iter_s": 12.508642673492432, "time_total_s": 553.4506421089172, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e111112050>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 553.4506421089172, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 18.094444444444445, "ram_util_percent": 29.200000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 112.96507201492787, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.8357019348846128, "policy_loss": -0.0030406443101431554, "vf_loss": 0.8400767248434325, "vf_explained_var": 0.998803538394471, "kl": 0.010931449705822186, "entropy": 1.4707873969028393, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "env_runners": {"episode_reward_max": -35.51888309140322, "episode_reward_min": -1529.2262631418741, "episode_reward_mean": -495.6203795603129, "episode_len_mean": 115.44, "episode_media": {}, "episodes_timesteps_total": 11544, "policy_reward_min": {"policy_0": -1529.2262631418741}, "policy_reward_max": {"policy_0": -35.51888309140322}, "policy_reward_mean": {"policy_0": -495.6203795603129}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-144.45915852263497, -862.9002881672892, -643.0708698854447, -538.8002577223215, -300.5890696237008, -1072.432837076961, -1207.3193064170266, -866.4322528093078, -115.81959829739529, -862.1598742379696, -301.6405042370695, -36.53248063047314, -817.6887711968513, -323.9500065143589, -110.47748288521082, -172.73111531833763, -124.69683667541825, -64.96774361468644, -83.1465518129765, -478.52845160338296, -96.64412110588214, -299.1668488443839, -143.96021162261414, -155.0137503096869, -560.5332408726805, -35.51888309140322, -617.1070330682131, -315.48543527758716, -39.67589676717782, -941.9834467610146, -545.745363740366, -233.30623392183435, -251.75246971946004, -166.15252825753578, -1057.3372968518972, -55.35003797022921, -367.8242157447591, -75.10615321547574, -711.3014706569651, -74.41870004870538, -676.1341484288362, -394.55413888932, -113.02890402959804, -1342.0581197688437, -1348.9866798618525, -493.7245589115087, -813.5235790118993, -138.56821424860607, -216.3570607110541, -335.2659049275922, -224.17713251455228, -124.83076387668606, -1138.4751158407273, -194.51284761132658, -946.9858024048431, -269.6276933355797, -251.15482340849593, -799.7615541769785, -461.65129701468777, -79.64890619487122, -279.6455786476044, -613.5737240796569, -304.3274495740772, -327.16709421495455, -232.94716743884533, -522.9987714834988, -106.59541815928712, -996.9823445875592, -879.7762422619412, -213.62846232125756, -799.4479485243138, -876.1133434971027, -1103.0748951670005, -138.59760251818034, -1012.6935374793641, -1267.7540908775509, -1529.2262631418741, -938.927018298311, -1211.0629627573821, -685.2615724946869, -61.136070959415754, -261.1946605516904, -740.8635765810113, -51.989579812556244, -304.2955767363611, -400.7840139072805, -65.89042196117155, -551.7874054891241, -134.52461201777172, -754.0296844083373, -796.9133995464762, -699.7725388929766, -70.04288207048299, -577.3684339739344, -381.39652019339314, -144.5594781680495, -1296.550459857038, -715.9051922914537, -1073.196077557768, -205.28184326600626], "episode_lengths": [70, 150, 150, 104, 121, 150, 150, 150, 103, 150, 123, 42, 150, 119, 76, 65, 114, 62, 150, 150, 59, 96, 76, 60, 150, 54, 150, 83, 49, 150, 150, 119, 112, 60, 150, 66, 121, 41, 150, 63, 150, 150, 76, 150, 150, 104, 150, 67, 150, 150, 65, 79, 150, 72, 150, 103, 114, 150, 117, 72, 82, 150, 130, 131, 100, 150, 47, 150, 150, 68, 150, 150, 150, 89, 150, 150, 150, 150, 150, 150, 61, 89, 150, 58, 122, 150, 52, 150, 66, 150, 150, 150, 65, 150, 128, 62, 150, 150, 150, 67], "policy_policy_0_reward": [-144.45915852263497, -862.9002881672892, -643.0708698854447, -538.8002577223215, -300.5890696237008, -1072.432837076961, -1207.3193064170266, -866.4322528093078, -115.81959829739529, -862.1598742379696, -301.6405042370695, -36.53248063047314, -817.6887711968513, -323.9500065143589, -110.47748288521082, -172.73111531833763, -124.69683667541825, -64.96774361468644, -83.1465518129765, -478.52845160338296, -96.64412110588214, -299.1668488443839, -143.96021162261414, -155.0137503096869, -560.5332408726805, -35.51888309140322, -617.1070330682131, -315.48543527758716, -39.67589676717782, -941.9834467610146, -545.745363740366, -233.30623392183435, -251.75246971946004, -166.15252825753578, -1057.3372968518972, -55.35003797022921, -367.8242157447591, -75.10615321547574, -711.3014706569651, -74.41870004870538, -676.1341484288362, -394.55413888932, -113.02890402959804, -1342.0581197688437, -1348.9866798618525, -493.7245589115087, -813.5235790118993, -138.56821424860607, -216.3570607110541, -335.2659049275922, -224.17713251455228, -124.83076387668606, -1138.4751158407273, -194.51284761132658, -946.9858024048431, -269.6276933355797, -251.15482340849593, -799.7615541769785, -461.65129701468777, -79.64890619487122, -279.6455786476044, -613.5737240796569, -304.3274495740772, -327.16709421495455, -232.94716743884533, -522.9987714834988, -106.59541815928712, -996.9823445875592, -879.7762422619412, -213.62846232125756, -799.4479485243138, -876.1133434971027, -1103.0748951670005, -138.59760251818034, -1012.6935374793641, -1267.7540908775509, -1529.2262631418741, -938.927018298311, -1211.0629627573821, -685.2615724946869, -61.136070959415754, -261.1946605516904, -740.8635765810113, -51.989579812556244, -304.2955767363611, -400.7840139072805, -65.89042196117155, -551.7874054891241, -134.52461201777172, -754.0296844083373, -796.9133995464762, -699.7725388929766, -70.04288207048299, -577.3684339739344, -381.39652019339314, -144.5594781680495, -1296.550459857038, -715.9051922914537, -1073.196077557768, -205.28184326600626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5587215283456437, "mean_inference_ms": 1.704307543789478, "mean_action_processing_ms": 0.27309446718882313, "mean_env_wait_ms": 3.4117390393815854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012583494186401367, "StateBufferConnector_ms": 0.008619308471679688, "ViewRequirementAgentConnector_ms": 0.197035551071167}, "num_episodes": 33, "episode_return_max": -35.51888309140322, "episode_return_min": -1529.2262631418741, "episode_return_mean": -495.6203795603129, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.7547971253503, "num_env_steps_trained_throughput_per_sec": 314.7547971253503, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 11645.833, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11645.762, "sample_time_ms": 1116.451, "learn_time_ms": 10468.274, "learn_throughput": 382.107, "synch_weights_time_ms": 60.214}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "training_iteration": 47, "trial_id": "4b94b_00000", "date": "2024-08-05_11-49-22", "timestamp": 1722838762, "time_this_iter_s": 12.719780445098877, "time_total_s": 566.1704225540161, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1110a2830>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 566.1704225540161, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 17.772222222222222, "ram_util_percent": 29.200000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 83.75557666917642, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9527666386837761, "policy_loss": -0.006358061858918518, "vf_loss": 0.9604707765082519, "vf_explained_var": 0.9911666275312503, "kl": 0.009887756291997625, "entropy": 1.4696753270924092, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": -7.057862973604789, "episode_reward_min": -1529.2262631418741, "episode_reward_mean": -532.5544524603318, "episode_len_mean": 117.45, "episode_media": {}, "episodes_timesteps_total": 11745, "policy_reward_min": {"policy_0": -1529.2262631418741}, "policy_reward_max": {"policy_0": -7.057862973604789}, "policy_reward_mean": {"policy_0": -532.5544524603318}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-367.8242157447591, -75.10615321547574, -711.3014706569651, -74.41870004870538, -676.1341484288362, -394.55413888932, -113.02890402959804, -1342.0581197688437, -1348.9866798618525, -493.7245589115087, -813.5235790118993, -138.56821424860607, -216.3570607110541, -335.2659049275922, -224.17713251455228, -124.83076387668606, -1138.4751158407273, -194.51284761132658, -946.9858024048431, -269.6276933355797, -251.15482340849593, -799.7615541769785, -461.65129701468777, -79.64890619487122, -279.6455786476044, -613.5737240796569, -304.3274495740772, -327.16709421495455, -232.94716743884533, -522.9987714834988, -106.59541815928712, -996.9823445875592, -879.7762422619412, -213.62846232125756, -799.4479485243138, -876.1133434971027, -1103.0748951670005, -138.59760251818034, -1012.6935374793641, -1267.7540908775509, -1529.2262631418741, -938.927018298311, -1211.0629627573821, -685.2615724946869, -61.136070959415754, -261.1946605516904, -740.8635765810113, -51.989579812556244, -304.2955767363611, -400.7840139072805, -65.89042196117155, -551.7874054891241, -134.52461201777172, -754.0296844083373, -796.9133995464762, -699.7725388929766, -70.04288207048299, -577.3684339739344, -381.39652019339314, -144.5594781680495, -1296.550459857038, -715.9051922914537, -1073.196077557768, -205.28184326600626, -466.79051045537165, -269.1159149425062, -164.23630184617016, -200.6450683367367, -1457.1198861568694, -136.87978003671438, -876.1882351537464, -1246.1413452498505, -301.8494419154097, -78.8796002094614, -425.56232834820224, -556.4823096754768, -945.01458722364, -284.6865521062309, -32.035694347081396, -394.40540861127, -68.79342134965411, -1003.7900708037537, -616.6159554478537, -376.9664758586104, -7.057862973604789, -852.656713055015, -1217.2005594660543, -901.5901735871802, -1082.9950591560903, -88.93810567259784, -767.0985872422476, -493.0958356663292, -238.98588974065675, -30.000392091941304, -407.7523156453528, -349.38595404597515, -537.4798858693242, -482.6873050572714, -760.2671591211276, -217.09285896729673], "episode_lengths": [121, 41, 150, 63, 150, 150, 76, 150, 150, 104, 150, 67, 150, 150, 65, 79, 150, 72, 150, 103, 114, 150, 117, 72, 82, 150, 130, 131, 100, 150, 47, 150, 150, 68, 150, 150, 150, 89, 150, 150, 150, 150, 150, 150, 61, 89, 150, 58, 122, 150, 52, 150, 66, 150, 150, 150, 65, 150, 128, 62, 150, 150, 150, 67, 138, 82, 59, 75, 150, 72, 150, 150, 86, 69, 94, 150, 150, 150, 39, 120, 45, 150, 150, 100, 42, 150, 150, 150, 150, 77, 150, 150, 97, 51, 96, 150, 150, 150, 146, 96], "policy_policy_0_reward": [-367.8242157447591, -75.10615321547574, -711.3014706569651, -74.41870004870538, -676.1341484288362, -394.55413888932, -113.02890402959804, -1342.0581197688437, -1348.9866798618525, -493.7245589115087, -813.5235790118993, -138.56821424860607, -216.3570607110541, -335.2659049275922, -224.17713251455228, -124.83076387668606, -1138.4751158407273, -194.51284761132658, -946.9858024048431, -269.6276933355797, -251.15482340849593, -799.7615541769785, -461.65129701468777, -79.64890619487122, -279.6455786476044, -613.5737240796569, -304.3274495740772, -327.16709421495455, -232.94716743884533, -522.9987714834988, -106.59541815928712, -996.9823445875592, -879.7762422619412, -213.62846232125756, -799.4479485243138, -876.1133434971027, -1103.0748951670005, -138.59760251818034, -1012.6935374793641, -1267.7540908775509, -1529.2262631418741, -938.927018298311, -1211.0629627573821, -685.2615724946869, -61.136070959415754, -261.1946605516904, -740.8635765810113, -51.989579812556244, -304.2955767363611, -400.7840139072805, -65.89042196117155, -551.7874054891241, -134.52461201777172, -754.0296844083373, -796.9133995464762, -699.7725388929766, -70.04288207048299, -577.3684339739344, -381.39652019339314, -144.5594781680495, -1296.550459857038, -715.9051922914537, -1073.196077557768, -205.28184326600626, -466.79051045537165, -269.1159149425062, -164.23630184617016, -200.6450683367367, -1457.1198861568694, -136.87978003671438, -876.1882351537464, -1246.1413452498505, -301.8494419154097, -78.8796002094614, -425.56232834820224, -556.4823096754768, -945.01458722364, -284.6865521062309, -32.035694347081396, -394.40540861127, -68.79342134965411, -1003.7900708037537, -616.6159554478537, -376.9664758586104, -7.057862973604789, -852.656713055015, -1217.2005594660543, -901.5901735871802, -1082.9950591560903, -88.93810567259784, -767.0985872422476, -493.0958356663292, -238.98588974065675, -30.000392091941304, -407.7523156453528, -349.38595404597515, -537.4798858693242, -482.6873050572714, -760.2671591211276, -217.09285896729673]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5596881383619011, "mean_inference_ms": 1.7025481232926187, "mean_action_processing_ms": 0.2729390782837998, "mean_env_wait_ms": 3.414131325731648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012464046478271484, "StateBufferConnector_ms": 0.008661508560180664, "ViewRequirementAgentConnector_ms": 0.1976029872894287}, "num_episodes": 36, "episode_return_max": -7.057862973604789, "episode_return_min": -1529.2262631418741, "episode_return_mean": -532.5544524603318, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.9701682004723, "num_env_steps_trained_throughput_per_sec": 326.9701682004723, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 11644.31, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11644.237, "sample_time_ms": 1120.321, "learn_time_ms": 10462.537, "learn_throughput": 382.316, "synch_weights_time_ms": 60.542}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 48, "trial_id": "4b94b_00000", "date": "2024-08-05_11-49-34", "timestamp": 1722838774, "time_this_iter_s": 12.245232582092285, "time_total_s": 578.4156551361084, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1110a3eb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 578.4156551361084, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 18.423529411764704, "ram_util_percent": 29.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 100.2041218633453, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9249354248245557, "policy_loss": -0.0012515283412843322, "vf_loss": 0.9273482983931899, "vf_explained_var": 0.9980827460065484, "kl": 0.016444415360668548, "entropy": 1.366901759803295, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "env_runners": {"episode_reward_max": -7.057862973604789, "episode_reward_min": -1529.2262631418741, "episode_reward_mean": -493.4355818440256, "episode_len_mean": 114.76, "episode_media": {}, "episodes_timesteps_total": 11476, "policy_reward_min": {"policy_0": -1529.2262631418741}, "policy_reward_max": {"policy_0": -7.057862973604789}, "policy_reward_mean": {"policy_0": -493.4355818440256}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1103.0748951670005, -138.59760251818034, -1012.6935374793641, -1267.7540908775509, -1529.2262631418741, -938.927018298311, -1211.0629627573821, -685.2615724946869, -61.136070959415754, -261.1946605516904, -740.8635765810113, -51.989579812556244, -304.2955767363611, -400.7840139072805, -65.89042196117155, -551.7874054891241, -134.52461201777172, -754.0296844083373, -796.9133995464762, -699.7725388929766, -70.04288207048299, -577.3684339739344, -381.39652019339314, -144.5594781680495, -1296.550459857038, -715.9051922914537, -1073.196077557768, -205.28184326600626, -466.79051045537165, -269.1159149425062, -164.23630184617016, -200.6450683367367, -1457.1198861568694, -136.87978003671438, -876.1882351537464, -1246.1413452498505, -301.8494419154097, -78.8796002094614, -425.56232834820224, -556.4823096754768, -945.01458722364, -284.6865521062309, -32.035694347081396, -394.40540861127, -68.79342134965411, -1003.7900708037537, -616.6159554478537, -376.9664758586104, -7.057862973604789, -852.656713055015, -1217.2005594660543, -901.5901735871802, -1082.9950591560903, -88.93810567259784, -767.0985872422476, -493.0958356663292, -238.98588974065675, -30.000392091941304, -407.7523156453528, -349.38595404597515, -537.4798858693242, -482.6873050572714, -760.2671591211276, -217.09285896729673, -601.3632253278145, -89.55996415856701, -77.28709403733893, -271.94131105614485, -42.724917826141386, -793.1302582346972, -160.0319670184837, -239.50880449551823, -802.9948462197995, -598.7785988168532, -35.1189608545769, -1266.9177817741636, -517.3429425589364, -207.81718435291114, -634.2803324047893, -534.6299374035552, -95.8133780569663, -188.56320018677403, -552.5474516739512, -96.79232233428044, -24.138928254663895, -407.64529773603635, -751.846333363007, -60.66740435236917, -328.44070923732085, -238.75846251067694, -1231.3947212431701, -551.0880543638116, -115.43193928206372, -606.178952988834, -326.2530565027067, -276.43705877232753, -508.03229322079227, -219.72244685820988, -82.91742443272443, -296.8967060822709], "episode_lengths": [150, 89, 150, 150, 150, 150, 150, 150, 61, 89, 150, 58, 122, 150, 52, 150, 66, 150, 150, 150, 65, 150, 128, 62, 150, 150, 150, 67, 138, 82, 59, 75, 150, 72, 150, 150, 86, 69, 94, 150, 150, 150, 39, 120, 45, 150, 150, 100, 42, 150, 150, 150, 150, 77, 150, 150, 97, 51, 96, 150, 150, 150, 146, 96, 150, 62, 57, 150, 57, 150, 81, 98, 150, 150, 46, 150, 150, 86, 150, 115, 75, 82, 150, 83, 53, 150, 150, 63, 113, 96, 150, 150, 74, 150, 92, 105, 133, 81, 76, 105], "policy_policy_0_reward": [-1103.0748951670005, -138.59760251818034, -1012.6935374793641, -1267.7540908775509, -1529.2262631418741, -938.927018298311, -1211.0629627573821, -685.2615724946869, -61.136070959415754, -261.1946605516904, -740.8635765810113, -51.989579812556244, -304.2955767363611, -400.7840139072805, -65.89042196117155, -551.7874054891241, -134.52461201777172, -754.0296844083373, -796.9133995464762, -699.7725388929766, -70.04288207048299, -577.3684339739344, -381.39652019339314, -144.5594781680495, -1296.550459857038, -715.9051922914537, -1073.196077557768, -205.28184326600626, -466.79051045537165, -269.1159149425062, -164.23630184617016, -200.6450683367367, -1457.1198861568694, -136.87978003671438, -876.1882351537464, -1246.1413452498505, -301.8494419154097, -78.8796002094614, -425.56232834820224, -556.4823096754768, -945.01458722364, -284.6865521062309, -32.035694347081396, -394.40540861127, -68.79342134965411, -1003.7900708037537, -616.6159554478537, -376.9664758586104, -7.057862973604789, -852.656713055015, -1217.2005594660543, -901.5901735871802, -1082.9950591560903, -88.93810567259784, -767.0985872422476, -493.0958356663292, -238.98588974065675, -30.000392091941304, -407.7523156453528, -349.38595404597515, -537.4798858693242, -482.6873050572714, -760.2671591211276, -217.09285896729673, -601.3632253278145, -89.55996415856701, -77.28709403733893, -271.94131105614485, -42.724917826141386, -793.1302582346972, -160.0319670184837, -239.50880449551823, -802.9948462197995, -598.7785988168532, -35.1189608545769, -1266.9177817741636, -517.3429425589364, -207.81718435291114, -634.2803324047893, -534.6299374035552, -95.8133780569663, -188.56320018677403, -552.5474516739512, -96.79232233428044, -24.138928254663895, -407.64529773603635, -751.846333363007, -60.66740435236917, -328.44070923732085, -238.75846251067694, -1231.3947212431701, -551.0880543638116, -115.43193928206372, -606.178952988834, -326.2530565027067, -276.43705877232753, -508.03229322079227, -219.72244685820988, -82.91742443272443, -296.8967060822709]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5598880904065097, "mean_inference_ms": 1.7018817248588898, "mean_action_processing_ms": 0.2729056231758075, "mean_env_wait_ms": 3.413165562689949, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012077569961547852, "StateBufferConnector_ms": 0.008078813552856445, "ViewRequirementAgentConnector_ms": 0.2004985809326172}, "num_episodes": 36, "episode_return_max": -7.057862973604789, "episode_return_min": -1529.2262631418741, "episode_return_mean": -493.4355818440256, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 329.08543261290174, "num_env_steps_trained_throughput_per_sec": 329.08543261290174, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 11674.395, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11674.323, "sample_time_ms": 1117.806, "learn_time_ms": 10493.767, "learn_throughput": 381.179, "synch_weights_time_ms": 61.909}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "training_iteration": 49, "trial_id": "4b94b_00000", "date": "2024-08-05_11-49-47", "timestamp": 1722838787, "time_this_iter_s": 12.167548179626465, "time_total_s": 590.5832033157349, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e11156be20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 590.5832033157349, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 17.916666666666668, "ram_util_percent": 29.216666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 102.42269073426723, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9403402423486114, "policy_loss": -0.00420320052896083, "vf_loss": 0.9457451849554975, "vf_explained_var": 0.9965203438575069, "kl": 0.011749265389759482, "entropy": 1.348606990277767, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": -2.2403750908804465, "episode_reward_min": -1439.437211571559, "episode_reward_mean": -441.0256061624599, "episode_len_mean": 111.5, "episode_media": {}, "episodes_timesteps_total": 11150, "policy_reward_min": {"policy_0": -1439.437211571559}, "policy_reward_max": {"policy_0": -2.2403750908804465}, "policy_reward_mean": {"policy_0": -441.0256061624599}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-876.1882351537464, -1246.1413452498505, -301.8494419154097, -78.8796002094614, -425.56232834820224, -556.4823096754768, -945.01458722364, -284.6865521062309, -32.035694347081396, -394.40540861127, -68.79342134965411, -1003.7900708037537, -616.6159554478537, -376.9664758586104, -7.057862973604789, -852.656713055015, -1217.2005594660543, -901.5901735871802, -1082.9950591560903, -88.93810567259784, -767.0985872422476, -493.0958356663292, -238.98588974065675, -30.000392091941304, -407.7523156453528, -349.38595404597515, -537.4798858693242, -482.6873050572714, -760.2671591211276, -217.09285896729673, -601.3632253278145, -89.55996415856701, -77.28709403733893, -271.94131105614485, -42.724917826141386, -793.1302582346972, -160.0319670184837, -239.50880449551823, -802.9948462197995, -598.7785988168532, -35.1189608545769, -1266.9177817741636, -517.3429425589364, -207.81718435291114, -634.2803324047893, -534.6299374035552, -95.8133780569663, -188.56320018677403, -552.5474516739512, -96.79232233428044, -24.138928254663895, -407.64529773603635, -751.846333363007, -60.66740435236917, -328.44070923732085, -238.75846251067694, -1231.3947212431701, -551.0880543638116, -115.43193928206372, -606.178952988834, -326.2530565027067, -276.43705877232753, -508.03229322079227, -219.72244685820988, -82.91742443272443, -296.8967060822709, -229.03873126790026, -1439.437211571559, -265.73491194243405, -218.16856962019432, -479.1126352657331, -798.389519017269, -599.1618818435015, -73.34045049488675, -220.46486923729663, -18.290429789599138, -47.37747162236116, -173.86774598468503, -46.62249183848995, -1248.0030090179566, -57.75423792468713, -791.1744189183075, -402.41248895497665, -841.9676152420049, -312.8991383889873, -1108.2062112572423, -31.227974528336336, -184.28837551357626, -785.3127093799626, -212.1779979160059, -2.2403750908804465, -7.368151771120283, -145.75787148922487, -703.4249199972874, -133.7403708295315, -991.6093854048597, -511.0110876661779, -137.93510685029835, -506.8899390516495, -903.4619599054388], "episode_lengths": [150, 150, 86, 69, 94, 150, 150, 150, 39, 120, 45, 150, 150, 100, 42, 150, 150, 150, 150, 77, 150, 150, 97, 51, 96, 150, 150, 150, 146, 96, 150, 62, 57, 150, 57, 150, 81, 98, 150, 150, 46, 150, 150, 86, 150, 115, 75, 82, 150, 83, 53, 150, 150, 63, 113, 96, 150, 150, 74, 150, 92, 105, 133, 81, 76, 105, 109, 150, 114, 109, 150, 150, 150, 58, 112, 34, 57, 59, 54, 150, 58, 147, 150, 150, 117, 150, 44, 90, 150, 84, 30, 43, 64, 150, 93, 150, 150, 83, 150, 150], "policy_policy_0_reward": [-876.1882351537464, -1246.1413452498505, -301.8494419154097, -78.8796002094614, -425.56232834820224, -556.4823096754768, -945.01458722364, -284.6865521062309, -32.035694347081396, -394.40540861127, -68.79342134965411, -1003.7900708037537, -616.6159554478537, -376.9664758586104, -7.057862973604789, -852.656713055015, -1217.2005594660543, -901.5901735871802, -1082.9950591560903, -88.93810567259784, -767.0985872422476, -493.0958356663292, -238.98588974065675, -30.000392091941304, -407.7523156453528, -349.38595404597515, -537.4798858693242, -482.6873050572714, -760.2671591211276, -217.09285896729673, -601.3632253278145, -89.55996415856701, -77.28709403733893, -271.94131105614485, -42.724917826141386, -793.1302582346972, -160.0319670184837, -239.50880449551823, -802.9948462197995, -598.7785988168532, -35.1189608545769, -1266.9177817741636, -517.3429425589364, -207.81718435291114, -634.2803324047893, -534.6299374035552, -95.8133780569663, -188.56320018677403, -552.5474516739512, -96.79232233428044, -24.138928254663895, -407.64529773603635, -751.846333363007, -60.66740435236917, -328.44070923732085, -238.75846251067694, -1231.3947212431701, -551.0880543638116, -115.43193928206372, -606.178952988834, -326.2530565027067, -276.43705877232753, -508.03229322079227, -219.72244685820988, -82.91742443272443, -296.8967060822709, -229.03873126790026, -1439.437211571559, -265.73491194243405, -218.16856962019432, -479.1126352657331, -798.389519017269, -599.1618818435015, -73.34045049488675, -220.46486923729663, -18.290429789599138, -47.37747162236116, -173.86774598468503, -46.62249183848995, -1248.0030090179566, -57.75423792468713, -791.1744189183075, -402.41248895497665, -841.9676152420049, -312.8991383889873, -1108.2062112572423, -31.227974528336336, -184.28837551357626, -785.3127093799626, -212.1779979160059, -2.2403750908804465, -7.368151771120283, -145.75787148922487, -703.4249199972874, -133.7403708295315, -991.6093854048597, -511.0110876661779, -137.93510685029835, -506.8899390516495, -903.4619599054388]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5603345439100006, "mean_inference_ms": 1.7000135379234294, "mean_action_processing_ms": 0.2727266217648862, "mean_env_wait_ms": 3.4121965208299425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012064456939697266, "StateBufferConnector_ms": 0.008108854293823242, "ViewRequirementAgentConnector_ms": 0.19408750534057617}, "num_episodes": 34, "episode_return_max": -2.2403750908804465, "episode_return_min": -1439.437211571559, "episode_return_mean": -441.0256061624599, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 325.4079596784056, "num_env_steps_trained_throughput_per_sec": 325.4079596784056, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 12118.17, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12118.1, "sample_time_ms": 1115.826, "learn_time_ms": 10937.276, "learn_throughput": 365.722, "synch_weights_time_ms": 64.151}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "training_iteration": 50, "trial_id": "4b94b_00000", "date": "2024-08-05_11-49-59", "timestamp": 1722838799, "time_this_iter_s": 12.304701566696167, "time_total_s": 602.887904882431, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1110a2830>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 602.887904882431, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 18.38235294117647, "ram_util_percent": 29.123529411764707}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 100.86222455104192, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.933076890806357, "policy_loss": 0.0014264087483752518, "vf_loss": 0.9328858243922392, "vf_explained_var": 0.9930287764718135, "kl": 0.013525331029237956, "entropy": 1.4044078469276429, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 48480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "env_runners": {"episode_reward_max": -2.2403750908804465, "episode_reward_min": -1449.837250729151, "episode_reward_mean": -450.5123886418663, "episode_len_mean": 111.18, "episode_media": {}, "episodes_timesteps_total": 11118, "policy_reward_min": {"policy_0": -1449.837250729151}, "policy_reward_max": {"policy_0": -2.2403750908804465}, "policy_reward_mean": {"policy_0": -450.5123886418663}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-42.724917826141386, -793.1302582346972, -160.0319670184837, -239.50880449551823, -802.9948462197995, -598.7785988168532, -35.1189608545769, -1266.9177817741636, -517.3429425589364, -207.81718435291114, -634.2803324047893, -534.6299374035552, -95.8133780569663, -188.56320018677403, -552.5474516739512, -96.79232233428044, -24.138928254663895, -407.64529773603635, -751.846333363007, -60.66740435236917, -328.44070923732085, -238.75846251067694, -1231.3947212431701, -551.0880543638116, -115.43193928206372, -606.178952988834, -326.2530565027067, -276.43705877232753, -508.03229322079227, -219.72244685820988, -82.91742443272443, -296.8967060822709, -229.03873126790026, -1439.437211571559, -265.73491194243405, -218.16856962019432, -479.1126352657331, -798.389519017269, -599.1618818435015, -73.34045049488675, -220.46486923729663, -18.290429789599138, -47.37747162236116, -173.86774598468503, -46.62249183848995, -1248.0030090179566, -57.75423792468713, -791.1744189183075, -402.41248895497665, -841.9676152420049, -312.8991383889873, -1108.2062112572423, -31.227974528336336, -184.28837551357626, -785.3127093799626, -212.1779979160059, -2.2403750908804465, -7.368151771120283, -145.75787148922487, -703.4249199972874, -133.7403708295315, -991.6093854048597, -511.0110876661779, -137.93510685029835, -506.8899390516495, -903.4619599054388, -557.2870795485485, -322.8606736965938, -207.28041335426659, -1004.7135571775489, -313.4605478498065, -152.47133168160627, -225.93407227674822, -450.4702125156246, -18.521143137882127, -106.92150491541675, -778.1656578949722, -725.6153560196037, -1039.7767906690895, -678.6366390485271, -6.79561158597286, -1130.8923181492487, -410.3322393434847, -477.9008377536762, -534.2138900687961, -166.26130142216223, -165.60839522872763, -195.40340236998108, -50.92939760084749, -497.3372599824122, -301.92777141954093, -1137.6486804397287, -1229.212487717529, -763.6938625687229, -225.1734999956691, -457.6845016591019, -553.7559070716361, -1449.837250729151, -605.868577239988, -687.9337540462126], "episode_lengths": [57, 150, 81, 98, 150, 150, 46, 150, 150, 86, 150, 115, 75, 82, 150, 83, 53, 150, 150, 63, 113, 96, 150, 150, 74, 150, 92, 105, 133, 81, 76, 105, 109, 150, 114, 109, 150, 150, 150, 58, 112, 34, 57, 59, 54, 150, 58, 147, 150, 150, 117, 150, 44, 90, 150, 84, 30, 43, 64, 150, 93, 150, 150, 83, 150, 150, 150, 103, 66, 150, 150, 70, 79, 102, 43, 67, 144, 150, 150, 150, 33, 150, 134, 143, 122, 85, 74, 95, 53, 150, 97, 150, 150, 150, 66, 119, 150, 150, 150, 150], "policy_policy_0_reward": [-42.724917826141386, -793.1302582346972, -160.0319670184837, -239.50880449551823, -802.9948462197995, -598.7785988168532, -35.1189608545769, -1266.9177817741636, -517.3429425589364, -207.81718435291114, -634.2803324047893, -534.6299374035552, -95.8133780569663, -188.56320018677403, -552.5474516739512, -96.79232233428044, -24.138928254663895, -407.64529773603635, -751.846333363007, -60.66740435236917, -328.44070923732085, -238.75846251067694, -1231.3947212431701, -551.0880543638116, -115.43193928206372, -606.178952988834, -326.2530565027067, -276.43705877232753, -508.03229322079227, -219.72244685820988, -82.91742443272443, -296.8967060822709, -229.03873126790026, -1439.437211571559, -265.73491194243405, -218.16856962019432, -479.1126352657331, -798.389519017269, -599.1618818435015, -73.34045049488675, -220.46486923729663, -18.290429789599138, -47.37747162236116, -173.86774598468503, -46.62249183848995, -1248.0030090179566, -57.75423792468713, -791.1744189183075, -402.41248895497665, -841.9676152420049, -312.8991383889873, -1108.2062112572423, -31.227974528336336, -184.28837551357626, -785.3127093799626, -212.1779979160059, -2.2403750908804465, -7.368151771120283, -145.75787148922487, -703.4249199972874, -133.7403708295315, -991.6093854048597, -511.0110876661779, -137.93510685029835, -506.8899390516495, -903.4619599054388, -557.2870795485485, -322.8606736965938, -207.28041335426659, -1004.7135571775489, -313.4605478498065, -152.47133168160627, -225.93407227674822, -450.4702125156246, -18.521143137882127, -106.92150491541675, -778.1656578949722, -725.6153560196037, -1039.7767906690895, -678.6366390485271, -6.79561158597286, -1130.8923181492487, -410.3322393434847, -477.9008377536762, -534.2138900687961, -166.26130142216223, -165.60839522872763, -195.40340236998108, -50.92939760084749, -497.3372599824122, -301.92777141954093, -1137.6486804397287, -1229.212487717529, -763.6938625687229, -225.1734999956691, -457.6845016591019, -553.7559070716361, -1449.837250729151, -605.868577239988, -687.9337540462126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5587493215804568, "mean_inference_ms": 1.6998906182129725, "mean_action_processing_ms": 0.27281463784889903, "mean_env_wait_ms": 3.4117390299390236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012145042419433594, "StateBufferConnector_ms": 0.008135080337524414, "ViewRequirementAgentConnector_ms": 0.19283270835876465}, "num_episodes": 34, "episode_return_max": -2.2403750908804465, "episode_return_min": -1449.837250729151, "episode_return_mean": -450.5123886418663, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 458.22245951050223, "num_env_steps_trained_throughput_per_sec": 458.22245951050223, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 11803.519, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11803.447, "sample_time_ms": 1105.01, "learn_time_ms": 10634.274, "learn_throughput": 376.142, "synch_weights_time_ms": 63.318}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "training_iteration": 51, "trial_id": "4b94b_00000", "date": "2024-08-05_11-50-08", "timestamp": 1722838808, "time_this_iter_s": 8.741499900817871, "time_total_s": 611.6294047832489, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e111111870>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 611.6294047832489, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 21.34615384615385, "ram_util_percent": 29.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 91.89142727603515, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.812058231389771, "policy_loss": -0.003644369883113541, "vf_loss": 0.8169171166916688, "vf_explained_var": 0.9967076756060124, "kl": 0.012822243285518198, "entropy": 1.3747926478584607, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 49440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": -2.2403750908804465, "episode_reward_min": -1449.837250729151, "episode_reward_mean": -466.63063900415347, "episode_len_mean": 110.52, "episode_media": {}, "episodes_timesteps_total": 11052, "policy_reward_min": {"policy_0": -1449.837250729151}, "policy_reward_max": {"policy_0": -2.2403750908804465}, "policy_reward_mean": {"policy_0": -466.63063900415347}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-599.1618818435015, -73.34045049488675, -220.46486923729663, -18.290429789599138, -47.37747162236116, -173.86774598468503, -46.62249183848995, -1248.0030090179566, -57.75423792468713, -791.1744189183075, -402.41248895497665, -841.9676152420049, -312.8991383889873, -1108.2062112572423, -31.227974528336336, -184.28837551357626, -785.3127093799626, -212.1779979160059, -2.2403750908804465, -7.368151771120283, -145.75787148922487, -703.4249199972874, -133.7403708295315, -991.6093854048597, -511.0110876661779, -137.93510685029835, -506.8899390516495, -903.4619599054388, -557.2870795485485, -322.8606736965938, -207.28041335426659, -1004.7135571775489, -313.4605478498065, -152.47133168160627, -225.93407227674822, -450.4702125156246, -18.521143137882127, -106.92150491541675, -778.1656578949722, -725.6153560196037, -1039.7767906690895, -678.6366390485271, -6.79561158597286, -1130.8923181492487, -410.3322393434847, -477.9008377536762, -534.2138900687961, -166.26130142216223, -165.60839522872763, -195.40340236998108, -50.92939760084749, -497.3372599824122, -301.92777141954093, -1137.6486804397287, -1229.212487717529, -763.6938625687229, -225.1734999956691, -457.6845016591019, -553.7559070716361, -1449.837250729151, -605.868577239988, -687.9337540462126, -307.4741615521801, -516.119247167969, -706.6131913551945, -387.50635337375564, -468.0891452541772, -291.28967772802457, -113.65015351433345, -276.84225325020867, -1275.2398557404947, -120.9533639784077, -292.8231430612429, -101.03012355742653, -83.58638715650925, -285.9997943659296, -84.44795941657847, -1423.1325514462942, -938.1527662210929, -144.16927438425176, -29.012188734271216, -1231.8593617133004, -682.3345468763979, -718.370332396994, -204.3950415868501, -826.4577176983971, -874.484511314195, -1231.367899833619, -596.2239818999901, -418.2977346961942, -300.61510280955184, -30.763220570389116, -216.86997308988867, -117.59677000898202, -210.14078966066512, -313.26100204964456, -245.2789996057981, -1223.36037312723, -350.22817855531383, -196.51215957544892], "episode_lengths": [150, 58, 112, 34, 57, 59, 54, 150, 58, 147, 150, 150, 117, 150, 44, 90, 150, 84, 30, 43, 64, 150, 93, 150, 150, 83, 150, 150, 150, 103, 66, 150, 150, 70, 79, 102, 43, 67, 144, 150, 150, 150, 33, 150, 134, 143, 122, 85, 74, 95, 53, 150, 97, 150, 150, 150, 66, 119, 150, 150, 150, 150, 118, 150, 150, 100, 133, 150, 53, 111, 150, 74, 109, 74, 69, 94, 59, 150, 150, 81, 51, 150, 150, 150, 114, 150, 150, 150, 131, 114, 84, 41, 108, 68, 96, 135, 89, 150, 84, 90], "policy_policy_0_reward": [-599.1618818435015, -73.34045049488675, -220.46486923729663, -18.290429789599138, -47.37747162236116, -173.86774598468503, -46.62249183848995, -1248.0030090179566, -57.75423792468713, -791.1744189183075, -402.41248895497665, -841.9676152420049, -312.8991383889873, -1108.2062112572423, -31.227974528336336, -184.28837551357626, -785.3127093799626, -212.1779979160059, -2.2403750908804465, -7.368151771120283, -145.75787148922487, -703.4249199972874, -133.7403708295315, -991.6093854048597, -511.0110876661779, -137.93510685029835, -506.8899390516495, -903.4619599054388, -557.2870795485485, -322.8606736965938, -207.28041335426659, -1004.7135571775489, -313.4605478498065, -152.47133168160627, -225.93407227674822, -450.4702125156246, -18.521143137882127, -106.92150491541675, -778.1656578949722, -725.6153560196037, -1039.7767906690895, -678.6366390485271, -6.79561158597286, -1130.8923181492487, -410.3322393434847, -477.9008377536762, -534.2138900687961, -166.26130142216223, -165.60839522872763, -195.40340236998108, -50.92939760084749, -497.3372599824122, -301.92777141954093, -1137.6486804397287, -1229.212487717529, -763.6938625687229, -225.1734999956691, -457.6845016591019, -553.7559070716361, -1449.837250729151, -605.868577239988, -687.9337540462126, -307.4741615521801, -516.119247167969, -706.6131913551945, -387.50635337375564, -468.0891452541772, -291.28967772802457, -113.65015351433345, -276.84225325020867, -1275.2398557404947, -120.9533639784077, -292.8231430612429, -101.03012355742653, -83.58638715650925, -285.9997943659296, -84.44795941657847, -1423.1325514462942, -938.1527662210929, -144.16927438425176, -29.012188734271216, -1231.8593617133004, -682.3345468763979, -718.370332396994, -204.3950415868501, -826.4577176983971, -874.484511314195, -1231.367899833619, -596.2239818999901, -418.2977346961942, -300.61510280955184, -30.763220570389116, -216.86997308988867, -117.59677000898202, -210.14078966066512, -313.26100204964456, -245.2789996057981, -1223.36037312723, -350.22817855531383, -196.51215957544892]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5587398434329822, "mean_inference_ms": 1.6977913520833139, "mean_action_processing_ms": 0.2726806363243874, "mean_env_wait_ms": 3.411541223286255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012117624282836914, "StateBufferConnector_ms": 0.008023262023925781, "ViewRequirementAgentConnector_ms": 0.19077658653259277}, "num_episodes": 38, "episode_return_max": -2.2403750908804465, "episode_return_min": -1449.837250729151, "episode_return_mean": -466.63063900415347, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 413.38125770706375, "num_env_steps_trained_throughput_per_sec": 413.38125770706375, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 11477.394, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11477.324, "sample_time_ms": 1105.896, "learn_time_ms": 10307.349, "learn_throughput": 388.073, "synch_weights_time_ms": 63.244}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 52, "trial_id": "4b94b_00000", "date": "2024-08-05_11-50-18", "timestamp": 1722838818, "time_this_iter_s": 9.69027042388916, "time_total_s": 621.3196752071381, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e11156be20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 621.3196752071381, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 20.784615384615385, "ram_util_percent": 29.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 105.19831621448199, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9906918123364449, "policy_loss": -0.0033170071023050697, "vf_loss": 0.9951642171479762, "vf_explained_var": 0.9941490755726894, "kl": 0.01350627830561282, "entropy": 1.3242282123615345, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 50400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "env_runners": {"episode_reward_max": -6.79561158597286, "episode_reward_min": -1449.837250729151, "episode_reward_mean": -512.0201680722939, "episode_len_mean": 116.2, "episode_media": {}, "episodes_timesteps_total": 11620, "policy_reward_min": {"policy_0": -1449.837250729151}, "policy_reward_max": {"policy_0": -6.79561158597286}, "policy_reward_mean": {"policy_0": -512.0201680722939}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152.47133168160627, -225.93407227674822, -450.4702125156246, -18.521143137882127, -106.92150491541675, -778.1656578949722, -725.6153560196037, -1039.7767906690895, -678.6366390485271, -6.79561158597286, -1130.8923181492487, -410.3322393434847, -477.9008377536762, -534.2138900687961, -166.26130142216223, -165.60839522872763, -195.40340236998108, -50.92939760084749, -497.3372599824122, -301.92777141954093, -1137.6486804397287, -1229.212487717529, -763.6938625687229, -225.1734999956691, -457.6845016591019, -553.7559070716361, -1449.837250729151, -605.868577239988, -687.9337540462126, -307.4741615521801, -516.119247167969, -706.6131913551945, -387.50635337375564, -468.0891452541772, -291.28967772802457, -113.65015351433345, -276.84225325020867, -1275.2398557404947, -120.9533639784077, -292.8231430612429, -101.03012355742653, -83.58638715650925, -285.9997943659296, -84.44795941657847, -1423.1325514462942, -938.1527662210929, -144.16927438425176, -29.012188734271216, -1231.8593617133004, -682.3345468763979, -718.370332396994, -204.3950415868501, -826.4577176983971, -874.484511314195, -1231.367899833619, -596.2239818999901, -418.2977346961942, -300.61510280955184, -30.763220570389116, -216.86997308988867, -117.59677000898202, -210.14078966066512, -313.26100204964456, -245.2789996057981, -1223.36037312723, -350.22817855531383, -196.51215957544892, -227.80882926703794, -424.96197960920273, -1099.2224445470572, -156.83494001157382, -1407.0848918049169, -70.70012444407651, -108.49140885150825, -925.8273717401349, -798.8806401304047, -684.8183441216904, -836.7744415856305, -1107.4220937772743, -477.4209861416002, -1074.5065989931238, -46.96549576306812, -304.2811408858326, -184.8409209010485, -584.8717673975938, -157.86862308622852, -195.34518699873865, -763.3522237461784, -570.4011348532068, -707.7707635996654, -900.994742178437, -40.63396084886743, -458.52344777924327, -339.51808257891855, -421.25053209418655, -147.32126791377163, -951.2837631543058, -951.6238787908362, -565.6749717547981, -449.26686499997777], "episode_lengths": [70, 79, 102, 43, 67, 144, 150, 150, 150, 33, 150, 134, 143, 122, 85, 74, 95, 53, 150, 97, 150, 150, 150, 66, 119, 150, 150, 150, 150, 118, 150, 150, 100, 133, 150, 53, 111, 150, 74, 109, 74, 69, 94, 59, 150, 150, 81, 51, 150, 150, 150, 114, 150, 150, 150, 131, 114, 84, 41, 108, 68, 96, 135, 89, 150, 84, 90, 77, 150, 150, 97, 150, 64, 76, 150, 150, 150, 150, 150, 106, 150, 60, 98, 66, 150, 74, 97, 150, 150, 150, 150, 58, 150, 109, 150, 82, 150, 150, 150, 150], "policy_policy_0_reward": [-152.47133168160627, -225.93407227674822, -450.4702125156246, -18.521143137882127, -106.92150491541675, -778.1656578949722, -725.6153560196037, -1039.7767906690895, -678.6366390485271, -6.79561158597286, -1130.8923181492487, -410.3322393434847, -477.9008377536762, -534.2138900687961, -166.26130142216223, -165.60839522872763, -195.40340236998108, -50.92939760084749, -497.3372599824122, -301.92777141954093, -1137.6486804397287, -1229.212487717529, -763.6938625687229, -225.1734999956691, -457.6845016591019, -553.7559070716361, -1449.837250729151, -605.868577239988, -687.9337540462126, -307.4741615521801, -516.119247167969, -706.6131913551945, -387.50635337375564, -468.0891452541772, -291.28967772802457, -113.65015351433345, -276.84225325020867, -1275.2398557404947, -120.9533639784077, -292.8231430612429, -101.03012355742653, -83.58638715650925, -285.9997943659296, -84.44795941657847, -1423.1325514462942, -938.1527662210929, -144.16927438425176, -29.012188734271216, -1231.8593617133004, -682.3345468763979, -718.370332396994, -204.3950415868501, -826.4577176983971, -874.484511314195, -1231.367899833619, -596.2239818999901, -418.2977346961942, -300.61510280955184, -30.763220570389116, -216.86997308988867, -117.59677000898202, -210.14078966066512, -313.26100204964456, -245.2789996057981, -1223.36037312723, -350.22817855531383, -196.51215957544892, -227.80882926703794, -424.96197960920273, -1099.2224445470572, -156.83494001157382, -1407.0848918049169, -70.70012444407651, -108.49140885150825, -925.8273717401349, -798.8806401304047, -684.8183441216904, -836.7744415856305, -1107.4220937772743, -477.4209861416002, -1074.5065989931238, -46.96549576306812, -304.2811408858326, -184.8409209010485, -584.8717673975938, -157.86862308622852, -195.34518699873865, -763.3522237461784, -570.4011348532068, -707.7707635996654, -900.994742178437, -40.63396084886743, -458.52344777924327, -339.51808257891855, -421.25053209418655, -147.32126791377163, -951.2837631543058, -951.6238787908362, -565.6749717547981, -449.26686499997777]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5588194519266899, "mean_inference_ms": 1.697838487237174, "mean_action_processing_ms": 0.2727175298135169, "mean_env_wait_ms": 3.4150992609040447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011821985244750977, "StateBufferConnector_ms": 0.008030414581298828, "ViewRequirementAgentConnector_ms": 0.19255781173706055}, "num_episodes": 33, "episode_return_max": -6.79561158597286, "episode_return_min": -1449.837250729151, "episode_return_mean": -512.0201680722939, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.1387297226425, "num_env_steps_trained_throughput_per_sec": 307.1387297226425, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 212000, "timers": {"training_iteration_time_ms": 11852.288, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11852.219, "sample_time_ms": 1103.409, "learn_time_ms": 10683.792, "learn_throughput": 374.399, "synch_weights_time_ms": 64.228}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "done": false, "training_iteration": 53, "trial_id": "4b94b_00000", "date": "2024-08-05_11-50-31", "timestamp": 1722838831, "time_this_iter_s": 13.036039352416992, "time_total_s": 634.355714559555, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e111113490>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 634.355714559555, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 17.589473684210525, "ram_util_percent": 29.115789473684213}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 97.7115715364615, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.0239228358492256, "policy_loss": -0.007235241298136922, "vf_loss": 1.0324633864065011, "vf_explained_var": 0.9963577441871166, "kl": 0.01273735530949125, "entropy": 1.4645259446154038, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 51360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "env_runners": {"episode_reward_max": -1.1997257818632163, "episode_reward_min": -1423.1325514462942, "episode_reward_mean": -499.2347181106517, "episode_len_mean": 113.68, "episode_media": {}, "episodes_timesteps_total": 11368, "policy_reward_min": {"policy_0": -1423.1325514462942}, "policy_reward_max": {"policy_0": -1.1997257818632163}, "policy_reward_mean": {"policy_0": -499.2347181106517}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-276.84225325020867, -1275.2398557404947, -120.9533639784077, -292.8231430612429, -101.03012355742653, -83.58638715650925, -285.9997943659296, -84.44795941657847, -1423.1325514462942, -938.1527662210929, -144.16927438425176, -29.012188734271216, -1231.8593617133004, -682.3345468763979, -718.370332396994, -204.3950415868501, -826.4577176983971, -874.484511314195, -1231.367899833619, -596.2239818999901, -418.2977346961942, -300.61510280955184, -30.763220570389116, -216.86997308988867, -117.59677000898202, -210.14078966066512, -313.26100204964456, -245.2789996057981, -1223.36037312723, -350.22817855531383, -196.51215957544892, -227.80882926703794, -424.96197960920273, -1099.2224445470572, -156.83494001157382, -1407.0848918049169, -70.70012444407651, -108.49140885150825, -925.8273717401349, -798.8806401304047, -684.8183441216904, -836.7744415856305, -1107.4220937772743, -477.4209861416002, -1074.5065989931238, -46.96549576306812, -304.2811408858326, -184.8409209010485, -584.8717673975938, -157.86862308622852, -195.34518699873865, -763.3522237461784, -570.4011348532068, -707.7707635996654, -900.994742178437, -40.63396084886743, -458.52344777924327, -339.51808257891855, -421.25053209418655, -147.32126791377163, -951.2837631543058, -951.6238787908362, -565.6749717547981, -449.26686499997777, -73.19445461773057, -1195.9489728259452, -592.6510882058415, -705.5873518862892, -667.2972215814553, -177.61033819860842, -1416.9475998705284, -858.1757846742306, -367.42160534301604, -131.81566565837366, -181.78569570642048, -213.85418527717812, -46.50560053087519, -1083.50437628776, -212.57396209750772, -328.4900111534064, -221.81475124483322, -392.76890839116874, -33.35043529001624, -129.44878767811423, -190.76845190115105, -151.6829540587255, -879.8409146365868, -186.34677982977018, -1.1997257818632163, -241.67710231894614, -1259.0703656701571, -1251.8860572819274, -57.64774935153416, -1227.5743909481341, -659.7836200566381, -95.93521531109828, -185.30217118226454, -118.68765968687065, -712.1167204216351, -486.8539133768783], "episode_lengths": [111, 150, 74, 109, 74, 69, 94, 59, 150, 150, 81, 51, 150, 150, 150, 114, 150, 150, 150, 131, 114, 84, 41, 108, 68, 96, 135, 89, 150, 84, 90, 77, 150, 150, 97, 150, 64, 76, 150, 150, 150, 150, 150, 106, 150, 60, 98, 66, 150, 74, 97, 150, 150, 150, 150, 58, 150, 109, 150, 82, 150, 150, 150, 150, 70, 150, 150, 150, 150, 82, 150, 150, 150, 50, 61, 78, 58, 150, 77, 150, 114, 143, 41, 71, 94, 128, 150, 92, 29, 104, 150, 150, 55, 150, 150, 79, 65, 94, 138, 105], "policy_policy_0_reward": [-276.84225325020867, -1275.2398557404947, -120.9533639784077, -292.8231430612429, -101.03012355742653, -83.58638715650925, -285.9997943659296, -84.44795941657847, -1423.1325514462942, -938.1527662210929, -144.16927438425176, -29.012188734271216, -1231.8593617133004, -682.3345468763979, -718.370332396994, -204.3950415868501, -826.4577176983971, -874.484511314195, -1231.367899833619, -596.2239818999901, -418.2977346961942, -300.61510280955184, -30.763220570389116, -216.86997308988867, -117.59677000898202, -210.14078966066512, -313.26100204964456, -245.2789996057981, -1223.36037312723, -350.22817855531383, -196.51215957544892, -227.80882926703794, -424.96197960920273, -1099.2224445470572, -156.83494001157382, -1407.0848918049169, -70.70012444407651, -108.49140885150825, -925.8273717401349, -798.8806401304047, -684.8183441216904, -836.7744415856305, -1107.4220937772743, -477.4209861416002, -1074.5065989931238, -46.96549576306812, -304.2811408858326, -184.8409209010485, -584.8717673975938, -157.86862308622852, -195.34518699873865, -763.3522237461784, -570.4011348532068, -707.7707635996654, -900.994742178437, -40.63396084886743, -458.52344777924327, -339.51808257891855, -421.25053209418655, -147.32126791377163, -951.2837631543058, -951.6238787908362, -565.6749717547981, -449.26686499997777, -73.19445461773057, -1195.9489728259452, -592.6510882058415, -705.5873518862892, -667.2972215814553, -177.61033819860842, -1416.9475998705284, -858.1757846742306, -367.42160534301604, -131.81566565837366, -181.78569570642048, -213.85418527717812, -46.50560053087519, -1083.50437628776, -212.57396209750772, -328.4900111534064, -221.81475124483322, -392.76890839116874, -33.35043529001624, -129.44878767811423, -190.76845190115105, -151.6829540587255, -879.8409146365868, -186.34677982977018, -1.1997257818632163, -241.67710231894614, -1259.0703656701571, -1251.8860572819274, -57.64774935153416, -1227.5743909481341, -659.7836200566381, -95.93521531109828, -185.30217118226454, -118.68765968687065, -712.1167204216351, -486.8539133768783]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5584856613671069, "mean_inference_ms": 1.6957288076454733, "mean_action_processing_ms": 0.2724357311498116, "mean_env_wait_ms": 3.4103764575398814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011714935302734375, "StateBufferConnector_ms": 0.007869958877563477, "ViewRequirementAgentConnector_ms": 0.19031429290771484}, "num_episodes": 36, "episode_return_max": -1.1997257818632163, "episode_return_min": -1423.1325514462942, "episode_return_mean": -499.2347181106517, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.0051051311544, "num_env_steps_trained_throughput_per_sec": 315.0051051311544, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 11865.765, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11865.696, "sample_time_ms": 1108.596, "learn_time_ms": 10689.998, "learn_throughput": 374.182, "synch_weights_time_ms": 66.301}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "training_iteration": 54, "trial_id": "4b94b_00000", "date": "2024-08-05_11-50-43", "timestamp": 1722838843, "time_this_iter_s": 12.71042013168335, "time_total_s": 647.0661346912384, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1110a31c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 647.0661346912384, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 18.233333333333334, "ram_util_percent": 29.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 104.89746089975039, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.1852697621487702, "policy_loss": -0.004943126600119285, "vf_loss": 1.191314366273582, "vf_explained_var": 0.9971770903095603, "kl": 0.01483603216596145, "entropy": 1.2869221527750294, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 52320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "env_runners": {"episode_reward_max": -1.1997257818632163, "episode_reward_min": -1526.8447823882218, "episode_reward_mean": -488.9627398208966, "episode_len_mean": 115.1, "episode_media": {}, "episodes_timesteps_total": 11510, "policy_reward_min": {"policy_0": -1526.8447823882218}, "policy_reward_max": {"policy_0": -1.1997257818632163}, "policy_reward_mean": {"policy_0": -488.9627398208966}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-70.70012444407651, -108.49140885150825, -925.8273717401349, -798.8806401304047, -684.8183441216904, -836.7744415856305, -1107.4220937772743, -477.4209861416002, -1074.5065989931238, -46.96549576306812, -304.2811408858326, -184.8409209010485, -584.8717673975938, -157.86862308622852, -195.34518699873865, -763.3522237461784, -570.4011348532068, -707.7707635996654, -900.994742178437, -40.63396084886743, -458.52344777924327, -339.51808257891855, -421.25053209418655, -147.32126791377163, -951.2837631543058, -951.6238787908362, -565.6749717547981, -449.26686499997777, -73.19445461773057, -1195.9489728259452, -592.6510882058415, -705.5873518862892, -667.2972215814553, -177.61033819860842, -1416.9475998705284, -858.1757846742306, -367.42160534301604, -131.81566565837366, -181.78569570642048, -213.85418527717812, -46.50560053087519, -1083.50437628776, -212.57396209750772, -328.4900111534064, -221.81475124483322, -392.76890839116874, -33.35043529001624, -129.44878767811423, -190.76845190115105, -151.6829540587255, -879.8409146365868, -186.34677982977018, -1.1997257818632163, -241.67710231894614, -1259.0703656701571, -1251.8860572819274, -57.64774935153416, -1227.5743909481341, -659.7836200566381, -95.93521531109828, -185.30217118226454, -118.68765968687065, -712.1167204216351, -486.8539133768783, -460.5537220584687, -156.56771819459505, -565.4937682054644, -96.39513109752556, -316.6879809279975, -689.2314832282315, -138.8237998250396, -1203.5751138668068, -1064.5484616990304, -892.2358504255533, -267.4562558009332, -99.08103848581433, -702.5451957854793, -894.8964610024085, -156.17506851394688, -233.68953254550746, -91.81488619885587, -185.19445226368444, -757.2195854554923, -438.4361751932295, -115.0387690218639, -191.38630381924642, -909.4567821503315, -358.2767857275099, -1314.9028634544532, -210.53600557296252, -331.05123429085137, -694.7124196317903, -563.6139843604635, -40.58020954094777, -1526.8447823882218, -396.6880912031582, -210.06256405720868, -282.7398337513432, -505.53755868667207, -270.472746214752], "episode_lengths": [64, 76, 150, 150, 150, 150, 150, 106, 150, 60, 98, 66, 150, 74, 97, 150, 150, 150, 150, 58, 150, 109, 150, 82, 150, 150, 150, 150, 70, 150, 150, 150, 150, 82, 150, 150, 150, 50, 61, 78, 58, 150, 77, 150, 114, 143, 41, 71, 94, 128, 150, 92, 29, 104, 150, 150, 55, 150, 150, 79, 65, 94, 138, 105, 150, 70, 150, 50, 104, 150, 57, 150, 150, 150, 98, 78, 150, 150, 95, 68, 69, 87, 150, 148, 104, 77, 150, 129, 150, 63, 103, 150, 150, 45, 150, 134, 109, 120, 150, 84], "policy_policy_0_reward": [-70.70012444407651, -108.49140885150825, -925.8273717401349, -798.8806401304047, -684.8183441216904, -836.7744415856305, -1107.4220937772743, -477.4209861416002, -1074.5065989931238, -46.96549576306812, -304.2811408858326, -184.8409209010485, -584.8717673975938, -157.86862308622852, -195.34518699873865, -763.3522237461784, -570.4011348532068, -707.7707635996654, -900.994742178437, -40.63396084886743, -458.52344777924327, -339.51808257891855, -421.25053209418655, -147.32126791377163, -951.2837631543058, -951.6238787908362, -565.6749717547981, -449.26686499997777, -73.19445461773057, -1195.9489728259452, -592.6510882058415, -705.5873518862892, -667.2972215814553, -177.61033819860842, -1416.9475998705284, -858.1757846742306, -367.42160534301604, -131.81566565837366, -181.78569570642048, -213.85418527717812, -46.50560053087519, -1083.50437628776, -212.57396209750772, -328.4900111534064, -221.81475124483322, -392.76890839116874, -33.35043529001624, -129.44878767811423, -190.76845190115105, -151.6829540587255, -879.8409146365868, -186.34677982977018, -1.1997257818632163, -241.67710231894614, -1259.0703656701571, -1251.8860572819274, -57.64774935153416, -1227.5743909481341, -659.7836200566381, -95.93521531109828, -185.30217118226454, -118.68765968687065, -712.1167204216351, -486.8539133768783, -460.5537220584687, -156.56771819459505, -565.4937682054644, -96.39513109752556, -316.6879809279975, -689.2314832282315, -138.8237998250396, -1203.5751138668068, -1064.5484616990304, -892.2358504255533, -267.4562558009332, -99.08103848581433, -702.5451957854793, -894.8964610024085, -156.17506851394688, -233.68953254550746, -91.81488619885587, -185.19445226368444, -757.2195854554923, -438.4361751932295, -115.0387690218639, -191.38630381924642, -909.4567821503315, -358.2767857275099, -1314.9028634544532, -210.53600557296252, -331.05123429085137, -694.7124196317903, -563.6139843604635, -40.58020954094777, -1526.8447823882218, -396.6880912031582, -210.06256405720868, -282.7398337513432, -505.53755868667207, -270.472746214752]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5584598734260089, "mean_inference_ms": 1.6955646232663728, "mean_action_processing_ms": 0.272648698726097, "mean_env_wait_ms": 3.4094963094136777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011884450912475586, "StateBufferConnector_ms": 0.007860660552978516, "ViewRequirementAgentConnector_ms": 0.1899256706237793}, "num_episodes": 36, "episode_return_max": -1.1997257818632163, "episode_return_min": -1526.8447823882218, "episode_return_mean": -488.9627398208966, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.8339094705313, "num_env_steps_trained_throughput_per_sec": 314.8339094705313, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 11871.717, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11871.649, "sample_time_ms": 1105.344, "learn_time_ms": 10700.051, "learn_throughput": 373.83, "synch_weights_time_ms": 65.456}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "done": false, "training_iteration": 55, "trial_id": "4b94b_00000", "date": "2024-08-05_11-50-56", "timestamp": 1722838856, "time_this_iter_s": 12.71676516532898, "time_total_s": 659.7828998565674, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1110a1d80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 659.7828998565674, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 18.07777777777778, "ram_util_percent": 29.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 76.01682611157497, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9573981305118651, "policy_loss": -0.0035167497306247244, "vf_loss": 0.9620889186859131, "vf_explained_var": 0.997390288921694, "kl": 0.013666659523156948, "entropy": 1.3448713234315315, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 53280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": -1.1997257818632163, "episode_reward_min": -1526.8447823882218, "episode_reward_mean": -435.1761796388612, "episode_len_mean": 110.82, "episode_media": {}, "episodes_timesteps_total": 11082, "policy_reward_min": {"policy_0": -1526.8447823882218}, "policy_reward_max": {"policy_0": -1.1997257818632163}, "policy_reward_mean": {"policy_0": -435.1761796388612}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-131.81566565837366, -181.78569570642048, -213.85418527717812, -46.50560053087519, -1083.50437628776, -212.57396209750772, -328.4900111534064, -221.81475124483322, -392.76890839116874, -33.35043529001624, -129.44878767811423, -190.76845190115105, -151.6829540587255, -879.8409146365868, -186.34677982977018, -1.1997257818632163, -241.67710231894614, -1259.0703656701571, -1251.8860572819274, -57.64774935153416, -1227.5743909481341, -659.7836200566381, -95.93521531109828, -185.30217118226454, -118.68765968687065, -712.1167204216351, -486.8539133768783, -460.5537220584687, -156.56771819459505, -565.4937682054644, -96.39513109752556, -316.6879809279975, -689.2314832282315, -138.8237998250396, -1203.5751138668068, -1064.5484616990304, -892.2358504255533, -267.4562558009332, -99.08103848581433, -702.5451957854793, -894.8964610024085, -156.17506851394688, -233.68953254550746, -91.81488619885587, -185.19445226368444, -757.2195854554923, -438.4361751932295, -115.0387690218639, -191.38630381924642, -909.4567821503315, -358.2767857275099, -1314.9028634544532, -210.53600557296252, -331.05123429085137, -694.7124196317903, -563.6139843604635, -40.58020954094777, -1526.8447823882218, -396.6880912031582, -210.06256405720868, -282.7398337513432, -505.53755868667207, -270.472746214752, -279.94830801865527, -435.97484713510505, -602.7737598568923, -488.0746417406099, -300.9398528158131, -523.0438315173027, -126.22346176925468, -195.17493150264613, -337.55472600017936, -190.304429895909, -229.05879392094687, -712.2013117182801, -152.62107444285968, -153.38281620207567, -98.880434697386, -1258.8415657354944, -316.80991507587765, -4.796832169843898, -912.4473098093085, -185.67175042508353, -132.1038074122224, -113.85223287208997, -1447.2067034754887, -594.0471477192133, -11.193855249972612, -764.9256960793831, -256.335523105012, -49.50028177882726, -116.63513303018712, -848.3238449486374, -528.9724602612968, -140.34388182547895, -894.7161627306859, -799.8205772192159, -425.81318730447344, -348.90171665433695, -525.3923719944005], "episode_lengths": [50, 61, 78, 58, 150, 77, 150, 114, 143, 41, 71, 94, 128, 150, 92, 29, 104, 150, 150, 55, 150, 150, 79, 65, 94, 138, 105, 150, 70, 150, 50, 104, 150, 57, 150, 150, 150, 98, 78, 150, 150, 95, 68, 69, 87, 150, 148, 104, 77, 150, 129, 150, 63, 103, 150, 150, 45, 150, 134, 109, 120, 150, 84, 104, 130, 150, 150, 114, 150, 76, 105, 120, 74, 82, 150, 73, 79, 66, 150, 150, 35, 150, 103, 95, 95, 150, 120, 37, 150, 150, 51, 68, 150, 150, 84, 150, 150, 150, 103, 150], "policy_policy_0_reward": [-131.81566565837366, -181.78569570642048, -213.85418527717812, -46.50560053087519, -1083.50437628776, -212.57396209750772, -328.4900111534064, -221.81475124483322, -392.76890839116874, -33.35043529001624, -129.44878767811423, -190.76845190115105, -151.6829540587255, -879.8409146365868, -186.34677982977018, -1.1997257818632163, -241.67710231894614, -1259.0703656701571, -1251.8860572819274, -57.64774935153416, -1227.5743909481341, -659.7836200566381, -95.93521531109828, -185.30217118226454, -118.68765968687065, -712.1167204216351, -486.8539133768783, -460.5537220584687, -156.56771819459505, -565.4937682054644, -96.39513109752556, -316.6879809279975, -689.2314832282315, -138.8237998250396, -1203.5751138668068, -1064.5484616990304, -892.2358504255533, -267.4562558009332, -99.08103848581433, -702.5451957854793, -894.8964610024085, -156.17506851394688, -233.68953254550746, -91.81488619885587, -185.19445226368444, -757.2195854554923, -438.4361751932295, -115.0387690218639, -191.38630381924642, -909.4567821503315, -358.2767857275099, -1314.9028634544532, -210.53600557296252, -331.05123429085137, -694.7124196317903, -563.6139843604635, -40.58020954094777, -1526.8447823882218, -396.6880912031582, -210.06256405720868, -282.7398337513432, -505.53755868667207, -270.472746214752, -279.94830801865527, -435.97484713510505, -602.7737598568923, -488.0746417406099, -300.9398528158131, -523.0438315173027, -126.22346176925468, -195.17493150264613, -337.55472600017936, -190.304429895909, -229.05879392094687, -712.2013117182801, -152.62107444285968, -153.38281620207567, -98.880434697386, -1258.8415657354944, -316.80991507587765, -4.796832169843898, -912.4473098093085, -185.67175042508353, -132.1038074122224, -113.85223287208997, -1447.2067034754887, -594.0471477192133, -11.193855249972612, -764.9256960793831, -256.335523105012, -49.50028177882726, -116.63513303018712, -848.3238449486374, -528.9724602612968, -140.34388182547895, -894.7161627306859, -799.8205772192159, -425.81318730447344, -348.90171665433695, -525.3923719944005]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5576144626955825, "mean_inference_ms": 1.6943796286462731, "mean_action_processing_ms": 0.27259947093664255, "mean_env_wait_ms": 3.405625709433374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011972904205322266, "StateBufferConnector_ms": 0.007977485656738281, "ViewRequirementAgentConnector_ms": 0.19185805320739746}, "num_episodes": 37, "episode_return_max": -1.1997257818632163, "episode_return_min": -1526.8447823882218, "episode_return_mean": -435.1761796388612, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 337.05525782757917, "num_env_steps_trained_throughput_per_sec": 337.05525782757917, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 11808.904, "restore_workers_time_ms": 0.025, "training_step_time_ms": 11808.836, "sample_time_ms": 1105.637, "learn_time_ms": 10635.881, "learn_throughput": 376.085, "synch_weights_time_ms": 66.522}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 56, "trial_id": "4b94b_00000", "date": "2024-08-05_11-51-08", "timestamp": 1722838868, "time_this_iter_s": 11.880231857299805, "time_total_s": 671.6631317138672, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1110a2c20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 671.6631317138672, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 18.35882352941176, "ram_util_percent": 29.111764705882354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 84.02739905416965, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9781593158841133, "policy_loss": -0.0028045120590832083, "vf_loss": 0.9822022609412671, "vf_explained_var": 0.9940855135520299, "kl": 0.015906738816374853, "entropy": 1.4372622723380724, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 54240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "env_runners": {"episode_reward_max": 1.1760287208953222, "episode_reward_min": -1526.8447823882218, "episode_reward_mean": -411.7435367706408, "episode_len_mean": 109.12, "episode_media": {}, "episodes_timesteps_total": 10912, "policy_reward_min": {"policy_0": -1526.8447823882218}, "policy_reward_max": {"policy_0": 1.1760287208953222}, "policy_reward_mean": {"policy_0": -411.7435367706408}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-892.2358504255533, -267.4562558009332, -99.08103848581433, -702.5451957854793, -894.8964610024085, -156.17506851394688, -233.68953254550746, -91.81488619885587, -185.19445226368444, -757.2195854554923, -438.4361751932295, -115.0387690218639, -191.38630381924642, -909.4567821503315, -358.2767857275099, -1314.9028634544532, -210.53600557296252, -331.05123429085137, -694.7124196317903, -563.6139843604635, -40.58020954094777, -1526.8447823882218, -396.6880912031582, -210.06256405720868, -282.7398337513432, -505.53755868667207, -270.472746214752, -279.94830801865527, -435.97484713510505, -602.7737598568923, -488.0746417406099, -300.9398528158131, -523.0438315173027, -126.22346176925468, -195.17493150264613, -337.55472600017936, -190.304429895909, -229.05879392094687, -712.2013117182801, -152.62107444285968, -153.38281620207567, -98.880434697386, -1258.8415657354944, -316.80991507587765, -4.796832169843898, -912.4473098093085, -185.67175042508353, -132.1038074122224, -113.85223287208997, -1447.2067034754887, -594.0471477192133, -11.193855249972612, -764.9256960793831, -256.335523105012, -49.50028177882726, -116.63513303018712, -848.3238449486374, -528.9724602612968, -140.34388182547895, -894.7161627306859, -799.8205772192159, -425.81318730447344, -348.90171665433695, -525.3923719944005, -332.82782655434266, -39.74469930763094, -235.72225546071698, 1.1760287208953222, -686.1232057621355, -262.59242135478456, -124.40781738761767, -739.6101309845684, -538.7440651777682, -113.8639271623517, -185.84753638024816, -269.9516289267303, -180.47716182472166, -468.2548972004232, -41.84149442913269, -14.198218276350802, -752.2346357261201, -1046.5232745627206, -890.7020891782298, -80.77924458188788, -122.69266853182809, -316.34746025867213, -1139.083446339126, -181.76870780887447, -837.824240091378, -283.280973471601, -163.66065707760694, -718.644568000469, -136.3084454708631, -314.2673466095387, -62.17917416821912, -4.839059024886128, -274.0725857244947, -97.0039079619216, -550.3116151998647, -825.3437061540174], "episode_lengths": [150, 98, 78, 150, 150, 95, 68, 69, 87, 150, 148, 104, 77, 150, 129, 150, 63, 103, 150, 150, 45, 150, 134, 109, 120, 150, 84, 104, 130, 150, 150, 114, 150, 76, 105, 120, 74, 82, 150, 73, 79, 66, 150, 150, 35, 150, 103, 95, 95, 150, 120, 37, 150, 150, 51, 68, 150, 150, 84, 150, 150, 150, 103, 150, 139, 54, 112, 35, 131, 122, 49, 150, 136, 72, 62, 74, 67, 135, 55, 39, 150, 150, 150, 72, 62, 116, 150, 75, 150, 97, 87, 150, 78, 125, 55, 39, 119, 71, 109, 150], "policy_policy_0_reward": [-892.2358504255533, -267.4562558009332, -99.08103848581433, -702.5451957854793, -894.8964610024085, -156.17506851394688, -233.68953254550746, -91.81488619885587, -185.19445226368444, -757.2195854554923, -438.4361751932295, -115.0387690218639, -191.38630381924642, -909.4567821503315, -358.2767857275099, -1314.9028634544532, -210.53600557296252, -331.05123429085137, -694.7124196317903, -563.6139843604635, -40.58020954094777, -1526.8447823882218, -396.6880912031582, -210.06256405720868, -282.7398337513432, -505.53755868667207, -270.472746214752, -279.94830801865527, -435.97484713510505, -602.7737598568923, -488.0746417406099, -300.9398528158131, -523.0438315173027, -126.22346176925468, -195.17493150264613, -337.55472600017936, -190.304429895909, -229.05879392094687, -712.2013117182801, -152.62107444285968, -153.38281620207567, -98.880434697386, -1258.8415657354944, -316.80991507587765, -4.796832169843898, -912.4473098093085, -185.67175042508353, -132.1038074122224, -113.85223287208997, -1447.2067034754887, -594.0471477192133, -11.193855249972612, -764.9256960793831, -256.335523105012, -49.50028177882726, -116.63513303018712, -848.3238449486374, -528.9724602612968, -140.34388182547895, -894.7161627306859, -799.8205772192159, -425.81318730447344, -348.90171665433695, -525.3923719944005, -332.82782655434266, -39.74469930763094, -235.72225546071698, 1.1760287208953222, -686.1232057621355, -262.59242135478456, -124.40781738761767, -739.6101309845684, -538.7440651777682, -113.8639271623517, -185.84753638024816, -269.9516289267303, -180.47716182472166, -468.2548972004232, -41.84149442913269, -14.198218276350802, -752.2346357261201, -1046.5232745627206, -890.7020891782298, -80.77924458188788, -122.69266853182809, -316.34746025867213, -1139.083446339126, -181.76870780887447, -837.824240091378, -283.280973471601, -163.66065707760694, -718.644568000469, -136.3084454708631, -314.2673466095387, -62.17917416821912, -4.839059024886128, -274.0725857244947, -97.0039079619216, -550.3116151998647, -825.3437061540174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5578326058804213, "mean_inference_ms": 1.6944744375224574, "mean_action_processing_ms": 0.27249417617308064, "mean_env_wait_ms": 3.40988195908039, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01186060905456543, "StateBufferConnector_ms": 0.00800943374633789, "ViewRequirementAgentConnector_ms": 0.19205141067504883}, "num_episodes": 36, "episode_return_max": 1.1760287208953222, "episode_return_min": -1526.8447823882218, "episode_return_mean": -411.7435367706408, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.29455658052575, "num_env_steps_trained_throughput_per_sec": 318.29455658052575, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 11794.771, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11794.7, "sample_time_ms": 1104.59, "learn_time_ms": 10623.077, "learn_throughput": 376.539, "synch_weights_time_ms": 66.238}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "training_iteration": 57, "trial_id": "4b94b_00000", "date": "2024-08-05_11-51-21", "timestamp": 1722838881, "time_this_iter_s": 12.578255653381348, "time_total_s": 684.2413873672485, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e111112200>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 684.2413873672485, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 17.938888888888883, "ram_util_percent": 29.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 112.69318072199822, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9873580423649401, "policy_loss": -0.0017228861475208153, "vf_loss": 0.9904580963154633, "vf_explained_var": 0.9979344832400481, "kl": 0.013989262556666934, "entropy": 1.5520340842505296, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 55200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "env_runners": {"episode_reward_max": 1.1760287208953222, "episode_reward_min": -1447.2067034754887, "episode_reward_mean": -439.06636778412036, "episode_len_mean": 111.53, "episode_media": {}, "episodes_timesteps_total": 11153, "policy_reward_min": {"policy_0": -1447.2067034754887}, "policy_reward_max": {"policy_0": 1.1760287208953222}, "policy_reward_mean": {"policy_0": -439.06636778412036}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-195.17493150264613, -337.55472600017936, -190.304429895909, -229.05879392094687, -712.2013117182801, -152.62107444285968, -153.38281620207567, -98.880434697386, -1258.8415657354944, -316.80991507587765, -4.796832169843898, -912.4473098093085, -185.67175042508353, -132.1038074122224, -113.85223287208997, -1447.2067034754887, -594.0471477192133, -11.193855249972612, -764.9256960793831, -256.335523105012, -49.50028177882726, -116.63513303018712, -848.3238449486374, -528.9724602612968, -140.34388182547895, -894.7161627306859, -799.8205772192159, -425.81318730447344, -348.90171665433695, -525.3923719944005, -332.82782655434266, -39.74469930763094, -235.72225546071698, 1.1760287208953222, -686.1232057621355, -262.59242135478456, -124.40781738761767, -739.6101309845684, -538.7440651777682, -113.8639271623517, -185.84753638024816, -269.9516289267303, -180.47716182472166, -468.2548972004232, -41.84149442913269, -14.198218276350802, -752.2346357261201, -1046.5232745627206, -890.7020891782298, -80.77924458188788, -122.69266853182809, -316.34746025867213, -1139.083446339126, -181.76870780887447, -837.824240091378, -283.280973471601, -163.66065707760694, -718.644568000469, -136.3084454708631, -314.2673466095387, -62.17917416821912, -4.839059024886128, -274.0725857244947, -97.0039079619216, -550.3116151998647, -825.3437061540174, -1061.3497910326855, -157.8449681852198, -46.79039729040895, -951.303409972349, -198.1110457306696, -262.09633735848564, -799.1417074413065, -853.3710339642118, -60.70107531615163, -876.5616121411499, -444.1691110712259, -649.54271316001, -1336.927681188644, -73.92455313597048, -762.5838715759153, -520.3989265265908, -224.24684685478547, -679.8289565976921, -301.8183683680349, -1185.8213104303147, -247.0546185610122, -692.1517603674389, -1223.8384184947151, -258.7262910461145, -984.9172650836086, -787.2199786460934, -487.00979839840954, -287.8983401676075, -823.7228549801235, -59.32777214113589, -140.15326657402488, -191.42106831777625, -361.88256738877493, -138.04952223561907], "episode_lengths": [105, 120, 74, 82, 150, 73, 79, 66, 150, 150, 35, 150, 103, 95, 95, 150, 120, 37, 150, 150, 51, 68, 150, 150, 84, 150, 150, 150, 103, 150, 139, 54, 112, 35, 131, 122, 49, 150, 136, 72, 62, 74, 67, 135, 55, 39, 150, 150, 150, 72, 62, 116, 150, 75, 150, 97, 87, 150, 78, 125, 55, 39, 119, 71, 109, 150, 150, 82, 44, 150, 74, 119, 150, 150, 66, 150, 133, 150, 150, 68, 150, 150, 85, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 91, 81, 150, 95], "policy_policy_0_reward": [-195.17493150264613, -337.55472600017936, -190.304429895909, -229.05879392094687, -712.2013117182801, -152.62107444285968, -153.38281620207567, -98.880434697386, -1258.8415657354944, -316.80991507587765, -4.796832169843898, -912.4473098093085, -185.67175042508353, -132.1038074122224, -113.85223287208997, -1447.2067034754887, -594.0471477192133, -11.193855249972612, -764.9256960793831, -256.335523105012, -49.50028177882726, -116.63513303018712, -848.3238449486374, -528.9724602612968, -140.34388182547895, -894.7161627306859, -799.8205772192159, -425.81318730447344, -348.90171665433695, -525.3923719944005, -332.82782655434266, -39.74469930763094, -235.72225546071698, 1.1760287208953222, -686.1232057621355, -262.59242135478456, -124.40781738761767, -739.6101309845684, -538.7440651777682, -113.8639271623517, -185.84753638024816, -269.9516289267303, -180.47716182472166, -468.2548972004232, -41.84149442913269, -14.198218276350802, -752.2346357261201, -1046.5232745627206, -890.7020891782298, -80.77924458188788, -122.69266853182809, -316.34746025867213, -1139.083446339126, -181.76870780887447, -837.824240091378, -283.280973471601, -163.66065707760694, -718.644568000469, -136.3084454708631, -314.2673466095387, -62.17917416821912, -4.839059024886128, -274.0725857244947, -97.0039079619216, -550.3116151998647, -825.3437061540174, -1061.3497910326855, -157.8449681852198, -46.79039729040895, -951.303409972349, -198.1110457306696, -262.09633735848564, -799.1417074413065, -853.3710339642118, -60.70107531615163, -876.5616121411499, -444.1691110712259, -649.54271316001, -1336.927681188644, -73.92455313597048, -762.5838715759153, -520.3989265265908, -224.24684685478547, -679.8289565976921, -301.8183683680349, -1185.8213104303147, -247.0546185610122, -692.1517603674389, -1223.8384184947151, -258.7262910461145, -984.9172650836086, -787.2199786460934, -487.00979839840954, -287.8983401676075, -823.7228549801235, -59.32777214113589, -140.15326657402488, -191.42106831777625, -361.88256738877493, -138.04952223561907]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5573505736096088, "mean_inference_ms": 1.6949026143698698, "mean_action_processing_ms": 0.2724631709219375, "mean_env_wait_ms": 3.4109676792082424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011991500854492188, "StateBufferConnector_ms": 0.008012533187866211, "ViewRequirementAgentConnector_ms": 0.19173598289489746}, "num_episodes": 34, "episode_return_max": 1.1760287208953222, "episode_return_min": -1447.2067034754887, "episode_return_mean": -439.06636778412036, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.0513702759945, "num_env_steps_trained_throughput_per_sec": 303.0513702759945, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 11891.326, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11891.255, "sample_time_ms": 1116.218, "learn_time_ms": 10708.317, "learn_throughput": 373.541, "synch_weights_time_ms": 65.884}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "training_iteration": 58, "trial_id": "4b94b_00000", "date": "2024-08-05_11-51-34", "timestamp": 1722838894, "time_this_iter_s": 13.212477207183838, "time_total_s": 697.4538645744324, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e111113910>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 697.4538645744324, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 17.789473684210524, "ram_util_percent": 29.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 124.13891407946745, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.0246902841764192, "policy_loss": -0.0032598921675041008, "vf_loss": 1.0293009440414607, "vf_explained_var": 0.9986287934084733, "kl": 0.013736554199537484, "entropy": 1.5224762710432211, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 56160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "env_runners": {"episode_reward_max": -4.839059024886128, "episode_reward_min": -1496.8218403611936, "episode_reward_mean": -463.7582828871441, "episode_len_mean": 110.26, "episode_media": {}, "episodes_timesteps_total": 11026, "policy_reward_min": {"policy_0": -1496.8218403611936}, "policy_reward_max": {"policy_0": -4.839059024886128}, "policy_reward_mean": {"policy_0": -463.7582828871441}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-686.1232057621355, -262.59242135478456, -124.40781738761767, -739.6101309845684, -538.7440651777682, -113.8639271623517, -185.84753638024816, -269.9516289267303, -180.47716182472166, -468.2548972004232, -41.84149442913269, -14.198218276350802, -752.2346357261201, -1046.5232745627206, -890.7020891782298, -80.77924458188788, -122.69266853182809, -316.34746025867213, -1139.083446339126, -181.76870780887447, -837.824240091378, -283.280973471601, -163.66065707760694, -718.644568000469, -136.3084454708631, -314.2673466095387, -62.17917416821912, -4.839059024886128, -274.0725857244947, -97.0039079619216, -550.3116151998647, -825.3437061540174, -1061.3497910326855, -157.8449681852198, -46.79039729040895, -951.303409972349, -198.1110457306696, -262.09633735848564, -799.1417074413065, -853.3710339642118, -60.70107531615163, -876.5616121411499, -444.1691110712259, -649.54271316001, -1336.927681188644, -73.92455313597048, -762.5838715759153, -520.3989265265908, -224.24684685478547, -679.8289565976921, -301.8183683680349, -1185.8213104303147, -247.0546185610122, -692.1517603674389, -1223.8384184947151, -258.7262910461145, -984.9172650836086, -787.2199786460934, -487.00979839840954, -287.8983401676075, -823.7228549801235, -59.32777214113589, -140.15326657402488, -191.42106831777625, -361.88256738877493, -138.04952223561907, -1229.766757665573, -57.225552503913654, -143.6803450831774, -59.15814291554344, -125.14835461424036, -32.21723611124307, -401.25668205854834, -1045.8233667763175, -111.88859741517973, -134.29114614142554, -527.1011393121987, -380.5008586011712, -1256.490953593286, -139.8177332940077, -170.58949794287062, -205.54243604820283, -1259.055660157776, -94.19460845055417, -128.49883376206208, -686.5540081070649, -156.13763812578293, -177.27697811593742, -180.71554777375596, -276.8241396819925, -1395.378383764679, -98.51701206374376, -1496.8218403611936, -1099.2031628741115, -392.0820294295093, -805.4285823563649, -244.72667145345406, -502.2787260033901, -725.4338665856677, -82.5142490170428], "episode_lengths": [131, 122, 49, 150, 136, 72, 62, 74, 67, 135, 55, 39, 150, 150, 150, 72, 62, 116, 150, 75, 150, 97, 87, 150, 78, 125, 55, 39, 119, 71, 109, 150, 150, 82, 44, 150, 74, 119, 150, 150, 66, 150, 133, 150, 150, 68, 150, 150, 85, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 91, 81, 150, 95, 150, 51, 94, 47, 64, 47, 150, 150, 69, 61, 150, 133, 150, 82, 71, 62, 150, 42, 84, 150, 99, 88, 63, 79, 150, 58, 150, 150, 148, 150, 92, 150, 150, 69], "policy_policy_0_reward": [-686.1232057621355, -262.59242135478456, -124.40781738761767, -739.6101309845684, -538.7440651777682, -113.8639271623517, -185.84753638024816, -269.9516289267303, -180.47716182472166, -468.2548972004232, -41.84149442913269, -14.198218276350802, -752.2346357261201, -1046.5232745627206, -890.7020891782298, -80.77924458188788, -122.69266853182809, -316.34746025867213, -1139.083446339126, -181.76870780887447, -837.824240091378, -283.280973471601, -163.66065707760694, -718.644568000469, -136.3084454708631, -314.2673466095387, -62.17917416821912, -4.839059024886128, -274.0725857244947, -97.0039079619216, -550.3116151998647, -825.3437061540174, -1061.3497910326855, -157.8449681852198, -46.79039729040895, -951.303409972349, -198.1110457306696, -262.09633735848564, -799.1417074413065, -853.3710339642118, -60.70107531615163, -876.5616121411499, -444.1691110712259, -649.54271316001, -1336.927681188644, -73.92455313597048, -762.5838715759153, -520.3989265265908, -224.24684685478547, -679.8289565976921, -301.8183683680349, -1185.8213104303147, -247.0546185610122, -692.1517603674389, -1223.8384184947151, -258.7262910461145, -984.9172650836086, -787.2199786460934, -487.00979839840954, -287.8983401676075, -823.7228549801235, -59.32777214113589, -140.15326657402488, -191.42106831777625, -361.88256738877493, -138.04952223561907, -1229.766757665573, -57.225552503913654, -143.6803450831774, -59.15814291554344, -125.14835461424036, -32.21723611124307, -401.25668205854834, -1045.8233667763175, -111.88859741517973, -134.29114614142554, -527.1011393121987, -380.5008586011712, -1256.490953593286, -139.8177332940077, -170.58949794287062, -205.54243604820283, -1259.055660157776, -94.19460845055417, -128.49883376206208, -686.5540081070649, -156.13763812578293, -177.27697811593742, -180.71554777375596, -276.8241396819925, -1395.378383764679, -98.51701206374376, -1496.8218403611936, -1099.2031628741115, -392.0820294295093, -805.4285823563649, -244.72667145345406, -502.2787260033901, -725.4338665856677, -82.5142490170428]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5573851965181268, "mean_inference_ms": 1.6939863880870458, "mean_action_processing_ms": 0.27262103100523516, "mean_env_wait_ms": 3.4113733321517556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012257575988769531, "StateBufferConnector_ms": 0.007942676544189453, "ViewRequirementAgentConnector_ms": 0.19148612022399902}, "num_episodes": 34, "episode_return_max": -4.839059024886128, "episode_return_min": -1496.8218403611936, "episode_return_mean": -463.7582828871441, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.83625962802824, "num_env_steps_trained_throughput_per_sec": 303.83625962802824, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 236000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 236000, "timers": {"training_iteration_time_ms": 11992.335, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11992.263, "sample_time_ms": 1121.525, "learn_time_ms": 10804.197, "learn_throughput": 370.226, "synch_weights_time_ms": 65.681}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "done": false, "training_iteration": 59, "trial_id": "4b94b_00000", "date": "2024-08-05_11-51-47", "timestamp": 1722838907, "time_this_iter_s": 13.177814245223999, "time_total_s": 710.6316788196564, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1110a2c20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 710.6316788196564, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 17.689473684210526, "ram_util_percent": 29.115789473684213}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 102.00796902080377, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9924321996979415, "policy_loss": -0.004258529977232683, "vf_loss": 0.9980940928993126, "vf_explained_var": 0.9929864196727674, "kl": 0.013099770189031345, "entropy": 1.5671141675362985, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 57120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": -9.553229995438388, "episode_reward_min": -1496.8218403611936, "episode_reward_mean": -474.78507147200077, "episode_len_mean": 109.13, "episode_media": {}, "episodes_timesteps_total": 10913, "policy_reward_min": {"policy_0": -1496.8218403611936}, "policy_reward_max": {"policy_0": -9.553229995438388}, "policy_reward_mean": {"policy_0": -474.78507147200077}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1336.927681188644, -73.92455313597048, -762.5838715759153, -520.3989265265908, -224.24684685478547, -679.8289565976921, -301.8183683680349, -1185.8213104303147, -247.0546185610122, -692.1517603674389, -1223.8384184947151, -258.7262910461145, -984.9172650836086, -787.2199786460934, -487.00979839840954, -287.8983401676075, -823.7228549801235, -59.32777214113589, -140.15326657402488, -191.42106831777625, -361.88256738877493, -138.04952223561907, -1229.766757665573, -57.225552503913654, -143.6803450831774, -59.15814291554344, -125.14835461424036, -32.21723611124307, -401.25668205854834, -1045.8233667763175, -111.88859741517973, -134.29114614142554, -527.1011393121987, -380.5008586011712, -1256.490953593286, -139.8177332940077, -170.58949794287062, -205.54243604820283, -1259.055660157776, -94.19460845055417, -128.49883376206208, -686.5540081070649, -156.13763812578293, -177.27697811593742, -180.71554777375596, -276.8241396819925, -1395.378383764679, -98.51701206374376, -1496.8218403611936, -1099.2031628741115, -392.0820294295093, -805.4285823563649, -244.72667145345406, -502.2787260033901, -725.4338665856677, -82.5142490170428, -336.500434532645, -233.5476592200692, -295.23371819957276, -1137.8856529486031, -16.08911061205779, -911.6146552954308, -324.63755242950066, -39.44247767999297, -1328.3490459607033, -57.42056405310461, -753.4640144560956, -1160.2786786172078, -280.9991985743456, -1282.6475330384208, -127.55171184779536, -130.30167757081333, -491.5623947398159, -321.4339534529467, -626.3303529768921, -621.1028099080946, -9.553229995438388, -278.9415629802838, -262.87115088722123, -143.95915573140772, -100.16230839277583, -328.1231377032354, -260.48046567238725, -116.41686439193346, -144.18562732016215, -39.50163078373928, -727.6009744669325, -1447.756446922761, -1128.1278544043862, -1413.5734797003431, -155.77074236335577, -267.1329622807276, -47.47337664920922, -792.1512406718792, -523.2887758697794, -48.271743125572904, -125.84735877630364, -45.02416906966401, -946.3064552583926, -58.528462426700656], "episode_lengths": [150, 68, 150, 150, 85, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 91, 81, 150, 95, 150, 51, 94, 47, 64, 47, 150, 150, 69, 61, 150, 133, 150, 82, 71, 62, 150, 42, 84, 150, 99, 88, 63, 79, 150, 58, 150, 150, 148, 150, 92, 150, 150, 69, 110, 115, 86, 150, 44, 150, 104, 55, 150, 54, 150, 150, 83, 150, 70, 82, 150, 119, 150, 126, 47, 96, 109, 77, 95, 90, 89, 50, 84, 52, 150, 150, 150, 150, 60, 100, 59, 150, 150, 47, 76, 60, 150, 63], "policy_policy_0_reward": [-1336.927681188644, -73.92455313597048, -762.5838715759153, -520.3989265265908, -224.24684685478547, -679.8289565976921, -301.8183683680349, -1185.8213104303147, -247.0546185610122, -692.1517603674389, -1223.8384184947151, -258.7262910461145, -984.9172650836086, -787.2199786460934, -487.00979839840954, -287.8983401676075, -823.7228549801235, -59.32777214113589, -140.15326657402488, -191.42106831777625, -361.88256738877493, -138.04952223561907, -1229.766757665573, -57.225552503913654, -143.6803450831774, -59.15814291554344, -125.14835461424036, -32.21723611124307, -401.25668205854834, -1045.8233667763175, -111.88859741517973, -134.29114614142554, -527.1011393121987, -380.5008586011712, -1256.490953593286, -139.8177332940077, -170.58949794287062, -205.54243604820283, -1259.055660157776, -94.19460845055417, -128.49883376206208, -686.5540081070649, -156.13763812578293, -177.27697811593742, -180.71554777375596, -276.8241396819925, -1395.378383764679, -98.51701206374376, -1496.8218403611936, -1099.2031628741115, -392.0820294295093, -805.4285823563649, -244.72667145345406, -502.2787260033901, -725.4338665856677, -82.5142490170428, -336.500434532645, -233.5476592200692, -295.23371819957276, -1137.8856529486031, -16.08911061205779, -911.6146552954308, -324.63755242950066, -39.44247767999297, -1328.3490459607033, -57.42056405310461, -753.4640144560956, -1160.2786786172078, -280.9991985743456, -1282.6475330384208, -127.55171184779536, -130.30167757081333, -491.5623947398159, -321.4339534529467, -626.3303529768921, -621.1028099080946, -9.553229995438388, -278.9415629802838, -262.87115088722123, -143.95915573140772, -100.16230839277583, -328.1231377032354, -260.48046567238725, -116.41686439193346, -144.18562732016215, -39.50163078373928, -727.6009744669325, -1447.756446922761, -1128.1278544043862, -1413.5734797003431, -155.77074236335577, -267.1329622807276, -47.47337664920922, -792.1512406718792, -523.2887758697794, -48.271743125572904, -125.84735877630364, -45.02416906966401, -946.3064552583926, -58.528462426700656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.556613664107855, "mean_inference_ms": 1.6937017259842617, "mean_action_processing_ms": 0.27251265440121947, "mean_env_wait_ms": 3.4133929429030503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012271642684936523, "StateBufferConnector_ms": 0.007825613021850586, "ViewRequirementAgentConnector_ms": 0.19081950187683105}, "num_episodes": 44, "episode_return_max": -9.553229995438388, "episode_return_min": -1496.8218403611936, "episode_return_mean": -474.78507147200077, "episodes_this_iter": 44}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.8232524143987, "num_env_steps_trained_throughput_per_sec": 323.8232524143987, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 11998.351, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11998.276, "sample_time_ms": 1126.124, "learn_time_ms": 10806.532, "learn_throughput": 370.146, "synch_weights_time_ms": 64.757}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 60, "trial_id": "4b94b_00000", "date": "2024-08-05_11-52-00", "timestamp": 1722838920, "time_this_iter_s": 12.36429738998413, "time_total_s": 722.9959762096405, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1111128c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 722.9959762096405, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 18.494117647058825, "ram_util_percent": 29.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 125.52674760123094, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.008231943845749, "policy_loss": -0.0016527512130172302, "vf_loss": 1.0111693632168075, "vf_explained_var": 0.9987343165402611, "kl": 0.01704048276333202, "entropy": 1.4976727310568094, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 58080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "env_runners": {"episode_reward_max": -9.553229995438388, "episode_reward_min": -1496.8218403611936, "episode_reward_mean": -492.40280110693885, "episode_len_mean": 108.47, "episode_media": {}, "episodes_timesteps_total": 10847, "policy_reward_min": {"policy_0": -1496.8218403611936}, "policy_reward_max": {"policy_0": -9.553229995438388}, "policy_reward_mean": {"policy_0": -492.40280110693885}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1256.490953593286, -139.8177332940077, -170.58949794287062, -205.54243604820283, -1259.055660157776, -94.19460845055417, -128.49883376206208, -686.5540081070649, -156.13763812578293, -177.27697811593742, -180.71554777375596, -276.8241396819925, -1395.378383764679, -98.51701206374376, -1496.8218403611936, -1099.2031628741115, -392.0820294295093, -805.4285823563649, -244.72667145345406, -502.2787260033901, -725.4338665856677, -82.5142490170428, -336.500434532645, -233.5476592200692, -295.23371819957276, -1137.8856529486031, -16.08911061205779, -911.6146552954308, -324.63755242950066, -39.44247767999297, -1328.3490459607033, -57.42056405310461, -753.4640144560956, -1160.2786786172078, -280.9991985743456, -1282.6475330384208, -127.55171184779536, -130.30167757081333, -491.5623947398159, -321.4339534529467, -626.3303529768921, -621.1028099080946, -9.553229995438388, -278.9415629802838, -262.87115088722123, -143.95915573140772, -100.16230839277583, -328.1231377032354, -260.48046567238725, -116.41686439193346, -144.18562732016215, -39.50163078373928, -727.6009744669325, -1447.756446922761, -1128.1278544043862, -1413.5734797003431, -155.77074236335577, -267.1329622807276, -47.47337664920922, -792.1512406718792, -523.2887758697794, -48.271743125572904, -125.84735877630364, -45.02416906966401, -946.3064552583926, -58.528462426700656, -1381.9793550247778, -19.657682237611933, -497.19036810448563, -992.9696583450219, -355.6458362519655, -77.92806518997226, -897.8463402866088, -1164.0376031931487, -17.39045207814764, -47.01871431857265, -760.2772204011953, -367.80843304116655, -259.03312077269703, -65.5435569179306, -1466.9878354214457, -318.48375340882194, -52.79296634017174, -516.2238194285878, -353.5398183855115, -1452.1494770432123, -896.9890154642311, -64.10909813476654, -219.47619318973247, -94.50250227301163, -903.1230656039837, -41.92547448486185, -154.03126910059103, -759.6120954950961, -172.98085076863217, -1000.2704258204557, -288.558270070071, -785.818415815888, -778.0913051097275, -554.7631222506299], "episode_lengths": [150, 82, 71, 62, 150, 42, 84, 150, 99, 88, 63, 79, 150, 58, 150, 150, 148, 150, 92, 150, 150, 69, 110, 115, 86, 150, 44, 150, 104, 55, 150, 54, 150, 150, 83, 150, 70, 82, 150, 119, 150, 126, 47, 96, 109, 77, 95, 90, 89, 50, 84, 52, 150, 150, 150, 150, 60, 100, 59, 150, 150, 47, 76, 60, 150, 63, 150, 51, 150, 150, 111, 73, 150, 150, 48, 59, 150, 134, 117, 64, 150, 111, 62, 150, 150, 150, 150, 50, 64, 67, 150, 47, 85, 150, 69, 150, 146, 150, 150, 150], "policy_policy_0_reward": [-1256.490953593286, -139.8177332940077, -170.58949794287062, -205.54243604820283, -1259.055660157776, -94.19460845055417, -128.49883376206208, -686.5540081070649, -156.13763812578293, -177.27697811593742, -180.71554777375596, -276.8241396819925, -1395.378383764679, -98.51701206374376, -1496.8218403611936, -1099.2031628741115, -392.0820294295093, -805.4285823563649, -244.72667145345406, -502.2787260033901, -725.4338665856677, -82.5142490170428, -336.500434532645, -233.5476592200692, -295.23371819957276, -1137.8856529486031, -16.08911061205779, -911.6146552954308, -324.63755242950066, -39.44247767999297, -1328.3490459607033, -57.42056405310461, -753.4640144560956, -1160.2786786172078, -280.9991985743456, -1282.6475330384208, -127.55171184779536, -130.30167757081333, -491.5623947398159, -321.4339534529467, -626.3303529768921, -621.1028099080946, -9.553229995438388, -278.9415629802838, -262.87115088722123, -143.95915573140772, -100.16230839277583, -328.1231377032354, -260.48046567238725, -116.41686439193346, -144.18562732016215, -39.50163078373928, -727.6009744669325, -1447.756446922761, -1128.1278544043862, -1413.5734797003431, -155.77074236335577, -267.1329622807276, -47.47337664920922, -792.1512406718792, -523.2887758697794, -48.271743125572904, -125.84735877630364, -45.02416906966401, -946.3064552583926, -58.528462426700656, -1381.9793550247778, -19.657682237611933, -497.19036810448563, -992.9696583450219, -355.6458362519655, -77.92806518997226, -897.8463402866088, -1164.0376031931487, -17.39045207814764, -47.01871431857265, -760.2772204011953, -367.80843304116655, -259.03312077269703, -65.5435569179306, -1466.9878354214457, -318.48375340882194, -52.79296634017174, -516.2238194285878, -353.5398183855115, -1452.1494770432123, -896.9890154642311, -64.10909813476654, -219.47619318973247, -94.50250227301163, -903.1230656039837, -41.92547448486185, -154.03126910059103, -759.6120954950961, -172.98085076863217, -1000.2704258204557, -288.558270070071, -785.818415815888, -778.0913051097275, -554.7631222506299]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5562315285786981, "mean_inference_ms": 1.6928033288365416, "mean_action_processing_ms": 0.2724574762732685, "mean_env_wait_ms": 3.4155070324327776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011883735656738281, "StateBufferConnector_ms": 0.007894754409790039, "ViewRequirementAgentConnector_ms": 0.19021892547607422}, "num_episodes": 34, "episode_return_max": -9.553229995438388, "episode_return_min": -1496.8218403611936, "episode_return_mean": -492.40280110693885, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.989197142049, "num_env_steps_trained_throughput_per_sec": 319.989197142049, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 244000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 244000, "timers": {"training_iteration_time_ms": 12375.455, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12375.381, "sample_time_ms": 1133.585, "learn_time_ms": 11174.456, "learn_throughput": 357.959, "synch_weights_time_ms": 66.473}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "done": false, "training_iteration": 61, "trial_id": "4b94b_00000", "date": "2024-08-05_11-52-12", "timestamp": 1722838932, "time_this_iter_s": 12.513557434082031, "time_total_s": 735.5095336437225, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e111113910>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 735.5095336437225, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 19.427777777777777, "ram_util_percent": 29.150000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 110.35370673636595, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.8900856422105183, "policy_loss": -0.0036066258656016243, "vf_loss": 0.894979681322972, "vf_explained_var": 0.9988529302179814, "kl": 0.015655971211617766, "entropy": 1.483109674602747, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 59040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "env_runners": {"episode_reward_max": -9.553229995438388, "episode_reward_min": -1569.4533326118049, "episode_reward_mean": -480.50945200546505, "episode_len_mean": 109.42, "episode_media": {}, "episodes_timesteps_total": 10942, "policy_reward_min": {"policy_0": -1569.4533326118049}, "policy_reward_max": {"policy_0": -9.553229995438388}, "policy_reward_mean": {"policy_0": -480.50945200546505}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-280.9991985743456, -1282.6475330384208, -127.55171184779536, -130.30167757081333, -491.5623947398159, -321.4339534529467, -626.3303529768921, -621.1028099080946, -9.553229995438388, -278.9415629802838, -262.87115088722123, -143.95915573140772, -100.16230839277583, -328.1231377032354, -260.48046567238725, -116.41686439193346, -144.18562732016215, -39.50163078373928, -727.6009744669325, -1447.756446922761, -1128.1278544043862, -1413.5734797003431, -155.77074236335577, -267.1329622807276, -47.47337664920922, -792.1512406718792, -523.2887758697794, -48.271743125572904, -125.84735877630364, -45.02416906966401, -946.3064552583926, -58.528462426700656, -1381.9793550247778, -19.657682237611933, -497.19036810448563, -992.9696583450219, -355.6458362519655, -77.92806518997226, -897.8463402866088, -1164.0376031931487, -17.39045207814764, -47.01871431857265, -760.2772204011953, -367.80843304116655, -259.03312077269703, -65.5435569179306, -1466.9878354214457, -318.48375340882194, -52.79296634017174, -516.2238194285878, -353.5398183855115, -1452.1494770432123, -896.9890154642311, -64.10909813476654, -219.47619318973247, -94.50250227301163, -903.1230656039837, -41.92547448486185, -154.03126910059103, -759.6120954950961, -172.98085076863217, -1000.2704258204557, -288.558270070071, -785.818415815888, -778.0913051097275, -554.7631222506299, -1564.5918234822939, -1311.956956811292, -289.7759822238124, -211.72961236036227, -558.271157839405, -233.7559757074524, -18.5720992534699, -221.14065407349653, -377.8400355551451, -34.21521312243935, -1143.1203913387105, -89.99350741337864, -150.44148271431922, -667.2152651403653, -857.181436949465, -636.2158739171164, -281.78230400327504, -233.03239989477652, -1271.510716524331, -107.60579566277144, -157.0203226772573, -136.0581119513342, -139.20802229901687, -457.0706925960948, -1569.4533326118049, -66.10628536372397, -131.30942136984257, -784.1115005397069, -752.4455739352398, -1382.7875539553872, -189.04847531317512, -208.7946074776885, -224.2450843440384, -521.6035443980621], "episode_lengths": [83, 150, 70, 82, 150, 119, 150, 126, 47, 96, 109, 77, 95, 90, 89, 50, 84, 52, 150, 150, 150, 150, 60, 100, 59, 150, 150, 47, 76, 60, 150, 63, 150, 51, 150, 150, 111, 73, 150, 150, 48, 59, 150, 134, 117, 64, 150, 111, 62, 150, 150, 150, 150, 50, 64, 67, 150, 47, 85, 150, 69, 150, 146, 150, 150, 150, 150, 150, 120, 82, 150, 111, 46, 90, 129, 52, 150, 72, 77, 150, 150, 150, 113, 150, 150, 80, 81, 62, 87, 117, 150, 61, 52, 150, 150, 150, 79, 90, 99, 150], "policy_policy_0_reward": [-280.9991985743456, -1282.6475330384208, -127.55171184779536, -130.30167757081333, -491.5623947398159, -321.4339534529467, -626.3303529768921, -621.1028099080946, -9.553229995438388, -278.9415629802838, -262.87115088722123, -143.95915573140772, -100.16230839277583, -328.1231377032354, -260.48046567238725, -116.41686439193346, -144.18562732016215, -39.50163078373928, -727.6009744669325, -1447.756446922761, -1128.1278544043862, -1413.5734797003431, -155.77074236335577, -267.1329622807276, -47.47337664920922, -792.1512406718792, -523.2887758697794, -48.271743125572904, -125.84735877630364, -45.02416906966401, -946.3064552583926, -58.528462426700656, -1381.9793550247778, -19.657682237611933, -497.19036810448563, -992.9696583450219, -355.6458362519655, -77.92806518997226, -897.8463402866088, -1164.0376031931487, -17.39045207814764, -47.01871431857265, -760.2772204011953, -367.80843304116655, -259.03312077269703, -65.5435569179306, -1466.9878354214457, -318.48375340882194, -52.79296634017174, -516.2238194285878, -353.5398183855115, -1452.1494770432123, -896.9890154642311, -64.10909813476654, -219.47619318973247, -94.50250227301163, -903.1230656039837, -41.92547448486185, -154.03126910059103, -759.6120954950961, -172.98085076863217, -1000.2704258204557, -288.558270070071, -785.818415815888, -778.0913051097275, -554.7631222506299, -1564.5918234822939, -1311.956956811292, -289.7759822238124, -211.72961236036227, -558.271157839405, -233.7559757074524, -18.5720992534699, -221.14065407349653, -377.8400355551451, -34.21521312243935, -1143.1203913387105, -89.99350741337864, -150.44148271431922, -667.2152651403653, -857.181436949465, -636.2158739171164, -281.78230400327504, -233.03239989477652, -1271.510716524331, -107.60579566277144, -157.0203226772573, -136.0581119513342, -139.20802229901687, -457.0706925960948, -1569.4533326118049, -66.10628536372397, -131.30942136984257, -784.1115005397069, -752.4455739352398, -1382.7875539553872, -189.04847531317512, -208.7946074776885, -224.2450843440384, -521.6035443980621]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5570763849003422, "mean_inference_ms": 1.693809125614055, "mean_action_processing_ms": 0.27257478070009705, "mean_env_wait_ms": 3.417740550757738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011793851852416992, "StateBufferConnector_ms": 0.007837295532226562, "ViewRequirementAgentConnector_ms": 0.18901801109313965}, "num_episodes": 34, "episode_return_max": -9.553229995438388, "episode_return_min": -1569.4533326118049, "episode_return_mean": -480.50945200546505, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 412.3386696877739, "num_env_steps_trained_throughput_per_sec": 412.3386696877739, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 12377.902, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12377.825, "sample_time_ms": 1142.42, "learn_time_ms": 11170.013, "learn_throughput": 358.102, "synch_weights_time_ms": 64.53}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "done": false, "training_iteration": 62, "trial_id": "4b94b_00000", "date": "2024-08-05_11-52-22", "timestamp": 1722838942, "time_this_iter_s": 9.712732791900635, "time_total_s": 745.2222664356232, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e111111510>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 745.2222664356232, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 22.73571428571429, "ram_util_percent": 29.207142857142852}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 112.55971598426501, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9921864483350267, "policy_loss": -0.003396372304026348, "vf_loss": 0.9967651775417229, "vf_explained_var": 0.9983673620348176, "kl": 0.015564973112001704, "entropy": 1.376919114589691, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "env_runners": {"episode_reward_max": -17.39045207814764, "episode_reward_min": -1569.4533326118049, "episode_reward_mean": -493.14416609432527, "episode_len_mean": 115.61, "episode_media": {}, "episodes_timesteps_total": 11561, "policy_reward_min": {"policy_0": -1569.4533326118049}, "policy_reward_max": {"policy_0": -17.39045207814764}, "policy_reward_mean": {"policy_0": -493.14416609432527}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-497.19036810448563, -992.9696583450219, -355.6458362519655, -77.92806518997226, -897.8463402866088, -1164.0376031931487, -17.39045207814764, -47.01871431857265, -760.2772204011953, -367.80843304116655, -259.03312077269703, -65.5435569179306, -1466.9878354214457, -318.48375340882194, -52.79296634017174, -516.2238194285878, -353.5398183855115, -1452.1494770432123, -896.9890154642311, -64.10909813476654, -219.47619318973247, -94.50250227301163, -903.1230656039837, -41.92547448486185, -154.03126910059103, -759.6120954950961, -172.98085076863217, -1000.2704258204557, -288.558270070071, -785.818415815888, -778.0913051097275, -554.7631222506299, -1564.5918234822939, -1311.956956811292, -289.7759822238124, -211.72961236036227, -558.271157839405, -233.7559757074524, -18.5720992534699, -221.14065407349653, -377.8400355551451, -34.21521312243935, -1143.1203913387105, -89.99350741337864, -150.44148271431922, -667.2152651403653, -857.181436949465, -636.2158739171164, -281.78230400327504, -233.03239989477652, -1271.510716524331, -107.60579566277144, -157.0203226772573, -136.0581119513342, -139.20802229901687, -457.0706925960948, -1569.4533326118049, -66.10628536372397, -131.30942136984257, -784.1115005397069, -752.4455739352398, -1382.7875539553872, -189.04847531317512, -208.7946074776885, -224.2450843440384, -521.6035443980621, -484.9841285920676, -233.70245651585375, -145.40222832245044, -471.11913074901076, -42.40922926064463, -974.701225842571, -180.9362308939636, -174.86419828734589, -806.650883448288, -60.9870651788371, -39.661478934899385, -181.251409554566, -1135.0903092279036, -1230.408959769726, -152.69456499507334, -505.28413993707113, -589.9226132551202, -813.6577599187252, -497.73096000931736, -523.982781792028, -379.2181047654202, -727.0803857358319, -348.0061408233052, -311.4601302344809, -1249.590035458198, -19.66207880737376, -685.9205284537719, -300.0579879648756, -149.150902527697, -217.46433256284095, -768.7278000675285, -173.2500603744094, -503.7088481470359, -879.3481636938964], "episode_lengths": [150, 150, 111, 73, 150, 150, 48, 59, 150, 134, 117, 64, 150, 111, 62, 150, 150, 150, 150, 50, 64, 67, 150, 47, 85, 150, 69, 150, 146, 150, 150, 150, 150, 150, 120, 82, 150, 111, 46, 90, 129, 52, 150, 72, 77, 150, 150, 150, 113, 150, 150, 80, 81, 62, 87, 117, 150, 61, 52, 150, 150, 150, 79, 90, 99, 150, 150, 106, 80, 140, 47, 150, 91, 123, 150, 57, 51, 128, 150, 150, 55, 150, 150, 150, 150, 136, 121, 150, 150, 106, 150, 41, 150, 110, 90, 93, 150, 79, 150, 150], "policy_policy_0_reward": [-497.19036810448563, -992.9696583450219, -355.6458362519655, -77.92806518997226, -897.8463402866088, -1164.0376031931487, -17.39045207814764, -47.01871431857265, -760.2772204011953, -367.80843304116655, -259.03312077269703, -65.5435569179306, -1466.9878354214457, -318.48375340882194, -52.79296634017174, -516.2238194285878, -353.5398183855115, -1452.1494770432123, -896.9890154642311, -64.10909813476654, -219.47619318973247, -94.50250227301163, -903.1230656039837, -41.92547448486185, -154.03126910059103, -759.6120954950961, -172.98085076863217, -1000.2704258204557, -288.558270070071, -785.818415815888, -778.0913051097275, -554.7631222506299, -1564.5918234822939, -1311.956956811292, -289.7759822238124, -211.72961236036227, -558.271157839405, -233.7559757074524, -18.5720992534699, -221.14065407349653, -377.8400355551451, -34.21521312243935, -1143.1203913387105, -89.99350741337864, -150.44148271431922, -667.2152651403653, -857.181436949465, -636.2158739171164, -281.78230400327504, -233.03239989477652, -1271.510716524331, -107.60579566277144, -157.0203226772573, -136.0581119513342, -139.20802229901687, -457.0706925960948, -1569.4533326118049, -66.10628536372397, -131.30942136984257, -784.1115005397069, -752.4455739352398, -1382.7875539553872, -189.04847531317512, -208.7946074776885, -224.2450843440384, -521.6035443980621, -484.9841285920676, -233.70245651585375, -145.40222832245044, -471.11913074901076, -42.40922926064463, -974.701225842571, -180.9362308939636, -174.86419828734589, -806.650883448288, -60.9870651788371, -39.661478934899385, -181.251409554566, -1135.0903092279036, -1230.408959769726, -152.69456499507334, -505.28413993707113, -589.9226132551202, -813.6577599187252, -497.73096000931736, -523.982781792028, -379.2181047654202, -727.0803857358319, -348.0061408233052, -311.4601302344809, -1249.590035458198, -19.66207880737376, -685.9205284537719, -300.0579879648756, -149.150902527697, -217.46433256284095, -768.7278000675285, -173.2500603744094, -503.7088481470359, -879.3481636938964]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5577135207305903, "mean_inference_ms": 1.6933741082527356, "mean_action_processing_ms": 0.272893217385564, "mean_env_wait_ms": 3.417062866615798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013653993606567383, "StateBufferConnector_ms": 0.007891654968261719, "ViewRequirementAgentConnector_ms": 0.19043827056884766}, "num_episodes": 34, "episode_return_max": -17.39045207814764, "episode_return_min": -1569.4533326118049, "episode_return_mean": -493.14416609432527, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.12611467190277, "num_env_steps_trained_throughput_per_sec": 306.12611467190277, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 252000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 12382.21, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12382.131, "sample_time_ms": 1146.44, "learn_time_ms": 11171.019, "learn_throughput": 358.069, "synch_weights_time_ms": 63.8}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "training_iteration": 63, "trial_id": "4b94b_00000", "date": "2024-08-05_11-52-35", "timestamp": 1722838955, "time_this_iter_s": 13.078431129455566, "time_total_s": 758.3006975650787, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1110a20e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 758.3006975650787, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 17.75263157894737, "ram_util_percent": 29.200000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 101.24721545477708, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.1645339255221188, "policy_loss": -0.0019522087241057307, "vf_loss": 1.1676437390968204, "vf_explained_var": 0.9900930964077512, "kl": 0.013550923871510705, "entropy": 1.3269937369351585, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": -4.77243708051107, "episode_reward_min": -1569.4533326118049, "episode_reward_mean": -448.38966258217476, "episode_len_mean": 112.0, "episode_media": {}, "episodes_timesteps_total": 11200, "policy_reward_min": {"policy_0": -1569.4533326118049}, "policy_reward_max": {"policy_0": -4.77243708051107}, "policy_reward_mean": {"policy_0": -448.38966258217476}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.5720992534699, -221.14065407349653, -377.8400355551451, -34.21521312243935, -1143.1203913387105, -89.99350741337864, -150.44148271431922, -667.2152651403653, -857.181436949465, -636.2158739171164, -281.78230400327504, -233.03239989477652, -1271.510716524331, -107.60579566277144, -157.0203226772573, -136.0581119513342, -139.20802229901687, -457.0706925960948, -1569.4533326118049, -66.10628536372397, -131.30942136984257, -784.1115005397069, -752.4455739352398, -1382.7875539553872, -189.04847531317512, -208.7946074776885, -224.2450843440384, -521.6035443980621, -484.9841285920676, -233.70245651585375, -145.40222832245044, -471.11913074901076, -42.40922926064463, -974.701225842571, -180.9362308939636, -174.86419828734589, -806.650883448288, -60.9870651788371, -39.661478934899385, -181.251409554566, -1135.0903092279036, -1230.408959769726, -152.69456499507334, -505.28413993707113, -589.9226132551202, -813.6577599187252, -497.73096000931736, -523.982781792028, -379.2181047654202, -727.0803857358319, -348.0061408233052, -311.4601302344809, -1249.590035458198, -19.66207880737376, -685.9205284537719, -300.0579879648756, -149.150902527697, -217.46433256284095, -768.7278000675285, -173.2500603744094, -503.7088481470359, -879.3481636938964, -494.5141849120413, -184.97207598426505, -84.16143760407391, -12.841018792138804, -502.7909730216218, -443.72247145056645, -386.7603581043265, -384.50959853418414, -897.2701246359411, -235.24940063290822, -460.4446950436868, -1047.7042922847243, -1324.414758098633, -553.8149572824728, -438.2360526570269, -334.5732078544729, -172.58332226119583, -1513.7935363553772, -242.93564559601137, -335.04757077799434, -938.9958546734188, -77.86760321500248, -334.80442563734357, -62.46296474082875, -155.22538823791854, -4.77243708051107, -603.7946190271094, -1006.9831007609346, -127.5318196149706, -22.6438994688935, -432.14990392374244, -46.881096099729504, -759.0726699852179, -89.51907674521044, -230.55031420913727, -981.313865808464, -119.0140321000586, -27.826546507753285], "episode_lengths": [46, 90, 129, 52, 150, 72, 77, 150, 150, 150, 113, 150, 150, 80, 81, 62, 87, 117, 150, 61, 52, 150, 150, 150, 79, 90, 99, 150, 150, 106, 80, 140, 47, 150, 91, 123, 150, 57, 51, 128, 150, 150, 55, 150, 150, 150, 150, 136, 121, 150, 150, 106, 150, 41, 150, 110, 90, 93, 150, 79, 150, 150, 136, 66, 61, 42, 150, 121, 88, 119, 150, 109, 131, 150, 150, 107, 105, 103, 124, 150, 107, 150, 150, 64, 124, 56, 80, 36, 150, 150, 74, 47, 150, 49, 150, 81, 141, 150, 88, 50], "policy_policy_0_reward": [-18.5720992534699, -221.14065407349653, -377.8400355551451, -34.21521312243935, -1143.1203913387105, -89.99350741337864, -150.44148271431922, -667.2152651403653, -857.181436949465, -636.2158739171164, -281.78230400327504, -233.03239989477652, -1271.510716524331, -107.60579566277144, -157.0203226772573, -136.0581119513342, -139.20802229901687, -457.0706925960948, -1569.4533326118049, -66.10628536372397, -131.30942136984257, -784.1115005397069, -752.4455739352398, -1382.7875539553872, -189.04847531317512, -208.7946074776885, -224.2450843440384, -521.6035443980621, -484.9841285920676, -233.70245651585375, -145.40222832245044, -471.11913074901076, -42.40922926064463, -974.701225842571, -180.9362308939636, -174.86419828734589, -806.650883448288, -60.9870651788371, -39.661478934899385, -181.251409554566, -1135.0903092279036, -1230.408959769726, -152.69456499507334, -505.28413993707113, -589.9226132551202, -813.6577599187252, -497.73096000931736, -523.982781792028, -379.2181047654202, -727.0803857358319, -348.0061408233052, -311.4601302344809, -1249.590035458198, -19.66207880737376, -685.9205284537719, -300.0579879648756, -149.150902527697, -217.46433256284095, -768.7278000675285, -173.2500603744094, -503.7088481470359, -879.3481636938964, -494.5141849120413, -184.97207598426505, -84.16143760407391, -12.841018792138804, -502.7909730216218, -443.72247145056645, -386.7603581043265, -384.50959853418414, -897.2701246359411, -235.24940063290822, -460.4446950436868, -1047.7042922847243, -1324.414758098633, -553.8149572824728, -438.2360526570269, -334.5732078544729, -172.58332226119583, -1513.7935363553772, -242.93564559601137, -335.04757077799434, -938.9958546734188, -77.86760321500248, -334.80442563734357, -62.46296474082875, -155.22538823791854, -4.77243708051107, -603.7946190271094, -1006.9831007609346, -127.5318196149706, -22.6438994688935, -432.14990392374244, -46.881096099729504, -759.0726699852179, -89.51907674521044, -230.55031420913727, -981.313865808464, -119.0140321000586, -27.826546507753285]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5575170575532136, "mean_inference_ms": 1.6943165265460038, "mean_action_processing_ms": 0.2727481005927702, "mean_env_wait_ms": 3.4160651389864194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013892173767089844, "StateBufferConnector_ms": 0.007836580276489258, "ViewRequirementAgentConnector_ms": 0.1930251121520996}, "num_episodes": 38, "episode_return_max": -4.77243708051107, "episode_return_min": -1569.4533326118049, "episode_return_mean": -448.38966258217476, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.99824529853123, "num_env_steps_trained_throughput_per_sec": 317.99824529853123, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 12370.259, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12370.176, "sample_time_ms": 1139.353, "learn_time_ms": 11167.716, "learn_throughput": 358.175, "synch_weights_time_ms": 62.256}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 64, "trial_id": "4b94b_00000", "date": "2024-08-05_11-52-48", "timestamp": 1722838968, "time_this_iter_s": 12.591259479522705, "time_total_s": 770.8919570446014, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e111113910>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 770.8919570446014, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 17.816666666666666, "ram_util_percent": 29.205555555555552}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 104.80159749488035, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9200352081718545, "policy_loss": -0.0013816170840679357, "vf_loss": 0.9225900202834357, "vf_explained_var": 0.9974105548734467, "kl": 0.02054838181538803, "entropy": 1.4300495808323224, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 61920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "env_runners": {"episode_reward_max": 8.322580053233768, "episode_reward_min": -1513.7935363553772, "episode_reward_mean": -434.49659534132405, "episode_len_mean": 110.06, "episode_media": {}, "episodes_timesteps_total": 11006, "policy_reward_min": {"policy_0": -1513.7935363553772}, "policy_reward_max": {"policy_0": 8.322580053233768}, "policy_reward_mean": {"policy_0": -434.49659534132405}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-60.9870651788371, -39.661478934899385, -181.251409554566, -1135.0903092279036, -1230.408959769726, -152.69456499507334, -505.28413993707113, -589.9226132551202, -813.6577599187252, -497.73096000931736, -523.982781792028, -379.2181047654202, -727.0803857358319, -348.0061408233052, -311.4601302344809, -1249.590035458198, -19.66207880737376, -685.9205284537719, -300.0579879648756, -149.150902527697, -217.46433256284095, -768.7278000675285, -173.2500603744094, -503.7088481470359, -879.3481636938964, -494.5141849120413, -184.97207598426505, -84.16143760407391, -12.841018792138804, -502.7909730216218, -443.72247145056645, -386.7603581043265, -384.50959853418414, -897.2701246359411, -235.24940063290822, -460.4446950436868, -1047.7042922847243, -1324.414758098633, -553.8149572824728, -438.2360526570269, -334.5732078544729, -172.58332226119583, -1513.7935363553772, -242.93564559601137, -335.04757077799434, -938.9958546734188, -77.86760321500248, -334.80442563734357, -62.46296474082875, -155.22538823791854, -4.77243708051107, -603.7946190271094, -1006.9831007609346, -127.5318196149706, -22.6438994688935, -432.14990392374244, -46.881096099729504, -759.0726699852179, -89.51907674521044, -230.55031420913727, -981.313865808464, -119.0140321000586, -27.826546507753285, -477.22606431727394, -443.5784453909068, -709.5351857210155, -369.944151982105, -124.5697660951774, -124.82259991136902, -492.8147937854451, -330.0859912886137, -1042.1306911078643, -429.08370899013215, -262.86568122356977, -877.6699563477569, -69.48074534844388, -370.79296952147916, -67.2217586232462, -171.0517520784463, -212.65960839607325, 8.322580053233768, -921.3410056154445, -385.3811958524921, -361.28172566837856, -0.14482702627598665, -112.72869400278174, -107.81823508548925, -75.06619602910794, -914.6194737825012, -1048.794359323839, -137.5161435584126, -306.06719921432693, -1078.884171155211, -534.9278209248814, -955.0923095481872, -26.72592606643316, -137.6024036880532, -155.2106497519436, -169.32441774379, -938.8546481093318], "episode_lengths": [57, 51, 128, 150, 150, 55, 150, 150, 150, 150, 136, 121, 150, 150, 106, 150, 41, 150, 110, 90, 93, 150, 79, 150, 150, 136, 66, 61, 42, 150, 121, 88, 119, 150, 109, 131, 150, 150, 107, 105, 103, 124, 150, 107, 150, 150, 64, 124, 56, 80, 36, 150, 150, 74, 47, 150, 49, 150, 81, 141, 150, 88, 50, 150, 97, 150, 119, 84, 48, 150, 107, 150, 137, 115, 150, 52, 135, 69, 56, 86, 35, 150, 118, 116, 31, 66, 65, 55, 150, 150, 61, 125, 150, 146, 150, 49, 79, 83, 96, 150], "policy_policy_0_reward": [-60.9870651788371, -39.661478934899385, -181.251409554566, -1135.0903092279036, -1230.408959769726, -152.69456499507334, -505.28413993707113, -589.9226132551202, -813.6577599187252, -497.73096000931736, -523.982781792028, -379.2181047654202, -727.0803857358319, -348.0061408233052, -311.4601302344809, -1249.590035458198, -19.66207880737376, -685.9205284537719, -300.0579879648756, -149.150902527697, -217.46433256284095, -768.7278000675285, -173.2500603744094, -503.7088481470359, -879.3481636938964, -494.5141849120413, -184.97207598426505, -84.16143760407391, -12.841018792138804, -502.7909730216218, -443.72247145056645, -386.7603581043265, -384.50959853418414, -897.2701246359411, -235.24940063290822, -460.4446950436868, -1047.7042922847243, -1324.414758098633, -553.8149572824728, -438.2360526570269, -334.5732078544729, -172.58332226119583, -1513.7935363553772, -242.93564559601137, -335.04757077799434, -938.9958546734188, -77.86760321500248, -334.80442563734357, -62.46296474082875, -155.22538823791854, -4.77243708051107, -603.7946190271094, -1006.9831007609346, -127.5318196149706, -22.6438994688935, -432.14990392374244, -46.881096099729504, -759.0726699852179, -89.51907674521044, -230.55031420913727, -981.313865808464, -119.0140321000586, -27.826546507753285, -477.22606431727394, -443.5784453909068, -709.5351857210155, -369.944151982105, -124.5697660951774, -124.82259991136902, -492.8147937854451, -330.0859912886137, -1042.1306911078643, -429.08370899013215, -262.86568122356977, -877.6699563477569, -69.48074534844388, -370.79296952147916, -67.2217586232462, -171.0517520784463, -212.65960839607325, 8.322580053233768, -921.3410056154445, -385.3811958524921, -361.28172566837856, -0.14482702627598665, -112.72869400278174, -107.81823508548925, -75.06619602910794, -914.6194737825012, -1048.794359323839, -137.5161435584126, -306.06719921432693, -1078.884171155211, -534.9278209248814, -955.0923095481872, -26.72592606643316, -137.6024036880532, -155.2106497519436, -169.32441774379, -938.8546481093318]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5570937182195115, "mean_inference_ms": 1.693748511471545, "mean_action_processing_ms": 0.27273761607400193, "mean_env_wait_ms": 3.414246289818499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013746261596679688, "StateBufferConnector_ms": 0.007822036743164062, "ViewRequirementAgentConnector_ms": 0.1920003890991211}, "num_episodes": 37, "episode_return_max": 8.322580053233768, "episode_return_min": -1513.7935363553772, "episode_return_mean": -434.49659534132405, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 446.48708183425083, "num_env_steps_trained_throughput_per_sec": 446.48708183425083, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 260000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 260000, "timers": {"training_iteration_time_ms": 11995.63, "restore_workers_time_ms": 0.035, "training_step_time_ms": 11995.547, "sample_time_ms": 1141.392, "learn_time_ms": 10792.06, "learn_throughput": 370.643, "synch_weights_time_ms": 61.243}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "done": false, "training_iteration": 65, "trial_id": "4b94b_00000", "date": "2024-08-05_11-52-57", "timestamp": 1722838977, "time_this_iter_s": 8.970611333847046, "time_total_s": 779.8625683784485, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1110a2830>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 779.8625683784485, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 21.674999999999997, "ram_util_percent": 29.20833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 107.78863360981147, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 0.0010000000000000005, "total_loss": 1.0206338780311246, "policy_loss": -0.0028531443216100647, "vf_loss": 1.0246852634785075, "vf_explained_var": 0.998139881901443, "kl": 0.015938189087592036, "entropy": 1.497080447897315, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 62880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "env_runners": {"episode_reward_max": 8.322580053233768, "episode_reward_min": -1513.7935363553772, "episode_reward_mean": -448.0669913413041, "episode_len_mean": 111.28, "episode_media": {}, "episodes_timesteps_total": 11128, "policy_reward_min": {"policy_0": -1513.7935363553772}, "policy_reward_max": {"policy_0": 8.322580053233768}, "policy_reward_mean": {"policy_0": -448.0669913413041}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-235.24940063290822, -460.4446950436868, -1047.7042922847243, -1324.414758098633, -553.8149572824728, -438.2360526570269, -334.5732078544729, -172.58332226119583, -1513.7935363553772, -242.93564559601137, -335.04757077799434, -938.9958546734188, -77.86760321500248, -334.80442563734357, -62.46296474082875, -155.22538823791854, -4.77243708051107, -603.7946190271094, -1006.9831007609346, -127.5318196149706, -22.6438994688935, -432.14990392374244, -46.881096099729504, -759.0726699852179, -89.51907674521044, -230.55031420913727, -981.313865808464, -119.0140321000586, -27.826546507753285, -477.22606431727394, -443.5784453909068, -709.5351857210155, -369.944151982105, -124.5697660951774, -124.82259991136902, -492.8147937854451, -330.0859912886137, -1042.1306911078643, -429.08370899013215, -262.86568122356977, -877.6699563477569, -69.48074534844388, -370.79296952147916, -67.2217586232462, -171.0517520784463, -212.65960839607325, 8.322580053233768, -921.3410056154445, -385.3811958524921, -361.28172566837856, -0.14482702627598665, -112.72869400278174, -107.81823508548925, -75.06619602910794, -914.6194737825012, -1048.794359323839, -137.5161435584126, -306.06719921432693, -1078.884171155211, -534.9278209248814, -955.0923095481872, -26.72592606643316, -137.6024036880532, -155.2106497519436, -169.32441774379, -938.8546481093318, -682.1859809058287, -158.76036059994655, -214.52544176885178, -763.2892002490828, -401.2010432948311, -1129.1560570874772, -825.7819653613238, -936.1128414268898, -142.3338015620898, -156.84109708466113, -998.2042776016741, -378.4606728986262, -730.7423194941492, -599.381928631024, -395.6127620380442, -1230.0556685317363, -115.29629227004126, -231.80160629508634, -153.24564633065768, -48.30297419620971, -100.5764325931444, -96.65092251932964, -349.6213107621896, -1497.672039910961, -252.3592723742665, -380.1957540615984, -439.59202606642754, -326.0972831877273, -970.6544647877193, -504.99474423188593, -409.3597969169847, -1255.63618398446, -112.45953383571498, -204.73768236644838], "episode_lengths": [109, 131, 150, 150, 107, 105, 103, 124, 150, 107, 150, 150, 64, 124, 56, 80, 36, 150, 150, 74, 47, 150, 49, 150, 81, 141, 150, 88, 50, 150, 97, 150, 119, 84, 48, 150, 107, 150, 137, 115, 150, 52, 135, 69, 56, 86, 35, 150, 118, 116, 31, 66, 65, 55, 150, 150, 61, 125, 150, 146, 150, 49, 79, 83, 96, 150, 150, 95, 150, 150, 134, 150, 150, 150, 56, 54, 150, 133, 150, 150, 118, 150, 70, 109, 81, 48, 43, 71, 150, 150, 105, 129, 150, 108, 150, 150, 150, 150, 78, 90], "policy_policy_0_reward": [-235.24940063290822, -460.4446950436868, -1047.7042922847243, -1324.414758098633, -553.8149572824728, -438.2360526570269, -334.5732078544729, -172.58332226119583, -1513.7935363553772, -242.93564559601137, -335.04757077799434, -938.9958546734188, -77.86760321500248, -334.80442563734357, -62.46296474082875, -155.22538823791854, -4.77243708051107, -603.7946190271094, -1006.9831007609346, -127.5318196149706, -22.6438994688935, -432.14990392374244, -46.881096099729504, -759.0726699852179, -89.51907674521044, -230.55031420913727, -981.313865808464, -119.0140321000586, -27.826546507753285, -477.22606431727394, -443.5784453909068, -709.5351857210155, -369.944151982105, -124.5697660951774, -124.82259991136902, -492.8147937854451, -330.0859912886137, -1042.1306911078643, -429.08370899013215, -262.86568122356977, -877.6699563477569, -69.48074534844388, -370.79296952147916, -67.2217586232462, -171.0517520784463, -212.65960839607325, 8.322580053233768, -921.3410056154445, -385.3811958524921, -361.28172566837856, -0.14482702627598665, -112.72869400278174, -107.81823508548925, -75.06619602910794, -914.6194737825012, -1048.794359323839, -137.5161435584126, -306.06719921432693, -1078.884171155211, -534.9278209248814, -955.0923095481872, -26.72592606643316, -137.6024036880532, -155.2106497519436, -169.32441774379, -938.8546481093318, -682.1859809058287, -158.76036059994655, -214.52544176885178, -763.2892002490828, -401.2010432948311, -1129.1560570874772, -825.7819653613238, -936.1128414268898, -142.3338015620898, -156.84109708466113, -998.2042776016741, -378.4606728986262, -730.7423194941492, -599.381928631024, -395.6127620380442, -1230.0556685317363, -115.29629227004126, -231.80160629508634, -153.24564633065768, -48.30297419620971, -100.5764325931444, -96.65092251932964, -349.6213107621896, -1497.672039910961, -252.3592723742665, -380.1957540615984, -439.59202606642754, -326.0972831877273, -970.6544647877193, -504.99474423188593, -409.3597969169847, -1255.63618398446, -112.45953383571498, -204.73768236644838]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5572402977236862, "mean_inference_ms": 1.6935019260137205, "mean_action_processing_ms": 0.27261454060380447, "mean_env_wait_ms": 3.415286963987335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012201309204101562, "StateBufferConnector_ms": 0.007819175720214844, "ViewRequirementAgentConnector_ms": 0.1910262107849121}, "num_episodes": 34, "episode_return_max": 8.322580053233768, "episode_return_min": -1513.7935363553772, "episode_return_mean": -448.0669913413041, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 424.43839101947793, "num_env_steps_trained_throughput_per_sec": 424.43839101947793, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 11751.303, "restore_workers_time_ms": 0.036, "training_step_time_ms": 11751.218, "sample_time_ms": 1142.93, "learn_time_ms": 10547.884, "learn_throughput": 379.223, "synch_weights_time_ms": 59.548}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "training_iteration": 66, "trial_id": "4b94b_00000", "date": "2024-08-05_11-53-06", "timestamp": 1722838986, "time_this_iter_s": 9.435710668563843, "time_total_s": 789.2982790470123, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e11156aa70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 789.2982790470123, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 19.971428571428568, "ram_util_percent": 29.19285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 95.5105852474769, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 0.0010000000000000005, "total_loss": 0.7776537853603561, "policy_loss": -0.006287724923943945, "vf_loss": 0.7851068104306856, "vf_explained_var": 0.9986016725500425, "kl": 0.014498367647380899, "entropy": 1.437145044344167, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 63840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "env_runners": {"episode_reward_max": 8.322580053233768, "episode_reward_min": -1528.6739520049628, "episode_reward_mean": -452.7266103094056, "episode_len_mean": 111.32, "episode_media": {}, "episodes_timesteps_total": 11132, "policy_reward_min": {"policy_0": -1528.6739520049628}, "policy_reward_max": {"policy_0": 8.322580053233768}, "policy_reward_mean": {"policy_0": -452.7266103094056}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1042.1306911078643, -429.08370899013215, -262.86568122356977, -877.6699563477569, -69.48074534844388, -370.79296952147916, -67.2217586232462, -171.0517520784463, -212.65960839607325, 8.322580053233768, -921.3410056154445, -385.3811958524921, -361.28172566837856, -0.14482702627598665, -112.72869400278174, -107.81823508548925, -75.06619602910794, -914.6194737825012, -1048.794359323839, -137.5161435584126, -306.06719921432693, -1078.884171155211, -534.9278209248814, -955.0923095481872, -26.72592606643316, -137.6024036880532, -155.2106497519436, -169.32441774379, -938.8546481093318, -682.1859809058287, -158.76036059994655, -214.52544176885178, -763.2892002490828, -401.2010432948311, -1129.1560570874772, -825.7819653613238, -936.1128414268898, -142.3338015620898, -156.84109708466113, -998.2042776016741, -378.4606728986262, -730.7423194941492, -599.381928631024, -395.6127620380442, -1230.0556685317363, -115.29629227004126, -231.80160629508634, -153.24564633065768, -48.30297419620971, -100.5764325931444, -96.65092251932964, -349.6213107621896, -1497.672039910961, -252.3592723742665, -380.1957540615984, -439.59202606642754, -326.0972831877273, -970.6544647877193, -504.99474423188593, -409.3597969169847, -1255.63618398446, -112.45953383571498, -204.73768236644838, -51.04055309350879, -1033.4171337811354, -703.4888426162496, -608.5297258782441, -103.94359439313246, -170.71145186552326, -581.047447848213, -87.27066611014025, -874.5021331385527, -140.1009231611251, -260.27865915900446, -304.4524198940057, -488.5436640026876, -138.17652748735526, -789.501128091524, -791.4970067120347, -22.239453531352556, -174.36239504112373, -99.65431794229262, -797.7712253539237, -115.41786757300714, -752.6840412234152, -483.8182634746606, -134.82421953461235, -126.57331232132846, -1301.1097623392466, -1528.6739520049628, -382.7897521297992, -302.4695228528788, -395.8249967656201, -20.624000205507308, -1062.6360230161738, -257.0565769497756, -247.4427196851018, -795.8079600137127, -76.15083059987991, -14.312882191996467], "episode_lengths": [150, 137, 115, 150, 52, 135, 69, 56, 86, 35, 150, 118, 116, 31, 66, 65, 55, 150, 150, 61, 125, 150, 146, 150, 49, 79, 83, 96, 150, 150, 95, 150, 150, 134, 150, 150, 150, 56, 54, 150, 133, 150, 150, 118, 150, 70, 109, 81, 48, 43, 71, 150, 150, 105, 129, 150, 108, 150, 150, 150, 150, 78, 90, 62, 150, 150, 150, 44, 97, 150, 62, 150, 74, 103, 122, 150, 82, 150, 150, 38, 89, 75, 150, 69, 150, 150, 75, 58, 150, 150, 117, 127, 109, 50, 150, 116, 150, 150, 73, 43], "policy_policy_0_reward": [-1042.1306911078643, -429.08370899013215, -262.86568122356977, -877.6699563477569, -69.48074534844388, -370.79296952147916, -67.2217586232462, -171.0517520784463, -212.65960839607325, 8.322580053233768, -921.3410056154445, -385.3811958524921, -361.28172566837856, -0.14482702627598665, -112.72869400278174, -107.81823508548925, -75.06619602910794, -914.6194737825012, -1048.794359323839, -137.5161435584126, -306.06719921432693, -1078.884171155211, -534.9278209248814, -955.0923095481872, -26.72592606643316, -137.6024036880532, -155.2106497519436, -169.32441774379, -938.8546481093318, -682.1859809058287, -158.76036059994655, -214.52544176885178, -763.2892002490828, -401.2010432948311, -1129.1560570874772, -825.7819653613238, -936.1128414268898, -142.3338015620898, -156.84109708466113, -998.2042776016741, -378.4606728986262, -730.7423194941492, -599.381928631024, -395.6127620380442, -1230.0556685317363, -115.29629227004126, -231.80160629508634, -153.24564633065768, -48.30297419620971, -100.5764325931444, -96.65092251932964, -349.6213107621896, -1497.672039910961, -252.3592723742665, -380.1957540615984, -439.59202606642754, -326.0972831877273, -970.6544647877193, -504.99474423188593, -409.3597969169847, -1255.63618398446, -112.45953383571498, -204.73768236644838, -51.04055309350879, -1033.4171337811354, -703.4888426162496, -608.5297258782441, -103.94359439313246, -170.71145186552326, -581.047447848213, -87.27066611014025, -874.5021331385527, -140.1009231611251, -260.27865915900446, -304.4524198940057, -488.5436640026876, -138.17652748735526, -789.501128091524, -791.4970067120347, -22.239453531352556, -174.36239504112373, -99.65431794229262, -797.7712253539237, -115.41786757300714, -752.6840412234152, -483.8182634746606, -134.82421953461235, -126.57331232132846, -1301.1097623392466, -1528.6739520049628, -382.7897521297992, -302.4695228528788, -395.8249967656201, -20.624000205507308, -1062.6360230161738, -257.0565769497756, -247.4427196851018, -795.8079600137127, -76.15083059987991, -14.312882191996467]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5577853209765411, "mean_inference_ms": 1.6921310826054279, "mean_action_processing_ms": 0.2726320718375538, "mean_env_wait_ms": 3.4160509198043605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01199030876159668, "StateBufferConnector_ms": 0.007885456085205078, "ViewRequirementAgentConnector_ms": 0.20132875442504883}, "num_episodes": 37, "episode_return_max": 8.322580053233768, "episode_return_min": -1528.6739520049628, "episode_return_mean": -452.7266103094056, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.84395345158606, "num_env_steps_trained_throughput_per_sec": 314.84395345158606, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 268000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 268000, "timers": {"training_iteration_time_ms": 11765.076, "restore_workers_time_ms": 0.036, "training_step_time_ms": 11764.993, "sample_time_ms": 1146.561, "learn_time_ms": 10557.11, "learn_throughput": 378.892, "synch_weights_time_ms": 60.467}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "done": false, "training_iteration": 67, "trial_id": "4b94b_00000", "date": "2024-08-05_11-53-19", "timestamp": 1722838999, "time_this_iter_s": 12.716655731201172, "time_total_s": 802.0149347782135, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1111105e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 802.0149347782135, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 18.077777777777776, "ram_util_percent": 29.188888888888886}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 93.85382288694382, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 0.0010000000000000005, "total_loss": 0.821189311488221, "policy_loss": -0.004343692534409153, "vf_loss": 0.8265588795145352, "vf_explained_var": 0.9981832278892397, "kl": 0.016724495734221568, "entropy": 1.3394591150184472, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 64800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 4.303070151787467, "episode_reward_min": -1528.6739520049628, "episode_reward_mean": -448.92765073033917, "episode_len_mean": 111.75, "episode_media": {}, "episodes_timesteps_total": 11175, "policy_reward_min": {"policy_0": -1528.6739520049628}, "policy_reward_max": {"policy_0": 4.303070151787467}, "policy_reward_mean": {"policy_0": -448.92765073033917}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1129.1560570874772, -825.7819653613238, -936.1128414268898, -142.3338015620898, -156.84109708466113, -998.2042776016741, -378.4606728986262, -730.7423194941492, -599.381928631024, -395.6127620380442, -1230.0556685317363, -115.29629227004126, -231.80160629508634, -153.24564633065768, -48.30297419620971, -100.5764325931444, -96.65092251932964, -349.6213107621896, -1497.672039910961, -252.3592723742665, -380.1957540615984, -439.59202606642754, -326.0972831877273, -970.6544647877193, -504.99474423188593, -409.3597969169847, -1255.63618398446, -112.45953383571498, -204.73768236644838, -51.04055309350879, -1033.4171337811354, -703.4888426162496, -608.5297258782441, -103.94359439313246, -170.71145186552326, -581.047447848213, -87.27066611014025, -874.5021331385527, -140.1009231611251, -260.27865915900446, -304.4524198940057, -488.5436640026876, -138.17652748735526, -789.501128091524, -791.4970067120347, -22.239453531352556, -174.36239504112373, -99.65431794229262, -797.7712253539237, -115.41786757300714, -752.6840412234152, -483.8182634746606, -134.82421953461235, -126.57331232132846, -1301.1097623392466, -1528.6739520049628, -382.7897521297992, -302.4695228528788, -395.8249967656201, -20.624000205507308, -1062.6360230161738, -257.0565769497756, -247.4427196851018, -795.8079600137127, -76.15083059987991, -14.312882191996467, -219.40570584541754, -986.9106854961755, -104.20166782246805, -103.99593554105115, -576.3900797133151, -13.138275513048908, -272.1183987506112, -44.58030258906202, -834.6524798299391, -478.57843948985453, -166.38572590331555, -181.39612348928642, -154.25436786909626, -813.3365711496215, -97.829305268723, -52.980147801932716, -685.2287333881393, -282.9738458543562, -929.928706447161, -154.12686388040393, -905.1587910020949, -126.28580364661825, -478.6431990630937, -868.0712745807343, -180.9684273240325, -768.4744337527634, -1034.081232919799, -74.33352945814427, -97.30687237367336, -200.46423566578605, -1211.0194488894297, 4.303070151787467, -322.7749487211165, -286.3902737540802], "episode_lengths": [150, 150, 150, 56, 54, 150, 133, 150, 150, 118, 150, 70, 109, 81, 48, 43, 71, 150, 150, 105, 129, 150, 108, 150, 150, 150, 150, 78, 90, 62, 150, 150, 150, 44, 97, 150, 62, 150, 74, 103, 122, 150, 82, 150, 150, 38, 89, 75, 150, 69, 150, 150, 75, 58, 150, 150, 117, 127, 109, 50, 150, 116, 150, 150, 73, 43, 103, 150, 48, 69, 150, 42, 107, 53, 150, 150, 99, 83, 52, 150, 150, 60, 150, 100, 150, 81, 150, 74, 150, 150, 80, 150, 150, 69, 66, 137, 150, 31, 125, 118], "policy_policy_0_reward": [-1129.1560570874772, -825.7819653613238, -936.1128414268898, -142.3338015620898, -156.84109708466113, -998.2042776016741, -378.4606728986262, -730.7423194941492, -599.381928631024, -395.6127620380442, -1230.0556685317363, -115.29629227004126, -231.80160629508634, -153.24564633065768, -48.30297419620971, -100.5764325931444, -96.65092251932964, -349.6213107621896, -1497.672039910961, -252.3592723742665, -380.1957540615984, -439.59202606642754, -326.0972831877273, -970.6544647877193, -504.99474423188593, -409.3597969169847, -1255.63618398446, -112.45953383571498, -204.73768236644838, -51.04055309350879, -1033.4171337811354, -703.4888426162496, -608.5297258782441, -103.94359439313246, -170.71145186552326, -581.047447848213, -87.27066611014025, -874.5021331385527, -140.1009231611251, -260.27865915900446, -304.4524198940057, -488.5436640026876, -138.17652748735526, -789.501128091524, -791.4970067120347, -22.239453531352556, -174.36239504112373, -99.65431794229262, -797.7712253539237, -115.41786757300714, -752.6840412234152, -483.8182634746606, -134.82421953461235, -126.57331232132846, -1301.1097623392466, -1528.6739520049628, -382.7897521297992, -302.4695228528788, -395.8249967656201, -20.624000205507308, -1062.6360230161738, -257.0565769497756, -247.4427196851018, -795.8079600137127, -76.15083059987991, -14.312882191996467, -219.40570584541754, -986.9106854961755, -104.20166782246805, -103.99593554105115, -576.3900797133151, -13.138275513048908, -272.1183987506112, -44.58030258906202, -834.6524798299391, -478.57843948985453, -166.38572590331555, -181.39612348928642, -154.25436786909626, -813.3365711496215, -97.829305268723, -52.980147801932716, -685.2287333881393, -282.9738458543562, -929.928706447161, -154.12686388040393, -905.1587910020949, -126.28580364661825, -478.6431990630937, -868.0712745807343, -180.9684273240325, -768.4744337527634, -1034.081232919799, -74.33352945814427, -97.30687237367336, -200.46423566578605, -1211.0194488894297, 4.303070151787467, -322.7749487211165, -286.3902737540802]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5564571037827826, "mean_inference_ms": 1.6920766179429287, "mean_action_processing_ms": 0.27250484830388894, "mean_env_wait_ms": 3.4164319661355314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01233220100402832, "StateBufferConnector_ms": 0.007840633392333984, "ViewRequirementAgentConnector_ms": 0.20110511779785156}, "num_episodes": 34, "episode_return_max": 4.303070151787467, "episode_return_min": -1528.6739520049628, "episode_return_mean": -448.92765073033917, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.23393947228436, "num_env_steps_trained_throughput_per_sec": 312.23393947228436, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 11726.258, "restore_workers_time_ms": 0.035, "training_step_time_ms": 11726.177, "sample_time_ms": 1130.186, "learn_time_ms": 10534.852, "learn_throughput": 379.692, "synch_weights_time_ms": 60.336}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 68, "trial_id": "4b94b_00000", "date": "2024-08-05_11-53-32", "timestamp": 1722839012, "time_this_iter_s": 12.82344102859497, "time_total_s": 814.8383758068085, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1111137f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 814.8383758068085, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 17.98888888888889, "ram_util_percent": 29.16111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 112.93403380016485, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 0.0010000000000000005, "total_loss": 0.8128040963201784, "policy_loss": -0.0023301951402875903, "vf_loss": 0.8165818305220455, "vf_explained_var": 0.99837897674491, "kl": 0.015850421530437163, "entropy": 1.7447348203510047, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 65760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "env_runners": {"episode_reward_max": 4.303070151787467, "episode_reward_min": -1528.6739520049628, "episode_reward_mean": -432.7290946689373, "episode_len_mean": 111.45, "episode_media": {}, "episodes_timesteps_total": 11145, "policy_reward_min": {"policy_0": -1528.6739520049628}, "policy_reward_max": {"policy_0": 4.303070151787467}, "policy_reward_mean": {"policy_0": -432.7290946689373}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-581.047447848213, -87.27066611014025, -874.5021331385527, -140.1009231611251, -260.27865915900446, -304.4524198940057, -488.5436640026876, -138.17652748735526, -789.501128091524, -791.4970067120347, -22.239453531352556, -174.36239504112373, -99.65431794229262, -797.7712253539237, -115.41786757300714, -752.6840412234152, -483.8182634746606, -134.82421953461235, -126.57331232132846, -1301.1097623392466, -1528.6739520049628, -382.7897521297992, -302.4695228528788, -395.8249967656201, -20.624000205507308, -1062.6360230161738, -257.0565769497756, -247.4427196851018, -795.8079600137127, -76.15083059987991, -14.312882191996467, -219.40570584541754, -986.9106854961755, -104.20166782246805, -103.99593554105115, -576.3900797133151, -13.138275513048908, -272.1183987506112, -44.58030258906202, -834.6524798299391, -478.57843948985453, -166.38572590331555, -181.39612348928642, -154.25436786909626, -813.3365711496215, -97.829305268723, -52.980147801932716, -685.2287333881393, -282.9738458543562, -929.928706447161, -154.12686388040393, -905.1587910020949, -126.28580364661825, -478.6431990630937, -868.0712745807343, -180.9684273240325, -768.4744337527634, -1034.081232919799, -74.33352945814427, -97.30687237367336, -200.46423566578605, -1211.0194488894297, 4.303070151787467, -322.7749487211165, -286.3902737540802, -456.1212280198279, -919.1207645893141, -32.29846679162832, -166.99123722990117, -488.08456110405876, -814.0545801287775, -495.5797211933465, -85.68703565235788, -660.623000931797, -764.7790071897509, -394.75342541595836, -431.0506477506955, -669.3029150208414, -879.9762830122652, -596.1558484891145, -362.45934452738214, -266.857077369217, -130.00700401879507, -271.46454545138346, -43.04157341695706, -1282.9529183378054, -167.51593211869354, -89.70064098083658, -1112.378286586409, -34.599250643360165, -292.5683338621356, -72.17616814329033, -248.17693008789618, -1082.4981366498844, -815.4324237346085, -890.8713626697012, -60.74364272689665, -491.28020857666456, -212.30166363365564, -241.60888784095226], "episode_lengths": [150, 62, 150, 74, 103, 122, 150, 82, 150, 150, 38, 89, 75, 150, 69, 150, 150, 75, 58, 150, 150, 117, 127, 109, 50, 150, 116, 150, 150, 73, 43, 103, 150, 48, 69, 150, 42, 107, 53, 150, 150, 99, 83, 52, 150, 150, 60, 150, 100, 150, 81, 150, 74, 150, 150, 80, 150, 150, 69, 66, 137, 150, 31, 125, 118, 133, 150, 55, 89, 146, 150, 149, 73, 150, 150, 150, 105, 150, 150, 150, 150, 78, 78, 93, 45, 150, 60, 65, 150, 59, 121, 39, 71, 150, 150, 150, 63, 150, 100, 144], "policy_policy_0_reward": [-581.047447848213, -87.27066611014025, -874.5021331385527, -140.1009231611251, -260.27865915900446, -304.4524198940057, -488.5436640026876, -138.17652748735526, -789.501128091524, -791.4970067120347, -22.239453531352556, -174.36239504112373, -99.65431794229262, -797.7712253539237, -115.41786757300714, -752.6840412234152, -483.8182634746606, -134.82421953461235, -126.57331232132846, -1301.1097623392466, -1528.6739520049628, -382.7897521297992, -302.4695228528788, -395.8249967656201, -20.624000205507308, -1062.6360230161738, -257.0565769497756, -247.4427196851018, -795.8079600137127, -76.15083059987991, -14.312882191996467, -219.40570584541754, -986.9106854961755, -104.20166782246805, -103.99593554105115, -576.3900797133151, -13.138275513048908, -272.1183987506112, -44.58030258906202, -834.6524798299391, -478.57843948985453, -166.38572590331555, -181.39612348928642, -154.25436786909626, -813.3365711496215, -97.829305268723, -52.980147801932716, -685.2287333881393, -282.9738458543562, -929.928706447161, -154.12686388040393, -905.1587910020949, -126.28580364661825, -478.6431990630937, -868.0712745807343, -180.9684273240325, -768.4744337527634, -1034.081232919799, -74.33352945814427, -97.30687237367336, -200.46423566578605, -1211.0194488894297, 4.303070151787467, -322.7749487211165, -286.3902737540802, -456.1212280198279, -919.1207645893141, -32.29846679162832, -166.99123722990117, -488.08456110405876, -814.0545801287775, -495.5797211933465, -85.68703565235788, -660.623000931797, -764.7790071897509, -394.75342541595836, -431.0506477506955, -669.3029150208414, -879.9762830122652, -596.1558484891145, -362.45934452738214, -266.857077369217, -130.00700401879507, -271.46454545138346, -43.04157341695706, -1282.9529183378054, -167.51593211869354, -89.70064098083658, -1112.378286586409, -34.599250643360165, -292.5683338621356, -72.17616814329033, -248.17693008789618, -1082.4981366498844, -815.4324237346085, -890.8713626697012, -60.74364272689665, -491.28020857666456, -212.30166363365564, -241.60888784095226]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5563943053466957, "mean_inference_ms": 1.691122727964638, "mean_action_processing_ms": 0.27266468951489015, "mean_env_wait_ms": 3.416197685786299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012503862380981445, "StateBufferConnector_ms": 0.007927894592285156, "ViewRequirementAgentConnector_ms": 0.20380616188049316}, "num_episodes": 35, "episode_return_max": 4.303070151787467, "episode_return_min": -1528.6739520049628, "episode_return_mean": -432.7290946689373, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.3293011320485, "num_env_steps_trained_throughput_per_sec": 323.3293011320485, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 276000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 11646.888, "restore_workers_time_ms": 0.035, "training_step_time_ms": 11646.807, "sample_time_ms": 1130.397, "learn_time_ms": 10456.139, "learn_throughput": 382.55, "synch_weights_time_ms": 59.497}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "training_iteration": 69, "trial_id": "4b94b_00000", "date": "2024-08-05_11-53-44", "timestamp": 1722839024, "time_this_iter_s": 12.382315397262573, "time_total_s": 827.220691204071, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd01009d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 827.220691204071, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 18.15555555555555, "ram_util_percent": 29.12222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 108.35595216453075, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 0.0010000000000000005, "total_loss": 0.994457247108221, "policy_loss": -0.0024538078922584344, "vf_loss": 0.9981709442101419, "vf_explained_var": 0.9981021447107196, "kl": 0.023559788587105383, "entropy": 1.7016365158061186, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 66720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "env_runners": {"episode_reward_max": 4.303070151787467, "episode_reward_min": -1467.0401019402557, "episode_reward_mean": -434.13631057399215, "episode_len_mean": 107.46, "episode_media": {}, "episodes_timesteps_total": 10746, "policy_reward_min": {"policy_0": -1467.0401019402557}, "policy_reward_max": {"policy_0": 4.303070151787467}, "policy_reward_mean": {"policy_0": -434.13631057399215}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-166.38572590331555, -181.39612348928642, -154.25436786909626, -813.3365711496215, -97.829305268723, -52.980147801932716, -685.2287333881393, -282.9738458543562, -929.928706447161, -154.12686388040393, -905.1587910020949, -126.28580364661825, -478.6431990630937, -868.0712745807343, -180.9684273240325, -768.4744337527634, -1034.081232919799, -74.33352945814427, -97.30687237367336, -200.46423566578605, -1211.0194488894297, 4.303070151787467, -322.7749487211165, -286.3902737540802, -456.1212280198279, -919.1207645893141, -32.29846679162832, -166.99123722990117, -488.08456110405876, -814.0545801287775, -495.5797211933465, -85.68703565235788, -660.623000931797, -764.7790071897509, -394.75342541595836, -431.0506477506955, -669.3029150208414, -879.9762830122652, -596.1558484891145, -362.45934452738214, -266.857077369217, -130.00700401879507, -271.46454545138346, -43.04157341695706, -1282.9529183378054, -167.51593211869354, -89.70064098083658, -1112.378286586409, -34.599250643360165, -292.5683338621356, -72.17616814329033, -248.17693008789618, -1082.4981366498844, -815.4324237346085, -890.8713626697012, -60.74364272689665, -491.28020857666456, -212.30166363365564, -241.60888784095226, -1159.5413399451281, -171.32194453809572, -83.08962719760656, -16.397165412376346, 1.2657342999345884, -1140.3752773479223, -1467.0401019402557, -34.02878496214291, -16.056690543145496, -102.13628824832139, -186.76692314898668, -996.6084169751252, -275.0546717605881, -165.72337066871043, -268.3930913926678, -114.31494926846518, -196.28236670913924, -150.74540389764326, -33.30340761823433, -911.6165808452984, -837.4020587953502, -483.0482442961708, -132.1836187066349, -67.83736528383574, -680.7241958424337, -166.73788716603613, -1373.8689815168202, -7.134350427348749, -1218.2794353533, -104.3546838419099, -188.6148956433987, -970.2143032766571, -102.68329550571143, -236.85597667940846, -189.6253683152479, -476.72528003448616, -831.8178508983871, -1050.009136990287, -217.19172618866824, -337.50493314724616, -161.96395542217556], "episode_lengths": [99, 83, 52, 150, 150, 60, 150, 100, 150, 81, 150, 74, 150, 150, 80, 150, 150, 69, 66, 137, 150, 31, 125, 118, 133, 150, 55, 89, 146, 150, 149, 73, 150, 150, 150, 105, 150, 150, 150, 150, 78, 78, 93, 45, 150, 60, 65, 150, 59, 121, 39, 71, 150, 150, 150, 63, 150, 100, 144, 150, 57, 58, 50, 37, 150, 150, 53, 43, 84, 62, 150, 114, 75, 96, 78, 82, 76, 57, 150, 150, 113, 86, 67, 150, 99, 150, 40, 150, 63, 70, 150, 58, 130, 86, 149, 150, 150, 104, 105, 63], "policy_policy_0_reward": [-166.38572590331555, -181.39612348928642, -154.25436786909626, -813.3365711496215, -97.829305268723, -52.980147801932716, -685.2287333881393, -282.9738458543562, -929.928706447161, -154.12686388040393, -905.1587910020949, -126.28580364661825, -478.6431990630937, -868.0712745807343, -180.9684273240325, -768.4744337527634, -1034.081232919799, -74.33352945814427, -97.30687237367336, -200.46423566578605, -1211.0194488894297, 4.303070151787467, -322.7749487211165, -286.3902737540802, -456.1212280198279, -919.1207645893141, -32.29846679162832, -166.99123722990117, -488.08456110405876, -814.0545801287775, -495.5797211933465, -85.68703565235788, -660.623000931797, -764.7790071897509, -394.75342541595836, -431.0506477506955, -669.3029150208414, -879.9762830122652, -596.1558484891145, -362.45934452738214, -266.857077369217, -130.00700401879507, -271.46454545138346, -43.04157341695706, -1282.9529183378054, -167.51593211869354, -89.70064098083658, -1112.378286586409, -34.599250643360165, -292.5683338621356, -72.17616814329033, -248.17693008789618, -1082.4981366498844, -815.4324237346085, -890.8713626697012, -60.74364272689665, -491.28020857666456, -212.30166363365564, -241.60888784095226, -1159.5413399451281, -171.32194453809572, -83.08962719760656, -16.397165412376346, 1.2657342999345884, -1140.3752773479223, -1467.0401019402557, -34.02878496214291, -16.056690543145496, -102.13628824832139, -186.76692314898668, -996.6084169751252, -275.0546717605881, -165.72337066871043, -268.3930913926678, -114.31494926846518, -196.28236670913924, -150.74540389764326, -33.30340761823433, -911.6165808452984, -837.4020587953502, -483.0482442961708, -132.1836187066349, -67.83736528383574, -680.7241958424337, -166.73788716603613, -1373.8689815168202, -7.134350427348749, -1218.2794353533, -104.3546838419099, -188.6148956433987, -970.2143032766571, -102.68329550571143, -236.85597667940846, -189.6253683152479, -476.72528003448616, -831.8178508983871, -1050.009136990287, -217.19172618866824, -337.50493314724616, -161.96395542217556]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5569679505585632, "mean_inference_ms": 1.6923007503659366, "mean_action_processing_ms": 0.2729509479013458, "mean_env_wait_ms": 3.417552310232005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01252603530883789, "StateBufferConnector_ms": 0.008131742477416992, "ViewRequirementAgentConnector_ms": 0.20572662353515625}, "num_episodes": 41, "episode_return_max": 4.303070151787467, "episode_return_min": -1467.0401019402557, "episode_return_mean": -434.13631057399215, "episodes_this_iter": 41}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 486.3097044218859, "num_env_steps_trained_throughput_per_sec": 486.3097044218859, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 11234.168, "restore_workers_time_ms": 0.033, "training_step_time_ms": 11234.088, "sample_time_ms": 1139.891, "learn_time_ms": 10034.742, "learn_throughput": 398.615, "synch_weights_time_ms": 58.679}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "training_iteration": 70, "trial_id": "4b94b_00000", "date": "2024-08-05_11-53-53", "timestamp": 1722839033, "time_this_iter_s": 8.237895011901855, "time_total_s": 835.4585862159729, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e111113ac0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 835.4585862159729, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 21.866666666666664, "ram_util_percent": 29.12500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 95.60497898558775, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.0010000000000000005, "total_loss": 1.036456949946781, "policy_loss": -0.0048715157279123865, "vf_loss": 1.042295855159561, "vf_explained_var": 0.9979491223270694, "kl": 0.017978335013928395, "entropy": 1.473030914242069, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 67680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "env_runners": {"episode_reward_max": 1.2657342999345884, "episode_reward_min": -1467.0401019402557, "episode_reward_mean": -406.6235213545596, "episode_len_mean": 99.39, "episode_media": {}, "episodes_timesteps_total": 9939, "policy_reward_min": {"policy_0": -1467.0401019402557}, "policy_reward_max": {"policy_0": 1.2657342999345884}, "policy_reward_mean": {"policy_0": -406.6235213545596}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-130.00700401879507, -271.46454545138346, -43.04157341695706, -1282.9529183378054, -167.51593211869354, -89.70064098083658, -1112.378286586409, -34.599250643360165, -292.5683338621356, -72.17616814329033, -248.17693008789618, -1082.4981366498844, -815.4324237346085, -890.8713626697012, -60.74364272689665, -491.28020857666456, -212.30166363365564, -241.60888784095226, -1159.5413399451281, -171.32194453809572, -83.08962719760656, -16.397165412376346, 1.2657342999345884, -1140.3752773479223, -1467.0401019402557, -34.02878496214291, -16.056690543145496, -102.13628824832139, -186.76692314898668, -996.6084169751252, -275.0546717605881, -165.72337066871043, -268.3930913926678, -114.31494926846518, -196.28236670913924, -150.74540389764326, -33.30340761823433, -911.6165808452984, -837.4020587953502, -483.0482442961708, -132.1836187066349, -67.83736528383574, -680.7241958424337, -166.73788716603613, -1373.8689815168202, -7.134350427348749, -1218.2794353533, -104.3546838419099, -188.6148956433987, -970.2143032766571, -102.68329550571143, -236.85597667940846, -189.6253683152479, -476.72528003448616, -831.8178508983871, -1050.009136990287, -217.19172618866824, -337.50493314724616, -161.96395542217556, -1303.2050242786854, -351.6361410692368, -920.4040837382239, -267.9426538309367, -479.05680469908816, -120.65444400585234, -585.1940641863855, -455.9109625645424, 0.48700750129520465, -274.35027700175954, -13.305622850463644, -261.96451128047687, -1069.8993292330044, -1078.598675336695, -153.67909068401957, -18.329446398738195, -1207.5509721763676, -7.794629749534782, -22.169886318680884, -516.5831416245763, -34.02421228185573, -123.55939913209377, -93.97353997456045, -727.2410142972434, -177.22018568948485, -230.08658088692286, -865.9390581463857, -1434.9223062899273, -552.3538611883546, -246.50939629385238, -240.29283437952947, -2.3428568522160242, -128.73705010385115, -87.80769958896329, -118.53423198637961, -207.0305793219586, -232.94238141625206, -35.18255168645988, -166.00908114333134, -689.5135520925901, -298.76088824641755], "episode_lengths": [78, 93, 45, 150, 60, 65, 150, 59, 121, 39, 71, 150, 150, 150, 63, 150, 100, 144, 150, 57, 58, 50, 37, 150, 150, 53, 43, 84, 62, 150, 114, 75, 96, 78, 82, 76, 57, 150, 150, 113, 86, 67, 150, 99, 150, 40, 150, 63, 70, 150, 58, 130, 86, 149, 150, 150, 104, 105, 63, 150, 105, 150, 104, 130, 59, 150, 150, 29, 103, 40, 77, 150, 150, 88, 39, 150, 40, 49, 150, 60, 68, 81, 150, 59, 89, 150, 150, 142, 117, 92, 40, 73, 50, 90, 105, 89, 47, 66, 150, 115], "policy_policy_0_reward": [-130.00700401879507, -271.46454545138346, -43.04157341695706, -1282.9529183378054, -167.51593211869354, -89.70064098083658, -1112.378286586409, -34.599250643360165, -292.5683338621356, -72.17616814329033, -248.17693008789618, -1082.4981366498844, -815.4324237346085, -890.8713626697012, -60.74364272689665, -491.28020857666456, -212.30166363365564, -241.60888784095226, -1159.5413399451281, -171.32194453809572, -83.08962719760656, -16.397165412376346, 1.2657342999345884, -1140.3752773479223, -1467.0401019402557, -34.02878496214291, -16.056690543145496, -102.13628824832139, -186.76692314898668, -996.6084169751252, -275.0546717605881, -165.72337066871043, -268.3930913926678, -114.31494926846518, -196.28236670913924, -150.74540389764326, -33.30340761823433, -911.6165808452984, -837.4020587953502, -483.0482442961708, -132.1836187066349, -67.83736528383574, -680.7241958424337, -166.73788716603613, -1373.8689815168202, -7.134350427348749, -1218.2794353533, -104.3546838419099, -188.6148956433987, -970.2143032766571, -102.68329550571143, -236.85597667940846, -189.6253683152479, -476.72528003448616, -831.8178508983871, -1050.009136990287, -217.19172618866824, -337.50493314724616, -161.96395542217556, -1303.2050242786854, -351.6361410692368, -920.4040837382239, -267.9426538309367, -479.05680469908816, -120.65444400585234, -585.1940641863855, -455.9109625645424, 0.48700750129520465, -274.35027700175954, -13.305622850463644, -261.96451128047687, -1069.8993292330044, -1078.598675336695, -153.67909068401957, -18.329446398738195, -1207.5509721763676, -7.794629749534782, -22.169886318680884, -516.5831416245763, -34.02421228185573, -123.55939913209377, -93.97353997456045, -727.2410142972434, -177.22018568948485, -230.08658088692286, -865.9390581463857, -1434.9223062899273, -552.3538611883546, -246.50939629385238, -240.29283437952947, -2.3428568522160242, -128.73705010385115, -87.80769958896329, -118.53423198637961, -207.0305793219586, -232.94238141625206, -35.18255168645988, -166.00908114333134, -689.5135520925901, -298.76088824641755]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5576663684533714, "mean_inference_ms": 1.6918504899683307, "mean_action_processing_ms": 0.273233047199597, "mean_env_wait_ms": 3.4173786109633553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012019634246826172, "StateBufferConnector_ms": 0.008147001266479492, "ViewRequirementAgentConnector_ms": 0.20366692543029785}, "num_episodes": 41, "episode_return_max": 1.2657342999345884, "episode_return_min": -1467.0401019402557, "episode_return_mean": -406.6235213545596, "episodes_this_iter": 41}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 322.0120409110676, "num_env_steps_trained_throughput_per_sec": 322.0120409110676, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 284000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 284000, "timers": {"training_iteration_time_ms": 11226.315, "restore_workers_time_ms": 0.034, "training_step_time_ms": 11226.235, "sample_time_ms": 1134.382, "learn_time_ms": 10033.304, "learn_throughput": 398.672, "synch_weights_time_ms": 57.775}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "done": false, "training_iteration": 71, "trial_id": "4b94b_00000", "date": "2024-08-05_11-54-05", "timestamp": 1722839045, "time_this_iter_s": 12.433544874191284, "time_total_s": 847.8921310901642, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd01016c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 847.8921310901642, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 18.341176470588234, "ram_util_percent": 29.11764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 100.30464285612106, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.0010000000000000005, "total_loss": 0.8794660015342136, "policy_loss": 0.0025950995443660457, "vf_loss": 0.8778857831843198, "vf_explained_var": 0.9990029451747735, "kl": 0.022327943297265545, "entropy": 1.6428572536756596, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 68640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 0.48700750129520465, "episode_reward_min": -1434.9223062899273, "episode_reward_mean": -415.8256381949714, "episode_len_mean": 103.88, "episode_media": {}, "episodes_timesteps_total": 10388, "policy_reward_min": {"policy_0": -1434.9223062899273}, "policy_reward_max": {"policy_0": 0.48700750129520465}, "policy_reward_mean": {"policy_0": -415.8256381949714}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-911.6165808452984, -837.4020587953502, -483.0482442961708, -132.1836187066349, -67.83736528383574, -680.7241958424337, -166.73788716603613, -1373.8689815168202, -7.134350427348749, -1218.2794353533, -104.3546838419099, -188.6148956433987, -970.2143032766571, -102.68329550571143, -236.85597667940846, -189.6253683152479, -476.72528003448616, -831.8178508983871, -1050.009136990287, -217.19172618866824, -337.50493314724616, -161.96395542217556, -1303.2050242786854, -351.6361410692368, -920.4040837382239, -267.9426538309367, -479.05680469908816, -120.65444400585234, -585.1940641863855, -455.9109625645424, 0.48700750129520465, -274.35027700175954, -13.305622850463644, -261.96451128047687, -1069.8993292330044, -1078.598675336695, -153.67909068401957, -18.329446398738195, -1207.5509721763676, -7.794629749534782, -22.169886318680884, -516.5831416245763, -34.02421228185573, -123.55939913209377, -93.97353997456045, -727.2410142972434, -177.22018568948485, -230.08658088692286, -865.9390581463857, -1434.9223062899273, -552.3538611883546, -246.50939629385238, -240.29283437952947, -2.3428568522160242, -128.73705010385115, -87.80769958896329, -118.53423198637961, -207.0305793219586, -232.94238141625206, -35.18255168645988, -166.00908114333134, -689.5135520925901, -298.76088824641755, -175.08044551925727, -699.1726003073368, -232.28937562023023, -87.7231306417631, -1003.3126872789426, -427.0826951029147, -775.7520307736896, -118.53695346586838, -441.06991416545935, -759.8854432614397, -112.24673733616949, -164.31873208072764, -338.3033930346244, -95.97014610324943, -1020.8107215762487, -116.00711798554892, -12.199593808738179, -35.56540990993151, -243.77324899111716, -303.9128765204066, -1269.714110766873, -1421.58637722874, -713.3344447499348, -396.5911816354066, -95.17613819226503, -299.92807800602714, -67.48907532160297, -76.05289308020325, -88.84490598101067, -54.29408624896009, -197.1111281386088, -439.1694689286671, -181.15591109318962, -207.74438207744728, -148.72298597589173, -1239.932110719642, -975.5831491675888], "episode_lengths": [150, 150, 113, 86, 67, 150, 99, 150, 40, 150, 63, 70, 150, 58, 130, 86, 149, 150, 150, 104, 105, 63, 150, 105, 150, 104, 130, 59, 150, 150, 29, 103, 40, 77, 150, 150, 88, 39, 150, 40, 49, 150, 60, 68, 81, 150, 59, 89, 150, 150, 142, 117, 92, 40, 73, 50, 90, 105, 89, 47, 66, 150, 115, 70, 150, 99, 72, 150, 148, 150, 80, 132, 150, 79, 81, 150, 72, 150, 87, 41, 58, 85, 124, 150, 150, 150, 121, 66, 92, 62, 57, 65, 45, 98, 142, 90, 96, 97, 150, 150], "policy_policy_0_reward": [-911.6165808452984, -837.4020587953502, -483.0482442961708, -132.1836187066349, -67.83736528383574, -680.7241958424337, -166.73788716603613, -1373.8689815168202, -7.134350427348749, -1218.2794353533, -104.3546838419099, -188.6148956433987, -970.2143032766571, -102.68329550571143, -236.85597667940846, -189.6253683152479, -476.72528003448616, -831.8178508983871, -1050.009136990287, -217.19172618866824, -337.50493314724616, -161.96395542217556, -1303.2050242786854, -351.6361410692368, -920.4040837382239, -267.9426538309367, -479.05680469908816, -120.65444400585234, -585.1940641863855, -455.9109625645424, 0.48700750129520465, -274.35027700175954, -13.305622850463644, -261.96451128047687, -1069.8993292330044, -1078.598675336695, -153.67909068401957, -18.329446398738195, -1207.5509721763676, -7.794629749534782, -22.169886318680884, -516.5831416245763, -34.02421228185573, -123.55939913209377, -93.97353997456045, -727.2410142972434, -177.22018568948485, -230.08658088692286, -865.9390581463857, -1434.9223062899273, -552.3538611883546, -246.50939629385238, -240.29283437952947, -2.3428568522160242, -128.73705010385115, -87.80769958896329, -118.53423198637961, -207.0305793219586, -232.94238141625206, -35.18255168645988, -166.00908114333134, -689.5135520925901, -298.76088824641755, -175.08044551925727, -699.1726003073368, -232.28937562023023, -87.7231306417631, -1003.3126872789426, -427.0826951029147, -775.7520307736896, -118.53695346586838, -441.06991416545935, -759.8854432614397, -112.24673733616949, -164.31873208072764, -338.3033930346244, -95.97014610324943, -1020.8107215762487, -116.00711798554892, -12.199593808738179, -35.56540990993151, -243.77324899111716, -303.9128765204066, -1269.714110766873, -1421.58637722874, -713.3344447499348, -396.5911816354066, -95.17613819226503, -299.92807800602714, -67.48907532160297, -76.05289308020325, -88.84490598101067, -54.29408624896009, -197.1111281386088, -439.1694689286671, -181.15591109318962, -207.74438207744728, -148.72298597589173, -1239.932110719642, -975.5831491675888]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5563300467694429, "mean_inference_ms": 1.6907494152069251, "mean_action_processing_ms": 0.27344768181878, "mean_env_wait_ms": 3.4166213114996333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012146234512329102, "StateBufferConnector_ms": 0.0080718994140625, "ViewRequirementAgentConnector_ms": 0.20162320137023926}, "num_episodes": 37, "episode_return_max": 0.48700750129520465, "episode_return_min": -1434.9223062899273, "episode_return_mean": -415.8256381949714, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.89411204766884, "num_env_steps_trained_throughput_per_sec": 314.89411204766884, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 11526.508, "restore_workers_time_ms": 0.035, "training_step_time_ms": 11526.425, "sample_time_ms": 1128.648, "learn_time_ms": 10337.977, "learn_throughput": 386.923, "synch_weights_time_ms": 59.015}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 72, "trial_id": "4b94b_00000", "date": "2024-08-05_11-54-18", "timestamp": 1722839058, "time_this_iter_s": 12.71391248703003, "time_total_s": 860.6060435771942, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd0102320>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 860.6060435771942, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 18.061111111111106, "ram_util_percent": 29.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 107.83063911497592, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.0897843167185783, "policy_loss": -0.0007413712019721667, "vf_loss": 1.0915740341258546, "vf_explained_var": 0.9973856292044123, "kl": 0.014458377402297702, "entropy": 1.658308321237564, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 69600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "env_runners": {"episode_reward_max": -2.3428568522160242, "episode_reward_min": -1531.3876218973996, "episode_reward_mean": -425.3486855710151, "episode_len_mean": 106.13, "episode_media": {}, "episodes_timesteps_total": 10613, "policy_reward_min": {"policy_0": -1531.3876218973996}, "policy_reward_max": {"policy_0": -2.3428568522160242}, "policy_reward_mean": {"policy_0": -425.3486855710151}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.329446398738195, -1207.5509721763676, -7.794629749534782, -22.169886318680884, -516.5831416245763, -34.02421228185573, -123.55939913209377, -93.97353997456045, -727.2410142972434, -177.22018568948485, -230.08658088692286, -865.9390581463857, -1434.9223062899273, -552.3538611883546, -246.50939629385238, -240.29283437952947, -2.3428568522160242, -128.73705010385115, -87.80769958896329, -118.53423198637961, -207.0305793219586, -232.94238141625206, -35.18255168645988, -166.00908114333134, -689.5135520925901, -298.76088824641755, -175.08044551925727, -699.1726003073368, -232.28937562023023, -87.7231306417631, -1003.3126872789426, -427.0826951029147, -775.7520307736896, -118.53695346586838, -441.06991416545935, -759.8854432614397, -112.24673733616949, -164.31873208072764, -338.3033930346244, -95.97014610324943, -1020.8107215762487, -116.00711798554892, -12.199593808738179, -35.56540990993151, -243.77324899111716, -303.9128765204066, -1269.714110766873, -1421.58637722874, -713.3344447499348, -396.5911816354066, -95.17613819226503, -299.92807800602714, -67.48907532160297, -76.05289308020325, -88.84490598101067, -54.29408624896009, -197.1111281386088, -439.1694689286671, -181.15591109318962, -207.74438207744728, -148.72298597589173, -1239.932110719642, -975.5831491675888, -1476.0302536441304, -1310.4769516894846, -172.10421197847333, -122.77445256941256, -126.89918760047246, -78.46602981217967, -275.00285884003557, -103.27901021453738, -1240.7694336266586, -435.17539388620077, -493.4157512604935, -337.2157875155372, -282.07436763659695, -1531.3876218973996, -848.1678542035519, -316.3602597876129, -86.37431765744654, -320.65753139492955, -638.5867135405289, -64.34277334634434, -1194.0524581881152, -266.8589002245435, -192.84138114577553, -98.76993421512712, -338.66117847637406, -718.761797012533, -542.596986366632, -23.13131590064631, -616.3048106381275, -576.0313280818915, -598.5781743422843, -956.8984348140164, -62.38397778304113, -782.9886883311648, -758.3354501313501, -820.6337271683617, -226.62423411725084], "episode_lengths": [39, 150, 40, 49, 150, 60, 68, 81, 150, 59, 89, 150, 150, 142, 117, 92, 40, 73, 50, 90, 105, 89, 47, 66, 150, 115, 70, 150, 99, 72, 150, 148, 150, 80, 132, 150, 79, 81, 150, 72, 150, 87, 41, 58, 85, 124, 150, 150, 150, 121, 66, 92, 62, 57, 65, 45, 98, 142, 90, 96, 97, 150, 150, 150, 150, 78, 63, 74, 67, 95, 67, 150, 126, 150, 150, 102, 150, 150, 108, 77, 103, 150, 53, 150, 111, 94, 54, 96, 150, 150, 50, 150, 150, 150, 150, 56, 150, 150, 150, 119], "policy_policy_0_reward": [-18.329446398738195, -1207.5509721763676, -7.794629749534782, -22.169886318680884, -516.5831416245763, -34.02421228185573, -123.55939913209377, -93.97353997456045, -727.2410142972434, -177.22018568948485, -230.08658088692286, -865.9390581463857, -1434.9223062899273, -552.3538611883546, -246.50939629385238, -240.29283437952947, -2.3428568522160242, -128.73705010385115, -87.80769958896329, -118.53423198637961, -207.0305793219586, -232.94238141625206, -35.18255168645988, -166.00908114333134, -689.5135520925901, -298.76088824641755, -175.08044551925727, -699.1726003073368, -232.28937562023023, -87.7231306417631, -1003.3126872789426, -427.0826951029147, -775.7520307736896, -118.53695346586838, -441.06991416545935, -759.8854432614397, -112.24673733616949, -164.31873208072764, -338.3033930346244, -95.97014610324943, -1020.8107215762487, -116.00711798554892, -12.199593808738179, -35.56540990993151, -243.77324899111716, -303.9128765204066, -1269.714110766873, -1421.58637722874, -713.3344447499348, -396.5911816354066, -95.17613819226503, -299.92807800602714, -67.48907532160297, -76.05289308020325, -88.84490598101067, -54.29408624896009, -197.1111281386088, -439.1694689286671, -181.15591109318962, -207.74438207744728, -148.72298597589173, -1239.932110719642, -975.5831491675888, -1476.0302536441304, -1310.4769516894846, -172.10421197847333, -122.77445256941256, -126.89918760047246, -78.46602981217967, -275.00285884003557, -103.27901021453738, -1240.7694336266586, -435.17539388620077, -493.4157512604935, -337.2157875155372, -282.07436763659695, -1531.3876218973996, -848.1678542035519, -316.3602597876129, -86.37431765744654, -320.65753139492955, -638.5867135405289, -64.34277334634434, -1194.0524581881152, -266.8589002245435, -192.84138114577553, -98.76993421512712, -338.66117847637406, -718.761797012533, -542.596986366632, -23.13131590064631, -616.3048106381275, -576.0313280818915, -598.5781743422843, -956.8984348140164, -62.38397778304113, -782.9886883311648, -758.3354501313501, -820.6337271683617, -226.62423411725084]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5565203279019433, "mean_inference_ms": 1.690866550945049, "mean_action_processing_ms": 0.2733878427128215, "mean_env_wait_ms": 3.4173009546538924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01206660270690918, "StateBufferConnector_ms": 0.007964134216308594, "ViewRequirementAgentConnector_ms": 0.1917104721069336}, "num_episodes": 37, "episode_return_max": -2.3428568522160242, "episode_return_min": -1531.3876218973996, "episode_return_mean": -425.3486855710151, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.0985782288525, "num_env_steps_trained_throughput_per_sec": 308.0985782288525, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 292000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 292000, "timers": {"training_iteration_time_ms": 11518.142, "restore_workers_time_ms": 0.034, "training_step_time_ms": 11518.061, "sample_time_ms": 1122.368, "learn_time_ms": 10335.202, "learn_throughput": 387.027, "synch_weights_time_ms": 59.71}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "done": false, "training_iteration": 73, "trial_id": "4b94b_00000", "date": "2024-08-05_11-54-31", "timestamp": 1722839071, "time_this_iter_s": 12.994689702987671, "time_total_s": 873.6007332801819, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1111132e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 873.6007332801819, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 17.736842105263154, "ram_util_percent": 29.110526315789475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 89.61140874822935, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.9153059582070758, "policy_loss": -0.002406268083723262, "vf_loss": 0.918564201767246, "vf_explained_var": 0.9987066865588228, "kl": 0.014378927731013456, "entropy": 1.4585871026540795, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 70560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "env_runners": {"episode_reward_max": 4.0099957479375785, "episode_reward_min": -1531.3876218973996, "episode_reward_mean": -464.3095163716926, "episode_len_mean": 109.26, "episode_media": {}, "episodes_timesteps_total": 10926, "policy_reward_min": {"policy_0": -1531.3876218973996}, "policy_reward_max": {"policy_0": 4.0099957479375785}, "policy_reward_mean": {"policy_0": -464.3095163716926}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-338.3033930346244, -95.97014610324943, -1020.8107215762487, -116.00711798554892, -12.199593808738179, -35.56540990993151, -243.77324899111716, -303.9128765204066, -1269.714110766873, -1421.58637722874, -713.3344447499348, -396.5911816354066, -95.17613819226503, -299.92807800602714, -67.48907532160297, -76.05289308020325, -88.84490598101067, -54.29408624896009, -197.1111281386088, -439.1694689286671, -181.15591109318962, -207.74438207744728, -148.72298597589173, -1239.932110719642, -975.5831491675888, -1476.0302536441304, -1310.4769516894846, -172.10421197847333, -122.77445256941256, -126.89918760047246, -78.46602981217967, -275.00285884003557, -103.27901021453738, -1240.7694336266586, -435.17539388620077, -493.4157512604935, -337.2157875155372, -282.07436763659695, -1531.3876218973996, -848.1678542035519, -316.3602597876129, -86.37431765744654, -320.65753139492955, -638.5867135405289, -64.34277334634434, -1194.0524581881152, -266.8589002245435, -192.84138114577553, -98.76993421512712, -338.66117847637406, -718.761797012533, -542.596986366632, -23.13131590064631, -616.3048106381275, -576.0313280818915, -598.5781743422843, -956.8984348140164, -62.38397778304113, -782.9886883311648, -758.3354501313501, -820.6337271683617, -226.62423411725084, -66.12933911542294, -479.7762105293474, -685.418201339506, -1149.3269625848548, -1358.2336030467543, -352.6117585706544, -120.68537250264116, -0.14138326613664975, -895.8023490233011, -161.17034282890216, -95.97600269040609, -533.1842042235098, -25.2424691090148, -146.3553873329543, -67.7744426013129, -377.47756573419014, -99.73075071714626, -114.55274863037495, 4.0099957479375785, -1382.0616870771055, -1452.4185594435949, -646.7141664972993, -116.00034806078246, -25.243338707401602, -227.3350124911549, -329.43340784709187, -204.65479710765246, -133.14528870356324, -814.3323033724837, -240.23482019665724, -418.4146794838296, -1315.7067069319307, -1079.1635577957884, -79.96164326591753, -640.8275894488227, -119.37211103002839, -1035.1087120346865, -372.2573352938007], "episode_lengths": [150, 72, 150, 87, 41, 58, 85, 124, 150, 150, 150, 121, 66, 92, 62, 57, 65, 45, 98, 142, 90, 96, 97, 150, 150, 150, 150, 78, 63, 74, 67, 95, 67, 150, 126, 150, 150, 102, 150, 150, 108, 77, 103, 150, 53, 150, 111, 94, 54, 96, 150, 150, 50, 150, 150, 150, 150, 56, 150, 150, 150, 119, 50, 150, 150, 150, 150, 142, 92, 32, 150, 85, 71, 150, 44, 65, 55, 148, 77, 68, 30, 150, 150, 150, 52, 44, 150, 106, 62, 150, 150, 98, 127, 150, 150, 70, 150, 51, 150, 116], "policy_policy_0_reward": [-338.3033930346244, -95.97014610324943, -1020.8107215762487, -116.00711798554892, -12.199593808738179, -35.56540990993151, -243.77324899111716, -303.9128765204066, -1269.714110766873, -1421.58637722874, -713.3344447499348, -396.5911816354066, -95.17613819226503, -299.92807800602714, -67.48907532160297, -76.05289308020325, -88.84490598101067, -54.29408624896009, -197.1111281386088, -439.1694689286671, -181.15591109318962, -207.74438207744728, -148.72298597589173, -1239.932110719642, -975.5831491675888, -1476.0302536441304, -1310.4769516894846, -172.10421197847333, -122.77445256941256, -126.89918760047246, -78.46602981217967, -275.00285884003557, -103.27901021453738, -1240.7694336266586, -435.17539388620077, -493.4157512604935, -337.2157875155372, -282.07436763659695, -1531.3876218973996, -848.1678542035519, -316.3602597876129, -86.37431765744654, -320.65753139492955, -638.5867135405289, -64.34277334634434, -1194.0524581881152, -266.8589002245435, -192.84138114577553, -98.76993421512712, -338.66117847637406, -718.761797012533, -542.596986366632, -23.13131590064631, -616.3048106381275, -576.0313280818915, -598.5781743422843, -956.8984348140164, -62.38397778304113, -782.9886883311648, -758.3354501313501, -820.6337271683617, -226.62423411725084, -66.12933911542294, -479.7762105293474, -685.418201339506, -1149.3269625848548, -1358.2336030467543, -352.6117585706544, -120.68537250264116, -0.14138326613664975, -895.8023490233011, -161.17034282890216, -95.97600269040609, -533.1842042235098, -25.2424691090148, -146.3553873329543, -67.7744426013129, -377.47756573419014, -99.73075071714626, -114.55274863037495, 4.0099957479375785, -1382.0616870771055, -1452.4185594435949, -646.7141664972993, -116.00034806078246, -25.243338707401602, -227.3350124911549, -329.43340784709187, -204.65479710765246, -133.14528870356324, -814.3323033724837, -240.23482019665724, -418.4146794838296, -1315.7067069319307, -1079.1635577957884, -79.96164326591753, -640.8275894488227, -119.37211103002839, -1035.1087120346865, -372.2573352938007]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5571385426515487, "mean_inference_ms": 1.6901098234197727, "mean_action_processing_ms": 0.2732497712313065, "mean_env_wait_ms": 3.419673016720713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01186227798461914, "StateBufferConnector_ms": 0.007883787155151367, "ViewRequirementAgentConnector_ms": 0.1914973258972168}, "num_episodes": 38, "episode_return_max": 4.0099957479375785, "episode_return_min": -1531.3876218973996, "episode_return_mean": -464.3095163716926, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.1718569977161, "num_env_steps_trained_throughput_per_sec": 315.1718569977161, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 296000, "timers": {"training_iteration_time_ms": 11529.422, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11529.345, "sample_time_ms": 1125.847, "learn_time_ms": 10343.622, "learn_throughput": 386.712, "synch_weights_time_ms": 59.085}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "done": false, "training_iteration": 74, "trial_id": "4b94b_00000", "date": "2024-08-05_11-54-44", "timestamp": 1722839084, "time_this_iter_s": 12.705487251281738, "time_total_s": 886.3062205314636, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e111111ea0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 886.3062205314636, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 17.93333333333333, "ram_util_percent": 29.16111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 103.06517475446066, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.9293719981176157, "policy_loss": -0.001429506931162905, "vf_loss": 0.9316349661909044, "vf_explained_var": 0.998610255929331, "kl": 0.019004308153671445, "entropy": 1.6352044353882471, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 71520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "env_runners": {"episode_reward_max": 4.0099957479375785, "episode_reward_min": -1531.3876218973996, "episode_reward_mean": -472.50177858363264, "episode_len_mean": 111.7, "episode_media": {}, "episodes_timesteps_total": 11170, "policy_reward_min": {"policy_0": -1531.3876218973996}, "policy_reward_max": {"policy_0": 4.0099957479375785}, "policy_reward_mean": {"policy_0": -472.50177858363264}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-337.2157875155372, -282.07436763659695, -1531.3876218973996, -848.1678542035519, -316.3602597876129, -86.37431765744654, -320.65753139492955, -638.5867135405289, -64.34277334634434, -1194.0524581881152, -266.8589002245435, -192.84138114577553, -98.76993421512712, -338.66117847637406, -718.761797012533, -542.596986366632, -23.13131590064631, -616.3048106381275, -576.0313280818915, -598.5781743422843, -956.8984348140164, -62.38397778304113, -782.9886883311648, -758.3354501313501, -820.6337271683617, -226.62423411725084, -66.12933911542294, -479.7762105293474, -685.418201339506, -1149.3269625848548, -1358.2336030467543, -352.6117585706544, -120.68537250264116, -0.14138326613664975, -895.8023490233011, -161.17034282890216, -95.97600269040609, -533.1842042235098, -25.2424691090148, -146.3553873329543, -67.7744426013129, -377.47756573419014, -99.73075071714626, -114.55274863037495, 4.0099957479375785, -1382.0616870771055, -1452.4185594435949, -646.7141664972993, -116.00034806078246, -25.243338707401602, -227.3350124911549, -329.43340784709187, -204.65479710765246, -133.14528870356324, -814.3323033724837, -240.23482019665724, -418.4146794838296, -1315.7067069319307, -1079.1635577957884, -79.96164326591753, -640.8275894488227, -119.37211103002839, -1035.1087120346865, -372.2573352938007, -1169.163408190456, -1121.9797295934202, -609.6572164511789, -1248.9451179052678, -295.87928736834743, -683.9610682319292, -189.39621221191535, -1111.1509838130808, -348.40382045446074, -401.9677796493841, -137.67672145744328, -882.6590801593632, -763.2584129996367, -449.35264005285813, -95.79426543851125, -89.88636393933461, -50.94372349117539, -591.1879770173518, -206.51187724327767, -581.4180350946303, -176.0116101721039, -1488.6057469783677, -913.5523145961777, -549.7003320077627, -39.59550093868517, -35.02603856050328, -383.51128065086885, -8.678550395288905, -206.66664674427707, -118.47508371571608, -352.8682920659846, -57.591777235097794, -191.8487508428104, -640.0987888455053, -93.09731975596591, -408.07093728985404], "episode_lengths": [150, 102, 150, 150, 108, 77, 103, 150, 53, 150, 111, 94, 54, 96, 150, 150, 50, 150, 150, 150, 150, 56, 150, 150, 150, 119, 50, 150, 150, 150, 150, 142, 92, 32, 150, 85, 71, 150, 44, 65, 55, 148, 77, 68, 30, 150, 150, 150, 52, 44, 150, 106, 62, 150, 150, 98, 127, 150, 150, 70, 150, 51, 150, 116, 150, 150, 150, 150, 106, 150, 82, 150, 110, 110, 74, 150, 150, 131, 71, 48, 63, 145, 76, 140, 86, 150, 150, 150, 45, 55, 121, 46, 84, 59, 150, 51, 79, 150, 80, 150], "policy_policy_0_reward": [-337.2157875155372, -282.07436763659695, -1531.3876218973996, -848.1678542035519, -316.3602597876129, -86.37431765744654, -320.65753139492955, -638.5867135405289, -64.34277334634434, -1194.0524581881152, -266.8589002245435, -192.84138114577553, -98.76993421512712, -338.66117847637406, -718.761797012533, -542.596986366632, -23.13131590064631, -616.3048106381275, -576.0313280818915, -598.5781743422843, -956.8984348140164, -62.38397778304113, -782.9886883311648, -758.3354501313501, -820.6337271683617, -226.62423411725084, -66.12933911542294, -479.7762105293474, -685.418201339506, -1149.3269625848548, -1358.2336030467543, -352.6117585706544, -120.68537250264116, -0.14138326613664975, -895.8023490233011, -161.17034282890216, -95.97600269040609, -533.1842042235098, -25.2424691090148, -146.3553873329543, -67.7744426013129, -377.47756573419014, -99.73075071714626, -114.55274863037495, 4.0099957479375785, -1382.0616870771055, -1452.4185594435949, -646.7141664972993, -116.00034806078246, -25.243338707401602, -227.3350124911549, -329.43340784709187, -204.65479710765246, -133.14528870356324, -814.3323033724837, -240.23482019665724, -418.4146794838296, -1315.7067069319307, -1079.1635577957884, -79.96164326591753, -640.8275894488227, -119.37211103002839, -1035.1087120346865, -372.2573352938007, -1169.163408190456, -1121.9797295934202, -609.6572164511789, -1248.9451179052678, -295.87928736834743, -683.9610682319292, -189.39621221191535, -1111.1509838130808, -348.40382045446074, -401.9677796493841, -137.67672145744328, -882.6590801593632, -763.2584129996367, -449.35264005285813, -95.79426543851125, -89.88636393933461, -50.94372349117539, -591.1879770173518, -206.51187724327767, -581.4180350946303, -176.0116101721039, -1488.6057469783677, -913.5523145961777, -549.7003320077627, -39.59550093868517, -35.02603856050328, -383.51128065086885, -8.678550395288905, -206.66664674427707, -118.47508371571608, -352.8682920659846, -57.591777235097794, -191.8487508428104, -640.0987888455053, -93.09731975596591, -408.07093728985404]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5565567531218468, "mean_inference_ms": 1.6888631672495693, "mean_action_processing_ms": 0.2733011591015312, "mean_env_wait_ms": 3.4153548241462306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011650800704956055, "StateBufferConnector_ms": 0.00770878791809082, "ViewRequirementAgentConnector_ms": 0.1852874755859375}, "num_episodes": 36, "episode_return_max": 4.0099957479375785, "episode_return_min": -1531.3876218973996, "episode_return_mean": -472.50177858363264, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 334.8096939618966, "num_env_steps_trained_throughput_per_sec": 334.8096939618966, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 300000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 11828.248, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11828.171, "sample_time_ms": 1125.994, "learn_time_ms": 10640.623, "learn_throughput": 375.918, "synch_weights_time_ms": 60.751}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "training_iteration": 75, "trial_id": "4b94b_00000", "date": "2024-08-05_11-54-56", "timestamp": 1722839096, "time_this_iter_s": 11.959771633148193, "time_total_s": 898.2659921646118, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd01016c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 898.2659921646118, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 18.435294117647057, "ram_util_percent": 28.96470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 103.41819403469563, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.9817460578245422, "policy_loss": -0.003410787263904543, "vf_loss": 0.9858076732916137, "vf_explained_var": 0.9974435143793623, "kl": 0.01839176084082889, "entropy": 1.4267315516869228, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 72480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 4.0099957479375785, "episode_reward_min": -1488.6057469783677, "episode_reward_mean": -447.166039231258, "episode_len_mean": 108.51, "episode_media": {}, "episodes_timesteps_total": 10851, "policy_reward_min": {"policy_0": -1488.6057469783677}, "policy_reward_max": {"policy_0": 4.0099957479375785}, "policy_reward_mean": {"policy_0": -447.166039231258}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-533.1842042235098, -25.2424691090148, -146.3553873329543, -67.7744426013129, -377.47756573419014, -99.73075071714626, -114.55274863037495, 4.0099957479375785, -1382.0616870771055, -1452.4185594435949, -646.7141664972993, -116.00034806078246, -25.243338707401602, -227.3350124911549, -329.43340784709187, -204.65479710765246, -133.14528870356324, -814.3323033724837, -240.23482019665724, -418.4146794838296, -1315.7067069319307, -1079.1635577957884, -79.96164326591753, -640.8275894488227, -119.37211103002839, -1035.1087120346865, -372.2573352938007, -1169.163408190456, -1121.9797295934202, -609.6572164511789, -1248.9451179052678, -295.87928736834743, -683.9610682319292, -189.39621221191535, -1111.1509838130808, -348.40382045446074, -401.9677796493841, -137.67672145744328, -882.6590801593632, -763.2584129996367, -449.35264005285813, -95.79426543851125, -89.88636393933461, -50.94372349117539, -591.1879770173518, -206.51187724327767, -581.4180350946303, -176.0116101721039, -1488.6057469783677, -913.5523145961777, -549.7003320077627, -39.59550093868517, -35.02603856050328, -383.51128065086885, -8.678550395288905, -206.66664674427707, -118.47508371571608, -352.8682920659846, -57.591777235097794, -191.8487508428104, -640.0987888455053, -93.09731975596591, -408.07093728985404, -155.61087934540453, -407.83900521479063, -81.87594289648756, -111.86114092686286, -839.7560334012953, -825.1727145897236, -91.47858397968601, -706.8690388529768, -278.54704662795666, -341.94960501474037, -29.71532287663346, -352.91802456952945, -321.16249346256313, -94.68208725290658, -1347.1270422643877, -29.710971348511485, -397.48809673293425, -226.46715820702005, -698.6631395931331, -944.0699992624711, -1129.809634428363, -274.2995256679158, -52.36431171683131, -853.1240437050335, -427.19000607174166, -18.44348934739949, -775.1231419032781, -296.15041172460536, -1001.7775708710674, -955.5374297267491, -232.78196405211077, -254.46652916468224, -34.66766098730317, -233.97568557079472, -174.77736464942734, -146.51536923046376, -887.3491289398667], "episode_lengths": [150, 44, 65, 55, 148, 77, 68, 30, 150, 150, 150, 52, 44, 150, 106, 62, 150, 150, 98, 127, 150, 150, 70, 150, 51, 150, 116, 150, 150, 150, 150, 106, 150, 82, 150, 110, 110, 74, 150, 150, 131, 71, 48, 63, 145, 76, 140, 86, 150, 150, 150, 45, 55, 121, 46, 84, 59, 150, 51, 79, 150, 80, 150, 74, 127, 71, 70, 150, 150, 71, 150, 110, 110, 42, 112, 150, 65, 150, 50, 118, 111, 150, 150, 150, 101, 57, 150, 150, 41, 150, 122, 150, 150, 93, 92, 51, 70, 92, 76, 150], "policy_policy_0_reward": [-533.1842042235098, -25.2424691090148, -146.3553873329543, -67.7744426013129, -377.47756573419014, -99.73075071714626, -114.55274863037495, 4.0099957479375785, -1382.0616870771055, -1452.4185594435949, -646.7141664972993, -116.00034806078246, -25.243338707401602, -227.3350124911549, -329.43340784709187, -204.65479710765246, -133.14528870356324, -814.3323033724837, -240.23482019665724, -418.4146794838296, -1315.7067069319307, -1079.1635577957884, -79.96164326591753, -640.8275894488227, -119.37211103002839, -1035.1087120346865, -372.2573352938007, -1169.163408190456, -1121.9797295934202, -609.6572164511789, -1248.9451179052678, -295.87928736834743, -683.9610682319292, -189.39621221191535, -1111.1509838130808, -348.40382045446074, -401.9677796493841, -137.67672145744328, -882.6590801593632, -763.2584129996367, -449.35264005285813, -95.79426543851125, -89.88636393933461, -50.94372349117539, -591.1879770173518, -206.51187724327767, -581.4180350946303, -176.0116101721039, -1488.6057469783677, -913.5523145961777, -549.7003320077627, -39.59550093868517, -35.02603856050328, -383.51128065086885, -8.678550395288905, -206.66664674427707, -118.47508371571608, -352.8682920659846, -57.591777235097794, -191.8487508428104, -640.0987888455053, -93.09731975596591, -408.07093728985404, -155.61087934540453, -407.83900521479063, -81.87594289648756, -111.86114092686286, -839.7560334012953, -825.1727145897236, -91.47858397968601, -706.8690388529768, -278.54704662795666, -341.94960501474037, -29.71532287663346, -352.91802456952945, -321.16249346256313, -94.68208725290658, -1347.1270422643877, -29.710971348511485, -397.48809673293425, -226.46715820702005, -698.6631395931331, -944.0699992624711, -1129.809634428363, -274.2995256679158, -52.36431171683131, -853.1240437050335, -427.19000607174166, -18.44348934739949, -775.1231419032781, -296.15041172460536, -1001.7775708710674, -955.5374297267491, -232.78196405211077, -254.46652916468224, -34.66766098730317, -233.97568557079472, -174.77736464942734, -146.51536923046376, -887.3491289398667]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5565161580200664, "mean_inference_ms": 1.689962215960562, "mean_action_processing_ms": 0.27326395042118035, "mean_env_wait_ms": 3.416428441568957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011565685272216797, "StateBufferConnector_ms": 0.00780797004699707, "ViewRequirementAgentConnector_ms": 0.1885383129119873}, "num_episodes": 37, "episode_return_max": 4.0099957479375785, "episode_return_min": -1488.6057469783677, "episode_return_mean": -447.166039231258, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 329.7065360723038, "num_env_steps_trained_throughput_per_sec": 329.7065360723038, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 12099.026, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12098.949, "sample_time_ms": 1140.305, "learn_time_ms": 10897.037, "learn_throughput": 367.072, "synch_weights_time_ms": 60.805}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 76, "trial_id": "4b94b_00000", "date": "2024-08-05_11-55-08", "timestamp": 1722839108, "time_this_iter_s": 12.143304347991943, "time_total_s": 910.4092965126038, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1111132e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 910.4092965126038, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 18.43529411764706, "ram_util_percent": 28.723529411764705}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 103.34763168990612, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.8161229898842672, "policy_loss": -0.000995000044349581, "vf_loss": 0.8180400938106079, "vf_explained_var": 0.9986842350413402, "kl": 0.01667751040386072, "entropy": 1.6256860839823881, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 73440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "env_runners": {"episode_reward_max": -8.678550395288905, "episode_reward_min": -1488.6057469783677, "episode_reward_mean": -445.63127548918084, "episode_len_mean": 110.07, "episode_media": {}, "episodes_timesteps_total": 11007, "policy_reward_min": {"policy_0": -1488.6057469783677}, "policy_reward_max": {"policy_0": -8.678550395288905}, "policy_reward_mean": {"policy_0": -445.63127548918084}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-683.9610682319292, -189.39621221191535, -1111.1509838130808, -348.40382045446074, -401.9677796493841, -137.67672145744328, -882.6590801593632, -763.2584129996367, -449.35264005285813, -95.79426543851125, -89.88636393933461, -50.94372349117539, -591.1879770173518, -206.51187724327767, -581.4180350946303, -176.0116101721039, -1488.6057469783677, -913.5523145961777, -549.7003320077627, -39.59550093868517, -35.02603856050328, -383.51128065086885, -8.678550395288905, -206.66664674427707, -118.47508371571608, -352.8682920659846, -57.591777235097794, -191.8487508428104, -640.0987888455053, -93.09731975596591, -408.07093728985404, -155.61087934540453, -407.83900521479063, -81.87594289648756, -111.86114092686286, -839.7560334012953, -825.1727145897236, -91.47858397968601, -706.8690388529768, -278.54704662795666, -341.94960501474037, -29.71532287663346, -352.91802456952945, -321.16249346256313, -94.68208725290658, -1347.1270422643877, -29.710971348511485, -397.48809673293425, -226.46715820702005, -698.6631395931331, -944.0699992624711, -1129.809634428363, -274.2995256679158, -52.36431171683131, -853.1240437050335, -427.19000607174166, -18.44348934739949, -775.1231419032781, -296.15041172460536, -1001.7775708710674, -955.5374297267491, -232.78196405211077, -254.46652916468224, -34.66766098730317, -233.97568557079472, -174.77736464942734, -146.51536923046376, -887.3491289398667, -772.4925692835768, -1437.2915485907051, -201.21327713503908, -596.5546273532518, -17.219628500955245, -12.0833596649612, -301.9320966849686, -213.13449533773013, -285.0520538076308, -488.3782862413839, -75.6560090916908, -404.9374013979736, -854.5708678799791, -583.3574397182317, -271.77740696410126, -870.9255648235189, -819.807530651312, -1172.2405940727147, -266.9548435708882, -246.84035332629114, -146.16991326429883, -1088.1728168934335, -1056.6544787847788, -182.81446230298852, -21.712108165364402, -437.4237597890892, -997.6344365771922, -49.507269712206394, -797.7581034868226, -219.48302488938555, -1174.6089705732022, -220.48272415544452], "episode_lengths": [150, 82, 150, 110, 110, 74, 150, 150, 131, 71, 48, 63, 145, 76, 140, 86, 150, 150, 150, 45, 55, 121, 46, 84, 59, 150, 51, 79, 150, 80, 150, 74, 127, 71, 70, 150, 150, 71, 150, 110, 110, 42, 112, 150, 65, 150, 50, 118, 111, 150, 150, 150, 101, 57, 150, 150, 41, 150, 122, 150, 150, 93, 92, 51, 70, 92, 76, 150, 150, 150, 106, 150, 41, 42, 117, 76, 150, 131, 56, 129, 150, 150, 150, 150, 150, 150, 98, 104, 55, 150, 150, 82, 54, 127, 150, 61, 150, 101, 150, 95], "policy_policy_0_reward": [-683.9610682319292, -189.39621221191535, -1111.1509838130808, -348.40382045446074, -401.9677796493841, -137.67672145744328, -882.6590801593632, -763.2584129996367, -449.35264005285813, -95.79426543851125, -89.88636393933461, -50.94372349117539, -591.1879770173518, -206.51187724327767, -581.4180350946303, -176.0116101721039, -1488.6057469783677, -913.5523145961777, -549.7003320077627, -39.59550093868517, -35.02603856050328, -383.51128065086885, -8.678550395288905, -206.66664674427707, -118.47508371571608, -352.8682920659846, -57.591777235097794, -191.8487508428104, -640.0987888455053, -93.09731975596591, -408.07093728985404, -155.61087934540453, -407.83900521479063, -81.87594289648756, -111.86114092686286, -839.7560334012953, -825.1727145897236, -91.47858397968601, -706.8690388529768, -278.54704662795666, -341.94960501474037, -29.71532287663346, -352.91802456952945, -321.16249346256313, -94.68208725290658, -1347.1270422643877, -29.710971348511485, -397.48809673293425, -226.46715820702005, -698.6631395931331, -944.0699992624711, -1129.809634428363, -274.2995256679158, -52.36431171683131, -853.1240437050335, -427.19000607174166, -18.44348934739949, -775.1231419032781, -296.15041172460536, -1001.7775708710674, -955.5374297267491, -232.78196405211077, -254.46652916468224, -34.66766098730317, -233.97568557079472, -174.77736464942734, -146.51536923046376, -887.3491289398667, -772.4925692835768, -1437.2915485907051, -201.21327713503908, -596.5546273532518, -17.219628500955245, -12.0833596649612, -301.9320966849686, -213.13449533773013, -285.0520538076308, -488.3782862413839, -75.6560090916908, -404.9374013979736, -854.5708678799791, -583.3574397182317, -271.77740696410126, -870.9255648235189, -819.807530651312, -1172.2405940727147, -266.9548435708882, -246.84035332629114, -146.16991326429883, -1088.1728168934335, -1056.6544787847788, -182.81446230298852, -21.712108165364402, -437.4237597890892, -997.6344365771922, -49.507269712206394, -797.7581034868226, -219.48302488938555, -1174.6089705732022, -220.48272415544452]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5563907413019552, "mean_inference_ms": 1.6881119294934601, "mean_action_processing_ms": 0.27333829927649, "mean_env_wait_ms": 3.414651028542197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012209177017211914, "StateBufferConnector_ms": 0.007864236831665039, "ViewRequirementAgentConnector_ms": 0.1891326904296875}, "num_episodes": 32, "episode_return_max": -8.678550395288905, "episode_return_min": -1488.6057469783677, "episode_return_mean": -445.63127548918084, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.640819218391, "num_env_steps_trained_throughput_per_sec": 317.640819218391, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 308000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 308000, "timers": {"training_iteration_time_ms": 12087.84, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12087.764, "sample_time_ms": 1138.236, "learn_time_ms": 10887.904, "learn_throughput": 367.38, "synch_weights_time_ms": 60.82}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "done": false, "training_iteration": 77, "trial_id": "4b94b_00000", "date": "2024-08-05_11-55-20", "timestamp": 1722839120, "time_this_iter_s": 12.605244874954224, "time_total_s": 923.014541387558, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e111111ea0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 923.014541387558, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 18.188888888888886, "ram_util_percent": 28.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 75.7230287383, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.9108717013538504, "policy_loss": -0.005435082107821169, "vf_loss": 0.9172137493578096, "vf_explained_var": 0.9982703272253275, "kl": 0.015817397587973934, "entropy": 1.574265451853474, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 74400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "env_runners": {"episode_reward_max": -12.0833596649612, "episode_reward_min": -1437.2915485907051, "episode_reward_mean": -480.8388860007713, "episode_len_mean": 115.92, "episode_media": {}, "episodes_timesteps_total": 11592, "policy_reward_min": {"policy_0": -1437.2915485907051}, "policy_reward_max": {"policy_0": -12.0833596649612}, "policy_reward_mean": {"policy_0": -480.8388860007713}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-839.7560334012953, -825.1727145897236, -91.47858397968601, -706.8690388529768, -278.54704662795666, -341.94960501474037, -29.71532287663346, -352.91802456952945, -321.16249346256313, -94.68208725290658, -1347.1270422643877, -29.710971348511485, -397.48809673293425, -226.46715820702005, -698.6631395931331, -944.0699992624711, -1129.809634428363, -274.2995256679158, -52.36431171683131, -853.1240437050335, -427.19000607174166, -18.44348934739949, -775.1231419032781, -296.15041172460536, -1001.7775708710674, -955.5374297267491, -232.78196405211077, -254.46652916468224, -34.66766098730317, -233.97568557079472, -174.77736464942734, -146.51536923046376, -887.3491289398667, -772.4925692835768, -1437.2915485907051, -201.21327713503908, -596.5546273532518, -17.219628500955245, -12.0833596649612, -301.9320966849686, -213.13449533773013, -285.0520538076308, -488.3782862413839, -75.6560090916908, -404.9374013979736, -854.5708678799791, -583.3574397182317, -271.77740696410126, -870.9255648235189, -819.807530651312, -1172.2405940727147, -266.9548435708882, -246.84035332629114, -146.16991326429883, -1088.1728168934335, -1056.6544787847788, -182.81446230298852, -21.712108165364402, -437.4237597890892, -997.6344365771922, -49.507269712206394, -797.7581034868226, -219.48302488938555, -1174.6089705732022, -220.48272415544452, -1373.79156189817, -667.8036066269966, -524.1586313854823, -1004.9125387161034, -299.68184352679003, -107.46407747058126, -324.67216956049293, -202.06497567794938, -53.77637439072375, -33.69784145760954, -680.6008533273504, -56.92202824326625, -263.46136019248115, -623.1264245721366, -88.49392078915965, -400.1335732477423, -1121.5375754046077, -910.5791991086799, -225.18268901749758, -418.13226922528304, -221.7335603032377, -471.15875232136057, -260.2223706295996, -160.63836798761534, -73.38674609460008, -457.0619593521559, -474.2395762169168, -1106.5203439000136, -55.16187321382921, -882.9560300064962, -57.7520986870722, -324.7862988615046, -689.6807772628828, -1375.4021259113524, -534.0215570041833], "episode_lengths": [150, 150, 71, 150, 110, 110, 42, 112, 150, 65, 150, 50, 118, 111, 150, 150, 150, 101, 57, 150, 150, 41, 150, 122, 150, 150, 93, 92, 51, 70, 92, 76, 150, 150, 150, 106, 150, 41, 42, 117, 76, 150, 131, 56, 129, 150, 150, 150, 150, 150, 150, 98, 104, 55, 150, 150, 82, 54, 127, 150, 61, 150, 101, 150, 95, 150, 150, 146, 150, 150, 65, 107, 85, 63, 44, 150, 61, 150, 150, 72, 143, 150, 150, 86, 150, 93, 150, 116, 75, 71, 150, 150, 150, 65, 150, 66, 125, 150, 150, 150], "policy_policy_0_reward": [-839.7560334012953, -825.1727145897236, -91.47858397968601, -706.8690388529768, -278.54704662795666, -341.94960501474037, -29.71532287663346, -352.91802456952945, -321.16249346256313, -94.68208725290658, -1347.1270422643877, -29.710971348511485, -397.48809673293425, -226.46715820702005, -698.6631395931331, -944.0699992624711, -1129.809634428363, -274.2995256679158, -52.36431171683131, -853.1240437050335, -427.19000607174166, -18.44348934739949, -775.1231419032781, -296.15041172460536, -1001.7775708710674, -955.5374297267491, -232.78196405211077, -254.46652916468224, -34.66766098730317, -233.97568557079472, -174.77736464942734, -146.51536923046376, -887.3491289398667, -772.4925692835768, -1437.2915485907051, -201.21327713503908, -596.5546273532518, -17.219628500955245, -12.0833596649612, -301.9320966849686, -213.13449533773013, -285.0520538076308, -488.3782862413839, -75.6560090916908, -404.9374013979736, -854.5708678799791, -583.3574397182317, -271.77740696410126, -870.9255648235189, -819.807530651312, -1172.2405940727147, -266.9548435708882, -246.84035332629114, -146.16991326429883, -1088.1728168934335, -1056.6544787847788, -182.81446230298852, -21.712108165364402, -437.4237597890892, -997.6344365771922, -49.507269712206394, -797.7581034868226, -219.48302488938555, -1174.6089705732022, -220.48272415544452, -1373.79156189817, -667.8036066269966, -524.1586313854823, -1004.9125387161034, -299.68184352679003, -107.46407747058126, -324.67216956049293, -202.06497567794938, -53.77637439072375, -33.69784145760954, -680.6008533273504, -56.92202824326625, -263.46136019248115, -623.1264245721366, -88.49392078915965, -400.1335732477423, -1121.5375754046077, -910.5791991086799, -225.18268901749758, -418.13226922528304, -221.7335603032377, -471.15875232136057, -260.2223706295996, -160.63836798761534, -73.38674609460008, -457.0619593521559, -474.2395762169168, -1106.5203439000136, -55.16187321382921, -882.9560300064962, -57.7520986870722, -324.7862988615046, -689.6807772628828, -1375.4021259113524, -534.0215570041833]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5572916543570356, "mean_inference_ms": 1.6885279830995854, "mean_action_processing_ms": 0.27322099621368273, "mean_env_wait_ms": 3.419293395853183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012099504470825195, "StateBufferConnector_ms": 0.007879972457885742, "ViewRequirementAgentConnector_ms": 0.18883800506591797}, "num_episodes": 35, "episode_return_max": -12.0833596649612, "episode_return_min": -1437.2915485907051, "episode_return_mean": -480.8388860007713, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.4961659221322, "num_env_steps_trained_throughput_per_sec": 308.4961659221322, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 12103.361, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12103.285, "sample_time_ms": 1139.6, "learn_time_ms": 10902.073, "learn_throughput": 366.903, "synch_weights_time_ms": 60.81}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "training_iteration": 78, "trial_id": "4b94b_00000", "date": "2024-08-05_11-55-33", "timestamp": 1722839133, "time_this_iter_s": 12.978577375411987, "time_total_s": 935.99311876297, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd01008b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 935.99311876297, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 17.563157894736843, "ram_util_percent": 28.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 104.32315409282843, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.0329712765679384, "policy_loss": -0.0031816067761004283, "vf_loss": 1.0368111928614476, "vf_explained_var": 0.9975790806735555, "kl": 0.021803562856424225, "entropy": 1.578147312750419, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 75360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "env_runners": {"episode_reward_max": -12.0833596649612, "episode_reward_min": -1529.8311939303803, "episode_reward_mean": -446.728849467778, "episode_len_mean": 114.21, "episode_media": {}, "episodes_timesteps_total": 11421, "policy_reward_min": {"policy_0": -1529.8311939303803}, "policy_reward_max": {"policy_0": -12.0833596649612}, "policy_reward_mean": {"policy_0": -446.728849467778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.219628500955245, -12.0833596649612, -301.9320966849686, -213.13449533773013, -285.0520538076308, -488.3782862413839, -75.6560090916908, -404.9374013979736, -854.5708678799791, -583.3574397182317, -271.77740696410126, -870.9255648235189, -819.807530651312, -1172.2405940727147, -266.9548435708882, -246.84035332629114, -146.16991326429883, -1088.1728168934335, -1056.6544787847788, -182.81446230298852, -21.712108165364402, -437.4237597890892, -997.6344365771922, -49.507269712206394, -797.7581034868226, -219.48302488938555, -1174.6089705732022, -220.48272415544452, -1373.79156189817, -667.8036066269966, -524.1586313854823, -1004.9125387161034, -299.68184352679003, -107.46407747058126, -324.67216956049293, -202.06497567794938, -53.77637439072375, -33.69784145760954, -680.6008533273504, -56.92202824326625, -263.46136019248115, -623.1264245721366, -88.49392078915965, -400.1335732477423, -1121.5375754046077, -910.5791991086799, -225.18268901749758, -418.13226922528304, -221.7335603032377, -471.15875232136057, -260.2223706295996, -160.63836798761534, -73.38674609460008, -457.0619593521559, -474.2395762169168, -1106.5203439000136, -55.16187321382921, -882.9560300064962, -57.7520986870722, -324.7862988615046, -689.6807772628828, -1375.4021259113524, -534.0215570041833, -167.81304173326666, -229.05241818018985, -907.4076063553421, -218.83422619287788, -320.598871493016, -300.6414236391807, -1099.889427084084, -80.07020387772661, -383.25108716758194, -268.4241136196684, -269.5158244758804, -178.3063765949795, -725.9166787895687, -112.73659016360247, -43.31496707840245, -216.43548884524515, -614.2263557719425, -148.1367286413167, -140.89625863786895, -93.46923647586631, -144.06051815925545, -47.98341017842791, -99.74878086929253, -491.51663841588095, -469.54829308778034, -152.81087898129985, -1529.8311939303803, -1128.1598827984064, -267.5705537676445, -1132.6166495155908, -253.8709164665264, -68.59825569274656, -344.2097008928282, -951.4010067756803, -762.1213197581263, -38.541876157065694, -469.152194592792], "episode_lengths": [41, 42, 117, 76, 150, 131, 56, 129, 150, 150, 150, 150, 150, 150, 98, 104, 55, 150, 150, 82, 54, 127, 150, 61, 150, 101, 150, 95, 150, 150, 146, 150, 150, 65, 107, 85, 63, 44, 150, 61, 150, 150, 72, 143, 150, 150, 86, 150, 93, 150, 116, 75, 71, 150, 150, 150, 65, 150, 66, 125, 150, 150, 150, 83, 108, 150, 95, 150, 126, 150, 64, 120, 92, 94, 98, 150, 55, 49, 93, 150, 83, 94, 66, 100, 56, 82, 150, 127, 97, 150, 150, 150, 150, 107, 54, 129, 150, 150, 51, 146], "policy_policy_0_reward": [-17.219628500955245, -12.0833596649612, -301.9320966849686, -213.13449533773013, -285.0520538076308, -488.3782862413839, -75.6560090916908, -404.9374013979736, -854.5708678799791, -583.3574397182317, -271.77740696410126, -870.9255648235189, -819.807530651312, -1172.2405940727147, -266.9548435708882, -246.84035332629114, -146.16991326429883, -1088.1728168934335, -1056.6544787847788, -182.81446230298852, -21.712108165364402, -437.4237597890892, -997.6344365771922, -49.507269712206394, -797.7581034868226, -219.48302488938555, -1174.6089705732022, -220.48272415544452, -1373.79156189817, -667.8036066269966, -524.1586313854823, -1004.9125387161034, -299.68184352679003, -107.46407747058126, -324.67216956049293, -202.06497567794938, -53.77637439072375, -33.69784145760954, -680.6008533273504, -56.92202824326625, -263.46136019248115, -623.1264245721366, -88.49392078915965, -400.1335732477423, -1121.5375754046077, -910.5791991086799, -225.18268901749758, -418.13226922528304, -221.7335603032377, -471.15875232136057, -260.2223706295996, -160.63836798761534, -73.38674609460008, -457.0619593521559, -474.2395762169168, -1106.5203439000136, -55.16187321382921, -882.9560300064962, -57.7520986870722, -324.7862988615046, -689.6807772628828, -1375.4021259113524, -534.0215570041833, -167.81304173326666, -229.05241818018985, -907.4076063553421, -218.83422619287788, -320.598871493016, -300.6414236391807, -1099.889427084084, -80.07020387772661, -383.25108716758194, -268.4241136196684, -269.5158244758804, -178.3063765949795, -725.9166787895687, -112.73659016360247, -43.31496707840245, -216.43548884524515, -614.2263557719425, -148.1367286413167, -140.89625863786895, -93.46923647586631, -144.06051815925545, -47.98341017842791, -99.74878086929253, -491.51663841588095, -469.54829308778034, -152.81087898129985, -1529.8311939303803, -1128.1598827984064, -267.5705537676445, -1132.6166495155908, -253.8709164665264, -68.59825569274656, -344.2097008928282, -951.4010067756803, -762.1213197581263, -38.541876157065694, -469.152194592792]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5570085904789029, "mean_inference_ms": 1.687399479863138, "mean_action_processing_ms": 0.273316498767319, "mean_env_wait_ms": 3.41860156210378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012620210647583008, "StateBufferConnector_ms": 0.007870197296142578, "ViewRequirementAgentConnector_ms": 0.18744921684265137}, "num_episodes": 37, "episode_return_max": -12.0833596649612, "episode_return_min": -1529.8311939303803, "episode_return_mean": -446.728849467778, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.24841510945066, "num_env_steps_trained_throughput_per_sec": 314.24841510945066, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 316000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 316000, "timers": {"training_iteration_time_ms": 12139.111, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12139.036, "sample_time_ms": 1137.535, "learn_time_ms": 10939.621, "learn_throughput": 365.643, "synch_weights_time_ms": 61.079}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "done": false, "training_iteration": 79, "trial_id": "4b94b_00000", "date": "2024-08-05_11-55-46", "timestamp": 1722839146, "time_this_iter_s": 12.742735147476196, "time_total_s": 948.7358539104462, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e111112c20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 948.7358539104462, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 18.044444444444444, "ram_util_percent": 28.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 116.98207026223342, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 0.0010000000000000005, "total_loss": 0.790644887535988, "policy_loss": -0.0028639458507920307, "vf_loss": 0.7944875167527546, "vf_explained_var": 0.9987321344514688, "kl": 0.014945273096418615, "entropy": 1.924436358983318, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 76320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": -15.378211334039051, "episode_reward_min": -1584.7791856058511, "episode_reward_mean": -467.9198828699269, "episode_len_mean": 113.86, "episode_media": {}, "episodes_timesteps_total": 11386, "policy_reward_min": {"policy_0": -1584.7791856058511}, "policy_reward_max": {"policy_0": -15.378211334039051}, "policy_reward_mean": {"policy_0": -467.9198828699269}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-324.67216956049293, -202.06497567794938, -53.77637439072375, -33.69784145760954, -680.6008533273504, -56.92202824326625, -263.46136019248115, -623.1264245721366, -88.49392078915965, -400.1335732477423, -1121.5375754046077, -910.5791991086799, -225.18268901749758, -418.13226922528304, -221.7335603032377, -471.15875232136057, -260.2223706295996, -160.63836798761534, -73.38674609460008, -457.0619593521559, -474.2395762169168, -1106.5203439000136, -55.16187321382921, -882.9560300064962, -57.7520986870722, -324.7862988615046, -689.6807772628828, -1375.4021259113524, -534.0215570041833, -167.81304173326666, -229.05241818018985, -907.4076063553421, -218.83422619287788, -320.598871493016, -300.6414236391807, -1099.889427084084, -80.07020387772661, -383.25108716758194, -268.4241136196684, -269.5158244758804, -178.3063765949795, -725.9166787895687, -112.73659016360247, -43.31496707840245, -216.43548884524515, -614.2263557719425, -148.1367286413167, -140.89625863786895, -93.46923647586631, -144.06051815925545, -47.98341017842791, -99.74878086929253, -491.51663841588095, -469.54829308778034, -152.81087898129985, -1529.8311939303803, -1128.1598827984064, -267.5705537676445, -1132.6166495155908, -253.8709164665264, -68.59825569274656, -344.2097008928282, -951.4010067756803, -762.1213197581263, -38.541876157065694, -469.152194592792, -88.02771144176157, -1447.3550850064885, -1095.614656075752, -456.5451631836427, -1584.7791856058511, -288.446844512356, -78.6181651717354, -336.3415348700412, -1197.4744509301802, -15.378211334039051, -449.9263799429774, -798.1306283833696, -588.1686548303578, -356.7193295298399, -35.82388808179719, -71.3835641041593, -1105.665753035035, -1292.7956786413497, -19.222497359228548, -35.37735715050155, -1262.5612283120338, -706.8291379726887, -245.384071999231, -287.18801997115554, -1005.9138810910409, -215.9956664922794, -478.1261373926461, -142.05755051715366, -176.38313987834601, -503.29692618960723, -791.7362026878303, -24.46670213004982, -1103.1009471041416, -1089.3712492388872], "episode_lengths": [107, 85, 63, 44, 150, 61, 150, 150, 72, 143, 150, 150, 86, 150, 93, 150, 116, 75, 71, 150, 150, 150, 65, 150, 66, 125, 150, 150, 150, 83, 108, 150, 95, 150, 126, 150, 64, 120, 92, 94, 98, 150, 55, 49, 93, 150, 83, 94, 66, 100, 56, 82, 150, 127, 97, 150, 150, 150, 150, 107, 54, 129, 150, 150, 51, 146, 73, 150, 150, 142, 150, 106, 43, 115, 150, 47, 150, 150, 150, 131, 57, 66, 150, 150, 47, 51, 150, 150, 90, 122, 150, 108, 150, 79, 80, 142, 150, 46, 150, 150], "policy_policy_0_reward": [-324.67216956049293, -202.06497567794938, -53.77637439072375, -33.69784145760954, -680.6008533273504, -56.92202824326625, -263.46136019248115, -623.1264245721366, -88.49392078915965, -400.1335732477423, -1121.5375754046077, -910.5791991086799, -225.18268901749758, -418.13226922528304, -221.7335603032377, -471.15875232136057, -260.2223706295996, -160.63836798761534, -73.38674609460008, -457.0619593521559, -474.2395762169168, -1106.5203439000136, -55.16187321382921, -882.9560300064962, -57.7520986870722, -324.7862988615046, -689.6807772628828, -1375.4021259113524, -534.0215570041833, -167.81304173326666, -229.05241818018985, -907.4076063553421, -218.83422619287788, -320.598871493016, -300.6414236391807, -1099.889427084084, -80.07020387772661, -383.25108716758194, -268.4241136196684, -269.5158244758804, -178.3063765949795, -725.9166787895687, -112.73659016360247, -43.31496707840245, -216.43548884524515, -614.2263557719425, -148.1367286413167, -140.89625863786895, -93.46923647586631, -144.06051815925545, -47.98341017842791, -99.74878086929253, -491.51663841588095, -469.54829308778034, -152.81087898129985, -1529.8311939303803, -1128.1598827984064, -267.5705537676445, -1132.6166495155908, -253.8709164665264, -68.59825569274656, -344.2097008928282, -951.4010067756803, -762.1213197581263, -38.541876157065694, -469.152194592792, -88.02771144176157, -1447.3550850064885, -1095.614656075752, -456.5451631836427, -1584.7791856058511, -288.446844512356, -78.6181651717354, -336.3415348700412, -1197.4744509301802, -15.378211334039051, -449.9263799429774, -798.1306283833696, -588.1686548303578, -356.7193295298399, -35.82388808179719, -71.3835641041593, -1105.665753035035, -1292.7956786413497, -19.222497359228548, -35.37735715050155, -1262.5612283120338, -706.8291379726887, -245.384071999231, -287.18801997115554, -1005.9138810910409, -215.9956664922794, -478.1261373926461, -142.05755051715366, -176.38313987834601, -503.29692618960723, -791.7362026878303, -24.46670213004982, -1103.1009471041416, -1089.3712492388872]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.556760810213823, "mean_inference_ms": 1.6887409148259254, "mean_action_processing_ms": 0.27328211900840904, "mean_env_wait_ms": 3.4198277660107483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012523412704467773, "StateBufferConnector_ms": 0.007858753204345703, "ViewRequirementAgentConnector_ms": 0.18755435943603516}, "num_episodes": 34, "episode_return_max": -15.378211334039051, "episode_return_min": -1584.7791856058511, "episode_return_mean": -467.9198828699269, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.91785549426504, "num_env_steps_trained_throughput_per_sec": 314.91785549426504, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 12586.762, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12586.686, "sample_time_ms": 1130.266, "learn_time_ms": 11392.767, "learn_throughput": 351.1, "synch_weights_time_ms": 62.861}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 80, "trial_id": "4b94b_00000", "date": "2024-08-05_11-55-59", "timestamp": 1722839159, "time_this_iter_s": 12.713026762008667, "time_total_s": 961.4488806724548, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e11156aa70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 961.4488806724548, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 18.172222222222224, "ram_util_percent": 28.705555555555552}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 115.96135317881902, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 0.0010000000000000005, "total_loss": 0.7962643316481263, "policy_loss": -0.00030229517190794773, "vf_loss": 0.7975451326929033, "vf_explained_var": 0.9989218417555094, "kl": 0.01533345602644362, "entropy": 1.9488267422964176, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 77280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "env_runners": {"episode_reward_max": -4.367821407047559, "episode_reward_min": -1584.7791856058511, "episode_reward_mean": -534.9450373177817, "episode_len_mean": 115.34, "episode_media": {}, "episodes_timesteps_total": 11534, "policy_reward_min": {"policy_0": -1584.7791856058511}, "policy_reward_max": {"policy_0": -4.367821407047559}, "policy_reward_mean": {"policy_0": -534.9450373177817}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-300.6414236391807, -1099.889427084084, -80.07020387772661, -383.25108716758194, -268.4241136196684, -269.5158244758804, -178.3063765949795, -725.9166787895687, -112.73659016360247, -43.31496707840245, -216.43548884524515, -614.2263557719425, -148.1367286413167, -140.89625863786895, -93.46923647586631, -144.06051815925545, -47.98341017842791, -99.74878086929253, -491.51663841588095, -469.54829308778034, -152.81087898129985, -1529.8311939303803, -1128.1598827984064, -267.5705537676445, -1132.6166495155908, -253.8709164665264, -68.59825569274656, -344.2097008928282, -951.4010067756803, -762.1213197581263, -38.541876157065694, -469.152194592792, -88.02771144176157, -1447.3550850064885, -1095.614656075752, -456.5451631836427, -1584.7791856058511, -288.446844512356, -78.6181651717354, -336.3415348700412, -1197.4744509301802, -15.378211334039051, -449.9263799429774, -798.1306283833696, -588.1686548303578, -356.7193295298399, -35.82388808179719, -71.3835641041593, -1105.665753035035, -1292.7956786413497, -19.222497359228548, -35.37735715050155, -1262.5612283120338, -706.8291379726887, -245.384071999231, -287.18801997115554, -1005.9138810910409, -215.9956664922794, -478.1261373926461, -142.05755051715366, -176.38313987834601, -503.29692618960723, -791.7362026878303, -24.46670213004982, -1103.1009471041416, -1089.3712492388872, -401.89522926661533, -1253.2791183431357, -266.4857670742293, -370.38637201487046, -222.0867698680658, -912.096348591096, -329.27840979542026, -586.4795252174936, -1382.9178361617298, -480.5021833317079, -192.99510948332178, -198.90731763045392, -805.404496073931, -286.3962896408083, -1017.2055411048271, -1473.4422865129068, -185.26763250811493, -1332.6924660058555, -898.2570555746154, -381.76372179924164, -193.58707698449604, -1385.481421187096, -993.9641130885076, -240.88393212078662, -91.81845671355107, -1326.118650613261, -534.1803979539891, -130.43543646912775, -1190.2988689576432, -1093.1117469506587, -640.6375646515575, -4.367821407047559, -176.89199188024241, -113.80834573157205], "episode_lengths": [126, 150, 64, 120, 92, 94, 98, 150, 55, 49, 93, 150, 83, 94, 66, 100, 56, 82, 150, 127, 97, 150, 150, 150, 150, 107, 54, 129, 150, 150, 51, 146, 73, 150, 150, 142, 150, 106, 43, 115, 150, 47, 150, 150, 150, 131, 57, 66, 150, 150, 47, 51, 150, 150, 90, 122, 150, 108, 150, 79, 80, 142, 150, 46, 150, 150, 150, 150, 100, 127, 70, 150, 80, 144, 150, 137, 107, 85, 150, 150, 150, 150, 88, 150, 150, 113, 87, 150, 150, 89, 70, 150, 150, 65, 150, 150, 150, 35, 77, 82], "policy_policy_0_reward": [-300.6414236391807, -1099.889427084084, -80.07020387772661, -383.25108716758194, -268.4241136196684, -269.5158244758804, -178.3063765949795, -725.9166787895687, -112.73659016360247, -43.31496707840245, -216.43548884524515, -614.2263557719425, -148.1367286413167, -140.89625863786895, -93.46923647586631, -144.06051815925545, -47.98341017842791, -99.74878086929253, -491.51663841588095, -469.54829308778034, -152.81087898129985, -1529.8311939303803, -1128.1598827984064, -267.5705537676445, -1132.6166495155908, -253.8709164665264, -68.59825569274656, -344.2097008928282, -951.4010067756803, -762.1213197581263, -38.541876157065694, -469.152194592792, -88.02771144176157, -1447.3550850064885, -1095.614656075752, -456.5451631836427, -1584.7791856058511, -288.446844512356, -78.6181651717354, -336.3415348700412, -1197.4744509301802, -15.378211334039051, -449.9263799429774, -798.1306283833696, -588.1686548303578, -356.7193295298399, -35.82388808179719, -71.3835641041593, -1105.665753035035, -1292.7956786413497, -19.222497359228548, -35.37735715050155, -1262.5612283120338, -706.8291379726887, -245.384071999231, -287.18801997115554, -1005.9138810910409, -215.9956664922794, -478.1261373926461, -142.05755051715366, -176.38313987834601, -503.29692618960723, -791.7362026878303, -24.46670213004982, -1103.1009471041416, -1089.3712492388872, -401.89522926661533, -1253.2791183431357, -266.4857670742293, -370.38637201487046, -222.0867698680658, -912.096348591096, -329.27840979542026, -586.4795252174936, -1382.9178361617298, -480.5021833317079, -192.99510948332178, -198.90731763045392, -805.404496073931, -286.3962896408083, -1017.2055411048271, -1473.4422865129068, -185.26763250811493, -1332.6924660058555, -898.2570555746154, -381.76372179924164, -193.58707698449604, -1385.481421187096, -993.9641130885076, -240.88393212078662, -91.81845671355107, -1326.118650613261, -534.1803979539891, -130.43543646912775, -1190.2988689576432, -1093.1117469506587, -640.6375646515575, -4.367821407047559, -176.89199188024241, -113.80834573157205]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5567630873870199, "mean_inference_ms": 1.686621609026159, "mean_action_processing_ms": 0.27324475736534537, "mean_env_wait_ms": 3.4182085042222674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012510061264038086, "StateBufferConnector_ms": 0.007941007614135742, "ViewRequirementAgentConnector_ms": 0.19052791595458984}, "num_episodes": 34, "episode_return_max": -4.367821407047559, "episode_return_min": -1584.7791856058511, "episode_return_mean": -534.9450373177817, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 321.36596841229846, "num_env_steps_trained_throughput_per_sec": 321.36596841229846, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 324000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 12589.259, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12589.183, "sample_time_ms": 1134.261, "learn_time_ms": 11391.231, "learn_throughput": 351.147, "synch_weights_time_ms": 62.897}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "training_iteration": 81, "trial_id": "4b94b_00000", "date": "2024-08-05_11-56-11", "timestamp": 1722839171, "time_this_iter_s": 12.459078073501587, "time_total_s": 973.9079587459564, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd0102680>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 973.9079587459564, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 18.233333333333334, "ram_util_percent": 28.705555555555552}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 99.53654504319032, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 0.0010000000000000005, "total_loss": 0.8193207330691318, "policy_loss": -0.0004541575840751951, "vf_loss": 0.8203433483839035, "vf_explained_var": 0.9986312945062915, "kl": 0.0192667583006975, "entropy": 1.7876832131296396, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 78240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "env_runners": {"episode_reward_max": -4.367821407047559, "episode_reward_min": -1584.7791856058511, "episode_reward_mean": -530.0023365282417, "episode_len_mean": 113.84, "episode_media": {}, "episodes_timesteps_total": 11384, "policy_reward_min": {"policy_0": -1584.7791856058511}, "policy_reward_max": {"policy_0": -4.367821407047559}, "policy_reward_mean": {"policy_0": -530.0023365282417}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-456.5451631836427, -1584.7791856058511, -288.446844512356, -78.6181651717354, -336.3415348700412, -1197.4744509301802, -15.378211334039051, -449.9263799429774, -798.1306283833696, -588.1686548303578, -356.7193295298399, -35.82388808179719, -71.3835641041593, -1105.665753035035, -1292.7956786413497, -19.222497359228548, -35.37735715050155, -1262.5612283120338, -706.8291379726887, -245.384071999231, -287.18801997115554, -1005.9138810910409, -215.9956664922794, -478.1261373926461, -142.05755051715366, -176.38313987834601, -503.29692618960723, -791.7362026878303, -24.46670213004982, -1103.1009471041416, -1089.3712492388872, -401.89522926661533, -1253.2791183431357, -266.4857670742293, -370.38637201487046, -222.0867698680658, -912.096348591096, -329.27840979542026, -586.4795252174936, -1382.9178361617298, -480.5021833317079, -192.99510948332178, -198.90731763045392, -805.404496073931, -286.3962896408083, -1017.2055411048271, -1473.4422865129068, -185.26763250811493, -1332.6924660058555, -898.2570555746154, -381.76372179924164, -193.58707698449604, -1385.481421187096, -993.9641130885076, -240.88393212078662, -91.81845671355107, -1326.118650613261, -534.1803979539891, -130.43543646912775, -1190.2988689576432, -1093.1117469506587, -640.6375646515575, -4.367821407047559, -176.89199188024241, -113.80834573157205, -179.3967401565547, -152.3180730413992, -1177.3630211375225, -868.6930631234653, -422.86480657679715, -64.81718036957179, -417.0687947774482, -126.65747518239448, -612.8610914470455, -213.1527686406369, -48.55254182443151, -823.1571886322106, -305.57259674413797, -1375.6782921164236, -32.99876677030215, -329.5508371991476, -744.4935640460507, -20.553839039825636, -1060.347748666566, -69.1589865655407, -474.3266870826816, -240.44192803004597, -173.17335916683626, -38.873611228409594, -135.75607371548327, -511.34845236366675, -34.891277746179775, -319.7489754439284, -1398.9717770105442, -143.44157841459182, -254.3681118788466, -367.70177430672123, -1077.5479128002148, -773.0218993533543, -174.82940987367124], "episode_lengths": [142, 150, 106, 43, 115, 150, 47, 150, 150, 150, 131, 57, 66, 150, 150, 47, 51, 150, 150, 90, 122, 150, 108, 150, 79, 80, 142, 150, 46, 150, 150, 150, 150, 100, 127, 70, 150, 80, 144, 150, 137, 107, 85, 150, 150, 150, 150, 88, 150, 150, 113, 87, 150, 150, 89, 70, 150, 150, 65, 150, 150, 150, 35, 77, 82, 99, 73, 150, 150, 131, 50, 131, 73, 150, 94, 64, 150, 144, 150, 37, 111, 150, 42, 150, 63, 132, 93, 76, 52, 72, 128, 55, 121, 150, 77, 90, 110, 150, 150, 88], "policy_policy_0_reward": [-456.5451631836427, -1584.7791856058511, -288.446844512356, -78.6181651717354, -336.3415348700412, -1197.4744509301802, -15.378211334039051, -449.9263799429774, -798.1306283833696, -588.1686548303578, -356.7193295298399, -35.82388808179719, -71.3835641041593, -1105.665753035035, -1292.7956786413497, -19.222497359228548, -35.37735715050155, -1262.5612283120338, -706.8291379726887, -245.384071999231, -287.18801997115554, -1005.9138810910409, -215.9956664922794, -478.1261373926461, -142.05755051715366, -176.38313987834601, -503.29692618960723, -791.7362026878303, -24.46670213004982, -1103.1009471041416, -1089.3712492388872, -401.89522926661533, -1253.2791183431357, -266.4857670742293, -370.38637201487046, -222.0867698680658, -912.096348591096, -329.27840979542026, -586.4795252174936, -1382.9178361617298, -480.5021833317079, -192.99510948332178, -198.90731763045392, -805.404496073931, -286.3962896408083, -1017.2055411048271, -1473.4422865129068, -185.26763250811493, -1332.6924660058555, -898.2570555746154, -381.76372179924164, -193.58707698449604, -1385.481421187096, -993.9641130885076, -240.88393212078662, -91.81845671355107, -1326.118650613261, -534.1803979539891, -130.43543646912775, -1190.2988689576432, -1093.1117469506587, -640.6375646515575, -4.367821407047559, -176.89199188024241, -113.80834573157205, -179.3967401565547, -152.3180730413992, -1177.3630211375225, -868.6930631234653, -422.86480657679715, -64.81718036957179, -417.0687947774482, -126.65747518239448, -612.8610914470455, -213.1527686406369, -48.55254182443151, -823.1571886322106, -305.57259674413797, -1375.6782921164236, -32.99876677030215, -329.5508371991476, -744.4935640460507, -20.553839039825636, -1060.347748666566, -69.1589865655407, -474.3266870826816, -240.44192803004597, -173.17335916683626, -38.873611228409594, -135.75607371548327, -511.34845236366675, -34.891277746179775, -319.7489754439284, -1398.9717770105442, -143.44157841459182, -254.3681118788466, -367.70177430672123, -1077.5479128002148, -773.0218993533543, -174.82940987367124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5564471084337003, "mean_inference_ms": 1.6862207704959267, "mean_action_processing_ms": 0.27342070372010163, "mean_env_wait_ms": 3.4183483601196074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012077808380126953, "StateBufferConnector_ms": 0.007967472076416016, "ViewRequirementAgentConnector_ms": 0.1931774616241455}, "num_episodes": 35, "episode_return_max": -4.367821407047559, "episode_return_min": -1584.7791856058511, "episode_return_mean": -530.0023365282417, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.4749730936949, "num_env_steps_trained_throughput_per_sec": 311.4749730936949, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 328000, "timers": {"training_iteration_time_ms": 12603.202, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12603.129, "sample_time_ms": 1137.832, "learn_time_ms": 11399.863, "learn_throughput": 350.881, "synch_weights_time_ms": 64.596}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "done": false, "training_iteration": 82, "trial_id": "4b94b_00000", "date": "2024-08-05_11-56-24", "timestamp": 1722839184, "time_this_iter_s": 12.854262351989746, "time_total_s": 986.7622210979462, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e111111510>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 986.7622210979462, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 17.905555555555555, "ram_util_percent": 28.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 91.88133565286795, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 0.0010000000000000005, "total_loss": 0.8279078608533988, "policy_loss": -0.000664540912839584, "vf_loss": 0.8290275839778284, "vf_explained_var": 0.9989858554055293, "kl": 0.01909487919347157, "entropy": 1.663529747041563, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 79200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "env_runners": {"episode_reward_max": 7.358779280884681, "episode_reward_min": -1476.2523344566393, "episode_reward_mean": -476.4739926159966, "episode_len_mean": 106.22, "episode_media": {}, "episodes_timesteps_total": 10622, "policy_reward_min": {"policy_0": -1476.2523344566393}, "policy_reward_max": {"policy_0": 7.358779280884681}, "policy_reward_mean": {"policy_0": -476.4739926159966}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-198.90731763045392, -805.404496073931, -286.3962896408083, -1017.2055411048271, -1473.4422865129068, -185.26763250811493, -1332.6924660058555, -898.2570555746154, -381.76372179924164, -193.58707698449604, -1385.481421187096, -993.9641130885076, -240.88393212078662, -91.81845671355107, -1326.118650613261, -534.1803979539891, -130.43543646912775, -1190.2988689576432, -1093.1117469506587, -640.6375646515575, -4.367821407047559, -176.89199188024241, -113.80834573157205, -179.3967401565547, -152.3180730413992, -1177.3630211375225, -868.6930631234653, -422.86480657679715, -64.81718036957179, -417.0687947774482, -126.65747518239448, -612.8610914470455, -213.1527686406369, -48.55254182443151, -823.1571886322106, -305.57259674413797, -1375.6782921164236, -32.99876677030215, -329.5508371991476, -744.4935640460507, -20.553839039825636, -1060.347748666566, -69.1589865655407, -474.3266870826816, -240.44192803004597, -173.17335916683626, -38.873611228409594, -135.75607371548327, -511.34845236366675, -34.891277746179775, -319.7489754439284, -1398.9717770105442, -143.44157841459182, -254.3681118788466, -367.70177430672123, -1077.5479128002148, -773.0218993533543, -174.82940987367124, -259.78761716281986, -739.8959628766937, -32.889527692982206, -592.2856159140553, -1363.6361952999039, -750.3876894985783, -715.2237980971526, -315.75577743646267, -299.5599721158332, -29.83659881213483, -326.20722438233537, -258.92318940362287, -1255.669148855684, -1366.3959345203727, -87.316287330176, 7.358779280884681, -168.4550512862201, -174.119605519089, -214.29148689701861, -983.1415787665363, -0.5611812986660294, -303.6949291714326, -40.04140808093379, -461.2423217996659, -90.41785460719221, -582.8423006479666, -78.79399479447254, -16.712931773088144, -572.8127467666883, -7.7452625480813895, -63.863735314136704, -1264.5588517048911, -1364.0305925952632, -1476.2523344566393, -968.5808152210426, -32.68384034018289, 1.6792538775582608, -305.1245923055474, -23.787483675216645, -75.3954902288334, -112.53136107581962, -22.36216845173678], "episode_lengths": [85, 150, 150, 150, 150, 88, 150, 150, 113, 87, 150, 150, 89, 70, 150, 150, 65, 150, 150, 150, 35, 77, 82, 99, 73, 150, 150, 131, 50, 131, 73, 150, 94, 64, 150, 144, 150, 37, 111, 150, 42, 150, 63, 132, 93, 76, 52, 72, 128, 55, 121, 150, 77, 90, 110, 150, 150, 88, 91, 150, 50, 150, 150, 150, 150, 116, 119, 52, 117, 102, 150, 150, 62, 34, 99, 83, 84, 150, 35, 114, 58, 142, 62, 150, 72, 46, 150, 39, 63, 150, 150, 150, 150, 57, 39, 102, 55, 57, 75, 50], "policy_policy_0_reward": [-198.90731763045392, -805.404496073931, -286.3962896408083, -1017.2055411048271, -1473.4422865129068, -185.26763250811493, -1332.6924660058555, -898.2570555746154, -381.76372179924164, -193.58707698449604, -1385.481421187096, -993.9641130885076, -240.88393212078662, -91.81845671355107, -1326.118650613261, -534.1803979539891, -130.43543646912775, -1190.2988689576432, -1093.1117469506587, -640.6375646515575, -4.367821407047559, -176.89199188024241, -113.80834573157205, -179.3967401565547, -152.3180730413992, -1177.3630211375225, -868.6930631234653, -422.86480657679715, -64.81718036957179, -417.0687947774482, -126.65747518239448, -612.8610914470455, -213.1527686406369, -48.55254182443151, -823.1571886322106, -305.57259674413797, -1375.6782921164236, -32.99876677030215, -329.5508371991476, -744.4935640460507, -20.553839039825636, -1060.347748666566, -69.1589865655407, -474.3266870826816, -240.44192803004597, -173.17335916683626, -38.873611228409594, -135.75607371548327, -511.34845236366675, -34.891277746179775, -319.7489754439284, -1398.9717770105442, -143.44157841459182, -254.3681118788466, -367.70177430672123, -1077.5479128002148, -773.0218993533543, -174.82940987367124, -259.78761716281986, -739.8959628766937, -32.889527692982206, -592.2856159140553, -1363.6361952999039, -750.3876894985783, -715.2237980971526, -315.75577743646267, -299.5599721158332, -29.83659881213483, -326.20722438233537, -258.92318940362287, -1255.669148855684, -1366.3959345203727, -87.316287330176, 7.358779280884681, -168.4550512862201, -174.119605519089, -214.29148689701861, -983.1415787665363, -0.5611812986660294, -303.6949291714326, -40.04140808093379, -461.2423217996659, -90.41785460719221, -582.8423006479666, -78.79399479447254, -16.712931773088144, -572.8127467666883, -7.7452625480813895, -63.863735314136704, -1264.5588517048911, -1364.0305925952632, -1476.2523344566393, -968.5808152210426, -32.68384034018289, 1.6792538775582608, -305.1245923055474, -23.787483675216645, -75.3954902288334, -112.53136107581962, -22.36216845173678]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5557486417450577, "mean_inference_ms": 1.686088733476142, "mean_action_processing_ms": 0.27306158269859027, "mean_env_wait_ms": 3.419328131231976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01166224479675293, "StateBufferConnector_ms": 0.007897138595581055, "ViewRequirementAgentConnector_ms": 0.19204187393188477}, "num_episodes": 42, "episode_return_max": 7.358779280884681, "episode_return_min": -1476.2523344566393, "episode_return_mean": -476.4739926159966, "episodes_this_iter": 42}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.5024023934118, "num_env_steps_trained_throughput_per_sec": 316.5024023934118, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 332000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 332000, "timers": {"training_iteration_time_ms": 12568.73, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12568.655, "sample_time_ms": 1144.972, "learn_time_ms": 11358.945, "learn_throughput": 352.145, "synch_weights_time_ms": 63.902}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "done": false, "training_iteration": 83, "trial_id": "4b94b_00000", "date": "2024-08-05_11-56-37", "timestamp": 1722839197, "time_this_iter_s": 12.650927305221558, "time_total_s": 999.4131484031677, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd0103520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 999.4131484031677, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 18.08888888888889, "ram_util_percent": 28.71111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 93.89417392810186, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 0.0010000000000000005, "total_loss": 0.7142221889458596, "policy_loss": -0.004598170148771411, "vf_loss": 0.7195014900217453, "vf_explained_var": 0.9989453678950667, "kl": 0.016333991884433394, "entropy": 1.714764841273427, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 80160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 9.437885263022633, "episode_reward_min": -1526.77023652335, "episode_reward_mean": -412.1586920093312, "episode_len_mean": 102.23, "episode_media": {}, "episodes_timesteps_total": 10223, "policy_reward_min": {"policy_0": -1526.77023652335}, "policy_reward_max": {"policy_0": 9.437885263022633}, "policy_reward_mean": {"policy_0": -412.1586920093312}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-32.99876677030215, -329.5508371991476, -744.4935640460507, -20.553839039825636, -1060.347748666566, -69.1589865655407, -474.3266870826816, -240.44192803004597, -173.17335916683626, -38.873611228409594, -135.75607371548327, -511.34845236366675, -34.891277746179775, -319.7489754439284, -1398.9717770105442, -143.44157841459182, -254.3681118788466, -367.70177430672123, -1077.5479128002148, -773.0218993533543, -174.82940987367124, -259.78761716281986, -739.8959628766937, -32.889527692982206, -592.2856159140553, -1363.6361952999039, -750.3876894985783, -715.2237980971526, -315.75577743646267, -299.5599721158332, -29.83659881213483, -326.20722438233537, -258.92318940362287, -1255.669148855684, -1366.3959345203727, -87.316287330176, 7.358779280884681, -168.4550512862201, -174.119605519089, -214.29148689701861, -983.1415787665363, -0.5611812986660294, -303.6949291714326, -40.04140808093379, -461.2423217996659, -90.41785460719221, -582.8423006479666, -78.79399479447254, -16.712931773088144, -572.8127467666883, -7.7452625480813895, -63.863735314136704, -1264.5588517048911, -1364.0305925952632, -1476.2523344566393, -968.5808152210426, -32.68384034018289, 1.6792538775582608, -305.1245923055474, -23.787483675216645, -75.3954902288334, -112.53136107581962, -22.36216845173678, -1526.77023652335, -464.76370484586784, -858.4397394992976, -1115.3226207637701, 6.951022864774295, -170.94759402936828, 9.437885263022633, -732.8524170297561, -97.25144341331054, -250.9739985597413, -293.6833289936832, -57.11942825021416, -156.55159729751387, -661.5544550892295, -1392.8237442004272, -215.30415967491555, -138.50246729734155, -127.06195555222672, -981.9855893065227, -51.81451826092857, -624.3291674948638, -264.03833672611614, -191.43625293206566, -76.63310611162291, -449.48441215937356, -185.9979415840451, -908.8817660971366, -359.08005250796, -180.5511781014914, -492.0719367294768, -199.97272760989296, -76.93488478016904, -170.12377842271408, -192.39344352391794, -901.8848305556172, -120.40395954668882, -379.9943393209612], "episode_lengths": [37, 111, 150, 42, 150, 63, 132, 93, 76, 52, 72, 128, 55, 121, 150, 77, 90, 110, 150, 150, 88, 91, 150, 50, 150, 150, 150, 150, 116, 119, 52, 117, 102, 150, 150, 62, 34, 99, 83, 84, 150, 35, 114, 58, 142, 62, 150, 72, 46, 150, 39, 63, 150, 150, 150, 150, 57, 39, 102, 55, 57, 75, 50, 150, 126, 150, 150, 30, 66, 35, 150, 48, 101, 123, 67, 98, 150, 150, 95, 94, 91, 150, 52, 150, 150, 74, 63, 150, 103, 150, 125, 105, 150, 86, 62, 77, 84, 150, 70, 126], "policy_policy_0_reward": [-32.99876677030215, -329.5508371991476, -744.4935640460507, -20.553839039825636, -1060.347748666566, -69.1589865655407, -474.3266870826816, -240.44192803004597, -173.17335916683626, -38.873611228409594, -135.75607371548327, -511.34845236366675, -34.891277746179775, -319.7489754439284, -1398.9717770105442, -143.44157841459182, -254.3681118788466, -367.70177430672123, -1077.5479128002148, -773.0218993533543, -174.82940987367124, -259.78761716281986, -739.8959628766937, -32.889527692982206, -592.2856159140553, -1363.6361952999039, -750.3876894985783, -715.2237980971526, -315.75577743646267, -299.5599721158332, -29.83659881213483, -326.20722438233537, -258.92318940362287, -1255.669148855684, -1366.3959345203727, -87.316287330176, 7.358779280884681, -168.4550512862201, -174.119605519089, -214.29148689701861, -983.1415787665363, -0.5611812986660294, -303.6949291714326, -40.04140808093379, -461.2423217996659, -90.41785460719221, -582.8423006479666, -78.79399479447254, -16.712931773088144, -572.8127467666883, -7.7452625480813895, -63.863735314136704, -1264.5588517048911, -1364.0305925952632, -1476.2523344566393, -968.5808152210426, -32.68384034018289, 1.6792538775582608, -305.1245923055474, -23.787483675216645, -75.3954902288334, -112.53136107581962, -22.36216845173678, -1526.77023652335, -464.76370484586784, -858.4397394992976, -1115.3226207637701, 6.951022864774295, -170.94759402936828, 9.437885263022633, -732.8524170297561, -97.25144341331054, -250.9739985597413, -293.6833289936832, -57.11942825021416, -156.55159729751387, -661.5544550892295, -1392.8237442004272, -215.30415967491555, -138.50246729734155, -127.06195555222672, -981.9855893065227, -51.81451826092857, -624.3291674948638, -264.03833672611614, -191.43625293206566, -76.63310611162291, -449.48441215937356, -185.9979415840451, -908.8817660971366, -359.08005250796, -180.5511781014914, -492.0719367294768, -199.97272760989296, -76.93488478016904, -170.12377842271408, -192.39344352391794, -901.8848305556172, -120.40395954668882, -379.9943393209612]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5551450837552884, "mean_inference_ms": 1.6869601019799305, "mean_action_processing_ms": 0.2732616545945759, "mean_env_wait_ms": 3.4221011547569007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011709451675415039, "StateBufferConnector_ms": 0.00800633430480957, "ViewRequirementAgentConnector_ms": 0.1952822208404541}, "num_episodes": 37, "episode_return_max": 9.437885263022633, "episode_return_min": -1526.77023652335, "episode_return_mean": -412.1586920093312, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.32756303938964, "num_env_steps_trained_throughput_per_sec": 312.32756303938964, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 12580.289, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12580.212, "sample_time_ms": 1146.755, "learn_time_ms": 11367.732, "learn_throughput": 351.873, "synch_weights_time_ms": 64.896}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 84, "trial_id": "4b94b_00000", "date": "2024-08-05_11-56-50", "timestamp": 1722839210, "time_this_iter_s": 12.819822311401367, "time_total_s": 1012.2329707145691, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd0103e20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1012.2329707145691, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 17.96666666666667, "ram_util_percent": 28.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 124.63220572074255, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 0.0010000000000000005, "total_loss": 0.833052228736536, "policy_loss": -0.003350116015644744, "vf_loss": 0.8372493870245914, "vf_explained_var": 0.9989084842304389, "kl": 0.01830161967083465, "entropy": 2.0051927749067544, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 81120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "env_runners": {"episode_reward_max": 9.437885263022633, "episode_reward_min": -1546.3326470753675, "episode_reward_mean": -443.96041132650987, "episode_len_mean": 105.08, "episode_media": {}, "episodes_timesteps_total": 10508, "policy_reward_min": {"policy_0": -1546.3326470753675}, "policy_reward_max": {"policy_0": 9.437885263022633}, "policy_reward_mean": {"policy_0": -443.96041132650987}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29.83659881213483, -326.20722438233537, -258.92318940362287, -1255.669148855684, -1366.3959345203727, -87.316287330176, 7.358779280884681, -168.4550512862201, -174.119605519089, -214.29148689701861, -983.1415787665363, -0.5611812986660294, -303.6949291714326, -40.04140808093379, -461.2423217996659, -90.41785460719221, -582.8423006479666, -78.79399479447254, -16.712931773088144, -572.8127467666883, -7.7452625480813895, -63.863735314136704, -1264.5588517048911, -1364.0305925952632, -1476.2523344566393, -968.5808152210426, -32.68384034018289, 1.6792538775582608, -305.1245923055474, -23.787483675216645, -75.3954902288334, -112.53136107581962, -22.36216845173678, -1526.77023652335, -464.76370484586784, -858.4397394992976, -1115.3226207637701, 6.951022864774295, -170.94759402936828, 9.437885263022633, -732.8524170297561, -97.25144341331054, -250.9739985597413, -293.6833289936832, -57.11942825021416, -156.55159729751387, -661.5544550892295, -1392.8237442004272, -215.30415967491555, -138.50246729734155, -127.06195555222672, -981.9855893065227, -51.81451826092857, -624.3291674948638, -264.03833672611614, -191.43625293206566, -76.63310611162291, -449.48441215937356, -185.9979415840451, -908.8817660971366, -359.08005250796, -180.5511781014914, -492.0719367294768, -199.97272760989296, -76.93488478016904, -170.12377842271408, -192.39344352391794, -901.8848305556172, -120.40395954668882, -379.9943393209612, -687.4908140599821, -1089.3528778735422, -237.95550147777658, -4.589287566008046, -548.3556856265517, -910.5358692414611, -37.08415668830202, -26.18874723763388, -759.9151706162735, -924.3354670227274, -87.31953220173429, -330.0827826305976, -285.36273345887435, -228.70112740654025, -21.884216639741343, -412.5098856533598, -445.7814584489705, -556.2417398719243, -99.90722592890631, -1420.64926000933, -1467.8136147577293, -118.40507295055467, -1546.3326470753675, -351.6128605813532, -453.2536387151563, -386.11984727633285, -761.2576880950662, -926.9102438063625, -69.27274104103032, -1429.9187645557743], "episode_lengths": [52, 117, 102, 150, 150, 62, 34, 99, 83, 84, 150, 35, 114, 58, 142, 62, 150, 72, 46, 150, 39, 63, 150, 150, 150, 150, 57, 39, 102, 55, 57, 75, 50, 150, 126, 150, 150, 30, 66, 35, 150, 48, 101, 123, 67, 98, 150, 150, 95, 94, 91, 150, 52, 150, 150, 74, 63, 150, 103, 150, 125, 105, 150, 86, 62, 77, 84, 150, 70, 126, 150, 150, 107, 36, 150, 150, 57, 45, 150, 150, 55, 150, 109, 111, 48, 138, 150, 150, 58, 150, 150, 73, 150, 114, 127, 112, 150, 150, 68, 150], "policy_policy_0_reward": [-29.83659881213483, -326.20722438233537, -258.92318940362287, -1255.669148855684, -1366.3959345203727, -87.316287330176, 7.358779280884681, -168.4550512862201, -174.119605519089, -214.29148689701861, -983.1415787665363, -0.5611812986660294, -303.6949291714326, -40.04140808093379, -461.2423217996659, -90.41785460719221, -582.8423006479666, -78.79399479447254, -16.712931773088144, -572.8127467666883, -7.7452625480813895, -63.863735314136704, -1264.5588517048911, -1364.0305925952632, -1476.2523344566393, -968.5808152210426, -32.68384034018289, 1.6792538775582608, -305.1245923055474, -23.787483675216645, -75.3954902288334, -112.53136107581962, -22.36216845173678, -1526.77023652335, -464.76370484586784, -858.4397394992976, -1115.3226207637701, 6.951022864774295, -170.94759402936828, 9.437885263022633, -732.8524170297561, -97.25144341331054, -250.9739985597413, -293.6833289936832, -57.11942825021416, -156.55159729751387, -661.5544550892295, -1392.8237442004272, -215.30415967491555, -138.50246729734155, -127.06195555222672, -981.9855893065227, -51.81451826092857, -624.3291674948638, -264.03833672611614, -191.43625293206566, -76.63310611162291, -449.48441215937356, -185.9979415840451, -908.8817660971366, -359.08005250796, -180.5511781014914, -492.0719367294768, -199.97272760989296, -76.93488478016904, -170.12377842271408, -192.39344352391794, -901.8848305556172, -120.40395954668882, -379.9943393209612, -687.4908140599821, -1089.3528778735422, -237.95550147777658, -4.589287566008046, -548.3556856265517, -910.5358692414611, -37.08415668830202, -26.18874723763388, -759.9151706162735, -924.3354670227274, -87.31953220173429, -330.0827826305976, -285.36273345887435, -228.70112740654025, -21.884216639741343, -412.5098856533598, -445.7814584489705, -556.2417398719243, -99.90722592890631, -1420.64926000933, -1467.8136147577293, -118.40507295055467, -1546.3326470753675, -351.6128605813532, -453.2536387151563, -386.11984727633285, -761.2576880950662, -926.9102438063625, -69.27274104103032, -1429.9187645557743]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5558469589882566, "mean_inference_ms": 1.6867574083635868, "mean_action_processing_ms": 0.2733022547769505, "mean_env_wait_ms": 3.4246968783772695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012281417846679688, "StateBufferConnector_ms": 0.008103609085083008, "ViewRequirementAgentConnector_ms": 0.1965792179107666}, "num_episodes": 30, "episode_return_max": 9.437885263022633, "episode_return_min": -1546.3326470753675, "episode_return_mean": -443.96041132650987, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.5002572786407, "num_env_steps_trained_throughput_per_sec": 310.5002572786407, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 340000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 340000, "timers": {"training_iteration_time_ms": 12673.824, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12673.747, "sample_time_ms": 1148.688, "learn_time_ms": 11460.797, "learn_throughput": 349.016, "synch_weights_time_ms": 63.445}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "done": false, "training_iteration": 85, "trial_id": "4b94b_00000", "date": "2024-08-05_11-57-03", "timestamp": 1722839223, "time_this_iter_s": 12.893559455871582, "time_total_s": 1025.1265301704407, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd0103760>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1025.1265301704407, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 17.836842105263155, "ram_util_percent": 28.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 103.87990224957466, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 0.0010000000000000005, "total_loss": 0.8982788994753113, "policy_loss": 0.005982534345821478, "vf_loss": 0.8915556789065401, "vf_explained_var": 0.9988306751474738, "kl": 0.039761073800824914, "entropy": 1.7754453436781963, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 82080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "env_runners": {"episode_reward_max": 9.437885263022633, "episode_reward_min": -1546.3326470753675, "episode_reward_mean": -498.7563460250233, "episode_len_mean": 114.27, "episode_media": {}, "episodes_timesteps_total": 11427, "policy_reward_min": {"policy_0": -1546.3326470753675}, "policy_reward_max": {"policy_0": 9.437885263022633}, "policy_reward_mean": {"policy_0": -498.7563460250233}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1115.3226207637701, 6.951022864774295, -170.94759402936828, 9.437885263022633, -732.8524170297561, -97.25144341331054, -250.9739985597413, -293.6833289936832, -57.11942825021416, -156.55159729751387, -661.5544550892295, -1392.8237442004272, -215.30415967491555, -138.50246729734155, -127.06195555222672, -981.9855893065227, -51.81451826092857, -624.3291674948638, -264.03833672611614, -191.43625293206566, -76.63310611162291, -449.48441215937356, -185.9979415840451, -908.8817660971366, -359.08005250796, -180.5511781014914, -492.0719367294768, -199.97272760989296, -76.93488478016904, -170.12377842271408, -192.39344352391794, -901.8848305556172, -120.40395954668882, -379.9943393209612, -687.4908140599821, -1089.3528778735422, -237.95550147777658, -4.589287566008046, -548.3556856265517, -910.5358692414611, -37.08415668830202, -26.18874723763388, -759.9151706162735, -924.3354670227274, -87.31953220173429, -330.0827826305976, -285.36273345887435, -228.70112740654025, -21.884216639741343, -412.5098856533598, -445.7814584489705, -556.2417398719243, -99.90722592890631, -1420.64926000933, -1467.8136147577293, -118.40507295055467, -1546.3326470753675, -351.6128605813532, -453.2536387151563, -386.11984727633285, -761.2576880950662, -926.9102438063625, -69.27274104103032, -1429.9187645557743, -1157.4137164576484, -1092.3712808984724, -197.53593860786728, -1112.8823043067648, -1464.983941439331, -919.0939028952198, -319.2239867034797, -279.8817528574757, -1381.5672192791765, -372.12052366260787, -436.1317855511397, -678.5831327705894, -51.669471558695236, -500.11629892488054, -829.206170037377, -229.79406827938823, -940.4422329429875, -16.33111806018025, -400.8882230065679, -423.4147865167096, -1138.7764006265527, -355.0793562777279, -467.1832391191863, -183.8019385320187, -225.37688506477213, -98.02195399849319, -373.31575222657716, -471.02536449862504, -1363.9670360697526, -197.14216759689236, -741.229252881877, -354.8263382208579, -96.5711787226052, -1458.475395073726, -300.11574808500586, -420.3615584408694], "episode_lengths": [150, 30, 66, 35, 150, 48, 101, 123, 67, 98, 150, 150, 95, 94, 91, 150, 52, 150, 150, 74, 63, 150, 103, 150, 125, 105, 150, 86, 62, 77, 84, 150, 70, 126, 150, 150, 107, 36, 150, 150, 57, 45, 150, 150, 55, 150, 109, 111, 48, 138, 150, 150, 58, 150, 150, 73, 150, 114, 127, 112, 150, 150, 68, 150, 150, 150, 96, 150, 150, 150, 110, 95, 150, 110, 124, 150, 56, 139, 150, 92, 150, 46, 137, 131, 150, 150, 150, 87, 117, 65, 114, 127, 150, 82, 150, 122, 74, 150, 97, 123], "policy_policy_0_reward": [-1115.3226207637701, 6.951022864774295, -170.94759402936828, 9.437885263022633, -732.8524170297561, -97.25144341331054, -250.9739985597413, -293.6833289936832, -57.11942825021416, -156.55159729751387, -661.5544550892295, -1392.8237442004272, -215.30415967491555, -138.50246729734155, -127.06195555222672, -981.9855893065227, -51.81451826092857, -624.3291674948638, -264.03833672611614, -191.43625293206566, -76.63310611162291, -449.48441215937356, -185.9979415840451, -908.8817660971366, -359.08005250796, -180.5511781014914, -492.0719367294768, -199.97272760989296, -76.93488478016904, -170.12377842271408, -192.39344352391794, -901.8848305556172, -120.40395954668882, -379.9943393209612, -687.4908140599821, -1089.3528778735422, -237.95550147777658, -4.589287566008046, -548.3556856265517, -910.5358692414611, -37.08415668830202, -26.18874723763388, -759.9151706162735, -924.3354670227274, -87.31953220173429, -330.0827826305976, -285.36273345887435, -228.70112740654025, -21.884216639741343, -412.5098856533598, -445.7814584489705, -556.2417398719243, -99.90722592890631, -1420.64926000933, -1467.8136147577293, -118.40507295055467, -1546.3326470753675, -351.6128605813532, -453.2536387151563, -386.11984727633285, -761.2576880950662, -926.9102438063625, -69.27274104103032, -1429.9187645557743, -1157.4137164576484, -1092.3712808984724, -197.53593860786728, -1112.8823043067648, -1464.983941439331, -919.0939028952198, -319.2239867034797, -279.8817528574757, -1381.5672192791765, -372.12052366260787, -436.1317855511397, -678.5831327705894, -51.669471558695236, -500.11629892488054, -829.206170037377, -229.79406827938823, -940.4422329429875, -16.33111806018025, -400.8882230065679, -423.4147865167096, -1138.7764006265527, -355.0793562777279, -467.1832391191863, -183.8019385320187, -225.37688506477213, -98.02195399849319, -373.31575222657716, -471.02536449862504, -1363.9670360697526, -197.14216759689236, -741.229252881877, -354.8263382208579, -96.5711787226052, -1458.475395073726, -300.11574808500586, -420.3615584408694]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5565480821969548, "mean_inference_ms": 1.685266889691983, "mean_action_processing_ms": 0.2735319780508086, "mean_env_wait_ms": 3.425121520241728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012678146362304688, "StateBufferConnector_ms": 0.008221864700317383, "ViewRequirementAgentConnector_ms": 0.20356273651123047}, "num_episodes": 36, "episode_return_max": 9.437885263022633, "episode_return_min": -1546.3326470753675, "episode_return_mean": -498.7563460250233, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.84199574523404, "num_env_steps_trained_throughput_per_sec": 311.84199574523404, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 344000, "timers": {"training_iteration_time_ms": 12743.324, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12743.248, "sample_time_ms": 1134.306, "learn_time_ms": 11543.407, "learn_throughput": 346.518, "synch_weights_time_ms": 64.721}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "done": false, "training_iteration": 86, "trial_id": "4b94b_00000", "date": "2024-08-05_11-57-16", "timestamp": 1722839236, "time_this_iter_s": 12.839913368225098, "time_total_s": 1037.9664435386658, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e11156aa70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1037.9664435386658, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 17.950000000000003, "ram_util_percent": 28.71111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 109.44370579818884, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.0010000000000000005, "total_loss": 0.7381039542068417, "policy_loss": -0.0006079729258393248, "vf_loss": 0.7389511907473206, "vf_explained_var": 0.9991151443993052, "kl": 0.015457700785191326, "entropy": 1.7065402068197728, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 83040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "env_runners": {"episode_reward_max": -16.33111806018025, "episode_reward_min": -1546.3326470753675, "episode_reward_mean": -526.7121577999058, "episode_len_mean": 114.22, "episode_media": {}, "episodes_timesteps_total": 11422, "policy_reward_min": {"policy_0": -1546.3326470753675}, "policy_reward_max": {"policy_0": -16.33111806018025}, "policy_reward_mean": {"policy_0": -526.7121577999058}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-548.3556856265517, -910.5358692414611, -37.08415668830202, -26.18874723763388, -759.9151706162735, -924.3354670227274, -87.31953220173429, -330.0827826305976, -285.36273345887435, -228.70112740654025, -21.884216639741343, -412.5098856533598, -445.7814584489705, -556.2417398719243, -99.90722592890631, -1420.64926000933, -1467.8136147577293, -118.40507295055467, -1546.3326470753675, -351.6128605813532, -453.2536387151563, -386.11984727633285, -761.2576880950662, -926.9102438063625, -69.27274104103032, -1429.9187645557743, -1157.4137164576484, -1092.3712808984724, -197.53593860786728, -1112.8823043067648, -1464.983941439331, -919.0939028952198, -319.2239867034797, -279.8817528574757, -1381.5672192791765, -372.12052366260787, -436.1317855511397, -678.5831327705894, -51.669471558695236, -500.11629892488054, -829.206170037377, -229.79406827938823, -940.4422329429875, -16.33111806018025, -400.8882230065679, -423.4147865167096, -1138.7764006265527, -355.0793562777279, -467.1832391191863, -183.8019385320187, -225.37688506477213, -98.02195399849319, -373.31575222657716, -471.02536449862504, -1363.9670360697526, -197.14216759689236, -741.229252881877, -354.8263382208579, -96.5711787226052, -1458.475395073726, -300.11574808500586, -420.3615584408694, -1014.8438680891074, -436.2834874047455, -70.89204469697363, -1000.5561916976226, -52.76914757786872, -290.92721172256296, -20.883262767473177, -257.0280878873484, -73.15104685140543, -1085.2419016445513, -134.40339907486657, -82.93729378576344, -366.57101414023975, -619.5356433187989, -277.29279237489993, -155.87935898083234, -851.5255824961779, -766.1895678291746, -1043.890179706802, -841.3051104899146, -92.24165980276062, -204.02529763062964, -425.7469957784871, -691.9939352169623, -736.2207924723256, -37.224381731603835, -83.5539239628738, -52.505786284152414, -19.891974702833675, -169.43922951574834, -1069.8441176797985, -325.6781351073302, -109.22434642772133, -1130.5113794828067, -50.76017304945735, -1065.8252744808894, -1270.6704440079293, -39.07814238938122], "episode_lengths": [150, 150, 57, 45, 150, 150, 55, 150, 109, 111, 48, 138, 150, 150, 58, 150, 150, 73, 150, 114, 127, 112, 150, 150, 68, 150, 150, 150, 96, 150, 150, 150, 110, 95, 150, 110, 124, 150, 56, 139, 150, 92, 150, 46, 137, 131, 150, 150, 150, 87, 117, 65, 114, 127, 150, 82, 150, 122, 74, 150, 97, 123, 150, 131, 56, 150, 46, 150, 42, 97, 54, 150, 81, 64, 113, 150, 87, 76, 150, 150, 150, 150, 50, 95, 132, 150, 150, 55, 70, 62, 45, 79, 150, 116, 69, 150, 51, 150, 150, 42], "policy_policy_0_reward": [-548.3556856265517, -910.5358692414611, -37.08415668830202, -26.18874723763388, -759.9151706162735, -924.3354670227274, -87.31953220173429, -330.0827826305976, -285.36273345887435, -228.70112740654025, -21.884216639741343, -412.5098856533598, -445.7814584489705, -556.2417398719243, -99.90722592890631, -1420.64926000933, -1467.8136147577293, -118.40507295055467, -1546.3326470753675, -351.6128605813532, -453.2536387151563, -386.11984727633285, -761.2576880950662, -926.9102438063625, -69.27274104103032, -1429.9187645557743, -1157.4137164576484, -1092.3712808984724, -197.53593860786728, -1112.8823043067648, -1464.983941439331, -919.0939028952198, -319.2239867034797, -279.8817528574757, -1381.5672192791765, -372.12052366260787, -436.1317855511397, -678.5831327705894, -51.669471558695236, -500.11629892488054, -829.206170037377, -229.79406827938823, -940.4422329429875, -16.33111806018025, -400.8882230065679, -423.4147865167096, -1138.7764006265527, -355.0793562777279, -467.1832391191863, -183.8019385320187, -225.37688506477213, -98.02195399849319, -373.31575222657716, -471.02536449862504, -1363.9670360697526, -197.14216759689236, -741.229252881877, -354.8263382208579, -96.5711787226052, -1458.475395073726, -300.11574808500586, -420.3615584408694, -1014.8438680891074, -436.2834874047455, -70.89204469697363, -1000.5561916976226, -52.76914757786872, -290.92721172256296, -20.883262767473177, -257.0280878873484, -73.15104685140543, -1085.2419016445513, -134.40339907486657, -82.93729378576344, -366.57101414023975, -619.5356433187989, -277.29279237489993, -155.87935898083234, -851.5255824961779, -766.1895678291746, -1043.890179706802, -841.3051104899146, -92.24165980276062, -204.02529763062964, -425.7469957784871, -691.9939352169623, -736.2207924723256, -37.224381731603835, -83.5539239628738, -52.505786284152414, -19.891974702833675, -169.43922951574834, -1069.8441176797985, -325.6781351073302, -109.22434642772133, -1130.5113794828067, -50.76017304945735, -1065.8252744808894, -1270.6704440079293, -39.07814238938122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5574173584625182, "mean_inference_ms": 1.6843684449720198, "mean_action_processing_ms": 0.2735102119194614, "mean_env_wait_ms": 3.4237240699621276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013017892837524414, "StateBufferConnector_ms": 0.008211851119995117, "ViewRequirementAgentConnector_ms": 0.20108294486999512}, "num_episodes": 38, "episode_return_max": -16.33111806018025, "episode_return_min": -1546.3326470753675, "episode_return_mean": -526.7121577999058, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.3680566446189, "num_env_steps_trained_throughput_per_sec": 306.3680566446189, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 348000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 12789.66, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12789.583, "sample_time_ms": 1135.888, "learn_time_ms": 11588.423, "learn_throughput": 345.172, "synch_weights_time_ms": 64.448}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "training_iteration": 87, "trial_id": "4b94b_00000", "date": "2024-08-05_11-57-29", "timestamp": 1722839249, "time_this_iter_s": 13.067387342453003, "time_total_s": 1051.0338308811188, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd0102d40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1051.0338308811188, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 17.663157894736845, "ram_util_percent": 28.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 104.3504169990619, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.0010000000000000005, "total_loss": 0.7817357600666582, "policy_loss": -0.001277886405781222, "vf_loss": 0.7834464815290024, "vf_explained_var": 0.9984079427396257, "kl": 0.014042775728376, "entropy": 1.765801985686024, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 3.2568909182392716, "episode_reward_min": -1507.24638896643, "episode_reward_mean": -480.9139859573355, "episode_len_mean": 110.27, "episode_media": {}, "episodes_timesteps_total": 11027, "policy_reward_min": {"policy_0": -1507.24638896643}, "policy_reward_max": {"policy_0": 3.2568909182392716}, "policy_reward_mean": {"policy_0": -480.9139859573355}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-51.669471558695236, -500.11629892488054, -829.206170037377, -229.79406827938823, -940.4422329429875, -16.33111806018025, -400.8882230065679, -423.4147865167096, -1138.7764006265527, -355.0793562777279, -467.1832391191863, -183.8019385320187, -225.37688506477213, -98.02195399849319, -373.31575222657716, -471.02536449862504, -1363.9670360697526, -197.14216759689236, -741.229252881877, -354.8263382208579, -96.5711787226052, -1458.475395073726, -300.11574808500586, -420.3615584408694, -1014.8438680891074, -436.2834874047455, -70.89204469697363, -1000.5561916976226, -52.76914757786872, -290.92721172256296, -20.883262767473177, -257.0280878873484, -73.15104685140543, -1085.2419016445513, -134.40339907486657, -82.93729378576344, -366.57101414023975, -619.5356433187989, -277.29279237489993, -155.87935898083234, -851.5255824961779, -766.1895678291746, -1043.890179706802, -841.3051104899146, -92.24165980276062, -204.02529763062964, -425.7469957784871, -691.9939352169623, -736.2207924723256, -37.224381731603835, -83.5539239628738, -52.505786284152414, -19.891974702833675, -169.43922951574834, -1069.8441176797985, -325.6781351073302, -109.22434642772133, -1130.5113794828067, -50.76017304945735, -1065.8252744808894, -1270.6704440079293, -39.07814238938122, -39.20691085364184, -379.6125532275272, -1117.887456998505, -767.7667245439254, -172.6959548475661, -831.5531755467462, -9.010763194395482, -503.126744635793, -899.6717561246678, -63.08133749724025, -206.5425457698427, -31.509822386275577, -1347.861228404062, -16.186516906759326, -194.6180175000087, -380.04836526834816, -448.75821780907916, -864.3924591283621, -375.8267722299211, -24.169876389861415, -140.38699312417114, -366.9223575162151, -31.97384045466272, -833.1417366668609, -1507.24638896643, -11.034301591455167, -468.7019751546998, -329.7255538110935, -672.548523056493, -1020.2575785315081, 3.2568909182392716, -1070.5970117060083, -922.0800286615811, -742.7684028025903, -146.26993836201154, -1409.1117124989878, -538.844955071335, -555.8428723900063], "episode_lengths": [56, 139, 150, 92, 150, 46, 137, 131, 150, 150, 150, 87, 117, 65, 114, 127, 150, 82, 150, 122, 74, 150, 97, 123, 150, 131, 56, 150, 46, 150, 42, 97, 54, 150, 81, 64, 113, 150, 87, 76, 150, 150, 150, 150, 50, 95, 132, 150, 150, 55, 70, 62, 45, 79, 150, 116, 69, 150, 51, 150, 150, 42, 50, 132, 150, 150, 84, 150, 45, 144, 150, 47, 86, 51, 150, 43, 86, 150, 116, 150, 120, 39, 92, 122, 44, 150, 150, 41, 150, 117, 150, 150, 32, 150, 150, 150, 75, 150, 139, 150], "policy_policy_0_reward": [-51.669471558695236, -500.11629892488054, -829.206170037377, -229.79406827938823, -940.4422329429875, -16.33111806018025, -400.8882230065679, -423.4147865167096, -1138.7764006265527, -355.0793562777279, -467.1832391191863, -183.8019385320187, -225.37688506477213, -98.02195399849319, -373.31575222657716, -471.02536449862504, -1363.9670360697526, -197.14216759689236, -741.229252881877, -354.8263382208579, -96.5711787226052, -1458.475395073726, -300.11574808500586, -420.3615584408694, -1014.8438680891074, -436.2834874047455, -70.89204469697363, -1000.5561916976226, -52.76914757786872, -290.92721172256296, -20.883262767473177, -257.0280878873484, -73.15104685140543, -1085.2419016445513, -134.40339907486657, -82.93729378576344, -366.57101414023975, -619.5356433187989, -277.29279237489993, -155.87935898083234, -851.5255824961779, -766.1895678291746, -1043.890179706802, -841.3051104899146, -92.24165980276062, -204.02529763062964, -425.7469957784871, -691.9939352169623, -736.2207924723256, -37.224381731603835, -83.5539239628738, -52.505786284152414, -19.891974702833675, -169.43922951574834, -1069.8441176797985, -325.6781351073302, -109.22434642772133, -1130.5113794828067, -50.76017304945735, -1065.8252744808894, -1270.6704440079293, -39.07814238938122, -39.20691085364184, -379.6125532275272, -1117.887456998505, -767.7667245439254, -172.6959548475661, -831.5531755467462, -9.010763194395482, -503.126744635793, -899.6717561246678, -63.08133749724025, -206.5425457698427, -31.509822386275577, -1347.861228404062, -16.186516906759326, -194.6180175000087, -380.04836526834816, -448.75821780907916, -864.3924591283621, -375.8267722299211, -24.169876389861415, -140.38699312417114, -366.9223575162151, -31.97384045466272, -833.1417366668609, -1507.24638896643, -11.034301591455167, -468.7019751546998, -329.7255538110935, -672.548523056493, -1020.2575785315081, 3.2568909182392716, -1070.5970117060083, -922.0800286615811, -742.7684028025903, -146.26993836201154, -1409.1117124989878, -538.844955071335, -555.8428723900063]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5564245788153861, "mean_inference_ms": 1.685330785426409, "mean_action_processing_ms": 0.27321011364199377, "mean_env_wait_ms": 3.424707256745703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012923240661621094, "StateBufferConnector_ms": 0.008087396621704102, "ViewRequirementAgentConnector_ms": 0.20073604583740234}, "num_episodes": 38, "episode_return_max": 3.2568909182392716, "episode_return_min": -1507.24638896643, "episode_return_mean": -480.9139859573355, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.99552349949124, "num_env_steps_trained_throughput_per_sec": 308.99552349949124, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 12787.564, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12787.487, "sample_time_ms": 1138.343, "learn_time_ms": 11583.481, "learn_throughput": 345.319, "synch_weights_time_ms": 64.836}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 88, "trial_id": "4b94b_00000", "date": "2024-08-05_11-57-42", "timestamp": 1722839262, "time_this_iter_s": 12.957792282104492, "time_total_s": 1063.9916231632233, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd01024d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1063.9916231632233, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 18.044444444444448, "ram_util_percent": 28.705555555555552}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 86.92139145632585, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.0010000000000000005, "total_loss": 0.6543351073904584, "policy_loss": 0.00033694182833035786, "vf_loss": 0.6543627065140754, "vf_explained_var": 0.9983679185931881, "kl": 0.014908722914393971, "entropy": 1.7797038109352192, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "env_runners": {"episode_reward_max": 3.2568909182392716, "episode_reward_min": -1507.24638896643, "episode_reward_mean": -465.51876470196225, "episode_len_mean": 105.13, "episode_media": {}, "episodes_timesteps_total": 10513, "policy_reward_min": {"policy_0": -1507.24638896643}, "policy_reward_max": {"policy_0": 3.2568909182392716}, "policy_reward_mean": {"policy_0": -465.51876470196225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-851.5255824961779, -766.1895678291746, -1043.890179706802, -841.3051104899146, -92.24165980276062, -204.02529763062964, -425.7469957784871, -691.9939352169623, -736.2207924723256, -37.224381731603835, -83.5539239628738, -52.505786284152414, -19.891974702833675, -169.43922951574834, -1069.8441176797985, -325.6781351073302, -109.22434642772133, -1130.5113794828067, -50.76017304945735, -1065.8252744808894, -1270.6704440079293, -39.07814238938122, -39.20691085364184, -379.6125532275272, -1117.887456998505, -767.7667245439254, -172.6959548475661, -831.5531755467462, -9.010763194395482, -503.126744635793, -899.6717561246678, -63.08133749724025, -206.5425457698427, -31.509822386275577, -1347.861228404062, -16.186516906759326, -194.6180175000087, -380.04836526834816, -448.75821780907916, -864.3924591283621, -375.8267722299211, -24.169876389861415, -140.38699312417114, -366.9223575162151, -31.97384045466272, -833.1417366668609, -1507.24638896643, -11.034301591455167, -468.7019751546998, -329.7255538110935, -672.548523056493, -1020.2575785315081, 3.2568909182392716, -1070.5970117060083, -922.0800286615811, -742.7684028025903, -146.26993836201154, -1409.1117124989878, -538.844955071335, -555.8428723900063, -249.10187490432128, -5.9420399929600975, -86.67008008019894, -121.51951146545854, -1304.5000658646602, -1288.308717683576, -17.816519323326883, -386.3939726696741, -633.9491165807569, -72.09143434491192, -99.30791817655515, -127.91672294208453, -315.6856516361871, -1118.0106626007796, -1065.8472673926588, -195.9271345238687, -332.6319264915433, -12.982290678484, -138.847617119598, -100.422690088587, -246.40087578425428, -129.21424754378077, -49.894084754288706, -838.0179805483966, -1403.1764655579375, -43.48136109225527, -65.01335774353691, -640.3954610941237, -109.91185536223728, -812.4503640902537, -10.442568254634843, -335.6174165115319, -1047.6136404289095, -69.62458913135518, -123.86347447561498, -664.3227037395048, -32.98515948057497, -23.159593681622734, -1367.761647431926, -349.5854999731379], "episode_lengths": [150, 150, 150, 150, 50, 95, 132, 150, 150, 55, 70, 62, 45, 79, 150, 116, 69, 150, 51, 150, 150, 42, 50, 132, 150, 150, 84, 150, 45, 144, 150, 47, 86, 51, 150, 43, 86, 150, 116, 150, 120, 39, 92, 122, 44, 150, 150, 41, 150, 117, 150, 150, 32, 150, 150, 150, 75, 150, 139, 150, 99, 37, 62, 73, 150, 150, 35, 150, 150, 73, 64, 69, 105, 150, 150, 103, 117, 41, 71, 66, 94, 81, 54, 150, 150, 56, 57, 146, 73, 150, 42, 116, 150, 64, 72, 150, 55, 47, 150, 120], "policy_policy_0_reward": [-851.5255824961779, -766.1895678291746, -1043.890179706802, -841.3051104899146, -92.24165980276062, -204.02529763062964, -425.7469957784871, -691.9939352169623, -736.2207924723256, -37.224381731603835, -83.5539239628738, -52.505786284152414, -19.891974702833675, -169.43922951574834, -1069.8441176797985, -325.6781351073302, -109.22434642772133, -1130.5113794828067, -50.76017304945735, -1065.8252744808894, -1270.6704440079293, -39.07814238938122, -39.20691085364184, -379.6125532275272, -1117.887456998505, -767.7667245439254, -172.6959548475661, -831.5531755467462, -9.010763194395482, -503.126744635793, -899.6717561246678, -63.08133749724025, -206.5425457698427, -31.509822386275577, -1347.861228404062, -16.186516906759326, -194.6180175000087, -380.04836526834816, -448.75821780907916, -864.3924591283621, -375.8267722299211, -24.169876389861415, -140.38699312417114, -366.9223575162151, -31.97384045466272, -833.1417366668609, -1507.24638896643, -11.034301591455167, -468.7019751546998, -329.7255538110935, -672.548523056493, -1020.2575785315081, 3.2568909182392716, -1070.5970117060083, -922.0800286615811, -742.7684028025903, -146.26993836201154, -1409.1117124989878, -538.844955071335, -555.8428723900063, -249.10187490432128, -5.9420399929600975, -86.67008008019894, -121.51951146545854, -1304.5000658646602, -1288.308717683576, -17.816519323326883, -386.3939726696741, -633.9491165807569, -72.09143434491192, -99.30791817655515, -127.91672294208453, -315.6856516361871, -1118.0106626007796, -1065.8472673926588, -195.9271345238687, -332.6319264915433, -12.982290678484, -138.847617119598, -100.422690088587, -246.40087578425428, -129.21424754378077, -49.894084754288706, -838.0179805483966, -1403.1764655579375, -43.48136109225527, -65.01335774353691, -640.3954610941237, -109.91185536223728, -812.4503640902537, -10.442568254634843, -335.6174165115319, -1047.6136404289095, -69.62458913135518, -123.86347447561498, -664.3227037395048, -32.98515948057497, -23.159593681622734, -1367.761647431926, -349.5854999731379]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.555478860637212, "mean_inference_ms": 1.68598407426221, "mean_action_processing_ms": 0.272973766699301, "mean_env_wait_ms": 3.423421417311047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012389183044433594, "StateBufferConnector_ms": 0.007911920547485352, "ViewRequirementAgentConnector_ms": 0.19522833824157715}, "num_episodes": 40, "episode_return_max": 3.2568909182392716, "episode_return_min": -1507.24638896643, "episode_return_mean": -465.51876470196225, "episodes_this_iter": 40}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.6146886780649, "num_env_steps_trained_throughput_per_sec": 308.6146886780649, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 356000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 356000, "timers": {"training_iteration_time_ms": 12810.8, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12810.723, "sample_time_ms": 1138.614, "learn_time_ms": 11607.029, "learn_throughput": 344.619, "synch_weights_time_ms": 64.249}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "done": false, "training_iteration": 89, "trial_id": "4b94b_00000", "date": "2024-08-05_11-57-55", "timestamp": 1722839275, "time_this_iter_s": 12.974656581878662, "time_total_s": 1076.966279745102, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e11156aa70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1076.966279745102, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 17.58421052631579, "ram_util_percent": 28.71578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 92.32496455212434, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.0010000000000000005, "total_loss": 0.8998017828445881, "policy_loss": -0.003404587917611934, "vf_loss": 0.9033017482298116, "vf_explained_var": 0.9981139947970709, "kl": 0.01610503382823185, "entropy": 1.6240955540289481, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 85920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": 3.2568909182392716, "episode_reward_min": -1507.24638896643, "episode_reward_mean": -436.6117454417895, "episode_len_mean": 105.76, "episode_media": {}, "episodes_timesteps_total": 10576, "policy_reward_min": {"policy_0": -1507.24638896643}, "policy_reward_max": {"policy_0": 3.2568909182392716}, "policy_reward_mean": {"policy_0": -436.6117454417895}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.186516906759326, -194.6180175000087, -380.04836526834816, -448.75821780907916, -864.3924591283621, -375.8267722299211, -24.169876389861415, -140.38699312417114, -366.9223575162151, -31.97384045466272, -833.1417366668609, -1507.24638896643, -11.034301591455167, -468.7019751546998, -329.7255538110935, -672.548523056493, -1020.2575785315081, 3.2568909182392716, -1070.5970117060083, -922.0800286615811, -742.7684028025903, -146.26993836201154, -1409.1117124989878, -538.844955071335, -555.8428723900063, -249.10187490432128, -5.9420399929600975, -86.67008008019894, -121.51951146545854, -1304.5000658646602, -1288.308717683576, -17.816519323326883, -386.3939726696741, -633.9491165807569, -72.09143434491192, -99.30791817655515, -127.91672294208453, -315.6856516361871, -1118.0106626007796, -1065.8472673926588, -195.9271345238687, -332.6319264915433, -12.982290678484, -138.847617119598, -100.422690088587, -246.40087578425428, -129.21424754378077, -49.894084754288706, -838.0179805483966, -1403.1764655579375, -43.48136109225527, -65.01335774353691, -640.3954610941237, -109.91185536223728, -812.4503640902537, -10.442568254634843, -335.6174165115319, -1047.6136404289095, -69.62458913135518, -123.86347447561498, -664.3227037395048, -32.98515948057497, -23.159593681622734, -1367.761647431926, -349.5854999731379, -1142.6702682118, -472.42019479313115, -210.95963113646056, -83.25800202456094, -323.3226578857408, -220.3610369862957, -513.3298816626036, -34.572520291282245, -74.45855265131502, -181.6711900360951, -108.33160827415098, -71.88845919857827, -19.516484617489507, -607.0302326826044, -202.5906077982427, -118.29239848762681, -580.5670835275183, -247.01794709530415, -591.9939224868602, -1302.7327599919786, -42.97842705018704, -332.7618752438406, -523.0438338000076, -416.43848408033995, -250.41862998402488, -37.23299884558677, -1356.894042207752, -303.68200291380646, -973.5696528019198, -1353.251182254496, -428.39505574105164, -159.76867188346887, -80.41733896369247, -806.7644058409235, -383.5694368079332], "episode_lengths": [43, 86, 150, 116, 150, 120, 39, 92, 122, 44, 150, 150, 41, 150, 117, 150, 150, 32, 150, 150, 150, 75, 150, 139, 150, 99, 37, 62, 73, 150, 150, 35, 150, 150, 73, 64, 69, 105, 150, 150, 103, 117, 41, 71, 66, 94, 81, 54, 150, 150, 56, 57, 146, 73, 150, 42, 116, 150, 64, 72, 150, 55, 47, 150, 120, 150, 128, 107, 78, 123, 101, 138, 58, 54, 91, 75, 61, 46, 150, 70, 72, 150, 98, 150, 150, 51, 116, 150, 127, 97, 49, 150, 105, 150, 150, 150, 150, 40, 150, 133], "policy_policy_0_reward": [-16.186516906759326, -194.6180175000087, -380.04836526834816, -448.75821780907916, -864.3924591283621, -375.8267722299211, -24.169876389861415, -140.38699312417114, -366.9223575162151, -31.97384045466272, -833.1417366668609, -1507.24638896643, -11.034301591455167, -468.7019751546998, -329.7255538110935, -672.548523056493, -1020.2575785315081, 3.2568909182392716, -1070.5970117060083, -922.0800286615811, -742.7684028025903, -146.26993836201154, -1409.1117124989878, -538.844955071335, -555.8428723900063, -249.10187490432128, -5.9420399929600975, -86.67008008019894, -121.51951146545854, -1304.5000658646602, -1288.308717683576, -17.816519323326883, -386.3939726696741, -633.9491165807569, -72.09143434491192, -99.30791817655515, -127.91672294208453, -315.6856516361871, -1118.0106626007796, -1065.8472673926588, -195.9271345238687, -332.6319264915433, -12.982290678484, -138.847617119598, -100.422690088587, -246.40087578425428, -129.21424754378077, -49.894084754288706, -838.0179805483966, -1403.1764655579375, -43.48136109225527, -65.01335774353691, -640.3954610941237, -109.91185536223728, -812.4503640902537, -10.442568254634843, -335.6174165115319, -1047.6136404289095, -69.62458913135518, -123.86347447561498, -664.3227037395048, -32.98515948057497, -23.159593681622734, -1367.761647431926, -349.5854999731379, -1142.6702682118, -472.42019479313115, -210.95963113646056, -83.25800202456094, -323.3226578857408, -220.3610369862957, -513.3298816626036, -34.572520291282245, -74.45855265131502, -181.6711900360951, -108.33160827415098, -71.88845919857827, -19.516484617489507, -607.0302326826044, -202.5906077982427, -118.29239848762681, -580.5670835275183, -247.01794709530415, -591.9939224868602, -1302.7327599919786, -42.97842705018704, -332.7618752438406, -523.0438338000076, -416.43848408033995, -250.41862998402488, -37.23299884558677, -1356.894042207752, -303.68200291380646, -973.5696528019198, -1353.251182254496, -428.39505574105164, -159.76867188346887, -80.41733896369247, -806.7644058409235, -383.5694368079332]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5561041582489923, "mean_inference_ms": 1.6846763957236845, "mean_action_processing_ms": 0.2727887107125945, "mean_env_wait_ms": 3.4251099295058465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012215852737426758, "StateBufferConnector_ms": 0.007868766784667969, "ViewRequirementAgentConnector_ms": 0.1970975399017334}, "num_episodes": 35, "episode_return_max": 3.2568909182392716, "episode_return_min": -1507.24638896643, "episode_return_mean": -436.6117454417895, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.043360914261, "num_env_steps_trained_throughput_per_sec": 312.043360914261, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 12822.501, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12822.424, "sample_time_ms": 1136.826, "learn_time_ms": 11621.613, "learn_throughput": 344.186, "synch_weights_time_ms": 63.155}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 90, "trial_id": "4b94b_00000", "date": "2024-08-05_11-58-08", "timestamp": 1722839288, "time_this_iter_s": 12.830428838729858, "time_total_s": 1089.7967085838318, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd0118c10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1089.7967085838318, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 17.905555555555555, "ram_util_percent": 28.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 109.37732630173365, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.0010000000000000005, "total_loss": 0.8296097405254841, "policy_loss": -0.0028411774207294607, "vf_loss": 0.8328536142905553, "vf_explained_var": 0.9986597353592515, "kl": 0.014873080288210445, "entropy": 1.8144780340294042, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 86880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "env_runners": {"episode_reward_max": 3.4188594244614365, "episode_reward_min": -1403.1764655579375, "episode_reward_mean": -417.0241573992963, "episode_len_mean": 105.92, "episode_media": {}, "episodes_timesteps_total": 10592, "policy_reward_min": {"policy_0": -1403.1764655579375}, "policy_reward_max": {"policy_0": 3.4188594244614365}, "policy_reward_mean": {"policy_0": -417.0241573992963}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1065.8472673926588, -195.9271345238687, -332.6319264915433, -12.982290678484, -138.847617119598, -100.422690088587, -246.40087578425428, -129.21424754378077, -49.894084754288706, -838.0179805483966, -1403.1764655579375, -43.48136109225527, -65.01335774353691, -640.3954610941237, -109.91185536223728, -812.4503640902537, -10.442568254634843, -335.6174165115319, -1047.6136404289095, -69.62458913135518, -123.86347447561498, -664.3227037395048, -32.98515948057497, -23.159593681622734, -1367.761647431926, -349.5854999731379, -1142.6702682118, -472.42019479313115, -210.95963113646056, -83.25800202456094, -323.3226578857408, -220.3610369862957, -513.3298816626036, -34.572520291282245, -74.45855265131502, -181.6711900360951, -108.33160827415098, -71.88845919857827, -19.516484617489507, -607.0302326826044, -202.5906077982427, -118.29239848762681, -580.5670835275183, -247.01794709530415, -591.9939224868602, -1302.7327599919786, -42.97842705018704, -332.7618752438406, -523.0438338000076, -416.43848408033995, -250.41862998402488, -37.23299884558677, -1356.894042207752, -303.68200291380646, -973.5696528019198, -1353.251182254496, -428.39505574105164, -159.76867188346887, -80.41733896369247, -806.7644058409235, -383.5694368079332, -207.19653852472027, 3.4188594244614365, -58.82036345772536, -624.4661551060251, -738.6141873660265, -154.74700008968483, -67.1683170576224, -856.9763129943407, -520.9884014593969, -123.39122913619333, -697.3194255398465, -251.66146087975994, -260.5145255397379, -135.04977938503163, -1362.6668332576253, -8.085439018755542, -152.14116959506276, -55.24267711852129, -933.8309469825355, -225.46280362162352, -563.2337208274794, -661.4879082640239, -977.279093233937, -124.21330366899227, -1050.108771423718, -980.0003601058227, -6.658243998408336, -423.1758404946707, -1080.7712059395901, -350.81791464728036, -357.7552918429813, -938.6742797704962, -268.573355103534, -388.4876620672642, -24.469479948551697, -313.89483680703387, -271.6515950903758, -663.7226522980311, -60.75276645837418], "episode_lengths": [150, 103, 117, 41, 71, 66, 94, 81, 54, 150, 150, 56, 57, 146, 73, 150, 42, 116, 150, 64, 72, 150, 55, 47, 150, 120, 150, 128, 107, 78, 123, 101, 138, 58, 54, 91, 75, 61, 46, 150, 70, 72, 150, 98, 150, 150, 51, 116, 150, 127, 97, 49, 150, 105, 150, 150, 150, 150, 40, 150, 133, 87, 31, 53, 150, 150, 80, 38, 150, 150, 70, 150, 98, 150, 73, 150, 41, 94, 62, 150, 68, 134, 150, 150, 70, 150, 150, 35, 144, 150, 150, 117, 150, 108, 135, 40, 106, 111, 150, 54], "policy_policy_0_reward": [-1065.8472673926588, -195.9271345238687, -332.6319264915433, -12.982290678484, -138.847617119598, -100.422690088587, -246.40087578425428, -129.21424754378077, -49.894084754288706, -838.0179805483966, -1403.1764655579375, -43.48136109225527, -65.01335774353691, -640.3954610941237, -109.91185536223728, -812.4503640902537, -10.442568254634843, -335.6174165115319, -1047.6136404289095, -69.62458913135518, -123.86347447561498, -664.3227037395048, -32.98515948057497, -23.159593681622734, -1367.761647431926, -349.5854999731379, -1142.6702682118, -472.42019479313115, -210.95963113646056, -83.25800202456094, -323.3226578857408, -220.3610369862957, -513.3298816626036, -34.572520291282245, -74.45855265131502, -181.6711900360951, -108.33160827415098, -71.88845919857827, -19.516484617489507, -607.0302326826044, -202.5906077982427, -118.29239848762681, -580.5670835275183, -247.01794709530415, -591.9939224868602, -1302.7327599919786, -42.97842705018704, -332.7618752438406, -523.0438338000076, -416.43848408033995, -250.41862998402488, -37.23299884558677, -1356.894042207752, -303.68200291380646, -973.5696528019198, -1353.251182254496, -428.39505574105164, -159.76867188346887, -80.41733896369247, -806.7644058409235, -383.5694368079332, -207.19653852472027, 3.4188594244614365, -58.82036345772536, -624.4661551060251, -738.6141873660265, -154.74700008968483, -67.1683170576224, -856.9763129943407, -520.9884014593969, -123.39122913619333, -697.3194255398465, -251.66146087975994, -260.5145255397379, -135.04977938503163, -1362.6668332576253, -8.085439018755542, -152.14116959506276, -55.24267711852129, -933.8309469825355, -225.46280362162352, -563.2337208274794, -661.4879082640239, -977.279093233937, -124.21330366899227, -1050.108771423718, -980.0003601058227, -6.658243998408336, -423.1758404946707, -1080.7712059395901, -350.81791464728036, -357.7552918429813, -938.6742797704962, -268.573355103534, -388.4876620672642, -24.469479948551697, -313.89483680703387, -271.6515950903758, -663.7226522980311, -60.75276645837418]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5555010741231062, "mean_inference_ms": 1.6850170411077194, "mean_action_processing_ms": 0.27295652270023085, "mean_env_wait_ms": 3.4242060819042823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011960268020629883, "StateBufferConnector_ms": 0.007867574691772461, "ViewRequirementAgentConnector_ms": 0.19351553916931152}, "num_episodes": 39, "episode_return_max": 3.4188594244614365, "episode_return_min": -1403.1764655579375, "episode_return_mean": -417.0241573992963, "episodes_this_iter": 39}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 394.8214179142552, "num_env_steps_trained_throughput_per_sec": 394.8214179142552, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 364000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 364000, "timers": {"training_iteration_time_ms": 12590.93, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12590.855, "sample_time_ms": 1146.237, "learn_time_ms": 11381.487, "learn_throughput": 351.448, "synch_weights_time_ms": 62.303}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "done": false, "training_iteration": 91, "trial_id": "4b94b_00000", "date": "2024-08-05_11-58-18", "timestamp": 1722839298, "time_this_iter_s": 10.143336296081543, "time_total_s": 1099.9400448799133, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1110a1090>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1099.9400448799133, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 20.342857142857145, "ram_util_percent": 28.707142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 104.66499775350094, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.0010000000000000005, "total_loss": 0.864527441894946, "policy_loss": 0.0050404283276293425, "vf_loss": 0.8589746898040176, "vf_explained_var": 0.9985902580743035, "kl": 0.02507880840918612, "entropy": 1.8682021267712117, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 87840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 3.4188594244614365, "episode_reward_min": -1530.4050945121753, "episode_reward_mean": -418.6576701085198, "episode_len_mean": 104.57, "episode_media": {}, "episodes_timesteps_total": 10457, "policy_reward_min": {"policy_0": -1530.4050945121753}, "policy_reward_max": {"policy_0": 3.4188594244614365}, "policy_reward_mean": {"policy_0": -418.6576701085198}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-202.5906077982427, -118.29239848762681, -580.5670835275183, -247.01794709530415, -591.9939224868602, -1302.7327599919786, -42.97842705018704, -332.7618752438406, -523.0438338000076, -416.43848408033995, -250.41862998402488, -37.23299884558677, -1356.894042207752, -303.68200291380646, -973.5696528019198, -1353.251182254496, -428.39505574105164, -159.76867188346887, -80.41733896369247, -806.7644058409235, -383.5694368079332, -207.19653852472027, 3.4188594244614365, -58.82036345772536, -624.4661551060251, -738.6141873660265, -154.74700008968483, -67.1683170576224, -856.9763129943407, -520.9884014593969, -123.39122913619333, -697.3194255398465, -251.66146087975994, -260.5145255397379, -135.04977938503163, -1362.6668332576253, -8.085439018755542, -152.14116959506276, -55.24267711852129, -933.8309469825355, -225.46280362162352, -563.2337208274794, -661.4879082640239, -977.279093233937, -124.21330366899227, -1050.108771423718, -980.0003601058227, -6.658243998408336, -423.1758404946707, -1080.7712059395901, -350.81791464728036, -357.7552918429813, -938.6742797704962, -268.573355103534, -388.4876620672642, -24.469479948551697, -313.89483680703387, -271.6515950903758, -663.7226522980311, -60.75276645837418, -147.30634666198327, -8.194960350358539, -206.38619376838457, -139.21959662956874, -386.802919890135, -198.27811605361785, -752.3476612803676, -1066.1377825247168, -851.2647097398308, -181.60824552193955, -736.9370474986869, -987.7661345111563, -13.52722535103805, -1038.4668067242835, -109.56195780257974, -294.2001759988267, -168.20508752736842, -23.65318296681314, -148.917099052939, -165.90293027583294, -117.38681408268187, -309.7548777006302, -36.67027728784965, -109.64899178276112, -6.241526090500104, -142.03583202660073, -767.7329038209117, -475.196467948452, -905.8238780805618, -1167.8410279906727, -52.07077710128114, -23.112459583516785, -401.13942428255905, -75.97583526792162, -1.8851200986834675, -417.4836845021537, -1530.4050945121753, -190.79852571177105, -25.263990636517388, -55.58157571046018], "episode_lengths": [70, 72, 150, 98, 150, 150, 51, 116, 150, 127, 97, 49, 150, 105, 150, 150, 150, 150, 40, 150, 133, 87, 31, 53, 150, 150, 80, 38, 150, 150, 70, 150, 98, 150, 73, 150, 41, 94, 62, 150, 68, 134, 150, 150, 70, 150, 150, 35, 144, 150, 150, 117, 150, 108, 135, 40, 106, 111, 150, 54, 81, 46, 62, 91, 127, 62, 150, 150, 150, 104, 150, 150, 39, 150, 72, 110, 88, 52, 73, 64, 64, 107, 55, 63, 40, 70, 150, 150, 150, 150, 50, 45, 150, 58, 31, 116, 150, 87, 39, 54], "policy_policy_0_reward": [-202.5906077982427, -118.29239848762681, -580.5670835275183, -247.01794709530415, -591.9939224868602, -1302.7327599919786, -42.97842705018704, -332.7618752438406, -523.0438338000076, -416.43848408033995, -250.41862998402488, -37.23299884558677, -1356.894042207752, -303.68200291380646, -973.5696528019198, -1353.251182254496, -428.39505574105164, -159.76867188346887, -80.41733896369247, -806.7644058409235, -383.5694368079332, -207.19653852472027, 3.4188594244614365, -58.82036345772536, -624.4661551060251, -738.6141873660265, -154.74700008968483, -67.1683170576224, -856.9763129943407, -520.9884014593969, -123.39122913619333, -697.3194255398465, -251.66146087975994, -260.5145255397379, -135.04977938503163, -1362.6668332576253, -8.085439018755542, -152.14116959506276, -55.24267711852129, -933.8309469825355, -225.46280362162352, -563.2337208274794, -661.4879082640239, -977.279093233937, -124.21330366899227, -1050.108771423718, -980.0003601058227, -6.658243998408336, -423.1758404946707, -1080.7712059395901, -350.81791464728036, -357.7552918429813, -938.6742797704962, -268.573355103534, -388.4876620672642, -24.469479948551697, -313.89483680703387, -271.6515950903758, -663.7226522980311, -60.75276645837418, -147.30634666198327, -8.194960350358539, -206.38619376838457, -139.21959662956874, -386.802919890135, -198.27811605361785, -752.3476612803676, -1066.1377825247168, -851.2647097398308, -181.60824552193955, -736.9370474986869, -987.7661345111563, -13.52722535103805, -1038.4668067242835, -109.56195780257974, -294.2001759988267, -168.20508752736842, -23.65318296681314, -148.917099052939, -165.90293027583294, -117.38681408268187, -309.7548777006302, -36.67027728784965, -109.64899178276112, -6.241526090500104, -142.03583202660073, -767.7329038209117, -475.196467948452, -905.8238780805618, -1167.8410279906727, -52.07077710128114, -23.112459583516785, -401.13942428255905, -75.97583526792162, -1.8851200986834675, -417.4836845021537, -1530.4050945121753, -190.79852571177105, -25.263990636517388, -55.58157571046018]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5558502083340525, "mean_inference_ms": 1.6843620171616498, "mean_action_processing_ms": 0.27359344915866, "mean_env_wait_ms": 3.4246503367925887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012028694152832031, "StateBufferConnector_ms": 0.00789642333984375, "ViewRequirementAgentConnector_ms": 0.1895301342010498}, "num_episodes": 40, "episode_return_max": 3.4188594244614365, "episode_return_min": -1530.4050945121753, "episode_return_mean": -418.6576701085198, "episodes_this_iter": 40}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 328.96941231705466, "num_env_steps_trained_throughput_per_sec": 328.96941231705466, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 12522.637, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12522.561, "sample_time_ms": 1141.961, "learn_time_ms": 11319.113, "learn_throughput": 353.385, "synch_weights_time_ms": 60.706}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 92, "trial_id": "4b94b_00000", "date": "2024-08-05_11-58-30", "timestamp": 1722839310, "time_this_iter_s": 12.171434164047241, "time_total_s": 1112.1114790439606, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e11156aa70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1112.1114790439606, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 18.055555555555557, "ram_util_percent": 28.71111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 108.99623861114183, "cur_kl_coeff": 0.14238281249999998, "cur_lr": 0.0010000000000000005, "total_loss": 0.9587776236856977, "policy_loss": 0.0023400497807112212, "vf_loss": 0.9559451970892648, "vf_explained_var": 0.998852740538617, "kl": 0.015764675677928705, "entropy": 1.752240063995123, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 88800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "env_runners": {"episode_reward_max": -1.8851200986834675, "episode_reward_min": -1530.4050945121753, "episode_reward_mean": -414.3326567526854, "episode_len_mean": 102.72, "episode_media": {}, "episodes_timesteps_total": 10272, "policy_reward_min": {"policy_0": -1530.4050945121753}, "policy_reward_max": {"policy_0": -1.8851200986834675}, "policy_reward_mean": {"policy_0": -414.3326567526854}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-55.24267711852129, -933.8309469825355, -225.46280362162352, -563.2337208274794, -661.4879082640239, -977.279093233937, -124.21330366899227, -1050.108771423718, -980.0003601058227, -6.658243998408336, -423.1758404946707, -1080.7712059395901, -350.81791464728036, -357.7552918429813, -938.6742797704962, -268.573355103534, -388.4876620672642, -24.469479948551697, -313.89483680703387, -271.6515950903758, -663.7226522980311, -60.75276645837418, -147.30634666198327, -8.194960350358539, -206.38619376838457, -139.21959662956874, -386.802919890135, -198.27811605361785, -752.3476612803676, -1066.1377825247168, -851.2647097398308, -181.60824552193955, -736.9370474986869, -987.7661345111563, -13.52722535103805, -1038.4668067242835, -109.56195780257974, -294.2001759988267, -168.20508752736842, -23.65318296681314, -148.917099052939, -165.90293027583294, -117.38681408268187, -309.7548777006302, -36.67027728784965, -109.64899178276112, -6.241526090500104, -142.03583202660073, -767.7329038209117, -475.196467948452, -905.8238780805618, -1167.8410279906727, -52.07077710128114, -23.112459583516785, -401.13942428255905, -75.97583526792162, -1.8851200986834675, -417.4836845021537, -1530.4050945121753, -190.79852571177105, -25.263990636517388, -55.58157571046018, -608.8294372709634, -242.7409707154834, -313.39835961667893, -217.89024614830876, -26.212340564393706, -111.14074563155688, -574.1592963868029, -994.7021923037067, -310.5116101364965, -509.58502798701, -42.38540289722995, -24.890106187818365, -87.68493538689889, -1194.4415829108104, -68.71131225111489, -140.42802717364793, -942.2888146189432, -95.20148835927705, -181.79957697597683, -141.42022586918714, -981.0173141579892, -740.2101613946423, -175.44165993264747, -230.1855637881367, -295.3555166088861, -175.6414624871538, -58.992987468107295, -76.01601041201283, -979.2658161836795, -117.20071183328774, -1347.7109623186263, -486.07487338874705, -960.8829154005075, -75.59374770587759, -883.4642492996816, -971.1778323640465, -629.3327470669157, -264.28147000295564], "episode_lengths": [62, 150, 68, 134, 150, 150, 70, 150, 150, 35, 144, 150, 150, 117, 150, 108, 135, 40, 106, 111, 150, 54, 81, 46, 62, 91, 127, 62, 150, 150, 150, 104, 150, 150, 39, 150, 72, 110, 88, 52, 73, 64, 64, 107, 55, 63, 40, 70, 150, 150, 150, 150, 50, 45, 150, 58, 31, 116, 150, 87, 39, 54, 143, 94, 92, 85, 52, 73, 150, 150, 110, 150, 59, 52, 52, 150, 57, 71, 150, 55, 97, 79, 150, 150, 89, 109, 108, 79, 50, 55, 150, 73, 150, 145, 150, 63, 150, 150, 150, 96], "policy_policy_0_reward": [-55.24267711852129, -933.8309469825355, -225.46280362162352, -563.2337208274794, -661.4879082640239, -977.279093233937, -124.21330366899227, -1050.108771423718, -980.0003601058227, -6.658243998408336, -423.1758404946707, -1080.7712059395901, -350.81791464728036, -357.7552918429813, -938.6742797704962, -268.573355103534, -388.4876620672642, -24.469479948551697, -313.89483680703387, -271.6515950903758, -663.7226522980311, -60.75276645837418, -147.30634666198327, -8.194960350358539, -206.38619376838457, -139.21959662956874, -386.802919890135, -198.27811605361785, -752.3476612803676, -1066.1377825247168, -851.2647097398308, -181.60824552193955, -736.9370474986869, -987.7661345111563, -13.52722535103805, -1038.4668067242835, -109.56195780257974, -294.2001759988267, -168.20508752736842, -23.65318296681314, -148.917099052939, -165.90293027583294, -117.38681408268187, -309.7548777006302, -36.67027728784965, -109.64899178276112, -6.241526090500104, -142.03583202660073, -767.7329038209117, -475.196467948452, -905.8238780805618, -1167.8410279906727, -52.07077710128114, -23.112459583516785, -401.13942428255905, -75.97583526792162, -1.8851200986834675, -417.4836845021537, -1530.4050945121753, -190.79852571177105, -25.263990636517388, -55.58157571046018, -608.8294372709634, -242.7409707154834, -313.39835961667893, -217.89024614830876, -26.212340564393706, -111.14074563155688, -574.1592963868029, -994.7021923037067, -310.5116101364965, -509.58502798701, -42.38540289722995, -24.890106187818365, -87.68493538689889, -1194.4415829108104, -68.71131225111489, -140.42802717364793, -942.2888146189432, -95.20148835927705, -181.79957697597683, -141.42022586918714, -981.0173141579892, -740.2101613946423, -175.44165993264747, -230.1855637881367, -295.3555166088861, -175.6414624871538, -58.992987468107295, -76.01601041201283, -979.2658161836795, -117.20071183328774, -1347.7109623186263, -486.07487338874705, -960.8829154005075, -75.59374770587759, -883.4642492996816, -971.1778323640465, -629.3327470669157, -264.28147000295564]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5558318022012213, "mean_inference_ms": 1.684458941426849, "mean_action_processing_ms": 0.2735009131664124, "mean_env_wait_ms": 3.423373113164136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012259721755981445, "StateBufferConnector_ms": 0.007966995239257812, "ViewRequirementAgentConnector_ms": 0.1917877197265625}, "num_episodes": 38, "episode_return_max": -1.8851200986834675, "episode_return_min": -1530.4050945121753, "episode_return_mean": -414.3326567526854, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.6837241927575, "num_env_steps_trained_throughput_per_sec": 308.6837241927575, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 372000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 12554.648, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12554.574, "sample_time_ms": 1148.086, "learn_time_ms": 11344.651, "learn_throughput": 352.589, "synch_weights_time_ms": 61.058}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "training_iteration": 93, "trial_id": "4b94b_00000", "date": "2024-08-05_11-58-43", "timestamp": 1722839323, "time_this_iter_s": 12.971220016479492, "time_total_s": 1125.08269906044, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd01025f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1125.08269906044, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 18.066666666666666, "ram_util_percent": 28.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 103.90947536031405, "cur_kl_coeff": 0.14238281249999998, "cur_lr": 0.0010000000000000005, "total_loss": 0.7284293642209377, "policy_loss": -0.0035964939646267644, "vf_loss": 0.7320769669953734, "vf_explained_var": 0.998988711523513, "kl": 0.01272458011011023, "entropy": 1.862874916816751, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 89760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "env_runners": {"episode_reward_max": 2.8080693359873776, "episode_reward_min": -1530.4050945121753, "episode_reward_mean": -429.7245067907609, "episode_len_mean": 102.75, "episode_media": {}, "episodes_timesteps_total": 10275, "policy_reward_min": {"policy_0": -1530.4050945121753}, "policy_reward_max": {"policy_0": 2.8080693359873776}, "policy_reward_mean": {"policy_0": -429.7245067907609}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-117.38681408268187, -309.7548777006302, -36.67027728784965, -109.64899178276112, -6.241526090500104, -142.03583202660073, -767.7329038209117, -475.196467948452, -905.8238780805618, -1167.8410279906727, -52.07077710128114, -23.112459583516785, -401.13942428255905, -75.97583526792162, -1.8851200986834675, -417.4836845021537, -1530.4050945121753, -190.79852571177105, -25.263990636517388, -55.58157571046018, -608.8294372709634, -242.7409707154834, -313.39835961667893, -217.89024614830876, -26.212340564393706, -111.14074563155688, -574.1592963868029, -994.7021923037067, -310.5116101364965, -509.58502798701, -42.38540289722995, -24.890106187818365, -87.68493538689889, -1194.4415829108104, -68.71131225111489, -140.42802717364793, -942.2888146189432, -95.20148835927705, -181.79957697597683, -141.42022586918714, -981.0173141579892, -740.2101613946423, -175.44165993264747, -230.1855637881367, -295.3555166088861, -175.6414624871538, -58.992987468107295, -76.01601041201283, -979.2658161836795, -117.20071183328774, -1347.7109623186263, -486.07487338874705, -960.8829154005075, -75.59374770587759, -883.4642492996816, -971.1778323640465, -629.3327470669157, -264.28147000295564, -169.82225429095922, -65.52328710353727, -1349.8403051583032, -270.0954046471254, -82.34042378255606, -969.5739324241969, -442.70321245612286, -109.13363429851917, -6.308986758349676, -151.9974552941124, -698.5297937392756, -268.8713285587567, -70.68770555279063, -1098.063735010328, -623.6024800370758, -26.33192029606599, 2.8080693359873776, -333.13268310329084, -902.1067898432907, -417.09045660297016, -1177.3017741545293, -454.1514611724655, -929.4280323569983, -915.8944941765094, -67.3579101906429, -1069.4413580371704, -59.657310047181774, -48.73803630066338, -233.88953171718066, -140.15022010284045, -14.015577763864092, -63.2280562621732, -71.17558985761167, -45.63104625495563, -407.3290756914166, -511.05408651820443, -989.2923742577883, -1459.63963081194, -862.1976346514272, -290.4591375684396, -1203.4496791414354, -817.7041569941438], "episode_lengths": [64, 107, 55, 63, 40, 70, 150, 150, 150, 150, 50, 45, 150, 58, 31, 116, 150, 87, 39, 54, 143, 94, 92, 85, 52, 73, 150, 150, 110, 150, 59, 52, 52, 150, 57, 71, 150, 55, 97, 79, 150, 150, 89, 109, 108, 79, 50, 55, 150, 73, 150, 145, 150, 63, 150, 150, 150, 96, 103, 57, 150, 125, 64, 150, 138, 68, 39, 73, 150, 110, 54, 150, 150, 44, 34, 107, 150, 124, 150, 150, 150, 150, 56, 150, 63, 56, 90, 77, 40, 58, 59, 63, 150, 150, 150, 150, 150, 106, 150, 150], "policy_policy_0_reward": [-117.38681408268187, -309.7548777006302, -36.67027728784965, -109.64899178276112, -6.241526090500104, -142.03583202660073, -767.7329038209117, -475.196467948452, -905.8238780805618, -1167.8410279906727, -52.07077710128114, -23.112459583516785, -401.13942428255905, -75.97583526792162, -1.8851200986834675, -417.4836845021537, -1530.4050945121753, -190.79852571177105, -25.263990636517388, -55.58157571046018, -608.8294372709634, -242.7409707154834, -313.39835961667893, -217.89024614830876, -26.212340564393706, -111.14074563155688, -574.1592963868029, -994.7021923037067, -310.5116101364965, -509.58502798701, -42.38540289722995, -24.890106187818365, -87.68493538689889, -1194.4415829108104, -68.71131225111489, -140.42802717364793, -942.2888146189432, -95.20148835927705, -181.79957697597683, -141.42022586918714, -981.0173141579892, -740.2101613946423, -175.44165993264747, -230.1855637881367, -295.3555166088861, -175.6414624871538, -58.992987468107295, -76.01601041201283, -979.2658161836795, -117.20071183328774, -1347.7109623186263, -486.07487338874705, -960.8829154005075, -75.59374770587759, -883.4642492996816, -971.1778323640465, -629.3327470669157, -264.28147000295564, -169.82225429095922, -65.52328710353727, -1349.8403051583032, -270.0954046471254, -82.34042378255606, -969.5739324241969, -442.70321245612286, -109.13363429851917, -6.308986758349676, -151.9974552941124, -698.5297937392756, -268.8713285587567, -70.68770555279063, -1098.063735010328, -623.6024800370758, -26.33192029606599, 2.8080693359873776, -333.13268310329084, -902.1067898432907, -417.09045660297016, -1177.3017741545293, -454.1514611724655, -929.4280323569983, -915.8944941765094, -67.3579101906429, -1069.4413580371704, -59.657310047181774, -48.73803630066338, -233.88953171718066, -140.15022010284045, -14.015577763864092, -63.2280562621732, -71.17558985761167, -45.63104625495563, -407.3290756914166, -511.05408651820443, -989.2923742577883, -1459.63963081194, -862.1976346514272, -290.4591375684396, -1203.4496791414354, -817.7041569941438]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5554124896886222, "mean_inference_ms": 1.68417225911995, "mean_action_processing_ms": 0.2734318142776134, "mean_env_wait_ms": 3.4251247751517933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012078285217285156, "StateBufferConnector_ms": 0.008000373840332031, "ViewRequirementAgentConnector_ms": 0.1937577724456787}, "num_episodes": 42, "episode_return_max": 2.8080693359873776, "episode_return_min": -1530.4050945121753, "episode_return_mean": -429.7245067907609, "episodes_this_iter": 42}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.58893720487396, "num_env_steps_trained_throughput_per_sec": 315.58893720487396, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 376000, "timers": {"training_iteration_time_ms": 12541.412, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12541.34, "sample_time_ms": 1144.51, "learn_time_ms": 11334.799, "learn_throughput": 352.896, "synch_weights_time_ms": 61.246}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "done": false, "training_iteration": 94, "trial_id": "4b94b_00000", "date": "2024-08-05_11-58-56", "timestamp": 1722839336, "time_this_iter_s": 12.686679601669312, "time_total_s": 1137.7693786621094, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e1110a1090>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1137.7693786621094, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 18.21666666666667, "ram_util_percent": 28.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 106.84926511545976, "cur_kl_coeff": 0.14238281249999998, "cur_lr": 0.0010000000000000005, "total_loss": 0.8487009692781915, "policy_loss": -0.003018513433441209, "vf_loss": 0.8513689041448136, "vf_explained_var": 0.9981244872634609, "kl": 0.01515433015786896, "entropy": 1.8071382486571868, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 90720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "env_runners": {"episode_reward_max": 2.8080693359873776, "episode_reward_min": -1459.63963081194, "episode_reward_mean": -491.32248554306307, "episode_len_mean": 108.63, "episode_media": {}, "episodes_timesteps_total": 10863, "policy_reward_min": {"policy_0": -1459.63963081194}, "policy_reward_max": {"policy_0": 2.8080693359873776}, "policy_reward_mean": {"policy_0": -491.32248554306307}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.890106187818365, -87.68493538689889, -1194.4415829108104, -68.71131225111489, -140.42802717364793, -942.2888146189432, -95.20148835927705, -181.79957697597683, -141.42022586918714, -981.0173141579892, -740.2101613946423, -175.44165993264747, -230.1855637881367, -295.3555166088861, -175.6414624871538, -58.992987468107295, -76.01601041201283, -979.2658161836795, -117.20071183328774, -1347.7109623186263, -486.07487338874705, -960.8829154005075, -75.59374770587759, -883.4642492996816, -971.1778323640465, -629.3327470669157, -264.28147000295564, -169.82225429095922, -65.52328710353727, -1349.8403051583032, -270.0954046471254, -82.34042378255606, -969.5739324241969, -442.70321245612286, -109.13363429851917, -6.308986758349676, -151.9974552941124, -698.5297937392756, -268.8713285587567, -70.68770555279063, -1098.063735010328, -623.6024800370758, -26.33192029606599, 2.8080693359873776, -333.13268310329084, -902.1067898432907, -417.09045660297016, -1177.3017741545293, -454.1514611724655, -929.4280323569983, -915.8944941765094, -67.3579101906429, -1069.4413580371704, -59.657310047181774, -48.73803630066338, -233.88953171718066, -140.15022010284045, -14.015577763864092, -63.2280562621732, -71.17558985761167, -45.63104625495563, -407.3290756914166, -511.05408651820443, -989.2923742577883, -1459.63963081194, -862.1976346514272, -290.4591375684396, -1203.4496791414354, -817.7041569941438, -625.1627794466901, -1139.3787465663072, -82.52006220708809, -1113.4993952012678, -166.90229455733436, -1187.83787446818, -872.1361101059579, -159.23793367192002, -950.2288983758529, -894.2331454475585, -348.3198344597194, -28.252609014010883, -223.656158410487, -450.92829041506775, -114.57878807994184, -849.0554060298423, -137.87594675836357, -684.8851962880381, -535.1233304046278, -642.5487573047999, -973.3743138025301, -77.93325941572651, -122.32409225333238, -569.248520249179, -872.9290320681722, -1430.1765531496249, -253.80341477629696, -6.05340148082971, -130.17349275421105, -43.56433517215532, -1237.4606167723966], "episode_lengths": [52, 52, 150, 57, 71, 150, 55, 97, 79, 150, 150, 89, 109, 108, 79, 50, 55, 150, 73, 150, 145, 150, 63, 150, 150, 150, 96, 103, 57, 150, 125, 64, 150, 138, 68, 39, 73, 150, 110, 54, 150, 150, 44, 34, 107, 150, 124, 150, 150, 150, 150, 56, 150, 63, 56, 90, 77, 40, 58, 59, 63, 150, 150, 150, 150, 150, 106, 150, 150, 148, 150, 57, 150, 77, 150, 150, 81, 150, 150, 121, 54, 73, 133, 69, 150, 55, 150, 150, 150, 150, 65, 73, 150, 150, 150, 98, 44, 80, 47, 150], "policy_policy_0_reward": [-24.890106187818365, -87.68493538689889, -1194.4415829108104, -68.71131225111489, -140.42802717364793, -942.2888146189432, -95.20148835927705, -181.79957697597683, -141.42022586918714, -981.0173141579892, -740.2101613946423, -175.44165993264747, -230.1855637881367, -295.3555166088861, -175.6414624871538, -58.992987468107295, -76.01601041201283, -979.2658161836795, -117.20071183328774, -1347.7109623186263, -486.07487338874705, -960.8829154005075, -75.59374770587759, -883.4642492996816, -971.1778323640465, -629.3327470669157, -264.28147000295564, -169.82225429095922, -65.52328710353727, -1349.8403051583032, -270.0954046471254, -82.34042378255606, -969.5739324241969, -442.70321245612286, -109.13363429851917, -6.308986758349676, -151.9974552941124, -698.5297937392756, -268.8713285587567, -70.68770555279063, -1098.063735010328, -623.6024800370758, -26.33192029606599, 2.8080693359873776, -333.13268310329084, -902.1067898432907, -417.09045660297016, -1177.3017741545293, -454.1514611724655, -929.4280323569983, -915.8944941765094, -67.3579101906429, -1069.4413580371704, -59.657310047181774, -48.73803630066338, -233.88953171718066, -140.15022010284045, -14.015577763864092, -63.2280562621732, -71.17558985761167, -45.63104625495563, -407.3290756914166, -511.05408651820443, -989.2923742577883, -1459.63963081194, -862.1976346514272, -290.4591375684396, -1203.4496791414354, -817.7041569941438, -625.1627794466901, -1139.3787465663072, -82.52006220708809, -1113.4993952012678, -166.90229455733436, -1187.83787446818, -872.1361101059579, -159.23793367192002, -950.2288983758529, -894.2331454475585, -348.3198344597194, -28.252609014010883, -223.656158410487, -450.92829041506775, -114.57878807994184, -849.0554060298423, -137.87594675836357, -684.8851962880381, -535.1233304046278, -642.5487573047999, -973.3743138025301, -77.93325941572651, -122.32409225333238, -569.248520249179, -872.9290320681722, -1430.1765531496249, -253.80341477629696, -6.05340148082971, -130.17349275421105, -43.56433517215532, -1237.4606167723966]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5555230191467809, "mean_inference_ms": 1.6849613788891238, "mean_action_processing_ms": 0.2732882173428556, "mean_env_wait_ms": 3.427746297372937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011929750442504883, "StateBufferConnector_ms": 0.00800323486328125, "ViewRequirementAgentConnector_ms": 0.19253110885620117}, "num_episodes": 31, "episode_return_max": 2.8080693359873776, "episode_return_min": -1459.63963081194, "episode_return_mean": -491.32248554306307, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 329.2920453491154, "num_env_steps_trained_throughput_per_sec": 329.2920453491154, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 380000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 380000, "timers": {"training_iteration_time_ms": 12467.896, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12467.823, "sample_time_ms": 1141.417, "learn_time_ms": 11263.357, "learn_throughput": 355.134, "synch_weights_time_ms": 62.259}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "done": false, "training_iteration": 95, "trial_id": "4b94b_00000", "date": "2024-08-05_11-59-08", "timestamp": 1722839348, "time_this_iter_s": 12.159361839294434, "time_total_s": 1149.9287405014038, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd0119090>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1149.9287405014038, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 17.933333333333334, "ram_util_percent": 28.71111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 87.7737035860618, "cur_kl_coeff": 0.14238281249999998, "cur_lr": 0.0010000000000000005, "total_loss": 0.7748017340801501, "policy_loss": -0.0016223093291046098, "vf_loss": 0.776249837782234, "vf_explained_var": 0.9983303487300873, "kl": 0.013946145614985117, "entropy": 1.811485506221652, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 91680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 4.167823687073433, "episode_reward_min": -1537.998783997607, "episode_reward_mean": -482.24093775261184, "episode_len_mean": 108.46, "episode_media": {}, "episodes_timesteps_total": 10846, "policy_reward_min": {"policy_0": -1537.998783997607}, "policy_reward_max": {"policy_0": 4.167823687073433}, "policy_reward_mean": {"policy_0": -482.24093775261184}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1098.063735010328, -623.6024800370758, -26.33192029606599, 2.8080693359873776, -333.13268310329084, -902.1067898432907, -417.09045660297016, -1177.3017741545293, -454.1514611724655, -929.4280323569983, -915.8944941765094, -67.3579101906429, -1069.4413580371704, -59.657310047181774, -48.73803630066338, -233.88953171718066, -140.15022010284045, -14.015577763864092, -63.2280562621732, -71.17558985761167, -45.63104625495563, -407.3290756914166, -511.05408651820443, -989.2923742577883, -1459.63963081194, -862.1976346514272, -290.4591375684396, -1203.4496791414354, -817.7041569941438, -625.1627794466901, -1139.3787465663072, -82.52006220708809, -1113.4993952012678, -166.90229455733436, -1187.83787446818, -872.1361101059579, -159.23793367192002, -950.2288983758529, -894.2331454475585, -348.3198344597194, -28.252609014010883, -223.656158410487, -450.92829041506775, -114.57878807994184, -849.0554060298423, -137.87594675836357, -684.8851962880381, -535.1233304046278, -642.5487573047999, -973.3743138025301, -77.93325941572651, -122.32409225333238, -569.248520249179, -872.9290320681722, -1430.1765531496249, -253.80341477629696, -6.05340148082971, -130.17349275421105, -43.56433517215532, -1237.4606167723966, -183.10899313770196, -108.53886544132646, -188.27013643005373, -934.2790995167105, -441.26154619483106, -349.1949482704457, -99.64081859071773, -295.196814023083, -413.2787275689856, -1537.998783997607, -548.6962288850018, -82.67840939208662, -452.48169880016593, -1011.4301502078893, -6.416539045020414, -1083.917596383112, -238.34335622209096, -406.3691044050382, -174.77346490932973, -255.23049839807408, -56.109940491889255, -200.49906863327305, -666.2313943121635, -555.9703639763533, -245.60755923537968, -1346.096405661911, -166.0194567201047, -754.4227847912024, -66.64037154099393, -80.3233996825771, -101.50914827557435, -18.962477406624764, -135.98439150172462, -1273.2623416647893, -244.59403735572974, -781.0438234419605, -30.47116894700247, 4.167823687073433, -446.3471249279771, -94.95180186763457], "episode_lengths": [150, 150, 44, 34, 107, 150, 124, 150, 150, 150, 150, 56, 150, 63, 56, 90, 77, 40, 58, 59, 63, 150, 150, 150, 150, 150, 106, 150, 150, 148, 150, 57, 150, 77, 150, 150, 81, 150, 150, 121, 54, 73, 133, 69, 150, 55, 150, 150, 150, 150, 65, 73, 150, 150, 150, 98, 44, 80, 47, 150, 85, 64, 81, 150, 150, 92, 85, 102, 121, 150, 150, 63, 133, 150, 39, 150, 116, 133, 82, 95, 61, 98, 150, 150, 94, 150, 78, 150, 55, 62, 70, 37, 74, 150, 92, 150, 51, 35, 129, 67], "policy_policy_0_reward": [-1098.063735010328, -623.6024800370758, -26.33192029606599, 2.8080693359873776, -333.13268310329084, -902.1067898432907, -417.09045660297016, -1177.3017741545293, -454.1514611724655, -929.4280323569983, -915.8944941765094, -67.3579101906429, -1069.4413580371704, -59.657310047181774, -48.73803630066338, -233.88953171718066, -140.15022010284045, -14.015577763864092, -63.2280562621732, -71.17558985761167, -45.63104625495563, -407.3290756914166, -511.05408651820443, -989.2923742577883, -1459.63963081194, -862.1976346514272, -290.4591375684396, -1203.4496791414354, -817.7041569941438, -625.1627794466901, -1139.3787465663072, -82.52006220708809, -1113.4993952012678, -166.90229455733436, -1187.83787446818, -872.1361101059579, -159.23793367192002, -950.2288983758529, -894.2331454475585, -348.3198344597194, -28.252609014010883, -223.656158410487, -450.92829041506775, -114.57878807994184, -849.0554060298423, -137.87594675836357, -684.8851962880381, -535.1233304046278, -642.5487573047999, -973.3743138025301, -77.93325941572651, -122.32409225333238, -569.248520249179, -872.9290320681722, -1430.1765531496249, -253.80341477629696, -6.05340148082971, -130.17349275421105, -43.56433517215532, -1237.4606167723966, -183.10899313770196, -108.53886544132646, -188.27013643005373, -934.2790995167105, -441.26154619483106, -349.1949482704457, -99.64081859071773, -295.196814023083, -413.2787275689856, -1537.998783997607, -548.6962288850018, -82.67840939208662, -452.48169880016593, -1011.4301502078893, -6.416539045020414, -1083.917596383112, -238.34335622209096, -406.3691044050382, -174.77346490932973, -255.23049839807408, -56.109940491889255, -200.49906863327305, -666.2313943121635, -555.9703639763533, -245.60755923537968, -1346.096405661911, -166.0194567201047, -754.4227847912024, -66.64037154099393, -80.3233996825771, -101.50914827557435, -18.962477406624764, -135.98439150172462, -1273.2623416647893, -244.59403735572974, -781.0438234419605, -30.47116894700247, 4.167823687073433, -446.3471249279771, -94.95180186763457]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5556453894226968, "mean_inference_ms": 1.6848607578309134, "mean_action_processing_ms": 0.27320487588670317, "mean_env_wait_ms": 3.428295188565634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012374639511108398, "StateBufferConnector_ms": 0.007951021194458008, "ViewRequirementAgentConnector_ms": 0.19072675704956055}, "num_episodes": 40, "episode_return_max": 4.167823687073433, "episode_return_min": -1537.998783997607, "episode_return_mean": -482.24093775261184, "episodes_this_iter": 40}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.32619113137196, "num_env_steps_trained_throughput_per_sec": 315.32619113137196, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 12453.723, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12453.65, "sample_time_ms": 1148.442, "learn_time_ms": 11242.174, "learn_throughput": 355.803, "synch_weights_time_ms": 62.243}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 96, "trial_id": "4b94b_00000", "date": "2024-08-05_11-59-21", "timestamp": 1722839361, "time_this_iter_s": 12.698158264160156, "time_total_s": 1162.626898765564, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd01025f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1162.626898765564, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 18.055555555555557, "ram_util_percent": 28.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 106.92666933834553, "cur_kl_coeff": 0.14238281249999998, "cur_lr": 0.0010000000000000005, "total_loss": 0.8204594642156735, "policy_loss": -0.006353767300606705, "vf_loss": 0.8268623693846167, "vf_explained_var": 0.9982624042158326, "kl": 0.014097004601232385, "entropy": 2.0563060554365316, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 92640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "env_runners": {"episode_reward_max": 4.167823687073433, "episode_reward_min": -1567.5652178683129, "episode_reward_mean": -491.90392763916907, "episode_len_mean": 111.2, "episode_media": {}, "episodes_timesteps_total": 11120, "policy_reward_min": {"policy_0": -1567.5652178683129}, "policy_reward_max": {"policy_0": 4.167823687073433}, "policy_reward_mean": {"policy_0": -491.90392763916907}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1113.4993952012678, -166.90229455733436, -1187.83787446818, -872.1361101059579, -159.23793367192002, -950.2288983758529, -894.2331454475585, -348.3198344597194, -28.252609014010883, -223.656158410487, -450.92829041506775, -114.57878807994184, -849.0554060298423, -137.87594675836357, -684.8851962880381, -535.1233304046278, -642.5487573047999, -973.3743138025301, -77.93325941572651, -122.32409225333238, -569.248520249179, -872.9290320681722, -1430.1765531496249, -253.80341477629696, -6.05340148082971, -130.17349275421105, -43.56433517215532, -1237.4606167723966, -183.10899313770196, -108.53886544132646, -188.27013643005373, -934.2790995167105, -441.26154619483106, -349.1949482704457, -99.64081859071773, -295.196814023083, -413.2787275689856, -1537.998783997607, -548.6962288850018, -82.67840939208662, -452.48169880016593, -1011.4301502078893, -6.416539045020414, -1083.917596383112, -238.34335622209096, -406.3691044050382, -174.77346490932973, -255.23049839807408, -56.109940491889255, -200.49906863327305, -666.2313943121635, -555.9703639763533, -245.60755923537968, -1346.096405661911, -166.0194567201047, -754.4227847912024, -66.64037154099393, -80.3233996825771, -101.50914827557435, -18.962477406624764, -135.98439150172462, -1273.2623416647893, -244.59403735572974, -781.0438234419605, -30.47116894700247, 4.167823687073433, -446.3471249279771, -94.95180186763457, -74.07400112216344, -98.26459344434481, -588.7209755399065, -451.7671980693131, -31.307300569796073, -380.04363257096134, -495.24821608884474, -1155.221173717855, 1.8772712193104648, -1368.5860382742828, -777.5041547675281, -170.74986295844366, -268.26594222267244, -1567.5652178683129, -361.4424363844103, -923.6685824384557, -19.187259037049266, -841.6845413375435, -1244.1461811491001, -447.32336112620095, -17.059037786685042, -353.5948071151613, -767.605602207536, -881.0281222745555, -778.8884396367687, -1226.0861886968867, -374.06508739761404, -103.65435585262668, -675.5611516720812, -571.2726926904206, -399.03031175390095, -631.3275519103078], "episode_lengths": [150, 77, 150, 150, 81, 150, 150, 121, 54, 73, 133, 69, 150, 55, 150, 150, 150, 150, 65, 73, 150, 150, 150, 98, 44, 80, 47, 150, 85, 64, 81, 150, 150, 92, 85, 102, 121, 150, 150, 63, 133, 150, 39, 150, 116, 133, 82, 95, 61, 98, 150, 150, 94, 150, 78, 150, 55, 62, 70, 37, 74, 150, 92, 150, 51, 35, 129, 67, 69, 61, 150, 150, 46, 122, 150, 150, 36, 150, 150, 81, 118, 150, 131, 150, 52, 150, 150, 138, 38, 142, 150, 150, 150, 150, 112, 44, 150, 150, 116, 150], "policy_policy_0_reward": [-1113.4993952012678, -166.90229455733436, -1187.83787446818, -872.1361101059579, -159.23793367192002, -950.2288983758529, -894.2331454475585, -348.3198344597194, -28.252609014010883, -223.656158410487, -450.92829041506775, -114.57878807994184, -849.0554060298423, -137.87594675836357, -684.8851962880381, -535.1233304046278, -642.5487573047999, -973.3743138025301, -77.93325941572651, -122.32409225333238, -569.248520249179, -872.9290320681722, -1430.1765531496249, -253.80341477629696, -6.05340148082971, -130.17349275421105, -43.56433517215532, -1237.4606167723966, -183.10899313770196, -108.53886544132646, -188.27013643005373, -934.2790995167105, -441.26154619483106, -349.1949482704457, -99.64081859071773, -295.196814023083, -413.2787275689856, -1537.998783997607, -548.6962288850018, -82.67840939208662, -452.48169880016593, -1011.4301502078893, -6.416539045020414, -1083.917596383112, -238.34335622209096, -406.3691044050382, -174.77346490932973, -255.23049839807408, -56.109940491889255, -200.49906863327305, -666.2313943121635, -555.9703639763533, -245.60755923537968, -1346.096405661911, -166.0194567201047, -754.4227847912024, -66.64037154099393, -80.3233996825771, -101.50914827557435, -18.962477406624764, -135.98439150172462, -1273.2623416647893, -244.59403735572974, -781.0438234419605, -30.47116894700247, 4.167823687073433, -446.3471249279771, -94.95180186763457, -74.07400112216344, -98.26459344434481, -588.7209755399065, -451.7671980693131, -31.307300569796073, -380.04363257096134, -495.24821608884474, -1155.221173717855, 1.8772712193104648, -1368.5860382742828, -777.5041547675281, -170.74986295844366, -268.26594222267244, -1567.5652178683129, -361.4424363844103, -923.6685824384557, -19.187259037049266, -841.6845413375435, -1244.1461811491001, -447.32336112620095, -17.059037786685042, -353.5948071151613, -767.605602207536, -881.0281222745555, -778.8884396367687, -1226.0861886968867, -374.06508739761404, -103.65435585262668, -675.5611516720812, -571.2726926904206, -399.03031175390095, -631.3275519103078]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5560149629290995, "mean_inference_ms": 1.6831735602513747, "mean_action_processing_ms": 0.27313217047710286, "mean_env_wait_ms": 3.4272500589820662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012395858764648438, "StateBufferConnector_ms": 0.00837254524230957, "ViewRequirementAgentConnector_ms": 0.19190692901611328}, "num_episodes": 32, "episode_return_max": 4.167823687073433, "episode_return_min": -1567.5652178683129, "episode_return_mean": -491.90392763916907, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 328.98832617298945, "num_env_steps_trained_throughput_per_sec": 328.98832617298945, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 388000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 388000, "timers": {"training_iteration_time_ms": 12363.952, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12363.88, "sample_time_ms": 1149.187, "learn_time_ms": 11150.91, "learn_throughput": 358.715, "synch_weights_time_ms": 63.003}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "done": false, "training_iteration": 97, "trial_id": "4b94b_00000", "date": "2024-08-05_11-59-33", "timestamp": 1722839373, "time_this_iter_s": 12.171283483505249, "time_total_s": 1174.7981822490692, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd01037f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1174.7981822490692, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 18.576470588235296, "ram_util_percent": 28.71764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 103.94606577555338, "cur_kl_coeff": 0.14238281249999998, "cur_lr": 0.0010000000000000005, "total_loss": 0.9631546664051711, "policy_loss": -0.0010543645490542985, "vf_loss": 0.9638695280688504, "vf_explained_var": 0.9981866005808115, "kl": 0.01631950507029017, "entropy": 1.9841156527400017, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 93600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "env_runners": {"episode_reward_max": 10.423063709983952, "episode_reward_min": -1567.5652178683129, "episode_reward_mean": -512.3130118304663, "episode_len_mean": 111.66, "episode_media": {}, "episodes_timesteps_total": 11166, "policy_reward_min": {"policy_0": -1567.5652178683129}, "policy_reward_max": {"policy_0": 10.423063709983952}, "policy_reward_mean": {"policy_0": -512.3130118304663}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-413.2787275689856, -1537.998783997607, -548.6962288850018, -82.67840939208662, -452.48169880016593, -1011.4301502078893, -6.416539045020414, -1083.917596383112, -238.34335622209096, -406.3691044050382, -174.77346490932973, -255.23049839807408, -56.109940491889255, -200.49906863327305, -666.2313943121635, -555.9703639763533, -245.60755923537968, -1346.096405661911, -166.0194567201047, -754.4227847912024, -66.64037154099393, -80.3233996825771, -101.50914827557435, -18.962477406624764, -135.98439150172462, -1273.2623416647893, -244.59403735572974, -781.0438234419605, -30.47116894700247, 4.167823687073433, -446.3471249279771, -94.95180186763457, -74.07400112216344, -98.26459344434481, -588.7209755399065, -451.7671980693131, -31.307300569796073, -380.04363257096134, -495.24821608884474, -1155.221173717855, 1.8772712193104648, -1368.5860382742828, -777.5041547675281, -170.74986295844366, -268.26594222267244, -1567.5652178683129, -361.4424363844103, -923.6685824384557, -19.187259037049266, -841.6845413375435, -1244.1461811491001, -447.32336112620095, -17.059037786685042, -353.5948071151613, -767.605602207536, -881.0281222745555, -778.8884396367687, -1226.0861886968867, -374.06508739761404, -103.65435585262668, -675.5611516720812, -571.2726926904206, -399.03031175390095, -631.3275519103078, -1317.869231880124, -412.65358142430324, -291.25565339496956, -486.1147496204733, -335.7229240679297, -439.6592567754428, -301.54852479121814, -404.9453056640428, -125.60054335114938, -200.49737165508526, -736.9376890612267, -1143.429084957728, -219.14878417198958, -1504.2622866190788, -90.42755685653985, -1294.9709244328053, -41.77133703532095, -1100.2267775047092, -47.25292597801828, -252.34256100754106, -1190.0443974209454, -1217.1087496636962, -793.4127398192089, -1230.390613785031, -248.02337337463845, -6.216338763924507, -1137.7579642967783, -229.59513049504926, -1375.2808267508365, -44.003049658181034, 10.423063709983952, -301.7458589453773, -128.67173144409207, -276.1770532549081, -695.6821090156296, -106.41669839401838], "episode_lengths": [121, 150, 150, 63, 133, 150, 39, 150, 116, 133, 82, 95, 61, 98, 150, 150, 94, 150, 78, 150, 55, 62, 70, 37, 74, 150, 92, 150, 51, 35, 129, 67, 69, 61, 150, 150, 46, 122, 150, 150, 36, 150, 150, 81, 118, 150, 131, 150, 52, 150, 150, 138, 38, 142, 150, 150, 150, 150, 112, 44, 150, 150, 116, 150, 150, 120, 115, 125, 121, 150, 121, 106, 71, 108, 150, 150, 106, 150, 61, 150, 59, 150, 51, 107, 150, 150, 150, 150, 101, 37, 150, 112, 150, 46, 32, 106, 71, 83, 150, 66], "policy_policy_0_reward": [-413.2787275689856, -1537.998783997607, -548.6962288850018, -82.67840939208662, -452.48169880016593, -1011.4301502078893, -6.416539045020414, -1083.917596383112, -238.34335622209096, -406.3691044050382, -174.77346490932973, -255.23049839807408, -56.109940491889255, -200.49906863327305, -666.2313943121635, -555.9703639763533, -245.60755923537968, -1346.096405661911, -166.0194567201047, -754.4227847912024, -66.64037154099393, -80.3233996825771, -101.50914827557435, -18.962477406624764, -135.98439150172462, -1273.2623416647893, -244.59403735572974, -781.0438234419605, -30.47116894700247, 4.167823687073433, -446.3471249279771, -94.95180186763457, -74.07400112216344, -98.26459344434481, -588.7209755399065, -451.7671980693131, -31.307300569796073, -380.04363257096134, -495.24821608884474, -1155.221173717855, 1.8772712193104648, -1368.5860382742828, -777.5041547675281, -170.74986295844366, -268.26594222267244, -1567.5652178683129, -361.4424363844103, -923.6685824384557, -19.187259037049266, -841.6845413375435, -1244.1461811491001, -447.32336112620095, -17.059037786685042, -353.5948071151613, -767.605602207536, -881.0281222745555, -778.8884396367687, -1226.0861886968867, -374.06508739761404, -103.65435585262668, -675.5611516720812, -571.2726926904206, -399.03031175390095, -631.3275519103078, -1317.869231880124, -412.65358142430324, -291.25565339496956, -486.1147496204733, -335.7229240679297, -439.6592567754428, -301.54852479121814, -404.9453056640428, -125.60054335114938, -200.49737165508526, -736.9376890612267, -1143.429084957728, -219.14878417198958, -1504.2622866190788, -90.42755685653985, -1294.9709244328053, -41.77133703532095, -1100.2267775047092, -47.25292597801828, -252.34256100754106, -1190.0443974209454, -1217.1087496636962, -793.4127398192089, -1230.390613785031, -248.02337337463845, -6.216338763924507, -1137.7579642967783, -229.59513049504926, -1375.2808267508365, -44.003049658181034, 10.423063709983952, -301.7458589453773, -128.67173144409207, -276.1770532549081, -695.6821090156296, -106.41669839401838]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5562239736526934, "mean_inference_ms": 1.682873657523003, "mean_action_processing_ms": 0.27320552672938353, "mean_env_wait_ms": 3.4288208946620613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012259721755981445, "StateBufferConnector_ms": 0.008537530899047852, "ViewRequirementAgentConnector_ms": 0.19426584243774414}, "num_episodes": 36, "episode_return_max": 10.423063709983952, "episode_return_min": -1567.5652178683129, "episode_return_mean": -512.3130118304663, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 325.1738936927834, "num_env_steps_trained_throughput_per_sec": 325.1738936927834, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 392000, "timers": {"training_iteration_time_ms": 12299.546, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12299.475, "sample_time_ms": 1147.1, "learn_time_ms": 11088.234, "learn_throughput": 360.743, "synch_weights_time_ms": 63.36}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "done": false, "training_iteration": 98, "trial_id": "4b94b_00000", "date": "2024-08-05_11-59-46", "timestamp": 1722839386, "time_this_iter_s": 12.313454866409302, "time_total_s": 1187.1116371154785, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75e11156aa70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1187.1116371154785, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 18.283333333333335, "ram_util_percent": 28.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 126.7509382446607, "cur_kl_coeff": 0.14238281249999998, "cur_lr": 0.0010000000000000005, "total_loss": 0.6949824040134748, "policy_loss": -0.0003118613516562618, "vf_loss": 0.6947838445970168, "vf_explained_var": 0.9990783698235949, "kl": 0.018345127835891616, "entropy": 2.101612088953455, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 94560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "env_runners": {"episode_reward_max": 10.423063709983952, "episode_reward_min": -1567.5652178683129, "episode_reward_mean": -598.8431613452183, "episode_len_mean": 120.51, "episode_media": {}, "episodes_timesteps_total": 12051, "policy_reward_min": {"policy_0": -1567.5652178683129}, "policy_reward_max": {"policy_0": 10.423063709983952}, "policy_reward_mean": {"policy_0": -598.8431613452183}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-588.7209755399065, -451.7671980693131, -31.307300569796073, -380.04363257096134, -495.24821608884474, -1155.221173717855, 1.8772712193104648, -1368.5860382742828, -777.5041547675281, -170.74986295844366, -268.26594222267244, -1567.5652178683129, -361.4424363844103, -923.6685824384557, -19.187259037049266, -841.6845413375435, -1244.1461811491001, -447.32336112620095, -17.059037786685042, -353.5948071151613, -767.605602207536, -881.0281222745555, -778.8884396367687, -1226.0861886968867, -374.06508739761404, -103.65435585262668, -675.5611516720812, -571.2726926904206, -399.03031175390095, -631.3275519103078, -1317.869231880124, -412.65358142430324, -291.25565339496956, -486.1147496204733, -335.7229240679297, -439.6592567754428, -301.54852479121814, -404.9453056640428, -125.60054335114938, -200.49737165508526, -736.9376890612267, -1143.429084957728, -219.14878417198958, -1504.2622866190788, -90.42755685653985, -1294.9709244328053, -41.77133703532095, -1100.2267775047092, -47.25292597801828, -252.34256100754106, -1190.0443974209454, -1217.1087496636962, -793.4127398192089, -1230.390613785031, -248.02337337463845, -6.216338763924507, -1137.7579642967783, -229.59513049504926, -1375.2808267508365, -44.003049658181034, 10.423063709983952, -301.7458589453773, -128.67173144409207, -276.1770532549081, -695.6821090156296, -106.41669839401838, -1401.0544491187673, -235.52181938159046, -585.6115062885846, -961.5994797906652, -1052.6786554599234, -344.4854766765952, -563.425258288436, -1338.8990188527102, -65.96493268682168, -96.95110662759419, -889.2463914593815, -1498.6721545406963, -1118.5199137547436, -106.59014308799411, -155.5483783593963, -711.4690236244454, -608.0466226758176, -95.64178562791602, -1203.031710195198, -518.5404250706614, -240.31127099363556, -356.27819135452, -130.76588218630147, -1055.4515426087373, -717.9652362923051, -588.6791332565807, -964.838997800703, -1207.6792655243955, -61.712947392911985, -1145.4709388305105, -545.3653787776029, -1233.843557640634, -117.31523328756165, -380.67151348954496], "episode_lengths": [150, 150, 46, 122, 150, 150, 36, 150, 150, 81, 118, 150, 131, 150, 52, 150, 150, 138, 38, 142, 150, 150, 150, 150, 112, 44, 150, 150, 116, 150, 150, 120, 115, 125, 121, 150, 121, 106, 71, 108, 150, 150, 106, 150, 61, 150, 59, 150, 51, 107, 150, 150, 150, 150, 101, 37, 150, 112, 150, 46, 32, 106, 71, 83, 150, 66, 150, 113, 150, 150, 150, 116, 150, 150, 66, 64, 150, 150, 150, 86, 78, 150, 150, 78, 150, 150, 116, 107, 76, 150, 150, 150, 150, 150, 56, 150, 150, 150, 75, 119], "policy_policy_0_reward": [-588.7209755399065, -451.7671980693131, -31.307300569796073, -380.04363257096134, -495.24821608884474, -1155.221173717855, 1.8772712193104648, -1368.5860382742828, -777.5041547675281, -170.74986295844366, -268.26594222267244, -1567.5652178683129, -361.4424363844103, -923.6685824384557, -19.187259037049266, -841.6845413375435, -1244.1461811491001, -447.32336112620095, -17.059037786685042, -353.5948071151613, -767.605602207536, -881.0281222745555, -778.8884396367687, -1226.0861886968867, -374.06508739761404, -103.65435585262668, -675.5611516720812, -571.2726926904206, -399.03031175390095, -631.3275519103078, -1317.869231880124, -412.65358142430324, -291.25565339496956, -486.1147496204733, -335.7229240679297, -439.6592567754428, -301.54852479121814, -404.9453056640428, -125.60054335114938, -200.49737165508526, -736.9376890612267, -1143.429084957728, -219.14878417198958, -1504.2622866190788, -90.42755685653985, -1294.9709244328053, -41.77133703532095, -1100.2267775047092, -47.25292597801828, -252.34256100754106, -1190.0443974209454, -1217.1087496636962, -793.4127398192089, -1230.390613785031, -248.02337337463845, -6.216338763924507, -1137.7579642967783, -229.59513049504926, -1375.2808267508365, -44.003049658181034, 10.423063709983952, -301.7458589453773, -128.67173144409207, -276.1770532549081, -695.6821090156296, -106.41669839401838, -1401.0544491187673, -235.52181938159046, -585.6115062885846, -961.5994797906652, -1052.6786554599234, -344.4854766765952, -563.425258288436, -1338.8990188527102, -65.96493268682168, -96.95110662759419, -889.2463914593815, -1498.6721545406963, -1118.5199137547436, -106.59014308799411, -155.5483783593963, -711.4690236244454, -608.0466226758176, -95.64178562791602, -1203.031710195198, -518.5404250706614, -240.31127099363556, -356.27819135452, -130.76588218630147, -1055.4515426087373, -717.9652362923051, -588.6791332565807, -964.838997800703, -1207.6792655243955, -61.712947392911985, -1145.4709388305105, -545.3653787776029, -1233.843557640634, -117.31523328756165, -380.67151348954496]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.555880113299362, "mean_inference_ms": 1.6825586849650522, "mean_action_processing_ms": 0.27321651786754414, "mean_env_wait_ms": 3.4300228327784628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011930227279663086, "StateBufferConnector_ms": 0.008551836013793945, "ViewRequirementAgentConnector_ms": 0.19485187530517578}, "num_episodes": 34, "episode_return_max": 10.423063709983952, "episode_return_min": -1567.5652178683129, "episode_return_mean": -598.8431613452183, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.75571480818354, "num_env_steps_trained_throughput_per_sec": 305.75571480818354, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 396000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 12311.666, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12311.596, "sample_time_ms": 1147.383, "learn_time_ms": 11100.393, "learn_throughput": 360.348, "synch_weights_time_ms": 63.041}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "training_iteration": 99, "trial_id": "4b94b_00000", "date": "2024-08-05_11-59-59", "timestamp": 1722839399, "time_this_iter_s": 13.09597897529602, "time_total_s": 1200.2076160907745, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd0119870>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1200.2076160907745, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 18.01666666666667, "ram_util_percent": 28.71111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 104.31777985692024, "cur_kl_coeff": 0.14238281249999998, "cur_lr": 0.0010000000000000005, "total_loss": 0.8425502684277792, "policy_loss": -0.005286737615824677, "vf_loss": 0.8476879232873519, "vf_explained_var": 0.9975258932138483, "kl": 0.013927248560018294, "entropy": 1.8339146591722966, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 95520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 10.423063709983952, "episode_reward_min": -1517.5319251763897, "episode_reward_mean": -591.1965954946648, "episode_len_mean": 116.47, "episode_media": {}, "episodes_timesteps_total": 11647, "policy_reward_min": {"policy_0": -1517.5319251763897}, "policy_reward_max": {"policy_0": 10.423063709983952}, "policy_reward_mean": {"policy_0": -591.1965954946648}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-439.6592567754428, -301.54852479121814, -404.9453056640428, -125.60054335114938, -200.49737165508526, -736.9376890612267, -1143.429084957728, -219.14878417198958, -1504.2622866190788, -90.42755685653985, -1294.9709244328053, -41.77133703532095, -1100.2267775047092, -47.25292597801828, -252.34256100754106, -1190.0443974209454, -1217.1087496636962, -793.4127398192089, -1230.390613785031, -248.02337337463845, -6.216338763924507, -1137.7579642967783, -229.59513049504926, -1375.2808267508365, -44.003049658181034, 10.423063709983952, -301.7458589453773, -128.67173144409207, -276.1770532549081, -695.6821090156296, -106.41669839401838, -1401.0544491187673, -235.52181938159046, -585.6115062885846, -961.5994797906652, -1052.6786554599234, -344.4854766765952, -563.425258288436, -1338.8990188527102, -65.96493268682168, -96.95110662759419, -889.2463914593815, -1498.6721545406963, -1118.5199137547436, -106.59014308799411, -155.5483783593963, -711.4690236244454, -608.0466226758176, -95.64178562791602, -1203.031710195198, -518.5404250706614, -240.31127099363556, -356.27819135452, -130.76588218630147, -1055.4515426087373, -717.9652362923051, -588.6791332565807, -964.838997800703, -1207.6792655243955, -61.712947392911985, -1145.4709388305105, -545.3653787776029, -1233.843557640634, -117.31523328756165, -380.67151348954496, -683.1992282719618, -1114.2755011684126, -1267.1253359566504, -181.9137746993563, -1203.560137081104, -135.04995341198907, -245.02011769265144, -106.47609626720514, -226.15791291921846, -564.5069992586052, -805.5207751283428, -441.44652236667196, -1011.3254635035527, -1285.1258542761418, -124.71444591995228, -992.4532542678387, -2.008880041581197, -30.217201516075527, -477.31328481703866, -117.28225851668465, -765.302866061866, -1109.1184436064561, -738.2520337117254, -204.25159838407632, -303.522730180687, -24.93367442767116, -821.495770268247, -845.6978828459495, -1310.505481431788, -863.4487283284984, -1517.5319251763897, -72.88970775713474, -132.81906671567717, -125.1541321873041, -99.07066906387232], "episode_lengths": [150, 121, 106, 71, 108, 150, 150, 106, 150, 61, 150, 59, 150, 51, 107, 150, 150, 150, 150, 101, 37, 150, 112, 150, 46, 32, 106, 71, 83, 150, 66, 150, 113, 150, 150, 150, 116, 150, 150, 66, 64, 150, 150, 150, 86, 78, 150, 150, 78, 150, 150, 116, 107, 76, 150, 150, 150, 150, 150, 56, 150, 150, 150, 75, 119, 150, 150, 150, 69, 150, 79, 110, 71, 107, 150, 150, 128, 150, 150, 68, 150, 39, 52, 118, 72, 150, 150, 150, 89, 107, 39, 150, 150, 150, 150, 150, 65, 73, 54, 63], "policy_policy_0_reward": [-439.6592567754428, -301.54852479121814, -404.9453056640428, -125.60054335114938, -200.49737165508526, -736.9376890612267, -1143.429084957728, -219.14878417198958, -1504.2622866190788, -90.42755685653985, -1294.9709244328053, -41.77133703532095, -1100.2267775047092, -47.25292597801828, -252.34256100754106, -1190.0443974209454, -1217.1087496636962, -793.4127398192089, -1230.390613785031, -248.02337337463845, -6.216338763924507, -1137.7579642967783, -229.59513049504926, -1375.2808267508365, -44.003049658181034, 10.423063709983952, -301.7458589453773, -128.67173144409207, -276.1770532549081, -695.6821090156296, -106.41669839401838, -1401.0544491187673, -235.52181938159046, -585.6115062885846, -961.5994797906652, -1052.6786554599234, -344.4854766765952, -563.425258288436, -1338.8990188527102, -65.96493268682168, -96.95110662759419, -889.2463914593815, -1498.6721545406963, -1118.5199137547436, -106.59014308799411, -155.5483783593963, -711.4690236244454, -608.0466226758176, -95.64178562791602, -1203.031710195198, -518.5404250706614, -240.31127099363556, -356.27819135452, -130.76588218630147, -1055.4515426087373, -717.9652362923051, -588.6791332565807, -964.838997800703, -1207.6792655243955, -61.712947392911985, -1145.4709388305105, -545.3653787776029, -1233.843557640634, -117.31523328756165, -380.67151348954496, -683.1992282719618, -1114.2755011684126, -1267.1253359566504, -181.9137746993563, -1203.560137081104, -135.04995341198907, -245.02011769265144, -106.47609626720514, -226.15791291921846, -564.5069992586052, -805.5207751283428, -441.44652236667196, -1011.3254635035527, -1285.1258542761418, -124.71444591995228, -992.4532542678387, -2.008880041581197, -30.217201516075527, -477.31328481703866, -117.28225851668465, -765.302866061866, -1109.1184436064561, -738.2520337117254, -204.25159838407632, -303.522730180687, -24.93367442767116, -821.495770268247, -845.6978828459495, -1310.505481431788, -863.4487283284984, -1517.5319251763897, -72.88970775713474, -132.81906671567717, -125.1541321873041, -99.07066906387232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5559058550451517, "mean_inference_ms": 1.6828562099762179, "mean_action_processing_ms": 0.2733065571957037, "mean_env_wait_ms": 3.432024860766582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01222848892211914, "StateBufferConnector_ms": 0.008039474487304688, "ViewRequirementAgentConnector_ms": 0.19334959983825684}, "num_episodes": 35, "episode_return_max": 10.423063709983952, "episode_return_min": -1517.5319251763897, "episode_return_mean": -591.1965954946648, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 346.85770133577466, "num_env_steps_trained_throughput_per_sec": 346.85770133577466, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 12183.003, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12182.934, "sample_time_ms": 1148.989, "learn_time_ms": 10968.942, "learn_throughput": 364.666, "synch_weights_time_ms": 64.223}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": true, "training_iteration": 100, "trial_id": "4b94b_00000", "date": "2024-08-05_12-00-10", "timestamp": 1722839410, "time_this_iter_s": 11.544965505599976, "time_total_s": 1211.7525815963745, "pid": 678545, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x75dfd0118040>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1211.7525815963745, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 19.064705882352943, "ram_util_percent": 28.7}}
