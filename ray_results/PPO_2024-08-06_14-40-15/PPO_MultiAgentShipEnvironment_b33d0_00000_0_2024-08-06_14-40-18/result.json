{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2064064785527686, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.323180671532949, "policy_loss": -0.018343550935969687, "vf_loss": 9.339522521694501, "vf_explained_var": 0.022865284110109012, "kl": 0.017218051463942174, "entropy": 1.4419315348068873, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -14.892030639565778, "episode_reward_min": -1341.1828788943872, "episode_reward_mean": -538.3803452982803, "episode_len_mean": 109.5, "episode_media": {}, "episodes_timesteps_total": 3066, "policy_reward_min": {"policy_0": -1341.1828788943872}, "policy_reward_max": {"policy_0": -14.892030639565778}, "policy_reward_mean": {"policy_0": -538.3803452982803}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-820.5011101426074, -14.892030639565778, -193.1850380647269, -130.43565031350323, -571.9745692364548, -837.4346758022893, -1059.8399906454595, -709.7930056298148, -363.1467437482664, -56.41383534138582, -443.4680592906348, -1341.1828788943872, -971.6920930085873, -1097.2838083879992, -620.5317203211459, -269.32476968999384, -435.17984627298046, -739.8108508183072, -769.2100682392409, -178.98163175272344, -1025.9481703089264, -249.18653258316846, -117.8445585674858, -518.3911113217923, -888.5472122493468, -118.69361359286496, -176.52980264511453, -355.2262908430769], "episode_lengths": [150, 37, 60, 59, 114, 139, 150, 150, 109, 63, 106, 150, 150, 150, 150, 83, 150, 150, 139, 62, 150, 74, 48, 108, 150, 66, 62, 87], "policy_policy_0_reward": [-820.5011101426074, -14.892030639565778, -193.1850380647269, -130.43565031350323, -571.9745692364548, -837.4346758022893, -1059.8399906454595, -709.7930056298148, -363.1467437482664, -56.41383534138582, -443.4680592906348, -1341.1828788943872, -971.6920930085873, -1097.2838083879992, -620.5317203211459, -269.32476968999384, -435.17984627298046, -739.8108508183072, -769.2100682392409, -178.98163175272344, -1025.9481703089264, -249.18653258316846, -117.8445585674858, -518.3911113217923, -888.5472122493468, -118.69361359286496, -176.52980264511453, -355.2262908430769]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.572247258827716, "mean_inference_ms": 1.6714222649859063, "mean_action_processing_ms": 0.27985655951046934, "mean_env_wait_ms": 3.4156635583299946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012133802686418806, "StateBufferConnector_ms": 0.008277382169451033, "ViewRequirementAgentConnector_ms": 0.18254433359418595}, "num_episodes": 28, "episode_return_max": -14.892030639565778, "episode_return_min": -1341.1828788943872, "episode_return_mean": -538.3803452982803, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 335.48313458591423, "num_env_steps_trained_throughput_per_sec": 335.48313458591423, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 11923.114, "restore_workers_time_ms": 0.025, "training_step_time_ms": 11923.048, "sample_time_ms": 1123.865, "learn_time_ms": 10732.916, "learn_throughput": 372.685, "synch_weights_time_ms": 65.387}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "b33d0_00000", "date": "2024-08-06_14-40-46", "timestamp": 1722935446, "time_this_iter_s": 11.935888051986694, "time_total_s": 11.935888051986694, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78558ff404c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11.935888051986694, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 18.294444444444444, "ram_util_percent": 35.20000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.595665690737466, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.173756872614225, "policy_loss": -0.0171406344830757, "vf_loss": 9.188577172160148, "vf_explained_var": 0.12635096187392872, "kl": 0.01877384641071937, "entropy": 1.4344302975883088, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -14.892030639565778, "episode_reward_min": -1341.1828788943872, "episode_reward_mean": -582.2898592983156, "episode_len_mean": 113.40350877192982, "episode_media": {}, "episodes_timesteps_total": 6464, "policy_reward_min": {"policy_0": -1341.1828788943872}, "policy_reward_max": {"policy_0": -14.892030639565778}, "policy_reward_mean": {"policy_0": -582.2898592983156}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-820.5011101426074, -14.892030639565778, -193.1850380647269, -130.43565031350323, -571.9745692364548, -837.4346758022893, -1059.8399906454595, -709.7930056298148, -363.1467437482664, -56.41383534138582, -443.4680592906348, -1341.1828788943872, -971.6920930085873, -1097.2838083879992, -620.5317203211459, -269.32476968999384, -435.17984627298046, -739.8108508183072, -769.2100682392409, -178.98163175272344, -1025.9481703089264, -249.18653258316846, -117.8445585674858, -518.3911113217923, -888.5472122493468, -118.69361359286496, -176.52980264511453, -355.2262908430769, -1273.684444908645, -925.227111376584, -41.82189429643634, -1029.6212585098738, -1226.2782477116784, -264.78824836281325, -179.8324144483424, -82.06291631264345, -1043.0466345070138, -230.98698303648953, -556.666103332926, -284.85132271439767, -290.4642741930808, -317.03219674621, -884.8071717696615, -18.62122005936686, -1292.2585220418396, -1110.4780997030593, -822.7049871220971, -35.9725043335315, -723.289625425923, -1141.9703798896594, -855.6909080885711, -593.6410488029576, -139.78232574382423, -1203.2791216616276, -417.0651980873626, -839.2206200679066, -290.72652839761884], "episode_lengths": [150, 37, 60, 59, 114, 139, 150, 150, 109, 63, 106, 150, 150, 150, 150, 83, 150, 150, 139, 62, 150, 74, 48, 108, 150, 66, 62, 87, 150, 150, 50, 150, 150, 97, 61, 66, 150, 83, 150, 102, 90, 87, 150, 36, 150, 150, 150, 50, 150, 150, 150, 150, 64, 150, 112, 150, 100], "policy_policy_0_reward": [-820.5011101426074, -14.892030639565778, -193.1850380647269, -130.43565031350323, -571.9745692364548, -837.4346758022893, -1059.8399906454595, -709.7930056298148, -363.1467437482664, -56.41383534138582, -443.4680592906348, -1341.1828788943872, -971.6920930085873, -1097.2838083879992, -620.5317203211459, -269.32476968999384, -435.17984627298046, -739.8108508183072, -769.2100682392409, -178.98163175272344, -1025.9481703089264, -249.18653258316846, -117.8445585674858, -518.3911113217923, -888.5472122493468, -118.69361359286496, -176.52980264511453, -355.2262908430769, -1273.684444908645, -925.227111376584, -41.82189429643634, -1029.6212585098738, -1226.2782477116784, -264.78824836281325, -179.8324144483424, -82.06291631264345, -1043.0466345070138, -230.98698303648953, -556.666103332926, -284.85132271439767, -290.4642741930808, -317.03219674621, -884.8071717696615, -18.62122005936686, -1292.2585220418396, -1110.4780997030593, -822.7049871220971, -35.9725043335315, -723.289625425923, -1141.9703798896594, -855.6909080885711, -593.6410488029576, -139.78232574382423, -1203.2791216616276, -417.0651980873626, -839.2206200679066, -290.72652839761884]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5688286355271099, "mean_inference_ms": 1.666810015410216, "mean_action_processing_ms": 0.27900980081680576, "mean_env_wait_ms": 3.410573984867699, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012995067395662007, "StateBufferConnector_ms": 0.01140351881060684, "ViewRequirementAgentConnector_ms": 0.18580043525026554}, "num_episodes": 29, "episode_return_max": -14.892030639565778, "episode_return_min": -1341.1828788943872, "episode_return_mean": -582.2898592983156, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 332.17073423240356, "num_env_steps_trained_throughput_per_sec": 332.17073423240356, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 11982.562, "restore_workers_time_ms": 0.024, "training_step_time_ms": 11982.5, "sample_time_ms": 1110.258, "learn_time_ms": 10804.936, "learn_throughput": 370.201, "synch_weights_time_ms": 66.485}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "b33d0_00000", "date": "2024-08-06_14-40-58", "timestamp": 1722935458, "time_this_iter_s": 12.054667711257935, "time_total_s": 23.99055576324463, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78558ff40790>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23.99055576324463, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 18.517647058823528, "ram_util_percent": 35.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6202909640346965, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.453042394916217, "policy_loss": -0.01808897722318458, "vf_loss": 9.468684135874112, "vf_explained_var": 0.14598446463545164, "kl": 0.01914726474728923, "entropy": 1.3822416914006075, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -14.892030639565778, "episode_reward_min": -1421.461766980029, "episode_reward_mean": -616.8282427805656, "episode_len_mean": 116.04597701149426, "episode_media": {}, "episodes_timesteps_total": 10096, "policy_reward_min": {"policy_0": -1421.461766980029}, "policy_reward_max": {"policy_0": -14.892030639565778}, "policy_reward_mean": {"policy_0": -616.8282427805656}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-820.5011101426074, -14.892030639565778, -193.1850380647269, -130.43565031350323, -571.9745692364548, -837.4346758022893, -1059.8399906454595, -709.7930056298148, -363.1467437482664, -56.41383534138582, -443.4680592906348, -1341.1828788943872, -971.6920930085873, -1097.2838083879992, -620.5317203211459, -269.32476968999384, -435.17984627298046, -739.8108508183072, -769.2100682392409, -178.98163175272344, -1025.9481703089264, -249.18653258316846, -117.8445585674858, -518.3911113217923, -888.5472122493468, -118.69361359286496, -176.52980264511453, -355.2262908430769, -1273.684444908645, -925.227111376584, -41.82189429643634, -1029.6212585098738, -1226.2782477116784, -264.78824836281325, -179.8324144483424, -82.06291631264345, -1043.0466345070138, -230.98698303648953, -556.666103332926, -284.85132271439767, -290.4642741930808, -317.03219674621, -884.8071717696615, -18.62122005936686, -1292.2585220418396, -1110.4780997030593, -822.7049871220971, -35.9725043335315, -723.289625425923, -1141.9703798896594, -855.6909080885711, -593.6410488029576, -139.78232574382423, -1203.2791216616276, -417.0651980873626, -839.2206200679066, -290.72652839761884, -339.4924059841478, -101.19079885064471, -137.9098374158989, -72.99244359665532, -969.322866228278, -1041.5555945897697, -86.1795903092797, -1156.9641522639522, -457.28567287240304, -1277.7900726516937, -207.42746436727896, -333.7692457898627, -1147.294449784623, -1137.2726793577501, -1123.4217122582545, -920.3587560879381, -792.1438475874216, -68.65595030743286, -1338.379997203565, -985.219076409416, -914.8536560253883, -498.8716348264619, -335.325432512411, -953.1324375565096, -624.9829889459386, -140.39242979897995, -754.4348318504092, -1421.461766980029, -48.69840658335553, -1086.754942909471], "episode_lengths": [150, 37, 60, 59, 114, 139, 150, 150, 109, 63, 106, 150, 150, 150, 150, 83, 150, 150, 139, 62, 150, 74, 48, 108, 150, 66, 62, 87, 150, 150, 50, 150, 150, 97, 61, 66, 150, 83, 150, 102, 90, 87, 150, 36, 150, 150, 150, 50, 150, 150, 150, 150, 64, 150, 112, 150, 100, 105, 79, 77, 45, 150, 150, 71, 150, 105, 150, 98, 90, 150, 150, 150, 150, 150, 39, 150, 150, 150, 150, 112, 150, 150, 66, 150, 150, 45, 150], "policy_policy_0_reward": [-820.5011101426074, -14.892030639565778, -193.1850380647269, -130.43565031350323, -571.9745692364548, -837.4346758022893, -1059.8399906454595, -709.7930056298148, -363.1467437482664, -56.41383534138582, -443.4680592906348, -1341.1828788943872, -971.6920930085873, -1097.2838083879992, -620.5317203211459, -269.32476968999384, -435.17984627298046, -739.8108508183072, -769.2100682392409, -178.98163175272344, -1025.9481703089264, -249.18653258316846, -117.8445585674858, -518.3911113217923, -888.5472122493468, -118.69361359286496, -176.52980264511453, -355.2262908430769, -1273.684444908645, -925.227111376584, -41.82189429643634, -1029.6212585098738, -1226.2782477116784, -264.78824836281325, -179.8324144483424, -82.06291631264345, -1043.0466345070138, -230.98698303648953, -556.666103332926, -284.85132271439767, -290.4642741930808, -317.03219674621, -884.8071717696615, -18.62122005936686, -1292.2585220418396, -1110.4780997030593, -822.7049871220971, -35.9725043335315, -723.289625425923, -1141.9703798896594, -855.6909080885711, -593.6410488029576, -139.78232574382423, -1203.2791216616276, -417.0651980873626, -839.2206200679066, -290.72652839761884, -339.4924059841478, -101.19079885064471, -137.9098374158989, -72.99244359665532, -969.322866228278, -1041.5555945897697, -86.1795903092797, -1156.9641522639522, -457.28567287240304, -1277.7900726516937, -207.42746436727896, -333.7692457898627, -1147.294449784623, -1137.2726793577501, -1123.4217122582545, -920.3587560879381, -792.1438475874216, -68.65595030743286, -1338.379997203565, -985.219076409416, -914.8536560253883, -498.8716348264619, -335.325432512411, -953.1324375565096, -624.9829889459386, -140.39242979897995, -754.4348318504092, -1421.461766980029, -48.69840658335553, -1086.754942909471]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5686297430623218, "mean_inference_ms": 1.670704509651894, "mean_action_processing_ms": 0.27929042512380536, "mean_env_wait_ms": 3.4101433135162273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012964489816249102, "StateBufferConnector_ms": 0.010499460943813982, "ViewRequirementAgentConnector_ms": 0.18883957259956446}, "num_episodes": 30, "episode_return_max": -14.892030639565778, "episode_return_min": -1421.461766980029, "episode_return_mean": -616.8282427805656, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 357.4385918519708, "num_env_steps_trained_throughput_per_sec": 357.4385918519708, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 11718.624, "restore_workers_time_ms": 0.025, "training_step_time_ms": 11718.56, "sample_time_ms": 1122.694, "learn_time_ms": 10530.174, "learn_throughput": 379.861, "synch_weights_time_ms": 64.867}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "b33d0_00000", "date": "2024-08-06_14-41-10", "timestamp": 1722935470, "time_this_iter_s": 11.202472448348999, "time_total_s": 35.19302821159363, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2301f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 35.19302821159363, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 19.4, "ram_util_percent": 35.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6748303889607388, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.034212771554788, "policy_loss": -0.016823506749642548, "vf_loss": 9.048209663232168, "vf_explained_var": 0.23576080550750098, "kl": 0.020829884932148466, "entropy": 1.3393450848758222, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -18.62122005936686, "episode_reward_min": -1421.461766980029, "episode_reward_mean": -648.3456652523586, "episode_len_mean": 119.88, "episode_media": {}, "episodes_timesteps_total": 11988, "policy_reward_min": {"policy_0": -1421.461766980029}, "policy_reward_max": {"policy_0": -18.62122005936686}, "policy_reward_mean": {"policy_0": -648.3456652523586}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1025.9481703089264, -249.18653258316846, -117.8445585674858, -518.3911113217923, -888.5472122493468, -118.69361359286496, -176.52980264511453, -355.2262908430769, -1273.684444908645, -925.227111376584, -41.82189429643634, -1029.6212585098738, -1226.2782477116784, -264.78824836281325, -179.8324144483424, -82.06291631264345, -1043.0466345070138, -230.98698303648953, -556.666103332926, -284.85132271439767, -290.4642741930808, -317.03219674621, -884.8071717696615, -18.62122005936686, -1292.2585220418396, -1110.4780997030593, -822.7049871220971, -35.9725043335315, -723.289625425923, -1141.9703798896594, -855.6909080885711, -593.6410488029576, -139.78232574382423, -1203.2791216616276, -417.0651980873626, -839.2206200679066, -290.72652839761884, -339.4924059841478, -101.19079885064471, -137.9098374158989, -72.99244359665532, -969.322866228278, -1041.5555945897697, -86.1795903092797, -1156.9641522639522, -457.28567287240304, -1277.7900726516937, -207.42746436727896, -333.7692457898627, -1147.294449784623, -1137.2726793577501, -1123.4217122582545, -920.3587560879381, -792.1438475874216, -68.65595030743286, -1338.379997203565, -985.219076409416, -914.8536560253883, -498.8716348264619, -335.325432512411, -953.1324375565096, -624.9829889459386, -140.39242979897995, -754.4348318504092, -1421.461766980029, -48.69840658335553, -1086.754942909471, -478.98686252550783, -882.4741826528809, -746.2136287015959, -1101.929909358966, -988.4834474064517, -594.2203258972054, -1015.7994741343855, -1324.8935521334263, -52.7911042347872, -718.706928119791, -1051.6956428812027, -529.4313267559429, -374.98153580409905, -1016.4303651318247, -553.7450019301328, -996.2158942914618, -990.8816083675648, -743.372766365976, -1041.272831870689, -817.6565318094661, -487.56263364838463, -1069.2332185762048, -717.2305531080378, -855.992163747417, -113.68307851868502, -42.04644815056116, -1077.9329670153902, -54.38125919134981, -807.2185318155015, -534.7027543801742, -254.15295019668653, -22.16606420765792, -738.3062366373038], "episode_lengths": [150, 74, 48, 108, 150, 66, 62, 87, 150, 150, 50, 150, 150, 97, 61, 66, 150, 83, 150, 102, 90, 87, 150, 36, 150, 150, 150, 50, 150, 150, 150, 150, 64, 150, 112, 150, 100, 105, 79, 77, 45, 150, 150, 71, 150, 105, 150, 98, 90, 150, 150, 150, 150, 150, 39, 150, 150, 150, 150, 112, 150, 150, 66, 150, 150, 45, 150, 150, 150, 150, 150, 150, 150, 150, 150, 36, 131, 150, 130, 150, 150, 150, 150, 150, 133, 150, 150, 112, 150, 150, 150, 46, 52, 150, 42, 150, 117, 81, 33, 150], "policy_policy_0_reward": [-1025.9481703089264, -249.18653258316846, -117.8445585674858, -518.3911113217923, -888.5472122493468, -118.69361359286496, -176.52980264511453, -355.2262908430769, -1273.684444908645, -925.227111376584, -41.82189429643634, -1029.6212585098738, -1226.2782477116784, -264.78824836281325, -179.8324144483424, -82.06291631264345, -1043.0466345070138, -230.98698303648953, -556.666103332926, -284.85132271439767, -290.4642741930808, -317.03219674621, -884.8071717696615, -18.62122005936686, -1292.2585220418396, -1110.4780997030593, -822.7049871220971, -35.9725043335315, -723.289625425923, -1141.9703798896594, -855.6909080885711, -593.6410488029576, -139.78232574382423, -1203.2791216616276, -417.0651980873626, -839.2206200679066, -290.72652839761884, -339.4924059841478, -101.19079885064471, -137.9098374158989, -72.99244359665532, -969.322866228278, -1041.5555945897697, -86.1795903092797, -1156.9641522639522, -457.28567287240304, -1277.7900726516937, -207.42746436727896, -333.7692457898627, -1147.294449784623, -1137.2726793577501, -1123.4217122582545, -920.3587560879381, -792.1438475874216, -68.65595030743286, -1338.379997203565, -985.219076409416, -914.8536560253883, -498.8716348264619, -335.325432512411, -953.1324375565096, -624.9829889459386, -140.39242979897995, -754.4348318504092, -1421.461766980029, -48.69840658335553, -1086.754942909471, -478.98686252550783, -882.4741826528809, -746.2136287015959, -1101.929909358966, -988.4834474064517, -594.2203258972054, -1015.7994741343855, -1324.8935521334263, -52.7911042347872, -718.706928119791, -1051.6956428812027, -529.4313267559429, -374.98153580409905, -1016.4303651318247, -553.7450019301328, -996.2158942914618, -990.8816083675648, -743.372766365976, -1041.272831870689, -817.6565318094661, -487.56263364838463, -1069.2332185762048, -717.2305531080378, -855.992163747417, -113.68307851868502, -42.04644815056116, -1077.9329670153902, -54.38125919134981, -807.2185318155015, -534.7027543801742, -254.15295019668653, -22.16606420765792, -738.3062366373038]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5670076673131053, "mean_inference_ms": 1.6730885054816518, "mean_action_processing_ms": 0.27861706051810275, "mean_env_wait_ms": 3.4058531247743997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013462066650390625, "StateBufferConnector_ms": 0.010479450225830078, "ViewRequirementAgentConnector_ms": 0.1920640468597412}, "num_episodes": 33, "episode_return_max": -18.62122005936686, "episode_return_min": -1421.461766980029, "episode_return_mean": -648.3456652523586, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 341.52081124937195, "num_env_steps_trained_throughput_per_sec": 341.52081124937195, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 11717.05, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11716.983, "sample_time_ms": 1118.233, "learn_time_ms": 10534.887, "learn_throughput": 379.691, "synch_weights_time_ms": 63.048}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "b33d0_00000", "date": "2024-08-06_14-41-21", "timestamp": 1722935481, "time_this_iter_s": 11.72226881980896, "time_total_s": 46.91529703140259, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2309d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 46.91529703140259, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 19.225, "ram_util_percent": 35.26875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2489200359831254, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.834218346575897, "policy_loss": -0.021714210485030586, "vf_loss": 8.85105164994796, "vf_explained_var": 0.24084505755454302, "kl": 0.02098685593467357, "entropy": 1.4151529715706905, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -22.16606420765792, "episode_reward_min": -1421.461766980029, "episode_reward_mean": -676.5202312659467, "episode_len_mean": 124.15, "episode_media": {}, "episodes_timesteps_total": 12415, "policy_reward_min": {"policy_0": -1421.461766980029}, "policy_reward_max": {"policy_0": -22.16606420765792}, "policy_reward_mean": {"policy_0": -676.5202312659467}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139.78232574382423, -1203.2791216616276, -417.0651980873626, -839.2206200679066, -290.72652839761884, -339.4924059841478, -101.19079885064471, -137.9098374158989, -72.99244359665532, -969.322866228278, -1041.5555945897697, -86.1795903092797, -1156.9641522639522, -457.28567287240304, -1277.7900726516937, -207.42746436727896, -333.7692457898627, -1147.294449784623, -1137.2726793577501, -1123.4217122582545, -920.3587560879381, -792.1438475874216, -68.65595030743286, -1338.379997203565, -985.219076409416, -914.8536560253883, -498.8716348264619, -335.325432512411, -953.1324375565096, -624.9829889459386, -140.39242979897995, -754.4348318504092, -1421.461766980029, -48.69840658335553, -1086.754942909471, -478.98686252550783, -882.4741826528809, -746.2136287015959, -1101.929909358966, -988.4834474064517, -594.2203258972054, -1015.7994741343855, -1324.8935521334263, -52.7911042347872, -718.706928119791, -1051.6956428812027, -529.4313267559429, -374.98153580409905, -1016.4303651318247, -553.7450019301328, -996.2158942914618, -990.8816083675648, -743.372766365976, -1041.272831870689, -817.6565318094661, -487.56263364838463, -1069.2332185762048, -717.2305531080378, -855.992163747417, -113.68307851868502, -42.04644815056116, -1077.9329670153902, -54.38125919134981, -807.2185318155015, -534.7027543801742, -254.15295019668653, -22.16606420765792, -738.3062366373038, -1227.4991114212896, -1042.4463133202432, -94.26635946467506, -184.72538008902987, -672.6885250062999, -143.95068687618536, -687.4496904136564, -108.92915720766926, -419.96732396823825, -1007.8844789787433, -1015.282832934612, -161.20573657862775, -1020.8665235695262, -462.6582159180805, -1409.61904989889, -176.8331942693357, -950.8991317637243, -1046.961150300261, -1035.7673097007691, -813.4334397069103, -1047.9046647350488, -294.0926806015162, -982.2104502199635, -991.304698683911, -872.8494786305893, -484.14207453678057, -988.3297391352904, -396.7692884692683, -775.6922578938992, -177.78518832205003, -26.59254288017397, -772.615735669144], "episode_lengths": [64, 150, 112, 150, 100, 105, 79, 77, 45, 150, 150, 71, 150, 105, 150, 98, 90, 150, 150, 150, 150, 150, 39, 150, 150, 150, 150, 112, 150, 150, 66, 150, 150, 45, 150, 150, 150, 150, 150, 150, 150, 150, 150, 36, 131, 150, 130, 150, 150, 150, 150, 150, 133, 150, 150, 112, 150, 150, 150, 46, 52, 150, 42, 150, 117, 81, 33, 150, 150, 150, 51, 69, 150, 83, 150, 55, 128, 150, 150, 82, 150, 112, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 107, 150, 96, 44, 150], "policy_policy_0_reward": [-139.78232574382423, -1203.2791216616276, -417.0651980873626, -839.2206200679066, -290.72652839761884, -339.4924059841478, -101.19079885064471, -137.9098374158989, -72.99244359665532, -969.322866228278, -1041.5555945897697, -86.1795903092797, -1156.9641522639522, -457.28567287240304, -1277.7900726516937, -207.42746436727896, -333.7692457898627, -1147.294449784623, -1137.2726793577501, -1123.4217122582545, -920.3587560879381, -792.1438475874216, -68.65595030743286, -1338.379997203565, -985.219076409416, -914.8536560253883, -498.8716348264619, -335.325432512411, -953.1324375565096, -624.9829889459386, -140.39242979897995, -754.4348318504092, -1421.461766980029, -48.69840658335553, -1086.754942909471, -478.98686252550783, -882.4741826528809, -746.2136287015959, -1101.929909358966, -988.4834474064517, -594.2203258972054, -1015.7994741343855, -1324.8935521334263, -52.7911042347872, -718.706928119791, -1051.6956428812027, -529.4313267559429, -374.98153580409905, -1016.4303651318247, -553.7450019301328, -996.2158942914618, -990.8816083675648, -743.372766365976, -1041.272831870689, -817.6565318094661, -487.56263364838463, -1069.2332185762048, -717.2305531080378, -855.992163747417, -113.68307851868502, -42.04644815056116, -1077.9329670153902, -54.38125919134981, -807.2185318155015, -534.7027543801742, -254.15295019668653, -22.16606420765792, -738.3062366373038, -1227.4991114212896, -1042.4463133202432, -94.26635946467506, -184.72538008902987, -672.6885250062999, -143.95068687618536, -687.4496904136564, -108.92915720766926, -419.96732396823825, -1007.8844789787433, -1015.282832934612, -161.20573657862775, -1020.8665235695262, -462.6582159180805, -1409.61904989889, -176.8331942693357, -950.8991317637243, -1046.961150300261, -1035.7673097007691, -813.4334397069103, -1047.9046647350488, -294.0926806015162, -982.2104502199635, -991.304698683911, -872.8494786305893, -484.14207453678057, -988.3297391352904, -396.7692884692683, -775.6922578938992, -177.78518832205003, -26.59254288017397, -772.615735669144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5660711952706508, "mean_inference_ms": 1.6766600636161422, "mean_action_processing_ms": 0.2791914493573233, "mean_env_wait_ms": 3.408385260209198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013052940368652344, "StateBufferConnector_ms": 0.008869171142578125, "ViewRequirementAgentConnector_ms": 0.19182491302490234}, "num_episodes": 32, "episode_return_max": -22.16606420765792, "episode_return_min": -1421.461766980029, "episode_return_mean": -676.5202312659467, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 329.0633514799324, "num_env_steps_trained_throughput_per_sec": 329.0633514799324, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 11804.786, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11804.717, "sample_time_ms": 1114.163, "learn_time_ms": 10624.793, "learn_throughput": 376.478, "synch_weights_time_ms": 64.954}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "b33d0_00000", "date": "2024-08-06_14-41-34", "timestamp": 1722935494, "time_this_iter_s": 12.167454481124878, "time_total_s": 59.082751512527466, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2316c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 59.082751512527466, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 18.38888888888889, "ram_util_percent": 35.28333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.191884594038129, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.807914469142755, "policy_loss": -0.0210117611073656, "vf_loss": 8.823371987044812, "vf_explained_var": 0.298869359989961, "kl": 0.015524006435655716, "entropy": 1.4315379571169615, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -22.16606420765792, "episode_reward_min": -1442.6628088176951, "episode_reward_mean": -703.3895227919148, "episode_len_mean": 127.86, "episode_media": {}, "episodes_timesteps_total": 12786, "policy_reward_min": {"policy_0": -1442.6628088176951}, "policy_reward_max": {"policy_0": -22.16606420765792}, "policy_reward_mean": {"policy_0": -703.3895227919148}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-624.9829889459386, -140.39242979897995, -754.4348318504092, -1421.461766980029, -48.69840658335553, -1086.754942909471, -478.98686252550783, -882.4741826528809, -746.2136287015959, -1101.929909358966, -988.4834474064517, -594.2203258972054, -1015.7994741343855, -1324.8935521334263, -52.7911042347872, -718.706928119791, -1051.6956428812027, -529.4313267559429, -374.98153580409905, -1016.4303651318247, -553.7450019301328, -996.2158942914618, -990.8816083675648, -743.372766365976, -1041.272831870689, -817.6565318094661, -487.56263364838463, -1069.2332185762048, -717.2305531080378, -855.992163747417, -113.68307851868502, -42.04644815056116, -1077.9329670153902, -54.38125919134981, -807.2185318155015, -534.7027543801742, -254.15295019668653, -22.16606420765792, -738.3062366373038, -1227.4991114212896, -1042.4463133202432, -94.26635946467506, -184.72538008902987, -672.6885250062999, -143.95068687618536, -687.4496904136564, -108.92915720766926, -419.96732396823825, -1007.8844789787433, -1015.282832934612, -161.20573657862775, -1020.8665235695262, -462.6582159180805, -1409.61904989889, -176.8331942693357, -950.8991317637243, -1046.961150300261, -1035.7673097007691, -813.4334397069103, -1047.9046647350488, -294.0926806015162, -982.2104502199635, -991.304698683911, -872.8494786305893, -484.14207453678057, -988.3297391352904, -396.7692884692683, -775.6922578938992, -177.78518832205003, -26.59254288017397, -772.615735669144, -407.0473969912212, -1146.0019672114556, -979.1112760313919, -824.6559422849351, -579.5947506134808, -995.657325607954, -905.5095475846156, -782.1586250382543, -1104.819849872652, -1051.8486332189468, -115.2836257914472, -1004.3784782280419, -59.79544569145597, -1442.6628088176951, -91.06958507244968, -969.6569374033432, -53.6993802489354, -570.7407981189684, -932.4928932986654, -347.458539939907, -898.8411743562807, -634.1720579556644, -764.3665431499477, -1103.8220785113126, -1121.2811654879401, -844.5220711303075, -1265.9629568713424, -574.384896986634, -402.81596987693], "episode_lengths": [150, 66, 150, 150, 45, 150, 150, 150, 150, 150, 150, 150, 150, 150, 36, 131, 150, 130, 150, 150, 150, 150, 150, 133, 150, 150, 112, 150, 150, 150, 46, 52, 150, 42, 150, 117, 81, 33, 150, 150, 150, 51, 69, 150, 83, 150, 55, 128, 150, 150, 82, 150, 112, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 107, 150, 96, 44, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 58, 150, 62, 150, 55, 150, 150, 116, 150, 119, 133, 150, 150, 150, 150, 150, 104], "policy_policy_0_reward": [-624.9829889459386, -140.39242979897995, -754.4348318504092, -1421.461766980029, -48.69840658335553, -1086.754942909471, -478.98686252550783, -882.4741826528809, -746.2136287015959, -1101.929909358966, -988.4834474064517, -594.2203258972054, -1015.7994741343855, -1324.8935521334263, -52.7911042347872, -718.706928119791, -1051.6956428812027, -529.4313267559429, -374.98153580409905, -1016.4303651318247, -553.7450019301328, -996.2158942914618, -990.8816083675648, -743.372766365976, -1041.272831870689, -817.6565318094661, -487.56263364838463, -1069.2332185762048, -717.2305531080378, -855.992163747417, -113.68307851868502, -42.04644815056116, -1077.9329670153902, -54.38125919134981, -807.2185318155015, -534.7027543801742, -254.15295019668653, -22.16606420765792, -738.3062366373038, -1227.4991114212896, -1042.4463133202432, -94.26635946467506, -184.72538008902987, -672.6885250062999, -143.95068687618536, -687.4496904136564, -108.92915720766926, -419.96732396823825, -1007.8844789787433, -1015.282832934612, -161.20573657862775, -1020.8665235695262, -462.6582159180805, -1409.61904989889, -176.8331942693357, -950.8991317637243, -1046.961150300261, -1035.7673097007691, -813.4334397069103, -1047.9046647350488, -294.0926806015162, -982.2104502199635, -991.304698683911, -872.8494786305893, -484.14207453678057, -988.3297391352904, -396.7692884692683, -775.6922578938992, -177.78518832205003, -26.59254288017397, -772.615735669144, -407.0473969912212, -1146.0019672114556, -979.1112760313919, -824.6559422849351, -579.5947506134808, -995.657325607954, -905.5095475846156, -782.1586250382543, -1104.819849872652, -1051.8486332189468, -115.2836257914472, -1004.3784782280419, -59.79544569145597, -1442.6628088176951, -91.06958507244968, -969.6569374033432, -53.6993802489354, -570.7407981189684, -932.4928932986654, -347.458539939907, -898.8411743562807, -634.1720579556644, -764.3665431499477, -1103.8220785113126, -1121.2811654879401, -844.5220711303075, -1265.9629568713424, -574.384896986634, -402.81596987693]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5648576955278197, "mean_inference_ms": 1.6771507317258207, "mean_action_processing_ms": 0.2793921106351976, "mean_env_wait_ms": 3.415066150444979, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013172626495361328, "StateBufferConnector_ms": 0.008826971054077148, "ViewRequirementAgentConnector_ms": 0.19678711891174316}, "num_episodes": 29, "episode_return_max": -22.16606420765792, "episode_return_min": -1442.6628088176951, "episode_return_mean": -703.3895227919148, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.0167858362554, "num_env_steps_trained_throughput_per_sec": 323.0167858362554, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 11901.2, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11901.128, "sample_time_ms": 1145.597, "learn_time_ms": 10687.491, "learn_throughput": 374.269, "synch_weights_time_ms": 67.239}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "b33d0_00000", "date": "2024-08-06_14-41-46", "timestamp": 1722935506, "time_this_iter_s": 12.39491891860962, "time_total_s": 71.47767043113708, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c231630>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 71.47767043113708, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 18.81764705882353, "ram_util_percent": 35.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.002184207985798, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.362131416300933, "policy_loss": -0.01784576722129714, "vf_loss": 8.374653828144073, "vf_explained_var": 0.386659154544274, "kl": 0.014946595535669386, "entropy": 1.4026323863615593, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -10.208098841000833, "episode_reward_min": -1442.6628088176951, "episode_reward_mean": -695.5306313919473, "episode_len_mean": 128.45, "episode_media": {}, "episodes_timesteps_total": 12845, "policy_reward_min": {"policy_0": -1442.6628088176951}, "policy_reward_max": {"policy_0": -10.208098841000833}, "policy_reward_mean": {"policy_0": -695.5306313919473}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-738.3062366373038, -1227.4991114212896, -1042.4463133202432, -94.26635946467506, -184.72538008902987, -672.6885250062999, -143.95068687618536, -687.4496904136564, -108.92915720766926, -419.96732396823825, -1007.8844789787433, -1015.282832934612, -161.20573657862775, -1020.8665235695262, -462.6582159180805, -1409.61904989889, -176.8331942693357, -950.8991317637243, -1046.961150300261, -1035.7673097007691, -813.4334397069103, -1047.9046647350488, -294.0926806015162, -982.2104502199635, -991.304698683911, -872.8494786305893, -484.14207453678057, -988.3297391352904, -396.7692884692683, -775.6922578938992, -177.78518832205003, -26.59254288017397, -772.615735669144, -407.0473969912212, -1146.0019672114556, -979.1112760313919, -824.6559422849351, -579.5947506134808, -995.657325607954, -905.5095475846156, -782.1586250382543, -1104.819849872652, -1051.8486332189468, -115.2836257914472, -1004.3784782280419, -59.79544569145597, -1442.6628088176951, -91.06958507244968, -969.6569374033432, -53.6993802489354, -570.7407981189684, -932.4928932986654, -347.458539939907, -898.8411743562807, -634.1720579556644, -764.3665431499477, -1103.8220785113126, -1121.2811654879401, -844.5220711303075, -1265.9629568713424, -574.384896986634, -402.81596987693, -1168.9823735811356, -185.61070825439143, -804.7451420422285, -77.22284936083122, -1207.5080961548867, -180.24769386900482, -322.9597855112596, -200.40922207585172, -394.20245182692423, -942.04509753361, -103.08891565225687, -551.6579770831302, -721.9508871414638, -140.6034677172881, -397.10198241160913, -554.7766618809243, -1212.2724558260666, -882.8136450034783, -568.1963778992751, -755.8181521424154, -1231.1853663399543, -1076.6500381613973, -1269.1017181108396, -1185.3861214012616, -659.0266850525052, -935.2015362944071, -1300.5984828842243, -420.8180633293998, -546.0217669127888, -176.9604754365162, -390.06351297922333, -1192.242449205515, -1018.1860697785024, -601.6498142890993, -271.17213013444564, -10.208098841000833, -883.424344519574, -807.2111533621479], "episode_lengths": [150, 150, 150, 51, 69, 150, 83, 150, 55, 128, 150, 150, 82, 150, 112, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 107, 150, 96, 44, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 58, 150, 62, 150, 55, 150, 150, 116, 150, 119, 133, 150, 150, 150, 150, 150, 104, 150, 60, 150, 72, 150, 60, 90, 72, 140, 150, 106, 120, 150, 77, 126, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 125, 150, 105, 150, 150, 150, 132, 74, 32, 150, 150], "policy_policy_0_reward": [-738.3062366373038, -1227.4991114212896, -1042.4463133202432, -94.26635946467506, -184.72538008902987, -672.6885250062999, -143.95068687618536, -687.4496904136564, -108.92915720766926, -419.96732396823825, -1007.8844789787433, -1015.282832934612, -161.20573657862775, -1020.8665235695262, -462.6582159180805, -1409.61904989889, -176.8331942693357, -950.8991317637243, -1046.961150300261, -1035.7673097007691, -813.4334397069103, -1047.9046647350488, -294.0926806015162, -982.2104502199635, -991.304698683911, -872.8494786305893, -484.14207453678057, -988.3297391352904, -396.7692884692683, -775.6922578938992, -177.78518832205003, -26.59254288017397, -772.615735669144, -407.0473969912212, -1146.0019672114556, -979.1112760313919, -824.6559422849351, -579.5947506134808, -995.657325607954, -905.5095475846156, -782.1586250382543, -1104.819849872652, -1051.8486332189468, -115.2836257914472, -1004.3784782280419, -59.79544569145597, -1442.6628088176951, -91.06958507244968, -969.6569374033432, -53.6993802489354, -570.7407981189684, -932.4928932986654, -347.458539939907, -898.8411743562807, -634.1720579556644, -764.3665431499477, -1103.8220785113126, -1121.2811654879401, -844.5220711303075, -1265.9629568713424, -574.384896986634, -402.81596987693, -1168.9823735811356, -185.61070825439143, -804.7451420422285, -77.22284936083122, -1207.5080961548867, -180.24769386900482, -322.9597855112596, -200.40922207585172, -394.20245182692423, -942.04509753361, -103.08891565225687, -551.6579770831302, -721.9508871414638, -140.6034677172881, -397.10198241160913, -554.7766618809243, -1212.2724558260666, -882.8136450034783, -568.1963778992751, -755.8181521424154, -1231.1853663399543, -1076.6500381613973, -1269.1017181108396, -1185.3861214012616, -659.0266850525052, -935.2015362944071, -1300.5984828842243, -420.8180633293998, -546.0217669127888, -176.9604754365162, -390.06351297922333, -1192.242449205515, -1018.1860697785024, -601.6498142890993, -271.17213013444564, -10.208098841000833, -883.424344519574, -807.2111533621479]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5634583840802341, "mean_inference_ms": 1.6732221012611546, "mean_action_processing_ms": 0.27860067226178, "mean_env_wait_ms": 3.4139111196081204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012832880020141602, "StateBufferConnector_ms": 0.008431434631347656, "ViewRequirementAgentConnector_ms": 0.19530320167541504}, "num_episodes": 38, "episode_return_max": -10.208098841000833, "episode_return_min": -1442.6628088176951, "episode_return_mean": -695.5306313919473, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.8836679705865, "num_env_steps_trained_throughput_per_sec": 326.8836679705865, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 11949.14, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11949.068, "sample_time_ms": 1140.373, "learn_time_ms": 10742.453, "learn_throughput": 372.354, "synch_weights_time_ms": 65.452}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "b33d0_00000", "date": "2024-08-06_14-41-58", "timestamp": 1722935518, "time_this_iter_s": 12.251182079315186, "time_total_s": 83.72885251045227, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c231990>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 83.72885251045227, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 18.25, "ram_util_percent": 35.29999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.957320063064495, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.821189486483733, "policy_loss": -0.015801516417802, "vf_loss": 7.831784616907438, "vf_explained_var": 0.3873832418272893, "kl": 0.014711154901154572, "entropy": 1.4136295006920894, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -10.208098841000833, "episode_reward_min": -1442.6628088176951, "episode_reward_mean": -690.9598292304539, "episode_len_mean": 129.09, "episode_media": {}, "episodes_timesteps_total": 12909, "policy_reward_min": {"policy_0": -1442.6628088176951}, "policy_reward_max": {"policy_0": -10.208098841000833}, "policy_reward_mean": {"policy_0": -690.9598292304539}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-484.14207453678057, -988.3297391352904, -396.7692884692683, -775.6922578938992, -177.78518832205003, -26.59254288017397, -772.615735669144, -407.0473969912212, -1146.0019672114556, -979.1112760313919, -824.6559422849351, -579.5947506134808, -995.657325607954, -905.5095475846156, -782.1586250382543, -1104.819849872652, -1051.8486332189468, -115.2836257914472, -1004.3784782280419, -59.79544569145597, -1442.6628088176951, -91.06958507244968, -969.6569374033432, -53.6993802489354, -570.7407981189684, -932.4928932986654, -347.458539939907, -898.8411743562807, -634.1720579556644, -764.3665431499477, -1103.8220785113126, -1121.2811654879401, -844.5220711303075, -1265.9629568713424, -574.384896986634, -402.81596987693, -1168.9823735811356, -185.61070825439143, -804.7451420422285, -77.22284936083122, -1207.5080961548867, -180.24769386900482, -322.9597855112596, -200.40922207585172, -394.20245182692423, -942.04509753361, -103.08891565225687, -551.6579770831302, -721.9508871414638, -140.6034677172881, -397.10198241160913, -554.7766618809243, -1212.2724558260666, -882.8136450034783, -568.1963778992751, -755.8181521424154, -1231.1853663399543, -1076.6500381613973, -1269.1017181108396, -1185.3861214012616, -659.0266850525052, -935.2015362944071, -1300.5984828842243, -420.8180633293998, -546.0217669127888, -176.9604754365162, -390.06351297922333, -1192.242449205515, -1018.1860697785024, -601.6498142890993, -271.17213013444564, -10.208098841000833, -883.424344519574, -807.2111533621479, -1381.9106531682946, -210.6777854997025, -204.26629384298963, -1177.8654413092947, -1297.3523229496054, -1151.741377930988, -725.4473920665797, -393.2814733686035, -960.0005025334589, -343.50184727420344, -228.11558249994118, -38.90849801992378, -1013.8800460440256, -954.8742425102436, -110.68792319486735, -1033.515970288781, -1221.5509975403415, -467.5773520454279, -682.4030274621125, -799.777586651988, -317.4470432848327, -139.98455707199105, -1006.235192346196, -1176.659821671847, -718.3752827717789, -396.8833913977637], "episode_lengths": [101, 150, 107, 150, 96, 44, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 58, 150, 62, 150, 55, 150, 150, 116, 150, 119, 133, 150, 150, 150, 150, 150, 104, 150, 60, 150, 72, 150, 60, 90, 72, 140, 150, 106, 120, 150, 77, 126, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 125, 150, 105, 150, 150, 150, 132, 74, 32, 150, 150, 150, 99, 82, 150, 150, 150, 150, 150, 150, 121, 138, 50, 150, 150, 46, 150, 150, 107, 150, 150, 126, 91, 150, 150, 150, 150], "policy_policy_0_reward": [-484.14207453678057, -988.3297391352904, -396.7692884692683, -775.6922578938992, -177.78518832205003, -26.59254288017397, -772.615735669144, -407.0473969912212, -1146.0019672114556, -979.1112760313919, -824.6559422849351, -579.5947506134808, -995.657325607954, -905.5095475846156, -782.1586250382543, -1104.819849872652, -1051.8486332189468, -115.2836257914472, -1004.3784782280419, -59.79544569145597, -1442.6628088176951, -91.06958507244968, -969.6569374033432, -53.6993802489354, -570.7407981189684, -932.4928932986654, -347.458539939907, -898.8411743562807, -634.1720579556644, -764.3665431499477, -1103.8220785113126, -1121.2811654879401, -844.5220711303075, -1265.9629568713424, -574.384896986634, -402.81596987693, -1168.9823735811356, -185.61070825439143, -804.7451420422285, -77.22284936083122, -1207.5080961548867, -180.24769386900482, -322.9597855112596, -200.40922207585172, -394.20245182692423, -942.04509753361, -103.08891565225687, -551.6579770831302, -721.9508871414638, -140.6034677172881, -397.10198241160913, -554.7766618809243, -1212.2724558260666, -882.8136450034783, -568.1963778992751, -755.8181521424154, -1231.1853663399543, -1076.6500381613973, -1269.1017181108396, -1185.3861214012616, -659.0266850525052, -935.2015362944071, -1300.5984828842243, -420.8180633293998, -546.0217669127888, -176.9604754365162, -390.06351297922333, -1192.242449205515, -1018.1860697785024, -601.6498142890993, -271.17213013444564, -10.208098841000833, -883.424344519574, -807.2111533621479, -1381.9106531682946, -210.6777854997025, -204.26629384298963, -1177.8654413092947, -1297.3523229496054, -1151.741377930988, -725.4473920665797, -393.2814733686035, -960.0005025334589, -343.50184727420344, -228.11558249994118, -38.90849801992378, -1013.8800460440256, -954.8742425102436, -110.68792319486735, -1033.515970288781, -1221.5509975403415, -467.5773520454279, -682.4030274621125, -799.777586651988, -317.4470432848327, -139.98455707199105, -1006.235192346196, -1176.659821671847, -718.3752827717789, -396.8833913977637]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5623142446569256, "mean_inference_ms": 1.673450147753884, "mean_action_processing_ms": 0.27821563808553085, "mean_env_wait_ms": 3.4193336880986727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012920379638671875, "StateBufferConnector_ms": 0.008263349533081055, "ViewRequirementAgentConnector_ms": 0.19521522521972656}, "num_episodes": 26, "episode_return_max": -10.208098841000833, "episode_return_min": -1442.6628088176951, "episode_return_mean": -690.9598292304539, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 342.78804848293163, "num_env_steps_trained_throughput_per_sec": 342.78804848293163, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 11914.128, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11914.054, "sample_time_ms": 1135.826, "learn_time_ms": 10713.197, "learn_throughput": 373.371, "synch_weights_time_ms": 64.247}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "b33d0_00000", "date": "2024-08-06_14-42-10", "timestamp": 1722935530, "time_this_iter_s": 11.682257890701294, "time_total_s": 95.41111040115356, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c233c70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 95.41111040115356, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 19.3, "ram_util_percent": 35.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.706828383604686, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.934951748450597, "policy_loss": -0.02711403355836713, "vf_loss": 7.954561543961366, "vf_explained_var": 0.45159442542741696, "kl": 0.019962143294348315, "entropy": 1.4786971045037112, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -6.275741370749106, "episode_reward_min": -1430.8772707814915, "episode_reward_mean": -674.9950184875909, "episode_len_mean": 130.05, "episode_media": {}, "episodes_timesteps_total": 13005, "policy_reward_min": {"policy_0": -1430.8772707814915}, "policy_reward_max": {"policy_0": -6.275741370749106}, "policy_reward_mean": {"policy_0": -674.9950184875909}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1121.2811654879401, -844.5220711303075, -1265.9629568713424, -574.384896986634, -402.81596987693, -1168.9823735811356, -185.61070825439143, -804.7451420422285, -77.22284936083122, -1207.5080961548867, -180.24769386900482, -322.9597855112596, -200.40922207585172, -394.20245182692423, -942.04509753361, -103.08891565225687, -551.6579770831302, -721.9508871414638, -140.6034677172881, -397.10198241160913, -554.7766618809243, -1212.2724558260666, -882.8136450034783, -568.1963778992751, -755.8181521424154, -1231.1853663399543, -1076.6500381613973, -1269.1017181108396, -1185.3861214012616, -659.0266850525052, -935.2015362944071, -1300.5984828842243, -420.8180633293998, -546.0217669127888, -176.9604754365162, -390.06351297922333, -1192.242449205515, -1018.1860697785024, -601.6498142890993, -271.17213013444564, -10.208098841000833, -883.424344519574, -807.2111533621479, -1381.9106531682946, -210.6777854997025, -204.26629384298963, -1177.8654413092947, -1297.3523229496054, -1151.741377930988, -725.4473920665797, -393.2814733686035, -960.0005025334589, -343.50184727420344, -228.11558249994118, -38.90849801992378, -1013.8800460440256, -954.8742425102436, -110.68792319486735, -1033.515970288781, -1221.5509975403415, -467.5773520454279, -682.4030274621125, -799.777586651988, -317.4470432848327, -139.98455707199105, -1006.235192346196, -1176.659821671847, -718.3752827717789, -396.8833913977637, -1244.0975615125094, -862.2880452161295, -1255.5831238664084, -832.1296076095622, -273.0254522076496, -444.10542974616146, -466.74455037246963, -61.40692710078674, -520.1248049013609, -555.3139976224962, -415.37877746064953, -587.1059998385638, -1417.2032136386379, -818.1709692755744, -550.9054726107296, -1044.1793524578777, -476.98214813627436, -503.5570465441127, -439.9805081559517, -1430.8772707814915, -48.425542029585415, -738.4636234495968, -186.47297015089939, -725.7750293803746, -291.192893544159, -6.275741370749106, -11.018595799866192, -596.5417943411594, -1105.3793709917013, -1054.7972359422138, -826.788357603608], "episode_lengths": [150, 150, 150, 150, 104, 150, 60, 150, 72, 150, 60, 90, 72, 140, 150, 106, 120, 150, 77, 126, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 125, 150, 105, 150, 150, 150, 132, 74, 32, 150, 150, 150, 99, 82, 150, 150, 150, 150, 150, 150, 121, 138, 50, 150, 150, 46, 150, 150, 107, 150, 150, 126, 91, 150, 150, 150, 150, 150, 150, 150, 150, 125, 120, 133, 47, 150, 150, 150, 150, 150, 150, 136, 150, 150, 150, 139, 150, 52, 150, 88, 150, 150, 34, 35, 149, 150, 150, 150], "policy_policy_0_reward": [-1121.2811654879401, -844.5220711303075, -1265.9629568713424, -574.384896986634, -402.81596987693, -1168.9823735811356, -185.61070825439143, -804.7451420422285, -77.22284936083122, -1207.5080961548867, -180.24769386900482, -322.9597855112596, -200.40922207585172, -394.20245182692423, -942.04509753361, -103.08891565225687, -551.6579770831302, -721.9508871414638, -140.6034677172881, -397.10198241160913, -554.7766618809243, -1212.2724558260666, -882.8136450034783, -568.1963778992751, -755.8181521424154, -1231.1853663399543, -1076.6500381613973, -1269.1017181108396, -1185.3861214012616, -659.0266850525052, -935.2015362944071, -1300.5984828842243, -420.8180633293998, -546.0217669127888, -176.9604754365162, -390.06351297922333, -1192.242449205515, -1018.1860697785024, -601.6498142890993, -271.17213013444564, -10.208098841000833, -883.424344519574, -807.2111533621479, -1381.9106531682946, -210.6777854997025, -204.26629384298963, -1177.8654413092947, -1297.3523229496054, -1151.741377930988, -725.4473920665797, -393.2814733686035, -960.0005025334589, -343.50184727420344, -228.11558249994118, -38.90849801992378, -1013.8800460440256, -954.8742425102436, -110.68792319486735, -1033.515970288781, -1221.5509975403415, -467.5773520454279, -682.4030274621125, -799.777586651988, -317.4470432848327, -139.98455707199105, -1006.235192346196, -1176.659821671847, -718.3752827717789, -396.8833913977637, -1244.0975615125094, -862.2880452161295, -1255.5831238664084, -832.1296076095622, -273.0254522076496, -444.10542974616146, -466.74455037246963, -61.40692710078674, -520.1248049013609, -555.3139976224962, -415.37877746064953, -587.1059998385638, -1417.2032136386379, -818.1709692755744, -550.9054726107296, -1044.1793524578777, -476.98214813627436, -503.5570465441127, -439.9805081559517, -1430.8772707814915, -48.425542029585415, -738.4636234495968, -186.47297015089939, -725.7750293803746, -291.192893544159, -6.275741370749106, -11.018595799866192, -596.5417943411594, -1105.3793709917013, -1054.7972359422138, -826.788357603608]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5606406748873985, "mean_inference_ms": 1.6708814339110005, "mean_action_processing_ms": 0.2771296382080892, "mean_env_wait_ms": 3.416903277933552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013072013854980469, "StateBufferConnector_ms": 0.00831294059753418, "ViewRequirementAgentConnector_ms": 0.19123482704162598}, "num_episodes": 31, "episode_return_max": -6.275741370749106, "episode_return_min": -1430.8772707814915, "episode_return_mean": -674.9950184875909, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.1022813779046, "num_env_steps_trained_throughput_per_sec": 319.1022813779046, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 11983.134, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11983.061, "sample_time_ms": 1134.486, "learn_time_ms": 10782.34, "learn_throughput": 370.977, "synch_weights_time_ms": 65.453}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "b33d0_00000", "date": "2024-08-06_14-42-23", "timestamp": 1722935543, "time_this_iter_s": 12.54729676246643, "time_total_s": 107.95840716362, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2a8ee0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 107.95840716362, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 18.438888888888894, "ram_util_percent": 35.22777777777779}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.550619570662578, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.5612258593241375, "policy_loss": -0.020528144095442256, "vf_loss": 7.575209872424603, "vf_explained_var": 0.5309959653144082, "kl": 0.01768968389469593, "entropy": 1.4162258670975765, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -6.275741370749106, "episode_reward_min": -1453.460207598838, "episode_reward_mean": -668.2095136516456, "episode_len_mean": 129.82, "episode_media": {}, "episodes_timesteps_total": 12982, "policy_reward_min": {"policy_0": -1453.460207598838}, "policy_reward_max": {"policy_0": -6.275741370749106}, "policy_reward_mean": {"policy_0": -668.2095136516456}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-935.2015362944071, -1300.5984828842243, -420.8180633293998, -546.0217669127888, -176.9604754365162, -390.06351297922333, -1192.242449205515, -1018.1860697785024, -601.6498142890993, -271.17213013444564, -10.208098841000833, -883.424344519574, -807.2111533621479, -1381.9106531682946, -210.6777854997025, -204.26629384298963, -1177.8654413092947, -1297.3523229496054, -1151.741377930988, -725.4473920665797, -393.2814733686035, -960.0005025334589, -343.50184727420344, -228.11558249994118, -38.90849801992378, -1013.8800460440256, -954.8742425102436, -110.68792319486735, -1033.515970288781, -1221.5509975403415, -467.5773520454279, -682.4030274621125, -799.777586651988, -317.4470432848327, -139.98455707199105, -1006.235192346196, -1176.659821671847, -718.3752827717789, -396.8833913977637, -1244.0975615125094, -862.2880452161295, -1255.5831238664084, -832.1296076095622, -273.0254522076496, -444.10542974616146, -466.74455037246963, -61.40692710078674, -520.1248049013609, -555.3139976224962, -415.37877746064953, -587.1059998385638, -1417.2032136386379, -818.1709692755744, -550.9054726107296, -1044.1793524578777, -476.98214813627436, -503.5570465441127, -439.9805081559517, -1430.8772707814915, -48.425542029585415, -738.4636234495968, -186.47297015089939, -725.7750293803746, -291.192893544159, -6.275741370749106, -11.018595799866192, -596.5417943411594, -1105.3793709917013, -1054.7972359422138, -826.788357603608, -799.7811516443342, -26.4375837709196, -1309.04718845192, -1229.4800930785116, -1146.501880182583, -93.49197225804306, -427.1430746235002, -1136.0049023784845, -312.7502077131806, -637.222103300657, -1453.460207598838, -952.3385152063609, -424.1170545096443, -209.17405504680747, -561.5921050945312, -207.2745786878828, -1193.0497693099314, -620.205969936892, -363.13823878038335, -1265.9763969799803, -768.0436739107707, -987.1955480904314, -318.6137270447249, -688.6919446546336, -171.975779525115, -29.016196037539085, -434.24285751955534, -1117.9662839225582, -712.5013933261059, -727.5459962078002], "episode_lengths": [150, 150, 125, 150, 105, 150, 150, 150, 132, 74, 32, 150, 150, 150, 99, 82, 150, 150, 150, 150, 150, 150, 121, 138, 50, 150, 150, 46, 150, 150, 107, 150, 150, 126, 91, 150, 150, 150, 150, 150, 150, 150, 150, 125, 120, 133, 47, 150, 150, 150, 150, 150, 150, 136, 150, 150, 150, 139, 150, 52, 150, 88, 150, 150, 34, 35, 149, 150, 150, 150, 150, 43, 150, 150, 150, 65, 150, 150, 84, 150, 150, 150, 150, 123, 150, 85, 150, 150, 150, 150, 150, 150, 88, 120, 87, 38, 113, 150, 150, 150], "policy_policy_0_reward": [-935.2015362944071, -1300.5984828842243, -420.8180633293998, -546.0217669127888, -176.9604754365162, -390.06351297922333, -1192.242449205515, -1018.1860697785024, -601.6498142890993, -271.17213013444564, -10.208098841000833, -883.424344519574, -807.2111533621479, -1381.9106531682946, -210.6777854997025, -204.26629384298963, -1177.8654413092947, -1297.3523229496054, -1151.741377930988, -725.4473920665797, -393.2814733686035, -960.0005025334589, -343.50184727420344, -228.11558249994118, -38.90849801992378, -1013.8800460440256, -954.8742425102436, -110.68792319486735, -1033.515970288781, -1221.5509975403415, -467.5773520454279, -682.4030274621125, -799.777586651988, -317.4470432848327, -139.98455707199105, -1006.235192346196, -1176.659821671847, -718.3752827717789, -396.8833913977637, -1244.0975615125094, -862.2880452161295, -1255.5831238664084, -832.1296076095622, -273.0254522076496, -444.10542974616146, -466.74455037246963, -61.40692710078674, -520.1248049013609, -555.3139976224962, -415.37877746064953, -587.1059998385638, -1417.2032136386379, -818.1709692755744, -550.9054726107296, -1044.1793524578777, -476.98214813627436, -503.5570465441127, -439.9805081559517, -1430.8772707814915, -48.425542029585415, -738.4636234495968, -186.47297015089939, -725.7750293803746, -291.192893544159, -6.275741370749106, -11.018595799866192, -596.5417943411594, -1105.3793709917013, -1054.7972359422138, -826.788357603608, -799.7811516443342, -26.4375837709196, -1309.04718845192, -1229.4800930785116, -1146.501880182583, -93.49197225804306, -427.1430746235002, -1136.0049023784845, -312.7502077131806, -637.222103300657, -1453.460207598838, -952.3385152063609, -424.1170545096443, -209.17405504680747, -561.5921050945312, -207.2745786878828, -1193.0497693099314, -620.205969936892, -363.13823878038335, -1265.9763969799803, -768.0436739107707, -987.1955480904314, -318.6137270447249, -688.6919446546336, -171.975779525115, -29.016196037539085, -434.24285751955534, -1117.9662839225582, -712.5013933261059, -727.5459962078002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5599698093940512, "mean_inference_ms": 1.6719887628472276, "mean_action_processing_ms": 0.2770989419134154, "mean_env_wait_ms": 3.425609341905881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012998819351196289, "StateBufferConnector_ms": 0.008160591125488281, "ViewRequirementAgentConnector_ms": 0.20646452903747559}, "num_episodes": 30, "episode_return_max": -6.275741370749106, "episode_return_min": -1453.460207598838, "episode_return_mean": -668.2095136516456, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.0935425520589, "num_env_steps_trained_throughput_per_sec": 312.0935425520589, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12066.489, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12066.417, "sample_time_ms": 1143.312, "learn_time_ms": 10856.562, "learn_throughput": 368.441, "synch_weights_time_ms": 65.764}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "b33d0_00000", "date": "2024-08-06_14-42-36", "timestamp": 1722935556, "time_this_iter_s": 12.828449964523315, "time_total_s": 120.78685712814331, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c232f80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 120.78685712814331, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 18.252631578947373, "ram_util_percent": 35.20000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.760568325221538, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.177832909921805, "policy_loss": -0.02056057732164239, "vf_loss": 7.191775023937225, "vf_explained_var": 0.6029055325314403, "kl": 0.017529614309099398, "entropy": 1.2698760819931825, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -6.275741370749106, "episode_reward_min": -1453.460207598838, "episode_reward_mean": -640.6907859377558, "episode_len_mean": 127.64, "episode_media": {}, "episodes_timesteps_total": 12764, "policy_reward_min": {"policy_0": -1453.460207598838}, "policy_reward_max": {"policy_0": -6.275741370749106}, "policy_reward_mean": {"policy_0": -640.6907859377558}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139.98455707199105, -1006.235192346196, -1176.659821671847, -718.3752827717789, -396.8833913977637, -1244.0975615125094, -862.2880452161295, -1255.5831238664084, -832.1296076095622, -273.0254522076496, -444.10542974616146, -466.74455037246963, -61.40692710078674, -520.1248049013609, -555.3139976224962, -415.37877746064953, -587.1059998385638, -1417.2032136386379, -818.1709692755744, -550.9054726107296, -1044.1793524578777, -476.98214813627436, -503.5570465441127, -439.9805081559517, -1430.8772707814915, -48.425542029585415, -738.4636234495968, -186.47297015089939, -725.7750293803746, -291.192893544159, -6.275741370749106, -11.018595799866192, -596.5417943411594, -1105.3793709917013, -1054.7972359422138, -826.788357603608, -799.7811516443342, -26.4375837709196, -1309.04718845192, -1229.4800930785116, -1146.501880182583, -93.49197225804306, -427.1430746235002, -1136.0049023784845, -312.7502077131806, -637.222103300657, -1453.460207598838, -952.3385152063609, -424.1170545096443, -209.17405504680747, -561.5921050945312, -207.2745786878828, -1193.0497693099314, -620.205969936892, -363.13823878038335, -1265.9763969799803, -768.0436739107707, -987.1955480904314, -318.6137270447249, -688.6919446546336, -171.975779525115, -29.016196037539085, -434.24285751955534, -1117.9662839225582, -712.5013933261059, -727.5459962078002, -919.2132354653558, -786.6629741007548, -1043.311885924491, -793.9518969860329, -554.2881008441519, -1129.02363528576, -291.537256546728, -619.7209142200377, -260.74941375082375, -126.11602517102318, -1225.5863405837804, -533.9136018454763, -417.46156402968694, -1055.1443238176228, -841.3884707415701, -538.3953450701503, -566.897282780957, -1281.107257117556, -49.04232413994906, -45.69868814033862, -55.64596215567978, -354.38902837568736, -91.38345662459577, -557.8336372209004, -1447.6189039676576, -327.65497699432393, -313.72294794201554, -1041.0624238628025, -77.55903000383464, -504.25584717128004, -813.3365887655145, -660.5640803305591, -123.69468952196364, -1068.736376565006], "episode_lengths": [91, 150, 150, 150, 150, 150, 150, 150, 150, 125, 120, 133, 47, 150, 150, 150, 150, 150, 150, 136, 150, 150, 150, 139, 150, 52, 150, 88, 150, 150, 34, 35, 149, 150, 150, 150, 150, 43, 150, 150, 150, 65, 150, 150, 84, 150, 150, 150, 150, 123, 150, 85, 150, 150, 150, 150, 150, 150, 88, 120, 87, 38, 113, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 136, 91, 65, 150, 150, 120, 150, 150, 150, 118, 150, 55, 51, 60, 150, 49, 150, 150, 117, 103, 150, 60, 150, 150, 150, 65, 150], "policy_policy_0_reward": [-139.98455707199105, -1006.235192346196, -1176.659821671847, -718.3752827717789, -396.8833913977637, -1244.0975615125094, -862.2880452161295, -1255.5831238664084, -832.1296076095622, -273.0254522076496, -444.10542974616146, -466.74455037246963, -61.40692710078674, -520.1248049013609, -555.3139976224962, -415.37877746064953, -587.1059998385638, -1417.2032136386379, -818.1709692755744, -550.9054726107296, -1044.1793524578777, -476.98214813627436, -503.5570465441127, -439.9805081559517, -1430.8772707814915, -48.425542029585415, -738.4636234495968, -186.47297015089939, -725.7750293803746, -291.192893544159, -6.275741370749106, -11.018595799866192, -596.5417943411594, -1105.3793709917013, -1054.7972359422138, -826.788357603608, -799.7811516443342, -26.4375837709196, -1309.04718845192, -1229.4800930785116, -1146.501880182583, -93.49197225804306, -427.1430746235002, -1136.0049023784845, -312.7502077131806, -637.222103300657, -1453.460207598838, -952.3385152063609, -424.1170545096443, -209.17405504680747, -561.5921050945312, -207.2745786878828, -1193.0497693099314, -620.205969936892, -363.13823878038335, -1265.9763969799803, -768.0436739107707, -987.1955480904314, -318.6137270447249, -688.6919446546336, -171.975779525115, -29.016196037539085, -434.24285751955534, -1117.9662839225582, -712.5013933261059, -727.5459962078002, -919.2132354653558, -786.6629741007548, -1043.311885924491, -793.9518969860329, -554.2881008441519, -1129.02363528576, -291.537256546728, -619.7209142200377, -260.74941375082375, -126.11602517102318, -1225.5863405837804, -533.9136018454763, -417.46156402968694, -1055.1443238176228, -841.3884707415701, -538.3953450701503, -566.897282780957, -1281.107257117556, -49.04232413994906, -45.69868814033862, -55.64596215567978, -354.38902837568736, -91.38345662459577, -557.8336372209004, -1447.6189039676576, -327.65497699432393, -313.72294794201554, -1041.0624238628025, -77.55903000383464, -504.25584717128004, -813.3365887655145, -660.5640803305591, -123.69468952196364, -1068.736376565006]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.559389086623912, "mean_inference_ms": 1.6713719386758927, "mean_action_processing_ms": 0.27678671531512267, "mean_env_wait_ms": 3.427041319547687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012845516204833984, "StateBufferConnector_ms": 0.008148193359375, "ViewRequirementAgentConnector_ms": 0.2076272964477539}, "num_episodes": 34, "episode_return_max": -6.275741370749106, "episode_return_min": -1453.460207598838, "episode_return_mean": -640.6907859377558, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.1900621857553, "num_env_steps_trained_throughput_per_sec": 318.1900621857553, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12131.289, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12131.216, "sample_time_ms": 1141.188, "learn_time_ms": 10924.153, "learn_throughput": 366.161, "synch_weights_time_ms": 65.111}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "b33d0_00000", "date": "2024-08-06_14-42-48", "timestamp": 1722935568, "time_this_iter_s": 12.583306074142456, "time_total_s": 133.37016320228577, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c232ef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 133.37016320228577, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 18.28888888888889, "ram_util_percent": 35.20000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.24373498459657, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.895679979026317, "policy_loss": -0.01886637646627302, "vf_loss": 6.90792065958182, "vf_explained_var": 0.7031414315725366, "kl": 0.017587185303091262, "entropy": 1.288536057372888, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -26.4375837709196, "episode_reward_min": -1453.460207598838, "episode_reward_mean": -645.2385057866683, "episode_len_mean": 127.04, "episode_media": {}, "episodes_timesteps_total": 12704, "policy_reward_min": {"policy_0": -1453.460207598838}, "policy_reward_max": {"policy_0": -26.4375837709196}, "policy_reward_mean": {"policy_0": -645.2385057866683}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1105.3793709917013, -1054.7972359422138, -826.788357603608, -799.7811516443342, -26.4375837709196, -1309.04718845192, -1229.4800930785116, -1146.501880182583, -93.49197225804306, -427.1430746235002, -1136.0049023784845, -312.7502077131806, -637.222103300657, -1453.460207598838, -952.3385152063609, -424.1170545096443, -209.17405504680747, -561.5921050945312, -207.2745786878828, -1193.0497693099314, -620.205969936892, -363.13823878038335, -1265.9763969799803, -768.0436739107707, -987.1955480904314, -318.6137270447249, -688.6919446546336, -171.975779525115, -29.016196037539085, -434.24285751955534, -1117.9662839225582, -712.5013933261059, -727.5459962078002, -919.2132354653558, -786.6629741007548, -1043.311885924491, -793.9518969860329, -554.2881008441519, -1129.02363528576, -291.537256546728, -619.7209142200377, -260.74941375082375, -126.11602517102318, -1225.5863405837804, -533.9136018454763, -417.46156402968694, -1055.1443238176228, -841.3884707415701, -538.3953450701503, -566.897282780957, -1281.107257117556, -49.04232413994906, -45.69868814033862, -55.64596215567978, -354.38902837568736, -91.38345662459577, -557.8336372209004, -1447.6189039676576, -327.65497699432393, -313.72294794201554, -1041.0624238628025, -77.55903000383464, -504.25584717128004, -813.3365887655145, -660.5640803305591, -123.69468952196364, -1068.736376565006, -666.1302507569281, -607.2908816877256, -683.5970327410782, -120.34392365220276, -976.5511236128235, -998.1634193165979, -656.1221893421, -595.0677077710608, -645.7058891680817, -50.8458015880541, -1151.9125632650107, -785.7579702242804, -58.7090991646913, -1074.6349572195104, -1156.0963865317988, -728.1585768164292, -357.4893159916986, -410.35664961643505, -1051.2054843428828, -953.252717650897, -644.5526370888283, -228.98322451844984, -1100.938184202785, -575.73440727628, -997.5297654052108, -353.48655031860653, -84.09111644706405, -54.72578380151653, -351.3463946626712, -459.8333264578422, -1009.3889078788361, -749.9646227490199, -358.26981800522674], "episode_lengths": [150, 150, 150, 150, 43, 150, 150, 150, 65, 150, 150, 84, 150, 150, 150, 150, 123, 150, 85, 150, 150, 150, 150, 150, 150, 88, 120, 87, 38, 113, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 136, 91, 65, 150, 150, 120, 150, 150, 150, 118, 150, 55, 51, 60, 150, 49, 150, 150, 117, 103, 150, 60, 150, 150, 150, 65, 150, 150, 150, 150, 61, 150, 150, 126, 150, 150, 57, 150, 150, 57, 150, 150, 150, 111, 106, 150, 150, 150, 95, 150, 150, 150, 133, 64, 57, 150, 103, 150, 150, 119], "policy_policy_0_reward": [-1105.3793709917013, -1054.7972359422138, -826.788357603608, -799.7811516443342, -26.4375837709196, -1309.04718845192, -1229.4800930785116, -1146.501880182583, -93.49197225804306, -427.1430746235002, -1136.0049023784845, -312.7502077131806, -637.222103300657, -1453.460207598838, -952.3385152063609, -424.1170545096443, -209.17405504680747, -561.5921050945312, -207.2745786878828, -1193.0497693099314, -620.205969936892, -363.13823878038335, -1265.9763969799803, -768.0436739107707, -987.1955480904314, -318.6137270447249, -688.6919446546336, -171.975779525115, -29.016196037539085, -434.24285751955534, -1117.9662839225582, -712.5013933261059, -727.5459962078002, -919.2132354653558, -786.6629741007548, -1043.311885924491, -793.9518969860329, -554.2881008441519, -1129.02363528576, -291.537256546728, -619.7209142200377, -260.74941375082375, -126.11602517102318, -1225.5863405837804, -533.9136018454763, -417.46156402968694, -1055.1443238176228, -841.3884707415701, -538.3953450701503, -566.897282780957, -1281.107257117556, -49.04232413994906, -45.69868814033862, -55.64596215567978, -354.38902837568736, -91.38345662459577, -557.8336372209004, -1447.6189039676576, -327.65497699432393, -313.72294794201554, -1041.0624238628025, -77.55903000383464, -504.25584717128004, -813.3365887655145, -660.5640803305591, -123.69468952196364, -1068.736376565006, -666.1302507569281, -607.2908816877256, -683.5970327410782, -120.34392365220276, -976.5511236128235, -998.1634193165979, -656.1221893421, -595.0677077710608, -645.7058891680817, -50.8458015880541, -1151.9125632650107, -785.7579702242804, -58.7090991646913, -1074.6349572195104, -1156.0963865317988, -728.1585768164292, -357.4893159916986, -410.35664961643505, -1051.2054843428828, -953.252717650897, -644.5526370888283, -228.98322451844984, -1100.938184202785, -575.73440727628, -997.5297654052108, -353.48655031860653, -84.09111644706405, -54.72578380151653, -351.3463946626712, -459.8333264578422, -1009.3889078788361, -749.9646227490199, -358.26981800522674]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5591080536620477, "mean_inference_ms": 1.6719487309240955, "mean_action_processing_ms": 0.2766526447157484, "mean_env_wait_ms": 3.4285838846616135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012540102005004883, "StateBufferConnector_ms": 0.008055448532104492, "ViewRequirementAgentConnector_ms": 0.2075812816619873}, "num_episodes": 33, "episode_return_max": -26.4375837709196, "episode_return_min": -1453.460207598838, "episode_return_mean": -645.2385057866683, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 336.9085503164544, "num_env_steps_trained_throughput_per_sec": 336.9085503164544, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12114.355, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12114.281, "sample_time_ms": 1144.779, "learn_time_ms": 10904.257, "learn_throughput": 366.829, "synch_weights_time_ms": 64.469}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "b33d0_00000", "date": "2024-08-06_14-43-00", "timestamp": 1722935580, "time_this_iter_s": 11.884629487991333, "time_total_s": 145.2547926902771, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c230b80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 145.2547926902771, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 19.150000000000002, "ram_util_percent": 35.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.145372209449608, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.8970523143808045, "policy_loss": -0.019672335365127462, "vf_loss": 6.910283852616946, "vf_explained_var": 0.7234139995028576, "kl": 0.017714709712890922, "entropy": 1.5308488680670658, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -45.69868814033862, "episode_reward_min": -1447.6189039676576, "episode_reward_mean": -632.770846357673, "episode_len_mean": 127.72, "episode_media": {}, "episodes_timesteps_total": 12772, "policy_reward_min": {"policy_0": -1447.6189039676576}, "policy_reward_max": {"policy_0": -45.69868814033862}, "policy_reward_mean": {"policy_0": -632.770846357673}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1117.9662839225582, -712.5013933261059, -727.5459962078002, -919.2132354653558, -786.6629741007548, -1043.311885924491, -793.9518969860329, -554.2881008441519, -1129.02363528576, -291.537256546728, -619.7209142200377, -260.74941375082375, -126.11602517102318, -1225.5863405837804, -533.9136018454763, -417.46156402968694, -1055.1443238176228, -841.3884707415701, -538.3953450701503, -566.897282780957, -1281.107257117556, -49.04232413994906, -45.69868814033862, -55.64596215567978, -354.38902837568736, -91.38345662459577, -557.8336372209004, -1447.6189039676576, -327.65497699432393, -313.72294794201554, -1041.0624238628025, -77.55903000383464, -504.25584717128004, -813.3365887655145, -660.5640803305591, -123.69468952196364, -1068.736376565006, -666.1302507569281, -607.2908816877256, -683.5970327410782, -120.34392365220276, -976.5511236128235, -998.1634193165979, -656.1221893421, -595.0677077710608, -645.7058891680817, -50.8458015880541, -1151.9125632650107, -785.7579702242804, -58.7090991646913, -1074.6349572195104, -1156.0963865317988, -728.1585768164292, -357.4893159916986, -410.35664961643505, -1051.2054843428828, -953.252717650897, -644.5526370888283, -228.98322451844984, -1100.938184202785, -575.73440727628, -997.5297654052108, -353.48655031860653, -84.09111644706405, -54.72578380151653, -351.3463946626712, -459.8333264578422, -1009.3889078788361, -749.9646227490199, -358.26981800522674, -1335.3595026298387, -330.2691556832521, -1297.9263509787452, -1104.1597270396373, -431.4538433183868, -496.5469919920979, -832.0853789054697, -126.47934158492835, -1174.3661117738084, -270.19757942338174, -335.4200527086367, -1150.7685162225466, -956.3221956143226, -84.79934515290414, -584.8075536968286, -127.3646133002583, -612.1658926198305, -1089.7695794411225, -536.1515274853267, -115.28716984418138, -864.1971013851255, -572.5810511818321, -973.996071113173, -637.8866729412778, -500.63064422505903, -1101.9050919449137, -470.9775086452896, -980.7149423489038, -191.35094431927158, -220.22533945379288], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 136, 91, 65, 150, 150, 120, 150, 150, 150, 118, 150, 55, 51, 60, 150, 49, 150, 150, 117, 103, 150, 60, 150, 150, 150, 65, 150, 150, 150, 150, 61, 150, 150, 126, 150, 150, 57, 150, 150, 57, 150, 150, 150, 111, 106, 150, 150, 150, 95, 150, 150, 150, 133, 64, 57, 150, 103, 150, 150, 119, 150, 112, 150, 150, 150, 150, 150, 67, 150, 109, 150, 150, 150, 56, 145, 75, 150, 150, 150, 78, 150, 113, 150, 150, 130, 150, 150, 150, 93, 86], "policy_policy_0_reward": [-1117.9662839225582, -712.5013933261059, -727.5459962078002, -919.2132354653558, -786.6629741007548, -1043.311885924491, -793.9518969860329, -554.2881008441519, -1129.02363528576, -291.537256546728, -619.7209142200377, -260.74941375082375, -126.11602517102318, -1225.5863405837804, -533.9136018454763, -417.46156402968694, -1055.1443238176228, -841.3884707415701, -538.3953450701503, -566.897282780957, -1281.107257117556, -49.04232413994906, -45.69868814033862, -55.64596215567978, -354.38902837568736, -91.38345662459577, -557.8336372209004, -1447.6189039676576, -327.65497699432393, -313.72294794201554, -1041.0624238628025, -77.55903000383464, -504.25584717128004, -813.3365887655145, -660.5640803305591, -123.69468952196364, -1068.736376565006, -666.1302507569281, -607.2908816877256, -683.5970327410782, -120.34392365220276, -976.5511236128235, -998.1634193165979, -656.1221893421, -595.0677077710608, -645.7058891680817, -50.8458015880541, -1151.9125632650107, -785.7579702242804, -58.7090991646913, -1074.6349572195104, -1156.0963865317988, -728.1585768164292, -357.4893159916986, -410.35664961643505, -1051.2054843428828, -953.252717650897, -644.5526370888283, -228.98322451844984, -1100.938184202785, -575.73440727628, -997.5297654052108, -353.48655031860653, -84.09111644706405, -54.72578380151653, -351.3463946626712, -459.8333264578422, -1009.3889078788361, -749.9646227490199, -358.26981800522674, -1335.3595026298387, -330.2691556832521, -1297.9263509787452, -1104.1597270396373, -431.4538433183868, -496.5469919920979, -832.0853789054697, -126.47934158492835, -1174.3661117738084, -270.19757942338174, -335.4200527086367, -1150.7685162225466, -956.3221956143226, -84.79934515290414, -584.8075536968286, -127.3646133002583, -612.1658926198305, -1089.7695794411225, -536.1515274853267, -115.28716984418138, -864.1971013851255, -572.5810511818321, -973.996071113173, -637.8866729412778, -500.63064422505903, -1101.9050919449137, -470.9775086452896, -980.7149423489038, -191.35094431927158, -220.22533945379288]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5585563823115902, "mean_inference_ms": 1.6712568469620834, "mean_action_processing_ms": 0.2765393602081492, "mean_env_wait_ms": 3.4314008810910837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012195587158203125, "StateBufferConnector_ms": 0.00794363021850586, "ViewRequirementAgentConnector_ms": 0.2002270221710205}, "num_episodes": 30, "episode_return_max": -45.69868814033862, "episode_return_min": -1447.6189039676576, "episode_return_mean": -632.770846357673, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.1522188176577, "num_env_steps_trained_throughput_per_sec": 317.1522188176577, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12256.506, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12256.431, "sample_time_ms": 1140.646, "learn_time_ms": 11050.066, "learn_throughput": 361.989, "synch_weights_time_ms": 64.942}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "b33d0_00000", "date": "2024-08-06_14-43-13", "timestamp": 1722935593, "time_this_iter_s": 12.625492334365845, "time_total_s": 157.88028502464294, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78558ff40820>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 157.88028502464294, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 18.36111111111111, "ram_util_percent": 35.21111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 46.76716272135575, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.633154474447171, "policy_loss": -0.010357520806913574, "vf_loss": 5.63794972896576, "vf_explained_var": 0.7474852638940016, "kl": 0.015094186535983092, "entropy": 1.2301164293040832, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -12.786926480081735, "episode_reward_min": -1436.8810191666214, "episode_reward_mean": -633.9343755730345, "episode_len_mean": 129.74, "episode_media": {}, "episodes_timesteps_total": 12974, "policy_reward_min": {"policy_0": -1436.8810191666214}, "policy_reward_max": {"policy_0": -12.786926480081735}, "policy_reward_mean": {"policy_0": -633.9343755730345}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-313.72294794201554, -1041.0624238628025, -77.55903000383464, -504.25584717128004, -813.3365887655145, -660.5640803305591, -123.69468952196364, -1068.736376565006, -666.1302507569281, -607.2908816877256, -683.5970327410782, -120.34392365220276, -976.5511236128235, -998.1634193165979, -656.1221893421, -595.0677077710608, -645.7058891680817, -50.8458015880541, -1151.9125632650107, -785.7579702242804, -58.7090991646913, -1074.6349572195104, -1156.0963865317988, -728.1585768164292, -357.4893159916986, -410.35664961643505, -1051.2054843428828, -953.252717650897, -644.5526370888283, -228.98322451844984, -1100.938184202785, -575.73440727628, -997.5297654052108, -353.48655031860653, -84.09111644706405, -54.72578380151653, -351.3463946626712, -459.8333264578422, -1009.3889078788361, -749.9646227490199, -358.26981800522674, -1335.3595026298387, -330.2691556832521, -1297.9263509787452, -1104.1597270396373, -431.4538433183868, -496.5469919920979, -832.0853789054697, -126.47934158492835, -1174.3661117738084, -270.19757942338174, -335.4200527086367, -1150.7685162225466, -956.3221956143226, -84.79934515290414, -584.8075536968286, -127.3646133002583, -612.1658926198305, -1089.7695794411225, -536.1515274853267, -115.28716984418138, -864.1971013851255, -572.5810511818321, -973.996071113173, -637.8866729412778, -500.63064422505903, -1101.9050919449137, -470.9775086452896, -980.7149423489038, -191.35094431927158, -220.22533945379288, -523.0467781873513, -628.0053586772434, -126.4965780618337, -989.9345239950014, -987.3123323559317, -806.6683688819274, -36.13190026267125, -636.3129692009896, -618.6448135853485, -642.2954800833487, -556.4432266074567, -555.9974341133617, -492.66864786044954, -693.2283466496807, -428.61161030552466, -12.786926480081735, -935.8750892213669, -876.0034158331703, -77.38097409937647, -1187.993081067118, -729.7146897157842, -242.04776826036723, -611.8972884978433, -1436.8810191666214, -570.3446593615058, -1154.262058566921, -1141.9949881810303, -494.623407114456, -394.49936249992413], "episode_lengths": [103, 150, 60, 150, 150, 150, 65, 150, 150, 150, 150, 61, 150, 150, 126, 150, 150, 57, 150, 150, 57, 150, 150, 150, 111, 106, 150, 150, 150, 95, 150, 150, 150, 133, 64, 57, 150, 103, 150, 150, 119, 150, 112, 150, 150, 150, 150, 150, 67, 150, 109, 150, 150, 150, 56, 145, 75, 150, 150, 150, 78, 150, 113, 150, 150, 130, 150, 150, 150, 93, 86, 150, 150, 59, 150, 150, 136, 43, 150, 150, 150, 114, 150, 150, 150, 150, 36, 150, 150, 64, 150, 150, 91, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-313.72294794201554, -1041.0624238628025, -77.55903000383464, -504.25584717128004, -813.3365887655145, -660.5640803305591, -123.69468952196364, -1068.736376565006, -666.1302507569281, -607.2908816877256, -683.5970327410782, -120.34392365220276, -976.5511236128235, -998.1634193165979, -656.1221893421, -595.0677077710608, -645.7058891680817, -50.8458015880541, -1151.9125632650107, -785.7579702242804, -58.7090991646913, -1074.6349572195104, -1156.0963865317988, -728.1585768164292, -357.4893159916986, -410.35664961643505, -1051.2054843428828, -953.252717650897, -644.5526370888283, -228.98322451844984, -1100.938184202785, -575.73440727628, -997.5297654052108, -353.48655031860653, -84.09111644706405, -54.72578380151653, -351.3463946626712, -459.8333264578422, -1009.3889078788361, -749.9646227490199, -358.26981800522674, -1335.3595026298387, -330.2691556832521, -1297.9263509787452, -1104.1597270396373, -431.4538433183868, -496.5469919920979, -832.0853789054697, -126.47934158492835, -1174.3661117738084, -270.19757942338174, -335.4200527086367, -1150.7685162225466, -956.3221956143226, -84.79934515290414, -584.8075536968286, -127.3646133002583, -612.1658926198305, -1089.7695794411225, -536.1515274853267, -115.28716984418138, -864.1971013851255, -572.5810511818321, -973.996071113173, -637.8866729412778, -500.63064422505903, -1101.9050919449137, -470.9775086452896, -980.7149423489038, -191.35094431927158, -220.22533945379288, -523.0467781873513, -628.0053586772434, -126.4965780618337, -989.9345239950014, -987.3123323559317, -806.6683688819274, -36.13190026267125, -636.3129692009896, -618.6448135853485, -642.2954800833487, -556.4432266074567, -555.9974341133617, -492.66864786044954, -693.2283466496807, -428.61161030552466, -12.786926480081735, -935.8750892213669, -876.0034158331703, -77.38097409937647, -1187.993081067118, -729.7146897157842, -242.04776826036723, -611.8972884978433, -1436.8810191666214, -570.3446593615058, -1154.262058566921, -1141.9949881810303, -494.623407114456, -394.49936249992413]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5581515831993236, "mean_inference_ms": 1.6715384800470594, "mean_action_processing_ms": 0.2764677581810435, "mean_env_wait_ms": 3.4315043996941568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012472391128540039, "StateBufferConnector_ms": 0.007988452911376953, "ViewRequirementAgentConnector_ms": 0.1948249340057373}, "num_episodes": 29, "episode_return_max": -12.786926480081735, "episode_return_min": -1436.8810191666214, "episode_return_mean": -633.9343755730345, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 365.2900415012655, "num_env_steps_trained_throughput_per_sec": 365.2900415012655, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12180.295, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12180.22, "sample_time_ms": 1155.209, "learn_time_ms": 10958.435, "learn_throughput": 365.016, "synch_weights_time_ms": 65.803}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "b33d0_00000", "date": "2024-08-06_14-43-24", "timestamp": 1722935604, "time_this_iter_s": 10.959389209747314, "time_total_s": 168.83967423439026, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2a95a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 168.83967423439026, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 19.1875, "ram_util_percent": 35.206250000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 58.58364374736945, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.485781495521466, "policy_loss": -0.014148610353974316, "vf_loss": 5.494427092621724, "vf_explained_var": 0.7808878796175123, "kl": 0.014771742973031616, "entropy": 1.1442538448298971, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -12.786926480081735, "episode_reward_min": -1436.8810191666214, "episode_reward_mean": -603.2216231478135, "episode_len_mean": 125.98, "episode_media": {}, "episodes_timesteps_total": 12598, "policy_reward_min": {"policy_0": -1436.8810191666214}, "policy_reward_max": {"policy_0": -12.786926480081735}, "policy_reward_mean": {"policy_0": -603.2216231478135}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-84.09111644706405, -54.72578380151653, -351.3463946626712, -459.8333264578422, -1009.3889078788361, -749.9646227490199, -358.26981800522674, -1335.3595026298387, -330.2691556832521, -1297.9263509787452, -1104.1597270396373, -431.4538433183868, -496.5469919920979, -832.0853789054697, -126.47934158492835, -1174.3661117738084, -270.19757942338174, -335.4200527086367, -1150.7685162225466, -956.3221956143226, -84.79934515290414, -584.8075536968286, -127.3646133002583, -612.1658926198305, -1089.7695794411225, -536.1515274853267, -115.28716984418138, -864.1971013851255, -572.5810511818321, -973.996071113173, -637.8866729412778, -500.63064422505903, -1101.9050919449137, -470.9775086452896, -980.7149423489038, -191.35094431927158, -220.22533945379288, -523.0467781873513, -628.0053586772434, -126.4965780618337, -989.9345239950014, -987.3123323559317, -806.6683688819274, -36.13190026267125, -636.3129692009896, -618.6448135853485, -642.2954800833487, -556.4432266074567, -555.9974341133617, -492.66864786044954, -693.2283466496807, -428.61161030552466, -12.786926480081735, -935.8750892213669, -876.0034158331703, -77.38097409937647, -1187.993081067118, -729.7146897157842, -242.04776826036723, -611.8972884978433, -1436.8810191666214, -570.3446593615058, -1154.262058566921, -1141.9949881810303, -494.623407114456, -394.49936249992413, -146.1349128179454, -605.036841806154, -651.953751472452, -924.8995155614869, -703.8489320596952, -680.9589555267846, -602.8031490149062, -212.42050089151448, -62.11781270747076, -492.49958749005367, -524.9311096440621, -199.2095496222321, -391.17534930721104, -28.99102816468002, -231.34394129068593, -503.31520574464116, -90.0776643917864, -59.80330590485846, -351.0866643320855, -729.6821974527635, -1086.4039815297126, -976.5121833809019, -1378.0235215916991, -560.1727834261426, -19.410640769589136, -621.8697247611672, -254.16289958385067, -1373.8421131868165, -1086.6002170802594, -1145.597587964871, -1094.472058567113, -20.173372837031227, -671.6871590550771, -679.0552319736296], "episode_lengths": [64, 57, 150, 103, 150, 150, 119, 150, 112, 150, 150, 150, 150, 150, 67, 150, 109, 150, 150, 150, 56, 145, 75, 150, 150, 150, 78, 150, 113, 150, 150, 130, 150, 150, 150, 93, 86, 150, 150, 59, 150, 150, 136, 43, 150, 150, 150, 114, 150, 150, 150, 150, 36, 150, 150, 64, 150, 150, 91, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 150, 150, 84, 46, 150, 150, 92, 150, 33, 69, 125, 64, 59, 119, 150, 150, 150, 150, 145, 37, 150, 78, 150, 150, 150, 150, 38, 150, 150], "policy_policy_0_reward": [-84.09111644706405, -54.72578380151653, -351.3463946626712, -459.8333264578422, -1009.3889078788361, -749.9646227490199, -358.26981800522674, -1335.3595026298387, -330.2691556832521, -1297.9263509787452, -1104.1597270396373, -431.4538433183868, -496.5469919920979, -832.0853789054697, -126.47934158492835, -1174.3661117738084, -270.19757942338174, -335.4200527086367, -1150.7685162225466, -956.3221956143226, -84.79934515290414, -584.8075536968286, -127.3646133002583, -612.1658926198305, -1089.7695794411225, -536.1515274853267, -115.28716984418138, -864.1971013851255, -572.5810511818321, -973.996071113173, -637.8866729412778, -500.63064422505903, -1101.9050919449137, -470.9775086452896, -980.7149423489038, -191.35094431927158, -220.22533945379288, -523.0467781873513, -628.0053586772434, -126.4965780618337, -989.9345239950014, -987.3123323559317, -806.6683688819274, -36.13190026267125, -636.3129692009896, -618.6448135853485, -642.2954800833487, -556.4432266074567, -555.9974341133617, -492.66864786044954, -693.2283466496807, -428.61161030552466, -12.786926480081735, -935.8750892213669, -876.0034158331703, -77.38097409937647, -1187.993081067118, -729.7146897157842, -242.04776826036723, -611.8972884978433, -1436.8810191666214, -570.3446593615058, -1154.262058566921, -1141.9949881810303, -494.623407114456, -394.49936249992413, -146.1349128179454, -605.036841806154, -651.953751472452, -924.8995155614869, -703.8489320596952, -680.9589555267846, -602.8031490149062, -212.42050089151448, -62.11781270747076, -492.49958749005367, -524.9311096440621, -199.2095496222321, -391.17534930721104, -28.99102816468002, -231.34394129068593, -503.31520574464116, -90.0776643917864, -59.80330590485846, -351.0866643320855, -729.6821974527635, -1086.4039815297126, -976.5121833809019, -1378.0235215916991, -560.1727834261426, -19.410640769589136, -621.8697247611672, -254.16289958385067, -1373.8421131868165, -1086.6002170802594, -1145.597587964871, -1094.472058567113, -20.173372837031227, -671.6871590550771, -679.0552319736296]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5582977504460415, "mean_inference_ms": 1.6744984340107747, "mean_action_processing_ms": 0.27695696287084276, "mean_env_wait_ms": 3.436559165625448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012427568435668945, "StateBufferConnector_ms": 0.007908821105957031, "ViewRequirementAgentConnector_ms": 0.19647908210754395}, "num_episodes": 34, "episode_return_max": -12.786926480081735, "episode_return_min": -1436.8810191666214, "episode_return_mean": -603.2216231478135, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 355.3306514901605, "num_env_steps_trained_throughput_per_sec": 355.3306514901605, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12090.435, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12090.362, "sample_time_ms": 1170.383, "learn_time_ms": 10854.672, "learn_throughput": 368.505, "synch_weights_time_ms": 64.534}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "b33d0_00000", "date": "2024-08-06_14-43-35", "timestamp": 1722935615, "time_this_iter_s": 11.270075798034668, "time_total_s": 180.10975003242493, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2a9ea0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 180.10975003242493, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 19.09375, "ram_util_percent": 35.212500000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 76.54271013538043, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.013491666565339, "policy_loss": -0.017712314701930153, "vf_loss": 5.025620689988136, "vf_explained_var": 0.8438760956128438, "kl": 0.015163352117057608, "entropy": 1.240202283859253, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -12.786926480081735, "episode_reward_min": -1436.8810191666214, "episode_reward_mean": -598.4911445727101, "episode_len_mean": 128.52, "episode_media": {}, "episodes_timesteps_total": 12852, "policy_reward_min": {"policy_0": -1436.8810191666214}, "policy_reward_max": {"policy_0": -12.786926480081735}, "policy_reward_mean": {"policy_0": -598.4911445727101}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-500.63064422505903, -1101.9050919449137, -470.9775086452896, -980.7149423489038, -191.35094431927158, -220.22533945379288, -523.0467781873513, -628.0053586772434, -126.4965780618337, -989.9345239950014, -987.3123323559317, -806.6683688819274, -36.13190026267125, -636.3129692009896, -618.6448135853485, -642.2954800833487, -556.4432266074567, -555.9974341133617, -492.66864786044954, -693.2283466496807, -428.61161030552466, -12.786926480081735, -935.8750892213669, -876.0034158331703, -77.38097409937647, -1187.993081067118, -729.7146897157842, -242.04776826036723, -611.8972884978433, -1436.8810191666214, -570.3446593615058, -1154.262058566921, -1141.9949881810303, -494.623407114456, -394.49936249992413, -146.1349128179454, -605.036841806154, -651.953751472452, -924.8995155614869, -703.8489320596952, -680.9589555267846, -602.8031490149062, -212.42050089151448, -62.11781270747076, -492.49958749005367, -524.9311096440621, -199.2095496222321, -391.17534930721104, -28.99102816468002, -231.34394129068593, -503.31520574464116, -90.0776643917864, -59.80330590485846, -351.0866643320855, -729.6821974527635, -1086.4039815297126, -976.5121833809019, -1378.0235215916991, -560.1727834261426, -19.410640769589136, -621.8697247611672, -254.16289958385067, -1373.8421131868165, -1086.6002170802594, -1145.597587964871, -1094.472058567113, -20.173372837031227, -671.6871590550771, -679.0552319736296, -569.0400680999195, -749.2060019718596, -576.6552909943615, -540.8944672808678, -705.0497280132785, -1126.2481712292597, -709.908515162371, -106.68670992532057, -111.16133800381769, -829.5120558835566, -848.5946026410252, -626.614268387094, -504.1487223523789, -629.5274140211881, -755.6634995235304, -672.1723610672952, -535.3111074443864, -1269.1089286061372, -550.5397409769633, -715.496692605459, -509.12616329515845, -236.84018329151226, -461.1402802927884, -554.2957711036605, -541.8341597545141, -227.90689579997417, -34.69768340635987, -332.85875739569406, -1018.270202829801, -563.1536015693374, -1023.2700555998998], "episode_lengths": [130, 150, 150, 150, 93, 86, 150, 150, 59, 150, 150, 136, 43, 150, 150, 150, 114, 150, 150, 150, 150, 36, 150, 150, 64, 150, 150, 91, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 150, 150, 84, 46, 150, 150, 92, 150, 33, 69, 125, 64, 59, 119, 150, 150, 150, 150, 145, 37, 150, 78, 150, 150, 150, 150, 38, 150, 150, 150, 150, 150, 150, 148, 150, 150, 71, 73, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 118, 150, 150, 150, 92, 48, 85, 150, 150, 150], "policy_policy_0_reward": [-500.63064422505903, -1101.9050919449137, -470.9775086452896, -980.7149423489038, -191.35094431927158, -220.22533945379288, -523.0467781873513, -628.0053586772434, -126.4965780618337, -989.9345239950014, -987.3123323559317, -806.6683688819274, -36.13190026267125, -636.3129692009896, -618.6448135853485, -642.2954800833487, -556.4432266074567, -555.9974341133617, -492.66864786044954, -693.2283466496807, -428.61161030552466, -12.786926480081735, -935.8750892213669, -876.0034158331703, -77.38097409937647, -1187.993081067118, -729.7146897157842, -242.04776826036723, -611.8972884978433, -1436.8810191666214, -570.3446593615058, -1154.262058566921, -1141.9949881810303, -494.623407114456, -394.49936249992413, -146.1349128179454, -605.036841806154, -651.953751472452, -924.8995155614869, -703.8489320596952, -680.9589555267846, -602.8031490149062, -212.42050089151448, -62.11781270747076, -492.49958749005367, -524.9311096440621, -199.2095496222321, -391.17534930721104, -28.99102816468002, -231.34394129068593, -503.31520574464116, -90.0776643917864, -59.80330590485846, -351.0866643320855, -729.6821974527635, -1086.4039815297126, -976.5121833809019, -1378.0235215916991, -560.1727834261426, -19.410640769589136, -621.8697247611672, -254.16289958385067, -1373.8421131868165, -1086.6002170802594, -1145.597587964871, -1094.472058567113, -20.173372837031227, -671.6871590550771, -679.0552319736296, -569.0400680999195, -749.2060019718596, -576.6552909943615, -540.8944672808678, -705.0497280132785, -1126.2481712292597, -709.908515162371, -106.68670992532057, -111.16133800381769, -829.5120558835566, -848.5946026410252, -626.614268387094, -504.1487223523789, -629.5274140211881, -755.6634995235304, -672.1723610672952, -535.3111074443864, -1269.1089286061372, -550.5397409769633, -715.496692605459, -509.12616329515845, -236.84018329151226, -461.1402802927884, -554.2957711036605, -541.8341597545141, -227.90689579997417, -34.69768340635987, -332.85875739569406, -1018.270202829801, -563.1536015693374, -1023.2700555998998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5581556329176487, "mean_inference_ms": 1.6748118776645131, "mean_action_processing_ms": 0.27721350562918023, "mean_env_wait_ms": 3.4356194005958773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01248478889465332, "StateBufferConnector_ms": 0.00794219970703125, "ViewRequirementAgentConnector_ms": 0.2050037384033203}, "num_episodes": 31, "episode_return_max": -12.786926480081735, "episode_return_min": -1436.8810191666214, "episode_return_mean": -598.4911445727101, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 325.27043852083017, "num_env_steps_trained_throughput_per_sec": 325.27043852083017, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12081.855, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12081.784, "sample_time_ms": 1159.118, "learn_time_ms": 10859.649, "learn_throughput": 368.336, "synch_weights_time_ms": 62.243}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "b33d0_00000", "date": "2024-08-06_14-43-47", "timestamp": 1722935627, "time_this_iter_s": 12.31009554862976, "time_total_s": 192.4198455810547, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c230a60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 192.4198455810547, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 18.772222222222222, "ram_util_percent": 35.211111111111116}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 65.26664926608403, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.291967001308998, "policy_loss": -0.01392671513312962, "vf_loss": 5.300181231896082, "vf_explained_var": 0.7952769126743078, "kl": 0.015176228653096294, "entropy": 1.1168071454390884, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": 11.19065875426486, "episode_reward_min": -1539.0317232134937, "episode_reward_mean": -583.1000616719596, "episode_len_mean": 126.55, "episode_media": {}, "episodes_timesteps_total": 12655, "policy_reward_min": {"policy_0": -1539.0317232134937}, "policy_reward_max": {"policy_0": 11.19065875426486}, "policy_reward_mean": {"policy_0": -583.1000616719596}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-570.3446593615058, -1154.262058566921, -1141.9949881810303, -494.623407114456, -394.49936249992413, -146.1349128179454, -605.036841806154, -651.953751472452, -924.8995155614869, -703.8489320596952, -680.9589555267846, -602.8031490149062, -212.42050089151448, -62.11781270747076, -492.49958749005367, -524.9311096440621, -199.2095496222321, -391.17534930721104, -28.99102816468002, -231.34394129068593, -503.31520574464116, -90.0776643917864, -59.80330590485846, -351.0866643320855, -729.6821974527635, -1086.4039815297126, -976.5121833809019, -1378.0235215916991, -560.1727834261426, -19.410640769589136, -621.8697247611672, -254.16289958385067, -1373.8421131868165, -1086.6002170802594, -1145.597587964871, -1094.472058567113, -20.173372837031227, -671.6871590550771, -679.0552319736296, -569.0400680999195, -749.2060019718596, -576.6552909943615, -540.8944672808678, -705.0497280132785, -1126.2481712292597, -709.908515162371, -106.68670992532057, -111.16133800381769, -829.5120558835566, -848.5946026410252, -626.614268387094, -504.1487223523789, -629.5274140211881, -755.6634995235304, -672.1723610672952, -535.3111074443864, -1269.1089286061372, -550.5397409769633, -715.496692605459, -509.12616329515845, -236.84018329151226, -461.1402802927884, -554.2957711036605, -541.8341597545141, -227.90689579997417, -34.69768340635987, -332.85875739569406, -1018.270202829801, -563.1536015693374, -1023.2700555998998, -523.9676927510442, -439.87132485107685, -82.632908668192, -690.8882900450185, -543.6477768732836, -544.2888746091587, -1539.0317232134937, 11.19065875426486, -572.2625705297925, -1277.5134867536306, -132.20802003134443, -164.26928059828882, -384.28863407274093, -701.4405882705462, -63.320740601028355, -1218.8794411290792, -494.3536755611715, -1302.6758654317184, -1075.7043015241577, -614.4237551361018, -390.2797456192065, -572.1312077968129, -953.6333337461394, -558.4791773842742, -278.8179636161301, -25.115599749186995, -500.453723213636, -383.77136781145134, -192.8660362086606, -549.0483549899236], "episode_lengths": [150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 150, 150, 84, 46, 150, 150, 92, 150, 33, 69, 125, 64, 59, 119, 150, 150, 150, 150, 145, 37, 150, 78, 150, 150, 150, 150, 38, 150, 150, 150, 150, 150, 150, 148, 150, 150, 71, 73, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 118, 150, 150, 150, 92, 48, 85, 150, 150, 150, 141, 106, 61, 150, 150, 150, 150, 30, 150, 150, 77, 83, 103, 150, 56, 150, 150, 150, 150, 150, 92, 150, 150, 150, 104, 45, 150, 126, 81, 150], "policy_policy_0_reward": [-570.3446593615058, -1154.262058566921, -1141.9949881810303, -494.623407114456, -394.49936249992413, -146.1349128179454, -605.036841806154, -651.953751472452, -924.8995155614869, -703.8489320596952, -680.9589555267846, -602.8031490149062, -212.42050089151448, -62.11781270747076, -492.49958749005367, -524.9311096440621, -199.2095496222321, -391.17534930721104, -28.99102816468002, -231.34394129068593, -503.31520574464116, -90.0776643917864, -59.80330590485846, -351.0866643320855, -729.6821974527635, -1086.4039815297126, -976.5121833809019, -1378.0235215916991, -560.1727834261426, -19.410640769589136, -621.8697247611672, -254.16289958385067, -1373.8421131868165, -1086.6002170802594, -1145.597587964871, -1094.472058567113, -20.173372837031227, -671.6871590550771, -679.0552319736296, -569.0400680999195, -749.2060019718596, -576.6552909943615, -540.8944672808678, -705.0497280132785, -1126.2481712292597, -709.908515162371, -106.68670992532057, -111.16133800381769, -829.5120558835566, -848.5946026410252, -626.614268387094, -504.1487223523789, -629.5274140211881, -755.6634995235304, -672.1723610672952, -535.3111074443864, -1269.1089286061372, -550.5397409769633, -715.496692605459, -509.12616329515845, -236.84018329151226, -461.1402802927884, -554.2957711036605, -541.8341597545141, -227.90689579997417, -34.69768340635987, -332.85875739569406, -1018.270202829801, -563.1536015693374, -1023.2700555998998, -523.9676927510442, -439.87132485107685, -82.632908668192, -690.8882900450185, -543.6477768732836, -544.2888746091587, -1539.0317232134937, 11.19065875426486, -572.2625705297925, -1277.5134867536306, -132.20802003134443, -164.26928059828882, -384.28863407274093, -701.4405882705462, -63.320740601028355, -1218.8794411290792, -494.3536755611715, -1302.6758654317184, -1075.7043015241577, -614.4237551361018, -390.2797456192065, -572.1312077968129, -953.6333337461394, -558.4791773842742, -278.8179636161301, -25.115599749186995, -500.453723213636, -383.77136781145134, -192.8660362086606, -549.0483549899236]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5581430010722356, "mean_inference_ms": 1.6762249892265728, "mean_action_processing_ms": 0.27742868446318797, "mean_env_wait_ms": 3.4348498675521757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012229681015014648, "StateBufferConnector_ms": 0.012507200241088867, "ViewRequirementAgentConnector_ms": 0.20546555519104004}, "num_episodes": 30, "episode_return_max": 11.19065875426486, "episode_return_min": -1539.0317232134937, "episode_return_mean": -583.1000616719596, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 346.0111361065551, "num_env_steps_trained_throughput_per_sec": 346.0111361065551, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12014.21, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12014.139, "sample_time_ms": 1155.578, "learn_time_ms": 10793.428, "learn_throughput": 370.596, "synch_weights_time_ms": 64.351}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "b33d0_00000", "date": "2024-08-06_14-43-59", "timestamp": 1722935639, "time_this_iter_s": 11.571466445922852, "time_total_s": 203.99131202697754, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7855b4e20700>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 203.99131202697754, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 23.0875, "ram_util_percent": 35.3125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 72.17681834797064, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.716040519128243, "policy_loss": -0.010421626863535493, "vf_loss": 5.720536648233732, "vf_explained_var": 0.8451560222854216, "kl": 0.016224541241475283, "entropy": 1.3755421402553718, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": 11.19065875426486, "episode_reward_min": -1539.0317232134937, "episode_reward_mean": -599.6000314284433, "episode_len_mean": 127.39, "episode_media": {}, "episodes_timesteps_total": 12739, "policy_reward_min": {"policy_0": -1539.0317232134937}, "policy_reward_max": {"policy_0": 11.19065875426486}, "policy_reward_mean": {"policy_0": -599.6000314284433}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.410640769589136, -621.8697247611672, -254.16289958385067, -1373.8421131868165, -1086.6002170802594, -1145.597587964871, -1094.472058567113, -20.173372837031227, -671.6871590550771, -679.0552319736296, -569.0400680999195, -749.2060019718596, -576.6552909943615, -540.8944672808678, -705.0497280132785, -1126.2481712292597, -709.908515162371, -106.68670992532057, -111.16133800381769, -829.5120558835566, -848.5946026410252, -626.614268387094, -504.1487223523789, -629.5274140211881, -755.6634995235304, -672.1723610672952, -535.3111074443864, -1269.1089286061372, -550.5397409769633, -715.496692605459, -509.12616329515845, -236.84018329151226, -461.1402802927884, -554.2957711036605, -541.8341597545141, -227.90689579997417, -34.69768340635987, -332.85875739569406, -1018.270202829801, -563.1536015693374, -1023.2700555998998, -523.9676927510442, -439.87132485107685, -82.632908668192, -690.8882900450185, -543.6477768732836, -544.2888746091587, -1539.0317232134937, 11.19065875426486, -572.2625705297925, -1277.5134867536306, -132.20802003134443, -164.26928059828882, -384.28863407274093, -701.4405882705462, -63.320740601028355, -1218.8794411290792, -494.3536755611715, -1302.6758654317184, -1075.7043015241577, -614.4237551361018, -390.2797456192065, -572.1312077968129, -953.6333337461394, -558.4791773842742, -278.8179636161301, -25.115599749186995, -500.453723213636, -383.77136781145134, -192.8660362086606, -549.0483549899236, -738.9574868222808, -532.5496310170008, -581.9146929371188, -76.2767378067302, -264.270335039142, -153.64874095162364, -729.4823595537284, -542.0122458040332, -644.2583650603177, -654.6940521964326, -891.8074956292622, -484.0824760502661, -136.08122897701944, -1070.970725085271, -752.0741838644319, -94.33117587717189, -774.968638926357, -1293.4188458134217, -1283.6872875118283, -289.92924236514443, -653.0492754600074, -395.6846055260208, -132.86165413416072, -1158.1325751985862, -683.7768510669625, -923.4083262188742, -162.12513229405684, -459.92786222857427, -1040.7416670883197], "episode_lengths": [37, 150, 78, 150, 150, 150, 150, 38, 150, 150, 150, 150, 150, 150, 148, 150, 150, 71, 73, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 118, 150, 150, 150, 92, 48, 85, 150, 150, 150, 141, 106, 61, 150, 150, 150, 150, 30, 150, 150, 77, 83, 103, 150, 56, 150, 150, 150, 150, 150, 92, 150, 150, 150, 104, 45, 150, 126, 81, 150, 150, 148, 150, 59, 72, 79, 150, 150, 150, 150, 150, 147, 75, 150, 129, 71, 131, 150, 150, 108, 150, 107, 76, 150, 150, 150, 77, 150, 150], "policy_policy_0_reward": [-19.410640769589136, -621.8697247611672, -254.16289958385067, -1373.8421131868165, -1086.6002170802594, -1145.597587964871, -1094.472058567113, -20.173372837031227, -671.6871590550771, -679.0552319736296, -569.0400680999195, -749.2060019718596, -576.6552909943615, -540.8944672808678, -705.0497280132785, -1126.2481712292597, -709.908515162371, -106.68670992532057, -111.16133800381769, -829.5120558835566, -848.5946026410252, -626.614268387094, -504.1487223523789, -629.5274140211881, -755.6634995235304, -672.1723610672952, -535.3111074443864, -1269.1089286061372, -550.5397409769633, -715.496692605459, -509.12616329515845, -236.84018329151226, -461.1402802927884, -554.2957711036605, -541.8341597545141, -227.90689579997417, -34.69768340635987, -332.85875739569406, -1018.270202829801, -563.1536015693374, -1023.2700555998998, -523.9676927510442, -439.87132485107685, -82.632908668192, -690.8882900450185, -543.6477768732836, -544.2888746091587, -1539.0317232134937, 11.19065875426486, -572.2625705297925, -1277.5134867536306, -132.20802003134443, -164.26928059828882, -384.28863407274093, -701.4405882705462, -63.320740601028355, -1218.8794411290792, -494.3536755611715, -1302.6758654317184, -1075.7043015241577, -614.4237551361018, -390.2797456192065, -572.1312077968129, -953.6333337461394, -558.4791773842742, -278.8179636161301, -25.115599749186995, -500.453723213636, -383.77136781145134, -192.8660362086606, -549.0483549899236, -738.9574868222808, -532.5496310170008, -581.9146929371188, -76.2767378067302, -264.270335039142, -153.64874095162364, -729.4823595537284, -542.0122458040332, -644.2583650603177, -654.6940521964326, -891.8074956292622, -484.0824760502661, -136.08122897701944, -1070.970725085271, -752.0741838644319, -94.33117587717189, -774.968638926357, -1293.4188458134217, -1283.6872875118283, -289.92924236514443, -653.0492754600074, -395.6846055260208, -132.86165413416072, -1158.1325751985862, -683.7768510669625, -923.4083262188742, -162.12513229405684, -459.92786222857427, -1040.7416670883197]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5574821949314078, "mean_inference_ms": 1.6747575993021284, "mean_action_processing_ms": 0.27715237407402205, "mean_env_wait_ms": 3.4354165529253136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012336969375610352, "StateBufferConnector_ms": 0.012537956237792969, "ViewRequirementAgentConnector_ms": 0.20442605018615723}, "num_episodes": 29, "episode_return_max": 11.19065875426486, "episode_return_min": -1539.0317232134937, "episode_return_mean": -599.6000314284433, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 327.99872892109397, "num_env_steps_trained_throughput_per_sec": 327.99872892109397, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12066.826, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12066.752, "sample_time_ms": 1156.664, "learn_time_ms": 10844.72, "learn_throughput": 368.843, "synch_weights_time_ms": 64.58}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "b33d0_00000", "date": "2024-08-06_14-44-11", "timestamp": 1722935651, "time_this_iter_s": 12.209564924240112, "time_total_s": 216.20087695121765, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2a9ea0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 216.20087695121765, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 18.505555555555556, "ram_util_percent": 35.20000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 76.36212198237578, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.937739961097638, "policy_loss": -0.02059002061141655, "vf_loss": 4.9520920604467396, "vf_explained_var": 0.8906300511832038, "kl": 0.016441062192492004, "entropy": 1.16056011877954, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": 11.19065875426486, "episode_reward_min": -1539.0317232134937, "episode_reward_mean": -597.6706225235458, "episode_len_mean": 124.86, "episode_media": {}, "episodes_timesteps_total": 12486, "policy_reward_min": {"policy_0": -1539.0317232134937}, "policy_reward_max": {"policy_0": 11.19065875426486}, "policy_reward_mean": {"policy_0": -597.6706225235458}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-332.85875739569406, -1018.270202829801, -563.1536015693374, -1023.2700555998998, -523.9676927510442, -439.87132485107685, -82.632908668192, -690.8882900450185, -543.6477768732836, -544.2888746091587, -1539.0317232134937, 11.19065875426486, -572.2625705297925, -1277.5134867536306, -132.20802003134443, -164.26928059828882, -384.28863407274093, -701.4405882705462, -63.320740601028355, -1218.8794411290792, -494.3536755611715, -1302.6758654317184, -1075.7043015241577, -614.4237551361018, -390.2797456192065, -572.1312077968129, -953.6333337461394, -558.4791773842742, -278.8179636161301, -25.115599749186995, -500.453723213636, -383.77136781145134, -192.8660362086606, -549.0483549899236, -738.9574868222808, -532.5496310170008, -581.9146929371188, -76.2767378067302, -264.270335039142, -153.64874095162364, -729.4823595537284, -542.0122458040332, -644.2583650603177, -654.6940521964326, -891.8074956292622, -484.0824760502661, -136.08122897701944, -1070.970725085271, -752.0741838644319, -94.33117587717189, -774.968638926357, -1293.4188458134217, -1283.6872875118283, -289.92924236514443, -653.0492754600074, -395.6846055260208, -132.86165413416072, -1158.1325751985862, -683.7768510669625, -923.4083262188742, -162.12513229405684, -459.92786222857427, -1040.7416670883197, -670.156137159893, -628.3922910719527, -1260.0955208291944, -74.72028975223799, -627.2176044923336, -630.4486151832261, -1020.064188821492, -511.0251350096321, -73.52255029389404, -1214.4227450955423, -972.7505037683421, -492.6828072610998, -1034.4909970452254, -1227.70820538541, -1303.2190759013743, -172.28385999945115, -600.0316522736335, -264.17122502636477, -199.1851117914901, -587.9022914076984, -297.23948520522384, -901.5237721384532, -691.6272442332798, -541.971410134105, -1156.6080967123637, -159.04139619712024, -1035.4888390227457, -435.2559346565368, -987.1980822055845, -540.5149036979054, -172.15057110558823, -491.24810387928716, -182.78935576734463, -667.6380370349875, -44.02905027892413, -257.65496962134995, -344.8408769634036], "episode_lengths": [85, 150, 150, 150, 141, 106, 61, 150, 150, 150, 150, 30, 150, 150, 77, 83, 103, 150, 56, 150, 150, 150, 150, 150, 92, 150, 150, 150, 104, 45, 150, 126, 81, 150, 150, 148, 150, 59, 72, 79, 150, 150, 150, 150, 150, 147, 75, 150, 129, 71, 131, 150, 150, 108, 150, 107, 76, 150, 150, 150, 77, 150, 150, 150, 150, 150, 65, 150, 150, 150, 150, 53, 150, 150, 150, 150, 150, 150, 84, 150, 93, 65, 150, 82, 150, 150, 150, 150, 80, 150, 143, 150, 150, 61, 150, 68, 150, 43, 99, 81], "policy_policy_0_reward": [-332.85875739569406, -1018.270202829801, -563.1536015693374, -1023.2700555998998, -523.9676927510442, -439.87132485107685, -82.632908668192, -690.8882900450185, -543.6477768732836, -544.2888746091587, -1539.0317232134937, 11.19065875426486, -572.2625705297925, -1277.5134867536306, -132.20802003134443, -164.26928059828882, -384.28863407274093, -701.4405882705462, -63.320740601028355, -1218.8794411290792, -494.3536755611715, -1302.6758654317184, -1075.7043015241577, -614.4237551361018, -390.2797456192065, -572.1312077968129, -953.6333337461394, -558.4791773842742, -278.8179636161301, -25.115599749186995, -500.453723213636, -383.77136781145134, -192.8660362086606, -549.0483549899236, -738.9574868222808, -532.5496310170008, -581.9146929371188, -76.2767378067302, -264.270335039142, -153.64874095162364, -729.4823595537284, -542.0122458040332, -644.2583650603177, -654.6940521964326, -891.8074956292622, -484.0824760502661, -136.08122897701944, -1070.970725085271, -752.0741838644319, -94.33117587717189, -774.968638926357, -1293.4188458134217, -1283.6872875118283, -289.92924236514443, -653.0492754600074, -395.6846055260208, -132.86165413416072, -1158.1325751985862, -683.7768510669625, -923.4083262188742, -162.12513229405684, -459.92786222857427, -1040.7416670883197, -670.156137159893, -628.3922910719527, -1260.0955208291944, -74.72028975223799, -627.2176044923336, -630.4486151832261, -1020.064188821492, -511.0251350096321, -73.52255029389404, -1214.4227450955423, -972.7505037683421, -492.6828072610998, -1034.4909970452254, -1227.70820538541, -1303.2190759013743, -172.28385999945115, -600.0316522736335, -264.17122502636477, -199.1851117914901, -587.9022914076984, -297.23948520522384, -901.5237721384532, -691.6272442332798, -541.971410134105, -1156.6080967123637, -159.04139619712024, -1035.4888390227457, -435.2559346565368, -987.1980822055845, -540.5149036979054, -172.15057110558823, -491.24810387928716, -182.78935576734463, -667.6380370349875, -44.02905027892413, -257.65496962134995, -344.8408769634036]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5575682480308888, "mean_inference_ms": 1.6753946589403939, "mean_action_processing_ms": 0.27711786646705217, "mean_env_wait_ms": 3.4380253972795516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012789249420166016, "StateBufferConnector_ms": 0.013296365737915039, "ViewRequirementAgentConnector_ms": 0.20041728019714355}, "num_episodes": 37, "episode_return_max": 11.19065875426486, "episode_return_min": -1539.0317232134937, "episode_return_mean": -597.6706225235458, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.11566068573705, "num_env_steps_trained_throughput_per_sec": 320.11566068573705, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12062.858, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12062.782, "sample_time_ms": 1158.231, "learn_time_ms": 10840.942, "learn_throughput": 368.972, "synch_weights_time_ms": 62.818}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "b33d0_00000", "date": "2024-08-06_14-44-24", "timestamp": 1722935664, "time_this_iter_s": 12.507364511489868, "time_total_s": 228.70824146270752, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2a92d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 228.70824146270752, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 19.499999999999996, "ram_util_percent": 35.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 84.27897715171179, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.583229231834411, "policy_loss": -0.014455220896343235, "vf_loss": 4.591340254743894, "vf_explained_var": 0.8756983599315087, "kl": 0.01639434808178826, "entropy": 1.033270983149608, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -5.170186550846745, "episode_reward_min": -1303.2190759013743, "episode_reward_mean": -573.039177675635, "episode_len_mean": 123.7, "episode_media": {}, "episodes_timesteps_total": 12370, "policy_reward_min": {"policy_0": -1303.2190759013743}, "policy_reward_max": {"policy_0": -5.170186550846745}, "policy_reward_mean": {"policy_0": -573.039177675635}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-549.0483549899236, -738.9574868222808, -532.5496310170008, -581.9146929371188, -76.2767378067302, -264.270335039142, -153.64874095162364, -729.4823595537284, -542.0122458040332, -644.2583650603177, -654.6940521964326, -891.8074956292622, -484.0824760502661, -136.08122897701944, -1070.970725085271, -752.0741838644319, -94.33117587717189, -774.968638926357, -1293.4188458134217, -1283.6872875118283, -289.92924236514443, -653.0492754600074, -395.6846055260208, -132.86165413416072, -1158.1325751985862, -683.7768510669625, -923.4083262188742, -162.12513229405684, -459.92786222857427, -1040.7416670883197, -670.156137159893, -628.3922910719527, -1260.0955208291944, -74.72028975223799, -627.2176044923336, -630.4486151832261, -1020.064188821492, -511.0251350096321, -73.52255029389404, -1214.4227450955423, -972.7505037683421, -492.6828072610998, -1034.4909970452254, -1227.70820538541, -1303.2190759013743, -172.28385999945115, -600.0316522736335, -264.17122502636477, -199.1851117914901, -587.9022914076984, -297.23948520522384, -901.5237721384532, -691.6272442332798, -541.971410134105, -1156.6080967123637, -159.04139619712024, -1035.4888390227457, -435.2559346565368, -987.1980822055845, -540.5149036979054, -172.15057110558823, -491.24810387928716, -182.78935576734463, -667.6380370349875, -44.02905027892413, -257.65496962134995, -344.8408769634036, -550.5073697943102, -563.0984659546002, -28.513011017338428, -12.665050482828027, -665.2219801089628, -5.170186550846745, -578.6360282895427, -780.2422102693663, -167.03955910728158, -258.2768233162355, -591.4491144923712, -1039.7621856865444, -389.91624636010704, -243.13990192173517, -1145.7860902508285, -806.1315184625734, -877.0695619496313, -426.8625129515289, -638.5233622268618, -606.8043188526937, -251.6068918020798, -367.3517828112382, -411.6814173125862, -1235.8418800117597, -763.5389377914646, -292.99435612561155, -384.1147934843113, -23.80630728453243, -36.25914699660279, -618.2005398128404, -1120.7333962797807, -310.2360027205238, -493.2536291662212], "episode_lengths": [150, 150, 148, 150, 59, 72, 79, 150, 150, 150, 150, 150, 147, 75, 150, 129, 71, 131, 150, 150, 108, 150, 107, 76, 150, 150, 150, 77, 150, 150, 150, 150, 150, 65, 150, 150, 150, 150, 53, 150, 150, 150, 150, 150, 150, 84, 150, 93, 65, 150, 82, 150, 150, 150, 150, 80, 150, 143, 150, 150, 61, 150, 68, 150, 43, 99, 81, 150, 150, 44, 41, 129, 32, 125, 150, 97, 85, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 73, 150, 102, 150, 150, 89, 116, 37, 48, 150, 150, 108, 150], "policy_policy_0_reward": [-549.0483549899236, -738.9574868222808, -532.5496310170008, -581.9146929371188, -76.2767378067302, -264.270335039142, -153.64874095162364, -729.4823595537284, -542.0122458040332, -644.2583650603177, -654.6940521964326, -891.8074956292622, -484.0824760502661, -136.08122897701944, -1070.970725085271, -752.0741838644319, -94.33117587717189, -774.968638926357, -1293.4188458134217, -1283.6872875118283, -289.92924236514443, -653.0492754600074, -395.6846055260208, -132.86165413416072, -1158.1325751985862, -683.7768510669625, -923.4083262188742, -162.12513229405684, -459.92786222857427, -1040.7416670883197, -670.156137159893, -628.3922910719527, -1260.0955208291944, -74.72028975223799, -627.2176044923336, -630.4486151832261, -1020.064188821492, -511.0251350096321, -73.52255029389404, -1214.4227450955423, -972.7505037683421, -492.6828072610998, -1034.4909970452254, -1227.70820538541, -1303.2190759013743, -172.28385999945115, -600.0316522736335, -264.17122502636477, -199.1851117914901, -587.9022914076984, -297.23948520522384, -901.5237721384532, -691.6272442332798, -541.971410134105, -1156.6080967123637, -159.04139619712024, -1035.4888390227457, -435.2559346565368, -987.1980822055845, -540.5149036979054, -172.15057110558823, -491.24810387928716, -182.78935576734463, -667.6380370349875, -44.02905027892413, -257.65496962134995, -344.8408769634036, -550.5073697943102, -563.0984659546002, -28.513011017338428, -12.665050482828027, -665.2219801089628, -5.170186550846745, -578.6360282895427, -780.2422102693663, -167.03955910728158, -258.2768233162355, -591.4491144923712, -1039.7621856865444, -389.91624636010704, -243.13990192173517, -1145.7860902508285, -806.1315184625734, -877.0695619496313, -426.8625129515289, -638.5233622268618, -606.8043188526937, -251.6068918020798, -367.3517828112382, -411.6814173125862, -1235.8418800117597, -763.5389377914646, -292.99435612561155, -384.1147934843113, -23.80630728453243, -36.25914699660279, -618.2005398128404, -1120.7333962797807, -310.2360027205238, -493.2536291662212]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5579008531309763, "mean_inference_ms": 1.6754749059405223, "mean_action_processing_ms": 0.27685782275573845, "mean_env_wait_ms": 3.437047644440342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012734651565551758, "StateBufferConnector_ms": 0.00887441635131836, "ViewRequirementAgentConnector_ms": 0.20123696327209473}, "num_episodes": 33, "episode_return_max": -5.170186550846745, "episode_return_min": -1303.2190759013743, "episode_return_mean": -573.039177675635, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.76880285950364, "num_env_steps_trained_throughput_per_sec": 304.76880285950364, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12093.662, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12093.58, "sample_time_ms": 1160.253, "learn_time_ms": 10868.299, "learn_throughput": 368.043, "synch_weights_time_ms": 64.224}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "b33d0_00000", "date": "2024-08-06_14-44-37", "timestamp": 1722935677, "time_this_iter_s": 13.13681149482727, "time_total_s": 241.8450529575348, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2aa320>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 241.8450529575348, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 23.3, "ram_util_percent": 38.11578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 95.49109981656075, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.212665490806103, "policy_loss": -0.012086769068749467, "vf_loss": 4.218619861950477, "vf_explained_var": 0.8822060245399673, "kl": 0.015804784049532845, "entropy": 0.9797669309501846, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -5.170186550846745, "episode_reward_min": -1324.0225948651653, "episode_reward_mean": -508.3309086265327, "episode_len_mean": 117.4, "episode_media": {}, "episodes_timesteps_total": 11740, "policy_reward_min": {"policy_0": -1324.0225948651653}, "policy_reward_max": {"policy_0": -5.170186550846745}, "policy_reward_mean": {"policy_0": -508.3309086265327}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-627.2176044923336, -630.4486151832261, -1020.064188821492, -511.0251350096321, -73.52255029389404, -1214.4227450955423, -972.7505037683421, -492.6828072610998, -1034.4909970452254, -1227.70820538541, -1303.2190759013743, -172.28385999945115, -600.0316522736335, -264.17122502636477, -199.1851117914901, -587.9022914076984, -297.23948520522384, -901.5237721384532, -691.6272442332798, -541.971410134105, -1156.6080967123637, -159.04139619712024, -1035.4888390227457, -435.2559346565368, -987.1980822055845, -540.5149036979054, -172.15057110558823, -491.24810387928716, -182.78935576734463, -667.6380370349875, -44.02905027892413, -257.65496962134995, -344.8408769634036, -550.5073697943102, -563.0984659546002, -28.513011017338428, -12.665050482828027, -665.2219801089628, -5.170186550846745, -578.6360282895427, -780.2422102693663, -167.03955910728158, -258.2768233162355, -591.4491144923712, -1039.7621856865444, -389.91624636010704, -243.13990192173517, -1145.7860902508285, -806.1315184625734, -877.0695619496313, -426.8625129515289, -638.5233622268618, -606.8043188526937, -251.6068918020798, -367.3517828112382, -411.6814173125862, -1235.8418800117597, -763.5389377914646, -292.99435612561155, -384.1147934843113, -23.80630728453243, -36.25914699660279, -618.2005398128404, -1120.7333962797807, -310.2360027205238, -493.2536291662212, -572.6837952185706, -420.28913547536484, -578.8085890953898, -202.53412895739015, -940.9354579298648, -284.87870728668685, -59.864107449210174, -1324.0225948651653, -176.55878140965712, -161.74380189725835, -627.3183695347932, -532.4836750799725, -90.31348976628345, -83.77999364405807, -452.6604173744127, -947.2171160590219, -492.4388271953837, -625.511850343207, -120.43977508422626, -394.84641807041345, -48.63970350069427, -532.2150511557321, -677.9370403775573, -33.83065350425922, -196.97745539197857, -397.06621371886735, -535.7365095254174, -734.3738834711753, -121.11816957559846, -355.0916697543299, -671.0784587965366, -171.45148012241876, -553.5792570717376, -192.2850076944735], "episode_lengths": [150, 150, 150, 150, 53, 150, 150, 150, 150, 150, 150, 84, 150, 93, 65, 150, 82, 150, 150, 150, 150, 80, 150, 143, 150, 150, 61, 150, 68, 150, 43, 99, 81, 150, 150, 44, 41, 129, 32, 125, 150, 97, 85, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 73, 150, 102, 150, 150, 89, 116, 37, 48, 150, 150, 108, 150, 150, 104, 150, 91, 150, 79, 51, 150, 79, 57, 150, 150, 46, 51, 150, 150, 115, 150, 76, 113, 54, 150, 150, 48, 78, 150, 150, 142, 56, 99, 126, 81, 150, 68], "policy_policy_0_reward": [-627.2176044923336, -630.4486151832261, -1020.064188821492, -511.0251350096321, -73.52255029389404, -1214.4227450955423, -972.7505037683421, -492.6828072610998, -1034.4909970452254, -1227.70820538541, -1303.2190759013743, -172.28385999945115, -600.0316522736335, -264.17122502636477, -199.1851117914901, -587.9022914076984, -297.23948520522384, -901.5237721384532, -691.6272442332798, -541.971410134105, -1156.6080967123637, -159.04139619712024, -1035.4888390227457, -435.2559346565368, -987.1980822055845, -540.5149036979054, -172.15057110558823, -491.24810387928716, -182.78935576734463, -667.6380370349875, -44.02905027892413, -257.65496962134995, -344.8408769634036, -550.5073697943102, -563.0984659546002, -28.513011017338428, -12.665050482828027, -665.2219801089628, -5.170186550846745, -578.6360282895427, -780.2422102693663, -167.03955910728158, -258.2768233162355, -591.4491144923712, -1039.7621856865444, -389.91624636010704, -243.13990192173517, -1145.7860902508285, -806.1315184625734, -877.0695619496313, -426.8625129515289, -638.5233622268618, -606.8043188526937, -251.6068918020798, -367.3517828112382, -411.6814173125862, -1235.8418800117597, -763.5389377914646, -292.99435612561155, -384.1147934843113, -23.80630728453243, -36.25914699660279, -618.2005398128404, -1120.7333962797807, -310.2360027205238, -493.2536291662212, -572.6837952185706, -420.28913547536484, -578.8085890953898, -202.53412895739015, -940.9354579298648, -284.87870728668685, -59.864107449210174, -1324.0225948651653, -176.55878140965712, -161.74380189725835, -627.3183695347932, -532.4836750799725, -90.31348976628345, -83.77999364405807, -452.6604173744127, -947.2171160590219, -492.4388271953837, -625.511850343207, -120.43977508422626, -394.84641807041345, -48.63970350069427, -532.2150511557321, -677.9370403775573, -33.83065350425922, -196.97745539197857, -397.06621371886735, -535.7365095254174, -734.3738834711753, -121.11816957559846, -355.0916697543299, -671.0784587965366, -171.45148012241876, -553.5792570717376, -192.2850076944735]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5585973603097486, "mean_inference_ms": 1.676281071705019, "mean_action_processing_ms": 0.27712075642996337, "mean_env_wait_ms": 3.4378800828931997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01249074935913086, "StateBufferConnector_ms": 0.008851289749145508, "ViewRequirementAgentConnector_ms": 0.19882869720458984}, "num_episodes": 34, "episode_return_max": -5.170186550846745, "episode_return_min": -1324.0225948651653, "episode_return_mean": -508.3309086265327, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 374.75707110602775, "num_env_steps_trained_throughput_per_sec": 374.75707110602775, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 11903.91, "restore_workers_time_ms": 0.033, "training_step_time_ms": 11903.829, "sample_time_ms": 1157.952, "learn_time_ms": 10680.69, "learn_throughput": 374.508, "synch_weights_time_ms": 64.38}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "b33d0_00000", "date": "2024-08-06_14-44-48", "timestamp": 1722935688, "time_this_iter_s": 10.684736728668213, "time_total_s": 252.529789686203, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2aa290>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 252.529789686203, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 20.433333333333334, "ram_util_percent": 36.50666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 89.38809829354287, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.047931110858917, "policy_loss": -0.012452598876067592, "vf_loss": 5.054287067055702, "vf_explained_var": 0.8268714245408774, "kl": 0.01650605766668986, "entropy": 1.3310770142823458, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -5.170186550846745, "episode_reward_min": -1324.0225948651653, "episode_reward_mean": -464.2087983806461, "episode_len_mean": 112.86, "episode_media": {}, "episodes_timesteps_total": 11286, "policy_reward_min": {"policy_0": -1324.0225948651653}, "policy_reward_max": {"policy_0": -5.170186550846745}, "policy_reward_mean": {"policy_0": -464.2087983806461}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-28.513011017338428, -12.665050482828027, -665.2219801089628, -5.170186550846745, -578.6360282895427, -780.2422102693663, -167.03955910728158, -258.2768233162355, -591.4491144923712, -1039.7621856865444, -389.91624636010704, -243.13990192173517, -1145.7860902508285, -806.1315184625734, -877.0695619496313, -426.8625129515289, -638.5233622268618, -606.8043188526937, -251.6068918020798, -367.3517828112382, -411.6814173125862, -1235.8418800117597, -763.5389377914646, -292.99435612561155, -384.1147934843113, -23.80630728453243, -36.25914699660279, -618.2005398128404, -1120.7333962797807, -310.2360027205238, -493.2536291662212, -572.6837952185706, -420.28913547536484, -578.8085890953898, -202.53412895739015, -940.9354579298648, -284.87870728668685, -59.864107449210174, -1324.0225948651653, -176.55878140965712, -161.74380189725835, -627.3183695347932, -532.4836750799725, -90.31348976628345, -83.77999364405807, -452.6604173744127, -947.2171160590219, -492.4388271953837, -625.511850343207, -120.43977508422626, -394.84641807041345, -48.63970350069427, -532.2150511557321, -677.9370403775573, -33.83065350425922, -196.97745539197857, -397.06621371886735, -535.7365095254174, -734.3738834711753, -121.11816957559846, -355.0916697543299, -671.0784587965366, -171.45148012241876, -553.5792570717376, -192.2850076944735, -482.51728122560706, -346.19806295696, -198.09462042291472, -763.206352484415, -284.22306942714624, -16.82095057704983, -389.8437514693404, -292.09695459479303, -1300.9309852555357, -53.64031370146171, -845.5203462972152, -980.2194469121945, -495.1566981421665, -589.3857227379974, -501.11049120605406, -242.1098832329592, -126.03674087599771, -285.77865964725913, -701.2883602005463, -489.92917272875985, -532.5031106516416, -443.48540864227743, -864.0462749990066, -812.423802254103, -48.05678394623807, -561.448508922386, -310.5101246121803, -549.3046088488942, -284.1372207809654, -325.16269606125434, -82.81067935178416, -170.19097242599088, -821.2762238490786, -1289.8679079001906, -60.00932142830932], "episode_lengths": [44, 41, 129, 32, 125, 150, 97, 85, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 73, 150, 102, 150, 150, 89, 116, 37, 48, 150, 150, 108, 150, 150, 104, 150, 91, 150, 79, 51, 150, 79, 57, 150, 150, 46, 51, 150, 150, 115, 150, 76, 113, 54, 150, 150, 48, 78, 150, 150, 142, 56, 99, 126, 81, 150, 68, 150, 100, 74, 150, 116, 48, 103, 79, 150, 56, 150, 150, 106, 150, 150, 103, 48, 89, 133, 150, 150, 150, 150, 138, 51, 113, 119, 150, 82, 114, 50, 68, 149, 150, 59], "policy_policy_0_reward": [-28.513011017338428, -12.665050482828027, -665.2219801089628, -5.170186550846745, -578.6360282895427, -780.2422102693663, -167.03955910728158, -258.2768233162355, -591.4491144923712, -1039.7621856865444, -389.91624636010704, -243.13990192173517, -1145.7860902508285, -806.1315184625734, -877.0695619496313, -426.8625129515289, -638.5233622268618, -606.8043188526937, -251.6068918020798, -367.3517828112382, -411.6814173125862, -1235.8418800117597, -763.5389377914646, -292.99435612561155, -384.1147934843113, -23.80630728453243, -36.25914699660279, -618.2005398128404, -1120.7333962797807, -310.2360027205238, -493.2536291662212, -572.6837952185706, -420.28913547536484, -578.8085890953898, -202.53412895739015, -940.9354579298648, -284.87870728668685, -59.864107449210174, -1324.0225948651653, -176.55878140965712, -161.74380189725835, -627.3183695347932, -532.4836750799725, -90.31348976628345, -83.77999364405807, -452.6604173744127, -947.2171160590219, -492.4388271953837, -625.511850343207, -120.43977508422626, -394.84641807041345, -48.63970350069427, -532.2150511557321, -677.9370403775573, -33.83065350425922, -196.97745539197857, -397.06621371886735, -535.7365095254174, -734.3738834711753, -121.11816957559846, -355.0916697543299, -671.0784587965366, -171.45148012241876, -553.5792570717376, -192.2850076944735, -482.51728122560706, -346.19806295696, -198.09462042291472, -763.206352484415, -284.22306942714624, -16.82095057704983, -389.8437514693404, -292.09695459479303, -1300.9309852555357, -53.64031370146171, -845.5203462972152, -980.2194469121945, -495.1566981421665, -589.3857227379974, -501.11049120605406, -242.1098832329592, -126.03674087599771, -285.77865964725913, -701.2883602005463, -489.92917272875985, -532.5031106516416, -443.48540864227743, -864.0462749990066, -812.423802254103, -48.05678394623807, -561.448508922386, -310.5101246121803, -549.3046088488942, -284.1372207809654, -325.16269606125434, -82.81067935178416, -170.19097242599088, -821.2762238490786, -1289.8679079001906, -60.00932142830932]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5590084343506369, "mean_inference_ms": 1.6760729721928929, "mean_action_processing_ms": 0.2768660827009354, "mean_env_wait_ms": 3.438299139686293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011979818344116211, "StateBufferConnector_ms": 0.008046865463256836, "ViewRequirementAgentConnector_ms": 0.1981363296508789}, "num_episodes": 35, "episode_return_max": -5.170186550846745, "episode_return_min": -1324.0225948651653, "episode_return_mean": -464.2087983806461, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 415.00060058919087, "num_env_steps_trained_throughput_per_sec": 415.00060058919087, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 11680.498, "restore_workers_time_ms": 0.033, "training_step_time_ms": 11680.417, "sample_time_ms": 1155.574, "learn_time_ms": 10458.952, "learn_throughput": 382.447, "synch_weights_time_ms": 65.089}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "b33d0_00000", "date": "2024-08-06_14-44-57", "timestamp": 1722935697, "time_this_iter_s": 9.65144658088684, "time_total_s": 262.18123626708984, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c231fc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 262.18123626708984, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 21.478571428571428, "ram_util_percent": 36.53571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 87.65065970321497, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.00190671980381, "policy_loss": -0.020398729351776033, "vf_loss": 5.016522449503342, "vf_explained_var": 0.8457007856418689, "kl": 0.01594804214340305, "entropy": 1.3936141451820732, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -16.82095057704983, "episode_reward_min": -1398.3416761451952, "episode_reward_mean": -509.0416077218379, "episode_len_mean": 115.38, "episode_media": {}, "episodes_timesteps_total": 11538, "policy_reward_min": {"policy_0": -1398.3416761451952}, "policy_reward_max": {"policy_0": -16.82095057704983}, "policy_reward_mean": {"policy_0": -509.0416077218379}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-578.8085890953898, -202.53412895739015, -940.9354579298648, -284.87870728668685, -59.864107449210174, -1324.0225948651653, -176.55878140965712, -161.74380189725835, -627.3183695347932, -532.4836750799725, -90.31348976628345, -83.77999364405807, -452.6604173744127, -947.2171160590219, -492.4388271953837, -625.511850343207, -120.43977508422626, -394.84641807041345, -48.63970350069427, -532.2150511557321, -677.9370403775573, -33.83065350425922, -196.97745539197857, -397.06621371886735, -535.7365095254174, -734.3738834711753, -121.11816957559846, -355.0916697543299, -671.0784587965366, -171.45148012241876, -553.5792570717376, -192.2850076944735, -482.51728122560706, -346.19806295696, -198.09462042291472, -763.206352484415, -284.22306942714624, -16.82095057704983, -389.8437514693404, -292.09695459479303, -1300.9309852555357, -53.64031370146171, -845.5203462972152, -980.2194469121945, -495.1566981421665, -589.3857227379974, -501.11049120605406, -242.1098832329592, -126.03674087599771, -285.77865964725913, -701.2883602005463, -489.92917272875985, -532.5031106516416, -443.48540864227743, -864.0462749990066, -812.423802254103, -48.05678394623807, -561.448508922386, -310.5101246121803, -549.3046088488942, -284.1372207809654, -325.16269606125434, -82.81067935178416, -170.19097242599088, -821.2762238490786, -1289.8679079001906, -60.00932142830932, -1311.6263160758388, -561.8692401535221, -847.2183160357285, -464.1855167200524, -628.2352934444243, -1076.7497056349084, -1394.408095080852, -178.5866852810392, -1379.7232738896216, -1398.3416761451952, -268.5713773371752, -484.197112982987, -1045.0194885695794, -60.98392484686326, -220.94702442369294, -1282.6771435981639, -395.3934828818476, -155.50665717400426, -541.6675738102816, -190.94798728883308, -286.29845298811813, -592.2858567358458, -261.22662683523055, -566.4705347730857, -1140.3763901029, -241.0634354678457, -273.3648923097584, -1130.5102381585768, -882.2570834605694, -283.7038813305852, -208.547465599303, -661.9221110858572, -632.1997484876734], "episode_lengths": [150, 91, 150, 79, 51, 150, 79, 57, 150, 150, 46, 51, 150, 150, 115, 150, 76, 113, 54, 150, 150, 48, 78, 150, 150, 142, 56, 99, 126, 81, 150, 68, 150, 100, 74, 150, 116, 48, 103, 79, 150, 56, 150, 150, 106, 150, 150, 103, 48, 89, 133, 150, 150, 150, 150, 138, 51, 113, 119, 150, 82, 114, 50, 68, 149, 150, 59, 150, 150, 141, 144, 150, 150, 150, 66, 150, 150, 117, 110, 150, 41, 86, 150, 150, 81, 150, 90, 74, 150, 107, 150, 150, 74, 101, 150, 150, 99, 99, 150, 150], "policy_policy_0_reward": [-578.8085890953898, -202.53412895739015, -940.9354579298648, -284.87870728668685, -59.864107449210174, -1324.0225948651653, -176.55878140965712, -161.74380189725835, -627.3183695347932, -532.4836750799725, -90.31348976628345, -83.77999364405807, -452.6604173744127, -947.2171160590219, -492.4388271953837, -625.511850343207, -120.43977508422626, -394.84641807041345, -48.63970350069427, -532.2150511557321, -677.9370403775573, -33.83065350425922, -196.97745539197857, -397.06621371886735, -535.7365095254174, -734.3738834711753, -121.11816957559846, -355.0916697543299, -671.0784587965366, -171.45148012241876, -553.5792570717376, -192.2850076944735, -482.51728122560706, -346.19806295696, -198.09462042291472, -763.206352484415, -284.22306942714624, -16.82095057704983, -389.8437514693404, -292.09695459479303, -1300.9309852555357, -53.64031370146171, -845.5203462972152, -980.2194469121945, -495.1566981421665, -589.3857227379974, -501.11049120605406, -242.1098832329592, -126.03674087599771, -285.77865964725913, -701.2883602005463, -489.92917272875985, -532.5031106516416, -443.48540864227743, -864.0462749990066, -812.423802254103, -48.05678394623807, -561.448508922386, -310.5101246121803, -549.3046088488942, -284.1372207809654, -325.16269606125434, -82.81067935178416, -170.19097242599088, -821.2762238490786, -1289.8679079001906, -60.00932142830932, -1311.6263160758388, -561.8692401535221, -847.2183160357285, -464.1855167200524, -628.2352934444243, -1076.7497056349084, -1394.408095080852, -178.5866852810392, -1379.7232738896216, -1398.3416761451952, -268.5713773371752, -484.197112982987, -1045.0194885695794, -60.98392484686326, -220.94702442369294, -1282.6771435981639, -395.3934828818476, -155.50665717400426, -541.6675738102816, -190.94798728883308, -286.29845298811813, -592.2858567358458, -261.22662683523055, -566.4705347730857, -1140.3763901029, -241.0634354678457, -273.3648923097584, -1130.5102381585768, -882.2570834605694, -283.7038813305852, -208.547465599303, -661.9221110858572, -632.1997484876734]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5590809914781668, "mean_inference_ms": 1.676096323957516, "mean_action_processing_ms": 0.2767583474544056, "mean_env_wait_ms": 3.439707841903944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012238264083862305, "StateBufferConnector_ms": 0.008033990859985352, "ViewRequirementAgentConnector_ms": 0.20458483695983887}, "num_episodes": 33, "episode_return_max": -16.82095057704983, "episode_return_min": -1398.3416761451952, "episode_return_mean": -509.0416077218379, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 373.8545406575227, "num_env_steps_trained_throughput_per_sec": 373.8545406575227, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 11489.209, "restore_workers_time_ms": 0.033, "training_step_time_ms": 11489.128, "sample_time_ms": 1181.132, "learn_time_ms": 10241.412, "learn_throughput": 390.571, "synch_weights_time_ms": 65.784}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "b33d0_00000", "date": "2024-08-06_14-45-08", "timestamp": 1722935708, "time_this_iter_s": 10.711862325668335, "time_total_s": 272.8930985927582, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c232170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 272.8930985927582, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 23.05625, "ram_util_percent": 36.49375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 112.77252161304156, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.286945661902427, "policy_loss": -0.01431855469418224, "vf_loss": 4.29506083453695, "vf_explained_var": 0.8734442968542377, "kl": 0.016582639951502644, "entropy": 1.2587855483715733, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -16.82095057704983, "episode_reward_min": -1398.3416761451952, "episode_reward_mean": -548.4006662972396, "episode_len_mean": 118.79, "episode_media": {}, "episodes_timesteps_total": 11879, "policy_reward_min": {"policy_0": -1398.3416761451952}, "policy_reward_max": {"policy_0": -16.82095057704983}, "policy_reward_mean": {"policy_0": -548.4006662972396}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-346.19806295696, -198.09462042291472, -763.206352484415, -284.22306942714624, -16.82095057704983, -389.8437514693404, -292.09695459479303, -1300.9309852555357, -53.64031370146171, -845.5203462972152, -980.2194469121945, -495.1566981421665, -589.3857227379974, -501.11049120605406, -242.1098832329592, -126.03674087599771, -285.77865964725913, -701.2883602005463, -489.92917272875985, -532.5031106516416, -443.48540864227743, -864.0462749990066, -812.423802254103, -48.05678394623807, -561.448508922386, -310.5101246121803, -549.3046088488942, -284.1372207809654, -325.16269606125434, -82.81067935178416, -170.19097242599088, -821.2762238490786, -1289.8679079001906, -60.00932142830932, -1311.6263160758388, -561.8692401535221, -847.2183160357285, -464.1855167200524, -628.2352934444243, -1076.7497056349084, -1394.408095080852, -178.5866852810392, -1379.7232738896216, -1398.3416761451952, -268.5713773371752, -484.197112982987, -1045.0194885695794, -60.98392484686326, -220.94702442369294, -1282.6771435981639, -395.3934828818476, -155.50665717400426, -541.6675738102816, -190.94798728883308, -286.29845298811813, -592.2858567358458, -261.22662683523055, -566.4705347730857, -1140.3763901029, -241.0634354678457, -273.3648923097584, -1130.5102381585768, -882.2570834605694, -283.7038813305852, -208.547465599303, -661.9221110858572, -632.1997484876734, -489.5930902866587, -151.0798922156398, -499.3665088903189, -662.5349903163709, -763.3499582667393, -43.226081052401376, -127.10452891333114, -948.5568215985164, -722.3747002137408, -862.7107220774951, -715.6656850593853, -862.5793783487017, -70.8449623823954, -831.7528652381814, -602.0529598392231, -1118.6181312261747, -372.1484387647982, -607.2442242295534, -234.8469570802523, -818.2213252508036, -897.9055930487949, -552.5213418827367, -45.59858989017819, -334.5098828447287, -496.47002678875276, -1215.9481336403373, -34.06567256195498, -136.96048881396058, -501.76921581968156, -979.4208064490452, -119.5063587128547, -620.385553650268, -297.2259081149536], "episode_lengths": [100, 74, 150, 116, 48, 103, 79, 150, 56, 150, 150, 106, 150, 150, 103, 48, 89, 133, 150, 150, 150, 150, 138, 51, 113, 119, 150, 82, 114, 50, 68, 149, 150, 59, 150, 150, 141, 144, 150, 150, 150, 66, 150, 150, 117, 110, 150, 41, 86, 150, 150, 81, 150, 90, 74, 150, 107, 150, 150, 74, 101, 150, 150, 99, 99, 150, 150, 150, 65, 150, 138, 150, 49, 57, 150, 145, 150, 150, 150, 68, 150, 150, 150, 96, 150, 97, 150, 150, 150, 43, 83, 150, 150, 46, 81, 115, 150, 80, 150, 88], "policy_policy_0_reward": [-346.19806295696, -198.09462042291472, -763.206352484415, -284.22306942714624, -16.82095057704983, -389.8437514693404, -292.09695459479303, -1300.9309852555357, -53.64031370146171, -845.5203462972152, -980.2194469121945, -495.1566981421665, -589.3857227379974, -501.11049120605406, -242.1098832329592, -126.03674087599771, -285.77865964725913, -701.2883602005463, -489.92917272875985, -532.5031106516416, -443.48540864227743, -864.0462749990066, -812.423802254103, -48.05678394623807, -561.448508922386, -310.5101246121803, -549.3046088488942, -284.1372207809654, -325.16269606125434, -82.81067935178416, -170.19097242599088, -821.2762238490786, -1289.8679079001906, -60.00932142830932, -1311.6263160758388, -561.8692401535221, -847.2183160357285, -464.1855167200524, -628.2352934444243, -1076.7497056349084, -1394.408095080852, -178.5866852810392, -1379.7232738896216, -1398.3416761451952, -268.5713773371752, -484.197112982987, -1045.0194885695794, -60.98392484686326, -220.94702442369294, -1282.6771435981639, -395.3934828818476, -155.50665717400426, -541.6675738102816, -190.94798728883308, -286.29845298811813, -592.2858567358458, -261.22662683523055, -566.4705347730857, -1140.3763901029, -241.0634354678457, -273.3648923097584, -1130.5102381585768, -882.2570834605694, -283.7038813305852, -208.547465599303, -661.9221110858572, -632.1997484876734, -489.5930902866587, -151.0798922156398, -499.3665088903189, -662.5349903163709, -763.3499582667393, -43.226081052401376, -127.10452891333114, -948.5568215985164, -722.3747002137408, -862.7107220774951, -715.6656850593853, -862.5793783487017, -70.8449623823954, -831.7528652381814, -602.0529598392231, -1118.6181312261747, -372.1484387647982, -607.2442242295534, -234.8469570802523, -818.2213252508036, -897.9055930487949, -552.5213418827367, -45.59858989017819, -334.5098828447287, -496.47002678875276, -1215.9481336403373, -34.06567256195498, -136.96048881396058, -501.76921581968156, -979.4208064490452, -119.5063587128547, -620.385553650268, -297.2259081149536]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5596317620259982, "mean_inference_ms": 1.6766311405503485, "mean_action_processing_ms": 0.27649814382577476, "mean_env_wait_ms": 3.441274558844579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012590646743774414, "StateBufferConnector_ms": 0.008105993270874023, "ViewRequirementAgentConnector_ms": 0.2113957405090332}, "num_episodes": 33, "episode_return_max": -16.82095057704983, "episode_return_min": -1398.3416761451952, "episode_return_mean": -548.4006662972396, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.3327460253247, "num_env_steps_trained_throughput_per_sec": 317.3327460253247, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 11654.695, "restore_workers_time_ms": 0.032, "training_step_time_ms": 11654.615, "sample_time_ms": 1186.533, "learn_time_ms": 10401.343, "learn_throughput": 384.566, "synch_weights_time_ms": 65.934}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "b33d0_00000", "date": "2024-08-06_14-45-21", "timestamp": 1722935721, "time_this_iter_s": 12.617803573608398, "time_total_s": 285.5109021663666, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2aa950>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 285.5109021663666, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 23.164705882352937, "ram_util_percent": 35.194117647058825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 93.92800144453844, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.577563960105181, "policy_loss": -0.018127370340031725, "vf_loss": 4.588627633204063, "vf_explained_var": 0.9062643762677908, "kl": 0.018596005584064813, "entropy": 1.3045025618125996, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -34.06567256195498, "episode_reward_min": -1398.3416761451952, "episode_reward_mean": -575.6572091705852, "episode_len_mean": 123.76, "episode_media": {}, "episodes_timesteps_total": 12376, "policy_reward_min": {"policy_0": -1398.3416761451952}, "policy_reward_max": {"policy_0": -34.06567256195498}, "policy_reward_mean": {"policy_0": -575.6572091705852}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1289.8679079001906, -60.00932142830932, -1311.6263160758388, -561.8692401535221, -847.2183160357285, -464.1855167200524, -628.2352934444243, -1076.7497056349084, -1394.408095080852, -178.5866852810392, -1379.7232738896216, -1398.3416761451952, -268.5713773371752, -484.197112982987, -1045.0194885695794, -60.98392484686326, -220.94702442369294, -1282.6771435981639, -395.3934828818476, -155.50665717400426, -541.6675738102816, -190.94798728883308, -286.29845298811813, -592.2858567358458, -261.22662683523055, -566.4705347730857, -1140.3763901029, -241.0634354678457, -273.3648923097584, -1130.5102381585768, -882.2570834605694, -283.7038813305852, -208.547465599303, -661.9221110858572, -632.1997484876734, -489.5930902866587, -151.0798922156398, -499.3665088903189, -662.5349903163709, -763.3499582667393, -43.226081052401376, -127.10452891333114, -948.5568215985164, -722.3747002137408, -862.7107220774951, -715.6656850593853, -862.5793783487017, -70.8449623823954, -831.7528652381814, -602.0529598392231, -1118.6181312261747, -372.1484387647982, -607.2442242295534, -234.8469570802523, -818.2213252508036, -897.9055930487949, -552.5213418827367, -45.59858989017819, -334.5098828447287, -496.47002678875276, -1215.9481336403373, -34.06567256195498, -136.96048881396058, -501.76921581968156, -979.4208064490452, -119.5063587128547, -620.385553650268, -297.2259081149536, -695.9624103676144, -552.0748143977858, -141.29850942056268, -537.5383542715105, -336.52894051106273, -389.4585409981234, -521.734005651026, -83.24141779833352, -216.92334369744583, -940.5502181826495, -1044.2513460611965, -445.30170160486983, -460.63849566570775, -172.4952775922938, -597.2934478048014, -843.89845394357, -49.85940155543411, -335.62442652736667, -617.5918987701324, -1145.2311683862417, -143.23392867995454, -1100.9401139033469, -683.91755578246, -406.47836711754564, -532.1056355556602, -878.492420086705, -1180.5980491545895, -349.79368149364933, -278.8589952096486, -474.4225934821963, -717.6294490305827, -558.6343228470652], "episode_lengths": [150, 59, 150, 150, 141, 144, 150, 150, 150, 66, 150, 150, 117, 110, 150, 41, 86, 150, 150, 81, 150, 90, 74, 150, 107, 150, 150, 74, 101, 150, 150, 99, 99, 150, 150, 150, 65, 150, 138, 150, 49, 57, 150, 145, 150, 150, 150, 68, 150, 150, 150, 96, 150, 97, 150, 150, 150, 43, 83, 150, 150, 46, 81, 115, 150, 80, 150, 88, 150, 116, 112, 150, 109, 140, 114, 58, 86, 150, 150, 99, 99, 83, 150, 150, 52, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150], "policy_policy_0_reward": [-1289.8679079001906, -60.00932142830932, -1311.6263160758388, -561.8692401535221, -847.2183160357285, -464.1855167200524, -628.2352934444243, -1076.7497056349084, -1394.408095080852, -178.5866852810392, -1379.7232738896216, -1398.3416761451952, -268.5713773371752, -484.197112982987, -1045.0194885695794, -60.98392484686326, -220.94702442369294, -1282.6771435981639, -395.3934828818476, -155.50665717400426, -541.6675738102816, -190.94798728883308, -286.29845298811813, -592.2858567358458, -261.22662683523055, -566.4705347730857, -1140.3763901029, -241.0634354678457, -273.3648923097584, -1130.5102381585768, -882.2570834605694, -283.7038813305852, -208.547465599303, -661.9221110858572, -632.1997484876734, -489.5930902866587, -151.0798922156398, -499.3665088903189, -662.5349903163709, -763.3499582667393, -43.226081052401376, -127.10452891333114, -948.5568215985164, -722.3747002137408, -862.7107220774951, -715.6656850593853, -862.5793783487017, -70.8449623823954, -831.7528652381814, -602.0529598392231, -1118.6181312261747, -372.1484387647982, -607.2442242295534, -234.8469570802523, -818.2213252508036, -897.9055930487949, -552.5213418827367, -45.59858989017819, -334.5098828447287, -496.47002678875276, -1215.9481336403373, -34.06567256195498, -136.96048881396058, -501.76921581968156, -979.4208064490452, -119.5063587128547, -620.385553650268, -297.2259081149536, -695.9624103676144, -552.0748143977858, -141.29850942056268, -537.5383542715105, -336.52894051106273, -389.4585409981234, -521.734005651026, -83.24141779833352, -216.92334369744583, -940.5502181826495, -1044.2513460611965, -445.30170160486983, -460.63849566570775, -172.4952775922938, -597.2934478048014, -843.89845394357, -49.85940155543411, -335.62442652736667, -617.5918987701324, -1145.2311683862417, -143.23392867995454, -1100.9401139033469, -683.91755578246, -406.47836711754564, -532.1056355556602, -878.492420086705, -1180.5980491545895, -349.79368149364933, -278.8589952096486, -474.4225934821963, -717.6294490305827, -558.6343228470652]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5600881561208417, "mean_inference_ms": 1.6792468855037261, "mean_action_processing_ms": 0.2769799478531065, "mean_env_wait_ms": 3.446842370577195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012809991836547852, "StateBufferConnector_ms": 0.00824427604675293, "ViewRequirementAgentConnector_ms": 0.21385741233825684}, "num_episodes": 32, "episode_return_max": -34.06567256195498, "episode_return_min": -1398.3416761451952, "episode_return_mean": -575.6572091705852, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 345.0755269013526, "num_env_steps_trained_throughput_per_sec": 345.0755269013526, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 11688.149, "restore_workers_time_ms": 0.032, "training_step_time_ms": 11688.069, "sample_time_ms": 1185.745, "learn_time_ms": 10435.72, "learn_throughput": 383.299, "synch_weights_time_ms": 65.802}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "training_iteration": 25, "trial_id": "b33d0_00000", "date": "2024-08-06_14-45-33", "timestamp": 1722935733, "time_this_iter_s": 11.603927612304688, "time_total_s": 297.11482977867126, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2a8310>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 297.11482977867126, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 21.470588235294116, "ram_util_percent": 35.28235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 94.40724082986513, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.77379592731595, "policy_loss": -0.01793947933765594, "vf_loss": 4.785169143478075, "vf_explained_var": 0.9129087954138716, "kl": 0.01764054419954846, "entropy": 1.371988674129049, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "env_runners": {"episode_reward_max": -8.618356180797766, "episode_reward_min": -1462.8882505420067, "episode_reward_mean": -548.7998102778924, "episode_len_mean": 122.92, "episode_media": {}, "episodes_timesteps_total": 12292, "policy_reward_min": {"policy_0": -1462.8882505420067}, "policy_reward_max": {"policy_0": -8.618356180797766}, "policy_reward_mean": {"policy_0": -548.7998102778924}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-632.1997484876734, -489.5930902866587, -151.0798922156398, -499.3665088903189, -662.5349903163709, -763.3499582667393, -43.226081052401376, -127.10452891333114, -948.5568215985164, -722.3747002137408, -862.7107220774951, -715.6656850593853, -862.5793783487017, -70.8449623823954, -831.7528652381814, -602.0529598392231, -1118.6181312261747, -372.1484387647982, -607.2442242295534, -234.8469570802523, -818.2213252508036, -897.9055930487949, -552.5213418827367, -45.59858989017819, -334.5098828447287, -496.47002678875276, -1215.9481336403373, -34.06567256195498, -136.96048881396058, -501.76921581968156, -979.4208064490452, -119.5063587128547, -620.385553650268, -297.2259081149536, -695.9624103676144, -552.0748143977858, -141.29850942056268, -537.5383542715105, -336.52894051106273, -389.4585409981234, -521.734005651026, -83.24141779833352, -216.92334369744583, -940.5502181826495, -1044.2513460611965, -445.30170160486983, -460.63849566570775, -172.4952775922938, -597.2934478048014, -843.89845394357, -49.85940155543411, -335.62442652736667, -617.5918987701324, -1145.2311683862417, -143.23392867995454, -1100.9401139033469, -683.91755578246, -406.47836711754564, -532.1056355556602, -878.492420086705, -1180.5980491545895, -349.79368149364933, -278.8589952096486, -474.4225934821963, -717.6294490305827, -558.6343228470652, -921.2497172009355, -402.20336851422934, -180.24271997852748, -130.82915495743643, -829.8983854637805, -11.504158009570252, -1043.5503271795817, -1082.3114472818827, -115.99912095127502, -448.741916672426, -618.0226659231887, -1098.3527108376495, -583.1111924571793, -427.7198214638696, -153.37200335491497, -652.3227571409974, -250.27745440234102, -260.80181737899966, -250.76142812326842, -217.89528781730988, -1093.4783673936217, -1293.95754815172, -477.89200390387305, -364.1946263765412, -1225.6290399241227, -473.3648122450181, -167.9855628772344, -8.618356180797766, -271.8333671379092, -930.4388262749025, -1462.8882505420067, -476.0300563285177, -413.7369992430799, -739.8049285928068], "episode_lengths": [150, 150, 65, 150, 138, 150, 49, 57, 150, 145, 150, 150, 150, 68, 150, 150, 150, 96, 150, 97, 150, 150, 150, 43, 83, 150, 150, 46, 81, 115, 150, 80, 150, 88, 150, 116, 112, 150, 109, 140, 114, 58, 86, 150, 150, 99, 99, 83, 150, 150, 52, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 144, 83, 82, 142, 43, 150, 150, 73, 150, 150, 150, 150, 120, 84, 122, 111, 98, 85, 85, 150, 150, 103, 150, 150, 131, 83, 38, 90, 150, 150, 150, 138, 150], "policy_policy_0_reward": [-632.1997484876734, -489.5930902866587, -151.0798922156398, -499.3665088903189, -662.5349903163709, -763.3499582667393, -43.226081052401376, -127.10452891333114, -948.5568215985164, -722.3747002137408, -862.7107220774951, -715.6656850593853, -862.5793783487017, -70.8449623823954, -831.7528652381814, -602.0529598392231, -1118.6181312261747, -372.1484387647982, -607.2442242295534, -234.8469570802523, -818.2213252508036, -897.9055930487949, -552.5213418827367, -45.59858989017819, -334.5098828447287, -496.47002678875276, -1215.9481336403373, -34.06567256195498, -136.96048881396058, -501.76921581968156, -979.4208064490452, -119.5063587128547, -620.385553650268, -297.2259081149536, -695.9624103676144, -552.0748143977858, -141.29850942056268, -537.5383542715105, -336.52894051106273, -389.4585409981234, -521.734005651026, -83.24141779833352, -216.92334369744583, -940.5502181826495, -1044.2513460611965, -445.30170160486983, -460.63849566570775, -172.4952775922938, -597.2934478048014, -843.89845394357, -49.85940155543411, -335.62442652736667, -617.5918987701324, -1145.2311683862417, -143.23392867995454, -1100.9401139033469, -683.91755578246, -406.47836711754564, -532.1056355556602, -878.492420086705, -1180.5980491545895, -349.79368149364933, -278.8589952096486, -474.4225934821963, -717.6294490305827, -558.6343228470652, -921.2497172009355, -402.20336851422934, -180.24271997852748, -130.82915495743643, -829.8983854637805, -11.504158009570252, -1043.5503271795817, -1082.3114472818827, -115.99912095127502, -448.741916672426, -618.0226659231887, -1098.3527108376495, -583.1111924571793, -427.7198214638696, -153.37200335491497, -652.3227571409974, -250.27745440234102, -260.80181737899966, -250.76142812326842, -217.89528781730988, -1093.4783673936217, -1293.95754815172, -477.89200390387305, -364.1946263765412, -1225.6290399241227, -473.3648122450181, -167.9855628772344, -8.618356180797766, -271.8333671379092, -930.4388262749025, -1462.8882505420067, -476.0300563285177, -413.7369992430799, -739.8049285928068]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5612497772998531, "mean_inference_ms": 1.6812159602539276, "mean_action_processing_ms": 0.2772473300587041, "mean_env_wait_ms": 3.4497339689461755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012726068496704102, "StateBufferConnector_ms": 0.008260965347290039, "ViewRequirementAgentConnector_ms": 0.22530221939086914}, "num_episodes": 34, "episode_return_max": -8.618356180797766, "episode_return_min": -1462.8882505420067, "episode_return_mean": -548.7998102778924, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.82915620138976, "num_env_steps_trained_throughput_per_sec": 319.82915620138976, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 11709.072, "restore_workers_time_ms": 0.039, "training_step_time_ms": 11708.983, "sample_time_ms": 1189.467, "learn_time_ms": 10451.799, "learn_throughput": 382.709, "synch_weights_time_ms": 66.906}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "training_iteration": 26, "trial_id": "b33d0_00000", "date": "2024-08-06_14-45-45", "timestamp": 1722935745, "time_this_iter_s": 12.518374919891357, "time_total_s": 309.6332046985626, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2ab0a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 309.6332046985626, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 19.583333333333332, "ram_util_percent": 35.07222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 111.89391115903854, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.671934835861126, "policy_loss": -0.019107023120159283, "vf_loss": 4.684028073896965, "vf_explained_var": 0.9164630523572366, "kl": 0.018529800128635563, "entropy": 1.3246195128808418, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "env_runners": {"episode_reward_max": -8.618356180797766, "episode_reward_min": -1544.1536745090893, "episode_reward_mean": -543.9931978914916, "episode_len_mean": 119.69, "episode_media": {}, "episodes_timesteps_total": 11969, "policy_reward_min": {"policy_0": -1544.1536745090893}, "policy_reward_max": {"policy_0": -8.618356180797766}, "policy_reward_mean": {"policy_0": -543.9931978914916}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-297.2259081149536, -695.9624103676144, -552.0748143977858, -141.29850942056268, -537.5383542715105, -336.52894051106273, -389.4585409981234, -521.734005651026, -83.24141779833352, -216.92334369744583, -940.5502181826495, -1044.2513460611965, -445.30170160486983, -460.63849566570775, -172.4952775922938, -597.2934478048014, -843.89845394357, -49.85940155543411, -335.62442652736667, -617.5918987701324, -1145.2311683862417, -143.23392867995454, -1100.9401139033469, -683.91755578246, -406.47836711754564, -532.1056355556602, -878.492420086705, -1180.5980491545895, -349.79368149364933, -278.8589952096486, -474.4225934821963, -717.6294490305827, -558.6343228470652, -921.2497172009355, -402.20336851422934, -180.24271997852748, -130.82915495743643, -829.8983854637805, -11.504158009570252, -1043.5503271795817, -1082.3114472818827, -115.99912095127502, -448.741916672426, -618.0226659231887, -1098.3527108376495, -583.1111924571793, -427.7198214638696, -153.37200335491497, -652.3227571409974, -250.27745440234102, -260.80181737899966, -250.76142812326842, -217.89528781730988, -1093.4783673936217, -1293.95754815172, -477.89200390387305, -364.1946263765412, -1225.6290399241227, -473.3648122450181, -167.9855628772344, -8.618356180797766, -271.8333671379092, -930.4388262749025, -1462.8882505420067, -476.0300563285177, -413.7369992430799, -739.8049285928068, -596.4960587350964, -183.894019871323, -55.825470788194814, -138.2718782896992, -1269.8078348357558, -109.34757494081026, -1311.8714612649037, -34.8518500074203, -858.8641292012903, -1377.3012018841946, -465.9941466149274, -62.690017686369295, -174.78917772322785, -22.355259938589995, -323.58417500325515, -553.2315612146615, -412.73502223234584, -1544.1536745090893, -626.9182816135724, -513.3130631979105, -106.5764391525105, -177.1680502119301, -154.49938198350065, -378.77866318609097, -716.6416617364073, -9.154604054758954, -1421.8347429663934, -178.35874040659488, -774.6802404492952, -528.2308246047734, -1239.864906993998, -1162.0651935346166, -106.32308636805311], "episode_lengths": [88, 150, 116, 112, 150, 109, 140, 114, 58, 86, 150, 150, 99, 99, 83, 150, 150, 52, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 144, 83, 82, 142, 43, 150, 150, 73, 150, 150, 150, 150, 120, 84, 122, 111, 98, 85, 85, 150, 150, 103, 150, 150, 131, 83, 38, 90, 150, 150, 150, 138, 150, 113, 59, 55, 63, 150, 71, 150, 41, 150, 150, 150, 60, 99, 36, 150, 150, 150, 150, 150, 122, 61, 93, 73, 150, 150, 36, 150, 95, 150, 150, 150, 150, 63], "policy_policy_0_reward": [-297.2259081149536, -695.9624103676144, -552.0748143977858, -141.29850942056268, -537.5383542715105, -336.52894051106273, -389.4585409981234, -521.734005651026, -83.24141779833352, -216.92334369744583, -940.5502181826495, -1044.2513460611965, -445.30170160486983, -460.63849566570775, -172.4952775922938, -597.2934478048014, -843.89845394357, -49.85940155543411, -335.62442652736667, -617.5918987701324, -1145.2311683862417, -143.23392867995454, -1100.9401139033469, -683.91755578246, -406.47836711754564, -532.1056355556602, -878.492420086705, -1180.5980491545895, -349.79368149364933, -278.8589952096486, -474.4225934821963, -717.6294490305827, -558.6343228470652, -921.2497172009355, -402.20336851422934, -180.24271997852748, -130.82915495743643, -829.8983854637805, -11.504158009570252, -1043.5503271795817, -1082.3114472818827, -115.99912095127502, -448.741916672426, -618.0226659231887, -1098.3527108376495, -583.1111924571793, -427.7198214638696, -153.37200335491497, -652.3227571409974, -250.27745440234102, -260.80181737899966, -250.76142812326842, -217.89528781730988, -1093.4783673936217, -1293.95754815172, -477.89200390387305, -364.1946263765412, -1225.6290399241227, -473.3648122450181, -167.9855628772344, -8.618356180797766, -271.8333671379092, -930.4388262749025, -1462.8882505420067, -476.0300563285177, -413.7369992430799, -739.8049285928068, -596.4960587350964, -183.894019871323, -55.825470788194814, -138.2718782896992, -1269.8078348357558, -109.34757494081026, -1311.8714612649037, -34.8518500074203, -858.8641292012903, -1377.3012018841946, -465.9941466149274, -62.690017686369295, -174.78917772322785, -22.355259938589995, -323.58417500325515, -553.2315612146615, -412.73502223234584, -1544.1536745090893, -626.9182816135724, -513.3130631979105, -106.5764391525105, -177.1680502119301, -154.49938198350065, -378.77866318609097, -716.6416617364073, -9.154604054758954, -1421.8347429663934, -178.35874040659488, -774.6802404492952, -528.2308246047734, -1239.864906993998, -1162.0651935346166, -106.32308636805311]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5611836632616948, "mean_inference_ms": 1.6825721023698998, "mean_action_processing_ms": 0.2772786708773713, "mean_env_wait_ms": 3.4529356921174728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012522459030151367, "StateBufferConnector_ms": 0.008266210556030273, "ViewRequirementAgentConnector_ms": 0.22385215759277344}, "num_episodes": 33, "episode_return_max": -8.618356180797766, "episode_return_min": -1544.1536745090893, "episode_return_mean": -543.9931978914916, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.7942601822932, "num_env_steps_trained_throughput_per_sec": 323.7942601822932, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 11788.393, "restore_workers_time_ms": 0.04, "training_step_time_ms": 11788.302, "sample_time_ms": 1193.653, "learn_time_ms": 10527.644, "learn_throughput": 379.952, "synch_weights_time_ms": 66.186}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "training_iteration": 27, "trial_id": "b33d0_00000", "date": "2024-08-06_14-45-58", "timestamp": 1722935758, "time_this_iter_s": 12.367072582244873, "time_total_s": 322.0002772808075, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2ab9a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 322.0002772808075, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 18.65, "ram_util_percent": 34.888888888888886}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 115.56192048589388, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.346330027778944, "policy_loss": -0.01432955954563416, "vf_loss": 4.352469546596209, "vf_explained_var": 0.9256714653223753, "kl": 0.020871149946469828, "entropy": 1.2019829438999294, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": -8.618356180797766, "episode_reward_min": -1544.1536745090893, "episode_reward_mean": -549.8527285349401, "episode_len_mean": 115.84, "episode_media": {}, "episodes_timesteps_total": 11584, "policy_reward_min": {"policy_0": -1544.1536745090893}, "policy_reward_max": {"policy_0": -8.618356180797766}, "policy_reward_mean": {"policy_0": -549.8527285349401}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-130.82915495743643, -829.8983854637805, -11.504158009570252, -1043.5503271795817, -1082.3114472818827, -115.99912095127502, -448.741916672426, -618.0226659231887, -1098.3527108376495, -583.1111924571793, -427.7198214638696, -153.37200335491497, -652.3227571409974, -250.27745440234102, -260.80181737899966, -250.76142812326842, -217.89528781730988, -1093.4783673936217, -1293.95754815172, -477.89200390387305, -364.1946263765412, -1225.6290399241227, -473.3648122450181, -167.9855628772344, -8.618356180797766, -271.8333671379092, -930.4388262749025, -1462.8882505420067, -476.0300563285177, -413.7369992430799, -739.8049285928068, -596.4960587350964, -183.894019871323, -55.825470788194814, -138.2718782896992, -1269.8078348357558, -109.34757494081026, -1311.8714612649037, -34.8518500074203, -858.8641292012903, -1377.3012018841946, -465.9941466149274, -62.690017686369295, -174.78917772322785, -22.355259938589995, -323.58417500325515, -553.2315612146615, -412.73502223234584, -1544.1536745090893, -626.9182816135724, -513.3130631979105, -106.5764391525105, -177.1680502119301, -154.49938198350065, -378.77866318609097, -716.6416617364073, -9.154604054758954, -1421.8347429663934, -178.35874040659488, -774.6802404492952, -528.2308246047734, -1239.864906993998, -1162.0651935346166, -106.32308636805311, -770.896023225529, -227.74740429648668, -956.2369784263502, -1108.6464648176989, -151.1242272850916, -518.6627738658001, -466.50415917671484, -772.5632362491406, -32.06963102741036, -1032.6448340403615, -275.82243609018303, -209.08773166935893, -1363.7725396059832, -486.71616557530064, -555.9723215891863, -953.7894669162255, -701.6471893582327, -1141.517598712716, -156.08275267490623, -375.99826078218473, -719.7276943153308, -28.66720136645396, -1349.9175306629638, -104.3382341031185, -389.08414830277974, -79.42867142060688, -109.03639885761176, -531.6474528255775, -1134.977881666792, -206.83133056862033, -719.2656821313992, -338.0705692176856, -1182.2734778515019, -512.6356771614848, -100.31616258558485, -55.75575528223874], "episode_lengths": [82, 142, 43, 150, 150, 73, 150, 150, 150, 150, 120, 84, 122, 111, 98, 85, 85, 150, 150, 103, 150, 150, 131, 83, 38, 90, 150, 150, 150, 138, 150, 113, 59, 55, 63, 150, 71, 150, 41, 150, 150, 150, 60, 99, 36, 150, 150, 150, 150, 150, 122, 61, 93, 73, 150, 150, 36, 150, 95, 150, 150, 150, 150, 63, 150, 76, 150, 150, 79, 150, 144, 150, 46, 150, 104, 90, 150, 150, 150, 150, 150, 150, 72, 111, 150, 43, 150, 59, 104, 66, 71, 114, 150, 94, 141, 115, 150, 118, 65, 54], "policy_policy_0_reward": [-130.82915495743643, -829.8983854637805, -11.504158009570252, -1043.5503271795817, -1082.3114472818827, -115.99912095127502, -448.741916672426, -618.0226659231887, -1098.3527108376495, -583.1111924571793, -427.7198214638696, -153.37200335491497, -652.3227571409974, -250.27745440234102, -260.80181737899966, -250.76142812326842, -217.89528781730988, -1093.4783673936217, -1293.95754815172, -477.89200390387305, -364.1946263765412, -1225.6290399241227, -473.3648122450181, -167.9855628772344, -8.618356180797766, -271.8333671379092, -930.4388262749025, -1462.8882505420067, -476.0300563285177, -413.7369992430799, -739.8049285928068, -596.4960587350964, -183.894019871323, -55.825470788194814, -138.2718782896992, -1269.8078348357558, -109.34757494081026, -1311.8714612649037, -34.8518500074203, -858.8641292012903, -1377.3012018841946, -465.9941466149274, -62.690017686369295, -174.78917772322785, -22.355259938589995, -323.58417500325515, -553.2315612146615, -412.73502223234584, -1544.1536745090893, -626.9182816135724, -513.3130631979105, -106.5764391525105, -177.1680502119301, -154.49938198350065, -378.77866318609097, -716.6416617364073, -9.154604054758954, -1421.8347429663934, -178.35874040659488, -774.6802404492952, -528.2308246047734, -1239.864906993998, -1162.0651935346166, -106.32308636805311, -770.896023225529, -227.74740429648668, -956.2369784263502, -1108.6464648176989, -151.1242272850916, -518.6627738658001, -466.50415917671484, -772.5632362491406, -32.06963102741036, -1032.6448340403615, -275.82243609018303, -209.08773166935893, -1363.7725396059832, -486.71616557530064, -555.9723215891863, -953.7894669162255, -701.6471893582327, -1141.517598712716, -156.08275267490623, -375.99826078218473, -719.7276943153308, -28.66720136645396, -1349.9175306629638, -104.3382341031185, -389.08414830277974, -79.42867142060688, -109.03639885761176, -531.6474528255775, -1134.977881666792, -206.83133056862033, -719.2656821313992, -338.0705692176856, -1182.2734778515019, -512.6356771614848, -100.31616258558485, -55.75575528223874]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5620886960286221, "mean_inference_ms": 1.6832145968217236, "mean_action_processing_ms": 0.2777045898916487, "mean_env_wait_ms": 3.453125653716121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012143850326538086, "StateBufferConnector_ms": 0.008698463439941406, "ViewRequirementAgentConnector_ms": 0.21695542335510254}, "num_episodes": 36, "episode_return_max": -8.618356180797766, "episode_return_min": -1544.1536745090893, "episode_return_mean": -549.8527285349401, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 383.02343809803835, "num_env_steps_trained_throughput_per_sec": 383.02343809803835, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 11613.196, "restore_workers_time_ms": 0.037, "training_step_time_ms": 11613.111, "sample_time_ms": 1214.243, "learn_time_ms": 10331.012, "learn_throughput": 387.184, "synch_weights_time_ms": 67.003}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 28, "trial_id": "b33d0_00000", "date": "2024-08-06_14-46-08", "timestamp": 1722935768, "time_this_iter_s": 10.455475091934204, "time_total_s": 332.4557523727417, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c232d40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 332.4557523727417, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 20.321428571428573, "ram_util_percent": 34.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 133.7107581535975, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.8447552625089885, "policy_loss": -0.01592249615108206, "vf_loss": 3.852180157105128, "vf_explained_var": 0.9381611670677861, "kl": 0.014152284827226443, "entropy": 1.0551901272808513, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "env_runners": {"episode_reward_max": -8.259080297920143, "episode_reward_min": -1544.1536745090893, "episode_reward_mean": -489.3895533627622, "episode_len_mean": 110.5, "episode_media": {}, "episodes_timesteps_total": 11050, "policy_reward_min": {"policy_0": -1544.1536745090893}, "policy_reward_max": {"policy_0": -8.259080297920143}, "policy_reward_mean": {"policy_0": -489.3895533627622}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-858.8641292012903, -1377.3012018841946, -465.9941466149274, -62.690017686369295, -174.78917772322785, -22.355259938589995, -323.58417500325515, -553.2315612146615, -412.73502223234584, -1544.1536745090893, -626.9182816135724, -513.3130631979105, -106.5764391525105, -177.1680502119301, -154.49938198350065, -378.77866318609097, -716.6416617364073, -9.154604054758954, -1421.8347429663934, -178.35874040659488, -774.6802404492952, -528.2308246047734, -1239.864906993998, -1162.0651935346166, -106.32308636805311, -770.896023225529, -227.74740429648668, -956.2369784263502, -1108.6464648176989, -151.1242272850916, -518.6627738658001, -466.50415917671484, -772.5632362491406, -32.06963102741036, -1032.6448340403615, -275.82243609018303, -209.08773166935893, -1363.7725396059832, -486.71616557530064, -555.9723215891863, -953.7894669162255, -701.6471893582327, -1141.517598712716, -156.08275267490623, -375.99826078218473, -719.7276943153308, -28.66720136645396, -1349.9175306629638, -104.3382341031185, -389.08414830277974, -79.42867142060688, -109.03639885761176, -531.6474528255775, -1134.977881666792, -206.83133056862033, -719.2656821313992, -338.0705692176856, -1182.2734778515019, -512.6356771614848, -100.31616258558485, -55.75575528223874, -1359.8526430366812, -169.57064973643185, -243.71648151972792, -50.682805396176214, -27.168873868812316, -95.72255887607469, -544.606644808487, -167.41831734719295, -686.9413562124604, -984.8751723639655, -371.08682468377253, -1235.199423799088, -616.9990602663553, -58.07039383979391, -8.259080297920143, -641.6197378622944, -375.9768088540234, -981.2802897312708, -97.57736733765861, -184.2478790611612, -189.4535860110605, -527.7894799066122, -111.18684958398511, -141.29193510406975, -45.802680260290906, -294.9466310928304, -849.5376236345102, -43.15404921356639, -395.19268604962133, -853.7020276552362, -593.0096802970749, -575.9320431958863, -99.22144299774072, -63.61582453525589, -376.1402596240457, -138.1404643856512, -319.5941267737498, -125.87880678025557, -584.910460102459], "episode_lengths": [150, 150, 150, 60, 99, 36, 150, 150, 150, 150, 150, 122, 61, 93, 73, 150, 150, 36, 150, 95, 150, 150, 150, 150, 63, 150, 76, 150, 150, 79, 150, 144, 150, 46, 150, 104, 90, 150, 150, 150, 150, 150, 150, 72, 111, 150, 43, 150, 59, 104, 66, 71, 114, 150, 94, 141, 115, 150, 118, 65, 54, 150, 63, 104, 58, 44, 47, 150, 67, 128, 150, 150, 150, 150, 52, 32, 150, 114, 150, 47, 84, 72, 131, 51, 59, 54, 98, 150, 47, 131, 150, 150, 150, 68, 45, 114, 75, 98, 63, 150], "policy_policy_0_reward": [-858.8641292012903, -1377.3012018841946, -465.9941466149274, -62.690017686369295, -174.78917772322785, -22.355259938589995, -323.58417500325515, -553.2315612146615, -412.73502223234584, -1544.1536745090893, -626.9182816135724, -513.3130631979105, -106.5764391525105, -177.1680502119301, -154.49938198350065, -378.77866318609097, -716.6416617364073, -9.154604054758954, -1421.8347429663934, -178.35874040659488, -774.6802404492952, -528.2308246047734, -1239.864906993998, -1162.0651935346166, -106.32308636805311, -770.896023225529, -227.74740429648668, -956.2369784263502, -1108.6464648176989, -151.1242272850916, -518.6627738658001, -466.50415917671484, -772.5632362491406, -32.06963102741036, -1032.6448340403615, -275.82243609018303, -209.08773166935893, -1363.7725396059832, -486.71616557530064, -555.9723215891863, -953.7894669162255, -701.6471893582327, -1141.517598712716, -156.08275267490623, -375.99826078218473, -719.7276943153308, -28.66720136645396, -1349.9175306629638, -104.3382341031185, -389.08414830277974, -79.42867142060688, -109.03639885761176, -531.6474528255775, -1134.977881666792, -206.83133056862033, -719.2656821313992, -338.0705692176856, -1182.2734778515019, -512.6356771614848, -100.31616258558485, -55.75575528223874, -1359.8526430366812, -169.57064973643185, -243.71648151972792, -50.682805396176214, -27.168873868812316, -95.72255887607469, -544.606644808487, -167.41831734719295, -686.9413562124604, -984.8751723639655, -371.08682468377253, -1235.199423799088, -616.9990602663553, -58.07039383979391, -8.259080297920143, -641.6197378622944, -375.9768088540234, -981.2802897312708, -97.57736733765861, -184.2478790611612, -189.4535860110605, -527.7894799066122, -111.18684958398511, -141.29193510406975, -45.802680260290906, -294.9466310928304, -849.5376236345102, -43.15404921356639, -395.19268604962133, -853.7020276552362, -593.0096802970749, -575.9320431958863, -99.22144299774072, -63.61582453525589, -376.1402596240457, -138.1404643856512, -319.5941267737498, -125.87880678025557, -584.910460102459]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5620468371158633, "mean_inference_ms": 1.6846844016103482, "mean_action_processing_ms": 0.27768070817737206, "mean_env_wait_ms": 3.452650681393848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01207590103149414, "StateBufferConnector_ms": 0.008808374404907227, "ViewRequirementAgentConnector_ms": 0.2026958465576172}, "num_episodes": 39, "episode_return_max": -8.259080297920143, "episode_return_min": -1544.1536745090893, "episode_return_mean": -489.3895533627622, "episodes_this_iter": 39}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 331.9051066297454, "num_env_steps_trained_throughput_per_sec": 331.9051066297454, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 11568.811, "restore_workers_time_ms": 0.037, "training_step_time_ms": 11568.726, "sample_time_ms": 1218.53, "learn_time_ms": 10280.022, "learn_throughput": 389.104, "synch_weights_time_ms": 69.323}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "training_iteration": 29, "trial_id": "b33d0_00000", "date": "2024-08-06_14-46-20", "timestamp": 1722935780, "time_this_iter_s": 12.063618421554565, "time_total_s": 344.51937079429626, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7855b4e20700>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 344.51937079429626, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 18.37777777777778, "ram_util_percent": 34.77777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 119.37732212543487, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.867455609018604, "policy_loss": -0.01832960308674956, "vf_loss": 3.8771167737742265, "vf_explained_var": 0.9634238888820013, "kl": 0.014415614745909524, "entropy": 1.0620935536300142, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": -8.259080297920143, "episode_reward_min": -1359.8526430366812, "episode_reward_mean": -451.0270845488919, "episode_len_mean": 108.98, "episode_media": {}, "episodes_timesteps_total": 10898, "policy_reward_min": {"policy_0": -1359.8526430366812}, "policy_reward_max": {"policy_0": -8.259080297920143}, "policy_reward_mean": {"policy_0": -451.0270845488919}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-555.9723215891863, -953.7894669162255, -701.6471893582327, -1141.517598712716, -156.08275267490623, -375.99826078218473, -719.7276943153308, -28.66720136645396, -1349.9175306629638, -104.3382341031185, -389.08414830277974, -79.42867142060688, -109.03639885761176, -531.6474528255775, -1134.977881666792, -206.83133056862033, -719.2656821313992, -338.0705692176856, -1182.2734778515019, -512.6356771614848, -100.31616258558485, -55.75575528223874, -1359.8526430366812, -169.57064973643185, -243.71648151972792, -50.682805396176214, -27.168873868812316, -95.72255887607469, -544.606644808487, -167.41831734719295, -686.9413562124604, -984.8751723639655, -371.08682468377253, -1235.199423799088, -616.9990602663553, -58.07039383979391, -8.259080297920143, -641.6197378622944, -375.9768088540234, -981.2802897312708, -97.57736733765861, -184.2478790611612, -189.4535860110605, -527.7894799066122, -111.18684958398511, -141.29193510406975, -45.802680260290906, -294.9466310928304, -849.5376236345102, -43.15404921356639, -395.19268604962133, -853.7020276552362, -593.0096802970749, -575.9320431958863, -99.22144299774072, -63.61582453525589, -376.1402596240457, -138.1404643856512, -319.5941267737498, -125.87880678025557, -584.910460102459, -934.3242998925526, -586.73269661645, -84.32341239308236, -259.4329995057662, -502.8249896602181, -382.83288355402453, -557.2152682777327, -891.9458944965414, -495.2037938469474, -588.5211572007231, -210.78517719267046, -590.9456020807526, -89.3521933984426, -136.14227538680717, -1010.2895932859223, -390.30038259226296, -54.81133423585869, -1159.744362039014, -962.8141505440091, -484.3772671048409, -385.1111490051692, -522.9702342062949, -252.2703205064767, -296.10814402287536, -293.3544401998454, -142.4703054894886, -181.5324032480104, -596.8801416850326, -206.50339790670986, -168.12445163456212, -976.6597017571478, -458.64301442361176, -928.4771380650916, -819.6532309994712, -102.19406560968008, -88.00870507564139, -558.1328982885433, -85.02876227070549, -991.3117327337634], "episode_lengths": [150, 150, 150, 150, 72, 111, 150, 43, 150, 59, 104, 66, 71, 114, 150, 94, 141, 115, 150, 118, 65, 54, 150, 63, 104, 58, 44, 47, 150, 67, 128, 150, 150, 150, 150, 52, 32, 150, 114, 150, 47, 84, 72, 131, 51, 59, 54, 98, 150, 47, 131, 150, 150, 150, 68, 45, 114, 75, 98, 63, 150, 150, 150, 65, 108, 150, 148, 150, 150, 150, 150, 67, 150, 48, 50, 150, 113, 59, 150, 150, 150, 123, 150, 82, 103, 131, 81, 100, 150, 66, 61, 150, 150, 150, 150, 66, 57, 150, 47, 150], "policy_policy_0_reward": [-555.9723215891863, -953.7894669162255, -701.6471893582327, -1141.517598712716, -156.08275267490623, -375.99826078218473, -719.7276943153308, -28.66720136645396, -1349.9175306629638, -104.3382341031185, -389.08414830277974, -79.42867142060688, -109.03639885761176, -531.6474528255775, -1134.977881666792, -206.83133056862033, -719.2656821313992, -338.0705692176856, -1182.2734778515019, -512.6356771614848, -100.31616258558485, -55.75575528223874, -1359.8526430366812, -169.57064973643185, -243.71648151972792, -50.682805396176214, -27.168873868812316, -95.72255887607469, -544.606644808487, -167.41831734719295, -686.9413562124604, -984.8751723639655, -371.08682468377253, -1235.199423799088, -616.9990602663553, -58.07039383979391, -8.259080297920143, -641.6197378622944, -375.9768088540234, -981.2802897312708, -97.57736733765861, -184.2478790611612, -189.4535860110605, -527.7894799066122, -111.18684958398511, -141.29193510406975, -45.802680260290906, -294.9466310928304, -849.5376236345102, -43.15404921356639, -395.19268604962133, -853.7020276552362, -593.0096802970749, -575.9320431958863, -99.22144299774072, -63.61582453525589, -376.1402596240457, -138.1404643856512, -319.5941267737498, -125.87880678025557, -584.910460102459, -934.3242998925526, -586.73269661645, -84.32341239308236, -259.4329995057662, -502.8249896602181, -382.83288355402453, -557.2152682777327, -891.9458944965414, -495.2037938469474, -588.5211572007231, -210.78517719267046, -590.9456020807526, -89.3521933984426, -136.14227538680717, -1010.2895932859223, -390.30038259226296, -54.81133423585869, -1159.744362039014, -962.8141505440091, -484.3772671048409, -385.1111490051692, -522.9702342062949, -252.2703205064767, -296.10814402287536, -293.3544401998454, -142.4703054894886, -181.5324032480104, -596.8801416850326, -206.50339790670986, -168.12445163456212, -976.6597017571478, -458.64301442361176, -928.4771380650916, -819.6532309994712, -102.19406560968008, -88.00870507564139, -558.1328982885433, -85.02876227070549, -991.3117327337634]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5624443003516122, "mean_inference_ms": 1.683697647171566, "mean_action_processing_ms": 0.2777071988555265, "mean_env_wait_ms": 3.4517094072104713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011779546737670898, "StateBufferConnector_ms": 0.008714437484741211, "ViewRequirementAgentConnector_ms": 0.2104501724243164}, "num_episodes": 39, "episode_return_max": -8.259080297920143, "episode_return_min": -1359.8526430366812, "episode_return_mean": -451.0270845488919, "episodes_this_iter": 39}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.5298218999143, "num_env_steps_trained_throughput_per_sec": 305.5298218999143, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 11565.542, "restore_workers_time_ms": 0.035, "training_step_time_ms": 11565.461, "sample_time_ms": 1216.275, "learn_time_ms": 10281.126, "learn_throughput": 389.062, "synch_weights_time_ms": 67.215}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 30, "trial_id": "b33d0_00000", "date": "2024-08-06_14-46-33", "timestamp": 1722935793, "time_this_iter_s": 13.105093717575073, "time_total_s": 357.62446451187134, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2aaef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 357.62446451187134, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 18.233333333333334, "ram_util_percent": 34.79999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 162.2648747464021, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.4054536292950313, "policy_loss": -0.018145424059669797, "vf_loss": 3.414908481016755, "vf_explained_var": 0.9684074568251769, "kl": 0.014476141583039255, "entropy": 1.0808201479415098, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "env_runners": {"episode_reward_max": -2.325054117135526, "episode_reward_min": -1436.12076731159, "episode_reward_mean": -420.68354334870133, "episode_len_mean": 108.29, "episode_media": {}, "episodes_timesteps_total": 10829, "policy_reward_min": {"policy_0": -1436.12076731159}, "policy_reward_max": {"policy_0": -2.325054117135526}, "policy_reward_mean": {"policy_0": -420.68354334870133}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.259080297920143, -641.6197378622944, -375.9768088540234, -981.2802897312708, -97.57736733765861, -184.2478790611612, -189.4535860110605, -527.7894799066122, -111.18684958398511, -141.29193510406975, -45.802680260290906, -294.9466310928304, -849.5376236345102, -43.15404921356639, -395.19268604962133, -853.7020276552362, -593.0096802970749, -575.9320431958863, -99.22144299774072, -63.61582453525589, -376.1402596240457, -138.1404643856512, -319.5941267737498, -125.87880678025557, -584.910460102459, -934.3242998925526, -586.73269661645, -84.32341239308236, -259.4329995057662, -502.8249896602181, -382.83288355402453, -557.2152682777327, -891.9458944965414, -495.2037938469474, -588.5211572007231, -210.78517719267046, -590.9456020807526, -89.3521933984426, -136.14227538680717, -1010.2895932859223, -390.30038259226296, -54.81133423585869, -1159.744362039014, -962.8141505440091, -484.3772671048409, -385.1111490051692, -522.9702342062949, -252.2703205064767, -296.10814402287536, -293.3544401998454, -142.4703054894886, -181.5324032480104, -596.8801416850326, -206.50339790670986, -168.12445163456212, -976.6597017571478, -458.64301442361176, -928.4771380650916, -819.6532309994712, -102.19406560968008, -88.00870507564139, -558.1328982885433, -85.02876227070549, -991.3117327337634, -232.375190783013, -537.62688519427, -326.347825645553, -177.3788138079092, -683.5677712073342, -558.6832114420348, -21.558198324542396, -548.3144690055756, -296.57080149867323, -414.137670376906, -2.325054117135526, -589.2173309633163, -368.25538895144473, -1112.8443687897225, -230.61516551419285, -213.94801832806505, -159.47035477591487, -604.1774002902748, -878.8262261374833, -209.98593764336215, -187.6073069801065, -523.7315287305079, -407.6633668310807, -45.4588640285634, -319.6286292133254, -1068.7883772733069, -12.842076720757042, -20.009901597402727, -135.73402744270373, -1436.12076731159, -1157.5901324249685, -331.56716896965077, -68.71799272601024, -858.7208695513989, -172.11386242083793, -112.01758907023115], "episode_lengths": [32, 150, 114, 150, 47, 84, 72, 131, 51, 59, 54, 98, 150, 47, 131, 150, 150, 150, 68, 45, 114, 75, 98, 63, 150, 150, 150, 65, 108, 150, 148, 150, 150, 150, 150, 67, 150, 48, 50, 150, 113, 59, 150, 150, 150, 123, 150, 82, 103, 131, 81, 100, 150, 66, 61, 150, 150, 150, 150, 66, 57, 150, 47, 150, 95, 150, 96, 87, 150, 150, 42, 150, 88, 112, 34, 150, 114, 150, 87, 81, 84, 150, 150, 93, 80, 150, 140, 53, 115, 150, 34, 43, 76, 150, 150, 124, 56, 150, 85, 52], "policy_policy_0_reward": [-8.259080297920143, -641.6197378622944, -375.9768088540234, -981.2802897312708, -97.57736733765861, -184.2478790611612, -189.4535860110605, -527.7894799066122, -111.18684958398511, -141.29193510406975, -45.802680260290906, -294.9466310928304, -849.5376236345102, -43.15404921356639, -395.19268604962133, -853.7020276552362, -593.0096802970749, -575.9320431958863, -99.22144299774072, -63.61582453525589, -376.1402596240457, -138.1404643856512, -319.5941267737498, -125.87880678025557, -584.910460102459, -934.3242998925526, -586.73269661645, -84.32341239308236, -259.4329995057662, -502.8249896602181, -382.83288355402453, -557.2152682777327, -891.9458944965414, -495.2037938469474, -588.5211572007231, -210.78517719267046, -590.9456020807526, -89.3521933984426, -136.14227538680717, -1010.2895932859223, -390.30038259226296, -54.81133423585869, -1159.744362039014, -962.8141505440091, -484.3772671048409, -385.1111490051692, -522.9702342062949, -252.2703205064767, -296.10814402287536, -293.3544401998454, -142.4703054894886, -181.5324032480104, -596.8801416850326, -206.50339790670986, -168.12445163456212, -976.6597017571478, -458.64301442361176, -928.4771380650916, -819.6532309994712, -102.19406560968008, -88.00870507564139, -558.1328982885433, -85.02876227070549, -991.3117327337634, -232.375190783013, -537.62688519427, -326.347825645553, -177.3788138079092, -683.5677712073342, -558.6832114420348, -21.558198324542396, -548.3144690055756, -296.57080149867323, -414.137670376906, -2.325054117135526, -589.2173309633163, -368.25538895144473, -1112.8443687897225, -230.61516551419285, -213.94801832806505, -159.47035477591487, -604.1774002902748, -878.8262261374833, -209.98593764336215, -187.6073069801065, -523.7315287305079, -407.6633668310807, -45.4588640285634, -319.6286292133254, -1068.7883772733069, -12.842076720757042, -20.009901597402727, -135.73402744270373, -1436.12076731159, -1157.5901324249685, -331.56716896965077, -68.71799272601024, -858.7208695513989, -172.11386242083793, -112.01758907023115]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5628019458115477, "mean_inference_ms": 1.7117580007461464, "mean_action_processing_ms": 0.2776643192125821, "mean_env_wait_ms": 3.4550965001489398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012033224105834961, "StateBufferConnector_ms": 0.008336305618286133, "ViewRequirementAgentConnector_ms": 0.21143698692321777}, "num_episodes": 36, "episode_return_max": -2.325054117135526, "episode_return_min": -1436.12076731159, "episode_return_mean": -420.68354334870133, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.4063329525286, "num_env_steps_trained_throughput_per_sec": 308.4063329525286, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 11795.174, "restore_workers_time_ms": 0.034, "training_step_time_ms": 11795.094, "sample_time_ms": 1265.454, "learn_time_ms": 10462.089, "learn_throughput": 382.333, "synch_weights_time_ms": 66.708}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "training_iteration": 31, "trial_id": "b33d0_00000", "date": "2024-08-06_14-46-46", "timestamp": 1722935806, "time_this_iter_s": 12.982519388198853, "time_total_s": 370.6069839000702, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2aadd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 370.6069839000702, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 20.542105263157897, "ram_util_percent": 34.79999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 115.05755347410837, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.713769942894578, "policy_loss": -0.01224590078248487, "vf_loss": 3.718601340179642, "vf_explained_var": 0.9475270735099912, "kl": 0.012266457234485035, "entropy": 0.8653572572395205, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": -2.325054117135526, "episode_reward_min": -1436.12076731159, "episode_reward_mean": -404.41162848817623, "episode_len_mean": 105.33, "episode_media": {}, "episodes_timesteps_total": 10533, "policy_reward_min": {"policy_0": -1436.12076731159}, "policy_reward_max": {"policy_0": -2.325054117135526}, "policy_reward_mean": {"policy_0": -404.41162848817623}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-390.30038259226296, -54.81133423585869, -1159.744362039014, -962.8141505440091, -484.3772671048409, -385.1111490051692, -522.9702342062949, -252.2703205064767, -296.10814402287536, -293.3544401998454, -142.4703054894886, -181.5324032480104, -596.8801416850326, -206.50339790670986, -168.12445163456212, -976.6597017571478, -458.64301442361176, -928.4771380650916, -819.6532309994712, -102.19406560968008, -88.00870507564139, -558.1328982885433, -85.02876227070549, -991.3117327337634, -232.375190783013, -537.62688519427, -326.347825645553, -177.3788138079092, -683.5677712073342, -558.6832114420348, -21.558198324542396, -548.3144690055756, -296.57080149867323, -414.137670376906, -2.325054117135526, -589.2173309633163, -368.25538895144473, -1112.8443687897225, -230.61516551419285, -213.94801832806505, -159.47035477591487, -604.1774002902748, -878.8262261374833, -209.98593764336215, -187.6073069801065, -523.7315287305079, -407.6633668310807, -45.4588640285634, -319.6286292133254, -1068.7883772733069, -12.842076720757042, -20.009901597402727, -135.73402744270373, -1436.12076731159, -1157.5901324249685, -331.56716896965077, -68.71799272601024, -858.7208695513989, -172.11386242083793, -112.01758907023115, -813.2773914128358, -464.15730159102276, -177.2938279591002, -235.6279324145819, -198.881496024473, -67.87767868213264, -153.7855407312882, -123.60086149499172, -419.24495619924386, -436.57778257040167, -356.7957994924306, -222.9564270025148, -197.89935248740917, -58.847419136288075, -83.77220402153606, -1276.7722903686104, -453.40480563802936, -136.91969537631917, -445.3847828682001, -155.5274499901354, -157.00932918258505, -76.05604479336293, -1238.8162592786482, -95.13180671374413, -1319.0255533460638, -90.19328179074232, -213.4211477201568, -519.422648647069, -161.54283008451932, -193.49111032620203, -114.19999264056645, -459.9391823812697, -264.6081596777923, -450.4081203987172, -125.67197713934723, -171.6925564521312, -24.758881878330513, -530.0887769522105, -1008.0215945639521, -619.0383216553929], "episode_lengths": [113, 59, 150, 150, 150, 123, 150, 82, 103, 131, 81, 100, 150, 66, 61, 150, 150, 150, 150, 66, 57, 150, 47, 150, 95, 150, 96, 87, 150, 150, 42, 150, 88, 112, 34, 150, 114, 150, 87, 81, 84, 150, 150, 93, 80, 150, 140, 53, 115, 150, 34, 43, 76, 150, 150, 124, 56, 150, 85, 52, 150, 150, 80, 118, 108, 62, 53, 75, 99, 150, 94, 94, 65, 58, 55, 150, 150, 51, 124, 74, 81, 60, 150, 62, 150, 49, 76, 120, 82, 77, 66, 149, 114, 148, 58, 79, 42, 150, 150, 150], "policy_policy_0_reward": [-390.30038259226296, -54.81133423585869, -1159.744362039014, -962.8141505440091, -484.3772671048409, -385.1111490051692, -522.9702342062949, -252.2703205064767, -296.10814402287536, -293.3544401998454, -142.4703054894886, -181.5324032480104, -596.8801416850326, -206.50339790670986, -168.12445163456212, -976.6597017571478, -458.64301442361176, -928.4771380650916, -819.6532309994712, -102.19406560968008, -88.00870507564139, -558.1328982885433, -85.02876227070549, -991.3117327337634, -232.375190783013, -537.62688519427, -326.347825645553, -177.3788138079092, -683.5677712073342, -558.6832114420348, -21.558198324542396, -548.3144690055756, -296.57080149867323, -414.137670376906, -2.325054117135526, -589.2173309633163, -368.25538895144473, -1112.8443687897225, -230.61516551419285, -213.94801832806505, -159.47035477591487, -604.1774002902748, -878.8262261374833, -209.98593764336215, -187.6073069801065, -523.7315287305079, -407.6633668310807, -45.4588640285634, -319.6286292133254, -1068.7883772733069, -12.842076720757042, -20.009901597402727, -135.73402744270373, -1436.12076731159, -1157.5901324249685, -331.56716896965077, -68.71799272601024, -858.7208695513989, -172.11386242083793, -112.01758907023115, -813.2773914128358, -464.15730159102276, -177.2938279591002, -235.6279324145819, -198.881496024473, -67.87767868213264, -153.7855407312882, -123.60086149499172, -419.24495619924386, -436.57778257040167, -356.7957994924306, -222.9564270025148, -197.89935248740917, -58.847419136288075, -83.77220402153606, -1276.7722903686104, -453.40480563802936, -136.91969537631917, -445.3847828682001, -155.5274499901354, -157.00932918258505, -76.05604479336293, -1238.8162592786482, -95.13180671374413, -1319.0255533460638, -90.19328179074232, -213.4211477201568, -519.422648647069, -161.54283008451932, -193.49111032620203, -114.19999264056645, -459.9391823812697, -264.6081596777923, -450.4081203987172, -125.67197713934723, -171.6925564521312, -24.758881878330513, -530.0887769522105, -1008.0215945639521, -619.0383216553929]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5628352705047537, "mean_inference_ms": 1.741452195266772, "mean_action_processing_ms": 0.277973798515388, "mean_env_wait_ms": 3.4547456423194314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011867284774780273, "StateBufferConnector_ms": 0.008116006851196289, "ViewRequirementAgentConnector_ms": 0.20485138893127441}, "num_episodes": 40, "episode_return_max": -2.325054117135526, "episode_return_min": -1436.12076731159, "episode_return_mean": -404.41162848817623, "episodes_this_iter": 40}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 346.61733663923684, "num_env_steps_trained_throughput_per_sec": 346.61733663923684, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 11985.331, "restore_workers_time_ms": 0.035, "training_step_time_ms": 11985.248, "sample_time_ms": 1267.233, "learn_time_ms": 10651.504, "learn_throughput": 375.534, "synch_weights_time_ms": 65.674}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 32, "trial_id": "b33d0_00000", "date": "2024-08-06_14-46-58", "timestamp": 1722935818, "time_this_iter_s": 11.550206422805786, "time_total_s": 382.157190322876, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2aa290>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 382.157190322876, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 19.412499999999998, "ram_util_percent": 34.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 109.04313848813375, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.9635553156336147, "policy_loss": -0.014887591470809033, "vf_loss": 3.9698306483527026, "vf_explained_var": 0.9664731704940398, "kl": 0.014361606525865985, "entropy": 1.081808968819678, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "env_runners": {"episode_reward_max": -12.842076720757042, "episode_reward_min": -1436.12076731159, "episode_reward_mean": -381.4506285133797, "episode_len_mean": 102.79, "episode_media": {}, "episodes_timesteps_total": 10279, "policy_reward_min": {"policy_0": -1436.12076731159}, "policy_reward_max": {"policy_0": -12.842076720757042}, "policy_reward_mean": {"policy_0": -381.4506285133797}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-230.61516551419285, -213.94801832806505, -159.47035477591487, -604.1774002902748, -878.8262261374833, -209.98593764336215, -187.6073069801065, -523.7315287305079, -407.6633668310807, -45.4588640285634, -319.6286292133254, -1068.7883772733069, -12.842076720757042, -20.009901597402727, -135.73402744270373, -1436.12076731159, -1157.5901324249685, -331.56716896965077, -68.71799272601024, -858.7208695513989, -172.11386242083793, -112.01758907023115, -813.2773914128358, -464.15730159102276, -177.2938279591002, -235.6279324145819, -198.881496024473, -67.87767868213264, -153.7855407312882, -123.60086149499172, -419.24495619924386, -436.57778257040167, -356.7957994924306, -222.9564270025148, -197.89935248740917, -58.847419136288075, -83.77220402153606, -1276.7722903686104, -453.40480563802936, -136.91969537631917, -445.3847828682001, -155.5274499901354, -157.00932918258505, -76.05604479336293, -1238.8162592786482, -95.13180671374413, -1319.0255533460638, -90.19328179074232, -213.4211477201568, -519.422648647069, -161.54283008451932, -193.49111032620203, -114.19999264056645, -459.9391823812697, -264.6081596777923, -450.4081203987172, -125.67197713934723, -171.6925564521312, -24.758881878330513, -530.0887769522105, -1008.0215945639521, -619.0383216553929, -1143.1499948359208, -43.59412665561569, -182.46268717452025, -93.76095987957542, -447.37708281842174, -60.38996686174943, -609.6937460761457, -543.2020096542906, -409.65056568837537, -587.6144062024089, -298.9830976544636, -585.1233642029117, -234.4450217573452, -41.33639781096526, -84.1727537496312, -167.9663345092443, -92.0601487227851, -362.9488870643, -1112.452476033127, -122.1204631721819, -322.2165390428199, -122.29030531224828, -59.596012822741635, -523.5751676728166, -282.58709097032323, -624.5791883172448, -363.7317036899364, -143.2978635081088, -146.30787156480287, -413.96891315990206, -152.1117940930126, -1296.0690566979306, -568.1598091689776, -184.3924777946465, -48.491829819385984, -417.40896932091056, -489.9048637496691, -1297.3907690424332], "episode_lengths": [87, 81, 84, 150, 150, 93, 80, 150, 140, 53, 115, 150, 34, 43, 76, 150, 150, 124, 56, 150, 85, 52, 150, 150, 80, 118, 108, 62, 53, 75, 99, 150, 94, 94, 65, 58, 55, 150, 150, 51, 124, 74, 81, 60, 150, 62, 150, 49, 76, 120, 82, 77, 66, 149, 114, 148, 58, 79, 42, 150, 150, 150, 150, 42, 71, 58, 150, 49, 147, 150, 104, 150, 87, 150, 79, 52, 65, 103, 66, 150, 150, 74, 83, 89, 60, 150, 102, 150, 128, 71, 84, 150, 60, 150, 150, 73, 56, 150, 150, 150], "policy_policy_0_reward": [-230.61516551419285, -213.94801832806505, -159.47035477591487, -604.1774002902748, -878.8262261374833, -209.98593764336215, -187.6073069801065, -523.7315287305079, -407.6633668310807, -45.4588640285634, -319.6286292133254, -1068.7883772733069, -12.842076720757042, -20.009901597402727, -135.73402744270373, -1436.12076731159, -1157.5901324249685, -331.56716896965077, -68.71799272601024, -858.7208695513989, -172.11386242083793, -112.01758907023115, -813.2773914128358, -464.15730159102276, -177.2938279591002, -235.6279324145819, -198.881496024473, -67.87767868213264, -153.7855407312882, -123.60086149499172, -419.24495619924386, -436.57778257040167, -356.7957994924306, -222.9564270025148, -197.89935248740917, -58.847419136288075, -83.77220402153606, -1276.7722903686104, -453.40480563802936, -136.91969537631917, -445.3847828682001, -155.5274499901354, -157.00932918258505, -76.05604479336293, -1238.8162592786482, -95.13180671374413, -1319.0255533460638, -90.19328179074232, -213.4211477201568, -519.422648647069, -161.54283008451932, -193.49111032620203, -114.19999264056645, -459.9391823812697, -264.6081596777923, -450.4081203987172, -125.67197713934723, -171.6925564521312, -24.758881878330513, -530.0887769522105, -1008.0215945639521, -619.0383216553929, -1143.1499948359208, -43.59412665561569, -182.46268717452025, -93.76095987957542, -447.37708281842174, -60.38996686174943, -609.6937460761457, -543.2020096542906, -409.65056568837537, -587.6144062024089, -298.9830976544636, -585.1233642029117, -234.4450217573452, -41.33639781096526, -84.1727537496312, -167.9663345092443, -92.0601487227851, -362.9488870643, -1112.452476033127, -122.1204631721819, -322.2165390428199, -122.29030531224828, -59.596012822741635, -523.5751676728166, -282.58709097032323, -624.5791883172448, -363.7317036899364, -143.2978635081088, -146.30787156480287, -413.96891315990206, -152.1117940930126, -1296.0690566979306, -568.1598091689776, -184.3924777946465, -48.491829819385984, -417.40896932091056, -489.9048637496691, -1297.3907690424332]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5624662297491467, "mean_inference_ms": 1.7589398575934043, "mean_action_processing_ms": 0.27768084670332166, "mean_env_wait_ms": 3.449800145451188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011741161346435547, "StateBufferConnector_ms": 0.008079767227172852, "ViewRequirementAgentConnector_ms": 0.2009577751159668}, "num_episodes": 38, "episode_return_max": -12.842076720757042, "episode_return_min": -1436.12076731159, "episode_return_mean": -381.4506285133797, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 372.9852591462747, "num_env_steps_trained_throughput_per_sec": 372.9852591462747, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 11987.824, "restore_workers_time_ms": 0.037, "training_step_time_ms": 11987.74, "sample_time_ms": 1239.409, "learn_time_ms": 10682.869, "learn_throughput": 374.431, "synch_weights_time_ms": 64.625}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "training_iteration": 33, "trial_id": "b33d0_00000", "date": "2024-08-06_14-47-09", "timestamp": 1722935829, "time_this_iter_s": 10.736083984375, "time_total_s": 392.893274307251, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2abd90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 392.893274307251, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 19.39375, "ram_util_percent": 34.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 118.43459379871686, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.760468321914474, "policy_loss": -0.013706636943000679, "vf_loss": 3.7675524214903513, "vf_explained_var": 0.9315497258678078, "kl": 0.011518131128226135, "entropy": 1.1522081958130002, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "env_runners": {"episode_reward_max": -24.758881878330513, "episode_reward_min": -1467.9031263565926, "episode_reward_mean": -421.31731299158326, "episode_len_mean": 107.24, "episode_media": {}, "episodes_timesteps_total": 10724, "policy_reward_min": {"policy_0": -1467.9031263565926}, "policy_reward_max": {"policy_0": -24.758881878330513}, "policy_reward_mean": {"policy_0": -421.31731299158326}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-83.77220402153606, -1276.7722903686104, -453.40480563802936, -136.91969537631917, -445.3847828682001, -155.5274499901354, -157.00932918258505, -76.05604479336293, -1238.8162592786482, -95.13180671374413, -1319.0255533460638, -90.19328179074232, -213.4211477201568, -519.422648647069, -161.54283008451932, -193.49111032620203, -114.19999264056645, -459.9391823812697, -264.6081596777923, -450.4081203987172, -125.67197713934723, -171.6925564521312, -24.758881878330513, -530.0887769522105, -1008.0215945639521, -619.0383216553929, -1143.1499948359208, -43.59412665561569, -182.46268717452025, -93.76095987957542, -447.37708281842174, -60.38996686174943, -609.6937460761457, -543.2020096542906, -409.65056568837537, -587.6144062024089, -298.9830976544636, -585.1233642029117, -234.4450217573452, -41.33639781096526, -84.1727537496312, -167.9663345092443, -92.0601487227851, -362.9488870643, -1112.452476033127, -122.1204631721819, -322.2165390428199, -122.29030531224828, -59.596012822741635, -523.5751676728166, -282.58709097032323, -624.5791883172448, -363.7317036899364, -143.2978635081088, -146.30787156480287, -413.96891315990206, -152.1117940930126, -1296.0690566979306, -568.1598091689776, -184.3924777946465, -48.491829819385984, -417.40896932091056, -489.9048637496691, -1297.3907690424332, -208.5816249529056, -149.41719389660537, -462.7676418492587, -507.169440824821, -256.40900656035393, -572.4903282331013, -139.50400346062438, -324.072652893013, -933.6993403670759, -160.34283310068702, -1344.86879655345, -289.6765157913204, -1467.9031263565926, -145.9121593526626, -141.8359851037349, -742.6312279077016, -533.9511081491796, -90.21050897290642, -110.37805253594624, -690.2184862394392, -1260.9523558797368, -484.17295468588486, -111.34010939268491, -486.3367615266356, -149.30486954367504, -170.58443777024792, -332.07458751745537, -367.6831964892306, -234.7046840279495, -1289.748662912008, -92.00891244235551, -567.6029201457429, -330.42867370369635, -197.06114480390139, -442.011764419932, -1280.771710638277], "episode_lengths": [55, 150, 150, 51, 124, 74, 81, 60, 150, 62, 150, 49, 76, 120, 82, 77, 66, 149, 114, 148, 58, 79, 42, 150, 150, 150, 150, 42, 71, 58, 150, 49, 147, 150, 104, 150, 87, 150, 79, 52, 65, 103, 66, 150, 150, 74, 83, 89, 60, 150, 102, 150, 128, 71, 84, 150, 60, 150, 150, 73, 56, 150, 150, 150, 98, 66, 150, 150, 115, 120, 67, 99, 150, 88, 150, 99, 150, 53, 56, 150, 150, 69, 45, 150, 150, 141, 71, 150, 75, 80, 109, 127, 81, 150, 73, 150, 150, 72, 150, 150], "policy_policy_0_reward": [-83.77220402153606, -1276.7722903686104, -453.40480563802936, -136.91969537631917, -445.3847828682001, -155.5274499901354, -157.00932918258505, -76.05604479336293, -1238.8162592786482, -95.13180671374413, -1319.0255533460638, -90.19328179074232, -213.4211477201568, -519.422648647069, -161.54283008451932, -193.49111032620203, -114.19999264056645, -459.9391823812697, -264.6081596777923, -450.4081203987172, -125.67197713934723, -171.6925564521312, -24.758881878330513, -530.0887769522105, -1008.0215945639521, -619.0383216553929, -1143.1499948359208, -43.59412665561569, -182.46268717452025, -93.76095987957542, -447.37708281842174, -60.38996686174943, -609.6937460761457, -543.2020096542906, -409.65056568837537, -587.6144062024089, -298.9830976544636, -585.1233642029117, -234.4450217573452, -41.33639781096526, -84.1727537496312, -167.9663345092443, -92.0601487227851, -362.9488870643, -1112.452476033127, -122.1204631721819, -322.2165390428199, -122.29030531224828, -59.596012822741635, -523.5751676728166, -282.58709097032323, -624.5791883172448, -363.7317036899364, -143.2978635081088, -146.30787156480287, -413.96891315990206, -152.1117940930126, -1296.0690566979306, -568.1598091689776, -184.3924777946465, -48.491829819385984, -417.40896932091056, -489.9048637496691, -1297.3907690424332, -208.5816249529056, -149.41719389660537, -462.7676418492587, -507.169440824821, -256.40900656035393, -572.4903282331013, -139.50400346062438, -324.072652893013, -933.6993403670759, -160.34283310068702, -1344.86879655345, -289.6765157913204, -1467.9031263565926, -145.9121593526626, -141.8359851037349, -742.6312279077016, -533.9511081491796, -90.21050897290642, -110.37805253594624, -690.2184862394392, -1260.9523558797368, -484.17295468588486, -111.34010939268491, -486.3367615266356, -149.30486954367504, -170.58443777024792, -332.07458751745537, -367.6831964892306, -234.7046840279495, -1289.748662912008, -92.00891244235551, -567.6029201457429, -330.42867370369635, -197.06114480390139, -442.011764419932, -1280.771710638277]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5630859240458261, "mean_inference_ms": 1.7551497682360226, "mean_action_processing_ms": 0.27753820976677235, "mean_env_wait_ms": 3.4478497127930496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011575698852539062, "StateBufferConnector_ms": 0.007974863052368164, "ViewRequirementAgentConnector_ms": 0.19469404220581055}, "num_episodes": 36, "episode_return_max": -24.758881878330513, "episode_return_min": -1467.9031263565926, "episode_return_mean": -421.31731299158326, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.9204039135228, "num_env_steps_trained_throughput_per_sec": 323.9204039135228, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 11962.189, "restore_workers_time_ms": 0.036, "training_step_time_ms": 11962.106, "sample_time_ms": 1218.793, "learn_time_ms": 10677.786, "learn_throughput": 374.609, "synch_weights_time_ms": 64.693}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "training_iteration": 34, "trial_id": "b33d0_00000", "date": "2024-08-06_14-47-21", "timestamp": 1722935841, "time_this_iter_s": 12.361065864562988, "time_total_s": 405.25434017181396, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2abe20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 405.25434017181396, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 18.694117647058825, "ram_util_percent": 34.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 132.52941997547944, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.491349711890022, "policy_loss": -0.014424692620135222, "vf_loss": 3.497821596513192, "vf_explained_var": 0.9653626553714275, "kl": 0.013573962788177596, "entropy": 1.209619010426104, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "env_runners": {"episode_reward_max": -41.33639781096526, "episode_reward_min": -1467.9031263565926, "episode_reward_mean": -455.8958409496335, "episode_len_mean": 112.82, "episode_media": {}, "episodes_timesteps_total": 11282, "policy_reward_min": {"policy_0": -1467.9031263565926}, "policy_reward_max": {"policy_0": -41.33639781096526}, "policy_reward_mean": {"policy_0": -455.8958409496335}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-587.6144062024089, -298.9830976544636, -585.1233642029117, -234.4450217573452, -41.33639781096526, -84.1727537496312, -167.9663345092443, -92.0601487227851, -362.9488870643, -1112.452476033127, -122.1204631721819, -322.2165390428199, -122.29030531224828, -59.596012822741635, -523.5751676728166, -282.58709097032323, -624.5791883172448, -363.7317036899364, -143.2978635081088, -146.30787156480287, -413.96891315990206, -152.1117940930126, -1296.0690566979306, -568.1598091689776, -184.3924777946465, -48.491829819385984, -417.40896932091056, -489.9048637496691, -1297.3907690424332, -208.5816249529056, -149.41719389660537, -462.7676418492587, -507.169440824821, -256.40900656035393, -572.4903282331013, -139.50400346062438, -324.072652893013, -933.6993403670759, -160.34283310068702, -1344.86879655345, -289.6765157913204, -1467.9031263565926, -145.9121593526626, -141.8359851037349, -742.6312279077016, -533.9511081491796, -90.21050897290642, -110.37805253594624, -690.2184862394392, -1260.9523558797368, -484.17295468588486, -111.34010939268491, -486.3367615266356, -149.30486954367504, -170.58443777024792, -332.07458751745537, -367.6831964892306, -234.7046840279495, -1289.748662912008, -92.00891244235551, -567.6029201457429, -330.42867370369635, -197.06114480390139, -442.011764419932, -1280.771710638277, -102.63227626152722, -158.0279879404421, -465.0862698122312, -456.56264568409574, -848.7907007506124, -250.93327135653172, -663.5026015682623, -149.7734242940838, -804.1181275663128, -1087.5074698197825, -164.9257854486349, -138.58131438197327, -1091.4297792410982, -183.61745250353752, -510.23343830905156, -456.8288662553865, -747.7126047058365, -429.55754364772037, -42.157278628492016, -311.9706000724437, -165.74458107244493, -61.989289200424764, -1342.1259240912545, -230.39060486973625, -209.55448479347677, -475.678161834928, -209.6042328839049, -529.2107776496571, -944.9540058396212, -1232.5021515011886, -220.6344465973746, -873.7493314174139, -509.9194152163101, -120.96448603288752, -1184.4814080866042], "episode_lengths": [150, 87, 150, 79, 52, 65, 103, 66, 150, 150, 74, 83, 89, 60, 150, 102, 150, 128, 71, 84, 150, 60, 150, 150, 73, 56, 150, 150, 150, 98, 66, 150, 150, 115, 120, 67, 99, 150, 88, 150, 99, 150, 53, 56, 150, 150, 69, 45, 150, 150, 141, 71, 150, 75, 80, 109, 127, 81, 150, 73, 150, 150, 72, 150, 150, 55, 83, 150, 150, 150, 87, 138, 82, 150, 150, 78, 74, 150, 86, 150, 150, 150, 150, 50, 141, 73, 55, 150, 91, 72, 150, 87, 150, 150, 150, 98, 150, 150, 46, 150], "policy_policy_0_reward": [-587.6144062024089, -298.9830976544636, -585.1233642029117, -234.4450217573452, -41.33639781096526, -84.1727537496312, -167.9663345092443, -92.0601487227851, -362.9488870643, -1112.452476033127, -122.1204631721819, -322.2165390428199, -122.29030531224828, -59.596012822741635, -523.5751676728166, -282.58709097032323, -624.5791883172448, -363.7317036899364, -143.2978635081088, -146.30787156480287, -413.96891315990206, -152.1117940930126, -1296.0690566979306, -568.1598091689776, -184.3924777946465, -48.491829819385984, -417.40896932091056, -489.9048637496691, -1297.3907690424332, -208.5816249529056, -149.41719389660537, -462.7676418492587, -507.169440824821, -256.40900656035393, -572.4903282331013, -139.50400346062438, -324.072652893013, -933.6993403670759, -160.34283310068702, -1344.86879655345, -289.6765157913204, -1467.9031263565926, -145.9121593526626, -141.8359851037349, -742.6312279077016, -533.9511081491796, -90.21050897290642, -110.37805253594624, -690.2184862394392, -1260.9523558797368, -484.17295468588486, -111.34010939268491, -486.3367615266356, -149.30486954367504, -170.58443777024792, -332.07458751745537, -367.6831964892306, -234.7046840279495, -1289.748662912008, -92.00891244235551, -567.6029201457429, -330.42867370369635, -197.06114480390139, -442.011764419932, -1280.771710638277, -102.63227626152722, -158.0279879404421, -465.0862698122312, -456.56264568409574, -848.7907007506124, -250.93327135653172, -663.5026015682623, -149.7734242940838, -804.1181275663128, -1087.5074698197825, -164.9257854486349, -138.58131438197327, -1091.4297792410982, -183.61745250353752, -510.23343830905156, -456.8288662553865, -747.7126047058365, -429.55754364772037, -42.157278628492016, -311.9706000724437, -165.74458107244493, -61.989289200424764, -1342.1259240912545, -230.39060486973625, -209.55448479347677, -475.678161834928, -209.6042328839049, -529.2107776496571, -944.9540058396212, -1232.5021515011886, -220.6344465973746, -873.7493314174139, -509.9194152163101, -120.96448603288752, -1184.4814080866042]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5628069090308098, "mean_inference_ms": 1.7511990934392634, "mean_action_processing_ms": 0.2772822351547395, "mean_env_wait_ms": 3.4449047582572008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011475324630737305, "StateBufferConnector_ms": 0.007993936538696289, "ViewRequirementAgentConnector_ms": 0.18969464302062988}, "num_episodes": 35, "episode_return_max": -41.33639781096526, "episode_return_min": -1467.9031263565926, "episode_return_mean": -455.8958409496335, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 335.0201340973859, "num_env_steps_trained_throughput_per_sec": 335.0201340973859, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 11996.98, "restore_workers_time_ms": 0.037, "training_step_time_ms": 11996.896, "sample_time_ms": 1210.817, "learn_time_ms": 10720.05, "learn_throughput": 373.133, "synch_weights_time_ms": 65.195}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "training_iteration": 35, "trial_id": "b33d0_00000", "date": "2024-08-06_14-47-33", "timestamp": 1722935853, "time_this_iter_s": 11.94926643371582, "time_total_s": 417.2036066055298, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2a8310>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 417.2036066055298, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 20.66470588235294, "ram_util_percent": 33.95294117647059}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 151.73066226840018, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.8078019923220077, "policy_loss": -0.012965788352448725, "vf_loss": 3.812153841679295, "vf_explained_var": 0.9449630027636886, "kl": 0.014272328407605558, "entropy": 1.0198876101523637, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": -34.655868411995414, "episode_reward_min": -1467.9031263565926, "episode_reward_mean": -440.72675100897794, "episode_len_mean": 110.14, "episode_media": {}, "episodes_timesteps_total": 11014, "policy_reward_min": {"policy_0": -1467.9031263565926}, "policy_reward_max": {"policy_0": -34.655868411995414}, "policy_reward_mean": {"policy_0": -440.72675100897794}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1344.86879655345, -289.6765157913204, -1467.9031263565926, -145.9121593526626, -141.8359851037349, -742.6312279077016, -533.9511081491796, -90.21050897290642, -110.37805253594624, -690.2184862394392, -1260.9523558797368, -484.17295468588486, -111.34010939268491, -486.3367615266356, -149.30486954367504, -170.58443777024792, -332.07458751745537, -367.6831964892306, -234.7046840279495, -1289.748662912008, -92.00891244235551, -567.6029201457429, -330.42867370369635, -197.06114480390139, -442.011764419932, -1280.771710638277, -102.63227626152722, -158.0279879404421, -465.0862698122312, -456.56264568409574, -848.7907007506124, -250.93327135653172, -663.5026015682623, -149.7734242940838, -804.1181275663128, -1087.5074698197825, -164.9257854486349, -138.58131438197327, -1091.4297792410982, -183.61745250353752, -510.23343830905156, -456.8288662553865, -747.7126047058365, -429.55754364772037, -42.157278628492016, -311.9706000724437, -165.74458107244493, -61.989289200424764, -1342.1259240912545, -230.39060486973625, -209.55448479347677, -475.678161834928, -209.6042328839049, -529.2107776496571, -944.9540058396212, -1232.5021515011886, -220.6344465973746, -873.7493314174139, -509.9194152163101, -120.96448603288752, -1184.4814080866042, -244.8609645187389, -607.0674339690731, -426.88884263843283, -427.98694791527294, -465.7288662553021, -870.1505079128444, -976.5795465248809, -77.28204209214522, -45.61217404452785, -322.50530959171596, -169.63159989895203, -600.4358974719794, -466.86489815215344, -405.4665802701101, -55.58048778884865, -351.59480904803144, -182.39275577132088, -209.68295556454558, -260.8803134835865, -339.2605865642868, -385.19046573391057, -563.4528756991182, -129.70218476654873, -208.47816276569912, -156.8747041945817, -335.259924455674, -156.79245611308303, -137.57206960803725, -601.0145740441361, -650.5692248475289, -214.17767427043515, -1025.4056002017885, -186.9117304489715, -193.66445456638957, -173.79768903155266, -225.9837743550961, -95.96065128203995, -34.655868411995414, -360.9310444268301], "episode_lengths": [150, 99, 150, 53, 56, 150, 150, 69, 45, 150, 150, 141, 71, 150, 75, 80, 109, 127, 81, 150, 73, 150, 150, 72, 150, 150, 55, 83, 150, 150, 150, 87, 138, 82, 150, 150, 78, 74, 150, 86, 150, 150, 150, 150, 50, 141, 73, 55, 150, 91, 72, 150, 87, 150, 150, 150, 98, 150, 150, 46, 150, 106, 150, 123, 129, 150, 150, 150, 63, 53, 88, 66, 150, 150, 96, 43, 111, 73, 83, 99, 92, 139, 150, 70, 94, 53, 85, 60, 76, 150, 127, 66, 150, 88, 93, 89, 98, 53, 51, 150], "policy_policy_0_reward": [-1344.86879655345, -289.6765157913204, -1467.9031263565926, -145.9121593526626, -141.8359851037349, -742.6312279077016, -533.9511081491796, -90.21050897290642, -110.37805253594624, -690.2184862394392, -1260.9523558797368, -484.17295468588486, -111.34010939268491, -486.3367615266356, -149.30486954367504, -170.58443777024792, -332.07458751745537, -367.6831964892306, -234.7046840279495, -1289.748662912008, -92.00891244235551, -567.6029201457429, -330.42867370369635, -197.06114480390139, -442.011764419932, -1280.771710638277, -102.63227626152722, -158.0279879404421, -465.0862698122312, -456.56264568409574, -848.7907007506124, -250.93327135653172, -663.5026015682623, -149.7734242940838, -804.1181275663128, -1087.5074698197825, -164.9257854486349, -138.58131438197327, -1091.4297792410982, -183.61745250353752, -510.23343830905156, -456.8288662553865, -747.7126047058365, -429.55754364772037, -42.157278628492016, -311.9706000724437, -165.74458107244493, -61.989289200424764, -1342.1259240912545, -230.39060486973625, -209.55448479347677, -475.678161834928, -209.6042328839049, -529.2107776496571, -944.9540058396212, -1232.5021515011886, -220.6344465973746, -873.7493314174139, -509.9194152163101, -120.96448603288752, -1184.4814080866042, -244.8609645187389, -607.0674339690731, -426.88884263843283, -427.98694791527294, -465.7288662553021, -870.1505079128444, -976.5795465248809, -77.28204209214522, -45.61217404452785, -322.50530959171596, -169.63159989895203, -600.4358974719794, -466.86489815215344, -405.4665802701101, -55.58048778884865, -351.59480904803144, -182.39275577132088, -209.68295556454558, -260.8803134835865, -339.2605865642868, -385.19046573391057, -563.4528756991182, -129.70218476654873, -208.47816276569912, -156.8747041945817, -335.259924455674, -156.79245611308303, -137.57206960803725, -601.0145740441361, -650.5692248475289, -214.17767427043515, -1025.4056002017885, -186.9117304489715, -193.66445456638957, -173.79768903155266, -225.9837743550961, -95.96065128203995, -34.655868411995414, -360.9310444268301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5632726433864894, "mean_inference_ms": 1.7490961764775939, "mean_action_processing_ms": 0.2772188923937393, "mean_env_wait_ms": 3.4440056781437893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01168203353881836, "StateBufferConnector_ms": 0.008071422576904297, "ViewRequirementAgentConnector_ms": 0.19581270217895508}, "num_episodes": 39, "episode_return_max": -34.655868411995414, "episode_return_min": -1467.9031263565926, "episode_return_mean": -440.72675100897794, "episodes_this_iter": 39}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 386.2112325640316, "num_env_steps_trained_throughput_per_sec": 386.2112325640316, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 11782.013, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11781.94, "sample_time_ms": 1204.516, "learn_time_ms": 10510.515, "learn_throughput": 380.571, "synch_weights_time_ms": 66.075}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 36, "trial_id": "b33d0_00000", "date": "2024-08-06_14-47-43", "timestamp": 1722935863, "time_this_iter_s": 10.368937015533447, "time_total_s": 427.57254362106323, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2a80d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 427.57254362106323, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 21.439999999999994, "ram_util_percent": 32.97333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 115.6222012201945, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.6807082099219164, "policy_loss": -0.0127319423656445, "vf_loss": 3.686222775032123, "vf_explained_var": 0.9640693162257473, "kl": 0.012562802665191499, "entropy": 1.2625239217032989, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "env_runners": {"episode_reward_max": -2.8269112578328532, "episode_reward_min": -1550.8356609711855, "episode_reward_mean": -438.16876392400496, "episode_len_mean": 107.27, "episode_media": {}, "episodes_timesteps_total": 10727, "policy_reward_min": {"policy_0": -1550.8356609711855}, "policy_reward_max": {"policy_0": -2.8269112578328532}, "policy_reward_mean": {"policy_0": -438.16876392400496}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1087.5074698197825, -164.9257854486349, -138.58131438197327, -1091.4297792410982, -183.61745250353752, -510.23343830905156, -456.8288662553865, -747.7126047058365, -429.55754364772037, -42.157278628492016, -311.9706000724437, -165.74458107244493, -61.989289200424764, -1342.1259240912545, -230.39060486973625, -209.55448479347677, -475.678161834928, -209.6042328839049, -529.2107776496571, -944.9540058396212, -1232.5021515011886, -220.6344465973746, -873.7493314174139, -509.9194152163101, -120.96448603288752, -1184.4814080866042, -244.8609645187389, -607.0674339690731, -426.88884263843283, -427.98694791527294, -465.7288662553021, -870.1505079128444, -976.5795465248809, -77.28204209214522, -45.61217404452785, -322.50530959171596, -169.63159989895203, -600.4358974719794, -466.86489815215344, -405.4665802701101, -55.58048778884865, -351.59480904803144, -182.39275577132088, -209.68295556454558, -260.8803134835865, -339.2605865642868, -385.19046573391057, -563.4528756991182, -129.70218476654873, -208.47816276569912, -156.8747041945817, -335.259924455674, -156.79245611308303, -137.57206960803725, -601.0145740441361, -650.5692248475289, -214.17767427043515, -1025.4056002017885, -186.9117304489715, -193.66445456638957, -173.79768903155266, -225.9837743550961, -95.96065128203995, -34.655868411995414, -360.9310444268301, -188.0838434963828, -1550.8356609711855, -105.72134329644685, -114.83106203148793, -427.5905500659672, -1277.1023711140554, -30.241971885209686, -503.0988870201272, -329.395419913615, -510.32850004624777, -1335.098276935274, -128.77228916688674, -2.8269112578328532, -164.49854803082096, -1087.7532573889623, -508.598239239243, -700.8072619474129, -1099.3719030867132, -172.91874615412976, -76.72967399379927, -232.53005660600064, -1057.5670978291625, -1363.2656502736252, -421.9418554187333, -195.62220044881664, -875.6544626113179, -1259.6080613663996, -125.7221946252473, -268.7069865989097, -44.88462340461787, -11.579692143017708, -191.64099955796968, -141.5563804842422, -391.7691641922169, -101.34816699707564], "episode_lengths": [150, 78, 74, 150, 86, 150, 150, 150, 150, 50, 141, 73, 55, 150, 91, 72, 150, 87, 150, 150, 150, 98, 150, 150, 46, 150, 106, 150, 123, 129, 150, 150, 150, 63, 53, 88, 66, 150, 150, 96, 43, 111, 73, 83, 99, 92, 139, 150, 70, 94, 53, 85, 60, 76, 150, 127, 66, 150, 88, 93, 89, 98, 53, 51, 150, 83, 150, 76, 71, 150, 150, 46, 149, 107, 150, 150, 76, 30, 60, 150, 150, 150, 150, 59, 60, 109, 150, 150, 137, 71, 150, 150, 64, 146, 37, 45, 78, 80, 104, 71], "policy_policy_0_reward": [-1087.5074698197825, -164.9257854486349, -138.58131438197327, -1091.4297792410982, -183.61745250353752, -510.23343830905156, -456.8288662553865, -747.7126047058365, -429.55754364772037, -42.157278628492016, -311.9706000724437, -165.74458107244493, -61.989289200424764, -1342.1259240912545, -230.39060486973625, -209.55448479347677, -475.678161834928, -209.6042328839049, -529.2107776496571, -944.9540058396212, -1232.5021515011886, -220.6344465973746, -873.7493314174139, -509.9194152163101, -120.96448603288752, -1184.4814080866042, -244.8609645187389, -607.0674339690731, -426.88884263843283, -427.98694791527294, -465.7288662553021, -870.1505079128444, -976.5795465248809, -77.28204209214522, -45.61217404452785, -322.50530959171596, -169.63159989895203, -600.4358974719794, -466.86489815215344, -405.4665802701101, -55.58048778884865, -351.59480904803144, -182.39275577132088, -209.68295556454558, -260.8803134835865, -339.2605865642868, -385.19046573391057, -563.4528756991182, -129.70218476654873, -208.47816276569912, -156.8747041945817, -335.259924455674, -156.79245611308303, -137.57206960803725, -601.0145740441361, -650.5692248475289, -214.17767427043515, -1025.4056002017885, -186.9117304489715, -193.66445456638957, -173.79768903155266, -225.9837743550961, -95.96065128203995, -34.655868411995414, -360.9310444268301, -188.0838434963828, -1550.8356609711855, -105.72134329644685, -114.83106203148793, -427.5905500659672, -1277.1023711140554, -30.241971885209686, -503.0988870201272, -329.395419913615, -510.32850004624777, -1335.098276935274, -128.77228916688674, -2.8269112578328532, -164.49854803082096, -1087.7532573889623, -508.598239239243, -700.8072619474129, -1099.3719030867132, -172.91874615412976, -76.72967399379927, -232.53005660600064, -1057.5670978291625, -1363.2656502736252, -421.9418554187333, -195.62220044881664, -875.6544626113179, -1259.6080613663996, -125.7221946252473, -268.7069865989097, -44.88462340461787, -11.579692143017708, -191.64099955796968, -141.5563804842422, -391.7691641922169, -101.34816699707564]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5630277767053053, "mean_inference_ms": 1.749434985806466, "mean_action_processing_ms": 0.27737031737388745, "mean_env_wait_ms": 3.44646349099517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012127161026000977, "StateBufferConnector_ms": 0.008063554763793945, "ViewRequirementAgentConnector_ms": 0.20001816749572754}, "num_episodes": 35, "episode_return_max": -2.8269112578328532, "episode_return_min": -1550.8356609711855, "episode_return_mean": -438.16876392400496, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 356.0206104356007, "num_env_steps_trained_throughput_per_sec": 356.0206104356007, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 11670.191, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11670.118, "sample_time_ms": 1215.279, "learn_time_ms": 10386.203, "learn_throughput": 385.126, "synch_weights_time_ms": 67.816}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "training_iteration": 37, "trial_id": "b33d0_00000", "date": "2024-08-06_14-47-55", "timestamp": 1722935875, "time_this_iter_s": 11.248945236206055, "time_total_s": 438.8214888572693, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2320e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 438.8214888572693, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 20.4125, "ram_util_percent": 30.9375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 145.59220491250355, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.449041539058089, "policy_loss": -0.017427041967069574, "vf_loss": 3.456738267590602, "vf_explained_var": 0.9701797651747862, "kl": 0.01601521170080866, "entropy": 1.0799536532411973, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "env_runners": {"episode_reward_max": -2.8269112578328532, "episode_reward_min": -1550.8356609711855, "episode_reward_mean": -395.711159705465, "episode_len_mean": 100.78, "episode_media": {}, "episodes_timesteps_total": 10078, "policy_reward_min": {"policy_0": -1550.8356609711855}, "policy_reward_max": {"policy_0": -2.8269112578328532}, "policy_reward_mean": {"policy_0": -395.711159705465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-405.4665802701101, -55.58048778884865, -351.59480904803144, -182.39275577132088, -209.68295556454558, -260.8803134835865, -339.2605865642868, -385.19046573391057, -563.4528756991182, -129.70218476654873, -208.47816276569912, -156.8747041945817, -335.259924455674, -156.79245611308303, -137.57206960803725, -601.0145740441361, -650.5692248475289, -214.17767427043515, -1025.4056002017885, -186.9117304489715, -193.66445456638957, -173.79768903155266, -225.9837743550961, -95.96065128203995, -34.655868411995414, -360.9310444268301, -188.0838434963828, -1550.8356609711855, -105.72134329644685, -114.83106203148793, -427.5905500659672, -1277.1023711140554, -30.241971885209686, -503.0988870201272, -329.395419913615, -510.32850004624777, -1335.098276935274, -128.77228916688674, -2.8269112578328532, -164.49854803082096, -1087.7532573889623, -508.598239239243, -700.8072619474129, -1099.3719030867132, -172.91874615412976, -76.72967399379927, -232.53005660600064, -1057.5670978291625, -1363.2656502736252, -421.9418554187333, -195.62220044881664, -875.6544626113179, -1259.6080613663996, -125.7221946252473, -268.7069865989097, -44.88462340461787, -11.579692143017708, -191.64099955796968, -141.5563804842422, -391.7691641922169, -101.34816699707564, -463.4187757236714, -52.95564211485831, -116.4261178814642, -81.6486605194282, -138.56603517585037, -161.4671613219175, -46.20477381211428, -28.20034053874439, -517.3613160092248, -1084.0037657272883, -486.0438277511565, -1037.0031462352267, -143.23681292662886, -435.3871458551878, -512.6570660284297, -1075.0430133410196, -79.11446019928655, -230.79808373411956, -97.31435931862652, -393.2444160938532, -1133.910235937302, -346.5935634622763, -195.08784741480423, -311.1079892186231, -205.8811648300196, -459.5660480471898, -1058.2618662811874, -788.7964105341985, -270.99714500474954, -892.4580996706019, -345.1989175313613, -199.35250645424628, -598.2758114319506, -237.52326925207666, -5.930190730975889, -101.50044411185276, -381.1516602317454, -159.14809386492328, -61.02385891501865], "episode_lengths": [96, 43, 111, 73, 83, 99, 92, 139, 150, 70, 94, 53, 85, 60, 76, 150, 127, 66, 150, 88, 93, 89, 98, 53, 51, 150, 83, 150, 76, 71, 150, 150, 46, 149, 107, 150, 150, 76, 30, 60, 150, 150, 150, 150, 59, 60, 109, 150, 150, 137, 71, 150, 150, 64, 146, 37, 45, 78, 80, 104, 71, 144, 56, 69, 62, 75, 62, 49, 41, 150, 150, 150, 150, 70, 110, 150, 150, 42, 110, 48, 103, 150, 125, 70, 98, 77, 108, 150, 150, 75, 150, 146, 75, 150, 82, 34, 69, 150, 77, 53], "policy_policy_0_reward": [-405.4665802701101, -55.58048778884865, -351.59480904803144, -182.39275577132088, -209.68295556454558, -260.8803134835865, -339.2605865642868, -385.19046573391057, -563.4528756991182, -129.70218476654873, -208.47816276569912, -156.8747041945817, -335.259924455674, -156.79245611308303, -137.57206960803725, -601.0145740441361, -650.5692248475289, -214.17767427043515, -1025.4056002017885, -186.9117304489715, -193.66445456638957, -173.79768903155266, -225.9837743550961, -95.96065128203995, -34.655868411995414, -360.9310444268301, -188.0838434963828, -1550.8356609711855, -105.72134329644685, -114.83106203148793, -427.5905500659672, -1277.1023711140554, -30.241971885209686, -503.0988870201272, -329.395419913615, -510.32850004624777, -1335.098276935274, -128.77228916688674, -2.8269112578328532, -164.49854803082096, -1087.7532573889623, -508.598239239243, -700.8072619474129, -1099.3719030867132, -172.91874615412976, -76.72967399379927, -232.53005660600064, -1057.5670978291625, -1363.2656502736252, -421.9418554187333, -195.62220044881664, -875.6544626113179, -1259.6080613663996, -125.7221946252473, -268.7069865989097, -44.88462340461787, -11.579692143017708, -191.64099955796968, -141.5563804842422, -391.7691641922169, -101.34816699707564, -463.4187757236714, -52.95564211485831, -116.4261178814642, -81.6486605194282, -138.56603517585037, -161.4671613219175, -46.20477381211428, -28.20034053874439, -517.3613160092248, -1084.0037657272883, -486.0438277511565, -1037.0031462352267, -143.23681292662886, -435.3871458551878, -512.6570660284297, -1075.0430133410196, -79.11446019928655, -230.79808373411956, -97.31435931862652, -393.2444160938532, -1133.910235937302, -346.5935634622763, -195.08784741480423, -311.1079892186231, -205.8811648300196, -459.5660480471898, -1058.2618662811874, -788.7964105341985, -270.99714500474954, -892.4580996706019, -345.1989175313613, -199.35250645424628, -598.2758114319506, -237.52326925207666, -5.930190730975889, -101.50044411185276, -381.1516602317454, -159.14809386492328, -61.02385891501865]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5633710781938083, "mean_inference_ms": 1.7492786484694165, "mean_action_processing_ms": 0.2774763979976856, "mean_env_wait_ms": 3.447684343843861, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012471199035644531, "StateBufferConnector_ms": 0.00803995132446289, "ViewRequirementAgentConnector_ms": 0.1982560157775879}, "num_episodes": 39, "episode_return_max": -2.8269112578328532, "episode_return_min": -1550.8356609711855, "episode_return_mean": -395.711159705465, "episodes_this_iter": 39}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 339.9254560386634, "num_env_steps_trained_throughput_per_sec": 339.9254560386634, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 11802.598, "restore_workers_time_ms": 0.032, "training_step_time_ms": 11802.522, "sample_time_ms": 1193.429, "learn_time_ms": 10540.023, "learn_throughput": 379.506, "synch_weights_time_ms": 68.253}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "training_iteration": 38, "trial_id": "b33d0_00000", "date": "2024-08-06_14-48-07", "timestamp": 1722935887, "time_this_iter_s": 11.780692338943481, "time_total_s": 450.60218119621277, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c124e50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 450.60218119621277, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 18.49411764705882, "ram_util_percent": 29.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 110.01495217680932, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.7208903598288696, "policy_loss": -0.015865640994161368, "vf_loss": 3.72667020658652, "vf_explained_var": 0.9357252155741056, "kl": 0.016258856389352663, "entropy": 0.8889305038377643, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "env_runners": {"episode_reward_max": -2.8269112578328532, "episode_reward_min": -1363.2656502736252, "episode_reward_mean": -423.2896114575049, "episode_len_mean": 105.11, "episode_media": {}, "episodes_timesteps_total": 10511, "policy_reward_min": {"policy_0": -1363.2656502736252}, "policy_reward_max": {"policy_0": -2.8269112578328532}, "policy_reward_mean": {"policy_0": -423.2896114575049}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1335.098276935274, -128.77228916688674, -2.8269112578328532, -164.49854803082096, -1087.7532573889623, -508.598239239243, -700.8072619474129, -1099.3719030867132, -172.91874615412976, -76.72967399379927, -232.53005660600064, -1057.5670978291625, -1363.2656502736252, -421.9418554187333, -195.62220044881664, -875.6544626113179, -1259.6080613663996, -125.7221946252473, -268.7069865989097, -44.88462340461787, -11.579692143017708, -191.64099955796968, -141.5563804842422, -391.7691641922169, -101.34816699707564, -463.4187757236714, -52.95564211485831, -116.4261178814642, -81.6486605194282, -138.56603517585037, -161.4671613219175, -46.20477381211428, -28.20034053874439, -517.3613160092248, -1084.0037657272883, -486.0438277511565, -1037.0031462352267, -143.23681292662886, -435.3871458551878, -512.6570660284297, -1075.0430133410196, -79.11446019928655, -230.79808373411956, -97.31435931862652, -393.2444160938532, -1133.910235937302, -346.5935634622763, -195.08784741480423, -311.1079892186231, -205.8811648300196, -459.5660480471898, -1058.2618662811874, -788.7964105341985, -270.99714500474954, -892.4580996706019, -345.1989175313613, -199.35250645424628, -598.2758114319506, -237.52326925207666, -5.930190730975889, -101.50044411185276, -381.1516602317454, -159.14809386492328, -61.02385891501865, -598.6286109747008, -95.228235571489, -418.0941440888181, -373.9152506420567, -671.0292924227074, -41.16577896209469, -97.16885681351556, -518.4010832677702, -613.6359623513373, -102.68506847100811, -1012.4212850825554, -160.63355848128245, -371.92805975637725, -494.6224070373356, -321.2395735098519, -488.986005794897, -171.1256666344884, -1083.3300242386201, -450.32921830866434, -1056.7099588495, -122.41887881305205, -340.76009688030854, -431.13549596539474, -30.765947261932734, -123.47272070181205, -1060.210124102069, -462.78013005424447, -1080.8694594232197, -174.39376528985952, -1239.796122179879, -28.52825898389833, -261.46018100767617, -145.62014794843213, -240.87520800139777, -380.5263771072474, -171.4374477793777], "episode_lengths": [150, 76, 30, 60, 150, 150, 150, 150, 59, 60, 109, 150, 150, 137, 71, 150, 150, 64, 146, 37, 45, 78, 80, 104, 71, 144, 56, 69, 62, 75, 62, 49, 41, 150, 150, 150, 150, 70, 110, 150, 150, 42, 110, 48, 103, 150, 125, 70, 98, 77, 108, 150, 150, 75, 150, 146, 75, 150, 82, 34, 69, 150, 77, 53, 150, 60, 125, 150, 121, 55, 66, 150, 150, 79, 150, 84, 126, 150, 150, 107, 85, 150, 105, 150, 71, 113, 150, 46, 70, 150, 150, 150, 87, 150, 39, 93, 76, 128, 112, 56], "policy_policy_0_reward": [-1335.098276935274, -128.77228916688674, -2.8269112578328532, -164.49854803082096, -1087.7532573889623, -508.598239239243, -700.8072619474129, -1099.3719030867132, -172.91874615412976, -76.72967399379927, -232.53005660600064, -1057.5670978291625, -1363.2656502736252, -421.9418554187333, -195.62220044881664, -875.6544626113179, -1259.6080613663996, -125.7221946252473, -268.7069865989097, -44.88462340461787, -11.579692143017708, -191.64099955796968, -141.5563804842422, -391.7691641922169, -101.34816699707564, -463.4187757236714, -52.95564211485831, -116.4261178814642, -81.6486605194282, -138.56603517585037, -161.4671613219175, -46.20477381211428, -28.20034053874439, -517.3613160092248, -1084.0037657272883, -486.0438277511565, -1037.0031462352267, -143.23681292662886, -435.3871458551878, -512.6570660284297, -1075.0430133410196, -79.11446019928655, -230.79808373411956, -97.31435931862652, -393.2444160938532, -1133.910235937302, -346.5935634622763, -195.08784741480423, -311.1079892186231, -205.8811648300196, -459.5660480471898, -1058.2618662811874, -788.7964105341985, -270.99714500474954, -892.4580996706019, -345.1989175313613, -199.35250645424628, -598.2758114319506, -237.52326925207666, -5.930190730975889, -101.50044411185276, -381.1516602317454, -159.14809386492328, -61.02385891501865, -598.6286109747008, -95.228235571489, -418.0941440888181, -373.9152506420567, -671.0292924227074, -41.16577896209469, -97.16885681351556, -518.4010832677702, -613.6359623513373, -102.68506847100811, -1012.4212850825554, -160.63355848128245, -371.92805975637725, -494.6224070373356, -321.2395735098519, -488.986005794897, -171.1256666344884, -1083.3300242386201, -450.32921830866434, -1056.7099588495, -122.41887881305205, -340.76009688030854, -431.13549596539474, -30.765947261932734, -123.47272070181205, -1060.210124102069, -462.78013005424447, -1080.8694594232197, -174.39376528985952, -1239.796122179879, -28.52825898389833, -261.46018100767617, -145.62014794843213, -240.87520800139777, -380.5263771072474, -171.4374477793777]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5631420594142329, "mean_inference_ms": 1.7468903116699386, "mean_action_processing_ms": 0.27722600450599577, "mean_env_wait_ms": 3.448277796406931, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012057304382324219, "StateBufferConnector_ms": 0.008090019226074219, "ViewRequirementAgentConnector_ms": 0.19411826133728027}, "num_episodes": 36, "episode_return_max": -2.8269112578328532, "episode_return_min": -1363.2656502736252, "episode_return_mean": -423.2896114575049, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.74632516124365, "num_env_steps_trained_throughput_per_sec": 316.74632516124365, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 11860.274, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11860.2, "sample_time_ms": 1181.475, "learn_time_ms": 10611.393, "learn_throughput": 376.953, "synch_weights_time_ms": 66.513}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "training_iteration": 39, "trial_id": "b33d0_00000", "date": "2024-08-06_14-48-19", "timestamp": 1722935899, "time_this_iter_s": 12.6406569480896, "time_total_s": 463.24283814430237, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c124dc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 463.24283814430237, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 17.6, "ram_util_percent": 29.299999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 128.1040869295597, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.7681946021815143, "policy_loss": -0.0118802054557212, "vf_loss": 3.772086862723033, "vf_explained_var": 0.9477485483512282, "kl": 0.013126106173391843, "entropy": 0.8721589349831144, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": -5.930190730975889, "episode_reward_min": -1542.7031958775058, "episode_reward_mean": -407.37355832377864, "episode_len_mean": 107.42, "episode_media": {}, "episodes_timesteps_total": 10742, "policy_reward_min": {"policy_0": -1542.7031958775058}, "policy_reward_max": {"policy_0": -5.930190730975889}, "policy_reward_mean": {"policy_0": -407.37355832377864}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-435.3871458551878, -512.6570660284297, -1075.0430133410196, -79.11446019928655, -230.79808373411956, -97.31435931862652, -393.2444160938532, -1133.910235937302, -346.5935634622763, -195.08784741480423, -311.1079892186231, -205.8811648300196, -459.5660480471898, -1058.2618662811874, -788.7964105341985, -270.99714500474954, -892.4580996706019, -345.1989175313613, -199.35250645424628, -598.2758114319506, -237.52326925207666, -5.930190730975889, -101.50044411185276, -381.1516602317454, -159.14809386492328, -61.02385891501865, -598.6286109747008, -95.228235571489, -418.0941440888181, -373.9152506420567, -671.0292924227074, -41.16577896209469, -97.16885681351556, -518.4010832677702, -613.6359623513373, -102.68506847100811, -1012.4212850825554, -160.63355848128245, -371.92805975637725, -494.6224070373356, -321.2395735098519, -488.986005794897, -171.1256666344884, -1083.3300242386201, -450.32921830866434, -1056.7099588495, -122.41887881305205, -340.76009688030854, -431.13549596539474, -30.765947261932734, -123.47272070181205, -1060.210124102069, -462.78013005424447, -1080.8694594232197, -174.39376528985952, -1239.796122179879, -28.52825898389833, -261.46018100767617, -145.62014794843213, -240.87520800139777, -380.5263771072474, -171.4374477793777, -401.96526928197375, -224.3295401761343, -356.42633913263126, -28.511191630562116, -104.84149008722571, -515.3631194218208, -14.483155024377833, -493.40206817355704, -470.3155622579424, -187.28371055831664, -510.01208975476675, -747.3646931739079, -720.3936690210758, -455.94188816794804, -320.1408093768723, -492.5671314597283, -725.8028673426098, -45.86755623264708, -460.4223210333991, -53.92760869119129, -69.56021931756271, -113.60514589283223, -96.85716193216327, -403.8738009432702, -54.75856238240352, -56.878812375917555, -1186.7268781275186, -287.96971622588717, -687.3419533205434, -1542.7031958775058, -458.0868089590078, -46.68064306547469, -208.61129115985378, -59.69437495543242, -1330.5184669195335, -100.45219438930361, -167.4293229721003, -524.5931333083626], "episode_lengths": [110, 150, 150, 42, 110, 48, 103, 150, 125, 70, 98, 77, 108, 150, 150, 75, 150, 146, 75, 150, 82, 34, 69, 150, 77, 53, 150, 60, 125, 150, 121, 55, 66, 150, 150, 79, 150, 84, 126, 150, 150, 107, 85, 150, 105, 150, 71, 113, 150, 46, 70, 150, 150, 150, 87, 150, 39, 93, 76, 128, 112, 56, 150, 115, 150, 43, 65, 150, 39, 150, 107, 65, 150, 150, 150, 150, 123, 117, 150, 57, 150, 66, 66, 50, 71, 108, 59, 46, 150, 96, 150, 150, 150, 56, 81, 56, 150, 67, 83, 150], "policy_policy_0_reward": [-435.3871458551878, -512.6570660284297, -1075.0430133410196, -79.11446019928655, -230.79808373411956, -97.31435931862652, -393.2444160938532, -1133.910235937302, -346.5935634622763, -195.08784741480423, -311.1079892186231, -205.8811648300196, -459.5660480471898, -1058.2618662811874, -788.7964105341985, -270.99714500474954, -892.4580996706019, -345.1989175313613, -199.35250645424628, -598.2758114319506, -237.52326925207666, -5.930190730975889, -101.50044411185276, -381.1516602317454, -159.14809386492328, -61.02385891501865, -598.6286109747008, -95.228235571489, -418.0941440888181, -373.9152506420567, -671.0292924227074, -41.16577896209469, -97.16885681351556, -518.4010832677702, -613.6359623513373, -102.68506847100811, -1012.4212850825554, -160.63355848128245, -371.92805975637725, -494.6224070373356, -321.2395735098519, -488.986005794897, -171.1256666344884, -1083.3300242386201, -450.32921830866434, -1056.7099588495, -122.41887881305205, -340.76009688030854, -431.13549596539474, -30.765947261932734, -123.47272070181205, -1060.210124102069, -462.78013005424447, -1080.8694594232197, -174.39376528985952, -1239.796122179879, -28.52825898389833, -261.46018100767617, -145.62014794843213, -240.87520800139777, -380.5263771072474, -171.4374477793777, -401.96526928197375, -224.3295401761343, -356.42633913263126, -28.511191630562116, -104.84149008722571, -515.3631194218208, -14.483155024377833, -493.40206817355704, -470.3155622579424, -187.28371055831664, -510.01208975476675, -747.3646931739079, -720.3936690210758, -455.94188816794804, -320.1408093768723, -492.5671314597283, -725.8028673426098, -45.86755623264708, -460.4223210333991, -53.92760869119129, -69.56021931756271, -113.60514589283223, -96.85716193216327, -403.8738009432702, -54.75856238240352, -56.878812375917555, -1186.7268781275186, -287.96971622588717, -687.3419533205434, -1542.7031958775058, -458.0868089590078, -46.68064306547469, -208.61129115985378, -59.69437495543242, -1330.5184669195335, -100.45219438930361, -167.4293229721003, -524.5931333083626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5631332454390096, "mean_inference_ms": 1.7431582966588666, "mean_action_processing_ms": 0.2770963377007962, "mean_env_wait_ms": 3.4403339665600443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012403726577758789, "StateBufferConnector_ms": 0.008105993270874023, "ViewRequirementAgentConnector_ms": 0.19475150108337402}, "num_episodes": 38, "episode_return_max": -5.930190730975889, "episode_return_min": -1542.7031958775058, "episode_return_mean": -407.37355832377864, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.51546520285683, "num_env_steps_trained_throughput_per_sec": 308.51546520285683, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 11847.604, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11847.529, "sample_time_ms": 1169.631, "learn_time_ms": 10610.331, "learn_throughput": 376.991, "synch_weights_time_ms": 66.745}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 40, "trial_id": "b33d0_00000", "date": "2024-08-06_14-48-32", "timestamp": 1722935912, "time_this_iter_s": 12.978055238723755, "time_total_s": 476.2208933830261, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2ab910>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 476.2208933830261, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 17.683333333333334, "ram_util_percent": 29.299999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 113.49562354882558, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.2428744489947956, "policy_loss": -0.01053119557715642, "vf_loss": 3.242784775669376, "vf_explained_var": 0.9682567287857334, "kl": 0.01662637590270609, "entropy": 0.6019407314558823, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "env_runners": {"episode_reward_max": -14.483155024377833, "episode_reward_min": -1542.7031958775058, "episode_reward_mean": -360.92364563745645, "episode_len_mean": 101.97, "episode_media": {}, "episodes_timesteps_total": 10197, "policy_reward_min": {"policy_0": -1542.7031958775058}, "policy_reward_max": {"policy_0": -14.483155024377833}, "policy_reward_mean": {"policy_0": -360.92364563745645}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1056.7099588495, -122.41887881305205, -340.76009688030854, -431.13549596539474, -30.765947261932734, -123.47272070181205, -1060.210124102069, -462.78013005424447, -1080.8694594232197, -174.39376528985952, -1239.796122179879, -28.52825898389833, -261.46018100767617, -145.62014794843213, -240.87520800139777, -380.5263771072474, -171.4374477793777, -401.96526928197375, -224.3295401761343, -356.42633913263126, -28.511191630562116, -104.84149008722571, -515.3631194218208, -14.483155024377833, -493.40206817355704, -470.3155622579424, -187.28371055831664, -510.01208975476675, -747.3646931739079, -720.3936690210758, -455.94188816794804, -320.1408093768723, -492.5671314597283, -725.8028673426098, -45.86755623264708, -460.4223210333991, -53.92760869119129, -69.56021931756271, -113.60514589283223, -96.85716193216327, -403.8738009432702, -54.75856238240352, -56.878812375917555, -1186.7268781275186, -287.96971622588717, -687.3419533205434, -1542.7031958775058, -458.0868089590078, -46.68064306547469, -208.61129115985378, -59.69437495543242, -1330.5184669195335, -100.45219438930361, -167.4293229721003, -524.5931333083626, -234.31649767858252, -729.8347528527587, -196.1015971725714, -158.56379735694193, -482.577576870803, -323.32055864613505, -506.29155130727435, -182.5039126440674, -478.17444400987216, -398.73481546325246, -93.36804378761902, -191.67251866984546, -203.0816659616205, -42.21074604090455, -1007.3363160599536, -112.26447279160062, -130.1715892517489, -1261.9615838747818, -35.90625623846502, -421.1498407877197, -146.4820575867697, -297.08021585357557, -160.96210595060043, -48.242300517800274, -488.81235849111334, -361.1317350386819, -143.15746420580558, -399.91105482493157, -186.55234327509424, -123.45356901005495, -337.5793379249932, -98.07576454383212, -116.68391208956793, -925.4389458147501, -162.88441048892426, -203.4138835429791, -443.21368037028896, -27.149192030630875, -658.4726937135085, -392.7112877154305, -617.7237296675721, -117.94337252562909, -193.77647444203694, -79.57892439311405, -94.92712978878114], "episode_lengths": [150, 71, 113, 150, 46, 70, 150, 150, 150, 87, 150, 39, 93, 76, 128, 112, 56, 150, 115, 150, 43, 65, 150, 39, 150, 107, 65, 150, 150, 150, 150, 123, 117, 150, 57, 150, 66, 66, 50, 71, 108, 59, 46, 150, 96, 150, 150, 150, 56, 81, 56, 150, 67, 83, 150, 79, 150, 88, 76, 110, 106, 150, 80, 150, 150, 66, 73, 84, 40, 150, 69, 62, 150, 48, 150, 52, 90, 73, 52, 150, 112, 88, 150, 74, 79, 125, 67, 61, 150, 69, 62, 132, 40, 150, 150, 150, 71, 72, 50, 70], "policy_policy_0_reward": [-1056.7099588495, -122.41887881305205, -340.76009688030854, -431.13549596539474, -30.765947261932734, -123.47272070181205, -1060.210124102069, -462.78013005424447, -1080.8694594232197, -174.39376528985952, -1239.796122179879, -28.52825898389833, -261.46018100767617, -145.62014794843213, -240.87520800139777, -380.5263771072474, -171.4374477793777, -401.96526928197375, -224.3295401761343, -356.42633913263126, -28.511191630562116, -104.84149008722571, -515.3631194218208, -14.483155024377833, -493.40206817355704, -470.3155622579424, -187.28371055831664, -510.01208975476675, -747.3646931739079, -720.3936690210758, -455.94188816794804, -320.1408093768723, -492.5671314597283, -725.8028673426098, -45.86755623264708, -460.4223210333991, -53.92760869119129, -69.56021931756271, -113.60514589283223, -96.85716193216327, -403.8738009432702, -54.75856238240352, -56.878812375917555, -1186.7268781275186, -287.96971622588717, -687.3419533205434, -1542.7031958775058, -458.0868089590078, -46.68064306547469, -208.61129115985378, -59.69437495543242, -1330.5184669195335, -100.45219438930361, -167.4293229721003, -524.5931333083626, -234.31649767858252, -729.8347528527587, -196.1015971725714, -158.56379735694193, -482.577576870803, -323.32055864613505, -506.29155130727435, -182.5039126440674, -478.17444400987216, -398.73481546325246, -93.36804378761902, -191.67251866984546, -203.0816659616205, -42.21074604090455, -1007.3363160599536, -112.26447279160062, -130.1715892517489, -1261.9615838747818, -35.90625623846502, -421.1498407877197, -146.4820575867697, -297.08021585357557, -160.96210595060043, -48.242300517800274, -488.81235849111334, -361.1317350386819, -143.15746420580558, -399.91105482493157, -186.55234327509424, -123.45356901005495, -337.5793379249932, -98.07576454383212, -116.68391208956793, -925.4389458147501, -162.88441048892426, -203.4138835429791, -443.21368037028896, -27.149192030630875, -658.4726937135085, -392.7112877154305, -617.7237296675721, -117.94337252562909, -193.77647444203694, -79.57892439311405, -94.92712978878114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5624267998824461, "mean_inference_ms": 1.7405172304715655, "mean_action_processing_ms": 0.27687220584099065, "mean_env_wait_ms": 3.438719059312269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012000560760498047, "StateBufferConnector_ms": 0.008080482482910156, "ViewRequirementAgentConnector_ms": 0.20308542251586914}, "num_episodes": 45, "episode_return_max": -14.483155024377833, "episode_return_min": -1542.7031958775058, "episode_return_mean": -360.92364563745645, "episodes_this_iter": 45}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.2381095101022, "num_env_steps_trained_throughput_per_sec": 302.2381095101022, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 11874.074, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11873.998, "sample_time_ms": 1135.704, "learn_time_ms": 10669.047, "learn_throughput": 374.916, "synch_weights_time_ms": 68.425}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "training_iteration": 41, "trial_id": "b33d0_00000", "date": "2024-08-06_14-48-46", "timestamp": 1722935926, "time_this_iter_s": 13.247706890106201, "time_total_s": 489.4686002731323, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2a9480>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 489.4686002731323, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 17.34736842105263, "ram_util_percent": 29.299999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 129.50321271220844, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.1744989559054373, "policy_loss": -0.018023936697863972, "vf_loss": 3.184670874600609, "vf_explained_var": 0.9587292262042563, "kl": 0.012690348859814548, "entropy": 0.7139603345965345, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "env_runners": {"episode_reward_max": -20.5352385378839, "episode_reward_min": -1542.7031958775058, "episode_reward_mean": -323.52325458573597, "episode_len_mean": 97.26, "episode_media": {}, "episodes_timesteps_total": 9726, "policy_reward_min": {"policy_0": -1542.7031958775058}, "policy_reward_max": {"policy_0": -20.5352385378839}, "policy_reward_mean": {"policy_0": -323.52325458573597}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-403.8738009432702, -54.75856238240352, -56.878812375917555, -1186.7268781275186, -287.96971622588717, -687.3419533205434, -1542.7031958775058, -458.0868089590078, -46.68064306547469, -208.61129115985378, -59.69437495543242, -1330.5184669195335, -100.45219438930361, -167.4293229721003, -524.5931333083626, -234.31649767858252, -729.8347528527587, -196.1015971725714, -158.56379735694193, -482.577576870803, -323.32055864613505, -506.29155130727435, -182.5039126440674, -478.17444400987216, -398.73481546325246, -93.36804378761902, -191.67251866984546, -203.0816659616205, -42.21074604090455, -1007.3363160599536, -112.26447279160062, -130.1715892517489, -1261.9615838747818, -35.90625623846502, -421.1498407877197, -146.4820575867697, -297.08021585357557, -160.96210595060043, -48.242300517800274, -488.81235849111334, -361.1317350386819, -143.15746420580558, -399.91105482493157, -186.55234327509424, -123.45356901005495, -337.5793379249932, -98.07576454383212, -116.68391208956793, -925.4389458147501, -162.88441048892426, -203.4138835429791, -443.21368037028896, -27.149192030630875, -658.4726937135085, -392.7112877154305, -617.7237296675721, -117.94337252562909, -193.77647444203694, -79.57892439311405, -94.92712978878114, -412.5131874885044, -227.86173546502405, -33.59522730248552, -74.97841818033349, -247.0879216327371, -280.4764052595595, -231.2495573610633, -69.20818737827256, -107.24652569806456, -204.85940766018777, -519.0790097895297, -135.4227527663328, -155.1768863890723, -157.43663532570142, -39.11115507421563, -118.97787598261982, -120.99691966715449, -122.32778584638793, -195.4955746759953, -126.88892708249614, -137.58993996601137, -683.9987885637862, -531.5685131014104, -450.31431533869386, -408.016616487044, -1224.9215967271825, -264.60730826954665, -62.38574520343455, -110.77536827415727, -174.03464568591656, -78.20976005026758, -1024.7209053963666, -85.90049186607833, -389.40402685544825, -93.55704991304238, -318.8653616882492, -843.5605767327708, -470.75546842071753, -267.39400921475135, -20.5352385378839], "episode_lengths": [108, 59, 46, 150, 96, 150, 150, 150, 56, 81, 56, 150, 67, 83, 150, 79, 150, 88, 76, 110, 106, 150, 80, 150, 150, 66, 73, 84, 40, 150, 69, 62, 150, 48, 150, 52, 90, 73, 52, 150, 112, 88, 150, 74, 79, 125, 67, 61, 150, 69, 62, 132, 40, 150, 150, 150, 71, 72, 50, 70, 135, 88, 45, 59, 111, 111, 100, 63, 70, 93, 119, 87, 86, 83, 52, 77, 77, 56, 91, 76, 54, 136, 150, 150, 143, 150, 83, 67, 73, 62, 41, 150, 60, 147, 64, 120, 150, 150, 129, 46], "policy_policy_0_reward": [-403.8738009432702, -54.75856238240352, -56.878812375917555, -1186.7268781275186, -287.96971622588717, -687.3419533205434, -1542.7031958775058, -458.0868089590078, -46.68064306547469, -208.61129115985378, -59.69437495543242, -1330.5184669195335, -100.45219438930361, -167.4293229721003, -524.5931333083626, -234.31649767858252, -729.8347528527587, -196.1015971725714, -158.56379735694193, -482.577576870803, -323.32055864613505, -506.29155130727435, -182.5039126440674, -478.17444400987216, -398.73481546325246, -93.36804378761902, -191.67251866984546, -203.0816659616205, -42.21074604090455, -1007.3363160599536, -112.26447279160062, -130.1715892517489, -1261.9615838747818, -35.90625623846502, -421.1498407877197, -146.4820575867697, -297.08021585357557, -160.96210595060043, -48.242300517800274, -488.81235849111334, -361.1317350386819, -143.15746420580558, -399.91105482493157, -186.55234327509424, -123.45356901005495, -337.5793379249932, -98.07576454383212, -116.68391208956793, -925.4389458147501, -162.88441048892426, -203.4138835429791, -443.21368037028896, -27.149192030630875, -658.4726937135085, -392.7112877154305, -617.7237296675721, -117.94337252562909, -193.77647444203694, -79.57892439311405, -94.92712978878114, -412.5131874885044, -227.86173546502405, -33.59522730248552, -74.97841818033349, -247.0879216327371, -280.4764052595595, -231.2495573610633, -69.20818737827256, -107.24652569806456, -204.85940766018777, -519.0790097895297, -135.4227527663328, -155.1768863890723, -157.43663532570142, -39.11115507421563, -118.97787598261982, -120.99691966715449, -122.32778584638793, -195.4955746759953, -126.88892708249614, -137.58993996601137, -683.9987885637862, -531.5685131014104, -450.31431533869386, -408.016616487044, -1224.9215967271825, -264.60730826954665, -62.38574520343455, -110.77536827415727, -174.03464568591656, -78.20976005026758, -1024.7209053963666, -85.90049186607833, -389.40402685544825, -93.55704991304238, -318.8653616882492, -843.5605767327708, -470.75546842071753, -267.39400921475135, -20.5352385378839]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5621701206003668, "mean_inference_ms": 1.7397369269863185, "mean_action_processing_ms": 0.2767741179641491, "mean_env_wait_ms": 3.44017170210042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011942148208618164, "StateBufferConnector_ms": 0.00802755355834961, "ViewRequirementAgentConnector_ms": 0.20235872268676758}, "num_episodes": 40, "episode_return_max": -20.5352385378839, "episode_return_min": -1542.7031958775058, "episode_return_mean": -323.52325458573597, "episodes_this_iter": 40}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.19774125084126, "num_env_steps_trained_throughput_per_sec": 309.19774125084126, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 12013.733, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12013.66, "sample_time_ms": 1130.881, "learn_time_ms": 10813.421, "learn_throughput": 369.911, "synch_weights_time_ms": 68.537}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "training_iteration": 42, "trial_id": "b33d0_00000", "date": "2024-08-06_14-48-59", "timestamp": 1722935939, "time_this_iter_s": 12.9494309425354, "time_total_s": 502.4180312156677, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2aab00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 502.4180312156677, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 17.342105263157894, "ram_util_percent": 29.299999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 119.79258090456327, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.5166788733253878, "policy_loss": -0.018797302027329956, "vf_loss": 3.5249610101183255, "vf_explained_var": 0.9544769189630945, "kl": 0.016765025826680387, "entropy": 0.8012320792923371, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "env_runners": {"episode_reward_max": -18.754944805884676, "episode_reward_min": -1224.9215967271825, "episode_reward_mean": -316.74890861832705, "episode_len_mean": 99.86, "episode_media": {}, "episodes_timesteps_total": 9986, "policy_reward_min": {"policy_0": -1224.9215967271825}, "policy_reward_max": {"policy_0": -18.754944805884676}, "policy_reward_mean": {"policy_0": -316.74890861832705}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-143.15746420580558, -399.91105482493157, -186.55234327509424, -123.45356901005495, -337.5793379249932, -98.07576454383212, -116.68391208956793, -925.4389458147501, -162.88441048892426, -203.4138835429791, -443.21368037028896, -27.149192030630875, -658.4726937135085, -392.7112877154305, -617.7237296675721, -117.94337252562909, -193.77647444203694, -79.57892439311405, -94.92712978878114, -412.5131874885044, -227.86173546502405, -33.59522730248552, -74.97841818033349, -247.0879216327371, -280.4764052595595, -231.2495573610633, -69.20818737827256, -107.24652569806456, -204.85940766018777, -519.0790097895297, -135.4227527663328, -155.1768863890723, -157.43663532570142, -39.11115507421563, -118.97787598261982, -120.99691966715449, -122.32778584638793, -195.4955746759953, -126.88892708249614, -137.58993996601137, -683.9987885637862, -531.5685131014104, -450.31431533869386, -408.016616487044, -1224.9215967271825, -264.60730826954665, -62.38574520343455, -110.77536827415727, -174.03464568591656, -78.20976005026758, -1024.7209053963666, -85.90049186607833, -389.40402685544825, -93.55704991304238, -318.8653616882492, -843.5605767327708, -470.75546842071753, -267.39400921475135, -20.5352385378839, -61.35859208510815, -155.53571248007086, -238.2767612722739, -267.8350312046953, -312.79501380235814, -98.35651281765017, -174.65311483076215, -856.7350425851195, -258.902178414612, -1187.9275012499006, -262.31080277354476, -201.73695780572135, -599.2434950584118, -611.5650963883759, -236.9963353690358, -406.77877290857583, -698.7913651099248, -23.90373621710775, -410.70168978246585, -470.43656864868126, -419.60219216120925, -246.69764478284634, -414.34283667568974, -791.9278490661661, -312.7893036164509, -141.84520600784242, -886.0932871301875, -491.3047571846617, -341.1174657420169, -1035.9936601424351, -276.28981622768987, -113.17211708335378, -323.3736728193924, -148.49520916936987, -18.754944805884676, -271.7072160660392, -983.0722112162755, -31.054250255280994, -56.64528606149525, -176.41835015860084, -115.60031196899686], "episode_lengths": [88, 150, 74, 79, 125, 67, 61, 150, 69, 62, 132, 40, 150, 150, 150, 71, 72, 50, 70, 135, 88, 45, 59, 111, 111, 100, 63, 70, 93, 119, 87, 86, 83, 52, 77, 77, 56, 91, 76, 54, 136, 150, 150, 143, 150, 83, 67, 73, 62, 41, 150, 60, 147, 64, 120, 150, 150, 129, 46, 53, 60, 97, 138, 88, 64, 77, 150, 90, 150, 117, 106, 150, 129, 71, 113, 150, 43, 150, 150, 141, 83, 150, 150, 112, 96, 150, 144, 150, 150, 110, 46, 120, 81, 41, 107, 150, 42, 47, 86, 70], "policy_policy_0_reward": [-143.15746420580558, -399.91105482493157, -186.55234327509424, -123.45356901005495, -337.5793379249932, -98.07576454383212, -116.68391208956793, -925.4389458147501, -162.88441048892426, -203.4138835429791, -443.21368037028896, -27.149192030630875, -658.4726937135085, -392.7112877154305, -617.7237296675721, -117.94337252562909, -193.77647444203694, -79.57892439311405, -94.92712978878114, -412.5131874885044, -227.86173546502405, -33.59522730248552, -74.97841818033349, -247.0879216327371, -280.4764052595595, -231.2495573610633, -69.20818737827256, -107.24652569806456, -204.85940766018777, -519.0790097895297, -135.4227527663328, -155.1768863890723, -157.43663532570142, -39.11115507421563, -118.97787598261982, -120.99691966715449, -122.32778584638793, -195.4955746759953, -126.88892708249614, -137.58993996601137, -683.9987885637862, -531.5685131014104, -450.31431533869386, -408.016616487044, -1224.9215967271825, -264.60730826954665, -62.38574520343455, -110.77536827415727, -174.03464568591656, -78.20976005026758, -1024.7209053963666, -85.90049186607833, -389.40402685544825, -93.55704991304238, -318.8653616882492, -843.5605767327708, -470.75546842071753, -267.39400921475135, -20.5352385378839, -61.35859208510815, -155.53571248007086, -238.2767612722739, -267.8350312046953, -312.79501380235814, -98.35651281765017, -174.65311483076215, -856.7350425851195, -258.902178414612, -1187.9275012499006, -262.31080277354476, -201.73695780572135, -599.2434950584118, -611.5650963883759, -236.9963353690358, -406.77877290857583, -698.7913651099248, -23.90373621710775, -410.70168978246585, -470.43656864868126, -419.60219216120925, -246.69764478284634, -414.34283667568974, -791.9278490661661, -312.7893036164509, -141.84520600784242, -886.0932871301875, -491.3047571846617, -341.1174657420169, -1035.9936601424351, -276.28981622768987, -113.17211708335378, -323.3736728193924, -148.49520916936987, -18.754944805884676, -271.7072160660392, -983.0722112162755, -31.054250255280994, -56.64528606149525, -176.41835015860084, -115.60031196899686]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5623026197069857, "mean_inference_ms": 1.7379579162157797, "mean_action_processing_ms": 0.27666326212768944, "mean_env_wait_ms": 3.433195891984988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012247800827026367, "StateBufferConnector_ms": 0.008013010025024414, "ViewRequirementAgentConnector_ms": 0.19988679885864258}, "num_episodes": 41, "episode_return_max": -18.754944805884676, "episode_return_min": -1224.9215967271825, "episode_return_mean": -316.74890861832705, "episodes_this_iter": 41}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.94213733740975, "num_env_steps_trained_throughput_per_sec": 313.94213733740975, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 12215.425, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12215.352, "sample_time_ms": 1132.471, "learn_time_ms": 11014.122, "learn_throughput": 363.17, "synch_weights_time_ms": 67.941}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "training_iteration": 43, "trial_id": "b33d0_00000", "date": "2024-08-06_14-49-11", "timestamp": 1722935951, "time_this_iter_s": 12.75383973121643, "time_total_s": 515.1718709468842, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2a96c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 515.1718709468842, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 17.58888888888889, "ram_util_percent": 29.299999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 122.35244434674581, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.6455857500744364, "policy_loss": -0.013570833286212291, "vf_loss": 3.65036345248421, "vf_explained_var": 0.9579898033911983, "kl": 0.014462190985523194, "entropy": 0.9688446580742797, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": -18.754944805884676, "episode_reward_min": -1325.0542583680638, "episode_reward_mean": -370.9188518145626, "episode_len_mean": 106.0, "episode_media": {}, "episodes_timesteps_total": 10600, "policy_reward_min": {"policy_0": -1325.0542583680638}, "policy_reward_max": {"policy_0": -18.754944805884676}, "policy_reward_mean": {"policy_0": -370.9188518145626}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155.1768863890723, -157.43663532570142, -39.11115507421563, -118.97787598261982, -120.99691966715449, -122.32778584638793, -195.4955746759953, -126.88892708249614, -137.58993996601137, -683.9987885637862, -531.5685131014104, -450.31431533869386, -408.016616487044, -1224.9215967271825, -264.60730826954665, -62.38574520343455, -110.77536827415727, -174.03464568591656, -78.20976005026758, -1024.7209053963666, -85.90049186607833, -389.40402685544825, -93.55704991304238, -318.8653616882492, -843.5605767327708, -470.75546842071753, -267.39400921475135, -20.5352385378839, -61.35859208510815, -155.53571248007086, -238.2767612722739, -267.8350312046953, -312.79501380235814, -98.35651281765017, -174.65311483076215, -856.7350425851195, -258.902178414612, -1187.9275012499006, -262.31080277354476, -201.73695780572135, -599.2434950584118, -611.5650963883759, -236.9963353690358, -406.77877290857583, -698.7913651099248, -23.90373621710775, -410.70168978246585, -470.43656864868126, -419.60219216120925, -246.69764478284634, -414.34283667568974, -791.9278490661661, -312.7893036164509, -141.84520600784242, -886.0932871301875, -491.3047571846617, -341.1174657420169, -1035.9936601424351, -276.28981622768987, -113.17211708335378, -323.3736728193924, -148.49520916936987, -18.754944805884676, -271.7072160660392, -983.0722112162755, -31.054250255280994, -56.64528606149525, -176.41835015860084, -115.60031196899686, -449.46276890326084, -243.75210258480698, -276.9980640831721, -229.20856927641944, -851.0662021842704, -150.17608648229316, -508.67701376399447, -1276.6946030116626, -40.56912505440237, -338.5432036154426, -452.55816557900766, -987.8797661494721, -109.47676075066819, -158.881857903007, -58.348009290888825, -121.14329214697172, -236.81026699502527, -350.67138184984964, -533.6037136530575, -154.4278921976455, -33.296483015189246, -371.6362257339148, -576.354767373401, -443.3374127149442, -212.90776758932353, -113.55228526379541, -250.3988801848869, -1325.0542583680638, -1225.8925138616403, -313.99721706352614, -887.8431693295742], "episode_lengths": [86, 83, 52, 77, 77, 56, 91, 76, 54, 136, 150, 150, 143, 150, 83, 67, 73, 62, 41, 150, 60, 147, 64, 120, 150, 150, 129, 46, 53, 60, 97, 138, 88, 64, 77, 150, 90, 150, 117, 106, 150, 129, 71, 113, 150, 43, 150, 150, 141, 83, 150, 150, 112, 96, 150, 144, 150, 150, 110, 46, 120, 81, 41, 107, 150, 42, 47, 86, 70, 150, 102, 116, 101, 150, 82, 150, 150, 49, 150, 150, 150, 65, 55, 55, 70, 94, 150, 150, 79, 44, 148, 150, 135, 87, 49, 105, 150, 150, 119, 150], "policy_policy_0_reward": [-155.1768863890723, -157.43663532570142, -39.11115507421563, -118.97787598261982, -120.99691966715449, -122.32778584638793, -195.4955746759953, -126.88892708249614, -137.58993996601137, -683.9987885637862, -531.5685131014104, -450.31431533869386, -408.016616487044, -1224.9215967271825, -264.60730826954665, -62.38574520343455, -110.77536827415727, -174.03464568591656, -78.20976005026758, -1024.7209053963666, -85.90049186607833, -389.40402685544825, -93.55704991304238, -318.8653616882492, -843.5605767327708, -470.75546842071753, -267.39400921475135, -20.5352385378839, -61.35859208510815, -155.53571248007086, -238.2767612722739, -267.8350312046953, -312.79501380235814, -98.35651281765017, -174.65311483076215, -856.7350425851195, -258.902178414612, -1187.9275012499006, -262.31080277354476, -201.73695780572135, -599.2434950584118, -611.5650963883759, -236.9963353690358, -406.77877290857583, -698.7913651099248, -23.90373621710775, -410.70168978246585, -470.43656864868126, -419.60219216120925, -246.69764478284634, -414.34283667568974, -791.9278490661661, -312.7893036164509, -141.84520600784242, -886.0932871301875, -491.3047571846617, -341.1174657420169, -1035.9936601424351, -276.28981622768987, -113.17211708335378, -323.3736728193924, -148.49520916936987, -18.754944805884676, -271.7072160660392, -983.0722112162755, -31.054250255280994, -56.64528606149525, -176.41835015860084, -115.60031196899686, -449.46276890326084, -243.75210258480698, -276.9980640831721, -229.20856927641944, -851.0662021842704, -150.17608648229316, -508.67701376399447, -1276.6946030116626, -40.56912505440237, -338.5432036154426, -452.55816557900766, -987.8797661494721, -109.47676075066819, -158.881857903007, -58.348009290888825, -121.14329214697172, -236.81026699502527, -350.67138184984964, -533.6037136530575, -154.4278921976455, -33.296483015189246, -371.6362257339148, -576.354767373401, -443.3374127149442, -212.90776758932353, -113.55228526379541, -250.3988801848869, -1325.0542583680638, -1225.8925138616403, -313.99721706352614, -887.8431693295742]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5625388308079706, "mean_inference_ms": 1.7364410269504602, "mean_action_processing_ms": 0.27659200300524733, "mean_env_wait_ms": 3.4354444642751867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012159347534179688, "StateBufferConnector_ms": 0.007800102233886719, "ViewRequirementAgentConnector_ms": 0.1942906379699707}, "num_episodes": 31, "episode_return_max": -18.754944805884676, "episode_return_min": -1325.0542583680638, "episode_return_mean": -370.9188518145626, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.41310147337845, "num_env_steps_trained_throughput_per_sec": 310.41310147337845, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 12269.16, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12269.083, "sample_time_ms": 1139.638, "learn_time_ms": 11062.168, "learn_throughput": 361.593, "synch_weights_time_ms": 66.456}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 44, "trial_id": "b33d0_00000", "date": "2024-08-06_14-49-24", "timestamp": 1722935964, "time_this_iter_s": 12.897294044494629, "time_total_s": 528.0691649913788, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c125bd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 528.0691649913788, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 17.72222222222222, "ram_util_percent": 29.299999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 135.77215725779533, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.3570428570111592, "policy_loss": -0.02213626348481436, "vf_loss": 3.368561736121774, "vf_explained_var": 0.9787628527730703, "kl": 0.01696390108589488, "entropy": 0.8332559309899807, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "env_runners": {"episode_reward_max": -18.754944805884676, "episode_reward_min": -1327.7434360186405, "episode_reward_mean": -362.966812925479, "episode_len_mean": 105.83, "episode_media": {}, "episodes_timesteps_total": 10583, "policy_reward_min": {"policy_0": -1327.7434360186405}, "policy_reward_max": {"policy_0": -18.754944805884676}, "policy_reward_mean": {"policy_0": -362.966812925479}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-236.9963353690358, -406.77877290857583, -698.7913651099248, -23.90373621710775, -410.70168978246585, -470.43656864868126, -419.60219216120925, -246.69764478284634, -414.34283667568974, -791.9278490661661, -312.7893036164509, -141.84520600784242, -886.0932871301875, -491.3047571846617, -341.1174657420169, -1035.9936601424351, -276.28981622768987, -113.17211708335378, -323.3736728193924, -148.49520916936987, -18.754944805884676, -271.7072160660392, -983.0722112162755, -31.054250255280994, -56.64528606149525, -176.41835015860084, -115.60031196899686, -449.46276890326084, -243.75210258480698, -276.9980640831721, -229.20856927641944, -851.0662021842704, -150.17608648229316, -508.67701376399447, -1276.6946030116626, -40.56912505440237, -338.5432036154426, -452.55816557900766, -987.8797661494721, -109.47676075066819, -158.881857903007, -58.348009290888825, -121.14329214697172, -236.81026699502527, -350.67138184984964, -533.6037136530575, -154.4278921976455, -33.296483015189246, -371.6362257339148, -576.354767373401, -443.3374127149442, -212.90776758932353, -113.55228526379541, -250.3988801848869, -1325.0542583680638, -1225.8925138616403, -313.99721706352614, -887.8431693295742, -165.19924867295546, -26.79833054760241, -45.45725519135396, -901.1622039293522, -118.70953204079673, -128.45103541815317, -44.54462290961132, -365.1148402051035, -470.4004559787221, -1111.971820929075, -212.77723414251963, -239.10878877572057, -264.65855222893765, -192.9363445242971, -148.46923917716592, -396.18256858425093, -602.6403476656386, -471.8058430194255, -319.2187774631, -133.4497391080292, -102.88008153954043, -1327.7434360186405, -281.82591565323145, -212.7137210632762, -121.98731416572156, -184.74123634657482, -524.3783278062913, -389.7374414141809, -69.87526441936416, -360.541599264312, -221.33756798462267, -21.355878982861483, -290.5067071744256, -190.3183751581507, -79.75172361069598, -151.1337649607693, -240.76816890433128, -93.70420533305015, -961.1554737441721, -321.2704860372207, -245.9721481089421, -416.7997919944621], "episode_lengths": [71, 113, 150, 43, 150, 150, 141, 83, 150, 150, 112, 96, 150, 144, 150, 150, 110, 46, 120, 81, 41, 107, 150, 42, 47, 86, 70, 150, 102, 116, 101, 150, 82, 150, 150, 49, 150, 150, 150, 65, 55, 55, 70, 94, 150, 150, 79, 44, 148, 150, 135, 87, 49, 105, 150, 150, 119, 150, 87, 45, 56, 150, 71, 68, 34, 149, 150, 150, 81, 96, 96, 86, 55, 104, 150, 150, 141, 88, 68, 150, 109, 66, 67, 101, 150, 150, 48, 98, 150, 42, 109, 90, 57, 88, 92, 65, 150, 101, 94, 123], "policy_policy_0_reward": [-236.9963353690358, -406.77877290857583, -698.7913651099248, -23.90373621710775, -410.70168978246585, -470.43656864868126, -419.60219216120925, -246.69764478284634, -414.34283667568974, -791.9278490661661, -312.7893036164509, -141.84520600784242, -886.0932871301875, -491.3047571846617, -341.1174657420169, -1035.9936601424351, -276.28981622768987, -113.17211708335378, -323.3736728193924, -148.49520916936987, -18.754944805884676, -271.7072160660392, -983.0722112162755, -31.054250255280994, -56.64528606149525, -176.41835015860084, -115.60031196899686, -449.46276890326084, -243.75210258480698, -276.9980640831721, -229.20856927641944, -851.0662021842704, -150.17608648229316, -508.67701376399447, -1276.6946030116626, -40.56912505440237, -338.5432036154426, -452.55816557900766, -987.8797661494721, -109.47676075066819, -158.881857903007, -58.348009290888825, -121.14329214697172, -236.81026699502527, -350.67138184984964, -533.6037136530575, -154.4278921976455, -33.296483015189246, -371.6362257339148, -576.354767373401, -443.3374127149442, -212.90776758932353, -113.55228526379541, -250.3988801848869, -1325.0542583680638, -1225.8925138616403, -313.99721706352614, -887.8431693295742, -165.19924867295546, -26.79833054760241, -45.45725519135396, -901.1622039293522, -118.70953204079673, -128.45103541815317, -44.54462290961132, -365.1148402051035, -470.4004559787221, -1111.971820929075, -212.77723414251963, -239.10878877572057, -264.65855222893765, -192.9363445242971, -148.46923917716592, -396.18256858425093, -602.6403476656386, -471.8058430194255, -319.2187774631, -133.4497391080292, -102.88008153954043, -1327.7434360186405, -281.82591565323145, -212.7137210632762, -121.98731416572156, -184.74123634657482, -524.3783278062913, -389.7374414141809, -69.87526441936416, -360.541599264312, -221.33756798462267, -21.355878982861483, -290.5067071744256, -190.3183751581507, -79.75172361069598, -151.1337649607693, -240.76816890433128, -93.70420533305015, -961.1554737441721, -321.2704860372207, -245.9721481089421, -416.7997919944621]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5629009282617524, "mean_inference_ms": 1.7356550310846146, "mean_action_processing_ms": 0.2767926405855785, "mean_env_wait_ms": 3.433355874838067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012070655822753906, "StateBufferConnector_ms": 0.008001565933227539, "ViewRequirementAgentConnector_ms": 0.19862866401672363}, "num_episodes": 42, "episode_return_max": -18.754944805884676, "episode_return_min": -1327.7434360186405, "episode_return_mean": -362.966812925479, "episodes_this_iter": 42}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 337.52143279775675, "num_env_steps_trained_throughput_per_sec": 337.52143279775675, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 12260.312, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12260.236, "sample_time_ms": 1134.081, "learn_time_ms": 11058.288, "learn_throughput": 361.72, "synch_weights_time_ms": 67.031}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "training_iteration": 45, "trial_id": "b33d0_00000", "date": "2024-08-06_14-49-36", "timestamp": 1722935976, "time_this_iter_s": 11.863310098648071, "time_total_s": 539.9324750900269, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c1267a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 539.9324750900269, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 18.276470588235295, "ram_util_percent": 29.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 148.08393899003664, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.5070640335480374, "policy_loss": -0.016964221237382542, "vf_loss": 3.51473703160882, "vf_explained_var": 0.9623666892449061, "kl": 0.015226451066943507, "entropy": 0.986626199260354, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "env_runners": {"episode_reward_max": -21.355878982861483, "episode_reward_min": -1327.7434360186405, "episode_reward_mean": -404.51978129461463, "episode_len_mean": 107.63, "episode_media": {}, "episodes_timesteps_total": 10763, "policy_reward_min": {"policy_0": -1327.7434360186405}, "policy_reward_max": {"policy_0": -21.355878982861483}, "policy_reward_mean": {"policy_0": -404.51978129461463}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-508.67701376399447, -1276.6946030116626, -40.56912505440237, -338.5432036154426, -452.55816557900766, -987.8797661494721, -109.47676075066819, -158.881857903007, -58.348009290888825, -121.14329214697172, -236.81026699502527, -350.67138184984964, -533.6037136530575, -154.4278921976455, -33.296483015189246, -371.6362257339148, -576.354767373401, -443.3374127149442, -212.90776758932353, -113.55228526379541, -250.3988801848869, -1325.0542583680638, -1225.8925138616403, -313.99721706352614, -887.8431693295742, -165.19924867295546, -26.79833054760241, -45.45725519135396, -901.1622039293522, -118.70953204079673, -128.45103541815317, -44.54462290961132, -365.1148402051035, -470.4004559787221, -1111.971820929075, -212.77723414251963, -239.10878877572057, -264.65855222893765, -192.9363445242971, -148.46923917716592, -396.18256858425093, -602.6403476656386, -471.8058430194255, -319.2187774631, -133.4497391080292, -102.88008153954043, -1327.7434360186405, -281.82591565323145, -212.7137210632762, -121.98731416572156, -184.74123634657482, -524.3783278062913, -389.7374414141809, -69.87526441936416, -360.541599264312, -221.33756798462267, -21.355878982861483, -290.5067071744256, -190.3183751581507, -79.75172361069598, -151.1337649607693, -240.76816890433128, -93.70420533305015, -961.1554737441721, -321.2704860372207, -245.9721481089421, -416.7997919944621, -163.79389794582707, -188.93306802686743, -1127.0549864311135, -489.959692855163, -914.6307879114371, -720.991744245091, -180.02072715245853, -541.556131856027, -503.3392695413721, -741.8611521171229, -70.30015275717436, -474.38540532462736, -1150.789560744228, -1124.86602847363, -64.5991885321517, -279.74109118030674, -1224.9577435770946, -634.8714821680273, -215.8837583866601, -502.8070543529278, -34.07044004226561, -97.37866615650053, -143.94773510558733, -294.67223470326053, -487.95546489969473, -499.46639603771183, -175.78134241929317, -228.97346634971672, -231.85207898208196, -1044.7109201287271, -986.9648398304863, -520.1572601343054, -138.59291843652568], "episode_lengths": [150, 150, 49, 150, 150, 150, 65, 55, 55, 70, 94, 150, 150, 79, 44, 148, 150, 135, 87, 49, 105, 150, 150, 119, 150, 87, 45, 56, 150, 71, 68, 34, 149, 150, 150, 81, 96, 96, 86, 55, 104, 150, 150, 141, 88, 68, 150, 109, 66, 67, 101, 150, 150, 48, 98, 150, 42, 109, 90, 57, 88, 92, 65, 150, 101, 94, 123, 68, 84, 150, 148, 150, 150, 69, 115, 150, 150, 51, 113, 150, 150, 44, 110, 150, 150, 102, 150, 47, 66, 83, 104, 150, 150, 58, 136, 80, 150, 150, 150, 56], "policy_policy_0_reward": [-508.67701376399447, -1276.6946030116626, -40.56912505440237, -338.5432036154426, -452.55816557900766, -987.8797661494721, -109.47676075066819, -158.881857903007, -58.348009290888825, -121.14329214697172, -236.81026699502527, -350.67138184984964, -533.6037136530575, -154.4278921976455, -33.296483015189246, -371.6362257339148, -576.354767373401, -443.3374127149442, -212.90776758932353, -113.55228526379541, -250.3988801848869, -1325.0542583680638, -1225.8925138616403, -313.99721706352614, -887.8431693295742, -165.19924867295546, -26.79833054760241, -45.45725519135396, -901.1622039293522, -118.70953204079673, -128.45103541815317, -44.54462290961132, -365.1148402051035, -470.4004559787221, -1111.971820929075, -212.77723414251963, -239.10878877572057, -264.65855222893765, -192.9363445242971, -148.46923917716592, -396.18256858425093, -602.6403476656386, -471.8058430194255, -319.2187774631, -133.4497391080292, -102.88008153954043, -1327.7434360186405, -281.82591565323145, -212.7137210632762, -121.98731416572156, -184.74123634657482, -524.3783278062913, -389.7374414141809, -69.87526441936416, -360.541599264312, -221.33756798462267, -21.355878982861483, -290.5067071744256, -190.3183751581507, -79.75172361069598, -151.1337649607693, -240.76816890433128, -93.70420533305015, -961.1554737441721, -321.2704860372207, -245.9721481089421, -416.7997919944621, -163.79389794582707, -188.93306802686743, -1127.0549864311135, -489.959692855163, -914.6307879114371, -720.991744245091, -180.02072715245853, -541.556131856027, -503.3392695413721, -741.8611521171229, -70.30015275717436, -474.38540532462736, -1150.789560744228, -1124.86602847363, -64.5991885321517, -279.74109118030674, -1224.9577435770946, -634.8714821680273, -215.8837583866601, -502.8070543529278, -34.07044004226561, -97.37866615650053, -143.94773510558733, -294.67223470326053, -487.95546489969473, -499.46639603771183, -175.78134241929317, -228.97346634971672, -231.85207898208196, -1044.7109201287271, -986.9648398304863, -520.1572601343054, -138.59291843652568]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5627229786831928, "mean_inference_ms": 1.733304066441155, "mean_action_processing_ms": 0.27657181615969106, "mean_env_wait_ms": 3.4328523676252813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012033224105834961, "StateBufferConnector_ms": 0.008043766021728516, "ViewRequirementAgentConnector_ms": 0.20015954971313477}, "num_episodes": 33, "episode_return_max": -21.355878982861483, "episode_return_min": -1327.7434360186405, "episode_return_mean": -404.51978129461463, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.5203340767718, "num_env_steps_trained_throughput_per_sec": 314.5203340767718, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 12496.388, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12496.311, "sample_time_ms": 1127.101, "learn_time_ms": 11302.408, "learn_throughput": 353.907, "synch_weights_time_ms": 65.977}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "training_iteration": 46, "trial_id": "b33d0_00000", "date": "2024-08-06_14-49-49", "timestamp": 1722935989, "time_this_iter_s": 12.730237483978271, "time_total_s": 552.6627125740051, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2a9750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 552.6627125740051, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 17.65555555555555, "ram_util_percent": 29.299999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 126.90865874091784, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.198745908463995, "policy_loss": -0.018339059232675935, "vf_loss": 3.2058439295738936, "vf_explained_var": 0.9609993144248923, "kl": 0.017856847692807352, "entropy": 0.8123255476976434, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "env_runners": {"episode_reward_max": -21.355878982861483, "episode_reward_min": -1327.7434360186405, "episode_reward_mean": -361.79049993284457, "episode_len_mean": 106.63, "episode_media": {}, "episodes_timesteps_total": 10663, "policy_reward_min": {"policy_0": -1327.7434360186405}, "policy_reward_max": {"policy_0": -21.355878982861483}, "policy_reward_mean": {"policy_0": -361.79049993284457}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-192.9363445242971, -148.46923917716592, -396.18256858425093, -602.6403476656386, -471.8058430194255, -319.2187774631, -133.4497391080292, -102.88008153954043, -1327.7434360186405, -281.82591565323145, -212.7137210632762, -121.98731416572156, -184.74123634657482, -524.3783278062913, -389.7374414141809, -69.87526441936416, -360.541599264312, -221.33756798462267, -21.355878982861483, -290.5067071744256, -190.3183751581507, -79.75172361069598, -151.1337649607693, -240.76816890433128, -93.70420533305015, -961.1554737441721, -321.2704860372207, -245.9721481089421, -416.7997919944621, -163.79389794582707, -188.93306802686743, -1127.0549864311135, -489.959692855163, -914.6307879114371, -720.991744245091, -180.02072715245853, -541.556131856027, -503.3392695413721, -741.8611521171229, -70.30015275717436, -474.38540532462736, -1150.789560744228, -1124.86602847363, -64.5991885321517, -279.74109118030674, -1224.9577435770946, -634.8714821680273, -215.8837583866601, -502.8070543529278, -34.07044004226561, -97.37866615650053, -143.94773510558733, -294.67223470326053, -487.95546489969473, -499.46639603771183, -175.78134241929317, -228.97346634971672, -231.85207898208196, -1044.7109201287271, -986.9648398304863, -520.1572601343054, -138.59291843652568, -49.45634828526157, -57.57409566478432, -175.70875538713952, -414.1688218928613, -235.99426815926412, -144.5944028551783, -565.7509382420432, -251.29334901202068, -238.66105713452842, -266.9983709690314, -93.5416137102491, -259.3541943570711, -474.15656809163767, -95.59994924561057, -223.4120040643798, -557.8867207767506, -60.85174718125221, -421.9242038952675, -66.81035207423115, -341.1236412574893, -191.85567272501123, -353.1081551465156, -438.7359790593829, -252.60816559032912, -423.21733466753767, -211.82060943060299, -388.22429136002944, -374.70810590352164, -192.34456097869585, -204.67951812426693, -405.4632528359918, -202.69827135369744, -795.1920989480194, -183.8348476816749, -570.0226933140849, -268.5544728703733, -104.27674779835547, -347.7756372080956], "episode_lengths": [86, 55, 104, 150, 150, 141, 88, 68, 150, 109, 66, 67, 101, 150, 150, 48, 98, 150, 42, 109, 90, 57, 88, 92, 65, 150, 101, 94, 123, 68, 84, 150, 148, 150, 150, 69, 115, 150, 150, 51, 113, 150, 150, 44, 110, 150, 150, 102, 150, 47, 66, 83, 104, 150, 150, 58, 136, 80, 150, 150, 150, 56, 53, 51, 101, 150, 79, 73, 150, 106, 101, 110, 60, 110, 150, 67, 93, 150, 60, 150, 56, 150, 82, 132, 100, 88, 142, 74, 150, 96, 89, 63, 127, 76, 150, 67, 150, 115, 66, 150], "policy_policy_0_reward": [-192.9363445242971, -148.46923917716592, -396.18256858425093, -602.6403476656386, -471.8058430194255, -319.2187774631, -133.4497391080292, -102.88008153954043, -1327.7434360186405, -281.82591565323145, -212.7137210632762, -121.98731416572156, -184.74123634657482, -524.3783278062913, -389.7374414141809, -69.87526441936416, -360.541599264312, -221.33756798462267, -21.355878982861483, -290.5067071744256, -190.3183751581507, -79.75172361069598, -151.1337649607693, -240.76816890433128, -93.70420533305015, -961.1554737441721, -321.2704860372207, -245.9721481089421, -416.7997919944621, -163.79389794582707, -188.93306802686743, -1127.0549864311135, -489.959692855163, -914.6307879114371, -720.991744245091, -180.02072715245853, -541.556131856027, -503.3392695413721, -741.8611521171229, -70.30015275717436, -474.38540532462736, -1150.789560744228, -1124.86602847363, -64.5991885321517, -279.74109118030674, -1224.9577435770946, -634.8714821680273, -215.8837583866601, -502.8070543529278, -34.07044004226561, -97.37866615650053, -143.94773510558733, -294.67223470326053, -487.95546489969473, -499.46639603771183, -175.78134241929317, -228.97346634971672, -231.85207898208196, -1044.7109201287271, -986.9648398304863, -520.1572601343054, -138.59291843652568, -49.45634828526157, -57.57409566478432, -175.70875538713952, -414.1688218928613, -235.99426815926412, -144.5944028551783, -565.7509382420432, -251.29334901202068, -238.66105713452842, -266.9983709690314, -93.5416137102491, -259.3541943570711, -474.15656809163767, -95.59994924561057, -223.4120040643798, -557.8867207767506, -60.85174718125221, -421.9242038952675, -66.81035207423115, -341.1236412574893, -191.85567272501123, -353.1081551465156, -438.7359790593829, -252.60816559032912, -423.21733466753767, -211.82060943060299, -388.22429136002944, -374.70810590352164, -192.34456097869585, -204.67951812426693, -405.4632528359918, -202.69827135369744, -795.1920989480194, -183.8348476816749, -570.0226933140849, -268.5544728703733, -104.27674779835547, -347.7756372080956]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5626131588642554, "mean_inference_ms": 1.7327303998687626, "mean_action_processing_ms": 0.27676971229108394, "mean_env_wait_ms": 3.434465742012349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012199878692626953, "StateBufferConnector_ms": 0.008200645446777344, "ViewRequirementAgentConnector_ms": 0.195509672164917}, "num_episodes": 38, "episode_return_max": -21.355878982861483, "episode_return_min": -1327.7434360186405, "episode_return_mean": -361.79049993284457, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 328.6122640074977, "num_env_steps_trained_throughput_per_sec": 328.6122640074977, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 12590.097, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12590.021, "sample_time_ms": 1114.981, "learn_time_ms": 11410.133, "learn_throughput": 350.566, "synch_weights_time_ms": 64.049}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "training_iteration": 47, "trial_id": "b33d0_00000", "date": "2024-08-06_14-50-01", "timestamp": 1722936001, "time_this_iter_s": 12.184077024459839, "time_total_s": 564.846789598465, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7855b4e20700>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 564.846789598465, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 17.805555555555557, "ram_util_percent": 29.299999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 199.84809799194335, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.4899295933544634, "policy_loss": -0.007264929843950085, "vf_loss": 3.489678554236889, "vf_explained_var": 0.9548288343474269, "kl": 0.012953461081512362, "entropy": 1.2276410952831307, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": -34.07044004226561, "episode_reward_min": -1380.2043655873297, "episode_reward_mean": -431.8253819867201, "episode_len_mean": 112.4, "episode_media": {}, "episodes_timesteps_total": 11240, "policy_reward_min": {"policy_0": -1380.2043655873297}, "policy_reward_max": {"policy_0": -34.07044004226561}, "policy_reward_mean": {"policy_0": -431.8253819867201}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-720.991744245091, -180.02072715245853, -541.556131856027, -503.3392695413721, -741.8611521171229, -70.30015275717436, -474.38540532462736, -1150.789560744228, -1124.86602847363, -64.5991885321517, -279.74109118030674, -1224.9577435770946, -634.8714821680273, -215.8837583866601, -502.8070543529278, -34.07044004226561, -97.37866615650053, -143.94773510558733, -294.67223470326053, -487.95546489969473, -499.46639603771183, -175.78134241929317, -228.97346634971672, -231.85207898208196, -1044.7109201287271, -986.9648398304863, -520.1572601343054, -138.59291843652568, -49.45634828526157, -57.57409566478432, -175.70875538713952, -414.1688218928613, -235.99426815926412, -144.5944028551783, -565.7509382420432, -251.29334901202068, -238.66105713452842, -266.9983709690314, -93.5416137102491, -259.3541943570711, -474.15656809163767, -95.59994924561057, -223.4120040643798, -557.8867207767506, -60.85174718125221, -421.9242038952675, -66.81035207423115, -341.1236412574893, -191.85567272501123, -353.1081551465156, -438.7359790593829, -252.60816559032912, -423.21733466753767, -211.82060943060299, -388.22429136002944, -374.70810590352164, -192.34456097869585, -204.67951812426693, -405.4632528359918, -202.69827135369744, -795.1920989480194, -183.8348476816749, -570.0226933140849, -268.5544728703733, -104.27674779835547, -347.7756372080956, -167.6822040800791, -555.2689554360296, -1280.0837245243627, -1380.2043655873297, -150.08811186497013, -294.02628352370186, -884.8388898948743, -405.4395200970811, -633.4998304618895, -321.5629549142643, -124.08277742177673, -48.42273069141577, -352.3076084071005, -1152.4253102638622, -278.93111449064617, -957.4282594045571, -1258.0228795338169, -335.18950153175194, -956.920814670778, -482.7513255834242, -105.64782743174788, -323.3771837789038, -552.8642358322238, -589.4135326690208, -860.1429823315171, -1105.9051294541507, -338.59334255452416, -34.94884845851291, -681.4029194561526, -474.1672286901995, -227.86880912187038, -149.51253845974412, -217.252838448959, -1282.7875487134775], "episode_lengths": [150, 69, 115, 150, 150, 51, 113, 150, 150, 44, 110, 150, 150, 102, 150, 47, 66, 83, 104, 150, 150, 58, 136, 80, 150, 150, 150, 56, 53, 51, 101, 150, 79, 73, 150, 106, 101, 110, 60, 110, 150, 67, 93, 150, 60, 150, 56, 150, 82, 132, 100, 88, 142, 74, 150, 96, 89, 63, 127, 76, 150, 67, 150, 115, 66, 150, 69, 150, 150, 150, 71, 106, 150, 150, 150, 122, 66, 51, 119, 150, 111, 150, 150, 115, 150, 150, 64, 104, 150, 150, 150, 150, 150, 43, 149, 150, 81, 80, 68, 150], "policy_policy_0_reward": [-720.991744245091, -180.02072715245853, -541.556131856027, -503.3392695413721, -741.8611521171229, -70.30015275717436, -474.38540532462736, -1150.789560744228, -1124.86602847363, -64.5991885321517, -279.74109118030674, -1224.9577435770946, -634.8714821680273, -215.8837583866601, -502.8070543529278, -34.07044004226561, -97.37866615650053, -143.94773510558733, -294.67223470326053, -487.95546489969473, -499.46639603771183, -175.78134241929317, -228.97346634971672, -231.85207898208196, -1044.7109201287271, -986.9648398304863, -520.1572601343054, -138.59291843652568, -49.45634828526157, -57.57409566478432, -175.70875538713952, -414.1688218928613, -235.99426815926412, -144.5944028551783, -565.7509382420432, -251.29334901202068, -238.66105713452842, -266.9983709690314, -93.5416137102491, -259.3541943570711, -474.15656809163767, -95.59994924561057, -223.4120040643798, -557.8867207767506, -60.85174718125221, -421.9242038952675, -66.81035207423115, -341.1236412574893, -191.85567272501123, -353.1081551465156, -438.7359790593829, -252.60816559032912, -423.21733466753767, -211.82060943060299, -388.22429136002944, -374.70810590352164, -192.34456097869585, -204.67951812426693, -405.4632528359918, -202.69827135369744, -795.1920989480194, -183.8348476816749, -570.0226933140849, -268.5544728703733, -104.27674779835547, -347.7756372080956, -167.6822040800791, -555.2689554360296, -1280.0837245243627, -1380.2043655873297, -150.08811186497013, -294.02628352370186, -884.8388898948743, -405.4395200970811, -633.4998304618895, -321.5629549142643, -124.08277742177673, -48.42273069141577, -352.3076084071005, -1152.4253102638622, -278.93111449064617, -957.4282594045571, -1258.0228795338169, -335.18950153175194, -956.920814670778, -482.7513255834242, -105.64782743174788, -323.3771837789038, -552.8642358322238, -589.4135326690208, -860.1429823315171, -1105.9051294541507, -338.59334255452416, -34.94884845851291, -681.4029194561526, -474.1672286901995, -227.86880912187038, -149.51253845974412, -217.252838448959, -1282.7875487134775]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5624528945131773, "mean_inference_ms": 1.7307190852949972, "mean_action_processing_ms": 0.27633995239510534, "mean_env_wait_ms": 3.431122173623491, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01201176643371582, "StateBufferConnector_ms": 0.007928609848022461, "ViewRequirementAgentConnector_ms": 0.1899263858795166}, "num_episodes": 34, "episode_return_max": -34.07044004226561, "episode_return_min": -1380.2043655873297, "episode_return_mean": -431.8253819867201, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.1238153233192, "num_env_steps_trained_throughput_per_sec": 317.1238153233192, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 12674.705, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12674.632, "sample_time_ms": 1127.03, "learn_time_ms": 11483.815, "learn_throughput": 348.316, "synch_weights_time_ms": 62.955}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 48, "trial_id": "b33d0_00000", "date": "2024-08-06_14-50-14", "timestamp": 1722936014, "time_this_iter_s": 12.624572515487671, "time_total_s": 577.4713621139526, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c125fc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 577.4713621139526, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 17.644444444444442, "ram_util_percent": 29.299999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 132.13060215910275, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.9155029356479645, "policy_loss": -0.015673505563366538, "vf_loss": 2.9212809789925815, "vf_explained_var": 0.934467094267408, "kl": 0.015624833900907752, "entropy": 0.6512956417786578, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "env_runners": {"episode_reward_max": -3.663502653373237, "episode_reward_min": -1380.2043655873297, "episode_reward_mean": -400.9622772705897, "episode_len_mean": 111.46, "episode_media": {}, "episodes_timesteps_total": 11146, "policy_reward_min": {"policy_0": -1380.2043655873297}, "policy_reward_max": {"policy_0": -3.663502653373237}, "policy_reward_mean": {"policy_0": -400.9622772705897}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-238.66105713452842, -266.9983709690314, -93.5416137102491, -259.3541943570711, -474.15656809163767, -95.59994924561057, -223.4120040643798, -557.8867207767506, -60.85174718125221, -421.9242038952675, -66.81035207423115, -341.1236412574893, -191.85567272501123, -353.1081551465156, -438.7359790593829, -252.60816559032912, -423.21733466753767, -211.82060943060299, -388.22429136002944, -374.70810590352164, -192.34456097869585, -204.67951812426693, -405.4632528359918, -202.69827135369744, -795.1920989480194, -183.8348476816749, -570.0226933140849, -268.5544728703733, -104.27674779835547, -347.7756372080956, -167.6822040800791, -555.2689554360296, -1280.0837245243627, -1380.2043655873297, -150.08811186497013, -294.02628352370186, -884.8388898948743, -405.4395200970811, -633.4998304618895, -321.5629549142643, -124.08277742177673, -48.42273069141577, -352.3076084071005, -1152.4253102638622, -278.93111449064617, -957.4282594045571, -1258.0228795338169, -335.18950153175194, -956.920814670778, -482.7513255834242, -105.64782743174788, -323.3771837789038, -552.8642358322238, -589.4135326690208, -860.1429823315171, -1105.9051294541507, -338.59334255452416, -34.94884845851291, -681.4029194561526, -474.1672286901995, -227.86880912187038, -149.51253845974412, -217.252838448959, -1282.7875487134775, -712.0696087205991, -92.9363795393632, -343.99225481031044, -118.32429534502806, -544.2609099169932, -395.96587223378594, -111.28190895982257, -289.14511661178403, -358.6691652095003, -149.25913854755532, -82.83417523497066, -612.4962307704443, -192.51307405118098, -152.06645807100318, -491.9096580900193, -194.24708490465682, -848.9106952281657, -158.14419587866792, -3.663502653373237, -547.2223162209907, -75.78071292200669, -171.36248715544122, -481.55831000651415, -254.47954146741895, -255.43800911176635, -223.5578289313474, -272.675426519092, -425.0022124189712, -436.17590518166355, -189.33174625856904, -83.84851842134115, -554.0123915143041, -374.5229540387778, -416.3482543108212, -901.0386176943127, -608.6798045700069], "episode_lengths": [101, 110, 60, 110, 150, 67, 93, 150, 60, 150, 56, 150, 82, 132, 100, 88, 142, 74, 150, 96, 89, 63, 127, 76, 150, 67, 150, 115, 66, 150, 69, 150, 150, 150, 71, 106, 150, 150, 150, 122, 66, 51, 119, 150, 111, 150, 150, 115, 150, 150, 64, 104, 150, 150, 150, 150, 150, 43, 149, 150, 81, 80, 68, 150, 150, 64, 107, 53, 150, 150, 61, 91, 119, 70, 59, 150, 95, 58, 150, 70, 150, 84, 38, 150, 61, 75, 150, 87, 99, 70, 101, 150, 150, 77, 64, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-238.66105713452842, -266.9983709690314, -93.5416137102491, -259.3541943570711, -474.15656809163767, -95.59994924561057, -223.4120040643798, -557.8867207767506, -60.85174718125221, -421.9242038952675, -66.81035207423115, -341.1236412574893, -191.85567272501123, -353.1081551465156, -438.7359790593829, -252.60816559032912, -423.21733466753767, -211.82060943060299, -388.22429136002944, -374.70810590352164, -192.34456097869585, -204.67951812426693, -405.4632528359918, -202.69827135369744, -795.1920989480194, -183.8348476816749, -570.0226933140849, -268.5544728703733, -104.27674779835547, -347.7756372080956, -167.6822040800791, -555.2689554360296, -1280.0837245243627, -1380.2043655873297, -150.08811186497013, -294.02628352370186, -884.8388898948743, -405.4395200970811, -633.4998304618895, -321.5629549142643, -124.08277742177673, -48.42273069141577, -352.3076084071005, -1152.4253102638622, -278.93111449064617, -957.4282594045571, -1258.0228795338169, -335.18950153175194, -956.920814670778, -482.7513255834242, -105.64782743174788, -323.3771837789038, -552.8642358322238, -589.4135326690208, -860.1429823315171, -1105.9051294541507, -338.59334255452416, -34.94884845851291, -681.4029194561526, -474.1672286901995, -227.86880912187038, -149.51253845974412, -217.252838448959, -1282.7875487134775, -712.0696087205991, -92.9363795393632, -343.99225481031044, -118.32429534502806, -544.2609099169932, -395.96587223378594, -111.28190895982257, -289.14511661178403, -358.6691652095003, -149.25913854755532, -82.83417523497066, -612.4962307704443, -192.51307405118098, -152.06645807100318, -491.9096580900193, -194.24708490465682, -848.9106952281657, -158.14419587866792, -3.663502653373237, -547.2223162209907, -75.78071292200669, -171.36248715544122, -481.55831000651415, -254.47954146741895, -255.43800911176635, -223.5578289313474, -272.675426519092, -425.0022124189712, -436.17590518166355, -189.33174625856904, -83.84851842134115, -554.0123915143041, -374.5229540387778, -416.3482543108212, -901.0386176943127, -608.6798045700069]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5624310425685622, "mean_inference_ms": 1.7300694511841752, "mean_action_processing_ms": 0.27647151818606663, "mean_env_wait_ms": 3.431476256416727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011837959289550781, "StateBufferConnector_ms": 0.007915735244750977, "ViewRequirementAgentConnector_ms": 0.19122624397277832}, "num_episodes": 36, "episode_return_max": -3.663502653373237, "episode_return_min": -1380.2043655873297, "episode_return_mean": -400.9622772705897, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.1144159026281, "num_env_steps_trained_throughput_per_sec": 301.1144159026281, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 12740.264, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12740.188, "sample_time_ms": 1127.883, "learn_time_ms": 11549.252, "learn_throughput": 346.343, "synch_weights_time_ms": 62.224}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "training_iteration": 49, "trial_id": "b33d0_00000", "date": "2024-08-06_14-50-27", "timestamp": 1722936027, "time_this_iter_s": 13.296217679977417, "time_total_s": 590.76757979393, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c124ee0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 590.76757979393, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 17.157894736842106, "ram_util_percent": 29.299999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 128.5710186580817, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.0865107673220336, "policy_loss": -0.014594680244044866, "vf_loss": 3.0914672278178235, "vf_explained_var": 0.9651642339924972, "kl": 0.015569470398077141, "entropy": 0.8711671791349848, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": -3.663502653373237, "episode_reward_min": -1282.7875487134775, "episode_reward_mean": -385.32887052045896, "episode_len_mean": 111.62, "episode_media": {}, "episodes_timesteps_total": 11162, "policy_reward_min": {"policy_0": -1282.7875487134775}, "policy_reward_max": {"policy_0": -3.663502653373237}, "policy_reward_mean": {"policy_0": -385.32887052045896}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-321.5629549142643, -124.08277742177673, -48.42273069141577, -352.3076084071005, -1152.4253102638622, -278.93111449064617, -957.4282594045571, -1258.0228795338169, -335.18950153175194, -956.920814670778, -482.7513255834242, -105.64782743174788, -323.3771837789038, -552.8642358322238, -589.4135326690208, -860.1429823315171, -1105.9051294541507, -338.59334255452416, -34.94884845851291, -681.4029194561526, -474.1672286901995, -227.86880912187038, -149.51253845974412, -217.252838448959, -1282.7875487134775, -712.0696087205991, -92.9363795393632, -343.99225481031044, -118.32429534502806, -544.2609099169932, -395.96587223378594, -111.28190895982257, -289.14511661178403, -358.6691652095003, -149.25913854755532, -82.83417523497066, -612.4962307704443, -192.51307405118098, -152.06645807100318, -491.9096580900193, -194.24708490465682, -848.9106952281657, -158.14419587866792, -3.663502653373237, -547.2223162209907, -75.78071292200669, -171.36248715544122, -481.55831000651415, -254.47954146741895, -255.43800911176635, -223.5578289313474, -272.675426519092, -425.0022124189712, -436.17590518166355, -189.33174625856904, -83.84851842134115, -554.0123915143041, -374.5229540387778, -416.3482543108212, -901.0386176943127, -608.6798045700069, -392.1764927094305, -394.56681865697567, -360.9387143873064, -561.341773109567, -327.3824875637012, -179.00033254576155, -913.9977522643611, -401.9697569425924, -313.77865017288747, -144.313895695764, -320.9458944806776, -181.08586935461557, -218.9406062559532, -38.971457478774916, -138.1587211386321, -660.4787770196613, -79.74183092275024, -200.9968755342963, -134.56119270262158, -65.22248172238008, -605.1630339158352, -279.3640737351392, -465.79550442590664, -71.5254019143661, -444.4431851183654, -1049.8644228892006, -427.3549061756433, -125.15396579917757, -757.8016324302628, -545.2483891640643, -43.44532167075512, -451.99686026813333, -125.94148395285883, -500.440671119491, -440.98539135668267, -419.20068651164127, -189.75172568670908, -43.52870099023547, -181.65631042774658], "episode_lengths": [122, 66, 51, 119, 150, 111, 150, 150, 115, 150, 150, 64, 104, 150, 150, 150, 150, 150, 43, 149, 150, 81, 80, 68, 150, 150, 64, 107, 53, 150, 150, 61, 91, 119, 70, 59, 150, 95, 58, 150, 70, 150, 84, 38, 150, 61, 75, 150, 87, 99, 70, 101, 150, 150, 77, 64, 150, 150, 150, 150, 150, 139, 139, 120, 150, 146, 92, 150, 150, 100, 63, 125, 104, 107, 47, 78, 132, 70, 96, 78, 64, 150, 110, 150, 64, 150, 150, 150, 78, 150, 150, 45, 125, 47, 150, 102, 150, 94, 57, 114], "policy_policy_0_reward": [-321.5629549142643, -124.08277742177673, -48.42273069141577, -352.3076084071005, -1152.4253102638622, -278.93111449064617, -957.4282594045571, -1258.0228795338169, -335.18950153175194, -956.920814670778, -482.7513255834242, -105.64782743174788, -323.3771837789038, -552.8642358322238, -589.4135326690208, -860.1429823315171, -1105.9051294541507, -338.59334255452416, -34.94884845851291, -681.4029194561526, -474.1672286901995, -227.86880912187038, -149.51253845974412, -217.252838448959, -1282.7875487134775, -712.0696087205991, -92.9363795393632, -343.99225481031044, -118.32429534502806, -544.2609099169932, -395.96587223378594, -111.28190895982257, -289.14511661178403, -358.6691652095003, -149.25913854755532, -82.83417523497066, -612.4962307704443, -192.51307405118098, -152.06645807100318, -491.9096580900193, -194.24708490465682, -848.9106952281657, -158.14419587866792, -3.663502653373237, -547.2223162209907, -75.78071292200669, -171.36248715544122, -481.55831000651415, -254.47954146741895, -255.43800911176635, -223.5578289313474, -272.675426519092, -425.0022124189712, -436.17590518166355, -189.33174625856904, -83.84851842134115, -554.0123915143041, -374.5229540387778, -416.3482543108212, -901.0386176943127, -608.6798045700069, -392.1764927094305, -394.56681865697567, -360.9387143873064, -561.341773109567, -327.3824875637012, -179.00033254576155, -913.9977522643611, -401.9697569425924, -313.77865017288747, -144.313895695764, -320.9458944806776, -181.08586935461557, -218.9406062559532, -38.971457478774916, -138.1587211386321, -660.4787770196613, -79.74183092275024, -200.9968755342963, -134.56119270262158, -65.22248172238008, -605.1630339158352, -279.3640737351392, -465.79550442590664, -71.5254019143661, -444.4431851183654, -1049.8644228892006, -427.3549061756433, -125.15396579917757, -757.8016324302628, -545.2483891640643, -43.44532167075512, -451.99686026813333, -125.94148395285883, -500.440671119491, -440.98539135668267, -419.20068651164127, -189.75172568670908, -43.52870099023547, -181.65631042774658]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5623118774110824, "mean_inference_ms": 1.7277470262626666, "mean_action_processing_ms": 0.2762139084006537, "mean_env_wait_ms": 3.4272382044977023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011573076248168945, "StateBufferConnector_ms": 0.0078582763671875, "ViewRequirementAgentConnector_ms": 0.19208860397338867}, "num_episodes": 39, "episode_return_max": -3.663502653373237, "episode_return_min": -1282.7875487134775, "episode_return_mean": -385.32887052045896, "episodes_this_iter": 39}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.14296650321535, "num_env_steps_trained_throughput_per_sec": 315.14296650321535, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 12712.998, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12712.923, "sample_time_ms": 1127.78, "learn_time_ms": 11521.103, "learn_throughput": 347.189, "synch_weights_time_ms": 63.212}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "training_iteration": 50, "trial_id": "b33d0_00000", "date": "2024-08-06_14-50-40", "timestamp": 1722936040, "time_this_iter_s": 12.704801082611084, "time_total_s": 603.4723808765411, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c124c10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 603.4723808765411, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 17.67777777777778, "ram_util_percent": 29.299999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 120.82454105218251, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.0112841825932266, "policy_loss": -0.014204126181236157, "vf_loss": 3.0158787180980045, "vf_explained_var": 0.9645122526213527, "kl": 0.015615277295682971, "entropy": 0.9307144718244672, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 48480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "env_runners": {"episode_reward_max": -3.663502653373237, "episode_reward_min": -1301.2595141465686, "episode_reward_mean": -346.5798483305264, "episode_len_mean": 106.02, "episode_media": {}, "episodes_timesteps_total": 10602, "policy_reward_min": {"policy_0": -1301.2595141465686}, "policy_reward_max": {"policy_0": -3.663502653373237}, "policy_reward_mean": {"policy_0": -346.5798483305264}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-848.9106952281657, -158.14419587866792, -3.663502653373237, -547.2223162209907, -75.78071292200669, -171.36248715544122, -481.55831000651415, -254.47954146741895, -255.43800911176635, -223.5578289313474, -272.675426519092, -425.0022124189712, -436.17590518166355, -189.33174625856904, -83.84851842134115, -554.0123915143041, -374.5229540387778, -416.3482543108212, -901.0386176943127, -608.6798045700069, -392.1764927094305, -394.56681865697567, -360.9387143873064, -561.341773109567, -327.3824875637012, -179.00033254576155, -913.9977522643611, -401.9697569425924, -313.77865017288747, -144.313895695764, -320.9458944806776, -181.08586935461557, -218.9406062559532, -38.971457478774916, -138.1587211386321, -660.4787770196613, -79.74183092275024, -200.9968755342963, -134.56119270262158, -65.22248172238008, -605.1630339158352, -279.3640737351392, -465.79550442590664, -71.5254019143661, -444.4431851183654, -1049.8644228892006, -427.3549061756433, -125.15396579917757, -757.8016324302628, -545.2483891640643, -43.44532167075512, -451.99686026813333, -125.94148395285883, -500.440671119491, -440.98539135668267, -419.20068651164127, -189.75172568670908, -43.52870099023547, -181.65631042774658, -980.8532523020821, -234.80829990276385, -262.7341296203872, -94.3940435731613, -321.4020916944118, -148.37283407751556, -275.0594462318008, -49.45081372048594, -423.4195493803401, -614.6063299443811, -125.80631447675519, -383.7020993520427, -280.03918679126144, -161.86242447866474, -251.26320013690238, -87.29789933207151, -190.3152496295207, -719.5564666317334, -256.5138985155213, -57.69131615199865, -53.94665273465594, -286.54509492530104, -1163.9143249060442, -1118.2448655326039, -525.0743696810175, -573.0462495378122, -191.4233108939553, -251.22326409847008, -49.33903566011179, -422.27202944544445, -931.3264445468483, -87.8833142695508, -117.25169762166391, -45.34511133172756, -300.47767437545787, -121.43573980626384, -397.13925963710466, -113.1138117679619, -74.6142867613884, -1301.2595141465686, -134.97445671440408], "episode_lengths": [150, 84, 38, 150, 61, 75, 150, 87, 99, 70, 101, 150, 150, 77, 64, 150, 150, 150, 150, 150, 139, 139, 120, 150, 146, 92, 150, 150, 100, 63, 125, 104, 107, 47, 78, 132, 70, 96, 78, 64, 150, 110, 150, 64, 150, 150, 150, 78, 150, 150, 45, 125, 47, 150, 102, 150, 94, 57, 114, 150, 113, 93, 65, 102, 53, 101, 51, 150, 150, 60, 150, 117, 76, 100, 57, 106, 144, 87, 47, 59, 101, 150, 150, 150, 124, 89, 107, 51, 109, 150, 71, 59, 45, 112, 71, 103, 68, 44, 150, 75], "policy_policy_0_reward": [-848.9106952281657, -158.14419587866792, -3.663502653373237, -547.2223162209907, -75.78071292200669, -171.36248715544122, -481.55831000651415, -254.47954146741895, -255.43800911176635, -223.5578289313474, -272.675426519092, -425.0022124189712, -436.17590518166355, -189.33174625856904, -83.84851842134115, -554.0123915143041, -374.5229540387778, -416.3482543108212, -901.0386176943127, -608.6798045700069, -392.1764927094305, -394.56681865697567, -360.9387143873064, -561.341773109567, -327.3824875637012, -179.00033254576155, -913.9977522643611, -401.9697569425924, -313.77865017288747, -144.313895695764, -320.9458944806776, -181.08586935461557, -218.9406062559532, -38.971457478774916, -138.1587211386321, -660.4787770196613, -79.74183092275024, -200.9968755342963, -134.56119270262158, -65.22248172238008, -605.1630339158352, -279.3640737351392, -465.79550442590664, -71.5254019143661, -444.4431851183654, -1049.8644228892006, -427.3549061756433, -125.15396579917757, -757.8016324302628, -545.2483891640643, -43.44532167075512, -451.99686026813333, -125.94148395285883, -500.440671119491, -440.98539135668267, -419.20068651164127, -189.75172568670908, -43.52870099023547, -181.65631042774658, -980.8532523020821, -234.80829990276385, -262.7341296203872, -94.3940435731613, -321.4020916944118, -148.37283407751556, -275.0594462318008, -49.45081372048594, -423.4195493803401, -614.6063299443811, -125.80631447675519, -383.7020993520427, -280.03918679126144, -161.86242447866474, -251.26320013690238, -87.29789933207151, -190.3152496295207, -719.5564666317334, -256.5138985155213, -57.69131615199865, -53.94665273465594, -286.54509492530104, -1163.9143249060442, -1118.2448655326039, -525.0743696810175, -573.0462495378122, -191.4233108939553, -251.22326409847008, -49.33903566011179, -422.27202944544445, -931.3264445468483, -87.8833142695508, -117.25169762166391, -45.34511133172756, -300.47767437545787, -121.43573980626384, -397.13925963710466, -113.1138117679619, -74.6142867613884, -1301.2595141465686, -134.97445671440408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5620367717480561, "mean_inference_ms": 1.7263103263278126, "mean_action_processing_ms": 0.27623640982136277, "mean_env_wait_ms": 3.4255621626617385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011826515197753906, "StateBufferConnector_ms": 0.008099794387817383, "ViewRequirementAgentConnector_ms": 0.1997087001800537}, "num_episodes": 41, "episode_return_max": -3.663502653373237, "episode_return_min": -1301.2595141465686, "episode_return_mean": -346.5798483305264, "episodes_this_iter": 41}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.06990206507595, "num_env_steps_trained_throughput_per_sec": 313.06990206507595, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 12667.208, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12667.133, "sample_time_ms": 1113.735, "learn_time_ms": 11490.51, "learn_throughput": 348.113, "synch_weights_time_ms": 62.06}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "training_iteration": 51, "trial_id": "b33d0_00000", "date": "2024-08-06_14-50-53", "timestamp": 1722936053, "time_this_iter_s": 12.78984022140503, "time_total_s": 616.2622210979462, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c125000>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 616.2622210979462, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 17.52777777777778, "ram_util_percent": 29.299999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 127.56597445209822, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.0885308848073083, "policy_loss": -0.01812279588242139, "vf_loss": 3.0955726044873395, "vf_explained_var": 0.9849073170994719, "kl": 0.017709820009440647, "entropy": 0.8730582057187954, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 49440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": -26.5156976106212, "episode_reward_min": -1301.2595141465686, "episode_reward_mean": -346.26567553738624, "episode_len_mean": 99.57, "episode_media": {}, "episodes_timesteps_total": 9957, "policy_reward_min": {"policy_0": -1301.2595141465686}, "policy_reward_max": {"policy_0": -26.5156976106212}, "policy_reward_mean": {"policy_0": -346.26567553738624}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-444.4431851183654, -1049.8644228892006, -427.3549061756433, -125.15396579917757, -757.8016324302628, -545.2483891640643, -43.44532167075512, -451.99686026813333, -125.94148395285883, -500.440671119491, -440.98539135668267, -419.20068651164127, -189.75172568670908, -43.52870099023547, -181.65631042774658, -980.8532523020821, -234.80829990276385, -262.7341296203872, -94.3940435731613, -321.4020916944118, -148.37283407751556, -275.0594462318008, -49.45081372048594, -423.4195493803401, -614.6063299443811, -125.80631447675519, -383.7020993520427, -280.03918679126144, -161.86242447866474, -251.26320013690238, -87.29789933207151, -190.3152496295207, -719.5564666317334, -256.5138985155213, -57.69131615199865, -53.94665273465594, -286.54509492530104, -1163.9143249060442, -1118.2448655326039, -525.0743696810175, -573.0462495378122, -191.4233108939553, -251.22326409847008, -49.33903566011179, -422.27202944544445, -931.3264445468483, -87.8833142695508, -117.25169762166391, -45.34511133172756, -300.47767437545787, -121.43573980626384, -397.13925963710466, -113.1138117679619, -74.6142867613884, -1301.2595141465686, -134.97445671440408, -86.68155544404296, -89.7203672118321, -81.11222829495566, -407.5597555322766, -139.23056981803083, -1169.7992295655877, -378.6716439836531, -170.6691255012001, -143.9616887355961, -997.8628974818791, -76.14320208833729, -284.952775224872, -81.98923064790475, -529.0364792488571, -278.3896262523349, -134.91870419677784, -432.2550251175756, -37.6343991416856, -123.15978116478492, -91.38989588735241, -85.37223401586115, -1208.3612547049763, -432.48272660448885, -36.44068486595979, -432.41720243073894, -259.80079172925656, -203.9921215216911, -26.5156976106212, -353.976289289982, -58.94660234449079, -85.62524745977983, -495.75058188291143, -226.7145480440019, -138.9084279053647, -35.75425187953272, -672.8904426768584, -96.54570148300988, -60.347772038082724, -38.14359838648242, -70.12584737667552, -590.4403605686567, -1155.0318538285185, -1093.1154697150619, -1107.9166569369606], "episode_lengths": [150, 150, 150, 78, 150, 150, 45, 125, 47, 150, 102, 150, 94, 57, 114, 150, 113, 93, 65, 102, 53, 101, 51, 150, 150, 60, 150, 117, 76, 100, 57, 106, 144, 87, 47, 59, 101, 150, 150, 150, 124, 89, 107, 51, 109, 150, 71, 59, 45, 112, 71, 103, 68, 44, 150, 75, 67, 53, 52, 150, 80, 150, 142, 61, 74, 150, 60, 150, 66, 150, 96, 78, 132, 52, 69, 51, 58, 150, 150, 43, 150, 111, 69, 33, 150, 55, 59, 150, 101, 60, 40, 150, 68, 67, 36, 52, 150, 150, 150, 150], "policy_policy_0_reward": [-444.4431851183654, -1049.8644228892006, -427.3549061756433, -125.15396579917757, -757.8016324302628, -545.2483891640643, -43.44532167075512, -451.99686026813333, -125.94148395285883, -500.440671119491, -440.98539135668267, -419.20068651164127, -189.75172568670908, -43.52870099023547, -181.65631042774658, -980.8532523020821, -234.80829990276385, -262.7341296203872, -94.3940435731613, -321.4020916944118, -148.37283407751556, -275.0594462318008, -49.45081372048594, -423.4195493803401, -614.6063299443811, -125.80631447675519, -383.7020993520427, -280.03918679126144, -161.86242447866474, -251.26320013690238, -87.29789933207151, -190.3152496295207, -719.5564666317334, -256.5138985155213, -57.69131615199865, -53.94665273465594, -286.54509492530104, -1163.9143249060442, -1118.2448655326039, -525.0743696810175, -573.0462495378122, -191.4233108939553, -251.22326409847008, -49.33903566011179, -422.27202944544445, -931.3264445468483, -87.8833142695508, -117.25169762166391, -45.34511133172756, -300.47767437545787, -121.43573980626384, -397.13925963710466, -113.1138117679619, -74.6142867613884, -1301.2595141465686, -134.97445671440408, -86.68155544404296, -89.7203672118321, -81.11222829495566, -407.5597555322766, -139.23056981803083, -1169.7992295655877, -378.6716439836531, -170.6691255012001, -143.9616887355961, -997.8628974818791, -76.14320208833729, -284.952775224872, -81.98923064790475, -529.0364792488571, -278.3896262523349, -134.91870419677784, -432.2550251175756, -37.6343991416856, -123.15978116478492, -91.38989588735241, -85.37223401586115, -1208.3612547049763, -432.48272660448885, -36.44068486595979, -432.41720243073894, -259.80079172925656, -203.9921215216911, -26.5156976106212, -353.976289289982, -58.94660234449079, -85.62524745977983, -495.75058188291143, -226.7145480440019, -138.9084279053647, -35.75425187953272, -672.8904426768584, -96.54570148300988, -60.347772038082724, -38.14359838648242, -70.12584737667552, -590.4403605686567, -1155.0318538285185, -1093.1154697150619, -1107.9166569369606]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5623584353110558, "mean_inference_ms": 1.7236010658366303, "mean_action_processing_ms": 0.2763222945952326, "mean_env_wait_ms": 3.423836189332688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011812210083007812, "StateBufferConnector_ms": 0.007938385009765625, "ViewRequirementAgentConnector_ms": 0.19500017166137695}, "num_episodes": 44, "episode_return_max": -26.5156976106212, "episode_return_min": -1301.2595141465686, "episode_return_mean": -346.26567553738624, "episodes_this_iter": 44}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 331.0613324217309, "num_env_steps_trained_throughput_per_sec": 331.0613324217309, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 12581.773, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12581.697, "sample_time_ms": 1117.361, "learn_time_ms": 11401.691, "learn_throughput": 350.825, "synch_weights_time_ms": 61.815}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 52, "trial_id": "b33d0_00000", "date": "2024-08-06_14-51-05", "timestamp": 1722936065, "time_this_iter_s": 12.094828844070435, "time_total_s": 628.3570499420166, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2a8ca0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 628.3570499420166, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 18.141176470588235, "ram_util_percent": 29.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 131.79213335911433, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.841925795873006, "policy_loss": -0.02069779420805086, "vf_loss": 2.8527112773309153, "vf_explained_var": 0.981247524296244, "kl": 0.01601298789513147, "entropy": 0.8964390735452373, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 50400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "env_runners": {"episode_reward_max": -26.5156976106212, "episode_reward_min": -1394.8965583323488, "episode_reward_mean": -353.54687492588664, "episode_len_mean": 97.19, "episode_media": {}, "episodes_timesteps_total": 9719, "policy_reward_min": {"policy_0": -1394.8965583323488}, "policy_reward_max": {"policy_0": -26.5156976106212}, "policy_reward_mean": {"policy_0": -353.54687492588664}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1118.2448655326039, -525.0743696810175, -573.0462495378122, -191.4233108939553, -251.22326409847008, -49.33903566011179, -422.27202944544445, -931.3264445468483, -87.8833142695508, -117.25169762166391, -45.34511133172756, -300.47767437545787, -121.43573980626384, -397.13925963710466, -113.1138117679619, -74.6142867613884, -1301.2595141465686, -134.97445671440408, -86.68155544404296, -89.7203672118321, -81.11222829495566, -407.5597555322766, -139.23056981803083, -1169.7992295655877, -378.6716439836531, -170.6691255012001, -143.9616887355961, -997.8628974818791, -76.14320208833729, -284.952775224872, -81.98923064790475, -529.0364792488571, -278.3896262523349, -134.91870419677784, -432.2550251175756, -37.6343991416856, -123.15978116478492, -91.38989588735241, -85.37223401586115, -1208.3612547049763, -432.48272660448885, -36.44068486595979, -432.41720243073894, -259.80079172925656, -203.9921215216911, -26.5156976106212, -353.976289289982, -58.94660234449079, -85.62524745977983, -495.75058188291143, -226.7145480440019, -138.9084279053647, -35.75425187953272, -672.8904426768584, -96.54570148300988, -60.347772038082724, -38.14359838648242, -70.12584737667552, -590.4403605686567, -1155.0318538285185, -1093.1154697150619, -1107.9166569369606, -336.1532321188548, -983.664925978243, -230.8474899386766, -427.76039904705493, -1096.5427179084434, -60.17483270167712, -100.1105031818807, -298.0170358433764, -73.10813355392332, -100.83513484444434, -39.532336977735014, -84.93256494284122, -48.48855406758019, -135.00774834168422, -300.1266538140301, -1101.7763498845875, -954.7151194975949, -517.876682717315, -609.3846551968505, -173.63077806893065, -974.3922317669709, -172.81495930843184, -194.8281616589729, -244.9363163497892, -413.76523065414153, -184.44102105186982, -57.67986963662757, -116.82809499450806, -227.8814440168278, -313.7504962225282, -1394.8965583323488, -116.4997720478914, -550.0316559149303, -558.6263753922113, -124.79463856444836, -232.9830757191959, -250.1183824507303, -96.53437821265963], "episode_lengths": [150, 150, 124, 89, 107, 51, 109, 150, 71, 59, 45, 112, 71, 103, 68, 44, 150, 75, 67, 53, 52, 150, 80, 150, 142, 61, 74, 150, 60, 150, 66, 150, 96, 78, 132, 52, 69, 51, 58, 150, 150, 43, 150, 111, 69, 33, 150, 55, 59, 150, 101, 60, 40, 150, 68, 67, 36, 52, 150, 150, 150, 150, 126, 150, 113, 150, 150, 52, 61, 130, 42, 71, 42, 60, 49, 49, 112, 150, 150, 150, 150, 83, 150, 64, 75, 67, 150, 81, 51, 53, 108, 120, 150, 61, 150, 150, 72, 67, 78, 69], "policy_policy_0_reward": [-1118.2448655326039, -525.0743696810175, -573.0462495378122, -191.4233108939553, -251.22326409847008, -49.33903566011179, -422.27202944544445, -931.3264445468483, -87.8833142695508, -117.25169762166391, -45.34511133172756, -300.47767437545787, -121.43573980626384, -397.13925963710466, -113.1138117679619, -74.6142867613884, -1301.2595141465686, -134.97445671440408, -86.68155544404296, -89.7203672118321, -81.11222829495566, -407.5597555322766, -139.23056981803083, -1169.7992295655877, -378.6716439836531, -170.6691255012001, -143.9616887355961, -997.8628974818791, -76.14320208833729, -284.952775224872, -81.98923064790475, -529.0364792488571, -278.3896262523349, -134.91870419677784, -432.2550251175756, -37.6343991416856, -123.15978116478492, -91.38989588735241, -85.37223401586115, -1208.3612547049763, -432.48272660448885, -36.44068486595979, -432.41720243073894, -259.80079172925656, -203.9921215216911, -26.5156976106212, -353.976289289982, -58.94660234449079, -85.62524745977983, -495.75058188291143, -226.7145480440019, -138.9084279053647, -35.75425187953272, -672.8904426768584, -96.54570148300988, -60.347772038082724, -38.14359838648242, -70.12584737667552, -590.4403605686567, -1155.0318538285185, -1093.1154697150619, -1107.9166569369606, -336.1532321188548, -983.664925978243, -230.8474899386766, -427.76039904705493, -1096.5427179084434, -60.17483270167712, -100.1105031818807, -298.0170358433764, -73.10813355392332, -100.83513484444434, -39.532336977735014, -84.93256494284122, -48.48855406758019, -135.00774834168422, -300.1266538140301, -1101.7763498845875, -954.7151194975949, -517.876682717315, -609.3846551968505, -173.63077806893065, -974.3922317669709, -172.81495930843184, -194.8281616589729, -244.9363163497892, -413.76523065414153, -184.44102105186982, -57.67986963662757, -116.82809499450806, -227.8814440168278, -313.7504962225282, -1394.8965583323488, -116.4997720478914, -550.0316559149303, -558.6263753922113, -124.79463856444836, -232.9830757191959, -250.1183824507303, -96.53437821265963]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.562002660253466, "mean_inference_ms": 1.7226372361135673, "mean_action_processing_ms": 0.27598278775089324, "mean_env_wait_ms": 3.42164410624305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011790752410888672, "StateBufferConnector_ms": 0.007924556732177734, "ViewRequirementAgentConnector_ms": 0.1904304027557373}, "num_episodes": 38, "episode_return_max": -26.5156976106212, "episode_return_min": -1394.8965583323488, "episode_return_mean": -353.54687492588664, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.26132401466543, "num_env_steps_trained_throughput_per_sec": 317.26132401466543, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 212000, "timers": {"training_iteration_time_ms": 12568.443, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12568.369, "sample_time_ms": 1114.589, "learn_time_ms": 11391.487, "learn_throughput": 351.139, "synch_weights_time_ms": 61.465}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "done": false, "training_iteration": 53, "trial_id": "b33d0_00000", "date": "2024-08-06_14-51-18", "timestamp": 1722936078, "time_this_iter_s": 12.619867086410522, "time_total_s": 640.9769170284271, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2aa9e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 640.9769170284271, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 17.61666666666667, "ram_util_percent": 29.299999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 106.54014724493027, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.1876320598026116, "policy_loss": -0.014241846749791875, "vf_loss": 3.193374290689826, "vf_explained_var": 0.9592535310735305, "kl": 0.013697815138706024, "entropy": 0.7464050279619793, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 51360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "env_runners": {"episode_reward_max": -26.5156976106212, "episode_reward_min": -1394.8965583323488, "episode_reward_mean": -319.5403590973603, "episode_len_mean": 94.42, "episode_media": {}, "episodes_timesteps_total": 9442, "policy_reward_min": {"policy_0": -1394.8965583323488}, "policy_reward_max": {"policy_0": -26.5156976106212}, "policy_reward_mean": {"policy_0": -319.5403590973603}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-203.9921215216911, -26.5156976106212, -353.976289289982, -58.94660234449079, -85.62524745977983, -495.75058188291143, -226.7145480440019, -138.9084279053647, -35.75425187953272, -672.8904426768584, -96.54570148300988, -60.347772038082724, -38.14359838648242, -70.12584737667552, -590.4403605686567, -1155.0318538285185, -1093.1154697150619, -1107.9166569369606, -336.1532321188548, -983.664925978243, -230.8474899386766, -427.76039904705493, -1096.5427179084434, -60.17483270167712, -100.1105031818807, -298.0170358433764, -73.10813355392332, -100.83513484444434, -39.532336977735014, -84.93256494284122, -48.48855406758019, -135.00774834168422, -300.1266538140301, -1101.7763498845875, -954.7151194975949, -517.876682717315, -609.3846551968505, -173.63077806893065, -974.3922317669709, -172.81495930843184, -194.8281616589729, -244.9363163497892, -413.76523065414153, -184.44102105186982, -57.67986963662757, -116.82809499450806, -227.8814440168278, -313.7504962225282, -1394.8965583323488, -116.4997720478914, -550.0316559149303, -558.6263753922113, -124.79463856444836, -232.9830757191959, -250.1183824507303, -96.53437821265963, -470.80005608147957, -44.99754276084333, -196.73885595301064, -915.7326824132083, -163.0729762992022, -37.79486230635591, -506.7632804130638, -65.53865452450313, -67.42399949314984, -298.90038658420053, -61.55659630580232, -234.62241023203737, -418.4702215733048, -132.10482467124757, -401.2859789583829, -71.96141978400622, -107.53405067726283, -313.09007648623475, -1172.9254969233666, -1127.6942559830725, -191.63516262433745, -236.12199716499669, -101.41684383457957, -115.80286678585128, -134.70782310609988, -113.31241494937127, -84.17343665676385, -643.280535132325, -41.78071813044005, -513.4526694609253, -189.23211020034688, -364.5232907807231, -154.13427415125977, -44.94430442152475, -63.28927469569126, -139.8918222006146, -31.701737173658703, -455.24814095532764, -88.12027802179774, -42.46458416958788, -169.4328911223943, -105.2130251306029, -456.15964570649254, -255.75745286709252], "episode_lengths": [69, 33, 150, 55, 59, 150, 101, 60, 40, 150, 68, 67, 36, 52, 150, 150, 150, 150, 126, 150, 113, 150, 150, 52, 61, 130, 42, 71, 42, 60, 49, 49, 112, 150, 150, 150, 150, 83, 150, 64, 75, 67, 150, 81, 51, 53, 108, 120, 150, 61, 150, 150, 72, 67, 78, 69, 150, 53, 61, 145, 71, 53, 150, 73, 66, 111, 57, 90, 143, 77, 125, 48, 74, 109, 150, 150, 87, 107, 70, 73, 50, 64, 64, 150, 49, 140, 88, 150, 53, 56, 44, 72, 41, 150, 75, 53, 95, 61, 150, 98], "policy_policy_0_reward": [-203.9921215216911, -26.5156976106212, -353.976289289982, -58.94660234449079, -85.62524745977983, -495.75058188291143, -226.7145480440019, -138.9084279053647, -35.75425187953272, -672.8904426768584, -96.54570148300988, -60.347772038082724, -38.14359838648242, -70.12584737667552, -590.4403605686567, -1155.0318538285185, -1093.1154697150619, -1107.9166569369606, -336.1532321188548, -983.664925978243, -230.8474899386766, -427.76039904705493, -1096.5427179084434, -60.17483270167712, -100.1105031818807, -298.0170358433764, -73.10813355392332, -100.83513484444434, -39.532336977735014, -84.93256494284122, -48.48855406758019, -135.00774834168422, -300.1266538140301, -1101.7763498845875, -954.7151194975949, -517.876682717315, -609.3846551968505, -173.63077806893065, -974.3922317669709, -172.81495930843184, -194.8281616589729, -244.9363163497892, -413.76523065414153, -184.44102105186982, -57.67986963662757, -116.82809499450806, -227.8814440168278, -313.7504962225282, -1394.8965583323488, -116.4997720478914, -550.0316559149303, -558.6263753922113, -124.79463856444836, -232.9830757191959, -250.1183824507303, -96.53437821265963, -470.80005608147957, -44.99754276084333, -196.73885595301064, -915.7326824132083, -163.0729762992022, -37.79486230635591, -506.7632804130638, -65.53865452450313, -67.42399949314984, -298.90038658420053, -61.55659630580232, -234.62241023203737, -418.4702215733048, -132.10482467124757, -401.2859789583829, -71.96141978400622, -107.53405067726283, -313.09007648623475, -1172.9254969233666, -1127.6942559830725, -191.63516262433745, -236.12199716499669, -101.41684383457957, -115.80286678585128, -134.70782310609988, -113.31241494937127, -84.17343665676385, -643.280535132325, -41.78071813044005, -513.4526694609253, -189.23211020034688, -364.5232907807231, -154.13427415125977, -44.94430442152475, -63.28927469569126, -139.8918222006146, -31.701737173658703, -455.24814095532764, -88.12027802179774, -42.46458416958788, -169.4328911223943, -105.2130251306029, -456.15964570649254, -255.75745286709252]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5620983353381485, "mean_inference_ms": 1.7213376495459238, "mean_action_processing_ms": 0.27556174167185726, "mean_env_wait_ms": 3.4188488641301786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011924028396606445, "StateBufferConnector_ms": 0.007920980453491211, "ViewRequirementAgentConnector_ms": 0.19243955612182617}, "num_episodes": 44, "episode_return_max": -26.5156976106212, "episode_return_min": -1394.8965583323488, "episode_return_mean": -319.5403590973603, "episodes_this_iter": 44}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 419.2840593811745, "num_env_steps_trained_throughput_per_sec": 419.2840593811745, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 12233.845, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12233.772, "sample_time_ms": 1115.018, "learn_time_ms": 11055.858, "learn_throughput": 361.799, "synch_weights_time_ms": 62.064}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "training_iteration": 54, "trial_id": "b33d0_00000", "date": "2024-08-06_14-51-27", "timestamp": 1722936087, "time_this_iter_s": 9.552459239959717, "time_total_s": 650.5293762683868, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c1269e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 650.5293762683868, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 19.835714285714285, "ram_util_percent": 29.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 151.1740389128526, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.9957138487448294, "policy_loss": -0.011434840738850956, "vf_loss": 2.9972027130424976, "vf_explained_var": 0.9829914402216673, "kl": 0.016282478096157623, "entropy": 1.0446899441381297, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 52320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "env_runners": {"episode_reward_max": -31.701737173658703, "episode_reward_min": -1394.8965583323488, "episode_reward_mean": -345.2341801006876, "episode_len_mean": 100.86, "episode_media": {}, "episodes_timesteps_total": 10086, "policy_reward_min": {"policy_0": -1394.8965583323488}, "policy_reward_max": {"policy_0": -31.701737173658703}, "policy_reward_mean": {"policy_0": -345.2341801006876}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-517.876682717315, -609.3846551968505, -173.63077806893065, -974.3922317669709, -172.81495930843184, -194.8281616589729, -244.9363163497892, -413.76523065414153, -184.44102105186982, -57.67986963662757, -116.82809499450806, -227.8814440168278, -313.7504962225282, -1394.8965583323488, -116.4997720478914, -550.0316559149303, -558.6263753922113, -124.79463856444836, -232.9830757191959, -250.1183824507303, -96.53437821265963, -470.80005608147957, -44.99754276084333, -196.73885595301064, -915.7326824132083, -163.0729762992022, -37.79486230635591, -506.7632804130638, -65.53865452450313, -67.42399949314984, -298.90038658420053, -61.55659630580232, -234.62241023203737, -418.4702215733048, -132.10482467124757, -401.2859789583829, -71.96141978400622, -107.53405067726283, -313.09007648623475, -1172.9254969233666, -1127.6942559830725, -191.63516262433745, -236.12199716499669, -101.41684383457957, -115.80286678585128, -134.70782310609988, -113.31241494937127, -84.17343665676385, -643.280535132325, -41.78071813044005, -513.4526694609253, -189.23211020034688, -364.5232907807231, -154.13427415125977, -44.94430442152475, -63.28927469569126, -139.8918222006146, -31.701737173658703, -455.24814095532764, -88.12027802179774, -42.46458416958788, -169.4328911223943, -105.2130251306029, -456.15964570649254, -255.75745286709252, -1015.0334169517103, -247.4190938697278, -153.66075041138762, -156.87102030778814, -435.875714107844, -401.96792304643304, -227.7698848574374, -1210.273728591172, -73.49646764259865, -1067.1018966694153, -1228.3051233437745, -80.01209754000189, -274.24656252926707, -64.93981192098246, -1339.9925913413397, -55.36815106395005, -99.30947005532833, -234.89700956630205, -572.1475878388296, -126.92834038109675, -1018.0633973668579, -346.2380415841523, -466.7268451919327, -332.37450658418624, -232.39811428513772, -372.2020282749331, -312.9834219878732, -447.5429997406575, -119.67454507395964, -528.3483370375563, -156.80717904393003, -255.6993273534147, -253.5902737163156, -387.0570593402439, -1156.5945853065], "episode_lengths": [150, 150, 83, 150, 64, 75, 67, 150, 81, 51, 53, 108, 120, 150, 61, 150, 150, 72, 67, 78, 69, 150, 53, 61, 145, 71, 53, 150, 73, 66, 111, 57, 90, 143, 77, 125, 48, 74, 109, 150, 150, 87, 107, 70, 73, 50, 64, 64, 150, 49, 140, 88, 150, 53, 56, 44, 72, 41, 150, 75, 53, 95, 61, 150, 98, 150, 97, 103, 77, 133, 150, 111, 150, 66, 150, 150, 60, 108, 57, 150, 42, 69, 123, 150, 50, 150, 150, 150, 110, 99, 122, 119, 150, 53, 150, 84, 109, 99, 150, 150], "policy_policy_0_reward": [-517.876682717315, -609.3846551968505, -173.63077806893065, -974.3922317669709, -172.81495930843184, -194.8281616589729, -244.9363163497892, -413.76523065414153, -184.44102105186982, -57.67986963662757, -116.82809499450806, -227.8814440168278, -313.7504962225282, -1394.8965583323488, -116.4997720478914, -550.0316559149303, -558.6263753922113, -124.79463856444836, -232.9830757191959, -250.1183824507303, -96.53437821265963, -470.80005608147957, -44.99754276084333, -196.73885595301064, -915.7326824132083, -163.0729762992022, -37.79486230635591, -506.7632804130638, -65.53865452450313, -67.42399949314984, -298.90038658420053, -61.55659630580232, -234.62241023203737, -418.4702215733048, -132.10482467124757, -401.2859789583829, -71.96141978400622, -107.53405067726283, -313.09007648623475, -1172.9254969233666, -1127.6942559830725, -191.63516262433745, -236.12199716499669, -101.41684383457957, -115.80286678585128, -134.70782310609988, -113.31241494937127, -84.17343665676385, -643.280535132325, -41.78071813044005, -513.4526694609253, -189.23211020034688, -364.5232907807231, -154.13427415125977, -44.94430442152475, -63.28927469569126, -139.8918222006146, -31.701737173658703, -455.24814095532764, -88.12027802179774, -42.46458416958788, -169.4328911223943, -105.2130251306029, -456.15964570649254, -255.75745286709252, -1015.0334169517103, -247.4190938697278, -153.66075041138762, -156.87102030778814, -435.875714107844, -401.96792304643304, -227.7698848574374, -1210.273728591172, -73.49646764259865, -1067.1018966694153, -1228.3051233437745, -80.01209754000189, -274.24656252926707, -64.93981192098246, -1339.9925913413397, -55.36815106395005, -99.30947005532833, -234.89700956630205, -572.1475878388296, -126.92834038109675, -1018.0633973668579, -346.2380415841523, -466.7268451919327, -332.37450658418624, -232.39811428513772, -372.2020282749331, -312.9834219878732, -447.5429997406575, -119.67454507395964, -528.3483370375563, -156.80717904393003, -255.6993273534147, -253.5902737163156, -387.0570593402439, -1156.5945853065]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5620020409593762, "mean_inference_ms": 1.7218910481656817, "mean_action_processing_ms": 0.2757128107359456, "mean_env_wait_ms": 3.4204965549019364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012244939804077148, "StateBufferConnector_ms": 0.007951021194458008, "ViewRequirementAgentConnector_ms": 0.19208073616027832}, "num_episodes": 35, "episode_return_max": -31.701737173658703, "episode_return_min": -1394.8965583323488, "episode_return_mean": -345.2341801006876, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.8631130207521, "num_env_steps_trained_throughput_per_sec": 311.8631130207521, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 12331.349, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12331.276, "sample_time_ms": 1115.235, "learn_time_ms": 11151.95, "learn_throughput": 358.682, "synch_weights_time_ms": 63.273}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "done": false, "training_iteration": 55, "trial_id": "b33d0_00000", "date": "2024-08-06_14-51-40", "timestamp": 1722936100, "time_this_iter_s": 12.83934235572815, "time_total_s": 663.368718624115, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c124af0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 663.368718624115, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 17.755555555555556, "ram_util_percent": 29.299999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 138.61454179883003, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.653657052634905, "policy_loss": -0.015103732552961446, "vf_loss": 2.656336228301128, "vf_explained_var": 0.9874973888198535, "kl": 0.019596200995753602, "entropy": 0.8028703022748231, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 53280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": -31.701737173658703, "episode_reward_min": -1339.9925913413397, "episode_reward_mean": -352.76879481628043, "episode_len_mean": 102.93, "episode_media": {}, "episodes_timesteps_total": 10293, "policy_reward_min": {"policy_0": -1339.9925913413397}, "policy_reward_max": {"policy_0": -31.701737173658703}, "policy_reward_mean": {"policy_0": -352.76879481628043}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1172.9254969233666, -1127.6942559830725, -191.63516262433745, -236.12199716499669, -101.41684383457957, -115.80286678585128, -134.70782310609988, -113.31241494937127, -84.17343665676385, -643.280535132325, -41.78071813044005, -513.4526694609253, -189.23211020034688, -364.5232907807231, -154.13427415125977, -44.94430442152475, -63.28927469569126, -139.8918222006146, -31.701737173658703, -455.24814095532764, -88.12027802179774, -42.46458416958788, -169.4328911223943, -105.2130251306029, -456.15964570649254, -255.75745286709252, -1015.0334169517103, -247.4190938697278, -153.66075041138762, -156.87102030778814, -435.875714107844, -401.96792304643304, -227.7698848574374, -1210.273728591172, -73.49646764259865, -1067.1018966694153, -1228.3051233437745, -80.01209754000189, -274.24656252926707, -64.93981192098246, -1339.9925913413397, -55.36815106395005, -99.30947005532833, -234.89700956630205, -572.1475878388296, -126.92834038109675, -1018.0633973668579, -346.2380415841523, -466.7268451919327, -332.37450658418624, -232.39811428513772, -372.2020282749331, -312.9834219878732, -447.5429997406575, -119.67454507395964, -528.3483370375563, -156.80717904393003, -255.6993273534147, -253.5902737163156, -387.0570593402439, -1156.5945853065, -202.01838445724002, -222.48589437310468, -96.4337472645263, -424.0428249853443, -726.6239369568495, -1327.5825993233702, -434.02215904256207, -170.4994388459208, -539.6914193971868, -1070.2225189201306, -132.4502536319972, -139.48839032717376, -110.42025386862888, -498.66173992625284, -45.67446233501282, -250.61866605104152, -465.9042682269942, -176.01868232370978, -219.0304269704118, -346.24077220988534, -244.50373505286763, -196.48405090850673, -295.9094652833325, -437.24810466851636, -245.2196518395733, -228.27925595398628, -35.867749088051504, -146.95359771011525, -103.96955035917705, -269.7154548214991, -251.2762773303428, -79.08833109501646, -487.61718402001605, -86.83654953913458, -1102.506062521014, -102.71194661730755, -389.279781599734, -134.79827892136638, -352.1492585878578], "episode_lengths": [150, 150, 87, 107, 70, 73, 50, 64, 64, 150, 49, 140, 88, 150, 53, 56, 44, 72, 41, 150, 75, 53, 95, 61, 150, 98, 150, 97, 103, 77, 133, 150, 111, 150, 66, 150, 150, 60, 108, 57, 150, 42, 69, 123, 150, 50, 150, 150, 150, 110, 99, 122, 119, 150, 53, 150, 84, 109, 99, 150, 150, 90, 107, 69, 150, 149, 150, 134, 62, 150, 150, 83, 75, 75, 150, 54, 70, 150, 59, 107, 129, 108, 104, 82, 131, 86, 71, 46, 80, 67, 115, 94, 68, 150, 44, 150, 65, 133, 55, 150], "policy_policy_0_reward": [-1172.9254969233666, -1127.6942559830725, -191.63516262433745, -236.12199716499669, -101.41684383457957, -115.80286678585128, -134.70782310609988, -113.31241494937127, -84.17343665676385, -643.280535132325, -41.78071813044005, -513.4526694609253, -189.23211020034688, -364.5232907807231, -154.13427415125977, -44.94430442152475, -63.28927469569126, -139.8918222006146, -31.701737173658703, -455.24814095532764, -88.12027802179774, -42.46458416958788, -169.4328911223943, -105.2130251306029, -456.15964570649254, -255.75745286709252, -1015.0334169517103, -247.4190938697278, -153.66075041138762, -156.87102030778814, -435.875714107844, -401.96792304643304, -227.7698848574374, -1210.273728591172, -73.49646764259865, -1067.1018966694153, -1228.3051233437745, -80.01209754000189, -274.24656252926707, -64.93981192098246, -1339.9925913413397, -55.36815106395005, -99.30947005532833, -234.89700956630205, -572.1475878388296, -126.92834038109675, -1018.0633973668579, -346.2380415841523, -466.7268451919327, -332.37450658418624, -232.39811428513772, -372.2020282749331, -312.9834219878732, -447.5429997406575, -119.67454507395964, -528.3483370375563, -156.80717904393003, -255.6993273534147, -253.5902737163156, -387.0570593402439, -1156.5945853065, -202.01838445724002, -222.48589437310468, -96.4337472645263, -424.0428249853443, -726.6239369568495, -1327.5825993233702, -434.02215904256207, -170.4994388459208, -539.6914193971868, -1070.2225189201306, -132.4502536319972, -139.48839032717376, -110.42025386862888, -498.66173992625284, -45.67446233501282, -250.61866605104152, -465.9042682269942, -176.01868232370978, -219.0304269704118, -346.24077220988534, -244.50373505286763, -196.48405090850673, -295.9094652833325, -437.24810466851636, -245.2196518395733, -228.27925595398628, -35.867749088051504, -146.95359771011525, -103.96955035917705, -269.7154548214991, -251.2762773303428, -79.08833109501646, -487.61718402001605, -86.83654953913458, -1102.506062521014, -102.71194661730755, -389.279781599734, -134.79827892136638, -352.1492585878578]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5621350675434167, "mean_inference_ms": 1.7200400978114323, "mean_action_processing_ms": 0.2757261168682488, "mean_env_wait_ms": 3.418292799870492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011960983276367188, "StateBufferConnector_ms": 0.008053302764892578, "ViewRequirementAgentConnector_ms": 0.19386029243469238}, "num_episodes": 39, "episode_return_max": -31.701737173658703, "episode_return_min": -1339.9925913413397, "episode_return_mean": -352.76879481628043, "episodes_this_iter": 39}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.27708383752633, "num_env_steps_trained_throughput_per_sec": 311.27708383752633, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 12344.599, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12344.527, "sample_time_ms": 1114.376, "learn_time_ms": 11166.019, "learn_throughput": 358.23, "synch_weights_time_ms": 63.317}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 56, "trial_id": "b33d0_00000", "date": "2024-08-06_14-51-53", "timestamp": 1722936113, "time_this_iter_s": 12.862849235534668, "time_total_s": 676.2315678596497, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2aa9e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 676.2315678596497, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 17.78888888888889, "ram_util_percent": 29.299999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 138.20310772657393, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.2168091259275875, "policy_loss": -0.01381980739630914, "vf_loss": 2.2218131166572372, "vf_explained_var": 0.9739022326345245, "kl": 0.014073497652983253, "entropy": 0.6837991549943884, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 54240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "env_runners": {"episode_reward_max": -28.9709314621365, "episode_reward_min": -1327.5825993233702, "episode_reward_mean": -324.4760094259158, "episode_len_mean": 101.52, "episode_media": {}, "episodes_timesteps_total": 10152, "policy_reward_min": {"policy_0": -1327.5825993233702}, "policy_reward_max": {"policy_0": -28.9709314621365}, "policy_reward_mean": {"policy_0": -324.4760094259158}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1018.0633973668579, -346.2380415841523, -466.7268451919327, -332.37450658418624, -232.39811428513772, -372.2020282749331, -312.9834219878732, -447.5429997406575, -119.67454507395964, -528.3483370375563, -156.80717904393003, -255.6993273534147, -253.5902737163156, -387.0570593402439, -1156.5945853065, -202.01838445724002, -222.48589437310468, -96.4337472645263, -424.0428249853443, -726.6239369568495, -1327.5825993233702, -434.02215904256207, -170.4994388459208, -539.6914193971868, -1070.2225189201306, -132.4502536319972, -139.48839032717376, -110.42025386862888, -498.66173992625284, -45.67446233501282, -250.61866605104152, -465.9042682269942, -176.01868232370978, -219.0304269704118, -346.24077220988534, -244.50373505286763, -196.48405090850673, -295.9094652833325, -437.24810466851636, -245.2196518395733, -228.27925595398628, -35.867749088051504, -146.95359771011525, -103.96955035917705, -269.7154548214991, -251.2762773303428, -79.08833109501646, -487.61718402001605, -86.83654953913458, -1102.506062521014, -102.71194661730755, -389.279781599734, -134.79827892136638, -352.1492585878578, -928.8006167313317, -148.14356713453458, -362.5560838930022, -317.56895419565586, -479.98594498751714, -57.91510190009722, -138.73203863380974, -164.20762302754832, -160.1193108694789, -324.07603509473233, -43.12388218269689, -73.32431868112437, -101.5024492089004, -938.5531940762436, -211.06858928090602, -28.9709314621365, -115.78782380414451, -90.95519249787948, -139.55902618610435, -65.19889387450196, -170.58664391559498, -78.9590760084276, -344.1944578495028, -188.57228787968873, -918.6562060856988, -181.3740147111964, -428.2547295855401, -165.67896458023887, -171.96531730550572, -578.8447611077662, -484.2855443270875, -381.661718165919, -668.5228325641102, -191.0374311060621, -56.81543580780334, -168.86847965918165, -314.71769575209925, -186.626923406557, -138.92724257141413, -210.00006666324626, -189.3891963933435, -1058.238527308136, -153.62789484276897, -303.54106035571573, -493.94326223595704, -155.31580743826154], "episode_lengths": [150, 150, 150, 110, 99, 122, 119, 150, 53, 150, 84, 109, 99, 150, 150, 90, 107, 69, 150, 149, 150, 134, 62, 150, 150, 83, 75, 75, 150, 54, 70, 150, 59, 107, 129, 108, 104, 82, 131, 86, 71, 46, 80, 67, 115, 94, 68, 150, 44, 150, 65, 133, 55, 150, 150, 55, 109, 120, 150, 51, 69, 92, 58, 121, 50, 63, 68, 150, 89, 43, 48, 46, 67, 57, 66, 66, 136, 78, 150, 126, 142, 63, 84, 148, 139, 126, 150, 83, 56, 62, 104, 90, 80, 95, 78, 150, 70, 111, 150, 86], "policy_policy_0_reward": [-1018.0633973668579, -346.2380415841523, -466.7268451919327, -332.37450658418624, -232.39811428513772, -372.2020282749331, -312.9834219878732, -447.5429997406575, -119.67454507395964, -528.3483370375563, -156.80717904393003, -255.6993273534147, -253.5902737163156, -387.0570593402439, -1156.5945853065, -202.01838445724002, -222.48589437310468, -96.4337472645263, -424.0428249853443, -726.6239369568495, -1327.5825993233702, -434.02215904256207, -170.4994388459208, -539.6914193971868, -1070.2225189201306, -132.4502536319972, -139.48839032717376, -110.42025386862888, -498.66173992625284, -45.67446233501282, -250.61866605104152, -465.9042682269942, -176.01868232370978, -219.0304269704118, -346.24077220988534, -244.50373505286763, -196.48405090850673, -295.9094652833325, -437.24810466851636, -245.2196518395733, -228.27925595398628, -35.867749088051504, -146.95359771011525, -103.96955035917705, -269.7154548214991, -251.2762773303428, -79.08833109501646, -487.61718402001605, -86.83654953913458, -1102.506062521014, -102.71194661730755, -389.279781599734, -134.79827892136638, -352.1492585878578, -928.8006167313317, -148.14356713453458, -362.5560838930022, -317.56895419565586, -479.98594498751714, -57.91510190009722, -138.73203863380974, -164.20762302754832, -160.1193108694789, -324.07603509473233, -43.12388218269689, -73.32431868112437, -101.5024492089004, -938.5531940762436, -211.06858928090602, -28.9709314621365, -115.78782380414451, -90.95519249787948, -139.55902618610435, -65.19889387450196, -170.58664391559498, -78.9590760084276, -344.1944578495028, -188.57228787968873, -918.6562060856988, -181.3740147111964, -428.2547295855401, -165.67896458023887, -171.96531730550572, -578.8447611077662, -484.2855443270875, -381.661718165919, -668.5228325641102, -191.0374311060621, -56.81543580780334, -168.86847965918165, -314.71769575209925, -186.626923406557, -138.92724257141413, -210.00006666324626, -189.3891963933435, -1058.238527308136, -153.62789484276897, -303.54106035571573, -493.94326223595704, -155.31580743826154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5621963363385648, "mean_inference_ms": 1.7195452522408374, "mean_action_processing_ms": 0.27588008005634646, "mean_env_wait_ms": 3.4187872770561945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011759757995605469, "StateBufferConnector_ms": 0.00811457633972168, "ViewRequirementAgentConnector_ms": 0.20195341110229492}, "num_episodes": 46, "episode_return_max": -28.9709314621365, "episode_return_min": -1327.5825993233702, "episode_return_mean": -324.4760094259158, "episodes_this_iter": 46}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.0994124939075, "num_env_steps_trained_throughput_per_sec": 309.0994124939075, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 12421.441, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12421.369, "sample_time_ms": 1112.687, "learn_time_ms": 11244.591, "learn_throughput": 355.727, "synch_weights_time_ms": 63.307}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "training_iteration": 57, "trial_id": "b33d0_00000", "date": "2024-08-06_14-52-06", "timestamp": 1722936126, "time_this_iter_s": 12.952584743499756, "time_total_s": 689.1841526031494, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c168550>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 689.1841526031494, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 17.30526315789474, "ram_util_percent": 29.299999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 101.11262945334117, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.9423214075465998, "policy_loss": -0.023828835236781743, "vf_loss": 2.9542320402959983, "vf_explained_var": 0.9899170699218909, "kl": 0.01873547055565723, "entropy": 0.7282405061957736, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 55200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "env_runners": {"episode_reward_max": -3.3165383117092566, "episode_reward_min": -1146.0342361314085, "episode_reward_mean": -262.70746936046316, "episode_len_mean": 91.93, "episode_media": {}, "episodes_timesteps_total": 9193, "policy_reward_min": {"policy_0": -1146.0342361314085}, "policy_reward_max": {"policy_0": -3.3165383117092566}, "policy_reward_mean": {"policy_0": -262.70746936046316}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-295.9094652833325, -437.24810466851636, -245.2196518395733, -228.27925595398628, -35.867749088051504, -146.95359771011525, -103.96955035917705, -269.7154548214991, -251.2762773303428, -79.08833109501646, -487.61718402001605, -86.83654953913458, -1102.506062521014, -102.71194661730755, -389.279781599734, -134.79827892136638, -352.1492585878578, -928.8006167313317, -148.14356713453458, -362.5560838930022, -317.56895419565586, -479.98594498751714, -57.91510190009722, -138.73203863380974, -164.20762302754832, -160.1193108694789, -324.07603509473233, -43.12388218269689, -73.32431868112437, -101.5024492089004, -938.5531940762436, -211.06858928090602, -28.9709314621365, -115.78782380414451, -90.95519249787948, -139.55902618610435, -65.19889387450196, -170.58664391559498, -78.9590760084276, -344.1944578495028, -188.57228787968873, -918.6562060856988, -181.3740147111964, -428.2547295855401, -165.67896458023887, -171.96531730550572, -578.8447611077662, -484.2855443270875, -381.661718165919, -668.5228325641102, -191.0374311060621, -56.81543580780334, -168.86847965918165, -314.71769575209925, -186.626923406557, -138.92724257141413, -210.00006666324626, -189.3891963933435, -1058.238527308136, -153.62789484276897, -303.54106035571573, -493.94326223595704, -155.31580743826154, -121.71500526905228, -60.62332253590048, -86.87466090292654, -88.42799663055752, -157.06156952314882, -488.9402546891685, -209.5538856076183, -194.52515861343014, -60.41221452365923, -198.3042254016422, -87.98544950228974, -76.02357874393074, -179.6455219275307, -84.75286466614833, -56.39214201597219, -244.0842142051125, -109.30714266689412, -254.2889743617076, -208.56979459500647, -127.13575592606887, -415.16459962460107, -279.75656498556134, -183.1818280163433, -347.4277643973637, -581.1026685510213, -3.3165383117092566, -452.64073247848273, -64.9219710582418, -121.87092608906634, -195.64794754213506, -1146.0342361314085, -161.55112853173364, -250.35668942308493, -65.71407632424341, -102.73663507352327, -505.4274504568544, -277.08979143796984], "episode_lengths": [82, 131, 86, 71, 46, 80, 67, 115, 94, 68, 150, 44, 150, 65, 133, 55, 150, 150, 55, 109, 120, 150, 51, 69, 92, 58, 121, 50, 63, 68, 150, 89, 43, 48, 46, 67, 57, 66, 66, 136, 78, 150, 126, 142, 63, 84, 148, 139, 126, 150, 83, 56, 62, 104, 90, 80, 95, 78, 150, 70, 111, 150, 86, 77, 58, 49, 52, 59, 143, 93, 109, 57, 90, 45, 61, 86, 64, 54, 75, 68, 120, 95, 76, 134, 114, 81, 130, 150, 31, 150, 60, 71, 97, 150, 79, 99, 67, 53, 150, 114], "policy_policy_0_reward": [-295.9094652833325, -437.24810466851636, -245.2196518395733, -228.27925595398628, -35.867749088051504, -146.95359771011525, -103.96955035917705, -269.7154548214991, -251.2762773303428, -79.08833109501646, -487.61718402001605, -86.83654953913458, -1102.506062521014, -102.71194661730755, -389.279781599734, -134.79827892136638, -352.1492585878578, -928.8006167313317, -148.14356713453458, -362.5560838930022, -317.56895419565586, -479.98594498751714, -57.91510190009722, -138.73203863380974, -164.20762302754832, -160.1193108694789, -324.07603509473233, -43.12388218269689, -73.32431868112437, -101.5024492089004, -938.5531940762436, -211.06858928090602, -28.9709314621365, -115.78782380414451, -90.95519249787948, -139.55902618610435, -65.19889387450196, -170.58664391559498, -78.9590760084276, -344.1944578495028, -188.57228787968873, -918.6562060856988, -181.3740147111964, -428.2547295855401, -165.67896458023887, -171.96531730550572, -578.8447611077662, -484.2855443270875, -381.661718165919, -668.5228325641102, -191.0374311060621, -56.81543580780334, -168.86847965918165, -314.71769575209925, -186.626923406557, -138.92724257141413, -210.00006666324626, -189.3891963933435, -1058.238527308136, -153.62789484276897, -303.54106035571573, -493.94326223595704, -155.31580743826154, -121.71500526905228, -60.62332253590048, -86.87466090292654, -88.42799663055752, -157.06156952314882, -488.9402546891685, -209.5538856076183, -194.52515861343014, -60.41221452365923, -198.3042254016422, -87.98544950228974, -76.02357874393074, -179.6455219275307, -84.75286466614833, -56.39214201597219, -244.0842142051125, -109.30714266689412, -254.2889743617076, -208.56979459500647, -127.13575592606887, -415.16459962460107, -279.75656498556134, -183.1818280163433, -347.4277643973637, -581.1026685510213, -3.3165383117092566, -452.64073247848273, -64.9219710582418, -121.87092608906634, -195.64794754213506, -1146.0342361314085, -161.55112853173364, -250.35668942308493, -65.71407632424341, -102.73663507352327, -505.4274504568544, -277.08979143796984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5621225492246239, "mean_inference_ms": 1.7184106798066368, "mean_action_processing_ms": 0.275894922873425, "mean_env_wait_ms": 3.417165399391562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011771678924560547, "StateBufferConnector_ms": 0.008109092712402344, "ViewRequirementAgentConnector_ms": 0.19945001602172852}, "num_episodes": 37, "episode_return_max": -3.3165383117092566, "episode_return_min": -1146.0342361314085, "episode_return_mean": -262.70746936046316, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 327.9454692953206, "num_env_steps_trained_throughput_per_sec": 327.9454692953206, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 12379.819, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12379.747, "sample_time_ms": 1099.104, "learn_time_ms": 11216.835, "learn_throughput": 356.607, "synch_weights_time_ms": 63.033}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "training_iteration": 58, "trial_id": "b33d0_00000", "date": "2024-08-06_14-52-18", "timestamp": 1722936138, "time_this_iter_s": 12.209654808044434, "time_total_s": 701.3938074111938, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c125c60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 701.3938074111938, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 18.099999999999998, "ram_util_percent": 29.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 139.77567111651103, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.5201355098436276, "policy_loss": -0.02098290606518276, "vf_loss": 2.5288585347433883, "vf_explained_var": 0.9923106419543425, "kl": 0.01940676345640592, "entropy": 0.8396889006718993, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 56160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "env_runners": {"episode_reward_max": -3.3165383117092566, "episode_reward_min": -1219.3481955304442, "episode_reward_mean": -280.55511016170465, "episode_len_mean": 94.73, "episode_media": {}, "episodes_timesteps_total": 9473, "policy_reward_min": {"policy_0": -1219.3481955304442}, "policy_reward_max": {"policy_0": -3.3165383117092566}, "policy_reward_mean": {"policy_0": -280.55511016170465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-165.67896458023887, -171.96531730550572, -578.8447611077662, -484.2855443270875, -381.661718165919, -668.5228325641102, -191.0374311060621, -56.81543580780334, -168.86847965918165, -314.71769575209925, -186.626923406557, -138.92724257141413, -210.00006666324626, -189.3891963933435, -1058.238527308136, -153.62789484276897, -303.54106035571573, -493.94326223595704, -155.31580743826154, -121.71500526905228, -60.62332253590048, -86.87466090292654, -88.42799663055752, -157.06156952314882, -488.9402546891685, -209.5538856076183, -194.52515861343014, -60.41221452365923, -198.3042254016422, -87.98544950228974, -76.02357874393074, -179.6455219275307, -84.75286466614833, -56.39214201597219, -244.0842142051125, -109.30714266689412, -254.2889743617076, -208.56979459500647, -127.13575592606887, -415.16459962460107, -279.75656498556134, -183.1818280163433, -347.4277643973637, -581.1026685510213, -3.3165383117092566, -452.64073247848273, -64.9219710582418, -121.87092608906634, -195.64794754213506, -1146.0342361314085, -161.55112853173364, -250.35668942308493, -65.71407632424341, -102.73663507352327, -505.4274504568544, -277.08979143796984, -474.9628714557208, -102.6552922201273, -36.28698570190396, -263.50754673797786, -523.2434278383855, -522.1315435610964, -147.19786190122446, -25.019321962533194, -169.33679956068434, -1219.3481955304442, -23.5189317614608, -158.81818079333888, -313.6195092677556, -26.615628403419514, -1167.1404263639868, -257.82551978561634, -159.10327367666284, -242.46898863389293, -1051.0886034150549, -213.9336384990082, -163.63653315441474, -317.6405516869165, -343.8535751691066, -93.73504768465169, -219.31269008960138, -159.29421416489754, -371.36009613585566, -440.1295547581166, -1101.8113611850038, -326.471942103204, -180.82162940049318, -221.6132288280548, -206.7413275214613, -281.9555638107167, -97.36207562740888, -31.530746315567317, -262.1594192980855, -111.50510640057169, -1065.352891541474, -231.3727531113812, -77.75148937361101, -73.51531313004166, -182.618895999295, -75.56902027796058], "episode_lengths": [63, 84, 148, 139, 126, 150, 83, 56, 62, 104, 90, 80, 95, 78, 150, 70, 111, 150, 86, 77, 58, 49, 52, 59, 143, 93, 109, 57, 90, 45, 61, 86, 64, 54, 75, 68, 120, 95, 76, 134, 114, 81, 130, 150, 31, 150, 60, 71, 97, 150, 79, 99, 67, 53, 150, 114, 150, 60, 54, 109, 150, 150, 66, 48, 87, 150, 38, 80, 150, 36, 150, 76, 55, 110, 150, 100, 83, 112, 150, 59, 91, 101, 126, 135, 150, 150, 94, 83, 78, 119, 65, 47, 105, 67, 150, 100, 64, 67, 61, 61], "policy_policy_0_reward": [-165.67896458023887, -171.96531730550572, -578.8447611077662, -484.2855443270875, -381.661718165919, -668.5228325641102, -191.0374311060621, -56.81543580780334, -168.86847965918165, -314.71769575209925, -186.626923406557, -138.92724257141413, -210.00006666324626, -189.3891963933435, -1058.238527308136, -153.62789484276897, -303.54106035571573, -493.94326223595704, -155.31580743826154, -121.71500526905228, -60.62332253590048, -86.87466090292654, -88.42799663055752, -157.06156952314882, -488.9402546891685, -209.5538856076183, -194.52515861343014, -60.41221452365923, -198.3042254016422, -87.98544950228974, -76.02357874393074, -179.6455219275307, -84.75286466614833, -56.39214201597219, -244.0842142051125, -109.30714266689412, -254.2889743617076, -208.56979459500647, -127.13575592606887, -415.16459962460107, -279.75656498556134, -183.1818280163433, -347.4277643973637, -581.1026685510213, -3.3165383117092566, -452.64073247848273, -64.9219710582418, -121.87092608906634, -195.64794754213506, -1146.0342361314085, -161.55112853173364, -250.35668942308493, -65.71407632424341, -102.73663507352327, -505.4274504568544, -277.08979143796984, -474.9628714557208, -102.6552922201273, -36.28698570190396, -263.50754673797786, -523.2434278383855, -522.1315435610964, -147.19786190122446, -25.019321962533194, -169.33679956068434, -1219.3481955304442, -23.5189317614608, -158.81818079333888, -313.6195092677556, -26.615628403419514, -1167.1404263639868, -257.82551978561634, -159.10327367666284, -242.46898863389293, -1051.0886034150549, -213.9336384990082, -163.63653315441474, -317.6405516869165, -343.8535751691066, -93.73504768465169, -219.31269008960138, -159.29421416489754, -371.36009613585566, -440.1295547581166, -1101.8113611850038, -326.471942103204, -180.82162940049318, -221.6132288280548, -206.7413275214613, -281.9555638107167, -97.36207562740888, -31.530746315567317, -262.1594192980855, -111.50510640057169, -1065.352891541474, -231.3727531113812, -77.75148937361101, -73.51531313004166, -182.618895999295, -75.56902027796058]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.561759479461611, "mean_inference_ms": 1.7178379066040386, "mean_action_processing_ms": 0.27578466266744295, "mean_env_wait_ms": 3.4143132287473876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011783361434936523, "StateBufferConnector_ms": 0.008133888244628906, "ViewRequirementAgentConnector_ms": 0.19389939308166504}, "num_episodes": 44, "episode_return_max": -3.3165383117092566, "episode_return_min": -1219.3481955304442, "episode_return_mean": -280.55511016170465, "episodes_this_iter": 44}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.89190929418515, "num_env_steps_trained_throughput_per_sec": 306.89190929418515, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 236000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 236000, "timers": {"training_iteration_time_ms": 12354.811, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12354.742, "sample_time_ms": 1110.092, "learn_time_ms": 11180.112, "learn_throughput": 357.778, "synch_weights_time_ms": 63.763}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "done": false, "training_iteration": 59, "trial_id": "b33d0_00000", "date": "2024-08-06_14-52-31", "timestamp": 1722936151, "time_this_iter_s": 13.045681953430176, "time_total_s": 714.439489364624, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c1264d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 714.439489364624, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 17.489473684210523, "ram_util_percent": 29.299999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 115.49839220046997, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.9699336819971602, "policy_loss": -0.01563244440330891, "vf_loss": 2.9750319010888537, "vf_explained_var": 0.98265968170017, "kl": 0.016798946157723548, "entropy": 0.8050632828846573, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 57120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": -3.3165383117092566, "episode_reward_min": -1299.5210962415706, "episode_reward_mean": -304.8297777509355, "episode_len_mean": 96.67, "episode_media": {}, "episodes_timesteps_total": 9667, "policy_reward_min": {"policy_0": -1299.5210962415706}, "policy_reward_max": {"policy_0": -3.3165383117092566}, "policy_reward_mean": {"policy_0": -304.8297777509355}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-581.1026685510213, -3.3165383117092566, -452.64073247848273, -64.9219710582418, -121.87092608906634, -195.64794754213506, -1146.0342361314085, -161.55112853173364, -250.35668942308493, -65.71407632424341, -102.73663507352327, -505.4274504568544, -277.08979143796984, -474.9628714557208, -102.6552922201273, -36.28698570190396, -263.50754673797786, -523.2434278383855, -522.1315435610964, -147.19786190122446, -25.019321962533194, -169.33679956068434, -1219.3481955304442, -23.5189317614608, -158.81818079333888, -313.6195092677556, -26.615628403419514, -1167.1404263639868, -257.82551978561634, -159.10327367666284, -242.46898863389293, -1051.0886034150549, -213.9336384990082, -163.63653315441474, -317.6405516869165, -343.8535751691066, -93.73504768465169, -219.31269008960138, -159.29421416489754, -371.36009613585566, -440.1295547581166, -1101.8113611850038, -326.471942103204, -180.82162940049318, -221.6132288280548, -206.7413275214613, -281.9555638107167, -97.36207562740888, -31.530746315567317, -262.1594192980855, -111.50510640057169, -1065.352891541474, -231.3727531113812, -77.75148937361101, -73.51531313004166, -182.618895999295, -75.56902027796058, -343.22967834210783, -94.48701360548688, -465.17966340433986, -239.16474332115317, -1145.6656594443486, -208.6183292795277, -175.0143871720908, -244.0541797779516, -153.68213261812636, -54.544935708827, -138.34412160166, -232.11004704134973, -57.8565867142728, -1179.6047350030626, -234.3860428297027, -96.9355671718325, -57.14489819162081, -66.8618233826964, -167.47479742166746, -502.3468563236362, -220.50587747026742, -171.53736639630088, -54.65083466637845, -174.25445809556274, -93.20719232782905, -135.99401028527376, -444.3858354741097, -267.500883390867, -305.5059725867397, -182.3623061118327, -75.42483740379825, -494.0318164504886, -1299.5210962415706, -267.38896388382733, -572.2529742991012, -114.73925971149737, -140.32232888267856, -251.13191140993217, -219.446811783616, -845.2147220929331, -75.24165938186563, -412.78723727227896, -145.5148558716752], "episode_lengths": [150, 31, 150, 60, 71, 97, 150, 79, 99, 67, 53, 150, 114, 150, 60, 54, 109, 150, 150, 66, 48, 87, 150, 38, 80, 150, 36, 150, 76, 55, 110, 150, 100, 83, 112, 150, 59, 91, 101, 126, 135, 150, 150, 94, 83, 78, 119, 65, 47, 105, 67, 150, 100, 64, 67, 61, 61, 88, 68, 138, 74, 150, 84, 68, 72, 76, 53, 77, 99, 56, 150, 110, 70, 53, 62, 79, 150, 105, 79, 56, 75, 67, 87, 150, 95, 104, 93, 52, 150, 150, 104, 150, 61, 116, 103, 101, 150, 80, 147, 57], "policy_policy_0_reward": [-581.1026685510213, -3.3165383117092566, -452.64073247848273, -64.9219710582418, -121.87092608906634, -195.64794754213506, -1146.0342361314085, -161.55112853173364, -250.35668942308493, -65.71407632424341, -102.73663507352327, -505.4274504568544, -277.08979143796984, -474.9628714557208, -102.6552922201273, -36.28698570190396, -263.50754673797786, -523.2434278383855, -522.1315435610964, -147.19786190122446, -25.019321962533194, -169.33679956068434, -1219.3481955304442, -23.5189317614608, -158.81818079333888, -313.6195092677556, -26.615628403419514, -1167.1404263639868, -257.82551978561634, -159.10327367666284, -242.46898863389293, -1051.0886034150549, -213.9336384990082, -163.63653315441474, -317.6405516869165, -343.8535751691066, -93.73504768465169, -219.31269008960138, -159.29421416489754, -371.36009613585566, -440.1295547581166, -1101.8113611850038, -326.471942103204, -180.82162940049318, -221.6132288280548, -206.7413275214613, -281.9555638107167, -97.36207562740888, -31.530746315567317, -262.1594192980855, -111.50510640057169, -1065.352891541474, -231.3727531113812, -77.75148937361101, -73.51531313004166, -182.618895999295, -75.56902027796058, -343.22967834210783, -94.48701360548688, -465.17966340433986, -239.16474332115317, -1145.6656594443486, -208.6183292795277, -175.0143871720908, -244.0541797779516, -153.68213261812636, -54.544935708827, -138.34412160166, -232.11004704134973, -57.8565867142728, -1179.6047350030626, -234.3860428297027, -96.9355671718325, -57.14489819162081, -66.8618233826964, -167.47479742166746, -502.3468563236362, -220.50587747026742, -171.53736639630088, -54.65083466637845, -174.25445809556274, -93.20719232782905, -135.99401028527376, -444.3858354741097, -267.500883390867, -305.5059725867397, -182.3623061118327, -75.42483740379825, -494.0318164504886, -1299.5210962415706, -267.38896388382733, -572.2529742991012, -114.73925971149737, -140.32232888267856, -251.13191140993217, -219.446811783616, -845.2147220929331, -75.24165938186563, -412.78723727227896, -145.5148558716752]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5621040952003754, "mean_inference_ms": 1.7173789267607524, "mean_action_processing_ms": 0.2759166849232218, "mean_env_wait_ms": 3.415322032162241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012098073959350586, "StateBufferConnector_ms": 0.008217334747314453, "ViewRequirementAgentConnector_ms": 0.1931924819946289}, "num_episodes": 43, "episode_return_max": -3.3165383117092566, "episode_return_min": -1299.5210962415706, "episode_return_mean": -304.8297777509355, "episodes_this_iter": 43}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 344.8154842664264, "num_env_steps_trained_throughput_per_sec": 344.8154842664264, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 12245.586, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12245.517, "sample_time_ms": 1106.506, "learn_time_ms": 11075.63, "learn_throughput": 361.153, "synch_weights_time_ms": 62.598}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 60, "trial_id": "b33d0_00000", "date": "2024-08-06_14-52-43", "timestamp": 1722936163, "time_this_iter_s": 11.612401723861694, "time_total_s": 726.0518910884857, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c126710>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 726.0518910884857, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 18.9625, "ram_util_percent": 29.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 167.99963935613633, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.5296475421016416, "policy_loss": -0.015844603574078065, "vf_loss": 2.5342894552896422, "vf_explained_var": 0.9888090437899033, "kl": 0.0181393912772668, "entropy": 1.041394706008335, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 58080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "env_runners": {"episode_reward_max": -31.530746315567317, "episode_reward_min": -1299.5210962415706, "episode_reward_mean": -309.8154254689865, "episode_len_mean": 99.06, "episode_media": {}, "episodes_timesteps_total": 9906, "policy_reward_min": {"policy_0": -1299.5210962415706}, "policy_reward_max": {"policy_0": -31.530746315567317}, "policy_reward_mean": {"policy_0": -309.8154254689865}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-159.29421416489754, -371.36009613585566, -440.1295547581166, -1101.8113611850038, -326.471942103204, -180.82162940049318, -221.6132288280548, -206.7413275214613, -281.9555638107167, -97.36207562740888, -31.530746315567317, -262.1594192980855, -111.50510640057169, -1065.352891541474, -231.3727531113812, -77.75148937361101, -73.51531313004166, -182.618895999295, -75.56902027796058, -343.22967834210783, -94.48701360548688, -465.17966340433986, -239.16474332115317, -1145.6656594443486, -208.6183292795277, -175.0143871720908, -244.0541797779516, -153.68213261812636, -54.544935708827, -138.34412160166, -232.11004704134973, -57.8565867142728, -1179.6047350030626, -234.3860428297027, -96.9355671718325, -57.14489819162081, -66.8618233826964, -167.47479742166746, -502.3468563236362, -220.50587747026742, -171.53736639630088, -54.65083466637845, -174.25445809556274, -93.20719232782905, -135.99401028527376, -444.3858354741097, -267.500883390867, -305.5059725867397, -182.3623061118327, -75.42483740379825, -494.0318164504886, -1299.5210962415706, -267.38896388382733, -572.2529742991012, -114.73925971149737, -140.32232888267856, -251.13191140993217, -219.446811783616, -845.2147220929331, -75.24165938186563, -412.78723727227896, -145.5148558716752, -425.81093728482523, -507.0825757509763, -158.70228095840963, -206.46935421020996, -319.56536261530346, -157.1476599167041, -573.2019709093096, -211.74364817655552, -173.86634402198328, -364.9531688586514, -1235.7397005721032, -174.74068611342298, -68.7457074092073, -85.45727585281465, -149.1695295191208, -450.14732467420146, -431.0541610283721, -190.17499215033075, -961.0734869763234, -138.64628654018063, -155.35889474559357, -683.9080963922462, -125.54410761892032, -1092.524458238147, -430.48179910695296, -106.58619195286944, -199.8737032809245, -70.41660840735508, -844.7911129026269, -233.86185932280532, -388.5374882465529, -46.17803533682004, -127.544451643902, -237.02394989873096, -267.1033180873248, -186.17552889816776, -213.54692762159067, -270.0275228290283], "episode_lengths": [101, 126, 135, 150, 150, 94, 83, 78, 119, 65, 47, 105, 67, 150, 100, 64, 67, 61, 61, 88, 68, 138, 74, 150, 84, 68, 72, 76, 53, 77, 99, 56, 150, 110, 70, 53, 62, 79, 150, 105, 79, 56, 75, 67, 87, 150, 95, 104, 93, 52, 150, 150, 104, 150, 61, 116, 103, 101, 150, 80, 147, 57, 150, 150, 71, 92, 118, 87, 150, 97, 101, 118, 150, 90, 60, 61, 83, 150, 129, 92, 150, 71, 89, 150, 67, 150, 150, 72, 113, 52, 150, 93, 134, 51, 86, 77, 90, 88, 91, 101], "policy_policy_0_reward": [-159.29421416489754, -371.36009613585566, -440.1295547581166, -1101.8113611850038, -326.471942103204, -180.82162940049318, -221.6132288280548, -206.7413275214613, -281.9555638107167, -97.36207562740888, -31.530746315567317, -262.1594192980855, -111.50510640057169, -1065.352891541474, -231.3727531113812, -77.75148937361101, -73.51531313004166, -182.618895999295, -75.56902027796058, -343.22967834210783, -94.48701360548688, -465.17966340433986, -239.16474332115317, -1145.6656594443486, -208.6183292795277, -175.0143871720908, -244.0541797779516, -153.68213261812636, -54.544935708827, -138.34412160166, -232.11004704134973, -57.8565867142728, -1179.6047350030626, -234.3860428297027, -96.9355671718325, -57.14489819162081, -66.8618233826964, -167.47479742166746, -502.3468563236362, -220.50587747026742, -171.53736639630088, -54.65083466637845, -174.25445809556274, -93.20719232782905, -135.99401028527376, -444.3858354741097, -267.500883390867, -305.5059725867397, -182.3623061118327, -75.42483740379825, -494.0318164504886, -1299.5210962415706, -267.38896388382733, -572.2529742991012, -114.73925971149737, -140.32232888267856, -251.13191140993217, -219.446811783616, -845.2147220929331, -75.24165938186563, -412.78723727227896, -145.5148558716752, -425.81093728482523, -507.0825757509763, -158.70228095840963, -206.46935421020996, -319.56536261530346, -157.1476599167041, -573.2019709093096, -211.74364817655552, -173.86634402198328, -364.9531688586514, -1235.7397005721032, -174.74068611342298, -68.7457074092073, -85.45727585281465, -149.1695295191208, -450.14732467420146, -431.0541610283721, -190.17499215033075, -961.0734869763234, -138.64628654018063, -155.35889474559357, -683.9080963922462, -125.54410761892032, -1092.524458238147, -430.48179910695296, -106.58619195286944, -199.8737032809245, -70.41660840735508, -844.7911129026269, -233.86185932280532, -388.5374882465529, -46.17803533682004, -127.544451643902, -237.02394989873096, -267.1033180873248, -186.17552889816776, -213.54692762159067, -270.0275228290283]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5625466551232513, "mean_inference_ms": 1.7166240745761074, "mean_action_processing_ms": 0.2756357755984676, "mean_env_wait_ms": 3.412961126008935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012002706527709961, "StateBufferConnector_ms": 0.008199691772460938, "ViewRequirementAgentConnector_ms": 0.1952958106994629}, "num_episodes": 38, "episode_return_max": -31.530746315567317, "episode_return_min": -1299.5210962415706, "episode_return_mean": -309.8154254689865, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.62210718336013, "num_env_steps_trained_throughput_per_sec": 314.62210718336013, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 244000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 244000, "timers": {"training_iteration_time_ms": 12239.282, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12239.214, "sample_time_ms": 1107.852, "learn_time_ms": 11067.638, "learn_throughput": 361.414, "synch_weights_time_ms": 62.943}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "done": false, "training_iteration": 61, "trial_id": "b33d0_00000", "date": "2024-08-06_14-52-56", "timestamp": 1722936176, "time_this_iter_s": 12.725398063659668, "time_total_s": 738.7772891521454, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2aa290>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 738.7772891521454, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 17.63157894736842, "ram_util_percent": 29.299999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 131.68737871249516, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.7800034371515117, "policy_loss": -0.016344123195449357, "vf_loss": 2.786169886837403, "vf_explained_var": 0.9886451713740826, "kl": 0.016470416606049844, "entropy": 0.9398596064187587, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 59040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "env_runners": {"episode_reward_max": -13.793413872589918, "episode_reward_min": -1299.5210962415706, "episode_reward_mean": -335.39723921335974, "episode_len_mean": 102.23, "episode_media": {}, "episodes_timesteps_total": 10223, "policy_reward_min": {"policy_0": -1299.5210962415706}, "policy_reward_max": {"policy_0": -13.793413872589918}, "policy_reward_mean": {"policy_0": -335.39723921335974}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-502.3468563236362, -220.50587747026742, -171.53736639630088, -54.65083466637845, -174.25445809556274, -93.20719232782905, -135.99401028527376, -444.3858354741097, -267.500883390867, -305.5059725867397, -182.3623061118327, -75.42483740379825, -494.0318164504886, -1299.5210962415706, -267.38896388382733, -572.2529742991012, -114.73925971149737, -140.32232888267856, -251.13191140993217, -219.446811783616, -845.2147220929331, -75.24165938186563, -412.78723727227896, -145.5148558716752, -425.81093728482523, -507.0825757509763, -158.70228095840963, -206.46935421020996, -319.56536261530346, -157.1476599167041, -573.2019709093096, -211.74364817655552, -173.86634402198328, -364.9531688586514, -1235.7397005721032, -174.74068611342298, -68.7457074092073, -85.45727585281465, -149.1695295191208, -450.14732467420146, -431.0541610283721, -190.17499215033075, -961.0734869763234, -138.64628654018063, -155.35889474559357, -683.9080963922462, -125.54410761892032, -1092.524458238147, -430.48179910695296, -106.58619195286944, -199.8737032809245, -70.41660840735508, -844.7911129026269, -233.86185932280532, -388.5374882465529, -46.17803533682004, -127.544451643902, -237.02394989873096, -267.1033180873248, -186.17552889816776, -213.54692762159067, -270.0275228290283, -1198.103233832142, -197.06708797324225, -660.4820985172815, -15.755000633230477, -1128.809728388135, -204.55663820374164, -19.105903585049788, -209.3037080671237, -13.793413872589918, -222.20910877097782, -995.9816554083792, -933.2412422511503, -233.00925098792035, -789.2092490250311, -214.81221342307532, -426.7074860733136, -37.85879930783866, -239.85198200310225, -52.69109529111497, -138.48281990407307, -861.5790605822416, -942.3020253013466, -47.59642188807731, -382.34753281708606, -27.83790839477525, -156.90369271738084, -385.77292496151637, -79.58691842180839, -20.69559289390272, -159.6490122240244, -32.752880702945, -369.03315780592175, -124.3648466588916, -155.0213261330899, -298.25268998673147, -933.9611013908822, -318.7505462179812, -184.03799083523586], "episode_lengths": [150, 105, 79, 56, 75, 67, 87, 150, 95, 104, 93, 52, 150, 150, 104, 150, 61, 116, 103, 101, 150, 80, 147, 57, 150, 150, 71, 92, 118, 87, 150, 97, 101, 118, 150, 90, 60, 61, 83, 150, 129, 92, 150, 71, 89, 150, 67, 150, 150, 72, 113, 52, 150, 93, 134, 51, 86, 77, 90, 88, 91, 101, 150, 97, 150, 37, 150, 73, 42, 89, 37, 105, 150, 150, 93, 150, 105, 150, 50, 114, 48, 76, 150, 150, 51, 150, 42, 95, 150, 61, 45, 100, 48, 146, 77, 82, 104, 150, 80, 70], "policy_policy_0_reward": [-502.3468563236362, -220.50587747026742, -171.53736639630088, -54.65083466637845, -174.25445809556274, -93.20719232782905, -135.99401028527376, -444.3858354741097, -267.500883390867, -305.5059725867397, -182.3623061118327, -75.42483740379825, -494.0318164504886, -1299.5210962415706, -267.38896388382733, -572.2529742991012, -114.73925971149737, -140.32232888267856, -251.13191140993217, -219.446811783616, -845.2147220929331, -75.24165938186563, -412.78723727227896, -145.5148558716752, -425.81093728482523, -507.0825757509763, -158.70228095840963, -206.46935421020996, -319.56536261530346, -157.1476599167041, -573.2019709093096, -211.74364817655552, -173.86634402198328, -364.9531688586514, -1235.7397005721032, -174.74068611342298, -68.7457074092073, -85.45727585281465, -149.1695295191208, -450.14732467420146, -431.0541610283721, -190.17499215033075, -961.0734869763234, -138.64628654018063, -155.35889474559357, -683.9080963922462, -125.54410761892032, -1092.524458238147, -430.48179910695296, -106.58619195286944, -199.8737032809245, -70.41660840735508, -844.7911129026269, -233.86185932280532, -388.5374882465529, -46.17803533682004, -127.544451643902, -237.02394989873096, -267.1033180873248, -186.17552889816776, -213.54692762159067, -270.0275228290283, -1198.103233832142, -197.06708797324225, -660.4820985172815, -15.755000633230477, -1128.809728388135, -204.55663820374164, -19.105903585049788, -209.3037080671237, -13.793413872589918, -222.20910877097782, -995.9816554083792, -933.2412422511503, -233.00925098792035, -789.2092490250311, -214.81221342307532, -426.7074860733136, -37.85879930783866, -239.85198200310225, -52.69109529111497, -138.48281990407307, -861.5790605822416, -942.3020253013466, -47.59642188807731, -382.34753281708606, -27.83790839477525, -156.90369271738084, -385.77292496151637, -79.58691842180839, -20.69559289390272, -159.6490122240244, -32.752880702945, -369.03315780592175, -124.3648466588916, -155.0213261330899, -298.25268998673147, -933.9611013908822, -318.7505462179812, -184.03799083523586]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.562286261670756, "mean_inference_ms": 1.7151478056294704, "mean_action_processing_ms": 0.27553681391668383, "mean_env_wait_ms": 3.4088021487924167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012153387069702148, "StateBufferConnector_ms": 0.007999420166015625, "ViewRequirementAgentConnector_ms": 0.19300413131713867}, "num_episodes": 38, "episode_return_max": -13.793413872589918, "episode_return_min": -1299.5210962415706, "episode_return_mean": -335.39723921335974, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.1587843547908, "num_env_steps_trained_throughput_per_sec": 313.1587843547908, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 12308.355, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12308.285, "sample_time_ms": 1103.962, "learn_time_ms": 11138.525, "learn_throughput": 359.114, "synch_weights_time_ms": 65.018}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "done": false, "training_iteration": 62, "trial_id": "b33d0_00000", "date": "2024-08-06_14-53-09", "timestamp": 1722936189, "time_this_iter_s": 12.786097288131714, "time_total_s": 751.5633864402771, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2315a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 751.5633864402771, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 17.650000000000002, "ram_util_percent": 29.299999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 120.30439145565033, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.369640706339851, "policy_loss": -0.012461886231176323, "vf_loss": 2.373946374623726, "vf_explained_var": 0.983632920247813, "kl": 0.013334029275817302, "entropy": 0.8442474906332791, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "env_runners": {"episode_reward_max": -2.2103301325639984, "episode_reward_min": -1238.6023328609717, "episode_reward_mean": -330.40550167794, "episode_len_mean": 99.52, "episode_media": {}, "episodes_timesteps_total": 9952, "policy_reward_min": {"policy_0": -1238.6023328609717}, "policy_reward_max": {"policy_0": -2.2103301325639984}, "policy_reward_mean": {"policy_0": -330.40550167794}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-683.9080963922462, -125.54410761892032, -1092.524458238147, -430.48179910695296, -106.58619195286944, -199.8737032809245, -70.41660840735508, -844.7911129026269, -233.86185932280532, -388.5374882465529, -46.17803533682004, -127.544451643902, -237.02394989873096, -267.1033180873248, -186.17552889816776, -213.54692762159067, -270.0275228290283, -1198.103233832142, -197.06708797324225, -660.4820985172815, -15.755000633230477, -1128.809728388135, -204.55663820374164, -19.105903585049788, -209.3037080671237, -13.793413872589918, -222.20910877097782, -995.9816554083792, -933.2412422511503, -233.00925098792035, -789.2092490250311, -214.81221342307532, -426.7074860733136, -37.85879930783866, -239.85198200310225, -52.69109529111497, -138.48281990407307, -861.5790605822416, -942.3020253013466, -47.59642188807731, -382.34753281708606, -27.83790839477525, -156.90369271738084, -385.77292496151637, -79.58691842180839, -20.69559289390272, -159.6490122240244, -32.752880702945, -369.03315780592175, -124.3648466588916, -155.0213261330899, -298.25268998673147, -933.9611013908822, -318.7505462179812, -184.03799083523586, -139.69388230868375, -610.3316030729362, -338.0444567824495, -119.42893650499556, -67.28345687499613, -199.95608486866095, -1057.1348082769453, -613.8547429525436, -43.37091889479598, -52.180737057010745, -395.9127750640122, -298.5324833718081, -192.49940161111107, -214.19514168612596, -174.89196004778822, -229.07101831583367, -361.5495694815117, -282.0182995258655, -66.7193244302705, -97.05122743030572, -1238.6023328609717, -66.3538930932108, -170.23486224085107, -1078.407147040536, -319.6753092805087, -245.23364650363854, -220.41972981002021, -1117.5410491576988, -417.01073259579783, -55.21734345849606, -200.54311900746697, -500.75007130026665, -211.43501854817353, -189.43390576706864, -173.58990078608764, -2.2103301325639984, -152.93262575510383, -294.5697128627672, -403.3115658887335, -320.0287709591895, -277.3472596636319, -403.31891947709136, -98.60736416738514, -233.1807913705152, -161.27143227025277], "episode_lengths": [150, 67, 150, 150, 72, 113, 52, 150, 93, 134, 51, 86, 77, 90, 88, 91, 101, 150, 97, 150, 37, 150, 73, 42, 89, 37, 105, 150, 150, 93, 150, 105, 150, 50, 114, 48, 76, 150, 150, 51, 150, 42, 95, 150, 61, 45, 100, 48, 146, 77, 82, 104, 150, 80, 70, 78, 150, 150, 50, 67, 81, 150, 129, 54, 63, 144, 118, 81, 88, 99, 85, 149, 111, 43, 65, 150, 57, 68, 150, 113, 80, 85, 150, 124, 38, 78, 139, 65, 69, 89, 32, 73, 139, 150, 150, 123, 136, 78, 90, 89], "policy_policy_0_reward": [-683.9080963922462, -125.54410761892032, -1092.524458238147, -430.48179910695296, -106.58619195286944, -199.8737032809245, -70.41660840735508, -844.7911129026269, -233.86185932280532, -388.5374882465529, -46.17803533682004, -127.544451643902, -237.02394989873096, -267.1033180873248, -186.17552889816776, -213.54692762159067, -270.0275228290283, -1198.103233832142, -197.06708797324225, -660.4820985172815, -15.755000633230477, -1128.809728388135, -204.55663820374164, -19.105903585049788, -209.3037080671237, -13.793413872589918, -222.20910877097782, -995.9816554083792, -933.2412422511503, -233.00925098792035, -789.2092490250311, -214.81221342307532, -426.7074860733136, -37.85879930783866, -239.85198200310225, -52.69109529111497, -138.48281990407307, -861.5790605822416, -942.3020253013466, -47.59642188807731, -382.34753281708606, -27.83790839477525, -156.90369271738084, -385.77292496151637, -79.58691842180839, -20.69559289390272, -159.6490122240244, -32.752880702945, -369.03315780592175, -124.3648466588916, -155.0213261330899, -298.25268998673147, -933.9611013908822, -318.7505462179812, -184.03799083523586, -139.69388230868375, -610.3316030729362, -338.0444567824495, -119.42893650499556, -67.28345687499613, -199.95608486866095, -1057.1348082769453, -613.8547429525436, -43.37091889479598, -52.180737057010745, -395.9127750640122, -298.5324833718081, -192.49940161111107, -214.19514168612596, -174.89196004778822, -229.07101831583367, -361.5495694815117, -282.0182995258655, -66.7193244302705, -97.05122743030572, -1238.6023328609717, -66.3538930932108, -170.23486224085107, -1078.407147040536, -319.6753092805087, -245.23364650363854, -220.41972981002021, -1117.5410491576988, -417.01073259579783, -55.21734345849606, -200.54311900746697, -500.75007130026665, -211.43501854817353, -189.43390576706864, -173.58990078608764, -2.2103301325639984, -152.93262575510383, -294.5697128627672, -403.3115658887335, -320.0287709591895, -277.3472596636319, -403.31891947709136, -98.60736416738514, -233.1807913705152, -161.27143227025277]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5622554615412411, "mean_inference_ms": 1.7140143123614706, "mean_action_processing_ms": 0.27560405371149765, "mean_env_wait_ms": 3.407575977365092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011857271194458008, "StateBufferConnector_ms": 0.007971525192260742, "ViewRequirementAgentConnector_ms": 0.19475865364074707}, "num_episodes": 45, "episode_return_max": -2.2103301325639984, "episode_return_min": -1238.6023328609717, "episode_return_mean": -330.40550167794, "episodes_this_iter": 45}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 333.94138133311816, "num_env_steps_trained_throughput_per_sec": 333.94138133311816, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 252000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 12245.379, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12245.31, "sample_time_ms": 1106.193, "learn_time_ms": 11070.96, "learn_throughput": 361.306, "synch_weights_time_ms": 67.36}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "training_iteration": 63, "trial_id": "b33d0_00000", "date": "2024-08-06_14-53-21", "timestamp": 1722936201, "time_this_iter_s": 11.99084997177124, "time_total_s": 763.5542364120483, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c168940>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 763.5542364120483, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 18.029411764705884, "ram_util_percent": 29.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 129.16386811137198, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.764452805618445, "policy_loss": -0.021833837121569864, "vf_loss": 2.7755745322753986, "vf_explained_var": 0.9768396852537989, "kl": 0.016925248025957792, "entropy": 0.7124255162663757, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": -2.2103301325639984, "episode_reward_min": -1238.6023328609717, "episode_reward_mean": -267.1407995452197, "episode_len_mean": 94.52, "episode_media": {}, "episodes_timesteps_total": 9452, "policy_reward_min": {"policy_0": -1238.6023328609717}, "policy_reward_max": {"policy_0": -2.2103301325639984}, "policy_reward_mean": {"policy_0": -267.1407995452197}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-156.90369271738084, -385.77292496151637, -79.58691842180839, -20.69559289390272, -159.6490122240244, -32.752880702945, -369.03315780592175, -124.3648466588916, -155.0213261330899, -298.25268998673147, -933.9611013908822, -318.7505462179812, -184.03799083523586, -139.69388230868375, -610.3316030729362, -338.0444567824495, -119.42893650499556, -67.28345687499613, -199.95608486866095, -1057.1348082769453, -613.8547429525436, -43.37091889479598, -52.180737057010745, -395.9127750640122, -298.5324833718081, -192.49940161111107, -214.19514168612596, -174.89196004778822, -229.07101831583367, -361.5495694815117, -282.0182995258655, -66.7193244302705, -97.05122743030572, -1238.6023328609717, -66.3538930932108, -170.23486224085107, -1078.407147040536, -319.6753092805087, -245.23364650363854, -220.41972981002021, -1117.5410491576988, -417.01073259579783, -55.21734345849606, -200.54311900746697, -500.75007130026665, -211.43501854817353, -189.43390576706864, -173.58990078608764, -2.2103301325639984, -152.93262575510383, -294.5697128627672, -403.3115658887335, -320.0287709591895, -277.3472596636319, -403.31891947709136, -98.60736416738514, -233.1807913705152, -161.27143227025277, -74.47610020553968, -301.50499315576263, -205.72665271079254, -203.51411670336194, -304.1846730288086, -119.15744766794585, -208.65106184020019, -27.03619228872634, -500.6717876771869, -64.39410852447934, -580.120515851285, -182.8286856679097, -317.6432838313072, -396.0296799004272, -75.23192547946132, -481.02405692176814, -186.8519757360588, -435.33728213385655, -317.3160364555419, -200.0753417266442, -159.95807916748214, -158.15221352999308, -169.09288746833423, -74.51357958167684, -81.09637324102775, -22.721737594899427, -66.5060022737974, -163.3994764743663, -39.205596442976976, -188.2908934054402, -136.91792006422037, -170.99225549583437, -406.35544696912757, -1041.0223087552715, -359.54253978098507, -61.174227576524004, -177.96934196717157, -90.38403626829549, -215.72946331918564, -202.02426491977712, -131.68332893328807, -91.84172027824359], "episode_lengths": [95, 150, 61, 45, 100, 48, 146, 77, 82, 104, 150, 80, 70, 78, 150, 150, 50, 67, 81, 150, 129, 54, 63, 144, 118, 81, 88, 99, 85, 149, 111, 43, 65, 150, 57, 68, 150, 113, 80, 85, 150, 124, 38, 78, 139, 65, 69, 89, 32, 73, 139, 150, 150, 123, 136, 78, 90, 89, 56, 112, 85, 82, 111, 71, 109, 49, 150, 53, 116, 84, 150, 150, 65, 150, 88, 150, 88, 68, 108, 61, 96, 62, 44, 45, 64, 69, 54, 96, 77, 69, 150, 150, 150, 53, 64, 66, 85, 81, 86, 57], "policy_policy_0_reward": [-156.90369271738084, -385.77292496151637, -79.58691842180839, -20.69559289390272, -159.6490122240244, -32.752880702945, -369.03315780592175, -124.3648466588916, -155.0213261330899, -298.25268998673147, -933.9611013908822, -318.7505462179812, -184.03799083523586, -139.69388230868375, -610.3316030729362, -338.0444567824495, -119.42893650499556, -67.28345687499613, -199.95608486866095, -1057.1348082769453, -613.8547429525436, -43.37091889479598, -52.180737057010745, -395.9127750640122, -298.5324833718081, -192.49940161111107, -214.19514168612596, -174.89196004778822, -229.07101831583367, -361.5495694815117, -282.0182995258655, -66.7193244302705, -97.05122743030572, -1238.6023328609717, -66.3538930932108, -170.23486224085107, -1078.407147040536, -319.6753092805087, -245.23364650363854, -220.41972981002021, -1117.5410491576988, -417.01073259579783, -55.21734345849606, -200.54311900746697, -500.75007130026665, -211.43501854817353, -189.43390576706864, -173.58990078608764, -2.2103301325639984, -152.93262575510383, -294.5697128627672, -403.3115658887335, -320.0287709591895, -277.3472596636319, -403.31891947709136, -98.60736416738514, -233.1807913705152, -161.27143227025277, -74.47610020553968, -301.50499315576263, -205.72665271079254, -203.51411670336194, -304.1846730288086, -119.15744766794585, -208.65106184020019, -27.03619228872634, -500.6717876771869, -64.39410852447934, -580.120515851285, -182.8286856679097, -317.6432838313072, -396.0296799004272, -75.23192547946132, -481.02405692176814, -186.8519757360588, -435.33728213385655, -317.3160364555419, -200.0753417266442, -159.95807916748214, -158.15221352999308, -169.09288746833423, -74.51357958167684, -81.09637324102775, -22.721737594899427, -66.5060022737974, -163.3994764743663, -39.205596442976976, -188.2908934054402, -136.91792006422037, -170.99225549583437, -406.35544696912757, -1041.0223087552715, -359.54253978098507, -61.174227576524004, -177.96934196717157, -90.38403626829549, -215.72946331918564, -202.02426491977712, -131.68332893328807, -91.84172027824359]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5618559944393862, "mean_inference_ms": 1.7130509585021856, "mean_action_processing_ms": 0.2755650136380918, "mean_env_wait_ms": 3.4070470271837974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012206315994262695, "StateBufferConnector_ms": 0.00796198844909668, "ViewRequirementAgentConnector_ms": 0.19229865074157715}, "num_episodes": 42, "episode_return_max": -2.2103301325639984, "episode_return_min": -1238.6023328609717, "episode_return_mean": -267.1407995452197, "episodes_this_iter": 42}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.43595177297954, "num_env_steps_trained_throughput_per_sec": 323.43595177297954, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 12528.093, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12528.023, "sample_time_ms": 1097.588, "learn_time_ms": 11360.876, "learn_throughput": 352.086, "synch_weights_time_ms": 68.769}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 64, "trial_id": "b33d0_00000", "date": "2024-08-06_14-53-33", "timestamp": 1722936213, "time_this_iter_s": 12.379501581192017, "time_total_s": 775.9337379932404, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c232c20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 775.9337379932404, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 17.764705882352942, "ram_util_percent": 29.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 151.57023874719937, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.57502013904353, "policy_loss": -0.02550824708644844, "vf_loss": 2.5886858113110067, "vf_explained_var": 0.9885077574600776, "kl": 0.01879308406326648, "entropy": 0.8427629944868386, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 61920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "env_runners": {"episode_reward_max": -2.2103301325639984, "episode_reward_min": -1080.339934243438, "episode_reward_mean": -256.4141803664402, "episode_len_mean": 96.38, "episode_media": {}, "episodes_timesteps_total": 9638, "policy_reward_min": {"policy_0": -1080.339934243438}, "policy_reward_max": {"policy_0": -2.2103301325639984}, "policy_reward_mean": {"policy_0": -256.4141803664402}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-417.01073259579783, -55.21734345849606, -200.54311900746697, -500.75007130026665, -211.43501854817353, -189.43390576706864, -173.58990078608764, -2.2103301325639984, -152.93262575510383, -294.5697128627672, -403.3115658887335, -320.0287709591895, -277.3472596636319, -403.31891947709136, -98.60736416738514, -233.1807913705152, -161.27143227025277, -74.47610020553968, -301.50499315576263, -205.72665271079254, -203.51411670336194, -304.1846730288086, -119.15744766794585, -208.65106184020019, -27.03619228872634, -500.6717876771869, -64.39410852447934, -580.120515851285, -182.8286856679097, -317.6432838313072, -396.0296799004272, -75.23192547946132, -481.02405692176814, -186.8519757360588, -435.33728213385655, -317.3160364555419, -200.0753417266442, -159.95807916748214, -158.15221352999308, -169.09288746833423, -74.51357958167684, -81.09637324102775, -22.721737594899427, -66.5060022737974, -163.3994764743663, -39.205596442976976, -188.2908934054402, -136.91792006422037, -170.99225549583437, -406.35544696912757, -1041.0223087552715, -359.54253978098507, -61.174227576524004, -177.96934196717157, -90.38403626829549, -215.72946331918564, -202.02426491977712, -131.68332893328807, -91.84172027824359, -259.5292446948411, -103.75794303333461, -170.01147178542953, -273.70251379149147, -508.44141250968573, -1080.339934243438, -92.80243943522346, -78.15749521245884, -117.46887067139764, -471.809850768589, -535.7581441057786, -884.9147051354108, -493.6669755372432, -42.79306325713474, -22.38959074975011, -217.65087185811123, -412.1160587812382, -281.96873358323165, -970.8289863196597, -266.5886038072231, -57.459865574489015, -233.11739848056803, -503.3373531283586, -137.61961116917058, -117.56886918067427, -439.94011396908513, -356.8203686250682, -432.01985331063105, -144.2969538020181, -116.66907769141281, -52.18985985546222, -391.0096495102905, -118.48117265610698, -489.08140302762945, -359.8976562370728, -119.31658744502843, -185.80355420214144, -257.5032843141555, -158.80929102174557, -41.61300390495627, -159.05772523170754], "episode_lengths": [124, 38, 78, 139, 65, 69, 89, 32, 73, 139, 150, 150, 123, 136, 78, 90, 89, 56, 112, 85, 82, 111, 71, 109, 49, 150, 53, 116, 84, 150, 150, 65, 150, 88, 150, 88, 68, 108, 61, 96, 62, 44, 45, 64, 69, 54, 96, 77, 69, 150, 150, 150, 53, 64, 66, 85, 81, 86, 57, 101, 59, 102, 116, 150, 150, 78, 55, 77, 150, 150, 150, 142, 46, 41, 105, 147, 144, 150, 99, 56, 82, 143, 70, 72, 150, 133, 140, 77, 72, 57, 150, 58, 150, 126, 68, 71, 105, 84, 44, 82], "policy_policy_0_reward": [-417.01073259579783, -55.21734345849606, -200.54311900746697, -500.75007130026665, -211.43501854817353, -189.43390576706864, -173.58990078608764, -2.2103301325639984, -152.93262575510383, -294.5697128627672, -403.3115658887335, -320.0287709591895, -277.3472596636319, -403.31891947709136, -98.60736416738514, -233.1807913705152, -161.27143227025277, -74.47610020553968, -301.50499315576263, -205.72665271079254, -203.51411670336194, -304.1846730288086, -119.15744766794585, -208.65106184020019, -27.03619228872634, -500.6717876771869, -64.39410852447934, -580.120515851285, -182.8286856679097, -317.6432838313072, -396.0296799004272, -75.23192547946132, -481.02405692176814, -186.8519757360588, -435.33728213385655, -317.3160364555419, -200.0753417266442, -159.95807916748214, -158.15221352999308, -169.09288746833423, -74.51357958167684, -81.09637324102775, -22.721737594899427, -66.5060022737974, -163.3994764743663, -39.205596442976976, -188.2908934054402, -136.91792006422037, -170.99225549583437, -406.35544696912757, -1041.0223087552715, -359.54253978098507, -61.174227576524004, -177.96934196717157, -90.38403626829549, -215.72946331918564, -202.02426491977712, -131.68332893328807, -91.84172027824359, -259.5292446948411, -103.75794303333461, -170.01147178542953, -273.70251379149147, -508.44141250968573, -1080.339934243438, -92.80243943522346, -78.15749521245884, -117.46887067139764, -471.809850768589, -535.7581441057786, -884.9147051354108, -493.6669755372432, -42.79306325713474, -22.38959074975011, -217.65087185811123, -412.1160587812382, -281.96873358323165, -970.8289863196597, -266.5886038072231, -57.459865574489015, -233.11739848056803, -503.3373531283586, -137.61961116917058, -117.56886918067427, -439.94011396908513, -356.8203686250682, -432.01985331063105, -144.2969538020181, -116.66907769141281, -52.18985985546222, -391.0096495102905, -118.48117265610698, -489.08140302762945, -359.8976562370728, -119.31658744502843, -185.80355420214144, -257.5032843141555, -158.80929102174557, -41.61300390495627, -159.05772523170754]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5614262982478161, "mean_inference_ms": 1.711482502290521, "mean_action_processing_ms": 0.2753439054671537, "mean_env_wait_ms": 3.4043687056148677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01231074333190918, "StateBufferConnector_ms": 0.007863759994506836, "ViewRequirementAgentConnector_ms": 0.19008564949035645}, "num_episodes": 41, "episode_return_max": -2.2103301325639984, "episode_return_min": -1080.339934243438, "episode_return_mean": -256.4141803664402, "episodes_this_iter": 41}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.13166035073687, "num_env_steps_trained_throughput_per_sec": 310.13166035073687, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 260000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 260000, "timers": {"training_iteration_time_ms": 12535.254, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12535.184, "sample_time_ms": 1094.075, "learn_time_ms": 11372.927, "learn_throughput": 351.712, "synch_weights_time_ms": 67.381}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "done": false, "training_iteration": 65, "trial_id": "b33d0_00000", "date": "2024-08-06_14-53-46", "timestamp": 1722936226, "time_this_iter_s": 12.910579919815063, "time_total_s": 788.8443179130554, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c124c10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 788.8443179130554, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 17.273684210526316, "ram_util_percent": 29.299999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 154.34538390636445, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.8218005795031784, "policy_loss": -0.01303985218158535, "vf_loss": 2.827542900542418, "vf_explained_var": 0.9875541279092431, "kl": 0.01242330122219452, "entropy": 1.0881902535135548, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 62880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "env_runners": {"episode_reward_max": -22.38959074975011, "episode_reward_min": -1499.4091104729328, "episode_reward_mean": -325.1197574482651, "episode_len_mean": 98.14, "episode_media": {}, "episodes_timesteps_total": 9814, "policy_reward_min": {"policy_0": -1499.4091104729328}, "policy_reward_max": {"policy_0": -22.38959074975011}, "policy_reward_mean": {"policy_0": -325.1197574482651}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-169.09288746833423, -74.51357958167684, -81.09637324102775, -22.721737594899427, -66.5060022737974, -163.3994764743663, -39.205596442976976, -188.2908934054402, -136.91792006422037, -170.99225549583437, -406.35544696912757, -1041.0223087552715, -359.54253978098507, -61.174227576524004, -177.96934196717157, -90.38403626829549, -215.72946331918564, -202.02426491977712, -131.68332893328807, -91.84172027824359, -259.5292446948411, -103.75794303333461, -170.01147178542953, -273.70251379149147, -508.44141250968573, -1080.339934243438, -92.80243943522346, -78.15749521245884, -117.46887067139764, -471.809850768589, -535.7581441057786, -884.9147051354108, -493.6669755372432, -42.79306325713474, -22.38959074975011, -217.65087185811123, -412.1160587812382, -281.96873358323165, -970.8289863196597, -266.5886038072231, -57.459865574489015, -233.11739848056803, -503.3373531283586, -137.61961116917058, -117.56886918067427, -439.94011396908513, -356.8203686250682, -432.01985331063105, -144.2969538020181, -116.66907769141281, -52.18985985546222, -391.0096495102905, -118.48117265610698, -489.08140302762945, -359.8976562370728, -119.31658744502843, -185.80355420214144, -257.5032843141555, -158.80929102174557, -41.61300390495627, -159.05772523170754, -181.64280149676674, -904.3108671498488, -265.27744884473844, -253.7555984866843, -300.74037078622547, -1022.4092794010078, -127.64140639514662, -91.70606254733215, -241.42397308060862, -1176.8153605048556, -136.68272776678685, -38.54271870174252, -1389.5788464151726, -383.53512139817576, -154.0722527047279, -46.61533806760273, -264.7601758875553, -427.89733736545594, -291.30615100881914, -516.9736460438223, -348.9583689054212, -199.69913624820475, -1250.6895693803895, -40.74777285853188, -321.99771338520327, -238.06098372263955, -258.1696483709539, -1499.4091104729328, -95.70607219448912, -105.5651372919574, -831.3480999157117, -110.8977739755537, -490.3760015200613, -1167.8030925618195, -99.32960887457764, -45.95091539967799, -39.083460515800574, -52.361113848822264, -1053.3617189017978], "episode_lengths": [96, 62, 44, 45, 64, 69, 54, 96, 77, 69, 150, 150, 150, 53, 64, 66, 85, 81, 86, 57, 101, 59, 102, 116, 150, 150, 78, 55, 77, 150, 150, 150, 142, 46, 41, 105, 147, 144, 150, 99, 56, 82, 143, 70, 72, 150, 133, 140, 77, 72, 57, 150, 58, 150, 126, 68, 71, 105, 84, 44, 82, 115, 150, 107, 108, 128, 150, 54, 65, 75, 150, 73, 46, 150, 105, 91, 51, 126, 142, 98, 138, 117, 67, 150, 45, 93, 100, 112, 150, 62, 81, 150, 74, 150, 150, 68, 52, 54, 47, 150], "policy_policy_0_reward": [-169.09288746833423, -74.51357958167684, -81.09637324102775, -22.721737594899427, -66.5060022737974, -163.3994764743663, -39.205596442976976, -188.2908934054402, -136.91792006422037, -170.99225549583437, -406.35544696912757, -1041.0223087552715, -359.54253978098507, -61.174227576524004, -177.96934196717157, -90.38403626829549, -215.72946331918564, -202.02426491977712, -131.68332893328807, -91.84172027824359, -259.5292446948411, -103.75794303333461, -170.01147178542953, -273.70251379149147, -508.44141250968573, -1080.339934243438, -92.80243943522346, -78.15749521245884, -117.46887067139764, -471.809850768589, -535.7581441057786, -884.9147051354108, -493.6669755372432, -42.79306325713474, -22.38959074975011, -217.65087185811123, -412.1160587812382, -281.96873358323165, -970.8289863196597, -266.5886038072231, -57.459865574489015, -233.11739848056803, -503.3373531283586, -137.61961116917058, -117.56886918067427, -439.94011396908513, -356.8203686250682, -432.01985331063105, -144.2969538020181, -116.66907769141281, -52.18985985546222, -391.0096495102905, -118.48117265610698, -489.08140302762945, -359.8976562370728, -119.31658744502843, -185.80355420214144, -257.5032843141555, -158.80929102174557, -41.61300390495627, -159.05772523170754, -181.64280149676674, -904.3108671498488, -265.27744884473844, -253.7555984866843, -300.74037078622547, -1022.4092794010078, -127.64140639514662, -91.70606254733215, -241.42397308060862, -1176.8153605048556, -136.68272776678685, -38.54271870174252, -1389.5788464151726, -383.53512139817576, -154.0722527047279, -46.61533806760273, -264.7601758875553, -427.89733736545594, -291.30615100881914, -516.9736460438223, -348.9583689054212, -199.69913624820475, -1250.6895693803895, -40.74777285853188, -321.99771338520327, -238.06098372263955, -258.1696483709539, -1499.4091104729328, -95.70607219448912, -105.5651372919574, -831.3480999157117, -110.8977739755537, -490.3760015200613, -1167.8030925618195, -99.32960887457764, -45.95091539967799, -39.083460515800574, -52.361113848822264, -1053.3617189017978]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5611302642473962, "mean_inference_ms": 1.709356749576241, "mean_action_processing_ms": 0.27493357614920827, "mean_env_wait_ms": 3.4018057268709323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01226353645324707, "StateBufferConnector_ms": 0.007917165756225586, "ViewRequirementAgentConnector_ms": 0.19125747680664062}, "num_episodes": 39, "episode_return_max": -22.38959074975011, "episode_return_min": -1499.4091104729328, "episode_return_mean": -325.1197574482651, "episodes_this_iter": 39}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.45047784463077, "num_env_steps_trained_throughput_per_sec": 309.45047784463077, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 12542.839, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12542.769, "sample_time_ms": 1111.859, "learn_time_ms": 11363.177, "learn_throughput": 352.014, "synch_weights_time_ms": 66.93}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "training_iteration": 66, "trial_id": "b33d0_00000", "date": "2024-08-06_14-53-59", "timestamp": 1722936239, "time_this_iter_s": 12.938555002212524, "time_total_s": 801.782872915268, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c127b50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 801.782872915268, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 17.744444444444447, "ram_util_percent": 29.299999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 92.26599386831124, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.6445404097437857, "policy_loss": -0.020727300807872478, "vf_loss": 2.6547011993825436, "vf_explained_var": 0.9814990510543188, "kl": 0.016796980054853822, "entropy": 0.7714571739236514, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 63840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "env_runners": {"episode_reward_max": -25.723596825038612, "episode_reward_min": -1499.4091104729328, "episode_reward_mean": -296.6793989755266, "episode_len_mean": 94.38, "episode_media": {}, "episodes_timesteps_total": 9438, "policy_reward_min": {"policy_0": -1499.4091104729328}, "policy_reward_max": {"policy_0": -25.723596825038612}, "policy_reward_mean": {"policy_0": -296.6793989755266}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-439.94011396908513, -356.8203686250682, -432.01985331063105, -144.2969538020181, -116.66907769141281, -52.18985985546222, -391.0096495102905, -118.48117265610698, -489.08140302762945, -359.8976562370728, -119.31658744502843, -185.80355420214144, -257.5032843141555, -158.80929102174557, -41.61300390495627, -159.05772523170754, -181.64280149676674, -904.3108671498488, -265.27744884473844, -253.7555984866843, -300.74037078622547, -1022.4092794010078, -127.64140639514662, -91.70606254733215, -241.42397308060862, -1176.8153605048556, -136.68272776678685, -38.54271870174252, -1389.5788464151726, -383.53512139817576, -154.0722527047279, -46.61533806760273, -264.7601758875553, -427.89733736545594, -291.30615100881914, -516.9736460438223, -348.9583689054212, -199.69913624820475, -1250.6895693803895, -40.74777285853188, -321.99771338520327, -238.06098372263955, -258.1696483709539, -1499.4091104729328, -95.70607219448912, -105.5651372919574, -831.3480999157117, -110.8977739755537, -490.3760015200613, -1167.8030925618195, -99.32960887457764, -45.95091539967799, -39.083460515800574, -52.361113848822264, -1053.3617189017978, -281.28136502140626, -67.26981093546472, -223.27535699836918, -104.27423084742794, -81.95309252392249, -95.64206260646334, -33.442427425369914, -231.9147902784888, -64.63721756451336, -102.58156271121472, -120.03943967129055, -1140.7247363017495, -105.59653543588576, -62.6258065319754, -102.87079019987462, -451.59029440101347, -59.581910148330614, -328.0300478274631, -228.95486273688513, -510.3590196265408, -335.8001988017338, -57.55817957069846, -1046.0518483734259, -102.89874102698035, -150.31809799777258, -46.08586212227178, -160.1729116654127, -171.29092545346515, -105.10641695620133, -336.896688248371, -465.46659036265504, -48.95773549458813, -25.723596825038612, -70.26275479695788, -354.8831809407955, -67.69612130119535, -87.77567977463909, -128.87671049602298, -145.36125894251938, -41.02432563973928, -228.60420415937364, -111.57086779161588, -454.968958423836, -168.14937955955688, -72.0809658320122], "episode_lengths": [150, 133, 140, 77, 72, 57, 150, 58, 150, 126, 68, 71, 105, 84, 44, 82, 115, 150, 107, 108, 128, 150, 54, 65, 75, 150, 73, 46, 150, 105, 91, 51, 126, 142, 98, 138, 117, 67, 150, 45, 93, 100, 112, 150, 62, 81, 150, 74, 150, 150, 68, 52, 54, 47, 150, 99, 47, 93, 79, 62, 65, 51, 105, 65, 69, 74, 150, 50, 52, 67, 150, 37, 150, 120, 150, 131, 44, 150, 59, 79, 53, 91, 84, 72, 132, 150, 55, 36, 53, 150, 63, 71, 72, 99, 50, 93, 70, 135, 85, 65], "policy_policy_0_reward": [-439.94011396908513, -356.8203686250682, -432.01985331063105, -144.2969538020181, -116.66907769141281, -52.18985985546222, -391.0096495102905, -118.48117265610698, -489.08140302762945, -359.8976562370728, -119.31658744502843, -185.80355420214144, -257.5032843141555, -158.80929102174557, -41.61300390495627, -159.05772523170754, -181.64280149676674, -904.3108671498488, -265.27744884473844, -253.7555984866843, -300.74037078622547, -1022.4092794010078, -127.64140639514662, -91.70606254733215, -241.42397308060862, -1176.8153605048556, -136.68272776678685, -38.54271870174252, -1389.5788464151726, -383.53512139817576, -154.0722527047279, -46.61533806760273, -264.7601758875553, -427.89733736545594, -291.30615100881914, -516.9736460438223, -348.9583689054212, -199.69913624820475, -1250.6895693803895, -40.74777285853188, -321.99771338520327, -238.06098372263955, -258.1696483709539, -1499.4091104729328, -95.70607219448912, -105.5651372919574, -831.3480999157117, -110.8977739755537, -490.3760015200613, -1167.8030925618195, -99.32960887457764, -45.95091539967799, -39.083460515800574, -52.361113848822264, -1053.3617189017978, -281.28136502140626, -67.26981093546472, -223.27535699836918, -104.27423084742794, -81.95309252392249, -95.64206260646334, -33.442427425369914, -231.9147902784888, -64.63721756451336, -102.58156271121472, -120.03943967129055, -1140.7247363017495, -105.59653543588576, -62.6258065319754, -102.87079019987462, -451.59029440101347, -59.581910148330614, -328.0300478274631, -228.95486273688513, -510.3590196265408, -335.8001988017338, -57.55817957069846, -1046.0518483734259, -102.89874102698035, -150.31809799777258, -46.08586212227178, -160.1729116654127, -171.29092545346515, -105.10641695620133, -336.896688248371, -465.46659036265504, -48.95773549458813, -25.723596825038612, -70.26275479695788, -354.8831809407955, -67.69612130119535, -87.77567977463909, -128.87671049602298, -145.36125894251938, -41.02432563973928, -228.60420415937364, -111.57086779161588, -454.968958423836, -168.14937955955688, -72.0809658320122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5610584867787236, "mean_inference_ms": 1.7089613761114786, "mean_action_processing_ms": 0.2750086467827087, "mean_env_wait_ms": 3.4029996609743636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012723684310913086, "StateBufferConnector_ms": 0.008157730102539062, "ViewRequirementAgentConnector_ms": 0.19565820693969727}, "num_episodes": 45, "episode_return_max": -25.723596825038612, "episode_return_min": -1499.4091104729328, "episode_return_mean": -296.6793989755266, "episodes_this_iter": 45}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.84989760566947, "num_env_steps_trained_throughput_per_sec": 315.84989760566947, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 268000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 268000, "timers": {"training_iteration_time_ms": 12515.181, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12515.112, "sample_time_ms": 1114.096, "learn_time_ms": 11334.346, "learn_throughput": 352.91, "synch_weights_time_ms": 65.87}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "done": false, "training_iteration": 67, "trial_id": "b33d0_00000", "date": "2024-08-06_14-54-12", "timestamp": 1722936252, "time_this_iter_s": 12.676318645477295, "time_total_s": 814.4591915607452, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c127c70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 814.4591915607452, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 17.577777777777776, "ram_util_percent": 29.299999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 151.90612301429113, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.6681885176648694, "policy_loss": -0.015411978808212249, "vf_loss": 2.6739214374373357, "vf_explained_var": 0.9768473856151104, "kl": 0.015591740761586455, "entropy": 0.8453672414645552, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 64800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": -12.372475881703938, "episode_reward_min": -1499.4091104729328, "episode_reward_mean": -254.09946201220077, "episode_len_mean": 91.27, "episode_media": {}, "episodes_timesteps_total": 9127, "policy_reward_min": {"policy_0": -1499.4091104729328}, "policy_reward_max": {"policy_0": -12.372475881703938}, "policy_reward_mean": {"policy_0": -254.09946201220077}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.74777285853188, -321.99771338520327, -238.06098372263955, -258.1696483709539, -1499.4091104729328, -95.70607219448912, -105.5651372919574, -831.3480999157117, -110.8977739755537, -490.3760015200613, -1167.8030925618195, -99.32960887457764, -45.95091539967799, -39.083460515800574, -52.361113848822264, -1053.3617189017978, -281.28136502140626, -67.26981093546472, -223.27535699836918, -104.27423084742794, -81.95309252392249, -95.64206260646334, -33.442427425369914, -231.9147902784888, -64.63721756451336, -102.58156271121472, -120.03943967129055, -1140.7247363017495, -105.59653543588576, -62.6258065319754, -102.87079019987462, -451.59029440101347, -59.581910148330614, -328.0300478274631, -228.95486273688513, -510.3590196265408, -335.8001988017338, -57.55817957069846, -1046.0518483734259, -102.89874102698035, -150.31809799777258, -46.08586212227178, -160.1729116654127, -171.29092545346515, -105.10641695620133, -336.896688248371, -465.46659036265504, -48.95773549458813, -25.723596825038612, -70.26275479695788, -354.8831809407955, -67.69612130119535, -87.77567977463909, -128.87671049602298, -145.36125894251938, -41.02432563973928, -228.60420415937364, -111.57086779161588, -454.968958423836, -168.14937955955688, -72.0809658320122, -119.95867433055922, -163.09276865193448, -190.1487450359495, -130.9397506119516, -244.59844852380263, -12.372475881703938, -132.98230036855483, -342.98219601850866, -328.5011417018337, -16.255031704388156, -316.5756858311052, -334.035547525275, -209.72459398139438, -265.86968754751274, -223.86482537933122, -277.556361404114, -457.97283975802543, -405.9158484010985, -66.71319452153837, -346.14368597726957, -229.50138716134035, -200.997079570728, -131.35468584381445, -393.0666581250898, -67.39720252062767, -172.50093635912148, -846.607563623129, -39.60813040065306, -53.0706483282886, -140.79511399463834, -123.28268000168411, -118.04660351977256, -165.4973661627008, -1190.56039538996, -225.64895138535942, -415.66834158403225, -100.68387655531518, -201.8850337454028, -177.17395963151296], "episode_lengths": [45, 93, 100, 112, 150, 62, 81, 150, 74, 150, 150, 68, 52, 54, 47, 150, 99, 47, 93, 79, 62, 65, 51, 105, 65, 69, 74, 150, 50, 52, 67, 150, 37, 150, 120, 150, 131, 44, 150, 59, 79, 53, 91, 84, 72, 132, 150, 55, 36, 53, 150, 63, 71, 72, 99, 50, 93, 70, 135, 85, 65, 81, 106, 88, 77, 107, 35, 77, 150, 149, 39, 127, 126, 98, 106, 94, 90, 150, 136, 77, 87, 80, 89, 92, 150, 54, 74, 141, 41, 48, 85, 66, 85, 86, 150, 105, 119, 73, 98, 76], "policy_policy_0_reward": [-40.74777285853188, -321.99771338520327, -238.06098372263955, -258.1696483709539, -1499.4091104729328, -95.70607219448912, -105.5651372919574, -831.3480999157117, -110.8977739755537, -490.3760015200613, -1167.8030925618195, -99.32960887457764, -45.95091539967799, -39.083460515800574, -52.361113848822264, -1053.3617189017978, -281.28136502140626, -67.26981093546472, -223.27535699836918, -104.27423084742794, -81.95309252392249, -95.64206260646334, -33.442427425369914, -231.9147902784888, -64.63721756451336, -102.58156271121472, -120.03943967129055, -1140.7247363017495, -105.59653543588576, -62.6258065319754, -102.87079019987462, -451.59029440101347, -59.581910148330614, -328.0300478274631, -228.95486273688513, -510.3590196265408, -335.8001988017338, -57.55817957069846, -1046.0518483734259, -102.89874102698035, -150.31809799777258, -46.08586212227178, -160.1729116654127, -171.29092545346515, -105.10641695620133, -336.896688248371, -465.46659036265504, -48.95773549458813, -25.723596825038612, -70.26275479695788, -354.8831809407955, -67.69612130119535, -87.77567977463909, -128.87671049602298, -145.36125894251938, -41.02432563973928, -228.60420415937364, -111.57086779161588, -454.968958423836, -168.14937955955688, -72.0809658320122, -119.95867433055922, -163.09276865193448, -190.1487450359495, -130.9397506119516, -244.59844852380263, -12.372475881703938, -132.98230036855483, -342.98219601850866, -328.5011417018337, -16.255031704388156, -316.5756858311052, -334.035547525275, -209.72459398139438, -265.86968754751274, -223.86482537933122, -277.556361404114, -457.97283975802543, -405.9158484010985, -66.71319452153837, -346.14368597726957, -229.50138716134035, -200.997079570728, -131.35468584381445, -393.0666581250898, -67.39720252062767, -172.50093635912148, -846.607563623129, -39.60813040065306, -53.0706483282886, -140.79511399463834, -123.28268000168411, -118.04660351977256, -165.4973661627008, -1190.56039538996, -225.64895138535942, -415.66834158403225, -100.68387655531518, -201.8850337454028, -177.17395963151296]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.561300456256672, "mean_inference_ms": 1.709452020174457, "mean_action_processing_ms": 0.2752635790847984, "mean_env_wait_ms": 3.4029115541400126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012562990188598633, "StateBufferConnector_ms": 0.008226871490478516, "ViewRequirementAgentConnector_ms": 0.19321060180664062}, "num_episodes": 39, "episode_return_max": -12.372475881703938, "episode_return_min": -1499.4091104729328, "episode_return_mean": -254.09946201220077, "episodes_this_iter": 39}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.289287164772, "num_env_steps_trained_throughput_per_sec": 320.289287164772, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 12544.337, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12544.268, "sample_time_ms": 1113.443, "learn_time_ms": 11364.038, "learn_throughput": 351.988, "synch_weights_time_ms": 65.99}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 68, "trial_id": "b33d0_00000", "date": "2024-08-06_14-54-24", "timestamp": 1722936264, "time_this_iter_s": 12.50096321105957, "time_total_s": 826.9601547718048, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c124c10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 826.9601547718048, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 17.655555555555555, "ram_util_percent": 29.299999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 109.17433078686396, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.5425202608729403, "policy_loss": -0.02253057711253253, "vf_loss": 2.5547842048108578, "vf_explained_var": 0.9836426307136814, "kl": 0.016454816923442195, "entropy": 0.8403781325245897, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 65760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "env_runners": {"episode_reward_max": 2.5629879282806454, "episode_reward_min": -1190.56039538996, "episode_reward_mean": -242.80773902885178, "episode_len_mean": 90.37, "episode_media": {}, "episodes_timesteps_total": 9037, "policy_reward_min": {"policy_0": -1190.56039538996}, "policy_reward_max": {"policy_0": 2.5629879282806454}, "policy_reward_mean": {"policy_0": -242.80773902885178}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.69612130119535, -87.77567977463909, -128.87671049602298, -145.36125894251938, -41.02432563973928, -228.60420415937364, -111.57086779161588, -454.968958423836, -168.14937955955688, -72.0809658320122, -119.95867433055922, -163.09276865193448, -190.1487450359495, -130.9397506119516, -244.59844852380263, -12.372475881703938, -132.98230036855483, -342.98219601850866, -328.5011417018337, -16.255031704388156, -316.5756858311052, -334.035547525275, -209.72459398139438, -265.86968754751274, -223.86482537933122, -277.556361404114, -457.97283975802543, -405.9158484010985, -66.71319452153837, -346.14368597726957, -229.50138716134035, -200.997079570728, -131.35468584381445, -393.0666581250898, -67.39720252062767, -172.50093635912148, -846.607563623129, -39.60813040065306, -53.0706483282886, -140.79511399463834, -123.28268000168411, -118.04660351977256, -165.4973661627008, -1190.56039538996, -225.64895138535942, -415.66834158403225, -100.68387655531518, -201.8850337454028, -177.17395963151296, -26.595487727152367, -101.94409190160582, -254.30199068625623, -161.75325420665484, -545.4650470590151, 2.5629879282806454, -266.7100579629968, -316.65489364232354, -960.5819622386783, -65.34247992355253, -174.65699140662105, -78.28330898448009, -151.98294921038033, -991.3655007610533, -1071.3131567792327, -94.30731381502974, -592.745175249929, -36.084435019294446, -13.504730912085376, -304.7941377793648, -128.50539144414626, -17.851358936651383, -468.45696325990787, -181.16623039203358, -60.33960667119116, -16.225713929713642, -44.56559410590764, -263.4825789410877, -64.46512070659188, -290.6553272657517, -81.79307197635183, -1110.8814763892797, -248.35817580723406, -19.729392412449773, -12.606525031626704, -176.20299791301224, -76.67352693352797, -624.2914957484478, -40.834526769624404, -299.75493954251806, -36.079346562905535, -127.94888002601283, -960.1742437748253, -370.3457342766524, -65.44568270949898, -73.14264922268264, -43.226721611552094, -329.1057954743872, -292.55990115074763, -325.12401445680473, -139.29805312509382], "episode_lengths": [63, 71, 72, 99, 50, 93, 70, 135, 85, 65, 81, 106, 88, 77, 107, 35, 77, 150, 149, 39, 127, 126, 98, 106, 94, 90, 150, 136, 77, 87, 80, 89, 92, 150, 54, 74, 141, 41, 48, 85, 66, 85, 86, 150, 105, 119, 73, 98, 76, 49, 62, 111, 73, 150, 31, 105, 120, 150, 58, 72, 54, 58, 150, 150, 56, 150, 43, 41, 105, 86, 44, 111, 90, 70, 33, 48, 106, 50, 150, 69, 150, 114, 38, 39, 86, 53, 150, 54, 123, 54, 82, 150, 150, 60, 55, 49, 150, 110, 150, 60], "policy_policy_0_reward": [-67.69612130119535, -87.77567977463909, -128.87671049602298, -145.36125894251938, -41.02432563973928, -228.60420415937364, -111.57086779161588, -454.968958423836, -168.14937955955688, -72.0809658320122, -119.95867433055922, -163.09276865193448, -190.1487450359495, -130.9397506119516, -244.59844852380263, -12.372475881703938, -132.98230036855483, -342.98219601850866, -328.5011417018337, -16.255031704388156, -316.5756858311052, -334.035547525275, -209.72459398139438, -265.86968754751274, -223.86482537933122, -277.556361404114, -457.97283975802543, -405.9158484010985, -66.71319452153837, -346.14368597726957, -229.50138716134035, -200.997079570728, -131.35468584381445, -393.0666581250898, -67.39720252062767, -172.50093635912148, -846.607563623129, -39.60813040065306, -53.0706483282886, -140.79511399463834, -123.28268000168411, -118.04660351977256, -165.4973661627008, -1190.56039538996, -225.64895138535942, -415.66834158403225, -100.68387655531518, -201.8850337454028, -177.17395963151296, -26.595487727152367, -101.94409190160582, -254.30199068625623, -161.75325420665484, -545.4650470590151, 2.5629879282806454, -266.7100579629968, -316.65489364232354, -960.5819622386783, -65.34247992355253, -174.65699140662105, -78.28330898448009, -151.98294921038033, -991.3655007610533, -1071.3131567792327, -94.30731381502974, -592.745175249929, -36.084435019294446, -13.504730912085376, -304.7941377793648, -128.50539144414626, -17.851358936651383, -468.45696325990787, -181.16623039203358, -60.33960667119116, -16.225713929713642, -44.56559410590764, -263.4825789410877, -64.46512070659188, -290.6553272657517, -81.79307197635183, -1110.8814763892797, -248.35817580723406, -19.729392412449773, -12.606525031626704, -176.20299791301224, -76.67352693352797, -624.2914957484478, -40.834526769624404, -299.75493954251806, -36.079346562905535, -127.94888002601283, -960.1742437748253, -370.3457342766524, -65.44568270949898, -73.14264922268264, -43.226721611552094, -329.1057954743872, -292.55990115074763, -325.12401445680473, -139.29805312509382]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5619855062543512, "mean_inference_ms": 1.711359293063161, "mean_action_processing_ms": 0.2756082376080346, "mean_env_wait_ms": 3.403640712702233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012399911880493164, "StateBufferConnector_ms": 0.008340597152709961, "ViewRequirementAgentConnector_ms": 0.197404146194458}, "num_episodes": 51, "episode_return_max": 2.5629879282806454, "episode_return_min": -1190.56039538996, "episode_return_mean": -242.80773902885178, "episodes_this_iter": 51}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.90049185031114, "num_env_steps_trained_throughput_per_sec": 313.90049185031114, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 276000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 12515.236, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12515.166, "sample_time_ms": 1116.428, "learn_time_ms": 11332.011, "learn_throughput": 352.982, "synch_weights_time_ms": 65.93}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "training_iteration": 69, "trial_id": "b33d0_00000", "date": "2024-08-06_14-54-37", "timestamp": 1722936277, "time_this_iter_s": 12.755441665649414, "time_total_s": 839.7155964374542, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c16a320>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 839.7155964374542, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 17.900000000000002, "ram_util_percent": 29.316666666666663}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 125.53025835553805, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.6052766421809794, "policy_loss": -0.017619615292157203, "vf_loss": 2.6119518215457598, "vf_explained_var": 0.9796268315364917, "kl": 0.017297929440996996, "entropy": 0.7316711751123269, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 66720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "env_runners": {"episode_reward_max": 2.5629879282806454, "episode_reward_min": -1143.6175742091875, "episode_reward_mean": -235.24891194061456, "episode_len_mean": 87.17, "episode_media": {}, "episodes_timesteps_total": 8717, "policy_reward_min": {"policy_0": -1143.6175742091875}, "policy_reward_max": {"policy_0": 2.5629879282806454}, "policy_reward_mean": {"policy_0": -235.24891194061456}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-415.66834158403225, -100.68387655531518, -201.8850337454028, -177.17395963151296, -26.595487727152367, -101.94409190160582, -254.30199068625623, -161.75325420665484, -545.4650470590151, 2.5629879282806454, -266.7100579629968, -316.65489364232354, -960.5819622386783, -65.34247992355253, -174.65699140662105, -78.28330898448009, -151.98294921038033, -991.3655007610533, -1071.3131567792327, -94.30731381502974, -592.745175249929, -36.084435019294446, -13.504730912085376, -304.7941377793648, -128.50539144414626, -17.851358936651383, -468.45696325990787, -181.16623039203358, -60.33960667119116, -16.225713929713642, -44.56559410590764, -263.4825789410877, -64.46512070659188, -290.6553272657517, -81.79307197635183, -1110.8814763892797, -248.35817580723406, -19.729392412449773, -12.606525031626704, -176.20299791301224, -76.67352693352797, -624.2914957484478, -40.834526769624404, -299.75493954251806, -36.079346562905535, -127.94888002601283, -960.1742437748253, -370.3457342766524, -65.44568270949898, -73.14264922268264, -43.226721611552094, -329.1057954743872, -292.55990115074763, -325.12401445680473, -139.29805312509382, -179.8730633552596, -165.82220996819075, -132.1133416214504, -337.1994471825983, -153.07455169627235, -186.1279375287741, -148.90319557638742, -33.6538553625663, -110.74093715538453, -121.02727470462308, -436.373023652247, -103.26586514205745, -124.82850914437724, -314.568052310761, -409.4188352809167, -124.68664250316563, -1143.6175742091875, -164.43018318397225, -79.4810359214564, -263.0252046342592, -91.62668901068241, -93.32658091518306, -122.61524052542572, -876.9198277984705, -325.2443682752503, -275.8993254563657, -13.05728603559874, -288.5470379019143, -65.14340529756899, -79.71764571329486, -64.07534744453625, -243.65734806288197, -91.0288250281255, -151.77616768797566, -2.44114637099167, -254.24518516077504, -144.63151629047655, -66.28710987682557, -68.23769634288506, -118.81630206089869, -758.1742244846906, -88.22071089050682, -61.95979435483584, -163.47329916028974, -193.0121483591893], "episode_lengths": [119, 73, 98, 76, 49, 62, 111, 73, 150, 31, 105, 120, 150, 58, 72, 54, 58, 150, 150, 56, 150, 43, 41, 105, 86, 44, 111, 90, 70, 33, 48, 106, 50, 150, 69, 150, 114, 38, 39, 86, 53, 150, 54, 123, 54, 82, 150, 150, 60, 55, 49, 150, 110, 150, 60, 85, 106, 68, 150, 62, 91, 81, 47, 73, 76, 150, 69, 61, 150, 123, 66, 150, 95, 59, 108, 75, 70, 72, 150, 122, 100, 38, 141, 58, 68, 37, 68, 67, 88, 37, 95, 80, 58, 40, 56, 150, 67, 39, 94, 89], "policy_policy_0_reward": [-415.66834158403225, -100.68387655531518, -201.8850337454028, -177.17395963151296, -26.595487727152367, -101.94409190160582, -254.30199068625623, -161.75325420665484, -545.4650470590151, 2.5629879282806454, -266.7100579629968, -316.65489364232354, -960.5819622386783, -65.34247992355253, -174.65699140662105, -78.28330898448009, -151.98294921038033, -991.3655007610533, -1071.3131567792327, -94.30731381502974, -592.745175249929, -36.084435019294446, -13.504730912085376, -304.7941377793648, -128.50539144414626, -17.851358936651383, -468.45696325990787, -181.16623039203358, -60.33960667119116, -16.225713929713642, -44.56559410590764, -263.4825789410877, -64.46512070659188, -290.6553272657517, -81.79307197635183, -1110.8814763892797, -248.35817580723406, -19.729392412449773, -12.606525031626704, -176.20299791301224, -76.67352693352797, -624.2914957484478, -40.834526769624404, -299.75493954251806, -36.079346562905535, -127.94888002601283, -960.1742437748253, -370.3457342766524, -65.44568270949898, -73.14264922268264, -43.226721611552094, -329.1057954743872, -292.55990115074763, -325.12401445680473, -139.29805312509382, -179.8730633552596, -165.82220996819075, -132.1133416214504, -337.1994471825983, -153.07455169627235, -186.1279375287741, -148.90319557638742, -33.6538553625663, -110.74093715538453, -121.02727470462308, -436.373023652247, -103.26586514205745, -124.82850914437724, -314.568052310761, -409.4188352809167, -124.68664250316563, -1143.6175742091875, -164.43018318397225, -79.4810359214564, -263.0252046342592, -91.62668901068241, -93.32658091518306, -122.61524052542572, -876.9198277984705, -325.2443682752503, -275.8993254563657, -13.05728603559874, -288.5470379019143, -65.14340529756899, -79.71764571329486, -64.07534744453625, -243.65734806288197, -91.0288250281255, -151.77616768797566, -2.44114637099167, -254.24518516077504, -144.63151629047655, -66.28710987682557, -68.23769634288506, -118.81630206089869, -758.1742244846906, -88.22071089050682, -61.95979435483584, -163.47329916028974, -193.0121483591893]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5615992458188122, "mean_inference_ms": 1.7085709457285574, "mean_action_processing_ms": 0.2752938385158341, "mean_env_wait_ms": 3.401811820993818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012099027633666992, "StateBufferConnector_ms": 0.00814056396484375, "ViewRequirementAgentConnector_ms": 0.20432329177856445}, "num_episodes": 45, "episode_return_max": 2.5629879282806454, "episode_return_min": -1143.6175742091875, "episode_return_mean": -235.24891194061456, "episodes_this_iter": 45}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 358.74830378835213, "num_env_steps_trained_throughput_per_sec": 358.74830378835213, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 12470.184, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12470.111, "sample_time_ms": 1117.381, "learn_time_ms": 11284.067, "learn_throughput": 354.482, "synch_weights_time_ms": 67.86}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "training_iteration": 70, "trial_id": "b33d0_00000", "date": "2024-08-06_14-54-48", "timestamp": 1722936288, "time_this_iter_s": 11.163395643234253, "time_total_s": 850.8789920806885, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c1272e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 850.8789920806885, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 18.55625, "ram_util_percent": 29.3875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 113.33330654303232, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.2415755967997635, "policy_loss": -0.02313474913292642, "vf_loss": 2.253437460275988, "vf_explained_var": 0.9907381072640419, "kl": 0.01773443151663142, "entropy": 0.697856814476351, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 67680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "env_runners": {"episode_reward_max": -2.319982384899217, "episode_reward_min": -1187.372206485778, "episode_reward_mean": -199.57502918126443, "episode_len_mean": 83.36, "episode_media": {}, "episodes_timesteps_total": 8336, "policy_reward_min": {"policy_0": -1187.372206485778}, "policy_reward_max": {"policy_0": -2.319982384899217}, "policy_reward_mean": {"policy_0": -199.57502918126443}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-65.44568270949898, -73.14264922268264, -43.226721611552094, -329.1057954743872, -292.55990115074763, -325.12401445680473, -139.29805312509382, -179.8730633552596, -165.82220996819075, -132.1133416214504, -337.1994471825983, -153.07455169627235, -186.1279375287741, -148.90319557638742, -33.6538553625663, -110.74093715538453, -121.02727470462308, -436.373023652247, -103.26586514205745, -124.82850914437724, -314.568052310761, -409.4188352809167, -124.68664250316563, -1143.6175742091875, -164.43018318397225, -79.4810359214564, -263.0252046342592, -91.62668901068241, -93.32658091518306, -122.61524052542572, -876.9198277984705, -325.2443682752503, -275.8993254563657, -13.05728603559874, -288.5470379019143, -65.14340529756899, -79.71764571329486, -64.07534744453625, -243.65734806288197, -91.0288250281255, -151.77616768797566, -2.44114637099167, -254.24518516077504, -144.63151629047655, -66.28710987682557, -68.23769634288506, -118.81630206089869, -758.1742244846906, -88.22071089050682, -61.95979435483584, -163.47329916028974, -193.0121483591893, -199.38832678361032, -69.61800193391223, -115.18998490977081, -56.490594258252926, -153.4813698761401, -26.62358656315716, -82.48478366476392, -510.410621831905, -203.14482192310246, -70.19493064950396, -98.58025499573793, -322.488824299267, -64.34388873266371, -257.8934582659287, -17.90414036664556, -54.55247600336832, -107.29322335284473, -1187.372206485778, -255.02177774628493, -142.38905527746203, -34.05041144750026, -77.53889920324066, -97.07127057557432, -183.03035256836745, -58.32954082415973, -122.78968512539743, -129.49774339769738, -143.2015506800792, -122.59272671125332, -1019.9911432008261, -255.9982934786072, -40.810245203359685, -110.20470735708135, -298.8530219537377, -87.07889827978572, -92.98442575348137, -25.661545607000132, -2.319982384899217, -965.7961312689027, -117.69843617853694, -43.35887362844231, -56.60186270714384, -123.02833108133682, -337.8058541770424, -109.72941108575007, -156.0208623500077, -281.93762408574355, -166.38697350107876], "episode_lengths": [60, 55, 49, 150, 110, 150, 60, 85, 106, 68, 150, 62, 91, 81, 47, 73, 76, 150, 69, 61, 150, 123, 66, 150, 95, 59, 108, 75, 70, 72, 150, 122, 100, 38, 141, 58, 68, 37, 68, 67, 88, 37, 95, 80, 58, 40, 56, 150, 67, 39, 94, 89, 91, 52, 78, 54, 98, 41, 68, 150, 96, 60, 54, 150, 40, 100, 32, 62, 72, 150, 108, 83, 52, 70, 67, 86, 60, 89, 75, 74, 84, 150, 150, 50, 45, 115, 64, 62, 41, 34, 150, 73, 44, 56, 65, 113, 59, 82, 145, 79], "policy_policy_0_reward": [-65.44568270949898, -73.14264922268264, -43.226721611552094, -329.1057954743872, -292.55990115074763, -325.12401445680473, -139.29805312509382, -179.8730633552596, -165.82220996819075, -132.1133416214504, -337.1994471825983, -153.07455169627235, -186.1279375287741, -148.90319557638742, -33.6538553625663, -110.74093715538453, -121.02727470462308, -436.373023652247, -103.26586514205745, -124.82850914437724, -314.568052310761, -409.4188352809167, -124.68664250316563, -1143.6175742091875, -164.43018318397225, -79.4810359214564, -263.0252046342592, -91.62668901068241, -93.32658091518306, -122.61524052542572, -876.9198277984705, -325.2443682752503, -275.8993254563657, -13.05728603559874, -288.5470379019143, -65.14340529756899, -79.71764571329486, -64.07534744453625, -243.65734806288197, -91.0288250281255, -151.77616768797566, -2.44114637099167, -254.24518516077504, -144.63151629047655, -66.28710987682557, -68.23769634288506, -118.81630206089869, -758.1742244846906, -88.22071089050682, -61.95979435483584, -163.47329916028974, -193.0121483591893, -199.38832678361032, -69.61800193391223, -115.18998490977081, -56.490594258252926, -153.4813698761401, -26.62358656315716, -82.48478366476392, -510.410621831905, -203.14482192310246, -70.19493064950396, -98.58025499573793, -322.488824299267, -64.34388873266371, -257.8934582659287, -17.90414036664556, -54.55247600336832, -107.29322335284473, -1187.372206485778, -255.02177774628493, -142.38905527746203, -34.05041144750026, -77.53889920324066, -97.07127057557432, -183.03035256836745, -58.32954082415973, -122.78968512539743, -129.49774339769738, -143.2015506800792, -122.59272671125332, -1019.9911432008261, -255.9982934786072, -40.810245203359685, -110.20470735708135, -298.8530219537377, -87.07889827978572, -92.98442575348137, -25.661545607000132, -2.319982384899217, -965.7961312689027, -117.69843617853694, -43.35887362844231, -56.60186270714384, -123.02833108133682, -337.8058541770424, -109.72941108575007, -156.0208623500077, -281.93762408574355, -166.38697350107876]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5612937563351219, "mean_inference_ms": 1.7067933873941257, "mean_action_processing_ms": 0.27495881081781887, "mean_env_wait_ms": 3.3995342608487955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011690616607666016, "StateBufferConnector_ms": 0.007993936538696289, "ViewRequirementAgentConnector_ms": 0.2007606029510498}, "num_episodes": 48, "episode_return_max": -2.319982384899217, "episode_return_min": -1187.372206485778, "episode_return_mean": -199.57502918126443, "episodes_this_iter": 48}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.2539650411995, "num_env_steps_trained_throughput_per_sec": 323.2539650411995, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 284000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 284000, "timers": {"training_iteration_time_ms": 12436.235, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12436.162, "sample_time_ms": 1117.167, "learn_time_ms": 11250.101, "learn_throughput": 355.552, "synch_weights_time_ms": 68.089}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "done": false, "training_iteration": 71, "trial_id": "b33d0_00000", "date": "2024-08-06_14-55-01", "timestamp": 1722936301, "time_this_iter_s": 12.388205766677856, "time_total_s": 863.2671978473663, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c124040>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 863.2671978473663, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 17.56111111111111, "ram_util_percent": 29.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 89.56715359886488, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.3152457961191732, "policy_loss": -0.022225479371263644, "vf_loss": 2.326908601199587, "vf_explained_var": 0.9794229396308461, "kl": 0.01670653378981418, "entropy": 0.7142302636988461, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 68640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": -2.319982384899217, "episode_reward_min": -1187.372206485778, "episode_reward_mean": -195.0529624451941, "episode_len_mean": 83.12, "episode_media": {}, "episodes_timesteps_total": 8312, "policy_reward_min": {"policy_0": -1187.372206485778}, "policy_reward_max": {"policy_0": -2.319982384899217}, "policy_reward_mean": {"policy_0": -195.0529624451941}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-193.0121483591893, -199.38832678361032, -69.61800193391223, -115.18998490977081, -56.490594258252926, -153.4813698761401, -26.62358656315716, -82.48478366476392, -510.410621831905, -203.14482192310246, -70.19493064950396, -98.58025499573793, -322.488824299267, -64.34388873266371, -257.8934582659287, -17.90414036664556, -54.55247600336832, -107.29322335284473, -1187.372206485778, -255.02177774628493, -142.38905527746203, -34.05041144750026, -77.53889920324066, -97.07127057557432, -183.03035256836745, -58.32954082415973, -122.78968512539743, -129.49774339769738, -143.2015506800792, -122.59272671125332, -1019.9911432008261, -255.9982934786072, -40.810245203359685, -110.20470735708135, -298.8530219537377, -87.07889827978572, -92.98442575348137, -25.661545607000132, -2.319982384899217, -965.7961312689027, -117.69843617853694, -43.35887362844231, -56.60186270714384, -123.02833108133682, -337.8058541770424, -109.72941108575007, -156.0208623500077, -281.93762408574355, -166.38697350107876, -436.82743148926835, -1096.0994276815031, -93.20592055449532, -145.79816185747265, -228.54117113535017, -65.66300082275991, -383.86750328854407, -138.82361085410216, -123.71820163905477, -82.38853868427769, -352.5472995664077, -352.67018000149557, -146.46584310641364, -111.1706790867299, -100.15942347504149, -18.58267559020965, -1077.1589811088204, -179.72631301360235, -130.15173941951008, -32.96741405538945, -104.61741524068914, -217.60752901846365, -139.4025139606059, -150.15404842429427, -237.9589710031455, -114.61116753568466, -56.28130944689372, -193.1834498069218, -107.23355250582085, -64.47636380314039, -112.61248732628074, -210.33098659229051, -135.2531827105308, -103.71934729419273, -172.03964563039392, -484.6727680434655, -197.80581840054708, -43.61202296393428, -35.77389178577528, -82.33164809556597, -175.47834166116448, -26.602396343108623, -103.16153537001895, -360.16720210922875, -146.04853751969912, -67.08376964416728, -338.2430905337408, -41.500033277709505, -129.85874929200352, -333.58828974338337, -75.10538291077592], "episode_lengths": [89, 91, 52, 78, 54, 98, 41, 68, 150, 96, 60, 54, 150, 40, 100, 32, 62, 72, 150, 108, 83, 52, 70, 67, 86, 60, 89, 75, 74, 84, 150, 150, 50, 45, 115, 64, 62, 41, 34, 150, 73, 44, 56, 65, 113, 59, 82, 145, 79, 137, 150, 70, 91, 104, 58, 147, 73, 83, 43, 150, 150, 65, 84, 79, 43, 150, 88, 80, 51, 67, 97, 81, 81, 96, 77, 59, 63, 68, 61, 75, 104, 75, 76, 83, 150, 88, 50, 51, 66, 86, 42, 68, 150, 76, 62, 105, 47, 75, 124, 51], "policy_policy_0_reward": [-193.0121483591893, -199.38832678361032, -69.61800193391223, -115.18998490977081, -56.490594258252926, -153.4813698761401, -26.62358656315716, -82.48478366476392, -510.410621831905, -203.14482192310246, -70.19493064950396, -98.58025499573793, -322.488824299267, -64.34388873266371, -257.8934582659287, -17.90414036664556, -54.55247600336832, -107.29322335284473, -1187.372206485778, -255.02177774628493, -142.38905527746203, -34.05041144750026, -77.53889920324066, -97.07127057557432, -183.03035256836745, -58.32954082415973, -122.78968512539743, -129.49774339769738, -143.2015506800792, -122.59272671125332, -1019.9911432008261, -255.9982934786072, -40.810245203359685, -110.20470735708135, -298.8530219537377, -87.07889827978572, -92.98442575348137, -25.661545607000132, -2.319982384899217, -965.7961312689027, -117.69843617853694, -43.35887362844231, -56.60186270714384, -123.02833108133682, -337.8058541770424, -109.72941108575007, -156.0208623500077, -281.93762408574355, -166.38697350107876, -436.82743148926835, -1096.0994276815031, -93.20592055449532, -145.79816185747265, -228.54117113535017, -65.66300082275991, -383.86750328854407, -138.82361085410216, -123.71820163905477, -82.38853868427769, -352.5472995664077, -352.67018000149557, -146.46584310641364, -111.1706790867299, -100.15942347504149, -18.58267559020965, -1077.1589811088204, -179.72631301360235, -130.15173941951008, -32.96741405538945, -104.61741524068914, -217.60752901846365, -139.4025139606059, -150.15404842429427, -237.9589710031455, -114.61116753568466, -56.28130944689372, -193.1834498069218, -107.23355250582085, -64.47636380314039, -112.61248732628074, -210.33098659229051, -135.2531827105308, -103.71934729419273, -172.03964563039392, -484.6727680434655, -197.80581840054708, -43.61202296393428, -35.77389178577528, -82.33164809556597, -175.47834166116448, -26.602396343108623, -103.16153537001895, -360.16720210922875, -146.04853751969912, -67.08376964416728, -338.2430905337408, -41.500033277709505, -129.85874929200352, -333.58828974338337, -75.10538291077592]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5614623585300496, "mean_inference_ms": 1.7075496415746858, "mean_action_processing_ms": 0.275088112301377, "mean_env_wait_ms": 3.400961926852017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011715173721313477, "StateBufferConnector_ms": 0.008026838302612305, "ViewRequirementAgentConnector_ms": 0.19239354133605957}, "num_episodes": 51, "episode_return_max": -2.319982384899217, "episode_return_min": -1187.372206485778, "episode_return_mean": -195.0529624451941, "episodes_this_iter": 51}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.46860075094213, "num_env_steps_trained_throughput_per_sec": 311.46860075094213, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 12443.166, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12443.095, "sample_time_ms": 1118.711, "learn_time_ms": 11256.441, "learn_throughput": 355.352, "synch_weights_time_ms": 67.139}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 72, "trial_id": "b33d0_00000", "date": "2024-08-06_14-55-14", "timestamp": 1722936314, "time_this_iter_s": 12.855130910873413, "time_total_s": 876.1223287582397, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c125cf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 876.1223287582397, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 17.577777777777776, "ram_util_percent": 29.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 107.18307541410128, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.038350083275388, "policy_loss": -0.013607093423100498, "vf_loss": 2.0418935252974433, "vf_explained_var": 0.9866251736258467, "kl": 0.01612450922748394, "entropy": 0.8203937385852138, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 69600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "env_runners": {"episode_reward_max": -5.410531899801135, "episode_reward_min": -1132.9490527092503, "episode_reward_mean": -201.55602604608208, "episode_len_mean": 86.18, "episode_media": {}, "episodes_timesteps_total": 8618, "policy_reward_min": {"policy_0": -1132.9490527092503}, "policy_reward_max": {"policy_0": -5.410531899801135}, "policy_reward_mean": {"policy_0": -201.55602604608208}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-337.8058541770424, -109.72941108575007, -156.0208623500077, -281.93762408574355, -166.38697350107876, -436.82743148926835, -1096.0994276815031, -93.20592055449532, -145.79816185747265, -228.54117113535017, -65.66300082275991, -383.86750328854407, -138.82361085410216, -123.71820163905477, -82.38853868427769, -352.5472995664077, -352.67018000149557, -146.46584310641364, -111.1706790867299, -100.15942347504149, -18.58267559020965, -1077.1589811088204, -179.72631301360235, -130.15173941951008, -32.96741405538945, -104.61741524068914, -217.60752901846365, -139.4025139606059, -150.15404842429427, -237.9589710031455, -114.61116753568466, -56.28130944689372, -193.1834498069218, -107.23355250582085, -64.47636380314039, -112.61248732628074, -210.33098659229051, -135.2531827105308, -103.71934729419273, -172.03964563039392, -484.6727680434655, -197.80581840054708, -43.61202296393428, -35.77389178577528, -82.33164809556597, -175.47834166116448, -26.602396343108623, -103.16153537001895, -360.16720210922875, -146.04853751969912, -67.08376964416728, -338.2430905337408, -41.500033277709505, -129.85874929200352, -333.58828974338337, -75.10538291077592, -997.475695469994, -99.38133825928846, -26.785776467948587, -216.13508103996594, -9.882697376064572, -184.81199125454643, -28.62738331795116, -27.935550479201538, -144.93987388552853, -105.4490336272154, -340.90074092671614, -27.241287118240052, -105.40545214422119, -120.75406480010616, -84.80496739274194, -221.24499770525713, -271.0798216735001, -24.976055840873546, -183.25461632549124, -156.84078945454036, -258.7589532573192, -206.19272274690252, -49.944369858344956, -239.79726213224768, -110.04557992391408, -279.93885837332664, -476.38536634618066, -188.5327504060082, -191.9643980853732, -196.45516372700237, -130.1358113322887, -391.83741291298224, -175.91493541850903, -185.1475167672279, -439.0192634698047, -1132.9490527092503, -5.410531899801135, -269.86269562687784, -8.635193148787431, -144.9272532395768, -107.83382193197149, -107.86650758320906, -123.16944671943706, -248.020832808766], "episode_lengths": [113, 59, 82, 145, 79, 137, 150, 70, 91, 104, 58, 147, 73, 83, 43, 150, 150, 65, 84, 79, 43, 150, 88, 80, 51, 67, 97, 81, 81, 96, 77, 59, 63, 68, 61, 75, 104, 75, 76, 83, 150, 88, 50, 51, 66, 86, 42, 68, 150, 76, 62, 105, 47, 75, 124, 51, 150, 71, 47, 98, 35, 89, 46, 37, 83, 72, 124, 58, 70, 60, 67, 78, 101, 43, 101, 88, 113, 96, 59, 117, 74, 119, 150, 97, 83, 98, 80, 150, 61, 100, 122, 150, 39, 136, 35, 82, 70, 88, 58, 95], "policy_policy_0_reward": [-337.8058541770424, -109.72941108575007, -156.0208623500077, -281.93762408574355, -166.38697350107876, -436.82743148926835, -1096.0994276815031, -93.20592055449532, -145.79816185747265, -228.54117113535017, -65.66300082275991, -383.86750328854407, -138.82361085410216, -123.71820163905477, -82.38853868427769, -352.5472995664077, -352.67018000149557, -146.46584310641364, -111.1706790867299, -100.15942347504149, -18.58267559020965, -1077.1589811088204, -179.72631301360235, -130.15173941951008, -32.96741405538945, -104.61741524068914, -217.60752901846365, -139.4025139606059, -150.15404842429427, -237.9589710031455, -114.61116753568466, -56.28130944689372, -193.1834498069218, -107.23355250582085, -64.47636380314039, -112.61248732628074, -210.33098659229051, -135.2531827105308, -103.71934729419273, -172.03964563039392, -484.6727680434655, -197.80581840054708, -43.61202296393428, -35.77389178577528, -82.33164809556597, -175.47834166116448, -26.602396343108623, -103.16153537001895, -360.16720210922875, -146.04853751969912, -67.08376964416728, -338.2430905337408, -41.500033277709505, -129.85874929200352, -333.58828974338337, -75.10538291077592, -997.475695469994, -99.38133825928846, -26.785776467948587, -216.13508103996594, -9.882697376064572, -184.81199125454643, -28.62738331795116, -27.935550479201538, -144.93987388552853, -105.4490336272154, -340.90074092671614, -27.241287118240052, -105.40545214422119, -120.75406480010616, -84.80496739274194, -221.24499770525713, -271.0798216735001, -24.976055840873546, -183.25461632549124, -156.84078945454036, -258.7589532573192, -206.19272274690252, -49.944369858344956, -239.79726213224768, -110.04557992391408, -279.93885837332664, -476.38536634618066, -188.5327504060082, -191.9643980853732, -196.45516372700237, -130.1358113322887, -391.83741291298224, -175.91493541850903, -185.1475167672279, -439.0192634698047, -1132.9490527092503, -5.410531899801135, -269.86269562687784, -8.635193148787431, -144.9272532395768, -107.83382193197149, -107.86650758320906, -123.16944671943706, -248.020832808766]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5620455095324363, "mean_inference_ms": 1.7071284279748646, "mean_action_processing_ms": 0.27509870959559835, "mean_env_wait_ms": 3.400582062100193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012551307678222656, "StateBufferConnector_ms": 0.008066415786743164, "ViewRequirementAgentConnector_ms": 0.1923503875732422}, "num_episodes": 44, "episode_return_max": -5.410531899801135, "episode_return_min": -1132.9490527092503, "episode_return_mean": -201.55602604608208, "episodes_this_iter": 44}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 388.19409973389486, "num_env_steps_trained_throughput_per_sec": 388.19409973389486, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 292000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 292000, "timers": {"training_iteration_time_ms": 12275.763, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12275.692, "sample_time_ms": 1117.402, "learn_time_ms": 11092.653, "learn_throughput": 360.599, "synch_weights_time_ms": 64.849}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "done": false, "training_iteration": 73, "trial_id": "b33d0_00000", "date": "2024-08-06_14-55-24", "timestamp": 1722936324, "time_this_iter_s": 10.31578278541565, "time_total_s": 886.4381115436554, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2a93f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 886.4381115436554, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 19.10666666666667, "ram_util_percent": 29.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 96.23021200895309, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.3521710094685355, "policy_loss": -0.01900411690682328, "vf_loss": 2.358639064679543, "vf_explained_var": 0.9874694138765335, "kl": 0.019666334461483834, "entropy": 0.7387207289847235, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 70560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "env_runners": {"episode_reward_max": -5.410531899801135, "episode_reward_min": -1132.9490527092503, "episode_reward_mean": -200.38962808873939, "episode_len_mean": 86.28, "episode_media": {}, "episodes_timesteps_total": 8628, "policy_reward_min": {"policy_0": -1132.9490527092503}, "policy_reward_max": {"policy_0": -5.410531899801135}, "policy_reward_mean": {"policy_0": -200.38962808873939}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-175.47834166116448, -26.602396343108623, -103.16153537001895, -360.16720210922875, -146.04853751969912, -67.08376964416728, -338.2430905337408, -41.500033277709505, -129.85874929200352, -333.58828974338337, -75.10538291077592, -997.475695469994, -99.38133825928846, -26.785776467948587, -216.13508103996594, -9.882697376064572, -184.81199125454643, -28.62738331795116, -27.935550479201538, -144.93987388552853, -105.4490336272154, -340.90074092671614, -27.241287118240052, -105.40545214422119, -120.75406480010616, -84.80496739274194, -221.24499770525713, -271.0798216735001, -24.976055840873546, -183.25461632549124, -156.84078945454036, -258.7589532573192, -206.19272274690252, -49.944369858344956, -239.79726213224768, -110.04557992391408, -279.93885837332664, -476.38536634618066, -188.5327504060082, -191.9643980853732, -196.45516372700237, -130.1358113322887, -391.83741291298224, -175.91493541850903, -185.1475167672279, -439.0192634698047, -1132.9490527092503, -5.410531899801135, -269.86269562687784, -8.635193148787431, -144.9272532395768, -107.83382193197149, -107.86650758320906, -123.16944671943706, -248.020832808766, -313.1920352386318, -211.1787759784395, -187.50650773621706, -182.40413429676715, -118.93245752287133, -137.33514512854262, -154.07015259280308, -125.10735687688685, -84.19772575233877, -819.8558573864732, -10.92802600118958, -360.4636270575952, -36.01003696500338, -186.1837744629599, -20.358633269077902, -22.614027345121215, -261.68988892102044, -144.7322215950246, -470.48737938835995, -452.1185577204686, -25.188654415898185, -145.66373281792863, -140.9773373848144, -120.98782426023476, -198.48009766855256, -96.06792222200795, -237.6197812061679, -52.87332161557682, -23.659572885360852, -1038.4342603700234, -419.9363624181375, -116.80867570209375, -67.77140447827705, -24.18482602886964, -54.71373347587671, -55.63965205211335, -289.2366987371338, -180.41462041922946, -198.55898707391128, -164.47557248905008, -85.98240390210829, -192.25704649458265, -344.77889148412856, -220.5794646934976, -400.7953999530645], "episode_lengths": [86, 42, 68, 150, 76, 62, 105, 47, 75, 124, 51, 150, 71, 47, 98, 35, 89, 46, 37, 83, 72, 124, 58, 70, 60, 67, 78, 101, 43, 101, 88, 113, 96, 59, 117, 74, 119, 150, 97, 83, 98, 80, 150, 61, 100, 122, 150, 39, 136, 35, 82, 70, 88, 58, 95, 150, 93, 95, 101, 87, 75, 80, 81, 68, 150, 35, 134, 45, 81, 39, 41, 98, 62, 145, 130, 48, 86, 78, 75, 94, 67, 102, 57, 46, 150, 150, 73, 56, 41, 56, 53, 118, 89, 85, 93, 53, 94, 150, 102, 146], "policy_policy_0_reward": [-175.47834166116448, -26.602396343108623, -103.16153537001895, -360.16720210922875, -146.04853751969912, -67.08376964416728, -338.2430905337408, -41.500033277709505, -129.85874929200352, -333.58828974338337, -75.10538291077592, -997.475695469994, -99.38133825928846, -26.785776467948587, -216.13508103996594, -9.882697376064572, -184.81199125454643, -28.62738331795116, -27.935550479201538, -144.93987388552853, -105.4490336272154, -340.90074092671614, -27.241287118240052, -105.40545214422119, -120.75406480010616, -84.80496739274194, -221.24499770525713, -271.0798216735001, -24.976055840873546, -183.25461632549124, -156.84078945454036, -258.7589532573192, -206.19272274690252, -49.944369858344956, -239.79726213224768, -110.04557992391408, -279.93885837332664, -476.38536634618066, -188.5327504060082, -191.9643980853732, -196.45516372700237, -130.1358113322887, -391.83741291298224, -175.91493541850903, -185.1475167672279, -439.0192634698047, -1132.9490527092503, -5.410531899801135, -269.86269562687784, -8.635193148787431, -144.9272532395768, -107.83382193197149, -107.86650758320906, -123.16944671943706, -248.020832808766, -313.1920352386318, -211.1787759784395, -187.50650773621706, -182.40413429676715, -118.93245752287133, -137.33514512854262, -154.07015259280308, -125.10735687688685, -84.19772575233877, -819.8558573864732, -10.92802600118958, -360.4636270575952, -36.01003696500338, -186.1837744629599, -20.358633269077902, -22.614027345121215, -261.68988892102044, -144.7322215950246, -470.48737938835995, -452.1185577204686, -25.188654415898185, -145.66373281792863, -140.9773373848144, -120.98782426023476, -198.48009766855256, -96.06792222200795, -237.6197812061679, -52.87332161557682, -23.659572885360852, -1038.4342603700234, -419.9363624181375, -116.80867570209375, -67.77140447827705, -24.18482602886964, -54.71373347587671, -55.63965205211335, -289.2366987371338, -180.41462041922946, -198.55898707391128, -164.47557248905008, -85.98240390210829, -192.25704649458265, -344.77889148412856, -220.5794646934976, -400.7953999530645]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5625224613322674, "mean_inference_ms": 1.7076239166968172, "mean_action_processing_ms": 0.27546542882345465, "mean_env_wait_ms": 3.400688188583248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012537479400634766, "StateBufferConnector_ms": 0.007959127426147461, "ViewRequirementAgentConnector_ms": 0.19072532653808594}, "num_episodes": 45, "episode_return_max": -5.410531899801135, "episode_return_min": -1132.9490527092503, "episode_return_mean": -200.38962808873939, "episodes_this_iter": 45}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 465.0784678482784, "num_env_steps_trained_throughput_per_sec": 465.0784678482784, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 296000, "timers": {"training_iteration_time_ms": 11899.112, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11899.042, "sample_time_ms": 1117.846, "learn_time_ms": 10717.864, "learn_throughput": 373.209, "synch_weights_time_ms": 62.547}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "done": false, "training_iteration": 74, "trial_id": "b33d0_00000", "date": "2024-08-06_14-55-33", "timestamp": 1722936333, "time_this_iter_s": 8.614601612091064, "time_total_s": 895.0527131557465, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c169990>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 895.0527131557465, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 21.391666666666666, "ram_util_percent": 29.374999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 131.10253387292227, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.664710453463097, "policy_loss": -0.025009200799589355, "vf_loss": 2.6782240947087605, "vf_explained_var": 0.9892995778471232, "kl": 0.018435524784702843, "entropy": 0.9484229448561867, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 71520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "env_runners": {"episode_reward_max": -5.410531899801135, "episode_reward_min": -1361.2473581505199, "episode_reward_mean": -260.26083115802516, "episode_len_mean": 92.58, "episode_media": {}, "episodes_timesteps_total": 9258, "policy_reward_min": {"policy_0": -1361.2473581505199}, "policy_reward_max": {"policy_0": -5.410531899801135}, "policy_reward_mean": {"policy_0": -260.26083115802516}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-196.45516372700237, -130.1358113322887, -391.83741291298224, -175.91493541850903, -185.1475167672279, -439.0192634698047, -1132.9490527092503, -5.410531899801135, -269.86269562687784, -8.635193148787431, -144.9272532395768, -107.83382193197149, -107.86650758320906, -123.16944671943706, -248.020832808766, -313.1920352386318, -211.1787759784395, -187.50650773621706, -182.40413429676715, -118.93245752287133, -137.33514512854262, -154.07015259280308, -125.10735687688685, -84.19772575233877, -819.8558573864732, -10.92802600118958, -360.4636270575952, -36.01003696500338, -186.1837744629599, -20.358633269077902, -22.614027345121215, -261.68988892102044, -144.7322215950246, -470.48737938835995, -452.1185577204686, -25.188654415898185, -145.66373281792863, -140.9773373848144, -120.98782426023476, -198.48009766855256, -96.06792222200795, -237.6197812061679, -52.87332161557682, -23.659572885360852, -1038.4342603700234, -419.9363624181375, -116.80867570209375, -67.77140447827705, -24.18482602886964, -54.71373347587671, -55.63965205211335, -289.2366987371338, -180.41462041922946, -198.55898707391128, -164.47557248905008, -85.98240390210829, -192.25704649458265, -344.77889148412856, -220.5794646934976, -400.7953999530645, -134.41765376415944, -182.25853091231244, -190.0914781522402, -263.34776638744285, -1093.704060001595, -249.33803752024613, -20.410957862390998, -52.269171410178735, -153.38325161312883, -877.7259200859738, -1361.2473581505199, -300.4238327880822, -111.18791168353755, -75.11015945169576, -71.31133150032474, -208.0551317679492, -119.05385446656409, -225.38995948517496, -128.1341070698126, -180.93495423440194, -160.0649017717635, -255.25723918016908, -911.169115049783, -559.959646459878, -89.96341225304367, -227.45100898681193, -459.7605657559375, -100.66697750264474, -378.6075248671122, -322.9304667614189, -81.6962925738696, -208.40301219928767, -523.3172794431075, -865.9694305908893, -338.1621979284321, -86.331522827703, -13.662538489058965, -264.4368553870556, -1214.3646495955131, -103.47504509138109], "episode_lengths": [98, 80, 150, 61, 100, 122, 150, 39, 136, 35, 82, 70, 88, 58, 95, 150, 93, 95, 101, 87, 75, 80, 81, 68, 150, 35, 134, 45, 81, 39, 41, 98, 62, 145, 130, 48, 86, 78, 75, 94, 67, 102, 57, 46, 150, 150, 73, 56, 41, 56, 53, 118, 89, 85, 93, 53, 94, 150, 102, 146, 71, 81, 95, 101, 150, 102, 49, 54, 63, 150, 150, 108, 68, 73, 59, 95, 76, 108, 66, 85, 55, 105, 150, 150, 76, 94, 150, 66, 120, 110, 57, 100, 150, 150, 150, 53, 42, 135, 150, 75], "policy_policy_0_reward": [-196.45516372700237, -130.1358113322887, -391.83741291298224, -175.91493541850903, -185.1475167672279, -439.0192634698047, -1132.9490527092503, -5.410531899801135, -269.86269562687784, -8.635193148787431, -144.9272532395768, -107.83382193197149, -107.86650758320906, -123.16944671943706, -248.020832808766, -313.1920352386318, -211.1787759784395, -187.50650773621706, -182.40413429676715, -118.93245752287133, -137.33514512854262, -154.07015259280308, -125.10735687688685, -84.19772575233877, -819.8558573864732, -10.92802600118958, -360.4636270575952, -36.01003696500338, -186.1837744629599, -20.358633269077902, -22.614027345121215, -261.68988892102044, -144.7322215950246, -470.48737938835995, -452.1185577204686, -25.188654415898185, -145.66373281792863, -140.9773373848144, -120.98782426023476, -198.48009766855256, -96.06792222200795, -237.6197812061679, -52.87332161557682, -23.659572885360852, -1038.4342603700234, -419.9363624181375, -116.80867570209375, -67.77140447827705, -24.18482602886964, -54.71373347587671, -55.63965205211335, -289.2366987371338, -180.41462041922946, -198.55898707391128, -164.47557248905008, -85.98240390210829, -192.25704649458265, -344.77889148412856, -220.5794646934976, -400.7953999530645, -134.41765376415944, -182.25853091231244, -190.0914781522402, -263.34776638744285, -1093.704060001595, -249.33803752024613, -20.410957862390998, -52.269171410178735, -153.38325161312883, -877.7259200859738, -1361.2473581505199, -300.4238327880822, -111.18791168353755, -75.11015945169576, -71.31133150032474, -208.0551317679492, -119.05385446656409, -225.38995948517496, -128.1341070698126, -180.93495423440194, -160.0649017717635, -255.25723918016908, -911.169115049783, -559.959646459878, -89.96341225304367, -227.45100898681193, -459.7605657559375, -100.66697750264474, -378.6075248671122, -322.9304667614189, -81.6962925738696, -208.40301219928767, -523.3172794431075, -865.9694305908893, -338.1621979284321, -86.331522827703, -13.662538489058965, -264.4368553870556, -1214.3646495955131, -103.47504509138109]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5621361829109116, "mean_inference_ms": 1.7063740384170938, "mean_action_processing_ms": 0.2753288150505863, "mean_env_wait_ms": 3.3983355986649944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012432336807250977, "StateBufferConnector_ms": 0.008042097091674805, "ViewRequirementAgentConnector_ms": 0.19184064865112305}, "num_episodes": 40, "episode_return_max": -5.410531899801135, "episode_return_min": -1361.2473581505199, "episode_return_mean": -260.26083115802516, "episodes_this_iter": 40}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.7370083179401, "num_env_steps_trained_throughput_per_sec": 311.7370083179401, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 300000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 11892.47, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11892.397, "sample_time_ms": 1117.807, "learn_time_ms": 10711.753, "learn_throughput": 373.422, "synch_weights_time_ms": 62.064}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "training_iteration": 75, "trial_id": "b33d0_00000", "date": "2024-08-06_14-55-45", "timestamp": 1722936345, "time_this_iter_s": 12.8444664478302, "time_total_s": 907.8971796035767, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c16b010>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 907.8971796035767, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 17.58888888888889, "ram_util_percent": 29.37222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 145.36295086542765, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.118535862956196, "policy_loss": -0.023018018495834743, "vf_loss": 2.129933364968747, "vf_explained_var": 0.9922798798109095, "kl": 0.01842699451929858, "entropy": 0.8177063887317976, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 72480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": -13.662538489058965, "episode_reward_min": -1361.2473581505199, "episode_reward_mean": -289.25543351969924, "episode_len_mean": 97.3, "episode_media": {}, "episodes_timesteps_total": 9730, "policy_reward_min": {"policy_0": -1361.2473581505199}, "policy_reward_max": {"policy_0": -13.662538489058965}, "policy_reward_mean": {"policy_0": -289.25543351969924}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-237.6197812061679, -52.87332161557682, -23.659572885360852, -1038.4342603700234, -419.9363624181375, -116.80867570209375, -67.77140447827705, -24.18482602886964, -54.71373347587671, -55.63965205211335, -289.2366987371338, -180.41462041922946, -198.55898707391128, -164.47557248905008, -85.98240390210829, -192.25704649458265, -344.77889148412856, -220.5794646934976, -400.7953999530645, -134.41765376415944, -182.25853091231244, -190.0914781522402, -263.34776638744285, -1093.704060001595, -249.33803752024613, -20.410957862390998, -52.269171410178735, -153.38325161312883, -877.7259200859738, -1361.2473581505199, -300.4238327880822, -111.18791168353755, -75.11015945169576, -71.31133150032474, -208.0551317679492, -119.05385446656409, -225.38995948517496, -128.1341070698126, -180.93495423440194, -160.0649017717635, -255.25723918016908, -911.169115049783, -559.959646459878, -89.96341225304367, -227.45100898681193, -459.7605657559375, -100.66697750264474, -378.6075248671122, -322.9304667614189, -81.6962925738696, -208.40301219928767, -523.3172794431075, -865.9694305908893, -338.1621979284321, -86.331522827703, -13.662538489058965, -264.4368553870556, -1214.3646495955131, -103.47504509138109, -172.6519280567178, -284.5784885605781, -83.32224883481375, -499.6991456088332, -149.98197795368847, -162.71269361302737, -192.05676426299775, -150.2155460140389, -892.9032019420599, -207.51810087092954, -208.3196976630971, -948.9467527108928, -303.0557204670455, -87.35371708365517, -155.73131141833105, -798.6273340186627, -139.10601407329153, -189.3460769224928, -44.7438930411048, -413.345816522658, -149.1726064318984, -1073.0329014836743, -93.78563796833632, -265.121594111202, -93.34832489712389, -123.85230602358891, -215.52388319624973, -362.5046082559207, -407.52059634915656, -108.55831404010799, -241.2327748945156, -68.28446645592662, -807.7363054419603, -232.63260103105586, -40.95920472039165, -185.74224198308863, -115.22149178975846, -392.9240343484345, -197.1579909113412, -79.81004320664758, -255.03920828883153], "episode_lengths": [102, 57, 46, 150, 150, 73, 56, 41, 56, 53, 118, 89, 85, 93, 53, 94, 150, 102, 146, 71, 81, 95, 101, 150, 102, 49, 54, 63, 150, 150, 108, 68, 73, 59, 95, 76, 108, 66, 85, 55, 105, 150, 150, 76, 94, 150, 66, 120, 110, 57, 100, 150, 150, 150, 53, 42, 135, 150, 75, 90, 120, 61, 136, 85, 87, 86, 93, 150, 107, 103, 150, 150, 86, 101, 150, 67, 92, 42, 143, 86, 150, 65, 104, 73, 71, 98, 127, 150, 53, 88, 63, 150, 100, 47, 81, 67, 143, 97, 57, 105], "policy_policy_0_reward": [-237.6197812061679, -52.87332161557682, -23.659572885360852, -1038.4342603700234, -419.9363624181375, -116.80867570209375, -67.77140447827705, -24.18482602886964, -54.71373347587671, -55.63965205211335, -289.2366987371338, -180.41462041922946, -198.55898707391128, -164.47557248905008, -85.98240390210829, -192.25704649458265, -344.77889148412856, -220.5794646934976, -400.7953999530645, -134.41765376415944, -182.25853091231244, -190.0914781522402, -263.34776638744285, -1093.704060001595, -249.33803752024613, -20.410957862390998, -52.269171410178735, -153.38325161312883, -877.7259200859738, -1361.2473581505199, -300.4238327880822, -111.18791168353755, -75.11015945169576, -71.31133150032474, -208.0551317679492, -119.05385446656409, -225.38995948517496, -128.1341070698126, -180.93495423440194, -160.0649017717635, -255.25723918016908, -911.169115049783, -559.959646459878, -89.96341225304367, -227.45100898681193, -459.7605657559375, -100.66697750264474, -378.6075248671122, -322.9304667614189, -81.6962925738696, -208.40301219928767, -523.3172794431075, -865.9694305908893, -338.1621979284321, -86.331522827703, -13.662538489058965, -264.4368553870556, -1214.3646495955131, -103.47504509138109, -172.6519280567178, -284.5784885605781, -83.32224883481375, -499.6991456088332, -149.98197795368847, -162.71269361302737, -192.05676426299775, -150.2155460140389, -892.9032019420599, -207.51810087092954, -208.3196976630971, -948.9467527108928, -303.0557204670455, -87.35371708365517, -155.73131141833105, -798.6273340186627, -139.10601407329153, -189.3460769224928, -44.7438930411048, -413.345816522658, -149.1726064318984, -1073.0329014836743, -93.78563796833632, -265.121594111202, -93.34832489712389, -123.85230602358891, -215.52388319624973, -362.5046082559207, -407.52059634915656, -108.55831404010799, -241.2327748945156, -68.28446645592662, -807.7363054419603, -232.63260103105586, -40.95920472039165, -185.74224198308863, -115.22149178975846, -392.9240343484345, -197.1579909113412, -79.81004320664758, -255.03920828883153]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5620054312554928, "mean_inference_ms": 1.704646540349752, "mean_action_processing_ms": 0.2752396142814642, "mean_env_wait_ms": 3.394287472624436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01292109489440918, "StateBufferConnector_ms": 0.008023977279663086, "ViewRequirementAgentConnector_ms": 0.1914076805114746}, "num_episodes": 41, "episode_return_max": -13.662538489058965, "episode_return_min": -1361.2473581505199, "episode_return_mean": -289.25543351969924, "episodes_this_iter": 41}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.36151210142214, "num_env_steps_trained_throughput_per_sec": 319.36151210142214, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 11852.355, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11852.283, "sample_time_ms": 1097.296, "learn_time_ms": 10692.429, "learn_throughput": 374.096, "synch_weights_time_ms": 61.784}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 76, "trial_id": "b33d0_00000", "date": "2024-08-06_14-55-58", "timestamp": 1722936358, "time_this_iter_s": 12.537451028823853, "time_total_s": 920.4346306324005, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c127ac0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 920.4346306324005, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 17.65555555555555, "ram_util_percent": 29.36666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 90.88574094275633, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.2322245090578994, "policy_loss": -0.020230489941604902, "vf_loss": 2.239058628802498, "vf_explained_var": 0.9841326548407475, "kl": 0.020627521366547323, "entropy": 0.5272171734521787, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 73440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "env_runners": {"episode_reward_max": -12.962983215068514, "episode_reward_min": -1214.3646495955131, "episode_reward_mean": -238.99439293222986, "episode_len_mean": 91.18, "episode_media": {}, "episodes_timesteps_total": 9118, "policy_reward_min": {"policy_0": -1214.3646495955131}, "policy_reward_max": {"policy_0": -12.962983215068514}, "policy_reward_mean": {"policy_0": -238.99439293222986}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-865.9694305908893, -338.1621979284321, -86.331522827703, -13.662538489058965, -264.4368553870556, -1214.3646495955131, -103.47504509138109, -172.6519280567178, -284.5784885605781, -83.32224883481375, -499.6991456088332, -149.98197795368847, -162.71269361302737, -192.05676426299775, -150.2155460140389, -892.9032019420599, -207.51810087092954, -208.3196976630971, -948.9467527108928, -303.0557204670455, -87.35371708365517, -155.73131141833105, -798.6273340186627, -139.10601407329153, -189.3460769224928, -44.7438930411048, -413.345816522658, -149.1726064318984, -1073.0329014836743, -93.78563796833632, -265.121594111202, -93.34832489712389, -123.85230602358891, -215.52388319624973, -362.5046082559207, -407.52059634915656, -108.55831404010799, -241.2327748945156, -68.28446645592662, -807.7363054419603, -232.63260103105586, -40.95920472039165, -185.74224198308863, -115.22149178975846, -392.9240343484345, -197.1579909113412, -79.81004320664758, -255.03920828883153, -134.6091169899087, -372.8495955770454, -167.1280498961277, -167.7575655798428, -147.21302781681925, -137.7790323953023, -81.27065718378685, -197.44786988497557, -219.60415883597574, -55.69629513671117, -123.14398366774213, -1086.1247824467991, -46.24421334510888, -158.14862187780147, -43.635802561017805, -75.56121950508178, -16.94133936330608, -246.89139663195056, -92.33642492807448, -101.27844861539117, -55.70627725558756, -192.05158111778687, -153.04021908364527, -319.2085299842155, -100.6995108467579, -34.01098615669093, -67.3430410147452, -99.99406951901217, -245.98695352153646, -138.11140878566653, -353.0835399000082, -178.091676149986, -319.7910799082828, -192.95383373869714, -274.06903819493937, -131.68132010495754, -42.24836152338222, -146.87822664326984, -256.89250801989806, -480.5247119029452, -64.06162530321441, -989.4853100602411, -136.1500896463709, -159.2488166966792, -83.1330500313568, -145.19409126414973, -165.6121286038428, -76.89184432276159, -12.962983215068514, -61.12848464561845, -35.54250727851413, -36.22008116622815], "episode_lengths": [150, 150, 53, 42, 135, 150, 75, 90, 120, 61, 136, 85, 87, 86, 93, 150, 107, 103, 150, 150, 86, 101, 150, 67, 92, 42, 143, 86, 150, 65, 104, 73, 71, 98, 127, 150, 53, 88, 63, 150, 100, 47, 81, 67, 143, 97, 57, 105, 78, 117, 88, 99, 79, 58, 63, 93, 109, 72, 89, 150, 59, 82, 50, 54, 37, 97, 70, 68, 56, 129, 89, 118, 91, 46, 52, 66, 93, 73, 150, 90, 150, 89, 119, 79, 51, 74, 92, 150, 56, 150, 70, 78, 48, 76, 88, 60, 49, 58, 47, 40], "policy_policy_0_reward": [-865.9694305908893, -338.1621979284321, -86.331522827703, -13.662538489058965, -264.4368553870556, -1214.3646495955131, -103.47504509138109, -172.6519280567178, -284.5784885605781, -83.32224883481375, -499.6991456088332, -149.98197795368847, -162.71269361302737, -192.05676426299775, -150.2155460140389, -892.9032019420599, -207.51810087092954, -208.3196976630971, -948.9467527108928, -303.0557204670455, -87.35371708365517, -155.73131141833105, -798.6273340186627, -139.10601407329153, -189.3460769224928, -44.7438930411048, -413.345816522658, -149.1726064318984, -1073.0329014836743, -93.78563796833632, -265.121594111202, -93.34832489712389, -123.85230602358891, -215.52388319624973, -362.5046082559207, -407.52059634915656, -108.55831404010799, -241.2327748945156, -68.28446645592662, -807.7363054419603, -232.63260103105586, -40.95920472039165, -185.74224198308863, -115.22149178975846, -392.9240343484345, -197.1579909113412, -79.81004320664758, -255.03920828883153, -134.6091169899087, -372.8495955770454, -167.1280498961277, -167.7575655798428, -147.21302781681925, -137.7790323953023, -81.27065718378685, -197.44786988497557, -219.60415883597574, -55.69629513671117, -123.14398366774213, -1086.1247824467991, -46.24421334510888, -158.14862187780147, -43.635802561017805, -75.56121950508178, -16.94133936330608, -246.89139663195056, -92.33642492807448, -101.27844861539117, -55.70627725558756, -192.05158111778687, -153.04021908364527, -319.2085299842155, -100.6995108467579, -34.01098615669093, -67.3430410147452, -99.99406951901217, -245.98695352153646, -138.11140878566653, -353.0835399000082, -178.091676149986, -319.7910799082828, -192.95383373869714, -274.06903819493937, -131.68132010495754, -42.24836152338222, -146.87822664326984, -256.89250801989806, -480.5247119029452, -64.06162530321441, -989.4853100602411, -136.1500896463709, -159.2488166966792, -83.1330500313568, -145.19409126414973, -165.6121286038428, -76.89184432276159, -12.962983215068514, -61.12848464561845, -35.54250727851413, -36.22008116622815]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5618478909603106, "mean_inference_ms": 1.7042150689659872, "mean_action_processing_ms": 0.27499539007560453, "mean_env_wait_ms": 3.3918363393826123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01249837875366211, "StateBufferConnector_ms": 0.007839441299438477, "ViewRequirementAgentConnector_ms": 0.1989278793334961}, "num_episodes": 52, "episode_return_max": -12.962983215068514, "episode_return_min": -1214.3646495955131, "episode_return_mean": -238.99439293222986, "episodes_this_iter": 52}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 351.3656254367929, "num_env_steps_trained_throughput_per_sec": 351.3656254367929, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 308000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 308000, "timers": {"training_iteration_time_ms": 11724.346, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11724.273, "sample_time_ms": 1104.157, "learn_time_ms": 10557.151, "learn_throughput": 378.89, "synch_weights_time_ms": 62.191}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "done": false, "training_iteration": 77, "trial_id": "b33d0_00000", "date": "2024-08-06_14-56-09", "timestamp": 1722936369, "time_this_iter_s": 11.39733338356018, "time_total_s": 931.8319640159607, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c125750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 931.8319640159607, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 18.50625, "ram_util_percent": 29.393749999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 92.64580350518227, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 2.0079527042185266, "policy_loss": -0.020403113156498877, "vf_loss": 2.013224730826914, "vf_explained_var": 0.9890158565094074, "kl": 0.015570100158341479, "entropy": 0.6336387477815151, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 74400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "env_runners": {"episode_reward_max": -12.962983215068514, "episode_reward_min": -1086.1247824467991, "episode_reward_mean": -177.671034939994, "episode_len_mean": 83.39, "episode_media": {}, "episodes_timesteps_total": 8339, "policy_reward_min": {"policy_0": -1086.1247824467991}, "policy_reward_max": {"policy_0": -12.962983215068514}, "policy_reward_mean": {"policy_0": -177.671034939994}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-79.81004320664758, -255.03920828883153, -134.6091169899087, -372.8495955770454, -167.1280498961277, -167.7575655798428, -147.21302781681925, -137.7790323953023, -81.27065718378685, -197.44786988497557, -219.60415883597574, -55.69629513671117, -123.14398366774213, -1086.1247824467991, -46.24421334510888, -158.14862187780147, -43.635802561017805, -75.56121950508178, -16.94133936330608, -246.89139663195056, -92.33642492807448, -101.27844861539117, -55.70627725558756, -192.05158111778687, -153.04021908364527, -319.2085299842155, -100.6995108467579, -34.01098615669093, -67.3430410147452, -99.99406951901217, -245.98695352153646, -138.11140878566653, -353.0835399000082, -178.091676149986, -319.7910799082828, -192.95383373869714, -274.06903819493937, -131.68132010495754, -42.24836152338222, -146.87822664326984, -256.89250801989806, -480.5247119029452, -64.06162530321441, -989.4853100602411, -136.1500896463709, -159.2488166966792, -83.1330500313568, -145.19409126414973, -165.6121286038428, -76.89184432276159, -12.962983215068514, -61.12848464561845, -35.54250727851413, -36.22008116622815, -45.007291662346816, -163.33754031981766, -55.351209937060375, -73.45829845802504, -183.55428489517118, -406.8338651821205, -35.028399574620195, -173.97466498463595, -268.27143678178794, -429.10875828050985, -228.71785352171386, -287.3106050687733, -63.28045846996332, -94.86989574339444, -69.05512187892815, -163.70539097256014, -460.0665466696127, -17.551112672298373, -99.31027558385092, -143.16801154644588, -49.28768099249142, -131.31707780160815, -216.28061493233284, -245.38501365192124, -157.07031033200852, -118.49054985161949, -284.70266001567404, -107.7517668730045, -61.2920389546242, -164.15022900079046, -250.9437113352356, -510.35303846690806, -133.6336575572001, -83.67830733983328, -333.4715009062522, -204.78260097850298, -237.4816701259381, -73.1393699793617, -92.22082262915232, -63.479452193384, -320.33331256001054, -360.80939591497395, -94.66339568515447, -150.5063994990714, -83.33984078963636, -23.06931408876926], "episode_lengths": [57, 105, 78, 117, 88, 99, 79, 58, 63, 93, 109, 72, 89, 150, 59, 82, 50, 54, 37, 97, 70, 68, 56, 129, 89, 118, 91, 46, 52, 66, 93, 73, 150, 90, 150, 89, 119, 79, 51, 74, 92, 150, 56, 150, 70, 78, 48, 76, 88, 60, 49, 58, 47, 40, 56, 86, 55, 64, 83, 150, 47, 75, 118, 123, 100, 114, 48, 60, 64, 76, 150, 47, 56, 81, 65, 78, 100, 103, 86, 76, 111, 63, 57, 74, 118, 150, 96, 58, 125, 110, 96, 55, 66, 58, 130, 104, 68, 85, 64, 39], "policy_policy_0_reward": [-79.81004320664758, -255.03920828883153, -134.6091169899087, -372.8495955770454, -167.1280498961277, -167.7575655798428, -147.21302781681925, -137.7790323953023, -81.27065718378685, -197.44786988497557, -219.60415883597574, -55.69629513671117, -123.14398366774213, -1086.1247824467991, -46.24421334510888, -158.14862187780147, -43.635802561017805, -75.56121950508178, -16.94133936330608, -246.89139663195056, -92.33642492807448, -101.27844861539117, -55.70627725558756, -192.05158111778687, -153.04021908364527, -319.2085299842155, -100.6995108467579, -34.01098615669093, -67.3430410147452, -99.99406951901217, -245.98695352153646, -138.11140878566653, -353.0835399000082, -178.091676149986, -319.7910799082828, -192.95383373869714, -274.06903819493937, -131.68132010495754, -42.24836152338222, -146.87822664326984, -256.89250801989806, -480.5247119029452, -64.06162530321441, -989.4853100602411, -136.1500896463709, -159.2488166966792, -83.1330500313568, -145.19409126414973, -165.6121286038428, -76.89184432276159, -12.962983215068514, -61.12848464561845, -35.54250727851413, -36.22008116622815, -45.007291662346816, -163.33754031981766, -55.351209937060375, -73.45829845802504, -183.55428489517118, -406.8338651821205, -35.028399574620195, -173.97466498463595, -268.27143678178794, -429.10875828050985, -228.71785352171386, -287.3106050687733, -63.28045846996332, -94.86989574339444, -69.05512187892815, -163.70539097256014, -460.0665466696127, -17.551112672298373, -99.31027558385092, -143.16801154644588, -49.28768099249142, -131.31707780160815, -216.28061493233284, -245.38501365192124, -157.07031033200852, -118.49054985161949, -284.70266001567404, -107.7517668730045, -61.2920389546242, -164.15022900079046, -250.9437113352356, -510.35303846690806, -133.6336575572001, -83.67830733983328, -333.4715009062522, -204.78260097850298, -237.4816701259381, -73.1393699793617, -92.22082262915232, -63.479452193384, -320.33331256001054, -360.80939591497395, -94.66339568515447, -150.5063994990714, -83.33984078963636, -23.06931408876926]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5616266376681811, "mean_inference_ms": 1.7045234270064915, "mean_action_processing_ms": 0.2748415321970368, "mean_env_wait_ms": 3.392446761125294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012297630310058594, "StateBufferConnector_ms": 0.007936477661132812, "ViewRequirementAgentConnector_ms": 0.21776175498962402}, "num_episodes": 46, "episode_return_max": -12.962983215068514, "episode_return_min": -1086.1247824467991, "episode_return_mean": -177.671034939994, "episodes_this_iter": 46}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.7822127332313, "num_env_steps_trained_throughput_per_sec": 302.7822127332313, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 11796.557, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11796.484, "sample_time_ms": 1117.09, "learn_time_ms": 10616.286, "learn_throughput": 376.78, "synch_weights_time_ms": 62.332}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "training_iteration": 78, "trial_id": "b33d0_00000", "date": "2024-08-06_14-56-23", "timestamp": 1722936383, "time_this_iter_s": 13.223513841629028, "time_total_s": 945.0554778575897, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c126830>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 945.0554778575897, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 17.205263157894734, "ram_util_percent": 29.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 119.19544787804286, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 1.9868254172615707, "policy_loss": -0.026089616503062036, "vf_loss": 1.999750715835641, "vf_explained_var": 0.9921357965096831, "kl": 0.013753565086578117, "entropy": 0.761175139589856, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 75360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "env_runners": {"episode_reward_max": -9.804435855785215, "episode_reward_min": -1101.4989691069163, "episode_reward_mean": -194.11245563003092, "episode_len_mean": 83.01, "episode_media": {}, "episodes_timesteps_total": 8301, "policy_reward_min": {"policy_0": -1101.4989691069163}, "policy_reward_max": {"policy_0": -9.804435855785215}, "policy_reward_mean": {"policy_0": -194.11245563003092}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-83.1330500313568, -145.19409126414973, -165.6121286038428, -76.89184432276159, -12.962983215068514, -61.12848464561845, -35.54250727851413, -36.22008116622815, -45.007291662346816, -163.33754031981766, -55.351209937060375, -73.45829845802504, -183.55428489517118, -406.8338651821205, -35.028399574620195, -173.97466498463595, -268.27143678178794, -429.10875828050985, -228.71785352171386, -287.3106050687733, -63.28045846996332, -94.86989574339444, -69.05512187892815, -163.70539097256014, -460.0665466696127, -17.551112672298373, -99.31027558385092, -143.16801154644588, -49.28768099249142, -131.31707780160815, -216.28061493233284, -245.38501365192124, -157.07031033200852, -118.49054985161949, -284.70266001567404, -107.7517668730045, -61.2920389546242, -164.15022900079046, -250.9437113352356, -510.35303846690806, -133.6336575572001, -83.67830733983328, -333.4715009062522, -204.78260097850298, -237.4816701259381, -73.1393699793617, -92.22082262915232, -63.479452193384, -320.33331256001054, -360.80939591497395, -94.66339568515447, -150.5063994990714, -83.33984078963636, -23.06931408876926, -53.72237730589175, -85.99155153818947, -643.9754702427521, -172.10097206926528, -192.88518516414914, -9.804435855785215, -293.1784626387881, -205.1221377844218, -874.0682724608532, -260.16099567425505, -136.59206006790401, -252.61603259327862, -156.28276829650576, -1101.4989691069163, -92.5295982595415, -85.39592748987322, -97.00460000307581, -33.91289547308634, -76.6445205655555, -129.2353452633577, -905.9396709840412, -63.741739003641214, -127.58615543072294, -443.4399077589958, -603.5791383946455, -47.41089374394348, -139.4548258009273, -425.08960736350343, -314.200097615507, -60.15829828445864, -247.17615090720633, -39.41013882320461, -276.30246111398964, -175.49476207678939, -13.090371533630464, -102.37908855818, -22.365089064100406, -934.8441632664455, -53.746893833540256, -108.14961955207514, -126.50836202529094, -80.52148148321275, -143.69095034937482, -149.75047240023517, -59.7527938001445, -165.45992679520572], "episode_lengths": [48, 76, 88, 60, 49, 58, 47, 40, 56, 86, 55, 64, 83, 150, 47, 75, 118, 123, 100, 114, 48, 60, 64, 76, 150, 47, 56, 81, 65, 78, 100, 103, 86, 76, 111, 63, 57, 74, 118, 150, 96, 58, 125, 110, 96, 55, 66, 58, 130, 104, 68, 85, 64, 39, 51, 61, 150, 65, 94, 45, 112, 96, 150, 106, 83, 104, 60, 150, 67, 55, 62, 51, 57, 76, 150, 50, 80, 146, 150, 58, 90, 150, 115, 60, 111, 45, 101, 87, 40, 67, 42, 150, 56, 72, 59, 62, 88, 79, 59, 85], "policy_policy_0_reward": [-83.1330500313568, -145.19409126414973, -165.6121286038428, -76.89184432276159, -12.962983215068514, -61.12848464561845, -35.54250727851413, -36.22008116622815, -45.007291662346816, -163.33754031981766, -55.351209937060375, -73.45829845802504, -183.55428489517118, -406.8338651821205, -35.028399574620195, -173.97466498463595, -268.27143678178794, -429.10875828050985, -228.71785352171386, -287.3106050687733, -63.28045846996332, -94.86989574339444, -69.05512187892815, -163.70539097256014, -460.0665466696127, -17.551112672298373, -99.31027558385092, -143.16801154644588, -49.28768099249142, -131.31707780160815, -216.28061493233284, -245.38501365192124, -157.07031033200852, -118.49054985161949, -284.70266001567404, -107.7517668730045, -61.2920389546242, -164.15022900079046, -250.9437113352356, -510.35303846690806, -133.6336575572001, -83.67830733983328, -333.4715009062522, -204.78260097850298, -237.4816701259381, -73.1393699793617, -92.22082262915232, -63.479452193384, -320.33331256001054, -360.80939591497395, -94.66339568515447, -150.5063994990714, -83.33984078963636, -23.06931408876926, -53.72237730589175, -85.99155153818947, -643.9754702427521, -172.10097206926528, -192.88518516414914, -9.804435855785215, -293.1784626387881, -205.1221377844218, -874.0682724608532, -260.16099567425505, -136.59206006790401, -252.61603259327862, -156.28276829650576, -1101.4989691069163, -92.5295982595415, -85.39592748987322, -97.00460000307581, -33.91289547308634, -76.6445205655555, -129.2353452633577, -905.9396709840412, -63.741739003641214, -127.58615543072294, -443.4399077589958, -603.5791383946455, -47.41089374394348, -139.4548258009273, -425.08960736350343, -314.200097615507, -60.15829828445864, -247.17615090720633, -39.41013882320461, -276.30246111398964, -175.49476207678939, -13.090371533630464, -102.37908855818, -22.365089064100406, -934.8441632664455, -53.746893833540256, -108.14961955207514, -126.50836202529094, -80.52148148321275, -143.69095034937482, -149.75047240023517, -59.7527938001445, -165.45992679520572]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5618852240800526, "mean_inference_ms": 1.7042914803104166, "mean_action_processing_ms": 0.27490219395200105, "mean_env_wait_ms": 3.3914858026746653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012120246887207031, "StateBufferConnector_ms": 0.007915973663330078, "ViewRequirementAgentConnector_ms": 0.20775747299194336}, "num_episodes": 46, "episode_return_max": -9.804435855785215, "episode_return_min": -1101.4989691069163, "episode_return_mean": -194.11245563003092, "episodes_this_iter": 46}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.59414945603083, "num_env_steps_trained_throughput_per_sec": 315.59414945603083, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 316000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 316000, "timers": {"training_iteration_time_ms": 11789.718, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11789.645, "sample_time_ms": 1103.904, "learn_time_ms": 10622.547, "learn_throughput": 376.558, "synch_weights_time_ms": 62.418}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "done": false, "training_iteration": 79, "trial_id": "b33d0_00000", "date": "2024-08-06_14-56-35", "timestamp": 1722936395, "time_this_iter_s": 12.689138174057007, "time_total_s": 957.7446160316467, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2a9fc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 957.7446160316467, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 17.544444444444444, "ram_util_percent": 29.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 99.31145566304525, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 2.2406782931337754, "policy_loss": -0.018250471031448494, "vf_loss": 2.2425288246323665, "vf_explained_var": 0.9909538043662905, "kl": 0.016932154129779064, "entropy": 0.7438689880693953, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 76320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": -5.072331225067259, "episode_reward_min": -1283.7112419796852, "episode_reward_mean": -220.87696743638844, "episode_len_mean": 86.21, "episode_media": {}, "episodes_timesteps_total": 8621, "policy_reward_min": {"policy_0": -1283.7112419796852}, "policy_reward_max": {"policy_0": -5.072331225067259}, "policy_reward_mean": {"policy_0": -220.87696743638844}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-73.1393699793617, -92.22082262915232, -63.479452193384, -320.33331256001054, -360.80939591497395, -94.66339568515447, -150.5063994990714, -83.33984078963636, -23.06931408876926, -53.72237730589175, -85.99155153818947, -643.9754702427521, -172.10097206926528, -192.88518516414914, -9.804435855785215, -293.1784626387881, -205.1221377844218, -874.0682724608532, -260.16099567425505, -136.59206006790401, -252.61603259327862, -156.28276829650576, -1101.4989691069163, -92.5295982595415, -85.39592748987322, -97.00460000307581, -33.91289547308634, -76.6445205655555, -129.2353452633577, -905.9396709840412, -63.741739003641214, -127.58615543072294, -443.4399077589958, -603.5791383946455, -47.41089374394348, -139.4548258009273, -425.08960736350343, -314.200097615507, -60.15829828445864, -247.17615090720633, -39.41013882320461, -276.30246111398964, -175.49476207678939, -13.090371533630464, -102.37908855818, -22.365089064100406, -934.8441632664455, -53.746893833540256, -108.14961955207514, -126.50836202529094, -80.52148148321275, -143.69095034937482, -149.75047240023517, -59.7527938001445, -165.45992679520572, -229.17891657952734, -446.7428496880885, -89.81313455897735, -64.79386501376636, -58.240142735694164, -35.40416849134201, -152.89230743368344, -182.45637049084073, -134.13993189591378, -99.50464173662395, -95.92483377669849, -268.30013212550745, -285.14272156955803, -27.424383620478427, -225.4630723946642, -235.93109918519514, -327.4386033123123, -86.42202363319961, -190.54038687954878, -319.57456318062356, -142.0983736623203, -81.93091049491157, -175.8976253300781, -670.0619972058287, -11.04683342336021, -347.0933518631612, -315.7532886374849, -137.04865439011985, -48.09482114488925, -133.55728310581318, -11.03862655851594, -5.072331225067259, -1283.7112419796852, -245.90481597092926, -287.91743976171506, -80.21515509571589, -390.87180832005936, -76.88735078813384, -129.27174598171388, -318.0969363413888, -949.8920843014936, -414.1575203077467, -99.26716001022515, -124.29564964125134, -9.658648639017066], "episode_lengths": [55, 66, 58, 130, 104, 68, 85, 64, 39, 51, 61, 150, 65, 94, 45, 112, 96, 150, 106, 83, 104, 60, 150, 67, 55, 62, 51, 57, 76, 150, 50, 80, 146, 150, 58, 90, 150, 115, 60, 111, 45, 101, 87, 40, 67, 42, 150, 56, 72, 59, 62, 88, 79, 59, 85, 94, 146, 66, 58, 57, 40, 84, 94, 79, 66, 83, 126, 126, 52, 108, 102, 117, 63, 74, 121, 77, 62, 89, 150, 36, 120, 140, 69, 42, 81, 39, 33, 150, 150, 98, 60, 129, 66, 74, 108, 150, 150, 67, 73, 36], "policy_policy_0_reward": [-73.1393699793617, -92.22082262915232, -63.479452193384, -320.33331256001054, -360.80939591497395, -94.66339568515447, -150.5063994990714, -83.33984078963636, -23.06931408876926, -53.72237730589175, -85.99155153818947, -643.9754702427521, -172.10097206926528, -192.88518516414914, -9.804435855785215, -293.1784626387881, -205.1221377844218, -874.0682724608532, -260.16099567425505, -136.59206006790401, -252.61603259327862, -156.28276829650576, -1101.4989691069163, -92.5295982595415, -85.39592748987322, -97.00460000307581, -33.91289547308634, -76.6445205655555, -129.2353452633577, -905.9396709840412, -63.741739003641214, -127.58615543072294, -443.4399077589958, -603.5791383946455, -47.41089374394348, -139.4548258009273, -425.08960736350343, -314.200097615507, -60.15829828445864, -247.17615090720633, -39.41013882320461, -276.30246111398964, -175.49476207678939, -13.090371533630464, -102.37908855818, -22.365089064100406, -934.8441632664455, -53.746893833540256, -108.14961955207514, -126.50836202529094, -80.52148148321275, -143.69095034937482, -149.75047240023517, -59.7527938001445, -165.45992679520572, -229.17891657952734, -446.7428496880885, -89.81313455897735, -64.79386501376636, -58.240142735694164, -35.40416849134201, -152.89230743368344, -182.45637049084073, -134.13993189591378, -99.50464173662395, -95.92483377669849, -268.30013212550745, -285.14272156955803, -27.424383620478427, -225.4630723946642, -235.93109918519514, -327.4386033123123, -86.42202363319961, -190.54038687954878, -319.57456318062356, -142.0983736623203, -81.93091049491157, -175.8976253300781, -670.0619972058287, -11.04683342336021, -347.0933518631612, -315.7532886374849, -137.04865439011985, -48.09482114488925, -133.55728310581318, -11.03862655851594, -5.072331225067259, -1283.7112419796852, -245.90481597092926, -287.91743976171506, -80.21515509571589, -390.87180832005936, -76.88735078813384, -129.27174598171388, -318.0969363413888, -949.8920843014936, -414.1575203077467, -99.26716001022515, -124.29564964125134, -9.658648639017066]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5624024422565862, "mean_inference_ms": 1.7044857916155072, "mean_action_processing_ms": 0.2750666557005811, "mean_env_wait_ms": 3.3896865904774973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011957883834838867, "StateBufferConnector_ms": 0.00797271728515625, "ViewRequirementAgentConnector_ms": 0.2053990364074707}, "num_episodes": 45, "episode_return_max": -5.072331225067259, "episode_return_min": -1283.7112419796852, "episode_return_mean": -220.87696743638844, "episodes_this_iter": 45}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 374.57583354999304, "num_env_steps_trained_throughput_per_sec": 374.57583354999304, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 11742.604, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11742.533, "sample_time_ms": 1103.939, "learn_time_ms": 10577.733, "learn_throughput": 378.153, "synch_weights_time_ms": 60.096}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 80, "trial_id": "b33d0_00000", "date": "2024-08-06_14-56-46", "timestamp": 1722936406, "time_this_iter_s": 10.690929174423218, "time_total_s": 968.43554520607, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c169750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 968.43554520607, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 18.59375, "ram_util_percent": 29.31875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 120.65431023736795, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 2.213349724126359, "policy_loss": -0.016917089272465092, "vf_loss": 2.2185509454458954, "vf_explained_var": 0.988682144259413, "kl": 0.012579745352225776, "entropy": 1.0211218178272248, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 77280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "env_runners": {"episode_reward_max": -5.072331225067259, "episode_reward_min": -1365.8712583308684, "episode_reward_mean": -216.46278257331574, "episode_len_mean": 85.21, "episode_media": {}, "episodes_timesteps_total": 8521, "policy_reward_min": {"policy_0": -1365.8712583308684}, "policy_reward_max": {"policy_0": -5.072331225067259}, "policy_reward_mean": {"policy_0": -216.46278257331574}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-53.746893833540256, -108.14961955207514, -126.50836202529094, -80.52148148321275, -143.69095034937482, -149.75047240023517, -59.7527938001445, -165.45992679520572, -229.17891657952734, -446.7428496880885, -89.81313455897735, -64.79386501376636, -58.240142735694164, -35.40416849134201, -152.89230743368344, -182.45637049084073, -134.13993189591378, -99.50464173662395, -95.92483377669849, -268.30013212550745, -285.14272156955803, -27.424383620478427, -225.4630723946642, -235.93109918519514, -327.4386033123123, -86.42202363319961, -190.54038687954878, -319.57456318062356, -142.0983736623203, -81.93091049491157, -175.8976253300781, -670.0619972058287, -11.04683342336021, -347.0933518631612, -315.7532886374849, -137.04865439011985, -48.09482114488925, -133.55728310581318, -11.03862655851594, -5.072331225067259, -1283.7112419796852, -245.90481597092926, -287.91743976171506, -80.21515509571589, -390.87180832005936, -76.88735078813384, -129.27174598171388, -318.0969363413888, -949.8920843014936, -414.1575203077467, -99.26716001022515, -124.29564964125134, -9.658648639017066, -396.91778323542616, -153.59368508552683, -48.70871628512264, -114.6182948352896, -187.64877132388375, -70.41943854445232, -32.75263117300159, -13.978048815577381, -52.24068963979455, -94.47252424851482, -54.30393901133348, -139.31368769828882, -169.08602480710317, -27.331145262953708, -17.61019520762095, -198.34019720377447, -130.92488798828046, -399.9552229188516, -273.7507255280883, -32.08023663511981, -179.3308991399169, -941.4628144064601, -1105.682040771081, -181.74341645039758, -99.46458751773392, -1365.8712583308684, -141.46788776117225, -86.91813423346974, -82.51507798288982, -119.88015165377813, -200.20838664332646, -85.11591012701318, -467.95581214087537, -132.50996989334377, -8.081054052458477, -527.8075528959607, -205.52581312119105, -97.07199894731893, -99.57023700555276, -188.34085414145034, -93.66325025984393, -155.32456192949448, -214.37623473597145, -154.11357989298347, -923.7185254623199, -101.39236416986411, -147.36873549489005], "episode_lengths": [56, 72, 59, 62, 88, 79, 59, 85, 94, 146, 66, 58, 57, 40, 84, 94, 79, 66, 83, 126, 126, 52, 108, 102, 117, 63, 74, 121, 77, 62, 89, 150, 36, 120, 140, 69, 42, 81, 39, 33, 150, 150, 98, 60, 129, 66, 74, 108, 150, 150, 67, 73, 36, 141, 73, 52, 71, 89, 64, 54, 39, 56, 60, 56, 72, 90, 40, 51, 80, 74, 150, 103, 55, 97, 150, 150, 90, 71, 150, 79, 60, 70, 80, 103, 62, 150, 54, 34, 150, 98, 69, 72, 85, 63, 87, 89, 78, 150, 66, 79], "policy_policy_0_reward": [-53.746893833540256, -108.14961955207514, -126.50836202529094, -80.52148148321275, -143.69095034937482, -149.75047240023517, -59.7527938001445, -165.45992679520572, -229.17891657952734, -446.7428496880885, -89.81313455897735, -64.79386501376636, -58.240142735694164, -35.40416849134201, -152.89230743368344, -182.45637049084073, -134.13993189591378, -99.50464173662395, -95.92483377669849, -268.30013212550745, -285.14272156955803, -27.424383620478427, -225.4630723946642, -235.93109918519514, -327.4386033123123, -86.42202363319961, -190.54038687954878, -319.57456318062356, -142.0983736623203, -81.93091049491157, -175.8976253300781, -670.0619972058287, -11.04683342336021, -347.0933518631612, -315.7532886374849, -137.04865439011985, -48.09482114488925, -133.55728310581318, -11.03862655851594, -5.072331225067259, -1283.7112419796852, -245.90481597092926, -287.91743976171506, -80.21515509571589, -390.87180832005936, -76.88735078813384, -129.27174598171388, -318.0969363413888, -949.8920843014936, -414.1575203077467, -99.26716001022515, -124.29564964125134, -9.658648639017066, -396.91778323542616, -153.59368508552683, -48.70871628512264, -114.6182948352896, -187.64877132388375, -70.41943854445232, -32.75263117300159, -13.978048815577381, -52.24068963979455, -94.47252424851482, -54.30393901133348, -139.31368769828882, -169.08602480710317, -27.331145262953708, -17.61019520762095, -198.34019720377447, -130.92488798828046, -399.9552229188516, -273.7507255280883, -32.08023663511981, -179.3308991399169, -941.4628144064601, -1105.682040771081, -181.74341645039758, -99.46458751773392, -1365.8712583308684, -141.46788776117225, -86.91813423346974, -82.51507798288982, -119.88015165377813, -200.20838664332646, -85.11591012701318, -467.95581214087537, -132.50996989334377, -8.081054052458477, -527.8075528959607, -205.52581312119105, -97.07199894731893, -99.57023700555276, -188.34085414145034, -93.66325025984393, -155.32456192949448, -214.37623473597145, -154.11357989298347, -923.7185254623199, -101.39236416986411, -147.36873549489005]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5621121506058729, "mean_inference_ms": 1.7034735071347618, "mean_action_processing_ms": 0.2746457356133718, "mean_env_wait_ms": 3.3880082006416763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012095928192138672, "StateBufferConnector_ms": 0.008182048797607422, "ViewRequirementAgentConnector_ms": 0.1957693099975586}, "num_episodes": 47, "episode_return_max": -5.072331225067259, "episode_return_min": -1365.8712583308684, "episode_return_mean": -216.46278257331574, "episodes_this_iter": 47}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.9444878844321, "num_env_steps_trained_throughput_per_sec": 310.9444878844321, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 324000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 11791.59, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11791.52, "sample_time_ms": 1102.084, "learn_time_ms": 10628.268, "learn_throughput": 376.355, "synch_weights_time_ms": 60.397}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "training_iteration": 81, "trial_id": "b33d0_00000", "date": "2024-08-06_14-56-59", "timestamp": 1722936419, "time_this_iter_s": 12.87723708152771, "time_total_s": 981.3127822875977, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c1685e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 981.3127822875977, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 17.383333333333336, "ram_util_percent": 29.299999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 106.41562028328578, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 2.103010361455381, "policy_loss": -0.009305259125540033, "vf_loss": 2.1037101985886695, "vf_explained_var": 0.9761074314514796, "kl": 0.009495717857316888, "entropy": 1.0089932079737385, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 78240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "env_runners": {"episode_reward_max": -8.081054052458477, "episode_reward_min": -1457.0839511848085, "episode_reward_mean": -248.1853859552927, "episode_len_mean": 86.42, "episode_media": {}, "episodes_timesteps_total": 8642, "policy_reward_min": {"policy_0": -1457.0839511848085}, "policy_reward_max": {"policy_0": -8.081054052458477}, "policy_reward_mean": {"policy_0": -248.1853859552927}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-129.27174598171388, -318.0969363413888, -949.8920843014936, -414.1575203077467, -99.26716001022515, -124.29564964125134, -9.658648639017066, -396.91778323542616, -153.59368508552683, -48.70871628512264, -114.6182948352896, -187.64877132388375, -70.41943854445232, -32.75263117300159, -13.978048815577381, -52.24068963979455, -94.47252424851482, -54.30393901133348, -139.31368769828882, -169.08602480710317, -27.331145262953708, -17.61019520762095, -198.34019720377447, -130.92488798828046, -399.9552229188516, -273.7507255280883, -32.08023663511981, -179.3308991399169, -941.4628144064601, -1105.682040771081, -181.74341645039758, -99.46458751773392, -1365.8712583308684, -141.46788776117225, -86.91813423346974, -82.51507798288982, -119.88015165377813, -200.20838664332646, -85.11591012701318, -467.95581214087537, -132.50996989334377, -8.081054052458477, -527.8075528959607, -205.52581312119105, -97.07199894731893, -99.57023700555276, -188.34085414145034, -93.66325025984393, -155.32456192949448, -214.37623473597145, -154.11357989298347, -923.7185254623199, -101.39236416986411, -147.36873549489005, -58.57393118033492, -91.27258959400788, -87.98497585396782, -239.27662668356146, -38.21787281250735, -461.4945857936463, -74.90169909667492, -1457.0839511848085, -76.83413376308907, -141.74478666832852, -518.1941112598465, -146.22529272644022, -47.422832522866926, -71.35878291028008, -531.4074000219766, -77.23526084612622, -61.24200088036093, -136.83400662957263, -141.74935587583118, -144.876216723523, -387.2796711716729, -64.36528170802397, -67.4651800116812, -38.8066080839357, -37.4158352099149, -70.58608601591244, -66.03129130875222, -188.05601488474815, -1212.7380142714544, -63.88772875285416, -829.3580272559218, -76.62965227389269, -179.84088696873647, -188.47565983823665, -51.26006426607568, -993.6424642641915, -83.27220896485515, -358.37518452484426, -235.9010871321433, -1100.9781770175678, -192.94841961509275, -334.17137407429675, -110.45805988421442, -163.90740028362652, -65.95467214090364, -293.6354327455028], "episode_lengths": [74, 108, 150, 150, 67, 73, 36, 141, 73, 52, 71, 89, 64, 54, 39, 56, 60, 56, 72, 90, 40, 51, 80, 74, 150, 103, 55, 97, 150, 150, 90, 71, 150, 79, 60, 70, 80, 103, 62, 150, 54, 34, 150, 98, 69, 72, 85, 63, 87, 89, 78, 150, 66, 79, 59, 65, 72, 102, 54, 149, 56, 150, 60, 83, 139, 81, 60, 76, 150, 71, 61, 83, 79, 56, 138, 63, 60, 40, 37, 61, 69, 81, 150, 59, 134, 55, 84, 95, 49, 150, 61, 136, 104, 150, 92, 117, 68, 85, 64, 120], "policy_policy_0_reward": [-129.27174598171388, -318.0969363413888, -949.8920843014936, -414.1575203077467, -99.26716001022515, -124.29564964125134, -9.658648639017066, -396.91778323542616, -153.59368508552683, -48.70871628512264, -114.6182948352896, -187.64877132388375, -70.41943854445232, -32.75263117300159, -13.978048815577381, -52.24068963979455, -94.47252424851482, -54.30393901133348, -139.31368769828882, -169.08602480710317, -27.331145262953708, -17.61019520762095, -198.34019720377447, -130.92488798828046, -399.9552229188516, -273.7507255280883, -32.08023663511981, -179.3308991399169, -941.4628144064601, -1105.682040771081, -181.74341645039758, -99.46458751773392, -1365.8712583308684, -141.46788776117225, -86.91813423346974, -82.51507798288982, -119.88015165377813, -200.20838664332646, -85.11591012701318, -467.95581214087537, -132.50996989334377, -8.081054052458477, -527.8075528959607, -205.52581312119105, -97.07199894731893, -99.57023700555276, -188.34085414145034, -93.66325025984393, -155.32456192949448, -214.37623473597145, -154.11357989298347, -923.7185254623199, -101.39236416986411, -147.36873549489005, -58.57393118033492, -91.27258959400788, -87.98497585396782, -239.27662668356146, -38.21787281250735, -461.4945857936463, -74.90169909667492, -1457.0839511848085, -76.83413376308907, -141.74478666832852, -518.1941112598465, -146.22529272644022, -47.422832522866926, -71.35878291028008, -531.4074000219766, -77.23526084612622, -61.24200088036093, -136.83400662957263, -141.74935587583118, -144.876216723523, -387.2796711716729, -64.36528170802397, -67.4651800116812, -38.8066080839357, -37.4158352099149, -70.58608601591244, -66.03129130875222, -188.05601488474815, -1212.7380142714544, -63.88772875285416, -829.3580272559218, -76.62965227389269, -179.84088696873647, -188.47565983823665, -51.26006426607568, -993.6424642641915, -83.27220896485515, -358.37518452484426, -235.9010871321433, -1100.9781770175678, -192.94841961509275, -334.17137407429675, -110.45805988421442, -163.90740028362652, -65.95467214090364, -293.6354327455028]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5618189221786036, "mean_inference_ms": 1.7028122459805872, "mean_action_processing_ms": 0.2747683715568372, "mean_env_wait_ms": 3.3886131221901468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01196146011352539, "StateBufferConnector_ms": 0.008035421371459961, "ViewRequirementAgentConnector_ms": 0.1927034854888916}, "num_episodes": 46, "episode_return_max": -8.081054052458477, "episode_return_min": -1457.0839511848085, "episode_return_mean": -248.1853859552927, "episodes_this_iter": 46}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.23118501272734, "num_env_steps_trained_throughput_per_sec": 306.23118501272734, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 328000, "timers": {"training_iteration_time_ms": 11813.555, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11813.481, "sample_time_ms": 1107.157, "learn_time_ms": 10644.312, "learn_throughput": 375.788, "synch_weights_time_ms": 61.24}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "done": false, "training_iteration": 82, "trial_id": "b33d0_00000", "date": "2024-08-06_14-57-12", "timestamp": 1722936432, "time_this_iter_s": 13.074158668518066, "time_total_s": 994.3869409561157, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c1240d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 994.3869409561157, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 17.352631578947367, "ram_util_percent": 29.342105263157894}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 112.44633270800114, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 2.3954140005633233, "policy_loss": -0.023160044824665722, "vf_loss": 2.4059606519838175, "vf_explained_var": 0.9903338783110182, "kl": 0.013411247573640208, "entropy": 0.96549352320532, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 79200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "env_runners": {"episode_reward_max": -4.600827647340896, "episode_reward_min": -1457.0839511848085, "episode_reward_mean": -255.10093128601224, "episode_len_mean": 89.13, "episode_media": {}, "episodes_timesteps_total": 8913, "policy_reward_min": {"policy_0": -1457.0839511848085}, "policy_reward_max": {"policy_0": -4.600827647340896}, "policy_reward_mean": {"policy_0": -255.10093128601224}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-527.8075528959607, -205.52581312119105, -97.07199894731893, -99.57023700555276, -188.34085414145034, -93.66325025984393, -155.32456192949448, -214.37623473597145, -154.11357989298347, -923.7185254623199, -101.39236416986411, -147.36873549489005, -58.57393118033492, -91.27258959400788, -87.98497585396782, -239.27662668356146, -38.21787281250735, -461.4945857936463, -74.90169909667492, -1457.0839511848085, -76.83413376308907, -141.74478666832852, -518.1941112598465, -146.22529272644022, -47.422832522866926, -71.35878291028008, -531.4074000219766, -77.23526084612622, -61.24200088036093, -136.83400662957263, -141.74935587583118, -144.876216723523, -387.2796711716729, -64.36528170802397, -67.4651800116812, -38.8066080839357, -37.4158352099149, -70.58608601591244, -66.03129130875222, -188.05601488474815, -1212.7380142714544, -63.88772875285416, -829.3580272559218, -76.62965227389269, -179.84088696873647, -188.47565983823665, -51.26006426607568, -993.6424642641915, -83.27220896485515, -358.37518452484426, -235.9010871321433, -1100.9781770175678, -192.94841961509275, -334.17137407429675, -110.45805988421442, -163.90740028362652, -65.95467214090364, -293.6354327455028, -98.71237199509751, -55.06925200509066, -25.29068181265715, -64.79539891434241, -152.0165413978772, -975.1996372105245, -1299.8736280320213, -129.47252716984963, -149.99531313706387, -438.60698683736484, -191.08432489712303, -246.42219064663482, -76.55338926848596, -88.3984957219442, -460.9332471589856, -206.55360462755604, -81.45761368126556, -119.9838115926211, -91.09797937321746, -169.35545000338894, -155.82193390369306, -83.43352657709649, -75.87673376520904, -221.1938928631537, -519.9409148390187, -136.409398457728, -54.76033743969569, -145.58721262637707, -4.600827647340896, -71.83430736511238, -608.1486342192884, -8.44151223065739, -213.62301949656865, -142.98992750599916, -180.02619550446073, -99.30003724328067, -1273.2007428790364, -274.5425530619215, -59.514231558860324, -355.54291405925403, -562.3927580012771, -174.39446811943617], "episode_lengths": [150, 98, 69, 72, 85, 63, 87, 89, 78, 150, 66, 79, 59, 65, 72, 102, 54, 149, 56, 150, 60, 83, 139, 81, 60, 76, 150, 71, 61, 83, 79, 56, 138, 63, 60, 40, 37, 61, 69, 81, 150, 59, 134, 55, 84, 95, 49, 150, 61, 136, 104, 150, 92, 117, 68, 85, 64, 120, 64, 54, 60, 50, 91, 150, 150, 81, 86, 150, 139, 97, 70, 68, 150, 99, 75, 72, 68, 86, 88, 60, 57, 73, 150, 77, 54, 78, 41, 49, 150, 39, 93, 83, 78, 71, 150, 107, 56, 150, 150, 85], "policy_policy_0_reward": [-527.8075528959607, -205.52581312119105, -97.07199894731893, -99.57023700555276, -188.34085414145034, -93.66325025984393, -155.32456192949448, -214.37623473597145, -154.11357989298347, -923.7185254623199, -101.39236416986411, -147.36873549489005, -58.57393118033492, -91.27258959400788, -87.98497585396782, -239.27662668356146, -38.21787281250735, -461.4945857936463, -74.90169909667492, -1457.0839511848085, -76.83413376308907, -141.74478666832852, -518.1941112598465, -146.22529272644022, -47.422832522866926, -71.35878291028008, -531.4074000219766, -77.23526084612622, -61.24200088036093, -136.83400662957263, -141.74935587583118, -144.876216723523, -387.2796711716729, -64.36528170802397, -67.4651800116812, -38.8066080839357, -37.4158352099149, -70.58608601591244, -66.03129130875222, -188.05601488474815, -1212.7380142714544, -63.88772875285416, -829.3580272559218, -76.62965227389269, -179.84088696873647, -188.47565983823665, -51.26006426607568, -993.6424642641915, -83.27220896485515, -358.37518452484426, -235.9010871321433, -1100.9781770175678, -192.94841961509275, -334.17137407429675, -110.45805988421442, -163.90740028362652, -65.95467214090364, -293.6354327455028, -98.71237199509751, -55.06925200509066, -25.29068181265715, -64.79539891434241, -152.0165413978772, -975.1996372105245, -1299.8736280320213, -129.47252716984963, -149.99531313706387, -438.60698683736484, -191.08432489712303, -246.42219064663482, -76.55338926848596, -88.3984957219442, -460.9332471589856, -206.55360462755604, -81.45761368126556, -119.9838115926211, -91.09797937321746, -169.35545000338894, -155.82193390369306, -83.43352657709649, -75.87673376520904, -221.1938928631537, -519.9409148390187, -136.409398457728, -54.76033743969569, -145.58721262637707, -4.600827647340896, -71.83430736511238, -608.1486342192884, -8.44151223065739, -213.62301949656865, -142.98992750599916, -180.02619550446073, -99.30003724328067, -1273.2007428790364, -274.5425530619215, -59.514231558860324, -355.54291405925403, -562.3927580012771, -174.39446811943617]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5621119829603429, "mean_inference_ms": 1.7031597790441264, "mean_action_processing_ms": 0.2752932042274309, "mean_env_wait_ms": 3.388642914228869, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012050628662109375, "StateBufferConnector_ms": 0.008055925369262695, "ViewRequirementAgentConnector_ms": 0.19120073318481445}, "num_episodes": 42, "episode_return_max": -4.600827647340896, "episode_return_min": -1457.0839511848085, "episode_return_mean": -255.10093128601224, "episodes_this_iter": 42}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.60497898899666, "num_env_steps_trained_throughput_per_sec": 318.60497898899666, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 332000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 332000, "timers": {"training_iteration_time_ms": 12038.616, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12038.542, "sample_time_ms": 1107.202, "learn_time_ms": 10869.283, "learn_throughput": 368.01, "synch_weights_time_ms": 61.287}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "done": false, "training_iteration": 83, "trial_id": "b33d0_00000", "date": "2024-08-06_14-57-25", "timestamp": 1722936445, "time_this_iter_s": 12.566319942474365, "time_total_s": 1006.9532608985901, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2a8dc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1006.9532608985901, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 17.91764705882353, "ram_util_percent": 29.39411764705882}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 93.88888600667318, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 2.274420605196307, "policy_loss": -0.013165523783148577, "vf_loss": 2.2750286743044854, "vf_explained_var": 0.9802661756053567, "kl": 0.013075096415983959, "entropy": 0.6810891463421285, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 80160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": -4.600827647340896, "episode_reward_min": -1459.7731698355374, "episode_reward_mean": -252.12066604948583, "episode_len_mean": 90.35, "episode_media": {}, "episodes_timesteps_total": 9035, "policy_reward_min": {"policy_0": -1459.7731698355374}, "policy_reward_max": {"policy_0": -4.600827647340896}, "policy_reward_mean": {"policy_0": -252.12066604948583}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-993.6424642641915, -83.27220896485515, -358.37518452484426, -235.9010871321433, -1100.9781770175678, -192.94841961509275, -334.17137407429675, -110.45805988421442, -163.90740028362652, -65.95467214090364, -293.6354327455028, -98.71237199509751, -55.06925200509066, -25.29068181265715, -64.79539891434241, -152.0165413978772, -975.1996372105245, -1299.8736280320213, -129.47252716984963, -149.99531313706387, -438.60698683736484, -191.08432489712303, -246.42219064663482, -76.55338926848596, -88.3984957219442, -460.9332471589856, -206.55360462755604, -81.45761368126556, -119.9838115926211, -91.09797937321746, -169.35545000338894, -155.82193390369306, -83.43352657709649, -75.87673376520904, -221.1938928631537, -519.9409148390187, -136.409398457728, -54.76033743969569, -145.58721262637707, -4.600827647340896, -71.83430736511238, -608.1486342192884, -8.44151223065739, -213.62301949656865, -142.98992750599916, -180.02619550446073, -99.30003724328067, -1273.2007428790364, -274.5425530619215, -59.514231558860324, -355.54291405925403, -562.3927580012771, -174.39446811943617, -79.41032061510572, -155.5860946598501, -6.880116168824375, -171.91280393346295, -169.19504483321293, -537.9508707919875, -1039.9430025658098, -281.6554050070078, -106.98644094396695, -114.52115771926493, -34.561429932530224, -21.871301944087673, -51.220755262910174, -71.63801509268468, -525.2885575472102, -119.78955191023293, -112.95695261713705, -205.22942895653443, -87.12802538363478, -22.695941607892557, -175.48504409377136, -53.86997294743318, -153.19758897827086, -996.8137051089866, -185.68503901229852, -263.7405476579227, -78.65105424235719, -1459.7731698355374, -158.03307226671737, -62.77089562253341, -169.33529859023895, -278.49711102753673, -122.71214153150926, -178.6344482315962, -171.73377713183672, -37.670085887691606, -134.39957786631243, -99.00375800921792, -323.9048840933478, -273.5031788258465, -119.15837493403043, -129.75087917294854, -202.88792547079072, -188.30764846453536, -32.31149348426145, -203.20294235689346, -566.9187671159996], "episode_lengths": [150, 61, 136, 104, 150, 92, 117, 68, 85, 64, 120, 64, 54, 60, 50, 91, 150, 150, 81, 86, 150, 139, 97, 70, 68, 150, 99, 75, 72, 68, 86, 88, 60, 57, 73, 150, 77, 54, 78, 41, 49, 150, 39, 93, 83, 78, 71, 150, 107, 56, 150, 150, 85, 45, 81, 42, 92, 85, 150, 150, 150, 67, 74, 39, 38, 42, 62, 150, 76, 66, 92, 65, 38, 80, 54, 89, 150, 82, 98, 71, 150, 79, 39, 85, 109, 80, 84, 88, 43, 89, 72, 150, 129, 80, 90, 99, 102, 53, 90, 150], "policy_policy_0_reward": [-993.6424642641915, -83.27220896485515, -358.37518452484426, -235.9010871321433, -1100.9781770175678, -192.94841961509275, -334.17137407429675, -110.45805988421442, -163.90740028362652, -65.95467214090364, -293.6354327455028, -98.71237199509751, -55.06925200509066, -25.29068181265715, -64.79539891434241, -152.0165413978772, -975.1996372105245, -1299.8736280320213, -129.47252716984963, -149.99531313706387, -438.60698683736484, -191.08432489712303, -246.42219064663482, -76.55338926848596, -88.3984957219442, -460.9332471589856, -206.55360462755604, -81.45761368126556, -119.9838115926211, -91.09797937321746, -169.35545000338894, -155.82193390369306, -83.43352657709649, -75.87673376520904, -221.1938928631537, -519.9409148390187, -136.409398457728, -54.76033743969569, -145.58721262637707, -4.600827647340896, -71.83430736511238, -608.1486342192884, -8.44151223065739, -213.62301949656865, -142.98992750599916, -180.02619550446073, -99.30003724328067, -1273.2007428790364, -274.5425530619215, -59.514231558860324, -355.54291405925403, -562.3927580012771, -174.39446811943617, -79.41032061510572, -155.5860946598501, -6.880116168824375, -171.91280393346295, -169.19504483321293, -537.9508707919875, -1039.9430025658098, -281.6554050070078, -106.98644094396695, -114.52115771926493, -34.561429932530224, -21.871301944087673, -51.220755262910174, -71.63801509268468, -525.2885575472102, -119.78955191023293, -112.95695261713705, -205.22942895653443, -87.12802538363478, -22.695941607892557, -175.48504409377136, -53.86997294743318, -153.19758897827086, -996.8137051089866, -185.68503901229852, -263.7405476579227, -78.65105424235719, -1459.7731698355374, -158.03307226671737, -62.77089562253341, -169.33529859023895, -278.49711102753673, -122.71214153150926, -178.6344482315962, -171.73377713183672, -37.670085887691606, -134.39957786631243, -99.00375800921792, -323.9048840933478, -273.5031788258465, -119.15837493403043, -129.75087917294854, -202.88792547079072, -188.30764846453536, -32.31149348426145, -203.20294235689346, -566.9187671159996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5624039043690927, "mean_inference_ms": 1.7015326009780114, "mean_action_processing_ms": 0.2752893334648006, "mean_env_wait_ms": 3.3873823462170596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012151241302490234, "StateBufferConnector_ms": 0.008136272430419922, "ViewRequirementAgentConnector_ms": 0.19389057159423828}, "num_episodes": 47, "episode_return_max": -4.600827647340896, "episode_return_min": -1459.7731698355374, "episode_return_mean": -252.12066604948583, "episodes_this_iter": 47}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.37470089139015, "num_env_steps_trained_throughput_per_sec": 317.37470089139015, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 12438.886, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12438.812, "sample_time_ms": 1104.39, "learn_time_ms": 11271.523, "learn_throughput": 354.877, "synch_weights_time_ms": 62.081}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 84, "trial_id": "b33d0_00000", "date": "2024-08-06_14-57-38", "timestamp": 1722936458, "time_this_iter_s": 12.615209817886353, "time_total_s": 1019.5684707164764, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c16a290>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1019.5684707164764, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 17.6, "ram_util_percent": 29.39444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 114.19880777994791, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 2.6400597306589284, "policy_loss": -0.017785313307346465, "vf_loss": 2.6452689353376626, "vf_explained_var": 0.9888519315049052, "kl": 0.013494054243877448, "entropy": 1.0866259613384803, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 81120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "env_runners": {"episode_reward_max": -4.600827647340896, "episode_reward_min": -1459.7731698355374, "episode_reward_mean": -252.49344370111677, "episode_len_mean": 90.03, "episode_media": {}, "episodes_timesteps_total": 9003, "policy_reward_min": {"policy_0": -1459.7731698355374}, "policy_reward_max": {"policy_0": -4.600827647340896}, "policy_reward_mean": {"policy_0": -252.49344370111677}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.600827647340896, -71.83430736511238, -608.1486342192884, -8.44151223065739, -213.62301949656865, -142.98992750599916, -180.02619550446073, -99.30003724328067, -1273.2007428790364, -274.5425530619215, -59.514231558860324, -355.54291405925403, -562.3927580012771, -174.39446811943617, -79.41032061510572, -155.5860946598501, -6.880116168824375, -171.91280393346295, -169.19504483321293, -537.9508707919875, -1039.9430025658098, -281.6554050070078, -106.98644094396695, -114.52115771926493, -34.561429932530224, -21.871301944087673, -51.220755262910174, -71.63801509268468, -525.2885575472102, -119.78955191023293, -112.95695261713705, -205.22942895653443, -87.12802538363478, -22.695941607892557, -175.48504409377136, -53.86997294743318, -153.19758897827086, -996.8137051089866, -185.68503901229852, -263.7405476579227, -78.65105424235719, -1459.7731698355374, -158.03307226671737, -62.77089562253341, -169.33529859023895, -278.49711102753673, -122.71214153150926, -178.6344482315962, -171.73377713183672, -37.670085887691606, -134.39957786631243, -99.00375800921792, -323.9048840933478, -273.5031788258465, -119.15837493403043, -129.75087917294854, -202.88792547079072, -188.30764846453536, -32.31149348426145, -203.20294235689346, -566.9187671159996, -178.5743391544262, -360.8045677544651, -155.6677137721351, -19.99268705894827, -52.86134172820459, -233.51784943279287, -226.59735044078818, -64.44421173795672, -110.13485935170314, -73.51474852467133, -42.48565450861131, -18.45647973014935, -19.497007761116357, -53.11991493254795, -134.2284804618182, -220.75873761682934, -524.2909498966047, -87.37211962515295, -138.31836385623143, -79.565496866171, -82.83405828881477, -27.972416388862527, -373.5217710585948, -162.93448718880651, -222.00948842078148, -333.03932530266513, -688.3294042671748, -107.90289219071917, -234.55534380211392, -1127.2607093948793, -146.48396647138782, -87.80336263522973, -107.84272705610199, -1104.1262766685288, -401.227253875949, -1022.7246294638549, -942.1700880280305, -344.8201659342735, -172.6574011173251], "episode_lengths": [41, 49, 150, 39, 93, 83, 78, 71, 150, 107, 56, 150, 150, 85, 45, 81, 42, 92, 85, 150, 150, 150, 67, 74, 39, 38, 42, 62, 150, 76, 66, 92, 65, 38, 80, 54, 89, 150, 82, 98, 71, 150, 79, 39, 85, 109, 80, 84, 88, 43, 89, 72, 150, 129, 80, 90, 99, 102, 53, 90, 150, 84, 119, 81, 40, 53, 112, 95, 60, 73, 60, 61, 36, 40, 56, 86, 73, 150, 66, 98, 59, 64, 47, 147, 84, 116, 150, 150, 72, 99, 150, 83, 63, 85, 150, 150, 150, 150, 115, 85], "policy_policy_0_reward": [-4.600827647340896, -71.83430736511238, -608.1486342192884, -8.44151223065739, -213.62301949656865, -142.98992750599916, -180.02619550446073, -99.30003724328067, -1273.2007428790364, -274.5425530619215, -59.514231558860324, -355.54291405925403, -562.3927580012771, -174.39446811943617, -79.41032061510572, -155.5860946598501, -6.880116168824375, -171.91280393346295, -169.19504483321293, -537.9508707919875, -1039.9430025658098, -281.6554050070078, -106.98644094396695, -114.52115771926493, -34.561429932530224, -21.871301944087673, -51.220755262910174, -71.63801509268468, -525.2885575472102, -119.78955191023293, -112.95695261713705, -205.22942895653443, -87.12802538363478, -22.695941607892557, -175.48504409377136, -53.86997294743318, -153.19758897827086, -996.8137051089866, -185.68503901229852, -263.7405476579227, -78.65105424235719, -1459.7731698355374, -158.03307226671737, -62.77089562253341, -169.33529859023895, -278.49711102753673, -122.71214153150926, -178.6344482315962, -171.73377713183672, -37.670085887691606, -134.39957786631243, -99.00375800921792, -323.9048840933478, -273.5031788258465, -119.15837493403043, -129.75087917294854, -202.88792547079072, -188.30764846453536, -32.31149348426145, -203.20294235689346, -566.9187671159996, -178.5743391544262, -360.8045677544651, -155.6677137721351, -19.99268705894827, -52.86134172820459, -233.51784943279287, -226.59735044078818, -64.44421173795672, -110.13485935170314, -73.51474852467133, -42.48565450861131, -18.45647973014935, -19.497007761116357, -53.11991493254795, -134.2284804618182, -220.75873761682934, -524.2909498966047, -87.37211962515295, -138.31836385623143, -79.565496866171, -82.83405828881477, -27.972416388862527, -373.5217710585948, -162.93448718880651, -222.00948842078148, -333.03932530266513, -688.3294042671748, -107.90289219071917, -234.55534380211392, -1127.2607093948793, -146.48396647138782, -87.80336263522973, -107.84272705610199, -1104.1262766685288, -401.227253875949, -1022.7246294638549, -942.1700880280305, -344.8201659342735, -172.6574011173251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5624683072582867, "mean_inference_ms": 1.70172964302773, "mean_action_processing_ms": 0.27527761403496726, "mean_env_wait_ms": 3.387461505730693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012131690979003906, "StateBufferConnector_ms": 0.008101224899291992, "ViewRequirementAgentConnector_ms": 0.1955726146697998}, "num_episodes": 39, "episode_return_max": -4.600827647340896, "episode_return_min": -1459.7731698355374, "episode_return_mean": -252.49344370111677, "episodes_this_iter": 39}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.058324349018, "num_env_steps_trained_throughput_per_sec": 300.058324349018, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 340000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 340000, "timers": {"training_iteration_time_ms": 12488.827, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12488.756, "sample_time_ms": 1112.566, "learn_time_ms": 11313.411, "learn_throughput": 353.563, "synch_weights_time_ms": 61.957}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "done": false, "training_iteration": 85, "trial_id": "b33d0_00000", "date": "2024-08-06_14-57-51", "timestamp": 1722936471, "time_this_iter_s": 13.344467639923096, "time_total_s": 1032.9129383563995, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c169870>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1032.9129383563995, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 17.426315789473687, "ram_util_percent": 29.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 112.94908894002438, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 2.443265370403727, "policy_loss": -0.008192596024794814, "vf_loss": 2.4420358148713905, "vf_explained_var": 0.9671631424377362, "kl": 0.010159344396136855, "entropy": 0.8641764948765437, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 82080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "env_runners": {"episode_reward_max": 2.2989310984008027, "episode_reward_min": -1380.8613500703302, "episode_reward_mean": -266.7444736670376, "episode_len_mean": 94.56, "episode_media": {}, "episodes_timesteps_total": 9456, "policy_reward_min": {"policy_0": -1380.8613500703302}, "policy_reward_max": {"policy_0": 2.2989310984008027}, "policy_reward_mean": {"policy_0": -266.7444736670376}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-178.6344482315962, -171.73377713183672, -37.670085887691606, -134.39957786631243, -99.00375800921792, -323.9048840933478, -273.5031788258465, -119.15837493403043, -129.75087917294854, -202.88792547079072, -188.30764846453536, -32.31149348426145, -203.20294235689346, -566.9187671159996, -178.5743391544262, -360.8045677544651, -155.6677137721351, -19.99268705894827, -52.86134172820459, -233.51784943279287, -226.59735044078818, -64.44421173795672, -110.13485935170314, -73.51474852467133, -42.48565450861131, -18.45647973014935, -19.497007761116357, -53.11991493254795, -134.2284804618182, -220.75873761682934, -524.2909498966047, -87.37211962515295, -138.31836385623143, -79.565496866171, -82.83405828881477, -27.972416388862527, -373.5217710585948, -162.93448718880651, -222.00948842078148, -333.03932530266513, -688.3294042671748, -107.90289219071917, -234.55534380211392, -1127.2607093948793, -146.48396647138782, -87.80336263522973, -107.84272705610199, -1104.1262766685288, -401.227253875949, -1022.7246294638549, -942.1700880280305, -344.8201659342735, -172.6574011173251, -255.4918228274582, -1380.8613500703302, -343.5434445592314, -70.67214057817907, -64.91609825521499, -133.1485325498415, -78.93338289417825, -321.3539364885128, -55.312212363971284, -89.4954496143113, -1361.0839218172687, -122.92567678673481, -196.41375250640584, -16.663086153484194, -877.4823413977617, -201.07441228108814, -237.4667763010762, -162.6395955892758, -207.22606589263282, 2.2989310984008027, -353.7538584977272, -411.13541279231157, -393.7711552037396, -161.39840336491608, -169.0302871834234, -1186.0428789624557, -181.74549336272065, -110.15454520774986, -534.6676118733591, -83.6714881500314, -168.50750617860433, -39.07369289874261, -157.55675898485325, -98.3488716913901, -128.40267603370785, -561.2560620201157, -270.90659115606735, -261.6560382607719, -114.77211515373753, -39.37347058525619, -133.2783777475095, -107.48287221286158, -342.6280325376385, -280.3051324288798, -337.26754156756806, -267.62053648945874, -460.42850551888074], "episode_lengths": [84, 88, 43, 89, 72, 150, 129, 80, 90, 99, 102, 53, 90, 150, 84, 119, 81, 40, 53, 112, 95, 60, 73, 60, 61, 36, 40, 56, 86, 73, 150, 66, 98, 59, 64, 47, 147, 84, 116, 150, 150, 72, 99, 150, 83, 63, 85, 150, 150, 150, 150, 115, 85, 113, 150, 150, 54, 54, 74, 62, 104, 56, 73, 150, 70, 95, 46, 144, 102, 100, 89, 90, 29, 121, 150, 118, 87, 74, 150, 90, 71, 150, 66, 81, 48, 86, 65, 61, 150, 103, 120, 75, 58, 82, 66, 121, 122, 150, 105, 150], "policy_policy_0_reward": [-178.6344482315962, -171.73377713183672, -37.670085887691606, -134.39957786631243, -99.00375800921792, -323.9048840933478, -273.5031788258465, -119.15837493403043, -129.75087917294854, -202.88792547079072, -188.30764846453536, -32.31149348426145, -203.20294235689346, -566.9187671159996, -178.5743391544262, -360.8045677544651, -155.6677137721351, -19.99268705894827, -52.86134172820459, -233.51784943279287, -226.59735044078818, -64.44421173795672, -110.13485935170314, -73.51474852467133, -42.48565450861131, -18.45647973014935, -19.497007761116357, -53.11991493254795, -134.2284804618182, -220.75873761682934, -524.2909498966047, -87.37211962515295, -138.31836385623143, -79.565496866171, -82.83405828881477, -27.972416388862527, -373.5217710585948, -162.93448718880651, -222.00948842078148, -333.03932530266513, -688.3294042671748, -107.90289219071917, -234.55534380211392, -1127.2607093948793, -146.48396647138782, -87.80336263522973, -107.84272705610199, -1104.1262766685288, -401.227253875949, -1022.7246294638549, -942.1700880280305, -344.8201659342735, -172.6574011173251, -255.4918228274582, -1380.8613500703302, -343.5434445592314, -70.67214057817907, -64.91609825521499, -133.1485325498415, -78.93338289417825, -321.3539364885128, -55.312212363971284, -89.4954496143113, -1361.0839218172687, -122.92567678673481, -196.41375250640584, -16.663086153484194, -877.4823413977617, -201.07441228108814, -237.4667763010762, -162.6395955892758, -207.22606589263282, 2.2989310984008027, -353.7538584977272, -411.13541279231157, -393.7711552037396, -161.39840336491608, -169.0302871834234, -1186.0428789624557, -181.74549336272065, -110.15454520774986, -534.6676118733591, -83.6714881500314, -168.50750617860433, -39.07369289874261, -157.55675898485325, -98.3488716913901, -128.40267603370785, -561.2560620201157, -270.90659115606735, -261.6560382607719, -114.77211515373753, -39.37347058525619, -133.2783777475095, -107.48287221286158, -342.6280325376385, -280.3051324288798, -337.26754156756806, -267.62053648945874, -460.42850551888074]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.56228368140774, "mean_inference_ms": 1.7016942373140653, "mean_action_processing_ms": 0.27522496216213127, "mean_env_wait_ms": 3.3872979420206986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01226663589477539, "StateBufferConnector_ms": 0.00818490982055664, "ViewRequirementAgentConnector_ms": 0.20041942596435547}, "num_episodes": 47, "episode_return_max": 2.2989310984008027, "episode_return_min": -1380.8613500703302, "episode_return_mean": -266.7444736670376, "episodes_this_iter": 47}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 329.4874251506884, "num_env_steps_trained_throughput_per_sec": 329.4874251506884, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 344000, "timers": {"training_iteration_time_ms": 12450.335, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12450.262, "sample_time_ms": 1113.258, "learn_time_ms": 11274.192, "learn_throughput": 354.793, "synch_weights_time_ms": 61.99}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "done": false, "training_iteration": 86, "trial_id": "b33d0_00000", "date": "2024-08-06_14-58-03", "timestamp": 1722936483, "time_this_iter_s": 12.151774168014526, "time_total_s": 1045.064712524414, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2a8dc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1045.064712524414, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 17.677777777777777, "ram_util_percent": 29.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 125.3913381020228, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 2.795489067894717, "policy_loss": -0.016015178872233568, "vf_loss": 2.7987868048250677, "vf_explained_var": 0.9597296845167875, "kl": 0.013444400490849754, "entropy": 0.8950194598796467, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 83040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "env_runners": {"episode_reward_max": 3.2647835905760556, "episode_reward_min": -1380.8613500703302, "episode_reward_mean": -297.5974797990399, "episode_len_mean": 95.46, "episode_media": {}, "episodes_timesteps_total": 9546, "policy_reward_min": {"policy_0": -1380.8613500703302}, "policy_reward_max": {"policy_0": 3.2647835905760556}, "policy_reward_mean": {"policy_0": -297.5974797990399}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1127.2607093948793, -146.48396647138782, -87.80336263522973, -107.84272705610199, -1104.1262766685288, -401.227253875949, -1022.7246294638549, -942.1700880280305, -344.8201659342735, -172.6574011173251, -255.4918228274582, -1380.8613500703302, -343.5434445592314, -70.67214057817907, -64.91609825521499, -133.1485325498415, -78.93338289417825, -321.3539364885128, -55.312212363971284, -89.4954496143113, -1361.0839218172687, -122.92567678673481, -196.41375250640584, -16.663086153484194, -877.4823413977617, -201.07441228108814, -237.4667763010762, -162.6395955892758, -207.22606589263282, 2.2989310984008027, -353.7538584977272, -411.13541279231157, -393.7711552037396, -161.39840336491608, -169.0302871834234, -1186.0428789624557, -181.74549336272065, -110.15454520774986, -534.6676118733591, -83.6714881500314, -168.50750617860433, -39.07369289874261, -157.55675898485325, -98.3488716913901, -128.40267603370785, -561.2560620201157, -270.90659115606735, -261.6560382607719, -114.77211515373753, -39.37347058525619, -133.2783777475095, -107.48287221286158, -342.6280325376385, -280.3051324288798, -337.26754156756806, -267.62053648945874, -460.42850551888074, -28.372967641546282, -639.386125858311, -464.217101205329, -6.635895841862224, -652.2095185301795, -99.97085568380335, -124.2274375246066, -76.93576881950727, -75.12716401439839, -161.75623330944822, -203.58012401589923, -180.81012520633763, -220.15766143233049, -15.70272754218615, -200.23684213594234, -435.86930611250955, -38.225559004077844, -322.36207027110254, -239.55026067243512, -114.00940061637762, -98.15034633257446, 3.0327642670860033, -36.68857673606004, -93.75845445115634, -604.2822582367971, -23.477204397002204, -399.23589233147027, -838.2157671912811, 3.2647835905760556, -78.16619204916276, -188.44315138450395, -260.8188092457393, -368.95910578019533, -980.2629066838515, -130.79505028130916, -166.7072828254887, -115.88420962588593, -656.67408087093, -86.19959795959085, -974.1187027696775, -240.68440393259635, -51.049998705888115, -88.3728259937083], "episode_lengths": [150, 83, 63, 85, 150, 150, 150, 150, 115, 85, 113, 150, 150, 54, 54, 74, 62, 104, 56, 73, 150, 70, 95, 46, 144, 102, 100, 89, 90, 29, 121, 150, 118, 87, 74, 150, 90, 71, 150, 66, 81, 48, 86, 65, 61, 150, 103, 120, 75, 58, 82, 66, 121, 122, 150, 105, 150, 43, 123, 150, 39, 150, 67, 65, 54, 52, 106, 85, 88, 90, 36, 95, 134, 54, 150, 95, 90, 49, 33, 56, 57, 150, 48, 122, 150, 32, 51, 89, 116, 150, 150, 77, 90, 74, 150, 64, 150, 96, 52, 68], "policy_policy_0_reward": [-1127.2607093948793, -146.48396647138782, -87.80336263522973, -107.84272705610199, -1104.1262766685288, -401.227253875949, -1022.7246294638549, -942.1700880280305, -344.8201659342735, -172.6574011173251, -255.4918228274582, -1380.8613500703302, -343.5434445592314, -70.67214057817907, -64.91609825521499, -133.1485325498415, -78.93338289417825, -321.3539364885128, -55.312212363971284, -89.4954496143113, -1361.0839218172687, -122.92567678673481, -196.41375250640584, -16.663086153484194, -877.4823413977617, -201.07441228108814, -237.4667763010762, -162.6395955892758, -207.22606589263282, 2.2989310984008027, -353.7538584977272, -411.13541279231157, -393.7711552037396, -161.39840336491608, -169.0302871834234, -1186.0428789624557, -181.74549336272065, -110.15454520774986, -534.6676118733591, -83.6714881500314, -168.50750617860433, -39.07369289874261, -157.55675898485325, -98.3488716913901, -128.40267603370785, -561.2560620201157, -270.90659115606735, -261.6560382607719, -114.77211515373753, -39.37347058525619, -133.2783777475095, -107.48287221286158, -342.6280325376385, -280.3051324288798, -337.26754156756806, -267.62053648945874, -460.42850551888074, -28.372967641546282, -639.386125858311, -464.217101205329, -6.635895841862224, -652.2095185301795, -99.97085568380335, -124.2274375246066, -76.93576881950727, -75.12716401439839, -161.75623330944822, -203.58012401589923, -180.81012520633763, -220.15766143233049, -15.70272754218615, -200.23684213594234, -435.86930611250955, -38.225559004077844, -322.36207027110254, -239.55026067243512, -114.00940061637762, -98.15034633257446, 3.0327642670860033, -36.68857673606004, -93.75845445115634, -604.2822582367971, -23.477204397002204, -399.23589233147027, -838.2157671912811, 3.2647835905760556, -78.16619204916276, -188.44315138450395, -260.8188092457393, -368.95910578019533, -980.2629066838515, -130.79505028130916, -166.7072828254887, -115.88420962588593, -656.67408087093, -86.19959795959085, -974.1187027696775, -240.68440393259635, -51.049998705888115, -88.3728259937083]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.56181565432199, "mean_inference_ms": 1.7011610783328046, "mean_action_processing_ms": 0.2747974545175835, "mean_env_wait_ms": 3.3872628727848206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012256383895874023, "StateBufferConnector_ms": 0.008149862289428711, "ViewRequirementAgentConnector_ms": 0.19954228401184082}, "num_episodes": 43, "episode_return_max": 3.2647835905760556, "episode_return_min": -1380.8613500703302, "episode_return_mean": -297.5974797990399, "episodes_this_iter": 43}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.6045176854321, "num_env_steps_trained_throughput_per_sec": 311.6045176854321, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 348000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 12595.599, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12595.524, "sample_time_ms": 1103.625, "learn_time_ms": 11427.63, "learn_throughput": 350.029, "synch_weights_time_ms": 63.439}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "training_iteration": 87, "trial_id": "b33d0_00000", "date": "2024-08-06_14-58-16", "timestamp": 1722936496, "time_this_iter_s": 12.849015712738037, "time_total_s": 1057.913728237152, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c16acb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1057.913728237152, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 17.583333333333332, "ram_util_percent": 29.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 118.90534406006336, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 2.084112035296857, "policy_loss": -0.01662999855179805, "vf_loss": 2.080937514019509, "vf_explained_var": 0.987027123508354, "kl": 0.02027106224116634, "entropy": 0.7199345691750447, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 3.2647835905760556, "episode_reward_min": -1043.761336597531, "episode_reward_mean": -226.27352072452126, "episode_len_mean": 88.57, "episode_media": {}, "episodes_timesteps_total": 8857, "policy_reward_min": {"policy_0": -1043.761336597531}, "policy_reward_max": {"policy_0": 3.2647835905760556}, "policy_reward_mean": {"policy_0": -226.27352072452126}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.37347058525619, -133.2783777475095, -107.48287221286158, -342.6280325376385, -280.3051324288798, -337.26754156756806, -267.62053648945874, -460.42850551888074, -28.372967641546282, -639.386125858311, -464.217101205329, -6.635895841862224, -652.2095185301795, -99.97085568380335, -124.2274375246066, -76.93576881950727, -75.12716401439839, -161.75623330944822, -203.58012401589923, -180.81012520633763, -220.15766143233049, -15.70272754218615, -200.23684213594234, -435.86930611250955, -38.225559004077844, -322.36207027110254, -239.55026067243512, -114.00940061637762, -98.15034633257446, 3.0327642670860033, -36.68857673606004, -93.75845445115634, -604.2822582367971, -23.477204397002204, -399.23589233147027, -838.2157671912811, 3.2647835905760556, -78.16619204916276, -188.44315138450395, -260.8188092457393, -368.95910578019533, -980.2629066838515, -130.79505028130916, -166.7072828254887, -115.88420962588593, -656.67408087093, -86.19959795959085, -974.1187027696775, -240.68440393259635, -51.049998705888115, -88.3728259937083, -21.749234497606707, -19.848057097288777, -153.84023552512798, -155.60554273344155, -163.53906359444787, -368.66639829334855, -41.592302763658395, 0.32452099727944017, -203.410130739818, -145.51368058709386, -513.4278838351582, -36.31413857850626, -250.80251553733413, -523.7304207020015, -112.79352281171339, -41.55365528823671, -184.2531322727283, -84.12367469161772, -134.21749293343754, -109.29950257613382, -179.76600525688542, -457.80374766238816, -54.99075043238084, -58.61127680242711, -100.27166842725491, -121.14124959647206, -149.7159018573464, -64.30264096865572, -129.246856015073, -786.1008965022163, -480.56687902336563, -90.48849440590863, -125.02541640461888, -19.855390398747748, -205.6293868334155, -244.26875713553792, -145.2481207593786, -222.25790235163035, -132.5224422132955, -74.94942341419613, -72.51605528666599, -357.64496730430193, -167.1686525365141, -160.6066661547094, -252.47581629723467, -196.41667534921018, -445.7079903117343, -81.95975763816034, -1043.761336597531], "episode_lengths": [58, 82, 66, 121, 122, 150, 105, 150, 43, 123, 150, 39, 150, 67, 65, 54, 52, 106, 85, 88, 90, 36, 95, 134, 54, 150, 95, 90, 49, 33, 56, 57, 150, 48, 122, 150, 32, 51, 89, 116, 150, 150, 77, 90, 74, 150, 64, 150, 96, 52, 68, 51, 42, 79, 81, 87, 138, 61, 31, 84, 74, 150, 49, 111, 150, 77, 36, 68, 66, 90, 67, 91, 150, 53, 48, 65, 77, 77, 55, 55, 150, 141, 68, 73, 44, 89, 101, 86, 94, 79, 66, 66, 150, 86, 80, 100, 94, 132, 51, 150], "policy_policy_0_reward": [-39.37347058525619, -133.2783777475095, -107.48287221286158, -342.6280325376385, -280.3051324288798, -337.26754156756806, -267.62053648945874, -460.42850551888074, -28.372967641546282, -639.386125858311, -464.217101205329, -6.635895841862224, -652.2095185301795, -99.97085568380335, -124.2274375246066, -76.93576881950727, -75.12716401439839, -161.75623330944822, -203.58012401589923, -180.81012520633763, -220.15766143233049, -15.70272754218615, -200.23684213594234, -435.86930611250955, -38.225559004077844, -322.36207027110254, -239.55026067243512, -114.00940061637762, -98.15034633257446, 3.0327642670860033, -36.68857673606004, -93.75845445115634, -604.2822582367971, -23.477204397002204, -399.23589233147027, -838.2157671912811, 3.2647835905760556, -78.16619204916276, -188.44315138450395, -260.8188092457393, -368.95910578019533, -980.2629066838515, -130.79505028130916, -166.7072828254887, -115.88420962588593, -656.67408087093, -86.19959795959085, -974.1187027696775, -240.68440393259635, -51.049998705888115, -88.3728259937083, -21.749234497606707, -19.848057097288777, -153.84023552512798, -155.60554273344155, -163.53906359444787, -368.66639829334855, -41.592302763658395, 0.32452099727944017, -203.410130739818, -145.51368058709386, -513.4278838351582, -36.31413857850626, -250.80251553733413, -523.7304207020015, -112.79352281171339, -41.55365528823671, -184.2531322727283, -84.12367469161772, -134.21749293343754, -109.29950257613382, -179.76600525688542, -457.80374766238816, -54.99075043238084, -58.61127680242711, -100.27166842725491, -121.14124959647206, -149.7159018573464, -64.30264096865572, -129.246856015073, -786.1008965022163, -480.56687902336563, -90.48849440590863, -125.02541640461888, -19.855390398747748, -205.6293868334155, -244.26875713553792, -145.2481207593786, -222.25790235163035, -132.5224422132955, -74.94942341419613, -72.51605528666599, -357.64496730430193, -167.1686525365141, -160.6066661547094, -252.47581629723467, -196.41667534921018, -445.7079903117343, -81.95975763816034, -1043.761336597531]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5622223870148864, "mean_inference_ms": 1.7018967606938356, "mean_action_processing_ms": 0.2751363473892005, "mean_env_wait_ms": 3.387959474353437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012181520462036133, "StateBufferConnector_ms": 0.008052825927734375, "ViewRequirementAgentConnector_ms": 0.19546961784362793}, "num_episodes": 49, "episode_return_max": 3.2647835905760556, "episode_return_min": -1043.761336597531, "episode_return_mean": -226.27352072452126, "episodes_this_iter": 49}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 337.78068484700765, "num_env_steps_trained_throughput_per_sec": 337.78068484700765, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 12458.718, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12458.641, "sample_time_ms": 1095.491, "learn_time_ms": 11297.95, "learn_throughput": 354.047, "synch_weights_time_ms": 64.353}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 88, "trial_id": "b33d0_00000", "date": "2024-08-06_14-58-28", "timestamp": 1722936508, "time_this_iter_s": 11.85800290107727, "time_total_s": 1069.7717311382294, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c16b760>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1069.7717311382294, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 18.247058823529414, "ram_util_percent": 29.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 104.87047323584557, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 2.368402203172445, "policy_loss": -0.013490428177465218, "vf_loss": 2.37132887126257, "vf_explained_var": 0.9677039218445619, "kl": 0.0074408069621919514, "entropy": 0.7369694218660394, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "env_runners": {"episode_reward_max": 1.3628243256847878, "episode_reward_min": -1043.761336597531, "episode_reward_mean": -203.81295964678765, "episode_len_mean": 86.09, "episode_media": {}, "episodes_timesteps_total": 8609, "policy_reward_min": {"policy_0": -1043.761336597531}, "policy_reward_max": {"policy_0": 1.3628243256847878}, "policy_reward_mean": {"policy_0": -203.81295964678765}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-656.67408087093, -86.19959795959085, -974.1187027696775, -240.68440393259635, -51.049998705888115, -88.3728259937083, -21.749234497606707, -19.848057097288777, -153.84023552512798, -155.60554273344155, -163.53906359444787, -368.66639829334855, -41.592302763658395, 0.32452099727944017, -203.410130739818, -145.51368058709386, -513.4278838351582, -36.31413857850626, -250.80251553733413, -523.7304207020015, -112.79352281171339, -41.55365528823671, -184.2531322727283, -84.12367469161772, -134.21749293343754, -109.29950257613382, -179.76600525688542, -457.80374766238816, -54.99075043238084, -58.61127680242711, -100.27166842725491, -121.14124959647206, -149.7159018573464, -64.30264096865572, -129.246856015073, -786.1008965022163, -480.56687902336563, -90.48849440590863, -125.02541640461888, -19.855390398747748, -205.6293868334155, -244.26875713553792, -145.2481207593786, -222.25790235163035, -132.5224422132955, -74.94942341419613, -72.51605528666599, -357.64496730430193, -167.1686525365141, -160.6066661547094, -252.47581629723467, -196.41667534921018, -445.7079903117343, -81.95975763816034, -1043.761336597531, -497.5025913148125, -175.72116678080585, -13.30304347367444, -137.7357268824346, -326.46878912740004, -67.82974393800086, -264.93181661781256, -268.46663540284663, -317.4060708456222, -556.8018010724883, -136.59026581527107, -120.28368473810383, -126.15606258163207, -194.74998199621584, -462.78255159464067, -111.04910362476411, -402.4466165235573, -304.7972848667224, -240.68102280749886, -102.50054140648685, -382.0546650799865, -160.58457917532064, -31.032675061641555, -28.328191315044826, -123.91835306505911, -12.590741206077576, -115.96969633603236, -40.268142384850506, -48.03471689041167, -8.422991410586741, 1.3628243256847878, -165.85605658419885, -57.26550814383311, -457.4407818351807, -743.8472631705305, -185.39653093582498, -22.907864274023343, -336.5933045661795, -0.7500884931737966, -157.2058626187023, -61.0075927865108, -119.0736340336247, -144.32951697763514, -83.17927054512263, -86.31946247303881], "episode_lengths": [150, 64, 150, 96, 52, 68, 51, 42, 79, 81, 87, 138, 61, 31, 84, 74, 150, 49, 111, 150, 77, 36, 68, 66, 90, 67, 91, 150, 53, 48, 65, 77, 77, 55, 55, 150, 141, 68, 73, 44, 89, 101, 86, 94, 79, 66, 66, 150, 86, 80, 100, 94, 132, 51, 150, 140, 87, 40, 72, 150, 68, 118, 98, 150, 150, 64, 54, 74, 90, 150, 71, 150, 150, 94, 71, 128, 92, 47, 46, 75, 45, 71, 54, 52, 34, 36, 87, 62, 150, 136, 87, 46, 115, 37, 84, 65, 70, 79, 63, 64], "policy_policy_0_reward": [-656.67408087093, -86.19959795959085, -974.1187027696775, -240.68440393259635, -51.049998705888115, -88.3728259937083, -21.749234497606707, -19.848057097288777, -153.84023552512798, -155.60554273344155, -163.53906359444787, -368.66639829334855, -41.592302763658395, 0.32452099727944017, -203.410130739818, -145.51368058709386, -513.4278838351582, -36.31413857850626, -250.80251553733413, -523.7304207020015, -112.79352281171339, -41.55365528823671, -184.2531322727283, -84.12367469161772, -134.21749293343754, -109.29950257613382, -179.76600525688542, -457.80374766238816, -54.99075043238084, -58.61127680242711, -100.27166842725491, -121.14124959647206, -149.7159018573464, -64.30264096865572, -129.246856015073, -786.1008965022163, -480.56687902336563, -90.48849440590863, -125.02541640461888, -19.855390398747748, -205.6293868334155, -244.26875713553792, -145.2481207593786, -222.25790235163035, -132.5224422132955, -74.94942341419613, -72.51605528666599, -357.64496730430193, -167.1686525365141, -160.6066661547094, -252.47581629723467, -196.41667534921018, -445.7079903117343, -81.95975763816034, -1043.761336597531, -497.5025913148125, -175.72116678080585, -13.30304347367444, -137.7357268824346, -326.46878912740004, -67.82974393800086, -264.93181661781256, -268.46663540284663, -317.4060708456222, -556.8018010724883, -136.59026581527107, -120.28368473810383, -126.15606258163207, -194.74998199621584, -462.78255159464067, -111.04910362476411, -402.4466165235573, -304.7972848667224, -240.68102280749886, -102.50054140648685, -382.0546650799865, -160.58457917532064, -31.032675061641555, -28.328191315044826, -123.91835306505911, -12.590741206077576, -115.96969633603236, -40.268142384850506, -48.03471689041167, -8.422991410586741, 1.3628243256847878, -165.85605658419885, -57.26550814383311, -457.4407818351807, -743.8472631705305, -185.39653093582498, -22.907864274023343, -336.5933045661795, -0.7500884931737966, -157.2058626187023, -61.0075927865108, -119.0736340336247, -144.32951697763514, -83.17927054512263, -86.31946247303881]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5622089779364206, "mean_inference_ms": 1.7006385187701352, "mean_action_processing_ms": 0.2749111149340713, "mean_env_wait_ms": 3.3842561624809373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012387752532958984, "StateBufferConnector_ms": 0.008041620254516602, "ViewRequirementAgentConnector_ms": 0.19521832466125488}, "num_episodes": 45, "episode_return_max": 1.3628243256847878, "episode_return_min": -1043.761336597531, "episode_return_mean": -203.81295964678765, "episodes_this_iter": 45}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.06277047878586, "num_env_steps_trained_throughput_per_sec": 323.06277047878586, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 356000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 356000, "timers": {"training_iteration_time_ms": 12429.417, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12429.338, "sample_time_ms": 1094.875, "learn_time_ms": 11268.958, "learn_throughput": 354.957, "synch_weights_time_ms": 64.65}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "done": false, "training_iteration": 89, "trial_id": "b33d0_00000", "date": "2024-08-06_14-58-40", "timestamp": 1722936520, "time_this_iter_s": 12.395308017730713, "time_total_s": 1082.16703915596, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c169a20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1082.16703915596, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 17.66111111111111, "ram_util_percent": 29.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 96.00812282363573, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 2.1128664333218086, "policy_loss": -0.015571046472662905, "vf_loss": 2.114720610156655, "vf_explained_var": 0.9847102597976725, "kl": 0.009528500416915227, "entropy": 0.7545460185036064, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 85920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": 1.3628243256847878, "episode_reward_min": -1397.3763820065562, "episode_reward_mean": -209.620046874477, "episode_len_mean": 85.71, "episode_media": {}, "episodes_timesteps_total": 8571, "policy_reward_min": {"policy_0": -1397.3763820065562}, "policy_reward_max": {"policy_0": 1.3628243256847878}, "policy_reward_mean": {"policy_0": -209.620046874477}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-445.7079903117343, -81.95975763816034, -1043.761336597531, -497.5025913148125, -175.72116678080585, -13.30304347367444, -137.7357268824346, -326.46878912740004, -67.82974393800086, -264.93181661781256, -268.46663540284663, -317.4060708456222, -556.8018010724883, -136.59026581527107, -120.28368473810383, -126.15606258163207, -194.74998199621584, -462.78255159464067, -111.04910362476411, -402.4466165235573, -304.7972848667224, -240.68102280749886, -102.50054140648685, -382.0546650799865, -160.58457917532064, -31.032675061641555, -28.328191315044826, -123.91835306505911, -12.590741206077576, -115.96969633603236, -40.268142384850506, -48.03471689041167, -8.422991410586741, 1.3628243256847878, -165.85605658419885, -57.26550814383311, -457.4407818351807, -743.8472631705305, -185.39653093582498, -22.907864274023343, -336.5933045661795, -0.7500884931737966, -157.2058626187023, -61.0075927865108, -119.0736340336247, -144.32951697763514, -83.17927054512263, -86.31946247303881, -561.7376006937369, -101.04849377892822, -173.42566817452607, -407.1502357523354, -904.3904008892661, -54.41779118092352, -123.43952821150704, -26.801741928955277, -13.87909129845151, -147.35392485791965, -143.51885296608066, -164.87481498462716, -8.112639392852477, -473.97036485300856, -19.384741585144262, -18.739321656683515, -43.073644622984844, -461.17370049036487, -258.8089409868739, -75.37449946074973, -115.4626312766642, -125.5786755393461, -312.36137564045254, -30.343291732628813, -5.817119991446257, -5.625893802142498, -235.23387956494753, -784.5975072356224, -197.27088834939624, -444.1239516562665, -177.15486394112457, -148.0834070176381, -101.57207229407751, -134.5147624559249, -139.41424568436642, -156.69548871034027, -79.02162593504552, -228.20221784939812, -119.54344271494033, -321.5668042918839, -1397.3763820065562, -96.04582625654136, -68.73695625713108, -167.2837769127931, -18.119634346116086, -69.04009498355036, -375.16726049294294, -122.16666889233062, -134.57545111878704, -96.63413669205471, -380.871155755159, -22.478949289047044], "episode_lengths": [132, 51, 150, 140, 87, 40, 72, 150, 68, 118, 98, 150, 150, 64, 54, 74, 90, 150, 71, 150, 150, 94, 71, 128, 92, 47, 46, 75, 45, 71, 54, 52, 34, 36, 87, 62, 150, 136, 87, 46, 115, 37, 84, 65, 70, 79, 63, 64, 147, 68, 87, 150, 150, 43, 76, 44, 35, 81, 80, 90, 34, 150, 41, 37, 60, 150, 131, 62, 71, 76, 112, 42, 33, 42, 76, 150, 110, 129, 90, 75, 69, 88, 62, 79, 56, 91, 76, 131, 150, 73, 58, 80, 44, 60, 133, 75, 80, 63, 135, 47], "policy_policy_0_reward": [-445.7079903117343, -81.95975763816034, -1043.761336597531, -497.5025913148125, -175.72116678080585, -13.30304347367444, -137.7357268824346, -326.46878912740004, -67.82974393800086, -264.93181661781256, -268.46663540284663, -317.4060708456222, -556.8018010724883, -136.59026581527107, -120.28368473810383, -126.15606258163207, -194.74998199621584, -462.78255159464067, -111.04910362476411, -402.4466165235573, -304.7972848667224, -240.68102280749886, -102.50054140648685, -382.0546650799865, -160.58457917532064, -31.032675061641555, -28.328191315044826, -123.91835306505911, -12.590741206077576, -115.96969633603236, -40.268142384850506, -48.03471689041167, -8.422991410586741, 1.3628243256847878, -165.85605658419885, -57.26550814383311, -457.4407818351807, -743.8472631705305, -185.39653093582498, -22.907864274023343, -336.5933045661795, -0.7500884931737966, -157.2058626187023, -61.0075927865108, -119.0736340336247, -144.32951697763514, -83.17927054512263, -86.31946247303881, -561.7376006937369, -101.04849377892822, -173.42566817452607, -407.1502357523354, -904.3904008892661, -54.41779118092352, -123.43952821150704, -26.801741928955277, -13.87909129845151, -147.35392485791965, -143.51885296608066, -164.87481498462716, -8.112639392852477, -473.97036485300856, -19.384741585144262, -18.739321656683515, -43.073644622984844, -461.17370049036487, -258.8089409868739, -75.37449946074973, -115.4626312766642, -125.5786755393461, -312.36137564045254, -30.343291732628813, -5.817119991446257, -5.625893802142498, -235.23387956494753, -784.5975072356224, -197.27088834939624, -444.1239516562665, -177.15486394112457, -148.0834070176381, -101.57207229407751, -134.5147624559249, -139.41424568436642, -156.69548871034027, -79.02162593504552, -228.20221784939812, -119.54344271494033, -321.5668042918839, -1397.3763820065562, -96.04582625654136, -68.73695625713108, -167.2837769127931, -18.119634346116086, -69.04009498355036, -375.16726049294294, -122.16666889233062, -134.57545111878704, -96.63413669205471, -380.871155755159, -22.478949289047044]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5619948281677694, "mean_inference_ms": 1.6987211921202903, "mean_action_processing_ms": 0.274603370519451, "mean_env_wait_ms": 3.3836050843157137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01232147216796875, "StateBufferConnector_ms": 0.00800323486328125, "ViewRequirementAgentConnector_ms": 0.1951143741607666}, "num_episodes": 52, "episode_return_max": 1.3628243256847878, "episode_return_min": -1397.3763820065562, "episode_return_mean": -209.620046874477, "episodes_this_iter": 52}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.8350095283707, "num_env_steps_trained_throughput_per_sec": 323.8350095283707, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 12596.739, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12596.662, "sample_time_ms": 1093.019, "learn_time_ms": 11437.526, "learn_throughput": 349.726, "synch_weights_time_ms": 65.262}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 90, "trial_id": "b33d0_00000", "date": "2024-08-06_14-58-53", "timestamp": 1722936533, "time_this_iter_s": 12.364394426345825, "time_total_s": 1094.531433582306, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c1685e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1094.531433582306, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 17.96470588235294, "ram_util_percent": 29.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 112.15666066606839, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 2.3108375301468187, "policy_loss": -0.010798586502399605, "vf_loss": 2.3094978262359898, "vf_explained_var": 0.9898463819175959, "kl": 0.008699992356241637, "entropy": 1.0748251691771051, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 86880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "env_runners": {"episode_reward_max": 1.5709854710016409, "episode_reward_min": -1397.3763820065562, "episode_reward_mean": -245.41196804208772, "episode_len_mean": 86.89, "episode_media": {}, "episodes_timesteps_total": 8689, "policy_reward_min": {"policy_0": -1397.3763820065562}, "policy_reward_max": {"policy_0": 1.5709854710016409}, "policy_reward_mean": {"policy_0": -245.41196804208772}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-336.5933045661795, -0.7500884931737966, -157.2058626187023, -61.0075927865108, -119.0736340336247, -144.32951697763514, -83.17927054512263, -86.31946247303881, -561.7376006937369, -101.04849377892822, -173.42566817452607, -407.1502357523354, -904.3904008892661, -54.41779118092352, -123.43952821150704, -26.801741928955277, -13.87909129845151, -147.35392485791965, -143.51885296608066, -164.87481498462716, -8.112639392852477, -473.97036485300856, -19.384741585144262, -18.739321656683515, -43.073644622984844, -461.17370049036487, -258.8089409868739, -75.37449946074973, -115.4626312766642, -125.5786755393461, -312.36137564045254, -30.343291732628813, -5.817119991446257, -5.625893802142498, -235.23387956494753, -784.5975072356224, -197.27088834939624, -444.1239516562665, -177.15486394112457, -148.0834070176381, -101.57207229407751, -134.5147624559249, -139.41424568436642, -156.69548871034027, -79.02162593504552, -228.20221784939812, -119.54344271494033, -321.5668042918839, -1397.3763820065562, -96.04582625654136, -68.73695625713108, -167.2837769127931, -18.119634346116086, -69.04009498355036, -375.16726049294294, -122.16666889233062, -134.57545111878704, -96.63413669205471, -380.871155755159, -22.478949289047044, 1.5709854710016409, -1120.8797248925, -255.51487059906682, -143.83894456436425, -109.72247714735306, -142.8902694307032, -214.0180527527667, -181.12030892185055, -63.97729366716568, -76.3748339695258, -93.08414121811506, -71.90743437341838, -84.5381515525377, -97.28827723550448, -983.0852953865189, -37.10568714380338, -103.1669194546585, -149.03356683670177, -129.12413807949883, -74.19424382654655, -328.5444097922488, -1047.13904354932, -242.80543181849563, -1163.7118883544306, -452.25639334011026, -73.37716063356366, -60.01731272279441, -111.73392340259512, -275.8457144175334, -145.31991400133714, -687.610337469678, -10.939659646341989, -95.1677308541187, -70.23136179875156, -1107.8247218929723, -1171.387655114585, -224.86985612925744, -428.9173192028488, -605.5046054565408, -128.88355008307946], "episode_lengths": [115, 37, 84, 65, 70, 79, 63, 64, 147, 68, 87, 150, 150, 43, 76, 44, 35, 81, 80, 90, 34, 150, 41, 37, 60, 150, 131, 62, 71, 76, 112, 42, 33, 42, 76, 150, 110, 129, 90, 75, 69, 88, 62, 79, 56, 91, 76, 131, 150, 73, 58, 80, 44, 60, 133, 75, 80, 63, 135, 47, 34, 150, 107, 83, 65, 78, 109, 90, 56, 66, 67, 61, 49, 63, 150, 49, 68, 83, 72, 62, 132, 150, 107, 150, 150, 69, 42, 74, 150, 97, 150, 35, 60, 61, 150, 150, 100, 121, 150, 80], "policy_policy_0_reward": [-336.5933045661795, -0.7500884931737966, -157.2058626187023, -61.0075927865108, -119.0736340336247, -144.32951697763514, -83.17927054512263, -86.31946247303881, -561.7376006937369, -101.04849377892822, -173.42566817452607, -407.1502357523354, -904.3904008892661, -54.41779118092352, -123.43952821150704, -26.801741928955277, -13.87909129845151, -147.35392485791965, -143.51885296608066, -164.87481498462716, -8.112639392852477, -473.97036485300856, -19.384741585144262, -18.739321656683515, -43.073644622984844, -461.17370049036487, -258.8089409868739, -75.37449946074973, -115.4626312766642, -125.5786755393461, -312.36137564045254, -30.343291732628813, -5.817119991446257, -5.625893802142498, -235.23387956494753, -784.5975072356224, -197.27088834939624, -444.1239516562665, -177.15486394112457, -148.0834070176381, -101.57207229407751, -134.5147624559249, -139.41424568436642, -156.69548871034027, -79.02162593504552, -228.20221784939812, -119.54344271494033, -321.5668042918839, -1397.3763820065562, -96.04582625654136, -68.73695625713108, -167.2837769127931, -18.119634346116086, -69.04009498355036, -375.16726049294294, -122.16666889233062, -134.57545111878704, -96.63413669205471, -380.871155755159, -22.478949289047044, 1.5709854710016409, -1120.8797248925, -255.51487059906682, -143.83894456436425, -109.72247714735306, -142.8902694307032, -214.0180527527667, -181.12030892185055, -63.97729366716568, -76.3748339695258, -93.08414121811506, -71.90743437341838, -84.5381515525377, -97.28827723550448, -983.0852953865189, -37.10568714380338, -103.1669194546585, -149.03356683670177, -129.12413807949883, -74.19424382654655, -328.5444097922488, -1047.13904354932, -242.80543181849563, -1163.7118883544306, -452.25639334011026, -73.37716063356366, -60.01731272279441, -111.73392340259512, -275.8457144175334, -145.31991400133714, -687.610337469678, -10.939659646341989, -95.1677308541187, -70.23136179875156, -1107.8247218929723, -1171.387655114585, -224.86985612925744, -428.9173192028488, -605.5046054565408, -128.88355008307946]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5621812905973446, "mean_inference_ms": 1.6996721787618612, "mean_action_processing_ms": 0.2747876704436102, "mean_env_wait_ms": 3.3834256052088434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012193441390991211, "StateBufferConnector_ms": 0.007896661758422852, "ViewRequirementAgentConnector_ms": 0.19210410118103027}, "num_episodes": 40, "episode_return_max": 1.5709854710016409, "episode_return_min": -1397.3763820065562, "episode_return_mean": -245.41196804208772, "episodes_this_iter": 40}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 333.2869607491071, "num_env_steps_trained_throughput_per_sec": 333.2869607491071, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 364000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 364000, "timers": {"training_iteration_time_ms": 12510.503, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12510.423, "sample_time_ms": 1093.06, "learn_time_ms": 11352.812, "learn_throughput": 352.336, "synch_weights_time_ms": 63.704}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "done": false, "training_iteration": 91, "trial_id": "b33d0_00000", "date": "2024-08-06_14-59-05", "timestamp": 1722936545, "time_this_iter_s": 12.015952110290527, "time_total_s": 1106.5473856925964, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c16b760>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1106.5473856925964, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 17.577777777777776, "ram_util_percent": 29.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 104.16991020639738, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 2.216890600696206, "policy_loss": -0.013394731108564883, "vf_loss": 2.2187526386231182, "vf_explained_var": 0.9760550066207846, "kl": 0.008168273807950755, "entropy": 0.8728758314624429, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 87840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 1.5709854710016409, "episode_reward_min": -1397.3763820065562, "episode_reward_mean": -249.17204693815313, "episode_len_mean": 88.68, "episode_media": {}, "episodes_timesteps_total": 8868, "policy_reward_min": {"policy_0": -1397.3763820065562}, "policy_reward_max": {"policy_0": 1.5709854710016409}, "policy_reward_mean": {"policy_0": -249.17204693815313}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-79.02162593504552, -228.20221784939812, -119.54344271494033, -321.5668042918839, -1397.3763820065562, -96.04582625654136, -68.73695625713108, -167.2837769127931, -18.119634346116086, -69.04009498355036, -375.16726049294294, -122.16666889233062, -134.57545111878704, -96.63413669205471, -380.871155755159, -22.478949289047044, 1.5709854710016409, -1120.8797248925, -255.51487059906682, -143.83894456436425, -109.72247714735306, -142.8902694307032, -214.0180527527667, -181.12030892185055, -63.97729366716568, -76.3748339695258, -93.08414121811506, -71.90743437341838, -84.5381515525377, -97.28827723550448, -983.0852953865189, -37.10568714380338, -103.1669194546585, -149.03356683670177, -129.12413807949883, -74.19424382654655, -328.5444097922488, -1047.13904354932, -242.80543181849563, -1163.7118883544306, -452.25639334011026, -73.37716063356366, -60.01731272279441, -111.73392340259512, -275.8457144175334, -145.31991400133714, -687.610337469678, -10.939659646341989, -95.1677308541187, -70.23136179875156, -1107.8247218929723, -1171.387655114585, -224.86985612925744, -428.9173192028488, -605.5046054565408, -128.88355008307946, -49.65603653335504, -9.742459883187799, -51.954625491097644, -79.6037069674016, -158.2780434898653, -128.7103506912653, -473.85867805714264, -104.65890670385348, -84.84550359852298, -2.7131209793419346, -42.45958621016401, -456.7278226607193, -175.59934535436838, -184.70547144076974, -234.9516741941712, -143.06038563676861, -70.57124437527767, -225.17951533364695, -40.576634614385114, -725.5873516571277, -214.7815244340822, -144.50674462060326, -128.08711031789636, -128.73411147843754, -124.49101371200878, -255.7918086697163, -55.12846185170396, -57.88479664881964, -368.492976018074, -1136.276706921649, -245.11131671335542, -26.24596546865502, -363.6609535020518, -54.52743233730604, -124.85224744280568, -12.928881265793045, -134.55249019295312, -186.8364349109897, -148.0642487427656, -0.8081404924538463, -111.86782200292677, -324.1236723833472, -424.64933756552983, -443.1480131924848], "episode_lengths": [56, 91, 76, 131, 150, 73, 58, 80, 44, 60, 133, 75, 80, 63, 135, 47, 34, 150, 107, 83, 65, 78, 109, 90, 56, 66, 67, 61, 49, 63, 150, 49, 68, 83, 72, 62, 132, 150, 107, 150, 150, 69, 42, 74, 150, 97, 150, 35, 60, 61, 150, 150, 100, 121, 150, 80, 51, 44, 60, 65, 85, 84, 150, 70, 65, 35, 56, 150, 105, 84, 97, 77, 65, 100, 50, 128, 112, 80, 76, 75, 75, 109, 61, 46, 150, 150, 108, 45, 150, 55, 69, 34, 74, 90, 81, 34, 82, 109, 140, 150], "policy_policy_0_reward": [-79.02162593504552, -228.20221784939812, -119.54344271494033, -321.5668042918839, -1397.3763820065562, -96.04582625654136, -68.73695625713108, -167.2837769127931, -18.119634346116086, -69.04009498355036, -375.16726049294294, -122.16666889233062, -134.57545111878704, -96.63413669205471, -380.871155755159, -22.478949289047044, 1.5709854710016409, -1120.8797248925, -255.51487059906682, -143.83894456436425, -109.72247714735306, -142.8902694307032, -214.0180527527667, -181.12030892185055, -63.97729366716568, -76.3748339695258, -93.08414121811506, -71.90743437341838, -84.5381515525377, -97.28827723550448, -983.0852953865189, -37.10568714380338, -103.1669194546585, -149.03356683670177, -129.12413807949883, -74.19424382654655, -328.5444097922488, -1047.13904354932, -242.80543181849563, -1163.7118883544306, -452.25639334011026, -73.37716063356366, -60.01731272279441, -111.73392340259512, -275.8457144175334, -145.31991400133714, -687.610337469678, -10.939659646341989, -95.1677308541187, -70.23136179875156, -1107.8247218929723, -1171.387655114585, -224.86985612925744, -428.9173192028488, -605.5046054565408, -128.88355008307946, -49.65603653335504, -9.742459883187799, -51.954625491097644, -79.6037069674016, -158.2780434898653, -128.7103506912653, -473.85867805714264, -104.65890670385348, -84.84550359852298, -2.7131209793419346, -42.45958621016401, -456.7278226607193, -175.59934535436838, -184.70547144076974, -234.9516741941712, -143.06038563676861, -70.57124437527767, -225.17951533364695, -40.576634614385114, -725.5873516571277, -214.7815244340822, -144.50674462060326, -128.08711031789636, -128.73411147843754, -124.49101371200878, -255.7918086697163, -55.12846185170396, -57.88479664881964, -368.492976018074, -1136.276706921649, -245.11131671335542, -26.24596546865502, -363.6609535020518, -54.52743233730604, -124.85224744280568, -12.928881265793045, -134.55249019295312, -186.8364349109897, -148.0642487427656, -0.8081404924538463, -111.86782200292677, -324.1236723833472, -424.64933756552983, -443.1480131924848]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5619663148423407, "mean_inference_ms": 1.698824729405893, "mean_action_processing_ms": 0.2748157708976199, "mean_env_wait_ms": 3.381662510869831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012122631072998047, "StateBufferConnector_ms": 0.00791621208190918, "ViewRequirementAgentConnector_ms": 0.19417405128479004}, "num_episodes": 44, "episode_return_max": 1.5709854710016409, "episode_return_min": -1397.3763820065562, "episode_return_mean": -249.17204693815313, "episodes_this_iter": 44}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.20261294865776, "num_env_steps_trained_throughput_per_sec": 303.20261294865776, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 12523.55, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12523.472, "sample_time_ms": 1100.958, "learn_time_ms": 11360.285, "learn_throughput": 352.104, "synch_weights_time_ms": 61.38}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 92, "trial_id": "b33d0_00000", "date": "2024-08-06_14-59-18", "timestamp": 1722936558, "time_this_iter_s": 13.203980922698975, "time_total_s": 1119.7513666152954, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c1d9240>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1119.7513666152954, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 17.84444444444445, "ram_util_percent": 29.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 116.1444685270389, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 2.6573373068124058, "policy_loss": -0.017410009537707084, "vf_loss": 2.658543998623888, "vf_explained_var": 0.9793112815047303, "kl": 0.011330326149376046, "entropy": 1.004619550642868, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 88800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "env_runners": {"episode_reward_max": -0.8081404924538463, "episode_reward_min": -1281.787290986625, "episode_reward_mean": -250.83728924177666, "episode_len_mean": 92.49, "episode_media": {}, "episodes_timesteps_total": 9249, "policy_reward_min": {"policy_0": -1281.787290986625}, "policy_reward_max": {"policy_0": -0.8081404924538463}, "policy_reward_mean": {"policy_0": -250.83728924177666}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-111.73392340259512, -275.8457144175334, -145.31991400133714, -687.610337469678, -10.939659646341989, -95.1677308541187, -70.23136179875156, -1107.8247218929723, -1171.387655114585, -224.86985612925744, -428.9173192028488, -605.5046054565408, -128.88355008307946, -49.65603653335504, -9.742459883187799, -51.954625491097644, -79.6037069674016, -158.2780434898653, -128.7103506912653, -473.85867805714264, -104.65890670385348, -84.84550359852298, -2.7131209793419346, -42.45958621016401, -456.7278226607193, -175.59934535436838, -184.70547144076974, -234.9516741941712, -143.06038563676861, -70.57124437527767, -225.17951533364695, -40.576634614385114, -725.5873516571277, -214.7815244340822, -144.50674462060326, -128.08711031789636, -128.73411147843754, -124.49101371200878, -255.7918086697163, -55.12846185170396, -57.88479664881964, -368.492976018074, -1136.276706921649, -245.11131671335542, -26.24596546865502, -363.6609535020518, -54.52743233730604, -124.85224744280568, -12.928881265793045, -134.55249019295312, -186.8364349109897, -148.0642487427656, -0.8081404924538463, -111.86782200292677, -324.1236723833472, -424.64933756552983, -443.1480131924848, -306.26971790431884, -149.53217850546105, -86.11011769072783, -441.50380118042705, -644.372573677849, -118.59469763129363, -76.29747061491065, -387.5834874309535, -287.97580544625475, -98.23348010246279, -18.648361923987547, -18.613232823889437, -190.0693242002267, -356.9826616682504, -661.1272781146599, -539.3773316920491, -186.67568990860892, -1113.1917764993148, -51.56953005616641, -18.299032118638905, -382.4032063581591, -217.0549772483769, -211.93483649357415, -16.147732616861866, -127.32138347084906, -82.48493384772864, -81.09443338957814, -1037.043022302786, -69.23848969804274, -1281.787290986625, -72.69291171241802, -289.63016548864204, -145.89299080279625, -360.31783748304986, -6.8768034917297705, -201.9278384351349, -74.65525877109444, -161.93582317910057, -353.0562270653393, -47.352249220975835, -28.709330461374446, -22.77919709472858, -337.135411139772], "episode_lengths": [74, 150, 97, 150, 35, 60, 61, 150, 150, 100, 121, 150, 80, 51, 44, 60, 65, 85, 84, 150, 70, 65, 35, 56, 150, 105, 84, 97, 77, 65, 100, 50, 128, 112, 80, 76, 75, 75, 109, 61, 46, 150, 150, 108, 45, 150, 55, 69, 34, 74, 90, 81, 34, 82, 109, 140, 150, 108, 87, 65, 150, 150, 75, 67, 150, 116, 65, 37, 45, 99, 150, 150, 142, 83, 150, 46, 47, 150, 111, 100, 46, 83, 64, 60, 150, 61, 150, 71, 150, 79, 150, 43, 91, 66, 87, 145, 47, 55, 42, 112], "policy_policy_0_reward": [-111.73392340259512, -275.8457144175334, -145.31991400133714, -687.610337469678, -10.939659646341989, -95.1677308541187, -70.23136179875156, -1107.8247218929723, -1171.387655114585, -224.86985612925744, -428.9173192028488, -605.5046054565408, -128.88355008307946, -49.65603653335504, -9.742459883187799, -51.954625491097644, -79.6037069674016, -158.2780434898653, -128.7103506912653, -473.85867805714264, -104.65890670385348, -84.84550359852298, -2.7131209793419346, -42.45958621016401, -456.7278226607193, -175.59934535436838, -184.70547144076974, -234.9516741941712, -143.06038563676861, -70.57124437527767, -225.17951533364695, -40.576634614385114, -725.5873516571277, -214.7815244340822, -144.50674462060326, -128.08711031789636, -128.73411147843754, -124.49101371200878, -255.7918086697163, -55.12846185170396, -57.88479664881964, -368.492976018074, -1136.276706921649, -245.11131671335542, -26.24596546865502, -363.6609535020518, -54.52743233730604, -124.85224744280568, -12.928881265793045, -134.55249019295312, -186.8364349109897, -148.0642487427656, -0.8081404924538463, -111.86782200292677, -324.1236723833472, -424.64933756552983, -443.1480131924848, -306.26971790431884, -149.53217850546105, -86.11011769072783, -441.50380118042705, -644.372573677849, -118.59469763129363, -76.29747061491065, -387.5834874309535, -287.97580544625475, -98.23348010246279, -18.648361923987547, -18.613232823889437, -190.0693242002267, -356.9826616682504, -661.1272781146599, -539.3773316920491, -186.67568990860892, -1113.1917764993148, -51.56953005616641, -18.299032118638905, -382.4032063581591, -217.0549772483769, -211.93483649357415, -16.147732616861866, -127.32138347084906, -82.48493384772864, -81.09443338957814, -1037.043022302786, -69.23848969804274, -1281.787290986625, -72.69291171241802, -289.63016548864204, -145.89299080279625, -360.31783748304986, -6.8768034917297705, -201.9278384351349, -74.65525877109444, -161.93582317910057, -353.0562270653393, -47.352249220975835, -28.709330461374446, -22.77919709472858, -337.135411139772]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5620135232996063, "mean_inference_ms": 1.6988784529537468, "mean_action_processing_ms": 0.2750016883466266, "mean_env_wait_ms": 3.3828576298911037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012105941772460938, "StateBufferConnector_ms": 0.008005142211914062, "ViewRequirementAgentConnector_ms": 0.19836139678955078}, "num_episodes": 43, "episode_return_max": -0.8081404924538463, "episode_return_min": -1281.787290986625, "episode_return_mean": -250.83728924177666, "episodes_this_iter": 43}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.28208913831213, "num_env_steps_trained_throughput_per_sec": 309.28208913831213, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 372000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 12561.395, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12561.316, "sample_time_ms": 1104.742, "learn_time_ms": 11393.574, "learn_throughput": 351.075, "synch_weights_time_ms": 62.151}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "training_iteration": 93, "trial_id": "b33d0_00000", "date": "2024-08-06_14-59-31", "timestamp": 1722936571, "time_this_iter_s": 12.945099353790283, "time_total_s": 1132.6964659690857, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c1d9ea0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1132.6964659690857, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 17.184210526315788, "ram_util_percent": 29.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 103.14000329772631, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 1.9206108987952273, "policy_loss": -0.011672895977487012, "vf_loss": 1.9227548101296028, "vf_explained_var": 0.9792866963893175, "kl": 0.006912749308473091, "entropy": 0.9697559424055119, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 89760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "env_runners": {"episode_reward_max": -0.3404008972209893, "episode_reward_min": -1281.787290986625, "episode_reward_mean": -230.00677432292304, "episode_len_mean": 88.98, "episode_media": {}, "episodes_timesteps_total": 8898, "policy_reward_min": {"policy_0": -1281.787290986625}, "policy_reward_max": {"policy_0": -0.3404008972209893}, "policy_reward_mean": {"policy_0": -230.00677432292304}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-124.85224744280568, -12.928881265793045, -134.55249019295312, -186.8364349109897, -148.0642487427656, -0.8081404924538463, -111.86782200292677, -324.1236723833472, -424.64933756552983, -443.1480131924848, -306.26971790431884, -149.53217850546105, -86.11011769072783, -441.50380118042705, -644.372573677849, -118.59469763129363, -76.29747061491065, -387.5834874309535, -287.97580544625475, -98.23348010246279, -18.648361923987547, -18.613232823889437, -190.0693242002267, -356.9826616682504, -661.1272781146599, -539.3773316920491, -186.67568990860892, -1113.1917764993148, -51.56953005616641, -18.299032118638905, -382.4032063581591, -217.0549772483769, -211.93483649357415, -16.147732616861866, -127.32138347084906, -82.48493384772864, -81.09443338957814, -1037.043022302786, -69.23848969804274, -1281.787290986625, -72.69291171241802, -289.63016548864204, -145.89299080279625, -360.31783748304986, -6.8768034917297705, -201.9278384351349, -74.65525877109444, -161.93582317910057, -353.0562270653393, -47.352249220975835, -28.709330461374446, -22.77919709472858, -337.135411139772, -1007.2202819570796, -1116.9405726438304, -166.57359651984365, -107.94148048761384, -130.71486582035163, -59.20959363429025, -60.23368936827579, -135.09033766134934, -166.4320418392615, -209.25287597806675, -76.7848138543476, -316.7950023676621, -98.77457791080316, -350.9293231510891, -78.18664834041651, -293.8507909114194, -87.8826842228994, -280.67296382861696, -149.90764538531428, -0.3404008972209893, -218.60238454483985, -33.08613718333046, -71.38001594716727, -80.24951679649158, -230.35952386340998, -2.6871421984610375, -166.62091187248876, -53.332792815733804, -105.75427744727062, -15.752396090207254, -258.5742401037825, -96.22694242103265, -180.8663433260791, -117.69304277681391, -172.84216050812307, -1042.8963871065937, -169.14183997880824, -106.49262101597445, -105.05473825235022, -579.0073264818209, -247.06556679082294, -115.82120957556513, -59.103727861267586, -375.76236068426044, -144.12258580428082, -17.423123414475455, -68.69274250986574], "episode_lengths": [69, 34, 74, 90, 81, 34, 82, 109, 140, 150, 108, 87, 65, 150, 150, 75, 67, 150, 116, 65, 37, 45, 99, 150, 150, 142, 83, 150, 46, 47, 150, 111, 100, 46, 83, 64, 60, 150, 61, 150, 71, 150, 79, 150, 43, 91, 66, 87, 145, 47, 55, 42, 112, 150, 150, 82, 77, 74, 51, 57, 76, 82, 117, 69, 131, 65, 122, 61, 89, 55, 115, 82, 31, 102, 47, 68, 63, 128, 32, 94, 61, 76, 36, 113, 54, 109, 74, 79, 150, 82, 80, 68, 114, 115, 77, 46, 150, 77, 45, 64], "policy_policy_0_reward": [-124.85224744280568, -12.928881265793045, -134.55249019295312, -186.8364349109897, -148.0642487427656, -0.8081404924538463, -111.86782200292677, -324.1236723833472, -424.64933756552983, -443.1480131924848, -306.26971790431884, -149.53217850546105, -86.11011769072783, -441.50380118042705, -644.372573677849, -118.59469763129363, -76.29747061491065, -387.5834874309535, -287.97580544625475, -98.23348010246279, -18.648361923987547, -18.613232823889437, -190.0693242002267, -356.9826616682504, -661.1272781146599, -539.3773316920491, -186.67568990860892, -1113.1917764993148, -51.56953005616641, -18.299032118638905, -382.4032063581591, -217.0549772483769, -211.93483649357415, -16.147732616861866, -127.32138347084906, -82.48493384772864, -81.09443338957814, -1037.043022302786, -69.23848969804274, -1281.787290986625, -72.69291171241802, -289.63016548864204, -145.89299080279625, -360.31783748304986, -6.8768034917297705, -201.9278384351349, -74.65525877109444, -161.93582317910057, -353.0562270653393, -47.352249220975835, -28.709330461374446, -22.77919709472858, -337.135411139772, -1007.2202819570796, -1116.9405726438304, -166.57359651984365, -107.94148048761384, -130.71486582035163, -59.20959363429025, -60.23368936827579, -135.09033766134934, -166.4320418392615, -209.25287597806675, -76.7848138543476, -316.7950023676621, -98.77457791080316, -350.9293231510891, -78.18664834041651, -293.8507909114194, -87.8826842228994, -280.67296382861696, -149.90764538531428, -0.3404008972209893, -218.60238454483985, -33.08613718333046, -71.38001594716727, -80.24951679649158, -230.35952386340998, -2.6871421984610375, -166.62091187248876, -53.332792815733804, -105.75427744727062, -15.752396090207254, -258.5742401037825, -96.22694242103265, -180.8663433260791, -117.69304277681391, -172.84216050812307, -1042.8963871065937, -169.14183997880824, -106.49262101597445, -105.05473825235022, -579.0073264818209, -247.06556679082294, -115.82120957556513, -59.103727861267586, -375.76236068426044, -144.12258580428082, -17.423123414475455, -68.69274250986574]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5623526909119877, "mean_inference_ms": 1.6989752390119188, "mean_action_processing_ms": 0.2750235243102097, "mean_env_wait_ms": 3.384211036249841, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012154102325439453, "StateBufferConnector_ms": 0.008145570755004883, "ViewRequirementAgentConnector_ms": 0.2009429931640625}, "num_episodes": 47, "episode_return_max": -0.3404008972209893, "episode_return_min": -1281.787290986625, "episode_return_mean": -230.00677432292304, "episodes_this_iter": 47}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.8499910082073, "num_env_steps_trained_throughput_per_sec": 319.8499910082073, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 376000, "timers": {"training_iteration_time_ms": 12551.64, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12551.563, "sample_time_ms": 1105.522, "learn_time_ms": 11382.831, "learn_throughput": 351.406, "synch_weights_time_ms": 62.394}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "done": false, "training_iteration": 94, "trial_id": "b33d0_00000", "date": "2024-08-06_14-59-44", "timestamp": 1722936584, "time_this_iter_s": 12.5184907913208, "time_total_s": 1145.2149567604065, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c2aae60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1145.2149567604065, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 17.577777777777776, "ram_util_percent": 29.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 118.19431701799233, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 1.9030585101495185, "policy_loss": -0.006241626309444351, "vf_loss": 1.899521732951204, "vf_explained_var": 0.974728403116266, "kl": 0.007105127236172941, "entropy": 1.0125049418459335, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 90720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "env_runners": {"episode_reward_max": 0.11687226732647504, "episode_reward_min": -1173.3465883401027, "episode_reward_mean": -215.5430112062942, "episode_len_mean": 82.76, "episode_media": {}, "episodes_timesteps_total": 8276, "policy_reward_min": {"policy_0": -1173.3465883401027}, "policy_reward_max": {"policy_0": 0.11687226732647504}, "policy_reward_mean": {"policy_0": -215.5430112062942}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-337.135411139772, -1007.2202819570796, -1116.9405726438304, -166.57359651984365, -107.94148048761384, -130.71486582035163, -59.20959363429025, -60.23368936827579, -135.09033766134934, -166.4320418392615, -209.25287597806675, -76.7848138543476, -316.7950023676621, -98.77457791080316, -350.9293231510891, -78.18664834041651, -293.8507909114194, -87.8826842228994, -280.67296382861696, -149.90764538531428, -0.3404008972209893, -218.60238454483985, -33.08613718333046, -71.38001594716727, -80.24951679649158, -230.35952386340998, -2.6871421984610375, -166.62091187248876, -53.332792815733804, -105.75427744727062, -15.752396090207254, -258.5742401037825, -96.22694242103265, -180.8663433260791, -117.69304277681391, -172.84216050812307, -1042.8963871065937, -169.14183997880824, -106.49262101597445, -105.05473825235022, -579.0073264818209, -247.06556679082294, -115.82120957556513, -59.103727861267586, -375.76236068426044, -144.12258580428082, -17.423123414475455, -68.69274250986574, -53.58152225534556, -175.01621271514117, -893.7400819601079, -56.469898280698295, -55.96763093422441, -1173.3465883401027, -178.75948375104903, -1022.3802174400162, -267.41222806661716, -781.6330214755666, -1105.8648196712, -52.08416572682771, -60.87945709525926, -17.001641982791035, -64.32291963742051, -528.9360554415468, -31.38096547382239, -62.91283971310337, -7.2104868023844215, -66.42333200857503, -70.72183203377269, -130.51797578937737, -112.83233537125389, -31.435597501685816, -142.56807776879046, -266.89149073065386, -234.0860281879597, -194.2907607852237, -271.5400883710578, -73.01467815431653, -173.07319940305385, -281.64416776189404, -63.363454698693594, -100.13861896779191, -124.03818982741187, -142.29843424068582, -45.92804804837128, -49.70520781801317, -3.9103163746643057, -159.1850682056179, -167.9528539349707, -49.6617045957903, -66.22636352370716, -181.31874162532995, 0.11687226732647504, -237.61247972972862, -308.0838544249645, -318.6412722737044, -432.60528947145207, -173.17756115591274, -66.70267073528481, -160.44640732297276], "episode_lengths": [112, 150, 150, 82, 77, 74, 51, 57, 76, 82, 117, 69, 131, 65, 122, 61, 89, 55, 115, 82, 31, 102, 47, 68, 63, 128, 32, 94, 61, 76, 36, 113, 54, 109, 74, 79, 150, 82, 80, 68, 114, 115, 77, 46, 150, 77, 45, 64, 59, 87, 147, 53, 49, 150, 85, 150, 107, 150, 150, 56, 59, 45, 60, 105, 47, 63, 38, 65, 55, 88, 69, 52, 82, 114, 105, 88, 103, 67, 82, 105, 63, 63, 71, 81, 45, 39, 36, 85, 77, 57, 60, 79, 34, 105, 116, 129, 120, 80, 58, 91], "policy_policy_0_reward": [-337.135411139772, -1007.2202819570796, -1116.9405726438304, -166.57359651984365, -107.94148048761384, -130.71486582035163, -59.20959363429025, -60.23368936827579, -135.09033766134934, -166.4320418392615, -209.25287597806675, -76.7848138543476, -316.7950023676621, -98.77457791080316, -350.9293231510891, -78.18664834041651, -293.8507909114194, -87.8826842228994, -280.67296382861696, -149.90764538531428, -0.3404008972209893, -218.60238454483985, -33.08613718333046, -71.38001594716727, -80.24951679649158, -230.35952386340998, -2.6871421984610375, -166.62091187248876, -53.332792815733804, -105.75427744727062, -15.752396090207254, -258.5742401037825, -96.22694242103265, -180.8663433260791, -117.69304277681391, -172.84216050812307, -1042.8963871065937, -169.14183997880824, -106.49262101597445, -105.05473825235022, -579.0073264818209, -247.06556679082294, -115.82120957556513, -59.103727861267586, -375.76236068426044, -144.12258580428082, -17.423123414475455, -68.69274250986574, -53.58152225534556, -175.01621271514117, -893.7400819601079, -56.469898280698295, -55.96763093422441, -1173.3465883401027, -178.75948375104903, -1022.3802174400162, -267.41222806661716, -781.6330214755666, -1105.8648196712, -52.08416572682771, -60.87945709525926, -17.001641982791035, -64.32291963742051, -528.9360554415468, -31.38096547382239, -62.91283971310337, -7.2104868023844215, -66.42333200857503, -70.72183203377269, -130.51797578937737, -112.83233537125389, -31.435597501685816, -142.56807776879046, -266.89149073065386, -234.0860281879597, -194.2907607852237, -271.5400883710578, -73.01467815431653, -173.07319940305385, -281.64416776189404, -63.363454698693594, -100.13861896779191, -124.03818982741187, -142.29843424068582, -45.92804804837128, -49.70520781801317, -3.9103163746643057, -159.1850682056179, -167.9528539349707, -49.6617045957903, -66.22636352370716, -181.31874162532995, 0.11687226732647504, -237.61247972972862, -308.0838544249645, -318.6412722737044, -432.60528947145207, -173.17756115591274, -66.70267073528481, -160.44640732297276]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5621642610975228, "mean_inference_ms": 1.6992944913211532, "mean_action_processing_ms": 0.2748199818270774, "mean_env_wait_ms": 3.3832862878469667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012112617492675781, "StateBufferConnector_ms": 0.00818777084350586, "ViewRequirementAgentConnector_ms": 0.1997215747833252}, "num_episodes": 52, "episode_return_max": 0.11687226732647504, "episode_return_min": -1173.3465883401027, "episode_return_mean": -215.5430112062942, "episodes_this_iter": 52}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.97074366846726, "num_env_steps_trained_throughput_per_sec": 311.97074366846726, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 380000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 380000, "timers": {"training_iteration_time_ms": 12500.738, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12500.66, "sample_time_ms": 1109.054, "learn_time_ms": 11327.618, "learn_throughput": 353.119, "synch_weights_time_ms": 63.139}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "done": false, "training_iteration": 95, "trial_id": "b33d0_00000", "date": "2024-08-06_14-59-57", "timestamp": 1722936597, "time_this_iter_s": 12.833858013153076, "time_total_s": 1158.0488147735596, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c169a20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1158.0488147735596, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 17.772222222222226, "ram_util_percent": 29.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 79.25981056392193, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 1.794444925741603, "policy_loss": -0.01625882375034659, "vf_loss": 1.7934078953228891, "vf_explained_var": 0.9955190460508069, "kl": 0.011894627625891569, "entropy": 0.7691173701236645, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 91680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 0.11687226732647504, "episode_reward_min": -1303.8580307398995, "episode_reward_mean": -210.39892580002052, "episode_len_mean": 81.81, "episode_media": {}, "episodes_timesteps_total": 8181, "policy_reward_min": {"policy_0": -1303.8580307398995}, "policy_reward_max": {"policy_0": 0.11687226732647504}, "policy_reward_mean": {"policy_0": -210.39892580002052}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56.469898280698295, -55.96763093422441, -1173.3465883401027, -178.75948375104903, -1022.3802174400162, -267.41222806661716, -781.6330214755666, -1105.8648196712, -52.08416572682771, -60.87945709525926, -17.001641982791035, -64.32291963742051, -528.9360554415468, -31.38096547382239, -62.91283971310337, -7.2104868023844215, -66.42333200857503, -70.72183203377269, -130.51797578937737, -112.83233537125389, -31.435597501685816, -142.56807776879046, -266.89149073065386, -234.0860281879597, -194.2907607852237, -271.5400883710578, -73.01467815431653, -173.07319940305385, -281.64416776189404, -63.363454698693594, -100.13861896779191, -124.03818982741187, -142.29843424068582, -45.92804804837128, -49.70520781801317, -3.9103163746643057, -159.1850682056179, -167.9528539349707, -49.6617045957903, -66.22636352370716, -181.31874162532995, 0.11687226732647504, -237.61247972972862, -308.0838544249645, -318.6412722737044, -432.60528947145207, -173.17756115591274, -66.70267073528481, -160.44640732297276, -230.1227281839799, -49.43542172073244, -186.74532795109673, -230.50957766956282, -138.16959727174432, -947.606078601224, -529.5724027109005, -158.9600018188812, -103.67192820805681, -137.003783377924, -407.6591917530214, -110.45467872734916, -34.91872685474754, -52.92257996612028, -222.0658192230625, -138.90878510182424, -100.89855527816518, -198.16529809529354, -64.09318476992922, -235.18603293772398, -90.61250376538301, -187.94532472230205, -74.48946005141002, -157.96751507443477, -28.062604345164107, -191.7617039230191, -305.2238561071339, -1252.0416115063178, -92.0278315968631, -132.4291194706389, -47.15024951896388, -16.601606371710297, -15.88879498579887, -130.87469567774534, -428.89197323728877, -121.85575468613959, -185.1356285799023, -19.772997842189124, -126.06652142879892, -1303.8580307398995, -44.52070923918011, -139.3479663168344, -198.1779699136307, -126.65972292489836, -76.72143734057877, -147.18866329180423, -420.2800063694163, -88.20715722652147, -120.93690229888438, -43.27916431582734, -82.36374850404906], "episode_lengths": [53, 49, 150, 85, 150, 107, 150, 150, 56, 59, 45, 60, 105, 47, 63, 38, 65, 55, 88, 69, 52, 82, 114, 105, 88, 103, 67, 82, 105, 63, 63, 71, 81, 45, 39, 36, 85, 77, 57, 60, 79, 34, 105, 116, 129, 120, 80, 58, 91, 100, 54, 62, 106, 78, 150, 146, 97, 72, 100, 121, 64, 55, 53, 85, 74, 71, 117, 57, 120, 64, 89, 59, 89, 50, 89, 120, 150, 67, 77, 56, 39, 38, 76, 140, 77, 92, 46, 82, 150, 50, 74, 93, 73, 53, 75, 141, 66, 73, 54, 66], "policy_policy_0_reward": [-56.469898280698295, -55.96763093422441, -1173.3465883401027, -178.75948375104903, -1022.3802174400162, -267.41222806661716, -781.6330214755666, -1105.8648196712, -52.08416572682771, -60.87945709525926, -17.001641982791035, -64.32291963742051, -528.9360554415468, -31.38096547382239, -62.91283971310337, -7.2104868023844215, -66.42333200857503, -70.72183203377269, -130.51797578937737, -112.83233537125389, -31.435597501685816, -142.56807776879046, -266.89149073065386, -234.0860281879597, -194.2907607852237, -271.5400883710578, -73.01467815431653, -173.07319940305385, -281.64416776189404, -63.363454698693594, -100.13861896779191, -124.03818982741187, -142.29843424068582, -45.92804804837128, -49.70520781801317, -3.9103163746643057, -159.1850682056179, -167.9528539349707, -49.6617045957903, -66.22636352370716, -181.31874162532995, 0.11687226732647504, -237.61247972972862, -308.0838544249645, -318.6412722737044, -432.60528947145207, -173.17756115591274, -66.70267073528481, -160.44640732297276, -230.1227281839799, -49.43542172073244, -186.74532795109673, -230.50957766956282, -138.16959727174432, -947.606078601224, -529.5724027109005, -158.9600018188812, -103.67192820805681, -137.003783377924, -407.6591917530214, -110.45467872734916, -34.91872685474754, -52.92257996612028, -222.0658192230625, -138.90878510182424, -100.89855527816518, -198.16529809529354, -64.09318476992922, -235.18603293772398, -90.61250376538301, -187.94532472230205, -74.48946005141002, -157.96751507443477, -28.062604345164107, -191.7617039230191, -305.2238561071339, -1252.0416115063178, -92.0278315968631, -132.4291194706389, -47.15024951896388, -16.601606371710297, -15.88879498579887, -130.87469567774534, -428.89197323728877, -121.85575468613959, -185.1356285799023, -19.772997842189124, -126.06652142879892, -1303.8580307398995, -44.52070923918011, -139.3479663168344, -198.1779699136307, -126.65972292489836, -76.72143734057877, -147.18866329180423, -420.2800063694163, -88.20715722652147, -120.93690229888438, -43.27916431582734, -82.36374850404906]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5623966939826185, "mean_inference_ms": 1.6982105807760959, "mean_action_processing_ms": 0.27479014683787023, "mean_env_wait_ms": 3.3806601964062706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012000322341918945, "StateBufferConnector_ms": 0.007931232452392578, "ViewRequirementAgentConnector_ms": 0.19258403778076172}, "num_episodes": 51, "episode_return_max": 0.11687226732647504, "episode_return_min": -1303.8580307398995, "episode_return_mean": -210.39892580002052, "episodes_this_iter": 51}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 322.507136702512, "num_env_steps_trained_throughput_per_sec": 322.507136702512, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 12527.014, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12526.936, "sample_time_ms": 1112.389, "learn_time_ms": 11349.509, "learn_throughput": 352.438, "synch_weights_time_ms": 64.172}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 96, "trial_id": "b33d0_00000", "date": "2024-08-06_15-00-09", "timestamp": 1722936609, "time_this_iter_s": 12.415192365646362, "time_total_s": 1170.464007139206, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c1d96c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1170.464007139206, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 17.766666666666666, "ram_util_percent": 29.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 108.77237983345985, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 1.8957849045128872, "policy_loss": -0.019685175768002713, "vf_loss": 1.8997744659582774, "vf_explained_var": 0.9905230132862926, "kl": 0.010810396944665105, "entropy": 0.722678602890422, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 92640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "env_runners": {"episode_reward_max": -10.544554227854329, "episode_reward_min": -1303.8580307398995, "episode_reward_mean": -199.6147216070771, "episode_len_mean": 84.42, "episode_media": {}, "episodes_timesteps_total": 8442, "policy_reward_min": {"policy_0": -1303.8580307398995}, "policy_reward_max": {"policy_0": -10.544554227854329}, "policy_reward_mean": {"policy_0": -199.6147216070771}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-308.0838544249645, -318.6412722737044, -432.60528947145207, -173.17756115591274, -66.70267073528481, -160.44640732297276, -230.1227281839799, -49.43542172073244, -186.74532795109673, -230.50957766956282, -138.16959727174432, -947.606078601224, -529.5724027109005, -158.9600018188812, -103.67192820805681, -137.003783377924, -407.6591917530214, -110.45467872734916, -34.91872685474754, -52.92257996612028, -222.0658192230625, -138.90878510182424, -100.89855527816518, -198.16529809529354, -64.09318476992922, -235.18603293772398, -90.61250376538301, -187.94532472230205, -74.48946005141002, -157.96751507443477, -28.062604345164107, -191.7617039230191, -305.2238561071339, -1252.0416115063178, -92.0278315968631, -132.4291194706389, -47.15024951896388, -16.601606371710297, -15.88879498579887, -130.87469567774534, -428.89197323728877, -121.85575468613959, -185.1356285799023, -19.772997842189124, -126.06652142879892, -1303.8580307398995, -44.52070923918011, -139.3479663168344, -198.1779699136307, -126.65972292489836, -76.72143734057877, -147.18866329180423, -420.2800063694163, -88.20715722652147, -120.93690229888438, -43.27916431582734, -82.36374850404906, -49.77654547219973, -37.40124299382016, -54.90253732429299, -223.20981426111987, -78.71257634269483, -123.30150531109061, -10.544554227854329, -65.80069347248876, -41.94815809897083, -75.87600455308346, -39.46240950867225, -46.38527716649928, -41.224586475719214, -40.797860994635315, -254.6200552960493, -71.09926509471622, -41.02104112519972, -118.49229154376378, -249.63900491040314, -205.4165641232229, -153.6459991364394, -214.71452560251544, -343.6425701306203, -738.5491234495269, -545.2831852213774, -388.2324109443308, -228.1195150863531, -295.4256402896978, -131.45975368359785, -189.3832539393395, -32.81784054047494, -136.26720869332044, -163.262379304237, -86.18449032706881, -206.51578321105106, -30.16326379080051, -113.90687708797401, -122.4128117930551, -943.8892304317333, -23.978087593848276, -91.15937274167781, -89.04647902562847, -690.7123834081822], "episode_lengths": [116, 129, 120, 80, 58, 91, 100, 54, 62, 106, 78, 150, 146, 97, 72, 100, 121, 64, 55, 53, 85, 74, 71, 117, 57, 120, 64, 89, 59, 89, 50, 89, 120, 150, 67, 77, 56, 39, 38, 76, 140, 77, 92, 46, 82, 150, 50, 74, 93, 73, 53, 75, 141, 66, 73, 54, 66, 49, 42, 54, 93, 58, 75, 39, 65, 46, 62, 42, 54, 57, 61, 150, 67, 50, 74, 111, 90, 80, 115, 150, 150, 150, 150, 111, 125, 75, 90, 50, 79, 89, 71, 93, 41, 73, 78, 150, 50, 64, 75, 150], "policy_policy_0_reward": [-308.0838544249645, -318.6412722737044, -432.60528947145207, -173.17756115591274, -66.70267073528481, -160.44640732297276, -230.1227281839799, -49.43542172073244, -186.74532795109673, -230.50957766956282, -138.16959727174432, -947.606078601224, -529.5724027109005, -158.9600018188812, -103.67192820805681, -137.003783377924, -407.6591917530214, -110.45467872734916, -34.91872685474754, -52.92257996612028, -222.0658192230625, -138.90878510182424, -100.89855527816518, -198.16529809529354, -64.09318476992922, -235.18603293772398, -90.61250376538301, -187.94532472230205, -74.48946005141002, -157.96751507443477, -28.062604345164107, -191.7617039230191, -305.2238561071339, -1252.0416115063178, -92.0278315968631, -132.4291194706389, -47.15024951896388, -16.601606371710297, -15.88879498579887, -130.87469567774534, -428.89197323728877, -121.85575468613959, -185.1356285799023, -19.772997842189124, -126.06652142879892, -1303.8580307398995, -44.52070923918011, -139.3479663168344, -198.1779699136307, -126.65972292489836, -76.72143734057877, -147.18866329180423, -420.2800063694163, -88.20715722652147, -120.93690229888438, -43.27916431582734, -82.36374850404906, -49.77654547219973, -37.40124299382016, -54.90253732429299, -223.20981426111987, -78.71257634269483, -123.30150531109061, -10.544554227854329, -65.80069347248876, -41.94815809897083, -75.87600455308346, -39.46240950867225, -46.38527716649928, -41.224586475719214, -40.797860994635315, -254.6200552960493, -71.09926509471622, -41.02104112519972, -118.49229154376378, -249.63900491040314, -205.4165641232229, -153.6459991364394, -214.71452560251544, -343.6425701306203, -738.5491234495269, -545.2831852213774, -388.2324109443308, -228.1195150863531, -295.4256402896978, -131.45975368359785, -189.3832539393395, -32.81784054047494, -136.26720869332044, -163.262379304237, -86.18449032706881, -206.51578321105106, -30.16326379080051, -113.90687708797401, -122.4128117930551, -943.8892304317333, -23.978087593848276, -91.15937274167781, -89.04647902562847, -690.7123834081822]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5625622973678595, "mean_inference_ms": 1.697287682183533, "mean_action_processing_ms": 0.2748128439641656, "mean_env_wait_ms": 3.378637641329422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012085199356079102, "StateBufferConnector_ms": 0.008045196533203125, "ViewRequirementAgentConnector_ms": 0.19149279594421387}, "num_episodes": 43, "episode_return_max": -10.544554227854329, "episode_return_min": -1303.8580307398995, "episode_return_mean": -199.6147216070771, "episodes_this_iter": 43}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 419.2289814358691, "num_env_steps_trained_throughput_per_sec": 419.2289814358691, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 388000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 388000, "timers": {"training_iteration_time_ms": 12197.467, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12197.393, "sample_time_ms": 1112.572, "learn_time_ms": 11020.49, "learn_throughput": 362.96, "synch_weights_time_ms": 63.469}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "done": false, "training_iteration": 97, "trial_id": "b33d0_00000", "date": "2024-08-06_15-00-19", "timestamp": 1722936619, "time_this_iter_s": 9.552635192871094, "time_total_s": 1180.016642332077, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c1d9c60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1180.016642332077, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 20.438461538461542, "ram_util_percent": 29.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 105.76456679900487, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 2.473982590374847, "policy_loss": -0.015059968973218929, "vf_loss": 2.469718015938997, "vf_explained_var": 0.9873276457190514, "kl": 0.013248986701546528, "entropy": 0.7973505456311007, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 93600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "env_runners": {"episode_reward_max": -9.843907155224903, "episode_reward_min": -1303.8580307398995, "episode_reward_mean": -201.78155595732173, "episode_len_mean": 84.36, "episode_media": {}, "episodes_timesteps_total": 8436, "policy_reward_min": {"policy_0": -1303.8580307398995}, "policy_reward_max": {"policy_0": -9.843907155224903}, "policy_reward_mean": {"policy_0": -201.78155595732173}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1303.8580307398995, -44.52070923918011, -139.3479663168344, -198.1779699136307, -126.65972292489836, -76.72143734057877, -147.18866329180423, -420.2800063694163, -88.20715722652147, -120.93690229888438, -43.27916431582734, -82.36374850404906, -49.77654547219973, -37.40124299382016, -54.90253732429299, -223.20981426111987, -78.71257634269483, -123.30150531109061, -10.544554227854329, -65.80069347248876, -41.94815809897083, -75.87600455308346, -39.46240950867225, -46.38527716649928, -41.224586475719214, -40.797860994635315, -254.6200552960493, -71.09926509471622, -41.02104112519972, -118.49229154376378, -249.63900491040314, -205.4165641232229, -153.6459991364394, -214.71452560251544, -343.6425701306203, -738.5491234495269, -545.2831852213774, -388.2324109443308, -228.1195150863531, -295.4256402896978, -131.45975368359785, -189.3832539393395, -32.81784054047494, -136.26720869332044, -163.262379304237, -86.18449032706881, -206.51578321105106, -30.16326379080051, -113.90687708797401, -122.4128117930551, -943.8892304317333, -23.978087593848276, -91.15937274167781, -89.04647902562847, -690.7123834081822, -429.7430246350066, -50.340780139326675, -45.430819987875495, -116.9291671355815, -486.54276026619124, -34.75918684887503, -298.46615477677517, -16.8920852427967, -40.625393732952, -145.2876812518821, -446.50691377913114, -334.3337727034525, -16.3207240912034, -280.09054956069457, -115.72963946548509, -967.675607624165, -80.31831158740137, -51.40750537031721, -294.28562585984525, -18.459119621457003, -155.04857593791328, -18.55088779760296, -53.950453132509026, -120.2288026710092, -73.04395505860843, -270.41508893963385, -79.90982865157872, -165.99748220492316, -9.843907155224903, -159.53957322521393, -225.26276016363846, -849.5157008980046, -110.40157018512724, -226.22980585234265, -37.79696312034473, -473.0186179873637, -52.37942766562233, -30.73844135670351, -185.32387084366832, -27.2318118357107, -29.12861947560363, -1004.1881130634731, -280.25867085480274, -566.8348414599395, -83.22735030432156], "episode_lengths": [150, 50, 74, 93, 73, 53, 75, 141, 66, 73, 54, 66, 49, 42, 54, 93, 58, 75, 39, 65, 46, 62, 42, 54, 57, 61, 150, 67, 50, 74, 111, 90, 80, 115, 150, 150, 150, 150, 111, 125, 75, 90, 50, 79, 89, 71, 93, 41, 73, 78, 150, 50, 64, 75, 150, 145, 54, 52, 74, 150, 48, 150, 45, 51, 76, 150, 142, 51, 114, 68, 150, 66, 57, 119, 50, 81, 40, 51, 68, 68, 102, 64, 90, 36, 86, 110, 150, 76, 97, 55, 150, 40, 43, 81, 52, 44, 150, 105, 150, 69], "policy_policy_0_reward": [-1303.8580307398995, -44.52070923918011, -139.3479663168344, -198.1779699136307, -126.65972292489836, -76.72143734057877, -147.18866329180423, -420.2800063694163, -88.20715722652147, -120.93690229888438, -43.27916431582734, -82.36374850404906, -49.77654547219973, -37.40124299382016, -54.90253732429299, -223.20981426111987, -78.71257634269483, -123.30150531109061, -10.544554227854329, -65.80069347248876, -41.94815809897083, -75.87600455308346, -39.46240950867225, -46.38527716649928, -41.224586475719214, -40.797860994635315, -254.6200552960493, -71.09926509471622, -41.02104112519972, -118.49229154376378, -249.63900491040314, -205.4165641232229, -153.6459991364394, -214.71452560251544, -343.6425701306203, -738.5491234495269, -545.2831852213774, -388.2324109443308, -228.1195150863531, -295.4256402896978, -131.45975368359785, -189.3832539393395, -32.81784054047494, -136.26720869332044, -163.262379304237, -86.18449032706881, -206.51578321105106, -30.16326379080051, -113.90687708797401, -122.4128117930551, -943.8892304317333, -23.978087593848276, -91.15937274167781, -89.04647902562847, -690.7123834081822, -429.7430246350066, -50.340780139326675, -45.430819987875495, -116.9291671355815, -486.54276026619124, -34.75918684887503, -298.46615477677517, -16.8920852427967, -40.625393732952, -145.2876812518821, -446.50691377913114, -334.3337727034525, -16.3207240912034, -280.09054956069457, -115.72963946548509, -967.675607624165, -80.31831158740137, -51.40750537031721, -294.28562585984525, -18.459119621457003, -155.04857593791328, -18.55088779760296, -53.950453132509026, -120.2288026710092, -73.04395505860843, -270.41508893963385, -79.90982865157872, -165.99748220492316, -9.843907155224903, -159.53957322521393, -225.26276016363846, -849.5157008980046, -110.40157018512724, -226.22980585234265, -37.79696312034473, -473.0186179873637, -52.37942766562233, -30.73844135670351, -185.32387084366832, -27.2318118357107, -29.12861947560363, -1004.1881130634731, -280.25867085480274, -566.8348414599395, -83.22735030432156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5623859835269388, "mean_inference_ms": 1.6969279854149029, "mean_action_processing_ms": 0.2748113809941155, "mean_env_wait_ms": 3.3781903040268126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012240886688232422, "StateBufferConnector_ms": 0.008107900619506836, "ViewRequirementAgentConnector_ms": 0.19237256050109863}, "num_episodes": 45, "episode_return_max": -9.843907155224903, "episode_return_min": -1303.8580307398995, "episode_return_mean": -201.78155595732173, "episodes_this_iter": 45}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.61427541924434, "num_env_steps_trained_throughput_per_sec": 316.61427541924434, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 392000, "timers": {"training_iteration_time_ms": 12276.634, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12276.556, "sample_time_ms": 1108.374, "learn_time_ms": 11105.107, "learn_throughput": 360.195, "synch_weights_time_ms": 62.233}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "done": false, "training_iteration": 98, "trial_id": "b33d0_00000", "date": "2024-08-06_15-00-31", "timestamp": 1722936631, "time_this_iter_s": 12.645192861557007, "time_total_s": 1192.661835193634, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c1da5f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1192.661835193634, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 17.43333333333333, "ram_util_percent": 29.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 85.54575386544069, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 1.9466150615364313, "policy_loss": -0.013818625008570961, "vf_loss": 1.9465163606529434, "vf_explained_var": 0.9927148244033257, "kl": 0.00967930757853234, "entropy": 0.7831200823498269, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 94560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "env_runners": {"episode_reward_max": -9.843907155224903, "episode_reward_min": -1327.6409785320668, "episode_reward_mean": -218.93754057744133, "episode_len_mean": 87.39, "episode_media": {}, "episodes_timesteps_total": 8739, "policy_reward_min": {"policy_0": -1327.6409785320668}, "policy_reward_max": {"policy_0": -9.843907155224903}, "policy_reward_mean": {"policy_0": -218.93754057744133}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113.90687708797401, -122.4128117930551, -943.8892304317333, -23.978087593848276, -91.15937274167781, -89.04647902562847, -690.7123834081822, -429.7430246350066, -50.340780139326675, -45.430819987875495, -116.9291671355815, -486.54276026619124, -34.75918684887503, -298.46615477677517, -16.8920852427967, -40.625393732952, -145.2876812518821, -446.50691377913114, -334.3337727034525, -16.3207240912034, -280.09054956069457, -115.72963946548509, -967.675607624165, -80.31831158740137, -51.40750537031721, -294.28562585984525, -18.459119621457003, -155.04857593791328, -18.55088779760296, -53.950453132509026, -120.2288026710092, -73.04395505860843, -270.41508893963385, -79.90982865157872, -165.99748220492316, -9.843907155224903, -159.53957322521393, -225.26276016363846, -849.5157008980046, -110.40157018512724, -226.22980585234265, -37.79696312034473, -473.0186179873637, -52.37942766562233, -30.73844135670351, -185.32387084366832, -27.2318118357107, -29.12861947560363, -1004.1881130634731, -280.25867085480274, -566.8348414599395, -83.22735030432156, -140.5365344406997, -148.0410349919315, -1039.700113408762, -24.626744910558116, -66.69837707625166, -178.26613821149184, -124.72352156428626, -44.050130428098974, -143.9262496560592, -57.62290459353621, -28.34534917102628, -98.85895110983064, -105.63600131587411, -275.9390987876806, -43.63614914700237, -507.048606848429, -144.4683309636495, -171.32630885411507, -95.6344871257443, -22.666908231129906, -205.04789029306065, -113.36851942606536, -1083.7172320409923, -242.43230692547237, -84.88078254587988, -137.13591212302748, -189.73952120049054, -151.9047635981257, -429.9033318134239, -129.99389859784256, -201.95218993539027, -102.80967135325193, -264.60175874385794, -1327.6409785320668, -138.45695104967845, -144.06923442913944, -42.07474326828775, -165.79342327935822, -106.68733767234768, -119.6475442807742, -326.5649536212181, -79.1397589282199, -76.60712590112396, -233.25641657633366, -155.49528382740078, -182.23236353341335, -92.1782847690107, -271.3547530393174], "episode_lengths": [73, 78, 150, 50, 64, 75, 150, 145, 54, 52, 74, 150, 48, 150, 45, 51, 76, 150, 142, 51, 114, 68, 150, 66, 57, 119, 50, 81, 40, 51, 68, 68, 102, 64, 90, 36, 86, 110, 150, 76, 97, 55, 150, 40, 43, 81, 52, 44, 150, 105, 150, 69, 81, 97, 150, 52, 64, 91, 59, 58, 108, 57, 49, 67, 74, 117, 51, 150, 81, 94, 66, 44, 95, 71, 150, 150, 64, 72, 85, 84, 150, 76, 99, 65, 100, 150, 87, 81, 49, 98, 91, 79, 130, 80, 54, 112, 78, 91, 69, 109], "policy_policy_0_reward": [-113.90687708797401, -122.4128117930551, -943.8892304317333, -23.978087593848276, -91.15937274167781, -89.04647902562847, -690.7123834081822, -429.7430246350066, -50.340780139326675, -45.430819987875495, -116.9291671355815, -486.54276026619124, -34.75918684887503, -298.46615477677517, -16.8920852427967, -40.625393732952, -145.2876812518821, -446.50691377913114, -334.3337727034525, -16.3207240912034, -280.09054956069457, -115.72963946548509, -967.675607624165, -80.31831158740137, -51.40750537031721, -294.28562585984525, -18.459119621457003, -155.04857593791328, -18.55088779760296, -53.950453132509026, -120.2288026710092, -73.04395505860843, -270.41508893963385, -79.90982865157872, -165.99748220492316, -9.843907155224903, -159.53957322521393, -225.26276016363846, -849.5157008980046, -110.40157018512724, -226.22980585234265, -37.79696312034473, -473.0186179873637, -52.37942766562233, -30.73844135670351, -185.32387084366832, -27.2318118357107, -29.12861947560363, -1004.1881130634731, -280.25867085480274, -566.8348414599395, -83.22735030432156, -140.5365344406997, -148.0410349919315, -1039.700113408762, -24.626744910558116, -66.69837707625166, -178.26613821149184, -124.72352156428626, -44.050130428098974, -143.9262496560592, -57.62290459353621, -28.34534917102628, -98.85895110983064, -105.63600131587411, -275.9390987876806, -43.63614914700237, -507.048606848429, -144.4683309636495, -171.32630885411507, -95.6344871257443, -22.666908231129906, -205.04789029306065, -113.36851942606536, -1083.7172320409923, -242.43230692547237, -84.88078254587988, -137.13591212302748, -189.73952120049054, -151.9047635981257, -429.9033318134239, -129.99389859784256, -201.95218993539027, -102.80967135325193, -264.60175874385794, -1327.6409785320668, -138.45695104967845, -144.06923442913944, -42.07474326828775, -165.79342327935822, -106.68733767234768, -119.6475442807742, -326.5649536212181, -79.1397589282199, -76.60712590112396, -233.25641657633366, -155.49528382740078, -182.23236353341335, -92.1782847690107, -271.3547530393174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5621488796029506, "mean_inference_ms": 1.695526048241635, "mean_action_processing_ms": 0.274835549202691, "mean_env_wait_ms": 3.376441237563965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012270689010620117, "StateBufferConnector_ms": 0.008108854293823242, "ViewRequirementAgentConnector_ms": 0.19329333305358887}, "num_episodes": 48, "episode_return_max": -9.843907155224903, "episode_return_min": -1327.6409785320668, "episode_return_mean": -218.93754057744133, "episodes_this_iter": 48}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.6619504782404, "num_env_steps_trained_throughput_per_sec": 309.6619504782404, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 396000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 12330.215, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12330.14, "sample_time_ms": 1108.957, "learn_time_ms": 11158.55, "learn_throughput": 358.47, "synch_weights_time_ms": 61.786}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "training_iteration": 99, "trial_id": "b33d0_00000", "date": "2024-08-06_15-00-44", "timestamp": 1722936644, "time_this_iter_s": 12.930145978927612, "time_total_s": 1205.5919811725616, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c1d96c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1205.5919811725616, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 17.11578947368421, "ram_util_percent": 29.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 106.59920251170794, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 2.3084654306992887, "policy_loss": -0.008898972651998823, "vf_loss": 2.302749489247799, "vf_explained_var": 0.985779255690674, "kl": 0.010258487303932877, "entropy": 0.9651642906169097, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 95520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": -10.81568842909901, "episode_reward_min": -1327.6409785320668, "episode_reward_mean": -230.4773018296945, "episode_len_mean": 88.31, "episode_media": {}, "episodes_timesteps_total": 8831, "policy_reward_min": {"policy_0": -1327.6409785320668}, "policy_reward_max": {"policy_0": -10.81568842909901}, "policy_reward_mean": {"policy_0": -230.4773018296945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29.12861947560363, -1004.1881130634731, -280.25867085480274, -566.8348414599395, -83.22735030432156, -140.5365344406997, -148.0410349919315, -1039.700113408762, -24.626744910558116, -66.69837707625166, -178.26613821149184, -124.72352156428626, -44.050130428098974, -143.9262496560592, -57.62290459353621, -28.34534917102628, -98.85895110983064, -105.63600131587411, -275.9390987876806, -43.63614914700237, -507.048606848429, -144.4683309636495, -171.32630885411507, -95.6344871257443, -22.666908231129906, -205.04789029306065, -113.36851942606536, -1083.7172320409923, -242.43230692547237, -84.88078254587988, -137.13591212302748, -189.73952120049054, -151.9047635981257, -429.9033318134239, -129.99389859784256, -201.95218993539027, -102.80967135325193, -264.60175874385794, -1327.6409785320668, -138.45695104967845, -144.06923442913944, -42.07474326828775, -165.79342327935822, -106.68733767234768, -119.6475442807742, -326.5649536212181, -79.1397589282199, -76.60712590112396, -233.25641657633366, -155.49528382740078, -182.23236353341335, -92.1782847690107, -271.3547530393174, -124.68914928074712, -67.50205028868616, -131.91540777380735, -130.00984921955956, -166.3294621562383, -45.77978910886903, -292.80262826977594, -283.7413001423699, -1121.377768252831, -333.0463602203857, -59.00643196715271, -80.52621456134007, -92.41406893135948, -131.38477149473619, -44.21635235836704, -20.441032715975705, -76.89007475141804, -1046.5937554470286, -122.89873124524505, -107.04538871678601, -561.0658026307609, -143.63846616992217, -169.61115260276065, -254.81950918808857, -127.02213327786832, -92.68390808314973, -116.77262734873204, -42.36141816430549, -85.27424305229891, -270.21317306596603, -146.99257173762902, -12.73364878070699, -350.01051665008737, -295.3315074008877, -173.01731993345007, -143.80320751297194, -133.69891852542645, -824.9816688795835, -29.630624851773113, -10.81568842909901, -78.6382765895486, -257.2725906393449, -107.48422985101612, -143.9130903587328, -1151.0073515666725, -449.985639025426, -172.26384445169728], "episode_lengths": [44, 150, 105, 150, 69, 81, 97, 150, 52, 64, 91, 59, 58, 108, 57, 49, 67, 74, 117, 51, 150, 81, 94, 66, 44, 95, 71, 150, 150, 64, 72, 85, 84, 150, 76, 99, 65, 100, 150, 87, 81, 49, 98, 91, 79, 130, 80, 54, 112, 78, 91, 69, 109, 75, 55, 79, 76, 84, 37, 131, 121, 150, 150, 57, 64, 64, 83, 50, 38, 62, 150, 72, 72, 111, 74, 83, 119, 77, 66, 71, 55, 65, 113, 77, 40, 145, 150, 88, 75, 75, 150, 40, 48, 73, 105, 85, 59, 150, 132, 88], "policy_policy_0_reward": [-29.12861947560363, -1004.1881130634731, -280.25867085480274, -566.8348414599395, -83.22735030432156, -140.5365344406997, -148.0410349919315, -1039.700113408762, -24.626744910558116, -66.69837707625166, -178.26613821149184, -124.72352156428626, -44.050130428098974, -143.9262496560592, -57.62290459353621, -28.34534917102628, -98.85895110983064, -105.63600131587411, -275.9390987876806, -43.63614914700237, -507.048606848429, -144.4683309636495, -171.32630885411507, -95.6344871257443, -22.666908231129906, -205.04789029306065, -113.36851942606536, -1083.7172320409923, -242.43230692547237, -84.88078254587988, -137.13591212302748, -189.73952120049054, -151.9047635981257, -429.9033318134239, -129.99389859784256, -201.95218993539027, -102.80967135325193, -264.60175874385794, -1327.6409785320668, -138.45695104967845, -144.06923442913944, -42.07474326828775, -165.79342327935822, -106.68733767234768, -119.6475442807742, -326.5649536212181, -79.1397589282199, -76.60712590112396, -233.25641657633366, -155.49528382740078, -182.23236353341335, -92.1782847690107, -271.3547530393174, -124.68914928074712, -67.50205028868616, -131.91540777380735, -130.00984921955956, -166.3294621562383, -45.77978910886903, -292.80262826977594, -283.7413001423699, -1121.377768252831, -333.0463602203857, -59.00643196715271, -80.52621456134007, -92.41406893135948, -131.38477149473619, -44.21635235836704, -20.441032715975705, -76.89007475141804, -1046.5937554470286, -122.89873124524505, -107.04538871678601, -561.0658026307609, -143.63846616992217, -169.61115260276065, -254.81950918808857, -127.02213327786832, -92.68390808314973, -116.77262734873204, -42.36141816430549, -85.27424305229891, -270.21317306596603, -146.99257173762902, -12.73364878070699, -350.01051665008737, -295.3315074008877, -173.01731993345007, -143.80320751297194, -133.69891852542645, -824.9816688795835, -29.630624851773113, -10.81568842909901, -78.6382765895486, -257.2725906393449, -107.48422985101612, -143.9130903587328, -1151.0073515666725, -449.985639025426, -172.26384445169728]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5624983396346486, "mean_inference_ms": 1.6964398458282972, "mean_action_processing_ms": 0.2749347756962768, "mean_env_wait_ms": 3.375942851432163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011806011199951172, "StateBufferConnector_ms": 0.00800466537475586, "ViewRequirementAgentConnector_ms": 0.1963660717010498}, "num_episodes": 47, "episode_return_max": -10.81568842909901, "episode_return_min": -1327.6409785320668, "episode_return_mean": -230.4773018296945, "episodes_this_iter": 47}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.0183232055167, "num_env_steps_trained_throughput_per_sec": 311.0183232055167, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 12381.117, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12381.04, "sample_time_ms": 1122.09, "learn_time_ms": 11197.344, "learn_throughput": 357.228, "synch_weights_time_ms": 60.77}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": true, "training_iteration": 100, "trial_id": "b33d0_00000", "date": "2024-08-06_15-00-57", "timestamp": 1722936657, "time_this_iter_s": 12.874317407608032, "time_total_s": 1218.4662985801697, "pid": 896885, "hostname": "mav-lab-invento", "node_ip": "10.42.130.3", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x78544c16b130>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.          -3.1415927], [100.          3.1415927 100.          1.          3.1415927], (5,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1218.4662985801697, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 17.65, "ram_util_percent": 29.399999999999995}}
