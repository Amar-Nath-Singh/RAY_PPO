{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9242307144217193, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.712824014822642, "policy_loss": -0.004882470204514296, "vf_loss": 9.730267783006033, "vf_explained_var": -0.0004995051150520643, "kl": 0.008426087512551325, "entropy": 1.4246530515452227, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -60.67885032383818, "episode_reward_min": -1288.429126979798, "episode_reward_mean": -764.6487460558155, "episode_len_mean": 142.2, "episode_media": {}, "episodes_timesteps_total": 3555, "policy_reward_min": {"policy_0": -1288.429126979798}, "policy_reward_max": {"policy_0": -60.67885032383818}, "policy_reward_mean": {"policy_0": -764.6487460558155}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-971.8329399681189, -910.1767836200455, -728.9380475735728, -518.6503003161362, -843.7838540329029, -332.15102205211446, -1054.739086312346, -607.4792334010081, -1112.8360363014735, -436.6434986725031, -875.8965521641135, -580.6878329153533, -291.58900286650936, -857.3997752037347, -1150.2675632530425, -947.9524390770702, -661.2426319587873, -825.0515406081687, -485.4259412894461, -537.4248437668318, -729.8953764160631, -1288.429126979798, -1106.9835014773646, -1200.0628708450488, -60.67885032383818], "episode_lengths": [150, 150, 147, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 118, 125, 150, 150, 150, 150, 64], "policy_policy_0_reward": [-971.8329399681189, -910.1767836200455, -728.9380475735728, -518.6503003161362, -843.7838540329029, -332.15102205211446, -1054.739086312346, -607.4792334010081, -1112.8360363014735, -436.6434986725031, -875.8965521641135, -580.6878329153533, -291.58900286650936, -857.3997752037347, -1150.2675632530425, -947.9524390770702, -661.2426319587873, -825.0515406081687, -485.4259412894461, -537.4248437668318, -729.8953764160631, -1288.429126979798, -1106.9835014773646, -1200.0628708450488, -60.67885032383818]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30140662461184387, "mean_inference_ms": 0.919047961669617, "mean_action_processing_ms": 0.16922730482770562, "mean_env_wait_ms": 1.648038097386354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007366180419921875, "StateBufferConnector_ms": 0.004406929016113281, "ViewRequirementAgentConnector_ms": 0.10088348388671875}, "num_episodes": 25, "episode_return_max": -60.67885032383818, "episode_return_min": -1288.429126979798, "episode_return_mean": -764.6487460558155, "episodes_this_iter": 25}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.3175979618981, "num_env_steps_trained_throughput_per_sec": 292.3175979618981, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 13683.757, "restore_workers_time_ms": 0.019, "training_step_time_ms": 13683.699, "sample_time_ms": 2561.764, "learn_time_ms": 11105.822, "learn_throughput": 360.171, "synch_weights_time_ms": 15.363}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "6d52d_00000", "date": "2024-07-26_22-44-16", "timestamp": 1722014056, "time_this_iter_s": 13.68789529800415, "time_total_s": 13.68789529800415, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d139df20d30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13.68789529800415, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 10.425, "ram_util_percent": 27.384999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4358913369476796, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.541466130812962, "policy_loss": -0.008465848463432242, "vf_loss": 9.561704126993815, "vf_explained_var": 0.07032303679734468, "kl": 0.01206133704005576, "entropy": 1.4184394795447588, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -60.67885032383818, "episode_reward_min": -1288.429126979798, "episode_reward_mean": -720.2936994449448, "episode_len_mean": 140.53703703703704, "episode_media": {}, "episodes_timesteps_total": 7589, "policy_reward_min": {"policy_0": -1288.429126979798}, "policy_reward_max": {"policy_0": -60.67885032383818}, "policy_reward_mean": {"policy_0": -720.2936994449448}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-971.8329399681189, -910.1767836200455, -728.9380475735728, -518.6503003161362, -843.7838540329029, -332.15102205211446, -1054.739086312346, -607.4792334010081, -1112.8360363014735, -436.6434986725031, -875.8965521641135, -580.6878329153533, -291.58900286650936, -857.3997752037347, -1150.2675632530425, -947.9524390770702, -661.2426319587873, -825.0515406081687, -485.4259412894461, -537.4248437668318, -729.8953764160631, -1288.429126979798, -1106.9835014773646, -1200.0628708450488, -60.67885032383818, -908.0137115442653, -719.6155695518446, -287.5282243889008, -861.9410026235424, -467.3267756237253, -706.2660314317235, -364.5217386936932, -548.0763954021053, -731.7126089391693, -366.3774025142973, -843.6999856050351, -580.9661361221029, -216.0728137032965, -980.3199345491754, -1239.2210496758137, -795.6151524831154, -1112.3671734565642, -780.2452360737128, -1023.7544645545971, -805.4986457157946, -354.4136299286047, -103.50442067991402, -1088.090974916091, -615.9472879490055, -568.3348622272779, -943.1500831204078, -216.13198420689028, -1176.004729123687, -374.92309382727115], "episode_lengths": [150, 150, 147, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 118, 125, 150, 150, 150, 150, 64, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 105, 150, 150, 150, 150, 150, 150, 150, 89, 48, 150, 150, 150, 150, 96, 150, 150], "policy_policy_0_reward": [-971.8329399681189, -910.1767836200455, -728.9380475735728, -518.6503003161362, -843.7838540329029, -332.15102205211446, -1054.739086312346, -607.4792334010081, -1112.8360363014735, -436.6434986725031, -875.8965521641135, -580.6878329153533, -291.58900286650936, -857.3997752037347, -1150.2675632530425, -947.9524390770702, -661.2426319587873, -825.0515406081687, -485.4259412894461, -537.4248437668318, -729.8953764160631, -1288.429126979798, -1106.9835014773646, -1200.0628708450488, -60.67885032383818, -908.0137115442653, -719.6155695518446, -287.5282243889008, -861.9410026235424, -467.3267756237253, -706.2660314317235, -364.5217386936932, -548.0763954021053, -731.7126089391693, -366.3774025142973, -843.6999856050351, -580.9661361221029, -216.0728137032965, -980.3199345491754, -1239.2210496758137, -795.6151524831154, -1112.3671734565642, -780.2452360737128, -1023.7544645545971, -805.4986457157946, -354.4136299286047, -103.50442067991402, -1088.090974916091, -615.9472879490055, -568.3348622272779, -943.1500831204078, -216.13198420689028, -1176.004729123687, -374.92309382727115]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29941589687391384, "mean_inference_ms": 0.9180739606062848, "mean_action_processing_ms": 0.16848162484582477, "mean_env_wait_ms": 1.6481435455295166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006842613220214844, "StateBufferConnector_ms": 0.0042928589714898, "ViewRequirementAgentConnector_ms": 0.10037819544474284}, "num_episodes": 29, "episode_return_max": -60.67885032383818, "episode_return_min": -1288.429126979798, "episode_return_mean": -720.2936994449448, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.4307376703811, "num_env_steps_trained_throughput_per_sec": 290.4307376703811, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 13728.208, "restore_workers_time_ms": 0.02, "training_step_time_ms": 13728.149, "sample_time_ms": 2551.283, "learn_time_ms": 11158.493, "learn_throughput": 358.471, "synch_weights_time_ms": 17.588}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "6d52d_00000", "date": "2024-07-26_22-44-30", "timestamp": 1722014070, "time_this_iter_s": 13.778611660003662, "time_total_s": 27.466506958007812, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d13c4540700>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 27.466506958007812, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 10.549999999999999, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.640381597013523, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.961280317604542, "policy_loss": -0.006239134737309845, "vf_loss": 8.97951586296161, "vf_explained_var": 0.2050871890038252, "kl": 0.012862760756070206, "entropy": 1.4568991309652726, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -60.67885032383818, "episode_reward_min": -1288.429126979798, "episode_reward_mean": -673.4260331221419, "episode_len_mean": 138.04705882352943, "episode_media": {}, "episodes_timesteps_total": 11734, "policy_reward_min": {"policy_0": -1288.429126979798}, "policy_reward_max": {"policy_0": -60.67885032383818}, "policy_reward_mean": {"policy_0": -673.4260331221419}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-971.8329399681189, -910.1767836200455, -728.9380475735728, -518.6503003161362, -843.7838540329029, -332.15102205211446, -1054.739086312346, -607.4792334010081, -1112.8360363014735, -436.6434986725031, -875.8965521641135, -580.6878329153533, -291.58900286650936, -857.3997752037347, -1150.2675632530425, -947.9524390770702, -661.2426319587873, -825.0515406081687, -485.4259412894461, -537.4248437668318, -729.8953764160631, -1288.429126979798, -1106.9835014773646, -1200.0628708450488, -60.67885032383818, -908.0137115442653, -719.6155695518446, -287.5282243889008, -861.9410026235424, -467.3267756237253, -706.2660314317235, -364.5217386936932, -548.0763954021053, -731.7126089391693, -366.3774025142973, -843.6999856050351, -580.9661361221029, -216.0728137032965, -980.3199345491754, -1239.2210496758137, -795.6151524831154, -1112.3671734565642, -780.2452360737128, -1023.7544645545971, -805.4986457157946, -354.4136299286047, -103.50442067991402, -1088.090974916091, -615.9472879490055, -568.3348622272779, -943.1500831204078, -216.13198420689028, -1176.004729123687, -374.92309382727115, -820.4545162126606, -410.9067001291087, -624.110197770225, -732.5273319859696, -389.3234699409334, -618.5285865865278, -1223.3439551010786, -897.6952092044487, -271.8616184245376, -222.00399839532795, -69.70825272797047, -300.13749487563314, -551.837816837592, -868.4626986795315, -633.4887746055837, -894.9868725613533, -204.53831026859473, -765.1040146041122, -880.4412640227939, -718.5773577822307, -1047.1053545946288, -375.4954914782427, -104.67294093432122, -214.71710675219617, -743.3922160975769, -969.8262865000547, -673.9442912621081, -861.6735476552516, -618.9379714807797, -322.83132800122576, -314.71806988244595], "episode_lengths": [150, 150, 147, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 118, 125, 150, 150, 150, 150, 64, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 105, 150, 150, 150, 150, 150, 150, 150, 89, 48, 150, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 75, 44, 110, 126, 150, 139, 150, 77, 150, 150, 150, 150, 150, 86, 110, 150, 150, 150, 150, 150, 132, 96], "policy_policy_0_reward": [-971.8329399681189, -910.1767836200455, -728.9380475735728, -518.6503003161362, -843.7838540329029, -332.15102205211446, -1054.739086312346, -607.4792334010081, -1112.8360363014735, -436.6434986725031, -875.8965521641135, -580.6878329153533, -291.58900286650936, -857.3997752037347, -1150.2675632530425, -947.9524390770702, -661.2426319587873, -825.0515406081687, -485.4259412894461, -537.4248437668318, -729.8953764160631, -1288.429126979798, -1106.9835014773646, -1200.0628708450488, -60.67885032383818, -908.0137115442653, -719.6155695518446, -287.5282243889008, -861.9410026235424, -467.3267756237253, -706.2660314317235, -364.5217386936932, -548.0763954021053, -731.7126089391693, -366.3774025142973, -843.6999856050351, -580.9661361221029, -216.0728137032965, -980.3199345491754, -1239.2210496758137, -795.6151524831154, -1112.3671734565642, -780.2452360737128, -1023.7544645545971, -805.4986457157946, -354.4136299286047, -103.50442067991402, -1088.090974916091, -615.9472879490055, -568.3348622272779, -943.1500831204078, -216.13198420689028, -1176.004729123687, -374.92309382727115, -820.4545162126606, -410.9067001291087, -624.110197770225, -732.5273319859696, -389.3234699409334, -618.5285865865278, -1223.3439551010786, -897.6952092044487, -271.8616184245376, -222.00399839532795, -69.70825272797047, -300.13749487563314, -551.837816837592, -868.4626986795315, -633.4887746055837, -894.9868725613533, -204.53831026859473, -765.1040146041122, -880.4412640227939, -718.5773577822307, -1047.1053545946288, -375.4954914782427, -104.67294093432122, -214.71710675219617, -743.3922160975769, -969.8262865000547, -673.9442912621081, -861.6735476552516, -618.9379714807797, -322.83132800122576, -314.71806988244595]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.298200715807674, "mean_inference_ms": 0.916870282655823, "mean_action_processing_ms": 0.16780000116654772, "mean_env_wait_ms": 1.643249009418612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006347544053021599, "StateBufferConnector_ms": 0.004200935363769531, "ViewRequirementAgentConnector_ms": 0.10079608244054458}, "num_episodes": 31, "episode_return_max": -60.67885032383818, "episode_return_min": -1288.429126979798, "episode_return_mean": -673.4260331221419, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.8209308747938, "num_env_steps_trained_throughput_per_sec": 298.8209308747938, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 13614.124, "restore_workers_time_ms": 0.02, "training_step_time_ms": 13614.064, "sample_time_ms": 2545.302, "learn_time_ms": 11051.49, "learn_throughput": 361.942, "synch_weights_time_ms": 16.451}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "6d52d_00000", "date": "2024-07-26_22-44-44", "timestamp": 1722014084, "time_this_iter_s": 13.392249584197998, "time_total_s": 40.85875654220581, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c311090>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 40.85875654220581, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 10.442105263157892, "ram_util_percent": 27.394736842105257}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.976839999978741, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.379756046334903, "policy_loss": -0.007788983751864483, "vf_loss": 9.399909268816312, "vf_explained_var": 0.29662459834168353, "kl": 0.011980728657431432, "entropy": 1.4760440852493049, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -60.67885032383818, "episode_reward_min": -1288.429126979798, "episode_reward_mean": -683.522080620982, "episode_len_mean": 137.12, "episode_media": {}, "episodes_timesteps_total": 13712, "policy_reward_min": {"policy_0": -1288.429126979798}, "policy_reward_max": {"policy_0": -60.67885032383818}, "policy_reward_mean": {"policy_0": -683.522080620982}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1150.2675632530425, -947.9524390770702, -661.2426319587873, -825.0515406081687, -485.4259412894461, -537.4248437668318, -729.8953764160631, -1288.429126979798, -1106.9835014773646, -1200.0628708450488, -60.67885032383818, -908.0137115442653, -719.6155695518446, -287.5282243889008, -861.9410026235424, -467.3267756237253, -706.2660314317235, -364.5217386936932, -548.0763954021053, -731.7126089391693, -366.3774025142973, -843.6999856050351, -580.9661361221029, -216.0728137032965, -980.3199345491754, -1239.2210496758137, -795.6151524831154, -1112.3671734565642, -780.2452360737128, -1023.7544645545971, -805.4986457157946, -354.4136299286047, -103.50442067991402, -1088.090974916091, -615.9472879490055, -568.3348622272779, -943.1500831204078, -216.13198420689028, -1176.004729123687, -374.92309382727115, -820.4545162126606, -410.9067001291087, -624.110197770225, -732.5273319859696, -389.3234699409334, -618.5285865865278, -1223.3439551010786, -897.6952092044487, -271.8616184245376, -222.00399839532795, -69.70825272797047, -300.13749487563314, -551.837816837592, -868.4626986795315, -633.4887746055837, -894.9868725613533, -204.53831026859473, -765.1040146041122, -880.4412640227939, -718.5773577822307, -1047.1053545946288, -375.4954914782427, -104.67294093432122, -214.71710675219617, -743.3922160975769, -969.8262865000547, -673.9442912621081, -861.6735476552516, -618.9379714807797, -322.83132800122576, -314.71806988244595, -856.4430653201218, -933.3166833083226, -612.6184459993776, -610.1957415203681, -670.9799591921338, -840.9536533632366, -863.2104064066401, -182.0051406697277, -942.5676134459254, -1233.2172699844045, -601.5337340541056, -68.82547586980286, -449.33368138277405, -1037.6335468959858, -959.1965850973369, -903.5376387252912, -837.9011004833877, -823.4632298997323, -314.2231211969709, -734.9051364365986, -999.9168054555602, -114.60617954368632, -921.0731954579754, -380.26647945494005, -1012.6253535823264, -783.1823033890141, -992.3734936364443, -601.8412444918139, -951.8529278520705], "episode_lengths": [150, 150, 150, 150, 118, 125, 150, 150, 150, 150, 64, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 105, 150, 150, 150, 150, 150, 150, 150, 89, 48, 150, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 75, 44, 110, 126, 150, 139, 150, 77, 150, 150, 150, 150, 150, 86, 110, 150, 150, 150, 150, 150, 132, 96, 150, 150, 123, 150, 150, 150, 150, 66, 150, 150, 120, 47, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 127, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1150.2675632530425, -947.9524390770702, -661.2426319587873, -825.0515406081687, -485.4259412894461, -537.4248437668318, -729.8953764160631, -1288.429126979798, -1106.9835014773646, -1200.0628708450488, -60.67885032383818, -908.0137115442653, -719.6155695518446, -287.5282243889008, -861.9410026235424, -467.3267756237253, -706.2660314317235, -364.5217386936932, -548.0763954021053, -731.7126089391693, -366.3774025142973, -843.6999856050351, -580.9661361221029, -216.0728137032965, -980.3199345491754, -1239.2210496758137, -795.6151524831154, -1112.3671734565642, -780.2452360737128, -1023.7544645545971, -805.4986457157946, -354.4136299286047, -103.50442067991402, -1088.090974916091, -615.9472879490055, -568.3348622272779, -943.1500831204078, -216.13198420689028, -1176.004729123687, -374.92309382727115, -820.4545162126606, -410.9067001291087, -624.110197770225, -732.5273319859696, -389.3234699409334, -618.5285865865278, -1223.3439551010786, -897.6952092044487, -271.8616184245376, -222.00399839532795, -69.70825272797047, -300.13749487563314, -551.837816837592, -868.4626986795315, -633.4887746055837, -894.9868725613533, -204.53831026859473, -765.1040146041122, -880.4412640227939, -718.5773577822307, -1047.1053545946288, -375.4954914782427, -104.67294093432122, -214.71710675219617, -743.3922160975769, -969.8262865000547, -673.9442912621081, -861.6735476552516, -618.9379714807797, -322.83132800122576, -314.71806988244595, -856.4430653201218, -933.3166833083226, -612.6184459993776, -610.1957415203681, -670.9799591921338, -840.9536533632366, -863.2104064066401, -182.0051406697277, -942.5676134459254, -1233.2172699844045, -601.5337340541056, -68.82547586980286, -449.33368138277405, -1037.6335468959858, -959.1965850973369, -903.5376387252912, -837.9011004833877, -823.4632298997323, -314.2231211969709, -734.9051364365986, -999.9168054555602, -114.60617954368632, -921.0731954579754, -380.26647945494005, -1012.6253535823264, -783.1823033890141, -992.3734936364443, -601.8412444918139, -951.8529278520705]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29791779845744537, "mean_inference_ms": 0.9172088428417676, "mean_action_processing_ms": 0.16754696096286623, "mean_env_wait_ms": 1.649699219779941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005914926528930664, "StateBufferConnector_ms": 0.004112720489501953, "ViewRequirementAgentConnector_ms": 0.10083675384521484}, "num_episodes": 29, "episode_return_max": -60.67885032383818, "episode_return_min": -1288.429126979798, "episode_return_mean": -683.522080620982, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.2085010121736, "num_env_steps_trained_throughput_per_sec": 272.2085010121736, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 13884.251, "restore_workers_time_ms": 0.022, "training_step_time_ms": 13884.188, "sample_time_ms": 2527.806, "learn_time_ms": 11339.44, "learn_throughput": 352.751, "synch_weights_time_ms": 16.104}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "6d52d_00000", "date": "2024-07-26_22-44-58", "timestamp": 1722014098, "time_this_iter_s": 14.70212721824646, "time_total_s": 55.56088376045227, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c311990>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 55.56088376045227, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 9.828571428571427, "ram_util_percent": 27.323809523809523}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.46054267504563, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.42482381214698, "policy_loss": -0.01205912689717176, "vf_loss": 8.448248759408791, "vf_explained_var": 0.4908112065245708, "kl": 0.0168063555014669, "entropy": 1.4727077728758255, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -68.82547586980286, "episode_reward_min": -1233.2172699844045, "episode_reward_mean": -675.5763579729104, "episode_len_mean": 135.17, "episode_media": {}, "episodes_timesteps_total": 13517, "policy_reward_min": {"policy_0": -1233.2172699844045}, "policy_reward_max": {"policy_0": -68.82547586980286}, "policy_reward_mean": {"policy_0": -675.5763579729104}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-780.2452360737128, -1023.7544645545971, -805.4986457157946, -354.4136299286047, -103.50442067991402, -1088.090974916091, -615.9472879490055, -568.3348622272779, -943.1500831204078, -216.13198420689028, -1176.004729123687, -374.92309382727115, -820.4545162126606, -410.9067001291087, -624.110197770225, -732.5273319859696, -389.3234699409334, -618.5285865865278, -1223.3439551010786, -897.6952092044487, -271.8616184245376, -222.00399839532795, -69.70825272797047, -300.13749487563314, -551.837816837592, -868.4626986795315, -633.4887746055837, -894.9868725613533, -204.53831026859473, -765.1040146041122, -880.4412640227939, -718.5773577822307, -1047.1053545946288, -375.4954914782427, -104.67294093432122, -214.71710675219617, -743.3922160975769, -969.8262865000547, -673.9442912621081, -861.6735476552516, -618.9379714807797, -322.83132800122576, -314.71806988244595, -856.4430653201218, -933.3166833083226, -612.6184459993776, -610.1957415203681, -670.9799591921338, -840.9536533632366, -863.2104064066401, -182.0051406697277, -942.5676134459254, -1233.2172699844045, -601.5337340541056, -68.82547586980286, -449.33368138277405, -1037.6335468959858, -959.1965850973369, -903.5376387252912, -837.9011004833877, -823.4632298997323, -314.2231211969709, -734.9051364365986, -999.9168054555602, -114.60617954368632, -921.0731954579754, -380.26647945494005, -1012.6253535823264, -783.1823033890141, -992.3734936364443, -601.8412444918139, -951.8529278520705, -877.7026263343794, -794.7565867270592, -431.4734184078212, -1003.07095584761, -866.1285938796477, -744.1983902123822, -978.9696933539525, -838.1491832891237, -868.037014331169, -859.6449561501773, -119.07795479526439, -927.5910729466481, -752.4568852614225, -675.2375396013684, -194.0738625278843, -811.6248378245959, -1221.1073408096279, -353.0776136308543, -862.9727438653057, -343.7587066716271, -101.75664463435177, -644.249857600709, -876.7621883826815, -1128.5380207459168, -85.82413751769114, -814.2549753055991, -834.6476925916274, -919.3406342501719], "episode_lengths": [150, 150, 150, 89, 48, 150, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 75, 44, 110, 126, 150, 139, 150, 77, 150, 150, 150, 150, 150, 86, 110, 150, 150, 150, 150, 150, 132, 96, 150, 150, 123, 150, 150, 150, 150, 66, 150, 150, 120, 47, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 54, 150, 150, 150, 80, 150, 150, 90, 150, 108, 58, 150, 150, 150, 73, 150, 150, 150], "policy_policy_0_reward": [-780.2452360737128, -1023.7544645545971, -805.4986457157946, -354.4136299286047, -103.50442067991402, -1088.090974916091, -615.9472879490055, -568.3348622272779, -943.1500831204078, -216.13198420689028, -1176.004729123687, -374.92309382727115, -820.4545162126606, -410.9067001291087, -624.110197770225, -732.5273319859696, -389.3234699409334, -618.5285865865278, -1223.3439551010786, -897.6952092044487, -271.8616184245376, -222.00399839532795, -69.70825272797047, -300.13749487563314, -551.837816837592, -868.4626986795315, -633.4887746055837, -894.9868725613533, -204.53831026859473, -765.1040146041122, -880.4412640227939, -718.5773577822307, -1047.1053545946288, -375.4954914782427, -104.67294093432122, -214.71710675219617, -743.3922160975769, -969.8262865000547, -673.9442912621081, -861.6735476552516, -618.9379714807797, -322.83132800122576, -314.71806988244595, -856.4430653201218, -933.3166833083226, -612.6184459993776, -610.1957415203681, -670.9799591921338, -840.9536533632366, -863.2104064066401, -182.0051406697277, -942.5676134459254, -1233.2172699844045, -601.5337340541056, -68.82547586980286, -449.33368138277405, -1037.6335468959858, -959.1965850973369, -903.5376387252912, -837.9011004833877, -823.4632298997323, -314.2231211969709, -734.9051364365986, -999.9168054555602, -114.60617954368632, -921.0731954579754, -380.26647945494005, -1012.6253535823264, -783.1823033890141, -992.3734936364443, -601.8412444918139, -951.8529278520705, -877.7026263343794, -794.7565867270592, -431.4734184078212, -1003.07095584761, -866.1285938796477, -744.1983902123822, -978.9696933539525, -838.1491832891237, -868.037014331169, -859.6449561501773, -119.07795479526439, -927.5910729466481, -752.4568852614225, -675.2375396013684, -194.0738625278843, -811.6248378245959, -1221.1073408096279, -353.0776136308543, -862.9727438653057, -343.7587066716271, -101.75664463435177, -644.249857600709, -876.7621883826815, -1128.5380207459168, -85.82413751769114, -814.2549753055991, -834.6476925916274, -919.3406342501719]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2961401266783733, "mean_inference_ms": 0.9145987587608618, "mean_action_processing_ms": 0.16666426248184765, "mean_env_wait_ms": 1.64690815539455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005396127700805664, "StateBufferConnector_ms": 0.004023075103759766, "ViewRequirementAgentConnector_ms": 0.10081958770751953}, "num_episodes": 28, "episode_return_max": -68.82547586980286, "episode_return_min": -1233.2172699844045, "episode_return_mean": -675.5763579729104, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.53796706018466, "num_env_steps_trained_throughput_per_sec": 308.53796706018466, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 13700.278, "restore_workers_time_ms": 0.023, "training_step_time_ms": 13700.213, "sample_time_ms": 2534.956, "learn_time_ms": 11148.652, "learn_throughput": 358.788, "synch_weights_time_ms": 15.785}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "6d52d_00000", "date": "2024-07-26_22-45-11", "timestamp": 1722014111, "time_this_iter_s": 12.969855308532715, "time_total_s": 68.53073906898499, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c3120e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 68.53073906898499, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 10.994444444444444, "ram_util_percent": 27.37777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.693408938248954, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.895400984585285, "policy_loss": -0.008536596510869762, "vf_loss": 7.915397000312805, "vf_explained_var": 0.513660506842037, "kl": 0.014954644798217492, "entropy": 1.4450332591931025, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -68.82547586980286, "episode_reward_min": -1380.3694979360316, "episode_reward_mean": -697.1440687010197, "episode_len_mean": 138.3, "episode_media": {}, "episodes_timesteps_total": 13830, "policy_reward_min": {"policy_0": -1380.3694979360316}, "policy_reward_max": {"policy_0": -68.82547586980286}, "policy_reward_mean": {"policy_0": -697.1440687010197}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-204.53831026859473, -765.1040146041122, -880.4412640227939, -718.5773577822307, -1047.1053545946288, -375.4954914782427, -104.67294093432122, -214.71710675219617, -743.3922160975769, -969.8262865000547, -673.9442912621081, -861.6735476552516, -618.9379714807797, -322.83132800122576, -314.71806988244595, -856.4430653201218, -933.3166833083226, -612.6184459993776, -610.1957415203681, -670.9799591921338, -840.9536533632366, -863.2104064066401, -182.0051406697277, -942.5676134459254, -1233.2172699844045, -601.5337340541056, -68.82547586980286, -449.33368138277405, -1037.6335468959858, -959.1965850973369, -903.5376387252912, -837.9011004833877, -823.4632298997323, -314.2231211969709, -734.9051364365986, -999.9168054555602, -114.60617954368632, -921.0731954579754, -380.26647945494005, -1012.6253535823264, -783.1823033890141, -992.3734936364443, -601.8412444918139, -951.8529278520705, -877.7026263343794, -794.7565867270592, -431.4734184078212, -1003.07095584761, -866.1285938796477, -744.1983902123822, -978.9696933539525, -838.1491832891237, -868.037014331169, -859.6449561501773, -119.07795479526439, -927.5910729466481, -752.4568852614225, -675.2375396013684, -194.0738625278843, -811.6248378245959, -1221.1073408096279, -353.0776136308543, -862.9727438653057, -343.7587066716271, -101.75664463435177, -644.249857600709, -876.7621883826815, -1128.5380207459168, -85.82413751769114, -814.2549753055991, -834.6476925916274, -919.3406342501719, -671.4349069673867, -193.5630409346668, -905.2011948103669, -366.0614305937118, -636.3065933044337, -1031.680369477725, -726.3844362129565, -515.0622941121252, -662.6961316145223, -1187.377764484147, -1380.3694979360316, -500.25898050110294, -335.70637370359935, -262.23976591901464, -1094.9267699777104, -1001.6713257907272, -635.1311867434839, -776.7167853804979, -500.5805321941884, -1130.8512959869481, -916.4872149802741, -1320.1128667887328, -202.06865329549476, -669.1014483366008, -692.0529633477612, -534.7319337390925, -491.38672472548103, -395.9854973138674], "episode_lengths": [77, 150, 150, 150, 150, 150, 86, 110, 150, 150, 150, 150, 150, 132, 96, 150, 150, 123, 150, 150, 150, 150, 66, 150, 150, 120, 47, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 54, 150, 150, 150, 80, 150, 150, 90, 150, 108, 58, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 96, 100, 150, 150, 150, 150, 150, 150, 150, 150, 129, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-204.53831026859473, -765.1040146041122, -880.4412640227939, -718.5773577822307, -1047.1053545946288, -375.4954914782427, -104.67294093432122, -214.71710675219617, -743.3922160975769, -969.8262865000547, -673.9442912621081, -861.6735476552516, -618.9379714807797, -322.83132800122576, -314.71806988244595, -856.4430653201218, -933.3166833083226, -612.6184459993776, -610.1957415203681, -670.9799591921338, -840.9536533632366, -863.2104064066401, -182.0051406697277, -942.5676134459254, -1233.2172699844045, -601.5337340541056, -68.82547586980286, -449.33368138277405, -1037.6335468959858, -959.1965850973369, -903.5376387252912, -837.9011004833877, -823.4632298997323, -314.2231211969709, -734.9051364365986, -999.9168054555602, -114.60617954368632, -921.0731954579754, -380.26647945494005, -1012.6253535823264, -783.1823033890141, -992.3734936364443, -601.8412444918139, -951.8529278520705, -877.7026263343794, -794.7565867270592, -431.4734184078212, -1003.07095584761, -866.1285938796477, -744.1983902123822, -978.9696933539525, -838.1491832891237, -868.037014331169, -859.6449561501773, -119.07795479526439, -927.5910729466481, -752.4568852614225, -675.2375396013684, -194.0738625278843, -811.6248378245959, -1221.1073408096279, -353.0776136308543, -862.9727438653057, -343.7587066716271, -101.75664463435177, -644.249857600709, -876.7621883826815, -1128.5380207459168, -85.82413751769114, -814.2549753055991, -834.6476925916274, -919.3406342501719, -671.4349069673867, -193.5630409346668, -905.2011948103669, -366.0614305937118, -636.3065933044337, -1031.680369477725, -726.3844362129565, -515.0622941121252, -662.6961316145223, -1187.377764484147, -1380.3694979360316, -500.25898050110294, -335.70637370359935, -262.23976591901464, -1094.9267699777104, -1001.6713257907272, -635.1311867434839, -776.7167853804979, -500.5805321941884, -1130.8512959869481, -916.4872149802741, -1320.1128667887328, -202.06865329549476, -669.1014483366008, -692.0529633477612, -534.7319337390925, -491.38672472548103, -395.9854973138674]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2960379588178214, "mean_inference_ms": 0.915291278475074, "mean_action_processing_ms": 0.16660420445673438, "mean_env_wait_ms": 1.6513133617977283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005217790603637695, "StateBufferConnector_ms": 0.0040209293365478516, "ViewRequirementAgentConnector_ms": 0.1009218692779541}, "num_episodes": 28, "episode_return_max": -68.82547586980286, "episode_return_min": -1380.3694979360316, "episode_return_mean": -697.1440687010197, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 334.09746415781956, "num_env_steps_trained_throughput_per_sec": 334.09746415781956, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 13412.326, "restore_workers_time_ms": 0.022, "training_step_time_ms": 13412.261, "sample_time_ms": 2536.606, "learn_time_ms": 10859.255, "learn_throughput": 368.349, "synch_weights_time_ms": 15.593}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "6d52d_00000", "date": "2024-07-26_22-45-23", "timestamp": 1722014123, "time_this_iter_s": 11.979729890823364, "time_total_s": 80.51046895980835, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c312320>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 80.51046895980835, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 11.805882352941177, "ram_util_percent": 27.529411764705884}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.56207781036695, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.008841502666473, "policy_loss": -0.006021426775259897, "vf_loss": 7.025830409427484, "vf_explained_var": 0.6477252639830112, "kl": 0.01819198602538564, "entropy": 1.4605898834764957, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -67.07642307665326, "episode_reward_min": -1380.3694979360316, "episode_reward_mean": -723.1528639294329, "episode_len_mean": 139.93, "episode_media": {}, "episodes_timesteps_total": 13993, "policy_reward_min": {"policy_0": -1380.3694979360316}, "policy_reward_max": {"policy_0": -67.07642307665326}, "policy_reward_mean": {"policy_0": -723.1528639294329}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1037.6335468959858, -959.1965850973369, -903.5376387252912, -837.9011004833877, -823.4632298997323, -314.2231211969709, -734.9051364365986, -999.9168054555602, -114.60617954368632, -921.0731954579754, -380.26647945494005, -1012.6253535823264, -783.1823033890141, -992.3734936364443, -601.8412444918139, -951.8529278520705, -877.7026263343794, -794.7565867270592, -431.4734184078212, -1003.07095584761, -866.1285938796477, -744.1983902123822, -978.9696933539525, -838.1491832891237, -868.037014331169, -859.6449561501773, -119.07795479526439, -927.5910729466481, -752.4568852614225, -675.2375396013684, -194.0738625278843, -811.6248378245959, -1221.1073408096279, -353.0776136308543, -862.9727438653057, -343.7587066716271, -101.75664463435177, -644.249857600709, -876.7621883826815, -1128.5380207459168, -85.82413751769114, -814.2549753055991, -834.6476925916274, -919.3406342501719, -671.4349069673867, -193.5630409346668, -905.2011948103669, -366.0614305937118, -636.3065933044337, -1031.680369477725, -726.3844362129565, -515.0622941121252, -662.6961316145223, -1187.377764484147, -1380.3694979360316, -500.25898050110294, -335.70637370359935, -262.23976591901464, -1094.9267699777104, -1001.6713257907272, -635.1311867434839, -776.7167853804979, -500.5805321941884, -1130.8512959869481, -916.4872149802741, -1320.1128667887328, -202.06865329549476, -669.1014483366008, -692.0529633477612, -534.7319337390925, -491.38672472548103, -395.9854973138674, -286.0839704195265, -67.07642307665326, -634.9724524807465, -550.8296967438653, -594.9151476092414, -1216.3147341816755, -528.3286042904613, -267.71216961543854, -898.1801328376523, -933.2967807700226, -979.1116503277586, -176.29312942950756, -794.6753779323443, -743.314133772596, -747.3638840535227, -1104.8383340694986, -647.3379682011108, -1328.0102916553496, -979.6210887860763, -919.0042835208192, -532.9754233192874, -554.8793688321903, -250.18122452833708, -926.5752792284551, -1056.3707556190127, -1176.3155674031289, -684.9940387277259, -702.4840332428313], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 54, 150, 150, 150, 80, 150, 150, 90, 150, 108, 58, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 96, 100, 150, 150, 150, 150, 150, 150, 150, 150, 129, 150, 150, 150, 150, 150, 104, 76, 150, 150, 150, 150, 150, 79, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 126, 81, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1037.6335468959858, -959.1965850973369, -903.5376387252912, -837.9011004833877, -823.4632298997323, -314.2231211969709, -734.9051364365986, -999.9168054555602, -114.60617954368632, -921.0731954579754, -380.26647945494005, -1012.6253535823264, -783.1823033890141, -992.3734936364443, -601.8412444918139, -951.8529278520705, -877.7026263343794, -794.7565867270592, -431.4734184078212, -1003.07095584761, -866.1285938796477, -744.1983902123822, -978.9696933539525, -838.1491832891237, -868.037014331169, -859.6449561501773, -119.07795479526439, -927.5910729466481, -752.4568852614225, -675.2375396013684, -194.0738625278843, -811.6248378245959, -1221.1073408096279, -353.0776136308543, -862.9727438653057, -343.7587066716271, -101.75664463435177, -644.249857600709, -876.7621883826815, -1128.5380207459168, -85.82413751769114, -814.2549753055991, -834.6476925916274, -919.3406342501719, -671.4349069673867, -193.5630409346668, -905.2011948103669, -366.0614305937118, -636.3065933044337, -1031.680369477725, -726.3844362129565, -515.0622941121252, -662.6961316145223, -1187.377764484147, -1380.3694979360316, -500.25898050110294, -335.70637370359935, -262.23976591901464, -1094.9267699777104, -1001.6713257907272, -635.1311867434839, -776.7167853804979, -500.5805321941884, -1130.8512959869481, -916.4872149802741, -1320.1128667887328, -202.06865329549476, -669.1014483366008, -692.0529633477612, -534.7319337390925, -491.38672472548103, -395.9854973138674, -286.0839704195265, -67.07642307665326, -634.9724524807465, -550.8296967438653, -594.9151476092414, -1216.3147341816755, -528.3286042904613, -267.71216961543854, -898.1801328376523, -933.2967807700226, -979.1116503277586, -176.29312942950756, -794.6753779323443, -743.314133772596, -747.3638840535227, -1104.8383340694986, -647.3379682011108, -1328.0102916553496, -979.6210887860763, -919.0042835208192, -532.9754233192874, -554.8793688321903, -250.18122452833708, -926.5752792284551, -1056.3707556190127, -1176.3155674031289, -684.9940387277259, -702.4840332428313]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2963308597280259, "mean_inference_ms": 0.9183035240865093, "mean_action_processing_ms": 0.16653520758462317, "mean_env_wait_ms": 1.654573147941564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054743289947509766, "StateBufferConnector_ms": 0.004090309143066406, "ViewRequirementAgentConnector_ms": 0.1027059555053711}, "num_episodes": 28, "episode_return_max": -67.07642307665326, "episode_return_min": -1380.3694979360316, "episode_return_mean": -723.1528639294329, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 289.9862805777582, "num_env_steps_trained_throughput_per_sec": 289.9862805777582, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 13466.818, "restore_workers_time_ms": 0.023, "training_step_time_ms": 13466.752, "sample_time_ms": 2560.508, "learn_time_ms": 10889.165, "learn_throughput": 367.338, "synch_weights_time_ms": 16.271}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "6d52d_00000", "date": "2024-07-26_22-45-37", "timestamp": 1722014137, "time_this_iter_s": 13.801743745803833, "time_total_s": 94.31221270561218, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c313be0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 94.31221270561218, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 11.935, "ram_util_percent": 27.555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 48.40764713982741, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.251054900884628, "policy_loss": -0.007575759917381219, "vf_loss": 6.270699345072111, "vf_explained_var": 0.823102539156874, "kl": 0.015957253820185244, "entropy": 1.526013396680355, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -38.893506758649565, "episode_reward_min": -1380.3694979360316, "episode_reward_mean": -718.693593602921, "episode_len_mean": 140.15, "episode_media": {}, "episodes_timesteps_total": 14015, "policy_reward_min": {"policy_0": -1380.3694979360316}, "policy_reward_max": {"policy_0": -38.893506758649565}, "policy_reward_mean": {"policy_0": -718.693593602921}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-675.2375396013684, -194.0738625278843, -811.6248378245959, -1221.1073408096279, -353.0776136308543, -862.9727438653057, -343.7587066716271, -101.75664463435177, -644.249857600709, -876.7621883826815, -1128.5380207459168, -85.82413751769114, -814.2549753055991, -834.6476925916274, -919.3406342501719, -671.4349069673867, -193.5630409346668, -905.2011948103669, -366.0614305937118, -636.3065933044337, -1031.680369477725, -726.3844362129565, -515.0622941121252, -662.6961316145223, -1187.377764484147, -1380.3694979360316, -500.25898050110294, -335.70637370359935, -262.23976591901464, -1094.9267699777104, -1001.6713257907272, -635.1311867434839, -776.7167853804979, -500.5805321941884, -1130.8512959869481, -916.4872149802741, -1320.1128667887328, -202.06865329549476, -669.1014483366008, -692.0529633477612, -534.7319337390925, -491.38672472548103, -395.9854973138674, -286.0839704195265, -67.07642307665326, -634.9724524807465, -550.8296967438653, -594.9151476092414, -1216.3147341816755, -528.3286042904613, -267.71216961543854, -898.1801328376523, -933.2967807700226, -979.1116503277586, -176.29312942950756, -794.6753779323443, -743.314133772596, -747.3638840535227, -1104.8383340694986, -647.3379682011108, -1328.0102916553496, -979.6210887860763, -919.0042835208192, -532.9754233192874, -554.8793688321903, -250.18122452833708, -926.5752792284551, -1056.3707556190127, -1176.3155674031289, -684.9940387277259, -702.4840332428313, -584.9184938699776, -993.5947334393974, -945.1968683185722, -1030.3563065877456, -648.2912203779166, -608.1666328844713, -386.26623113585964, -868.2852654381653, -966.1214211609388, -1170.41925813403, -760.3220618277035, -831.9547980207527, -744.0755076667829, -797.0671936008526, -944.3500379179011, -677.9972282948838, -756.8926980395709, -1013.7054314880972, -1066.2498309095852, -238.4235305240239, -794.8535097146499, -38.893506758649565, -707.6371378368086, -1076.9093038732676, -741.3234351700527, -821.2269053593118, -419.7836320667248, -651.5025726368746, -699.1438874310362], "episode_lengths": [150, 80, 150, 150, 90, 150, 108, 58, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 96, 100, 150, 150, 150, 150, 150, 150, 150, 150, 129, 150, 150, 150, 150, 150, 104, 76, 150, 150, 150, 150, 150, 79, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 126, 81, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 150, 118, 150, 56, 150, 150, 150, 150, 142, 150, 150], "policy_policy_0_reward": [-675.2375396013684, -194.0738625278843, -811.6248378245959, -1221.1073408096279, -353.0776136308543, -862.9727438653057, -343.7587066716271, -101.75664463435177, -644.249857600709, -876.7621883826815, -1128.5380207459168, -85.82413751769114, -814.2549753055991, -834.6476925916274, -919.3406342501719, -671.4349069673867, -193.5630409346668, -905.2011948103669, -366.0614305937118, -636.3065933044337, -1031.680369477725, -726.3844362129565, -515.0622941121252, -662.6961316145223, -1187.377764484147, -1380.3694979360316, -500.25898050110294, -335.70637370359935, -262.23976591901464, -1094.9267699777104, -1001.6713257907272, -635.1311867434839, -776.7167853804979, -500.5805321941884, -1130.8512959869481, -916.4872149802741, -1320.1128667887328, -202.06865329549476, -669.1014483366008, -692.0529633477612, -534.7319337390925, -491.38672472548103, -395.9854973138674, -286.0839704195265, -67.07642307665326, -634.9724524807465, -550.8296967438653, -594.9151476092414, -1216.3147341816755, -528.3286042904613, -267.71216961543854, -898.1801328376523, -933.2967807700226, -979.1116503277586, -176.29312942950756, -794.6753779323443, -743.314133772596, -747.3638840535227, -1104.8383340694986, -647.3379682011108, -1328.0102916553496, -979.6210887860763, -919.0042835208192, -532.9754233192874, -554.8793688321903, -250.18122452833708, -926.5752792284551, -1056.3707556190127, -1176.3155674031289, -684.9940387277259, -702.4840332428313, -584.9184938699776, -993.5947334393974, -945.1968683185722, -1030.3563065877456, -648.2912203779166, -608.1666328844713, -386.26623113585964, -868.2852654381653, -966.1214211609388, -1170.41925813403, -760.3220618277035, -831.9547980207527, -744.0755076667829, -797.0671936008526, -944.3500379179011, -677.9972282948838, -756.8926980395709, -1013.7054314880972, -1066.2498309095852, -238.4235305240239, -794.8535097146499, -38.893506758649565, -707.6371378368086, -1076.9093038732676, -741.3234351700527, -821.2269053593118, -419.7836320667248, -651.5025726368746, -699.1438874310362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29670810285315014, "mean_inference_ms": 0.9284152785591426, "mean_action_processing_ms": 0.1665665821937293, "mean_env_wait_ms": 1.6593253497386191, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056912899017333984, "StateBufferConnector_ms": 0.004249095916748047, "ViewRequirementAgentConnector_ms": 0.10584139823913574}, "num_episodes": 29, "episode_return_max": -38.893506758649565, "episode_return_min": -1380.3694979360316, "episode_return_mean": -718.693593602921, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 282.4538721575383, "num_env_steps_trained_throughput_per_sec": 282.4538721575383, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 13553.668, "restore_workers_time_ms": 0.023, "training_step_time_ms": 13553.602, "sample_time_ms": 2587.251, "learn_time_ms": 10949.364, "learn_throughput": 365.318, "synch_weights_time_ms": 16.155}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "6d52d_00000", "date": "2024-07-26_22-45-51", "timestamp": 1722014151, "time_this_iter_s": 14.16652774810791, "time_total_s": 108.47874045372009, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c39c9d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 108.47874045372009, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 11.995000000000001, "ram_util_percent": 27.484999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 52.76213538547357, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.1341869056224825, "policy_loss": -0.013702666372410022, "vf_loss": 6.157605946560701, "vf_explained_var": 0.9014493584011992, "kl": 0.019514048767784214, "entropy": 1.3619177070756754, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -38.893506758649565, "episode_reward_min": -1328.0102916553496, "episode_reward_mean": -679.460889322515, "episode_len_mean": 139.14, "episode_media": {}, "episodes_timesteps_total": 13914, "policy_reward_min": {"policy_0": -1328.0102916553496}, "policy_reward_max": {"policy_0": -38.893506758649565}, "policy_reward_mean": {"policy_0": -679.460889322515}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1001.6713257907272, -635.1311867434839, -776.7167853804979, -500.5805321941884, -1130.8512959869481, -916.4872149802741, -1320.1128667887328, -202.06865329549476, -669.1014483366008, -692.0529633477612, -534.7319337390925, -491.38672472548103, -395.9854973138674, -286.0839704195265, -67.07642307665326, -634.9724524807465, -550.8296967438653, -594.9151476092414, -1216.3147341816755, -528.3286042904613, -267.71216961543854, -898.1801328376523, -933.2967807700226, -979.1116503277586, -176.29312942950756, -794.6753779323443, -743.314133772596, -747.3638840535227, -1104.8383340694986, -647.3379682011108, -1328.0102916553496, -979.6210887860763, -919.0042835208192, -532.9754233192874, -554.8793688321903, -250.18122452833708, -926.5752792284551, -1056.3707556190127, -1176.3155674031289, -684.9940387277259, -702.4840332428313, -584.9184938699776, -993.5947334393974, -945.1968683185722, -1030.3563065877456, -648.2912203779166, -608.1666328844713, -386.26623113585964, -868.2852654381653, -966.1214211609388, -1170.41925813403, -760.3220618277035, -831.9547980207527, -744.0755076667829, -797.0671936008526, -944.3500379179011, -677.9972282948838, -756.8926980395709, -1013.7054314880972, -1066.2498309095852, -238.4235305240239, -794.8535097146499, -38.893506758649565, -707.6371378368086, -1076.9093038732676, -741.3234351700527, -821.2269053593118, -419.7836320667248, -651.5025726368746, -699.1438874310362, -541.592498970055, -220.64354173307305, -148.1978732829333, -213.9503980644005, -944.0415861780367, -162.8385050990909, -127.58984820595477, -1001.5716234959385, -481.89973157677383, -862.7493137123322, -246.28815414385383, -623.5573371979127, -684.8315462349302, -1018.2704004512618, -677.2955581676229, -756.9697610888835, -670.1777195162706, -571.5263636823381, -763.4004262155546, -485.56188418191897, -849.6698931885713, -394.4525117017608, -693.7654930482821, -255.20224164965174, -307.0406823133999, -503.9817239152068, -677.7701332191169, -815.9552421940249, -53.00977060020654, -659.4241554395356], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 129, 150, 150, 150, 150, 150, 104, 76, 150, 150, 150, 150, 150, 79, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 126, 81, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 150, 118, 150, 56, 150, 150, 150, 150, 142, 150, 150, 150, 76, 97, 76, 150, 91, 59, 150, 150, 150, 136, 150, 150, 150, 150, 150, 150, 129, 150, 150, 150, 147, 150, 120, 88, 150, 150, 150, 50, 150], "policy_policy_0_reward": [-1001.6713257907272, -635.1311867434839, -776.7167853804979, -500.5805321941884, -1130.8512959869481, -916.4872149802741, -1320.1128667887328, -202.06865329549476, -669.1014483366008, -692.0529633477612, -534.7319337390925, -491.38672472548103, -395.9854973138674, -286.0839704195265, -67.07642307665326, -634.9724524807465, -550.8296967438653, -594.9151476092414, -1216.3147341816755, -528.3286042904613, -267.71216961543854, -898.1801328376523, -933.2967807700226, -979.1116503277586, -176.29312942950756, -794.6753779323443, -743.314133772596, -747.3638840535227, -1104.8383340694986, -647.3379682011108, -1328.0102916553496, -979.6210887860763, -919.0042835208192, -532.9754233192874, -554.8793688321903, -250.18122452833708, -926.5752792284551, -1056.3707556190127, -1176.3155674031289, -684.9940387277259, -702.4840332428313, -584.9184938699776, -993.5947334393974, -945.1968683185722, -1030.3563065877456, -648.2912203779166, -608.1666328844713, -386.26623113585964, -868.2852654381653, -966.1214211609388, -1170.41925813403, -760.3220618277035, -831.9547980207527, -744.0755076667829, -797.0671936008526, -944.3500379179011, -677.9972282948838, -756.8926980395709, -1013.7054314880972, -1066.2498309095852, -238.4235305240239, -794.8535097146499, -38.893506758649565, -707.6371378368086, -1076.9093038732676, -741.3234351700527, -821.2269053593118, -419.7836320667248, -651.5025726368746, -699.1438874310362, -541.592498970055, -220.64354173307305, -148.1978732829333, -213.9503980644005, -944.0415861780367, -162.8385050990909, -127.58984820595477, -1001.5716234959385, -481.89973157677383, -862.7493137123322, -246.28815414385383, -623.5573371979127, -684.8315462349302, -1018.2704004512618, -677.2955581676229, -756.9697610888835, -670.1777195162706, -571.5263636823381, -763.4004262155546, -485.56188418191897, -849.6698931885713, -394.4525117017608, -693.7654930482821, -255.20224164965174, -307.0406823133999, -503.9817239152068, -677.7701332191169, -815.9552421940249, -53.00977060020654, -659.4241554395356]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29840988384604594, "mean_inference_ms": 0.941678706510257, "mean_action_processing_ms": 0.16703513132474174, "mean_env_wait_ms": 1.665842708167458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006186246871948242, "StateBufferConnector_ms": 0.004431486129760742, "ViewRequirementAgentConnector_ms": 0.11111116409301758}, "num_episodes": 30, "episode_return_max": -38.893506758649565, "episode_return_min": -1328.0102916553496, "episode_return_mean": -679.460889322515, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.2291944827454, "num_env_steps_trained_throughput_per_sec": 305.2291944827454, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 13503.808, "restore_workers_time_ms": 0.023, "training_step_time_ms": 13503.741, "sample_time_ms": 2602.99, "learn_time_ms": 10884.006, "learn_throughput": 367.512, "synch_weights_time_ms": 15.915}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "6d52d_00000", "date": "2024-07-26_22-46-05", "timestamp": 1722014165, "time_this_iter_s": 13.11197566986084, "time_total_s": 121.59071612358093, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c39da20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 121.59071612358093, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 17.11052631578948, "ram_util_percent": 28.052631578947373}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 59.7666379104058, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.089930408447981, "policy_loss": -0.008738262129675907, "vf_loss": 6.10966745565335, "vf_explained_var": 0.8713409815604488, "kl": 0.01711697868304328, "entropy": 1.4422158909340699, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -38.893506758649565, "episode_reward_min": -1328.0102916553496, "episode_reward_mean": -711.9102406713215, "episode_len_mean": 140.78, "episode_media": {}, "episodes_timesteps_total": 14078, "policy_reward_min": {"policy_0": -1328.0102916553496}, "policy_reward_max": {"policy_0": -38.893506758649565}, "policy_reward_mean": {"policy_0": -711.9102406713215}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-743.314133772596, -747.3638840535227, -1104.8383340694986, -647.3379682011108, -1328.0102916553496, -979.6210887860763, -919.0042835208192, -532.9754233192874, -554.8793688321903, -250.18122452833708, -926.5752792284551, -1056.3707556190127, -1176.3155674031289, -684.9940387277259, -702.4840332428313, -584.9184938699776, -993.5947334393974, -945.1968683185722, -1030.3563065877456, -648.2912203779166, -608.1666328844713, -386.26623113585964, -868.2852654381653, -966.1214211609388, -1170.41925813403, -760.3220618277035, -831.9547980207527, -744.0755076667829, -797.0671936008526, -944.3500379179011, -677.9972282948838, -756.8926980395709, -1013.7054314880972, -1066.2498309095852, -238.4235305240239, -794.8535097146499, -38.893506758649565, -707.6371378368086, -1076.9093038732676, -741.3234351700527, -821.2269053593118, -419.7836320667248, -651.5025726368746, -699.1438874310362, -541.592498970055, -220.64354173307305, -148.1978732829333, -213.9503980644005, -944.0415861780367, -162.8385050990909, -127.58984820595477, -1001.5716234959385, -481.89973157677383, -862.7493137123322, -246.28815414385383, -623.5573371979127, -684.8315462349302, -1018.2704004512618, -677.2955581676229, -756.9697610888835, -670.1777195162706, -571.5263636823381, -763.4004262155546, -485.56188418191897, -849.6698931885713, -394.4525117017608, -693.7654930482821, -255.20224164965174, -307.0406823133999, -503.9817239152068, -677.7701332191169, -815.9552421940249, -53.00977060020654, -659.4241554395356, -1262.6964272421824, -436.57476196874643, -1012.0044518791464, -367.45467837567844, -631.1096785952908, -1163.1868648750312, -540.1133726694059, -1209.9309918761974, -1149.4051067918788, -1209.9287534841674, -327.1659288211871, -795.2079278549015, -314.5674845338671, -76.42661987807374, -999.0749424036239, -654.4770476347077, -1070.8057978714576, -1105.4904052241545, -1031.992728554925, -931.5286969455417, -795.2671473328721, -716.7663263362026, -334.67266431357297, -707.4918138554973, -1090.2754333130026, -505.9877805873932], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 126, 81, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 150, 118, 150, 56, 150, 150, 150, 150, 142, 150, 150, 150, 76, 97, 76, 150, 91, 59, 150, 150, 150, 136, 150, 150, 150, 150, 150, 150, 129, 150, 150, 150, 147, 150, 120, 88, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 146, 150, 150, 150, 150], "policy_policy_0_reward": [-743.314133772596, -747.3638840535227, -1104.8383340694986, -647.3379682011108, -1328.0102916553496, -979.6210887860763, -919.0042835208192, -532.9754233192874, -554.8793688321903, -250.18122452833708, -926.5752792284551, -1056.3707556190127, -1176.3155674031289, -684.9940387277259, -702.4840332428313, -584.9184938699776, -993.5947334393974, -945.1968683185722, -1030.3563065877456, -648.2912203779166, -608.1666328844713, -386.26623113585964, -868.2852654381653, -966.1214211609388, -1170.41925813403, -760.3220618277035, -831.9547980207527, -744.0755076667829, -797.0671936008526, -944.3500379179011, -677.9972282948838, -756.8926980395709, -1013.7054314880972, -1066.2498309095852, -238.4235305240239, -794.8535097146499, -38.893506758649565, -707.6371378368086, -1076.9093038732676, -741.3234351700527, -821.2269053593118, -419.7836320667248, -651.5025726368746, -699.1438874310362, -541.592498970055, -220.64354173307305, -148.1978732829333, -213.9503980644005, -944.0415861780367, -162.8385050990909, -127.58984820595477, -1001.5716234959385, -481.89973157677383, -862.7493137123322, -246.28815414385383, -623.5573371979127, -684.8315462349302, -1018.2704004512618, -677.2955581676229, -756.9697610888835, -670.1777195162706, -571.5263636823381, -763.4004262155546, -485.56188418191897, -849.6698931885713, -394.4525117017608, -693.7654930482821, -255.20224164965174, -307.0406823133999, -503.9817239152068, -677.7701332191169, -815.9552421940249, -53.00977060020654, -659.4241554395356, -1262.6964272421824, -436.57476196874643, -1012.0044518791464, -367.45467837567844, -631.1096785952908, -1163.1868648750312, -540.1133726694059, -1209.9309918761974, -1149.4051067918788, -1209.9287534841674, -327.1659288211871, -795.2079278549015, -314.5674845338671, -76.42661987807374, -999.0749424036239, -654.4770476347077, -1070.8057978714576, -1105.4904052241545, -1031.992728554925, -931.5286969455417, -795.2671473328721, -716.7663263362026, -334.67266431357297, -707.4918138554973, -1090.2754333130026, -505.9877805873932]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2999046694660323, "mean_inference_ms": 0.9500274533412071, "mean_action_processing_ms": 0.16754265685633762, "mean_env_wait_ms": 1.6734874691936332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006159782409667969, "StateBufferConnector_ms": 0.004441738128662109, "ViewRequirementAgentConnector_ms": 0.11262202262878418}, "num_episodes": 26, "episode_return_max": -38.893506758649565, "episode_return_min": -1328.0102916553496, "episode_return_mean": -711.9102406713215, "episodes_this_iter": 26}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.1262361151515, "num_env_steps_trained_throughput_per_sec": 303.1262361151515, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 13473.011, "restore_workers_time_ms": 0.023, "training_step_time_ms": 13472.943, "sample_time_ms": 2593.078, "learn_time_ms": 10863.113, "learn_throughput": 368.219, "synch_weights_time_ms": 15.929}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "6d52d_00000", "date": "2024-07-26_22-46-18", "timestamp": 1722014178, "time_this_iter_s": 13.201737880706787, "time_total_s": 134.79245400428772, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c312e60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 134.79245400428772, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 11.363157894736842, "ram_util_percent": 28.094736842105267}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 70.31745865444343, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.734586863716443, "policy_loss": -0.00956189475740151, "vf_loss": 5.753840738534928, "vf_explained_var": 0.8802829772854844, "kl": 0.015856389560819178, "entropy": 1.2863274185607831, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -32.713632696955365, "episode_reward_min": -1316.3350567398659, "episode_reward_mean": -666.092462538375, "episode_len_mean": 138.94, "episode_media": {}, "episodes_timesteps_total": 13894, "policy_reward_min": {"policy_0": -1316.3350567398659}, "policy_reward_max": {"policy_0": -32.713632696955365}, "policy_reward_mean": {"policy_0": -666.092462538375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-756.8926980395709, -1013.7054314880972, -1066.2498309095852, -238.4235305240239, -794.8535097146499, -38.893506758649565, -707.6371378368086, -1076.9093038732676, -741.3234351700527, -821.2269053593118, -419.7836320667248, -651.5025726368746, -699.1438874310362, -541.592498970055, -220.64354173307305, -148.1978732829333, -213.9503980644005, -944.0415861780367, -162.8385050990909, -127.58984820595477, -1001.5716234959385, -481.89973157677383, -862.7493137123322, -246.28815414385383, -623.5573371979127, -684.8315462349302, -1018.2704004512618, -677.2955581676229, -756.9697610888835, -670.1777195162706, -571.5263636823381, -763.4004262155546, -485.56188418191897, -849.6698931885713, -394.4525117017608, -693.7654930482821, -255.20224164965174, -307.0406823133999, -503.9817239152068, -677.7701332191169, -815.9552421940249, -53.00977060020654, -659.4241554395356, -1262.6964272421824, -436.57476196874643, -1012.0044518791464, -367.45467837567844, -631.1096785952908, -1163.1868648750312, -540.1133726694059, -1209.9309918761974, -1149.4051067918788, -1209.9287534841674, -327.1659288211871, -795.2079278549015, -314.5674845338671, -76.42661987807374, -999.0749424036239, -654.4770476347077, -1070.8057978714576, -1105.4904052241545, -1031.992728554925, -931.5286969455417, -795.2671473328721, -716.7663263362026, -334.67266431357297, -707.4918138554973, -1090.2754333130026, -505.9877805873932, -307.5681892381055, -539.9901550367254, -622.2928973355077, -537.3761405891976, -610.4586939016715, -485.3920383342997, -846.9610840114273, -752.0848952159156, -649.1231554788774, -905.3392892956673, -32.713632696955365, -79.36402640430177, -842.4039187383761, -1032.7842937519129, -461.1681399845783, -873.2389784824652, -510.949255119872, -657.0959882516033, -987.2294316575081, -826.9253718149962, -461.92332992599074, -657.9749307111967, -840.8447906885274, -302.6558522977006, -1049.8828445824563, -1073.611411101304, -136.90717085573746, -711.1295961424855, -560.4016797079342, -1057.744882248089, -1316.3350567398659], "episode_lengths": [150, 150, 150, 118, 150, 56, 150, 150, 150, 150, 142, 150, 150, 150, 76, 97, 76, 150, 91, 59, 150, 150, 150, 136, 150, 150, 150, 150, 150, 150, 129, 150, 150, 150, 147, 150, 120, 88, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 146, 150, 150, 150, 150, 137, 150, 150, 140, 150, 125, 150, 150, 141, 150, 52, 63, 150, 150, 132, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150], "policy_policy_0_reward": [-756.8926980395709, -1013.7054314880972, -1066.2498309095852, -238.4235305240239, -794.8535097146499, -38.893506758649565, -707.6371378368086, -1076.9093038732676, -741.3234351700527, -821.2269053593118, -419.7836320667248, -651.5025726368746, -699.1438874310362, -541.592498970055, -220.64354173307305, -148.1978732829333, -213.9503980644005, -944.0415861780367, -162.8385050990909, -127.58984820595477, -1001.5716234959385, -481.89973157677383, -862.7493137123322, -246.28815414385383, -623.5573371979127, -684.8315462349302, -1018.2704004512618, -677.2955581676229, -756.9697610888835, -670.1777195162706, -571.5263636823381, -763.4004262155546, -485.56188418191897, -849.6698931885713, -394.4525117017608, -693.7654930482821, -255.20224164965174, -307.0406823133999, -503.9817239152068, -677.7701332191169, -815.9552421940249, -53.00977060020654, -659.4241554395356, -1262.6964272421824, -436.57476196874643, -1012.0044518791464, -367.45467837567844, -631.1096785952908, -1163.1868648750312, -540.1133726694059, -1209.9309918761974, -1149.4051067918788, -1209.9287534841674, -327.1659288211871, -795.2079278549015, -314.5674845338671, -76.42661987807374, -999.0749424036239, -654.4770476347077, -1070.8057978714576, -1105.4904052241545, -1031.992728554925, -931.5286969455417, -795.2671473328721, -716.7663263362026, -334.67266431357297, -707.4918138554973, -1090.2754333130026, -505.9877805873932, -307.5681892381055, -539.9901550367254, -622.2928973355077, -537.3761405891976, -610.4586939016715, -485.3920383342997, -846.9610840114273, -752.0848952159156, -649.1231554788774, -905.3392892956673, -32.713632696955365, -79.36402640430177, -842.4039187383761, -1032.7842937519129, -461.1681399845783, -873.2389784824652, -510.949255119872, -657.0959882516033, -987.2294316575081, -826.9253718149962, -461.92332992599074, -657.9749307111967, -840.8447906885274, -302.6558522977006, -1049.8828445824563, -1073.611411101304, -136.90717085573746, -711.1295961424855, -560.4016797079342, -1057.744882248089, -1316.3350567398659]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30047904381475254, "mean_inference_ms": 0.9544450532365726, "mean_action_processing_ms": 0.16766930311661704, "mean_env_wait_ms": 1.6764333805627656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006188392639160156, "StateBufferConnector_ms": 0.004400491714477539, "ViewRequirementAgentConnector_ms": 0.11131453514099121}, "num_episodes": 31, "episode_return_max": -32.713632696955365, "episode_return_min": -1316.3350567398659, "episode_return_mean": -666.092462538375, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.2586480948268, "num_env_steps_trained_throughput_per_sec": 288.2586480948268, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 13492.279, "restore_workers_time_ms": 0.023, "training_step_time_ms": 13492.211, "sample_time_ms": 2587.618, "learn_time_ms": 10887.463, "learn_throughput": 367.395, "synch_weights_time_ms": 16.293}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "6d52d_00000", "date": "2024-07-26_22-46-32", "timestamp": 1722014192, "time_this_iter_s": 13.883581638336182, "time_total_s": 148.6760356426239, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c311f30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 148.6760356426239, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 11.921052631578947, "ram_util_percent": 27.99473684210526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 93.11938382585843, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.617436144252618, "policy_loss": -0.007823915608848134, "vf_loss": 5.6353328866263235, "vf_explained_var": 0.9312204762051502, "kl": 0.016859062603149764, "entropy": 1.3444638227423031, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -22.187636808486104, "episode_reward_min": -1316.3350567398659, "episode_reward_mean": -701.6316704785601, "episode_len_mean": 141.13, "episode_media": {}, "episodes_timesteps_total": 14113, "policy_reward_min": {"policy_0": -1316.3350567398659}, "policy_reward_max": {"policy_0": -22.187636808486104}, "policy_reward_mean": {"policy_0": -701.6316704785601}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-756.9697610888835, -670.1777195162706, -571.5263636823381, -763.4004262155546, -485.56188418191897, -849.6698931885713, -394.4525117017608, -693.7654930482821, -255.20224164965174, -307.0406823133999, -503.9817239152068, -677.7701332191169, -815.9552421940249, -53.00977060020654, -659.4241554395356, -1262.6964272421824, -436.57476196874643, -1012.0044518791464, -367.45467837567844, -631.1096785952908, -1163.1868648750312, -540.1133726694059, -1209.9309918761974, -1149.4051067918788, -1209.9287534841674, -327.1659288211871, -795.2079278549015, -314.5674845338671, -76.42661987807374, -999.0749424036239, -654.4770476347077, -1070.8057978714576, -1105.4904052241545, -1031.992728554925, -931.5286969455417, -795.2671473328721, -716.7663263362026, -334.67266431357297, -707.4918138554973, -1090.2754333130026, -505.9877805873932, -307.5681892381055, -539.9901550367254, -622.2928973355077, -537.3761405891976, -610.4586939016715, -485.3920383342997, -846.9610840114273, -752.0848952159156, -649.1231554788774, -905.3392892956673, -32.713632696955365, -79.36402640430177, -842.4039187383761, -1032.7842937519129, -461.1681399845783, -873.2389784824652, -510.949255119872, -657.0959882516033, -987.2294316575081, -826.9253718149962, -461.92332992599074, -657.9749307111967, -840.8447906885274, -302.6558522977006, -1049.8828445824563, -1073.611411101304, -136.90717085573746, -711.1295961424855, -560.4016797079342, -1057.744882248089, -1316.3350567398659, -832.4684533740132, -1277.9450275144839, -734.0468316874742, -909.9788327149117, -106.85990548445288, -963.4106860068777, -357.4875922183951, -420.26262060733995, -1237.9487955793659, -95.38058952464796, -1153.2695999285602, -1070.310895227831, -951.6882624201716, -886.1860319967444, -22.187636808486104, -860.431592194199, -300.27316755311915, -496.40561637893296, -839.2360674639307, -797.1258890721547, -775.8521809367136, -830.7557748007464, -909.604582796562, -687.844528010316, -761.6508240550592, -534.1397183612997, -761.3071930195399, -961.7251966049931], "episode_lengths": [150, 150, 129, 150, 150, 150, 147, 150, 120, 88, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 146, 150, 150, 150, 150, 137, 150, 150, 140, 150, 125, 150, 150, 141, 150, 52, 63, 150, 150, 132, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 126, 150, 76, 150, 150, 150, 150, 47, 150, 150, 150, 150, 150, 150, 150, 150, 141, 150, 150, 150, 150], "policy_policy_0_reward": [-756.9697610888835, -670.1777195162706, -571.5263636823381, -763.4004262155546, -485.56188418191897, -849.6698931885713, -394.4525117017608, -693.7654930482821, -255.20224164965174, -307.0406823133999, -503.9817239152068, -677.7701332191169, -815.9552421940249, -53.00977060020654, -659.4241554395356, -1262.6964272421824, -436.57476196874643, -1012.0044518791464, -367.45467837567844, -631.1096785952908, -1163.1868648750312, -540.1133726694059, -1209.9309918761974, -1149.4051067918788, -1209.9287534841674, -327.1659288211871, -795.2079278549015, -314.5674845338671, -76.42661987807374, -999.0749424036239, -654.4770476347077, -1070.8057978714576, -1105.4904052241545, -1031.992728554925, -931.5286969455417, -795.2671473328721, -716.7663263362026, -334.67266431357297, -707.4918138554973, -1090.2754333130026, -505.9877805873932, -307.5681892381055, -539.9901550367254, -622.2928973355077, -537.3761405891976, -610.4586939016715, -485.3920383342997, -846.9610840114273, -752.0848952159156, -649.1231554788774, -905.3392892956673, -32.713632696955365, -79.36402640430177, -842.4039187383761, -1032.7842937519129, -461.1681399845783, -873.2389784824652, -510.949255119872, -657.0959882516033, -987.2294316575081, -826.9253718149962, -461.92332992599074, -657.9749307111967, -840.8447906885274, -302.6558522977006, -1049.8828445824563, -1073.611411101304, -136.90717085573746, -711.1295961424855, -560.4016797079342, -1057.744882248089, -1316.3350567398659, -832.4684533740132, -1277.9450275144839, -734.0468316874742, -909.9788327149117, -106.85990548445288, -963.4106860068777, -357.4875922183951, -420.26262060733995, -1237.9487955793659, -95.38058952464796, -1153.2695999285602, -1070.310895227831, -951.6882624201716, -886.1860319967444, -22.187636808486104, -860.431592194199, -300.27316755311915, -496.40561637893296, -839.2360674639307, -797.1258890721547, -775.8521809367136, -830.7557748007464, -909.604582796562, -687.844528010316, -761.6508240550592, -534.1397183612997, -761.3071930195399, -961.7251966049931]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.300535404963492, "mean_inference_ms": 0.9519956413808808, "mean_action_processing_ms": 0.16770787606448712, "mean_env_wait_ms": 1.6747579803483683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005915403366088867, "StateBufferConnector_ms": 0.0042231082916259766, "ViewRequirementAgentConnector_ms": 0.10651159286499023}, "num_episodes": 28, "episode_return_max": -22.187636808486104, "episode_return_min": -1316.3350567398659, "episode_return_mean": -701.6316704785601, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 291.3934457691943, "num_env_steps_trained_throughput_per_sec": 291.3934457691943, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 13487.729, "restore_workers_time_ms": 0.023, "training_step_time_ms": 13487.661, "sample_time_ms": 2587.316, "learn_time_ms": 10883.558, "learn_throughput": 367.527, "synch_weights_time_ms": 15.946}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "6d52d_00000", "date": "2024-07-26_22-46-46", "timestamp": 1722014206, "time_this_iter_s": 13.7358238697052, "time_total_s": 162.4118595123291, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d139df20f70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 162.4118595123291, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 10.495, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 86.95287372171879, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.2821079028149445, "policy_loss": -0.01774691232809952, "vf_loss": 5.309463637818893, "vf_explained_var": 0.935421538601319, "kl": 0.02029118799158218, "entropy": 1.3667053062468768, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -22.187636808486104, "episode_reward_min": -1316.3350567398659, "episode_reward_mean": -700.8174746432668, "episode_len_mean": 141.75, "episode_media": {}, "episodes_timesteps_total": 14175, "policy_reward_min": {"policy_0": -1316.3350567398659}, "policy_reward_max": {"policy_0": -22.187636808486104}, "policy_reward_mean": {"policy_0": -700.8174746432668}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-999.0749424036239, -654.4770476347077, -1070.8057978714576, -1105.4904052241545, -1031.992728554925, -931.5286969455417, -795.2671473328721, -716.7663263362026, -334.67266431357297, -707.4918138554973, -1090.2754333130026, -505.9877805873932, -307.5681892381055, -539.9901550367254, -622.2928973355077, -537.3761405891976, -610.4586939016715, -485.3920383342997, -846.9610840114273, -752.0848952159156, -649.1231554788774, -905.3392892956673, -32.713632696955365, -79.36402640430177, -842.4039187383761, -1032.7842937519129, -461.1681399845783, -873.2389784824652, -510.949255119872, -657.0959882516033, -987.2294316575081, -826.9253718149962, -461.92332992599074, -657.9749307111967, -840.8447906885274, -302.6558522977006, -1049.8828445824563, -1073.611411101304, -136.90717085573746, -711.1295961424855, -560.4016797079342, -1057.744882248089, -1316.3350567398659, -832.4684533740132, -1277.9450275144839, -734.0468316874742, -909.9788327149117, -106.85990548445288, -963.4106860068777, -357.4875922183951, -420.26262060733995, -1237.9487955793659, -95.38058952464796, -1153.2695999285602, -1070.310895227831, -951.6882624201716, -886.1860319967444, -22.187636808486104, -860.431592194199, -300.27316755311915, -496.40561637893296, -839.2360674639307, -797.1258890721547, -775.8521809367136, -830.7557748007464, -909.604582796562, -687.844528010316, -761.6508240550592, -534.1397183612997, -761.3071930195399, -961.7251966049931, -279.09880458604755, -576.6400533725342, -784.5453741258398, -546.2160018922027, -265.7752909385167, -640.6451599512183, -714.8183143761885, -1107.1636209742267, -1050.9515653950675, -339.0896399118327, -805.4382998716015, -996.9801903890497, -468.6406399196921, -589.8969812778811, -769.0788836877539, -379.8367922187843, -194.27828363271533, -466.67491166099575, -263.7125294272554, -1077.0283805234353, -916.5375354290268, -931.2489687373452, -1054.7097247927632, -433.3400907214869, -813.0473497940094, -429.62971495767204, -501.44212355447985, -1048.158415143073, -427.63782600846025], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 146, 150, 150, 150, 150, 137, 150, 150, 140, 150, 125, 150, 150, 141, 150, 52, 63, 150, 150, 132, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 126, 150, 76, 150, 150, 150, 150, 47, 150, 150, 150, 150, 150, 150, 150, 150, 141, 150, 150, 150, 150, 120, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 119, 105, 150, 81, 150, 150, 150, 150, 150, 150, 134, 150, 150, 150], "policy_policy_0_reward": [-999.0749424036239, -654.4770476347077, -1070.8057978714576, -1105.4904052241545, -1031.992728554925, -931.5286969455417, -795.2671473328721, -716.7663263362026, -334.67266431357297, -707.4918138554973, -1090.2754333130026, -505.9877805873932, -307.5681892381055, -539.9901550367254, -622.2928973355077, -537.3761405891976, -610.4586939016715, -485.3920383342997, -846.9610840114273, -752.0848952159156, -649.1231554788774, -905.3392892956673, -32.713632696955365, -79.36402640430177, -842.4039187383761, -1032.7842937519129, -461.1681399845783, -873.2389784824652, -510.949255119872, -657.0959882516033, -987.2294316575081, -826.9253718149962, -461.92332992599074, -657.9749307111967, -840.8447906885274, -302.6558522977006, -1049.8828445824563, -1073.611411101304, -136.90717085573746, -711.1295961424855, -560.4016797079342, -1057.744882248089, -1316.3350567398659, -832.4684533740132, -1277.9450275144839, -734.0468316874742, -909.9788327149117, -106.85990548445288, -963.4106860068777, -357.4875922183951, -420.26262060733995, -1237.9487955793659, -95.38058952464796, -1153.2695999285602, -1070.310895227831, -951.6882624201716, -886.1860319967444, -22.187636808486104, -860.431592194199, -300.27316755311915, -496.40561637893296, -839.2360674639307, -797.1258890721547, -775.8521809367136, -830.7557748007464, -909.604582796562, -687.844528010316, -761.6508240550592, -534.1397183612997, -761.3071930195399, -961.7251966049931, -279.09880458604755, -576.6400533725342, -784.5453741258398, -546.2160018922027, -265.7752909385167, -640.6451599512183, -714.8183143761885, -1107.1636209742267, -1050.9515653950675, -339.0896399118327, -805.4382998716015, -996.9801903890497, -468.6406399196921, -589.8969812778811, -769.0788836877539, -379.8367922187843, -194.27828363271533, -466.67491166099575, -263.7125294272554, -1077.0283805234353, -916.5375354290268, -931.2489687373452, -1054.7097247927632, -433.3400907214869, -813.0473497940094, -429.62971495767204, -501.44212355447985, -1048.158415143073, -427.63782600846025]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30012380222085616, "mean_inference_ms": 0.9486507042612468, "mean_action_processing_ms": 0.1673963306618098, "mean_env_wait_ms": 1.6734786956178402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005563974380493164, "StateBufferConnector_ms": 0.004102230072021484, "ViewRequirementAgentConnector_ms": 0.10311365127563477}, "num_episodes": 29, "episode_return_max": -22.187636808486104, "episode_return_min": -1316.3350567398659, "episode_return_mean": -700.8174746432668, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.9846917589667, "num_env_steps_trained_throughput_per_sec": 307.9846917589667, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 13447.901, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13447.829, "sample_time_ms": 2592.773, "learn_time_ms": 10837.616, "learn_throughput": 369.085, "synch_weights_time_ms": 16.603}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "6d52d_00000", "date": "2024-07-26_22-46-59", "timestamp": 1722014219, "time_this_iter_s": 12.99507737159729, "time_total_s": 175.4069368839264, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d139df212d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 175.4069368839264, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 11.305555555555557, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 93.04176153937975, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.758979708949725, "policy_loss": -0.010184808977646754, "vf_loss": 4.7771678596735, "vf_explained_var": 0.9674573309098681, "kl": 0.017294681941530145, "entropy": 1.319173310448726, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -22.187636808486104, "episode_reward_min": -1316.3350567398659, "episode_reward_mean": -714.1821729665502, "episode_len_mean": 143.01, "episode_media": {}, "episodes_timesteps_total": 14301, "policy_reward_min": {"policy_0": -1316.3350567398659}, "policy_reward_max": {"policy_0": -22.187636808486104}, "policy_reward_mean": {"policy_0": -714.1821729665502}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-873.2389784824652, -510.949255119872, -657.0959882516033, -987.2294316575081, -826.9253718149962, -461.92332992599074, -657.9749307111967, -840.8447906885274, -302.6558522977006, -1049.8828445824563, -1073.611411101304, -136.90717085573746, -711.1295961424855, -560.4016797079342, -1057.744882248089, -1316.3350567398659, -832.4684533740132, -1277.9450275144839, -734.0468316874742, -909.9788327149117, -106.85990548445288, -963.4106860068777, -357.4875922183951, -420.26262060733995, -1237.9487955793659, -95.38058952464796, -1153.2695999285602, -1070.310895227831, -951.6882624201716, -886.1860319967444, -22.187636808486104, -860.431592194199, -300.27316755311915, -496.40561637893296, -839.2360674639307, -797.1258890721547, -775.8521809367136, -830.7557748007464, -909.604582796562, -687.844528010316, -761.6508240550592, -534.1397183612997, -761.3071930195399, -961.7251966049931, -279.09880458604755, -576.6400533725342, -784.5453741258398, -546.2160018922027, -265.7752909385167, -640.6451599512183, -714.8183143761885, -1107.1636209742267, -1050.9515653950675, -339.0896399118327, -805.4382998716015, -996.9801903890497, -468.6406399196921, -589.8969812778811, -769.0788836877539, -379.8367922187843, -194.27828363271533, -466.67491166099575, -263.7125294272554, -1077.0283805234353, -916.5375354290268, -931.2489687373452, -1054.7097247927632, -433.3400907214869, -813.0473497940094, -429.62971495767204, -501.44212355447985, -1048.158415143073, -427.63782600846025, -1059.5614891908474, -919.4084779428393, -579.9624393357913, -653.033140150655, -837.3466978900258, -1118.0746164001903, -914.5352523936868, -1052.4180843270867, -898.3513239976226, -256.01487333246666, -422.2581526741737, -929.2892277480473, -570.046857227043, -381.5265165009997, -1133.8944525237068, -832.5230045049296, -322.87804427147523, -708.4163172435527, -1068.0995364097516, -1033.986193017102, -621.3189320545491, -479.2319630960225, -496.6886697405303, -31.148974074369224, -729.8132937166241, -1025.4671437406803, -910.0274932100492], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 126, 150, 76, 150, 150, 150, 150, 47, 150, 150, 150, 150, 150, 150, 150, 150, 141, 150, 150, 150, 150, 120, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 119, 105, 150, 81, 150, 150, 150, 150, 150, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 150], "policy_policy_0_reward": [-873.2389784824652, -510.949255119872, -657.0959882516033, -987.2294316575081, -826.9253718149962, -461.92332992599074, -657.9749307111967, -840.8447906885274, -302.6558522977006, -1049.8828445824563, -1073.611411101304, -136.90717085573746, -711.1295961424855, -560.4016797079342, -1057.744882248089, -1316.3350567398659, -832.4684533740132, -1277.9450275144839, -734.0468316874742, -909.9788327149117, -106.85990548445288, -963.4106860068777, -357.4875922183951, -420.26262060733995, -1237.9487955793659, -95.38058952464796, -1153.2695999285602, -1070.310895227831, -951.6882624201716, -886.1860319967444, -22.187636808486104, -860.431592194199, -300.27316755311915, -496.40561637893296, -839.2360674639307, -797.1258890721547, -775.8521809367136, -830.7557748007464, -909.604582796562, -687.844528010316, -761.6508240550592, -534.1397183612997, -761.3071930195399, -961.7251966049931, -279.09880458604755, -576.6400533725342, -784.5453741258398, -546.2160018922027, -265.7752909385167, -640.6451599512183, -714.8183143761885, -1107.1636209742267, -1050.9515653950675, -339.0896399118327, -805.4382998716015, -996.9801903890497, -468.6406399196921, -589.8969812778811, -769.0788836877539, -379.8367922187843, -194.27828363271533, -466.67491166099575, -263.7125294272554, -1077.0283805234353, -916.5375354290268, -931.2489687373452, -1054.7097247927632, -433.3400907214869, -813.0473497940094, -429.62971495767204, -501.44212355447985, -1048.158415143073, -427.63782600846025, -1059.5614891908474, -919.4084779428393, -579.9624393357913, -653.033140150655, -837.3466978900258, -1118.0746164001903, -914.5352523936868, -1052.4180843270867, -898.3513239976226, -256.01487333246666, -422.2581526741737, -929.2892277480473, -570.046857227043, -381.5265165009997, -1133.8944525237068, -832.5230045049296, -322.87804427147523, -708.4163172435527, -1068.0995364097516, -1033.986193017102, -621.3189320545491, -479.2319630960225, -496.6886697405303, -31.148974074369224, -729.8132937166241, -1025.4671437406803, -910.0274932100492]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2997093022823289, "mean_inference_ms": 0.9455741108636715, "mean_action_processing_ms": 0.1672392665924105, "mean_env_wait_ms": 1.6724069696745887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00535130500793457, "StateBufferConnector_ms": 0.00403285026550293, "ViewRequirementAgentConnector_ms": 0.10166311264038086}, "num_episodes": 27, "episode_return_max": -22.187636808486104, "episode_return_min": -1316.3350567398659, "episode_return_mean": -714.1821729665502, "episodes_this_iter": 27}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.33137288161043, "num_env_steps_trained_throughput_per_sec": 301.33137288161043, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 13305.881, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13305.811, "sample_time_ms": 2591.421, "learn_time_ms": 10696.742, "learn_throughput": 373.946, "synch_weights_time_ms": 16.82}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "6d52d_00000", "date": "2024-07-26_22-47-12", "timestamp": 1722014232, "time_this_iter_s": 13.283831357955933, "time_total_s": 188.69076824188232, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c39df30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 188.69076824188232, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 14.03157894736842, "ram_util_percent": 27.97368421052631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 118.66801919937134, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.440060557673375, "policy_loss": -0.012641110328452972, "vf_loss": 4.461344326535861, "vf_explained_var": 0.9610263934358955, "kl": 0.015667117219466807, "entropy": 1.3342788030703863, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -22.187636808486104, "episode_reward_min": -1266.0595011908288, "episode_reward_mean": -703.4094614600393, "episode_len_mean": 141.18, "episode_media": {}, "episodes_timesteps_total": 14118, "policy_reward_min": {"policy_0": -1266.0595011908288}, "policy_reward_max": {"policy_0": -22.187636808486104}, "policy_reward_mean": {"policy_0": -703.4094614600393}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-886.1860319967444, -22.187636808486104, -860.431592194199, -300.27316755311915, -496.40561637893296, -839.2360674639307, -797.1258890721547, -775.8521809367136, -830.7557748007464, -909.604582796562, -687.844528010316, -761.6508240550592, -534.1397183612997, -761.3071930195399, -961.7251966049931, -279.09880458604755, -576.6400533725342, -784.5453741258398, -546.2160018922027, -265.7752909385167, -640.6451599512183, -714.8183143761885, -1107.1636209742267, -1050.9515653950675, -339.0896399118327, -805.4382998716015, -996.9801903890497, -468.6406399196921, -589.8969812778811, -769.0788836877539, -379.8367922187843, -194.27828363271533, -466.67491166099575, -263.7125294272554, -1077.0283805234353, -916.5375354290268, -931.2489687373452, -1054.7097247927632, -433.3400907214869, -813.0473497940094, -429.62971495767204, -501.44212355447985, -1048.158415143073, -427.63782600846025, -1059.5614891908474, -919.4084779428393, -579.9624393357913, -653.033140150655, -837.3466978900258, -1118.0746164001903, -914.5352523936868, -1052.4180843270867, -898.3513239976226, -256.01487333246666, -422.2581526741737, -929.2892277480473, -570.046857227043, -381.5265165009997, -1133.8944525237068, -832.5230045049296, -322.87804427147523, -708.4163172435527, -1068.0995364097516, -1033.986193017102, -621.3189320545491, -479.2319630960225, -496.6886697405303, -31.148974074369224, -729.8132937166241, -1025.4671437406803, -910.0274932100492, -664.9150222997746, -1163.6980186620874, -379.2236944797322, -407.16089755274686, -103.08445144613208, -887.41957324097, -897.5741457831855, -485.605282254268, -863.9416966299871, -983.5276212062644, -1138.169591015916, -1110.527493045784, -583.6786034678122, -253.28686177596265, -1012.7703215236484, -747.535296142544, -1074.2396366987603, -654.8441335669767, -956.5155127535835, -780.6733548452002, -96.31181368209083, -428.1700816351175, -1005.8242798883008, -49.43156650830196, -1266.0595011908288, -696.9336291953547, -809.8908607056553, -908.8716519025119, -648.7529188656754], "episode_lengths": [150, 47, 150, 150, 150, 150, 150, 150, 150, 150, 141, 150, 150, 150, 150, 120, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 119, 105, 150, 81, 150, 150, 150, 150, 150, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150, 137, 116, 87, 150, 150, 124, 150, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 150, 49, 150, 150, 57, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-886.1860319967444, -22.187636808486104, -860.431592194199, -300.27316755311915, -496.40561637893296, -839.2360674639307, -797.1258890721547, -775.8521809367136, -830.7557748007464, -909.604582796562, -687.844528010316, -761.6508240550592, -534.1397183612997, -761.3071930195399, -961.7251966049931, -279.09880458604755, -576.6400533725342, -784.5453741258398, -546.2160018922027, -265.7752909385167, -640.6451599512183, -714.8183143761885, -1107.1636209742267, -1050.9515653950675, -339.0896399118327, -805.4382998716015, -996.9801903890497, -468.6406399196921, -589.8969812778811, -769.0788836877539, -379.8367922187843, -194.27828363271533, -466.67491166099575, -263.7125294272554, -1077.0283805234353, -916.5375354290268, -931.2489687373452, -1054.7097247927632, -433.3400907214869, -813.0473497940094, -429.62971495767204, -501.44212355447985, -1048.158415143073, -427.63782600846025, -1059.5614891908474, -919.4084779428393, -579.9624393357913, -653.033140150655, -837.3466978900258, -1118.0746164001903, -914.5352523936868, -1052.4180843270867, -898.3513239976226, -256.01487333246666, -422.2581526741737, -929.2892277480473, -570.046857227043, -381.5265165009997, -1133.8944525237068, -832.5230045049296, -322.87804427147523, -708.4163172435527, -1068.0995364097516, -1033.986193017102, -621.3189320545491, -479.2319630960225, -496.6886697405303, -31.148974074369224, -729.8132937166241, -1025.4671437406803, -910.0274932100492, -664.9150222997746, -1163.6980186620874, -379.2236944797322, -407.16089755274686, -103.08445144613208, -887.41957324097, -897.5741457831855, -485.605282254268, -863.9416966299871, -983.5276212062644, -1138.169591015916, -1110.527493045784, -583.6786034678122, -253.28686177596265, -1012.7703215236484, -747.535296142544, -1074.2396366987603, -654.8441335669767, -956.5155127535835, -780.6733548452002, -96.31181368209083, -428.1700816351175, -1005.8242798883008, -49.43156650830196, -1266.0595011908288, -696.9336291953547, -809.8908607056553, -908.8716519025119, -648.7529188656754]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2996946617669883, "mean_inference_ms": 0.9439795558995752, "mean_action_processing_ms": 0.1672074705747837, "mean_env_wait_ms": 1.6733932204788773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054624080657958984, "StateBufferConnector_ms": 0.00413060188293457, "ViewRequirementAgentConnector_ms": 0.10363531112670898}, "num_episodes": 29, "episode_return_max": -22.187636808486104, "episode_return_min": -1266.0595011908288, "episode_return_mean": -703.4094614600393, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.0642842246476, "num_env_steps_trained_throughput_per_sec": 303.0642842246476, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 13329.297, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13329.224, "sample_time_ms": 2602.946, "learn_time_ms": 10708.489, "learn_throughput": 373.535, "synch_weights_time_ms": 16.962}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "6d52d_00000", "date": "2024-07-26_22-47-25", "timestamp": 1722014245, "time_this_iter_s": 13.205637454986572, "time_total_s": 201.8964056968689, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c39eb00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 201.8964056968689, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 17.905263157894737, "ram_util_percent": 27.78421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 106.39155447284381, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.9683839472631615, "policy_loss": -0.016761365479032973, "vf_loss": 4.991105497131745, "vf_explained_var": 0.9652834864954154, "kl": 0.01654527382712939, "entropy": 1.0923747685427467, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -31.148974074369224, "episode_reward_min": -1266.0595011908288, "episode_reward_mean": -690.3156890347252, "episode_len_mean": 141.42, "episode_media": {}, "episodes_timesteps_total": 14142, "policy_reward_min": {"policy_0": -1266.0595011908288}, "policy_reward_max": {"policy_0": -31.148974074369224}, "policy_reward_mean": {"policy_0": -690.3156890347252}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-589.8969812778811, -769.0788836877539, -379.8367922187843, -194.27828363271533, -466.67491166099575, -263.7125294272554, -1077.0283805234353, -916.5375354290268, -931.2489687373452, -1054.7097247927632, -433.3400907214869, -813.0473497940094, -429.62971495767204, -501.44212355447985, -1048.158415143073, -427.63782600846025, -1059.5614891908474, -919.4084779428393, -579.9624393357913, -653.033140150655, -837.3466978900258, -1118.0746164001903, -914.5352523936868, -1052.4180843270867, -898.3513239976226, -256.01487333246666, -422.2581526741737, -929.2892277480473, -570.046857227043, -381.5265165009997, -1133.8944525237068, -832.5230045049296, -322.87804427147523, -708.4163172435527, -1068.0995364097516, -1033.986193017102, -621.3189320545491, -479.2319630960225, -496.6886697405303, -31.148974074369224, -729.8132937166241, -1025.4671437406803, -910.0274932100492, -664.9150222997746, -1163.6980186620874, -379.2236944797322, -407.16089755274686, -103.08445144613208, -887.41957324097, -897.5741457831855, -485.605282254268, -863.9416966299871, -983.5276212062644, -1138.169591015916, -1110.527493045784, -583.6786034678122, -253.28686177596265, -1012.7703215236484, -747.535296142544, -1074.2396366987603, -654.8441335669767, -956.5155127535835, -780.6733548452002, -96.31181368209083, -428.1700816351175, -1005.8242798883008, -49.43156650830196, -1266.0595011908288, -696.9336291953547, -809.8908607056553, -908.8716519025119, -648.7529188656754, -370.88166874615723, -136.14926578130377, -583.7087448067405, -668.5410416301088, -1120.4302727730196, -583.981607469892, -1210.7138139747628, -486.91948197180693, -1158.1972025049843, -636.3197078193714, -472.12476941811093, -321.741045158267, -917.8555517995463, -1029.3457595597035, -311.4316525815138, -512.2607537573494, -875.1929825878025, -321.14027774311137, -753.5822116809583, -550.383267805194, -573.0470857605662, -526.2710302885314, -335.6657142348453, -1012.9233163757754, -768.6280834138277, -575.629788147977, -326.5877768757175, -551.6978385584334], "episode_lengths": [150, 150, 119, 105, 150, 81, 150, 150, 150, 150, 150, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150, 137, 116, 87, 150, 150, 124, 150, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 150, 49, 150, 150, 57, 150, 150, 150, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 123, 150, 150, 150, 150, 150, 150, 150, 150, 119, 150], "policy_policy_0_reward": [-589.8969812778811, -769.0788836877539, -379.8367922187843, -194.27828363271533, -466.67491166099575, -263.7125294272554, -1077.0283805234353, -916.5375354290268, -931.2489687373452, -1054.7097247927632, -433.3400907214869, -813.0473497940094, -429.62971495767204, -501.44212355447985, -1048.158415143073, -427.63782600846025, -1059.5614891908474, -919.4084779428393, -579.9624393357913, -653.033140150655, -837.3466978900258, -1118.0746164001903, -914.5352523936868, -1052.4180843270867, -898.3513239976226, -256.01487333246666, -422.2581526741737, -929.2892277480473, -570.046857227043, -381.5265165009997, -1133.8944525237068, -832.5230045049296, -322.87804427147523, -708.4163172435527, -1068.0995364097516, -1033.986193017102, -621.3189320545491, -479.2319630960225, -496.6886697405303, -31.148974074369224, -729.8132937166241, -1025.4671437406803, -910.0274932100492, -664.9150222997746, -1163.6980186620874, -379.2236944797322, -407.16089755274686, -103.08445144613208, -887.41957324097, -897.5741457831855, -485.605282254268, -863.9416966299871, -983.5276212062644, -1138.169591015916, -1110.527493045784, -583.6786034678122, -253.28686177596265, -1012.7703215236484, -747.535296142544, -1074.2396366987603, -654.8441335669767, -956.5155127535835, -780.6733548452002, -96.31181368209083, -428.1700816351175, -1005.8242798883008, -49.43156650830196, -1266.0595011908288, -696.9336291953547, -809.8908607056553, -908.8716519025119, -648.7529188656754, -370.88166874615723, -136.14926578130377, -583.7087448067405, -668.5410416301088, -1120.4302727730196, -583.981607469892, -1210.7138139747628, -486.91948197180693, -1158.1972025049843, -636.3197078193714, -472.12476941811093, -321.741045158267, -917.8555517995463, -1029.3457595597035, -311.4316525815138, -512.2607537573494, -875.1929825878025, -321.14027774311137, -753.5822116809583, -550.383267805194, -573.0470857605662, -526.2710302885314, -335.6657142348453, -1012.9233163757754, -768.6280834138277, -575.629788147977, -326.5877768757175, -551.6978385584334]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29939693553960856, "mean_inference_ms": 0.9423392340842764, "mean_action_processing_ms": 0.16708756138358993, "mean_env_wait_ms": 1.6735015665593738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054857730865478516, "StateBufferConnector_ms": 0.004122018814086914, "ViewRequirementAgentConnector_ms": 0.10289144515991211}, "num_episodes": 28, "episode_return_max": -31.148974074369224, "episode_return_min": -1266.0595011908288, "episode_return_mean": -690.3156890347252, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 336.6387325194206, "num_env_steps_trained_throughput_per_sec": 336.6387325194206, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 13320.259, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13320.186, "sample_time_ms": 2597.237, "learn_time_ms": 10705.023, "learn_throughput": 373.656, "synch_weights_time_ms": 17.088}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "6d52d_00000", "date": "2024-07-26_22-47-37", "timestamp": 1722014257, "time_this_iter_s": 11.889622449874878, "time_total_s": 213.78602814674377, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c311ab0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 213.78602814674377, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 11.88823529411765, "ram_util_percent": 28.123529411764707}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 130.5213041206201, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.8405312632521, "policy_loss": -0.013047206907261473, "vf_loss": 4.860325141996145, "vf_explained_var": 0.9656262089808781, "kl": 0.01674574768051875, "entropy": 1.1770381756747763, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -31.148974074369224, "episode_reward_min": -1266.0595011908288, "episode_reward_mean": -680.9472307175903, "episode_len_mean": 140.85, "episode_media": {}, "episodes_timesteps_total": 14085, "policy_reward_min": {"policy_0": -1266.0595011908288}, "policy_reward_max": {"policy_0": -31.148974074369224}, "policy_reward_mean": {"policy_0": -680.9472307175903}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-570.046857227043, -381.5265165009997, -1133.8944525237068, -832.5230045049296, -322.87804427147523, -708.4163172435527, -1068.0995364097516, -1033.986193017102, -621.3189320545491, -479.2319630960225, -496.6886697405303, -31.148974074369224, -729.8132937166241, -1025.4671437406803, -910.0274932100492, -664.9150222997746, -1163.6980186620874, -379.2236944797322, -407.16089755274686, -103.08445144613208, -887.41957324097, -897.5741457831855, -485.605282254268, -863.9416966299871, -983.5276212062644, -1138.169591015916, -1110.527493045784, -583.6786034678122, -253.28686177596265, -1012.7703215236484, -747.535296142544, -1074.2396366987603, -654.8441335669767, -956.5155127535835, -780.6733548452002, -96.31181368209083, -428.1700816351175, -1005.8242798883008, -49.43156650830196, -1266.0595011908288, -696.9336291953547, -809.8908607056553, -908.8716519025119, -648.7529188656754, -370.88166874615723, -136.14926578130377, -583.7087448067405, -668.5410416301088, -1120.4302727730196, -583.981607469892, -1210.7138139747628, -486.91948197180693, -1158.1972025049843, -636.3197078193714, -472.12476941811093, -321.741045158267, -917.8555517995463, -1029.3457595597035, -311.4316525815138, -512.2607537573494, -875.1929825878025, -321.14027774311137, -753.5822116809583, -550.383267805194, -573.0470857605662, -526.2710302885314, -335.6657142348453, -1012.9233163757754, -768.6280834138277, -575.629788147977, -326.5877768757175, -551.6978385584334, -557.4891269552178, -320.8430274751032, -552.1641456999034, -714.4835119952113, -160.24745622387553, -740.8415706129447, -147.05765261003108, -1229.5752211090785, -1181.6265034412306, -874.9380748458934, -944.1215343319666, -403.81126471770835, -686.5129931786237, -379.04745349734736, -677.5372455081032, -308.1057614479891, -786.0506526435076, -920.1103147150432, -759.7681226707444, -1147.1084008631096, -137.39592002527436, -1036.7590855352971, -712.6524784744895, -674.6581623198067, -905.4967196251492, -358.4589634395319, -656.9870205876557, -1025.8180706872563], "episode_lengths": [150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150, 137, 116, 87, 150, 150, 124, 150, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 150, 49, 150, 150, 57, 150, 150, 150, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 123, 150, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 145, 143, 76, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-570.046857227043, -381.5265165009997, -1133.8944525237068, -832.5230045049296, -322.87804427147523, -708.4163172435527, -1068.0995364097516, -1033.986193017102, -621.3189320545491, -479.2319630960225, -496.6886697405303, -31.148974074369224, -729.8132937166241, -1025.4671437406803, -910.0274932100492, -664.9150222997746, -1163.6980186620874, -379.2236944797322, -407.16089755274686, -103.08445144613208, -887.41957324097, -897.5741457831855, -485.605282254268, -863.9416966299871, -983.5276212062644, -1138.169591015916, -1110.527493045784, -583.6786034678122, -253.28686177596265, -1012.7703215236484, -747.535296142544, -1074.2396366987603, -654.8441335669767, -956.5155127535835, -780.6733548452002, -96.31181368209083, -428.1700816351175, -1005.8242798883008, -49.43156650830196, -1266.0595011908288, -696.9336291953547, -809.8908607056553, -908.8716519025119, -648.7529188656754, -370.88166874615723, -136.14926578130377, -583.7087448067405, -668.5410416301088, -1120.4302727730196, -583.981607469892, -1210.7138139747628, -486.91948197180693, -1158.1972025049843, -636.3197078193714, -472.12476941811093, -321.741045158267, -917.8555517995463, -1029.3457595597035, -311.4316525815138, -512.2607537573494, -875.1929825878025, -321.14027774311137, -753.5822116809583, -550.383267805194, -573.0470857605662, -526.2710302885314, -335.6657142348453, -1012.9233163757754, -768.6280834138277, -575.629788147977, -326.5877768757175, -551.6978385584334, -557.4891269552178, -320.8430274751032, -552.1641456999034, -714.4835119952113, -160.24745622387553, -740.8415706129447, -147.05765261003108, -1229.5752211090785, -1181.6265034412306, -874.9380748458934, -944.1215343319666, -403.81126471770835, -686.5129931786237, -379.04745349734736, -677.5372455081032, -308.1057614479891, -786.0506526435076, -920.1103147150432, -759.7681226707444, -1147.1084008631096, -137.39592002527436, -1036.7590855352971, -712.6524784744895, -674.6581623198067, -905.4967196251492, -358.4589634395319, -656.9870205876557, -1025.8180706872563]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29932868645194527, "mean_inference_ms": 0.9411199508503719, "mean_action_processing_ms": 0.16694448862178823, "mean_env_wait_ms": 1.6737136645812982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005704402923583984, "StateBufferConnector_ms": 0.00413060188293457, "ViewRequirementAgentConnector_ms": 0.10387468338012695}, "num_episodes": 28, "episode_return_max": -31.148974074369224, "episode_return_min": -1266.0595011908288, "episode_return_mean": -680.9472307175903, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.93644643342344, "num_env_steps_trained_throughput_per_sec": 295.93644643342344, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 13292.524, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13292.453, "sample_time_ms": 2576.072, "learn_time_ms": 10699.12, "learn_throughput": 373.863, "synch_weights_time_ms": 16.428}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "6d52d_00000", "date": "2024-07-26_22-47-51", "timestamp": 1722014271, "time_this_iter_s": 13.52234172821045, "time_total_s": 227.30836987495422, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c3117e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 227.30836987495422, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 11.005263157894737, "ram_util_percent": 28.110526315789475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 147.74802744785944, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.9982094794511793, "policy_loss": -0.01148632859888797, "vf_loss": 4.018243757635355, "vf_explained_var": 0.9801843523358306, "kl": 0.017316890423050325, "entropy": 1.3743009024610122, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -30.306171235916217, "episode_reward_min": -1266.0595011908288, "episode_reward_mean": -678.6307284855839, "episode_len_mean": 141.76, "episode_media": {}, "episodes_timesteps_total": 14176, "policy_reward_min": {"policy_0": -1266.0595011908288}, "policy_reward_max": {"policy_0": -30.306171235916217}, "policy_reward_mean": {"policy_0": -678.6307284855839}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-253.28686177596265, -1012.7703215236484, -747.535296142544, -1074.2396366987603, -654.8441335669767, -956.5155127535835, -780.6733548452002, -96.31181368209083, -428.1700816351175, -1005.8242798883008, -49.43156650830196, -1266.0595011908288, -696.9336291953547, -809.8908607056553, -908.8716519025119, -648.7529188656754, -370.88166874615723, -136.14926578130377, -583.7087448067405, -668.5410416301088, -1120.4302727730196, -583.981607469892, -1210.7138139747628, -486.91948197180693, -1158.1972025049843, -636.3197078193714, -472.12476941811093, -321.741045158267, -917.8555517995463, -1029.3457595597035, -311.4316525815138, -512.2607537573494, -875.1929825878025, -321.14027774311137, -753.5822116809583, -550.383267805194, -573.0470857605662, -526.2710302885314, -335.6657142348453, -1012.9233163757754, -768.6280834138277, -575.629788147977, -326.5877768757175, -551.6978385584334, -557.4891269552178, -320.8430274751032, -552.1641456999034, -714.4835119952113, -160.24745622387553, -740.8415706129447, -147.05765261003108, -1229.5752211090785, -1181.6265034412306, -874.9380748458934, -944.1215343319666, -403.81126471770835, -686.5129931786237, -379.04745349734736, -677.5372455081032, -308.1057614479891, -786.0506526435076, -920.1103147150432, -759.7681226707444, -1147.1084008631096, -137.39592002527436, -1036.7590855352971, -712.6524784744895, -674.6581623198067, -905.4967196251492, -358.4589634395319, -656.9870205876557, -1025.8180706872563, -829.1885634441026, -340.0491806744658, -913.1145805290824, -708.2481436169431, -913.7774192228959, -30.306171235916217, -776.4040784576392, -869.942696155048, -954.9323081659392, -1069.066163618105, -476.6126917927866, -527.5197648851471, -321.24873202418087, -738.0417748229548, -478.49039391029896, -755.5110985985569, -859.0446350642667, -941.0466201570113, -899.5884170161046, -603.269214757291, -903.7578354023706, -888.5195838756721, -867.3970021597166, -862.1717448555843, -357.2573825982405, -397.74272557076137, -946.2061659969776, -553.4881706073553], "episode_lengths": [92, 150, 150, 150, 150, 150, 150, 49, 150, 150, 57, 150, 150, 150, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 123, 150, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 145, 143, 76, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 139, 150, 145, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 102, 123, 150, 150], "policy_policy_0_reward": [-253.28686177596265, -1012.7703215236484, -747.535296142544, -1074.2396366987603, -654.8441335669767, -956.5155127535835, -780.6733548452002, -96.31181368209083, -428.1700816351175, -1005.8242798883008, -49.43156650830196, -1266.0595011908288, -696.9336291953547, -809.8908607056553, -908.8716519025119, -648.7529188656754, -370.88166874615723, -136.14926578130377, -583.7087448067405, -668.5410416301088, -1120.4302727730196, -583.981607469892, -1210.7138139747628, -486.91948197180693, -1158.1972025049843, -636.3197078193714, -472.12476941811093, -321.741045158267, -917.8555517995463, -1029.3457595597035, -311.4316525815138, -512.2607537573494, -875.1929825878025, -321.14027774311137, -753.5822116809583, -550.383267805194, -573.0470857605662, -526.2710302885314, -335.6657142348453, -1012.9233163757754, -768.6280834138277, -575.629788147977, -326.5877768757175, -551.6978385584334, -557.4891269552178, -320.8430274751032, -552.1641456999034, -714.4835119952113, -160.24745622387553, -740.8415706129447, -147.05765261003108, -1229.5752211090785, -1181.6265034412306, -874.9380748458934, -944.1215343319666, -403.81126471770835, -686.5129931786237, -379.04745349734736, -677.5372455081032, -308.1057614479891, -786.0506526435076, -920.1103147150432, -759.7681226707444, -1147.1084008631096, -137.39592002527436, -1036.7590855352971, -712.6524784744895, -674.6581623198067, -905.4967196251492, -358.4589634395319, -656.9870205876557, -1025.8180706872563, -829.1885634441026, -340.0491806744658, -913.1145805290824, -708.2481436169431, -913.7774192228959, -30.306171235916217, -776.4040784576392, -869.942696155048, -954.9323081659392, -1069.066163618105, -476.6126917927866, -527.5197648851471, -321.24873202418087, -738.0417748229548, -478.49039391029896, -755.5110985985569, -859.0446350642667, -941.0466201570113, -899.5884170161046, -603.269214757291, -903.7578354023706, -888.5195838756721, -867.3970021597166, -862.1717448555843, -357.2573825982405, -397.74272557076137, -946.2061659969776, -553.4881706073553]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3003289803375827, "mean_inference_ms": 0.9436410766973478, "mean_action_processing_ms": 0.1674041700873349, "mean_env_wait_ms": 1.6798560810683034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006403923034667969, "StateBufferConnector_ms": 0.004410505294799805, "ViewRequirementAgentConnector_ms": 0.11112618446350098}, "num_episodes": 28, "episode_return_max": -30.306171235916217, "episode_return_min": -1266.0595011908288, "episode_return_mean": -678.6307284855839, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 350.67159109673077, "num_env_steps_trained_throughput_per_sec": 350.67159109673077, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 13017.032, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13016.961, "sample_time_ms": 2617.94, "learn_time_ms": 10381.951, "learn_throughput": 385.284, "synch_weights_time_ms": 16.254}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "6d52d_00000", "date": "2024-07-26_22-48-02", "timestamp": 1722014282, "time_this_iter_s": 11.41440725326538, "time_total_s": 238.7227771282196, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c313250>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 238.7227771282196, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 29.052941176470586, "ram_util_percent": 28.61764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 111.99564112027487, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.340885243068139, "policy_loss": -0.01144176501062854, "vf_loss": 4.359415064503749, "vf_explained_var": 0.9704105796913306, "kl": 0.015485704568891378, "entropy": 1.1733777841553092, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -30.306171235916217, "episode_reward_min": -1229.5752211090785, "episode_reward_mean": -660.7730192132277, "episode_len_mean": 139.67, "episode_media": {}, "episodes_timesteps_total": 13967, "policy_reward_min": {"policy_0": -1229.5752211090785}, "policy_reward_max": {"policy_0": -30.306171235916217}, "policy_reward_mean": {"policy_0": -660.7730192132277}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-512.2607537573494, -875.1929825878025, -321.14027774311137, -753.5822116809583, -550.383267805194, -573.0470857605662, -526.2710302885314, -335.6657142348453, -1012.9233163757754, -768.6280834138277, -575.629788147977, -326.5877768757175, -551.6978385584334, -557.4891269552178, -320.8430274751032, -552.1641456999034, -714.4835119952113, -160.24745622387553, -740.8415706129447, -147.05765261003108, -1229.5752211090785, -1181.6265034412306, -874.9380748458934, -944.1215343319666, -403.81126471770835, -686.5129931786237, -379.04745349734736, -677.5372455081032, -308.1057614479891, -786.0506526435076, -920.1103147150432, -759.7681226707444, -1147.1084008631096, -137.39592002527436, -1036.7590855352971, -712.6524784744895, -674.6581623198067, -905.4967196251492, -358.4589634395319, -656.9870205876557, -1025.8180706872563, -829.1885634441026, -340.0491806744658, -913.1145805290824, -708.2481436169431, -913.7774192228959, -30.306171235916217, -776.4040784576392, -869.942696155048, -954.9323081659392, -1069.066163618105, -476.6126917927866, -527.5197648851471, -321.24873202418087, -738.0417748229548, -478.49039391029896, -755.5110985985569, -859.0446350642667, -941.0466201570113, -899.5884170161046, -603.269214757291, -903.7578354023706, -888.5195838756721, -867.3970021597166, -862.1717448555843, -357.2573825982405, -397.74272557076137, -946.2061659969776, -553.4881706073553, -985.14921763726, -683.2855562219697, -204.0319330104397, -218.91320243078115, -723.499965776557, -448.80719087479537, -140.09589542030176, -857.0511664264994, -534.6799070661094, -517.638424556595, -793.9010336473148, -772.0687330810322, -1109.297091615624, -842.2582748993484, -640.3225618068657, -295.6267353763344, -918.6817885394157, -535.3553768581762, -182.3682633747843, -1003.9607751859985, -919.4861349587512, -621.8535893366586, -796.1436352908264, -1125.2288267881124, -857.5844642553797, -169.76119176298644, -114.81595267861935, -649.0150516844823, -58.301158544962924, -1156.0099584909574, -737.4890220422287], "episode_lengths": [150, 150, 123, 150, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 145, 143, 76, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 139, 150, 145, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 102, 123, 150, 150, 150, 150, 101, 80, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 88, 150, 150, 74, 150, 150, 150, 150, 150, 150, 102, 55, 150, 67, 150, 150], "policy_policy_0_reward": [-512.2607537573494, -875.1929825878025, -321.14027774311137, -753.5822116809583, -550.383267805194, -573.0470857605662, -526.2710302885314, -335.6657142348453, -1012.9233163757754, -768.6280834138277, -575.629788147977, -326.5877768757175, -551.6978385584334, -557.4891269552178, -320.8430274751032, -552.1641456999034, -714.4835119952113, -160.24745622387553, -740.8415706129447, -147.05765261003108, -1229.5752211090785, -1181.6265034412306, -874.9380748458934, -944.1215343319666, -403.81126471770835, -686.5129931786237, -379.04745349734736, -677.5372455081032, -308.1057614479891, -786.0506526435076, -920.1103147150432, -759.7681226707444, -1147.1084008631096, -137.39592002527436, -1036.7590855352971, -712.6524784744895, -674.6581623198067, -905.4967196251492, -358.4589634395319, -656.9870205876557, -1025.8180706872563, -829.1885634441026, -340.0491806744658, -913.1145805290824, -708.2481436169431, -913.7774192228959, -30.306171235916217, -776.4040784576392, -869.942696155048, -954.9323081659392, -1069.066163618105, -476.6126917927866, -527.5197648851471, -321.24873202418087, -738.0417748229548, -478.49039391029896, -755.5110985985569, -859.0446350642667, -941.0466201570113, -899.5884170161046, -603.269214757291, -903.7578354023706, -888.5195838756721, -867.3970021597166, -862.1717448555843, -357.2573825982405, -397.74272557076137, -946.2061659969776, -553.4881706073553, -985.14921763726, -683.2855562219697, -204.0319330104397, -218.91320243078115, -723.499965776557, -448.80719087479537, -140.09589542030176, -857.0511664264994, -534.6799070661094, -517.638424556595, -793.9010336473148, -772.0687330810322, -1109.297091615624, -842.2582748993484, -640.3225618068657, -295.6267353763344, -918.6817885394157, -535.3553768581762, -182.3682633747843, -1003.9607751859985, -919.4861349587512, -621.8535893366586, -796.1436352908264, -1125.2288267881124, -857.5844642553797, -169.76119176298644, -114.81595267861935, -649.0150516844823, -58.301158544962924, -1156.0099584909574, -737.4890220422287]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30124895802687623, "mean_inference_ms": 0.9457298382337939, "mean_action_processing_ms": 0.16775741963651764, "mean_env_wait_ms": 1.6836314679073872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062673091888427734, "StateBufferConnector_ms": 0.0043790340423583984, "ViewRequirementAgentConnector_ms": 0.11014151573181152}, "num_episodes": 31, "episode_return_max": -30.306171235916217, "episode_return_min": -1229.5752211090785, "episode_return_mean": -660.7730192132277, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.57347935395575, "num_env_steps_trained_throughput_per_sec": 296.57347935395575, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 13055.28, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13055.208, "sample_time_ms": 2595.674, "learn_time_ms": 10442.349, "learn_throughput": 383.056, "synch_weights_time_ms": 16.334}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "6d52d_00000", "date": "2024-07-26_22-48-16", "timestamp": 1722014296, "time_this_iter_s": 13.493480205535889, "time_total_s": 252.2162573337555, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c39de10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 252.2162573337555, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 12.489473684210525, "ram_util_percent": 29.036842105263162}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 117.58214269081752, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.104446010291577, "policy_loss": -0.014146840291990278, "vf_loss": 4.125114535291989, "vf_explained_var": 0.9735161435479919, "kl": 0.018644547547592105, "entropy": 1.2115052225068212, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -9.096399959874363, "episode_reward_min": -1161.502790635733, "episode_reward_mean": -662.5965252322634, "episode_len_mean": 136.92, "episode_media": {}, "episodes_timesteps_total": 13692, "policy_reward_min": {"policy_0": -1161.502790635733}, "policy_reward_max": {"policy_0": -9.096399959874363}, "policy_reward_mean": {"policy_0": -662.5965252322634}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-920.1103147150432, -759.7681226707444, -1147.1084008631096, -137.39592002527436, -1036.7590855352971, -712.6524784744895, -674.6581623198067, -905.4967196251492, -358.4589634395319, -656.9870205876557, -1025.8180706872563, -829.1885634441026, -340.0491806744658, -913.1145805290824, -708.2481436169431, -913.7774192228959, -30.306171235916217, -776.4040784576392, -869.942696155048, -954.9323081659392, -1069.066163618105, -476.6126917927866, -527.5197648851471, -321.24873202418087, -738.0417748229548, -478.49039391029896, -755.5110985985569, -859.0446350642667, -941.0466201570113, -899.5884170161046, -603.269214757291, -903.7578354023706, -888.5195838756721, -867.3970021597166, -862.1717448555843, -357.2573825982405, -397.74272557076137, -946.2061659969776, -553.4881706073553, -985.14921763726, -683.2855562219697, -204.0319330104397, -218.91320243078115, -723.499965776557, -448.80719087479537, -140.09589542030176, -857.0511664264994, -534.6799070661094, -517.638424556595, -793.9010336473148, -772.0687330810322, -1109.297091615624, -842.2582748993484, -640.3225618068657, -295.6267353763344, -918.6817885394157, -535.3553768581762, -182.3682633747843, -1003.9607751859985, -919.4861349587512, -621.8535893366586, -796.1436352908264, -1125.2288267881124, -857.5844642553797, -169.76119176298644, -114.81595267861935, -649.0150516844823, -58.301158544962924, -1156.0099584909574, -737.4890220422287, -469.31511172483755, -803.4033217155201, -1161.502790635733, -650.3638466014098, -543.7378205684679, -367.0133380752452, -615.5214248922856, -549.6101733496314, -760.3432653057961, -710.3512755211236, -110.53656518633439, -922.4148938626623, -59.21810030598007, -719.9424480185653, -363.8906619135569, -974.3301756807853, -709.8742796943787, -82.46637382137426, -426.31125042891745, -9.096399959874363, -1129.7414060190201, -973.8165088670481, -239.72675297915293, -369.8439465194992, -1128.942927295353, -742.2590585089573, -548.1543772317712, -991.4573251036999, -295.1621027788759, -1101.4660028615288], "episode_lengths": [150, 150, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 139, 150, 145, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 102, 123, 150, 150, 150, 150, 101, 80, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 88, 150, 150, 74, 150, 150, 150, 150, 150, 150, 102, 55, 150, 67, 150, 150, 126, 150, 150, 150, 150, 130, 150, 150, 150, 150, 69, 150, 65, 132, 150, 150, 150, 79, 150, 32, 150, 150, 150, 136, 150, 150, 150, 150, 111, 150], "policy_policy_0_reward": [-920.1103147150432, -759.7681226707444, -1147.1084008631096, -137.39592002527436, -1036.7590855352971, -712.6524784744895, -674.6581623198067, -905.4967196251492, -358.4589634395319, -656.9870205876557, -1025.8180706872563, -829.1885634441026, -340.0491806744658, -913.1145805290824, -708.2481436169431, -913.7774192228959, -30.306171235916217, -776.4040784576392, -869.942696155048, -954.9323081659392, -1069.066163618105, -476.6126917927866, -527.5197648851471, -321.24873202418087, -738.0417748229548, -478.49039391029896, -755.5110985985569, -859.0446350642667, -941.0466201570113, -899.5884170161046, -603.269214757291, -903.7578354023706, -888.5195838756721, -867.3970021597166, -862.1717448555843, -357.2573825982405, -397.74272557076137, -946.2061659969776, -553.4881706073553, -985.14921763726, -683.2855562219697, -204.0319330104397, -218.91320243078115, -723.499965776557, -448.80719087479537, -140.09589542030176, -857.0511664264994, -534.6799070661094, -517.638424556595, -793.9010336473148, -772.0687330810322, -1109.297091615624, -842.2582748993484, -640.3225618068657, -295.6267353763344, -918.6817885394157, -535.3553768581762, -182.3682633747843, -1003.9607751859985, -919.4861349587512, -621.8535893366586, -796.1436352908264, -1125.2288267881124, -857.5844642553797, -169.76119176298644, -114.81595267861935, -649.0150516844823, -58.301158544962924, -1156.0099584909574, -737.4890220422287, -469.31511172483755, -803.4033217155201, -1161.502790635733, -650.3638466014098, -543.7378205684679, -367.0133380752452, -615.5214248922856, -549.6101733496314, -760.3432653057961, -710.3512755211236, -110.53656518633439, -922.4148938626623, -59.21810030598007, -719.9424480185653, -363.8906619135569, -974.3301756807853, -709.8742796943787, -82.46637382137426, -426.31125042891745, -9.096399959874363, -1129.7414060190201, -973.8165088670481, -239.72675297915293, -369.8439465194992, -1128.942927295353, -742.2590585089573, -548.1543772317712, -991.4573251036999, -295.1621027788759, -1101.4660028615288]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3020595103900537, "mean_inference_ms": 0.9477042624361887, "mean_action_processing_ms": 0.16809283703544842, "mean_env_wait_ms": 1.6891107536629761, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006357669830322266, "StateBufferConnector_ms": 0.004401683807373047, "ViewRequirementAgentConnector_ms": 0.11037135124206543}, "num_episodes": 30, "episode_return_max": -9.096399959874363, "episode_return_min": -1161.502790635733, "episode_return_mean": -662.5965252322634, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.28414048895377, "num_env_steps_trained_throughput_per_sec": 295.28414048895377, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 13090.325, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13090.252, "sample_time_ms": 2593.864, "learn_time_ms": 10479.199, "learn_throughput": 381.709, "synch_weights_time_ms": 16.327}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "6d52d_00000", "date": "2024-07-26_22-48-29", "timestamp": 1722014309, "time_this_iter_s": 13.552180290222168, "time_total_s": 265.76843762397766, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c39ecb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 265.76843762397766, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 13.236842105263158, "ram_util_percent": 28.76842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 154.81392972071964, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.8817786373198033, "policy_loss": -0.008940844491007738, "vf_loss": 3.8975671395659446, "vf_explained_var": 0.981931468533973, "kl": 0.01738644646679861, "entropy": 1.2063588231801987, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -9.096399959874363, "episode_reward_min": -1263.485153928835, "episode_reward_mean": -634.5042825167967, "episode_len_mean": 132.8, "episode_media": {}, "episodes_timesteps_total": 13280, "policy_reward_min": {"policy_0": -1263.485153928835}, "policy_reward_max": {"policy_0": -9.096399959874363}, "policy_reward_mean": {"policy_0": -634.5042825167967}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-903.7578354023706, -888.5195838756721, -867.3970021597166, -862.1717448555843, -357.2573825982405, -397.74272557076137, -946.2061659969776, -553.4881706073553, -985.14921763726, -683.2855562219697, -204.0319330104397, -218.91320243078115, -723.499965776557, -448.80719087479537, -140.09589542030176, -857.0511664264994, -534.6799070661094, -517.638424556595, -793.9010336473148, -772.0687330810322, -1109.297091615624, -842.2582748993484, -640.3225618068657, -295.6267353763344, -918.6817885394157, -535.3553768581762, -182.3682633747843, -1003.9607751859985, -919.4861349587512, -621.8535893366586, -796.1436352908264, -1125.2288267881124, -857.5844642553797, -169.76119176298644, -114.81595267861935, -649.0150516844823, -58.301158544962924, -1156.0099584909574, -737.4890220422287, -469.31511172483755, -803.4033217155201, -1161.502790635733, -650.3638466014098, -543.7378205684679, -367.0133380752452, -615.5214248922856, -549.6101733496314, -760.3432653057961, -710.3512755211236, -110.53656518633439, -922.4148938626623, -59.21810030598007, -719.9424480185653, -363.8906619135569, -974.3301756807853, -709.8742796943787, -82.46637382137426, -426.31125042891745, -9.096399959874363, -1129.7414060190201, -973.8165088670481, -239.72675297915293, -369.8439465194992, -1128.942927295353, -742.2590585089573, -548.1543772317712, -991.4573251036999, -295.1621027788759, -1101.4660028615288, -1263.485153928835, -1102.5282552415017, -180.6136273991923, -646.0538035145439, -1038.1869629949626, -495.8546368376422, -681.7471059129301, -489.48241199827584, -141.73350937939483, -644.0123158987274, -1157.0967403857107, -717.721232560089, -861.5351914273767, -60.5012436883024, -237.36682768184252, -59.29548164913042, -576.2222248012772, -849.3662451503568, -883.9916856344777, -896.4880358832972, -790.7200981874727, -831.9818835130573, -782.3448153715663, -833.7714759949947, -495.47585757610375, -90.31650282325889, -11.054623989254353, -1146.0298556218534, -400.3258926904135, -1100.8782767513571, -65.20966105823955], "episode_lengths": [150, 150, 150, 150, 102, 123, 150, 150, 150, 150, 101, 80, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 88, 150, 150, 74, 150, 150, 150, 150, 150, 150, 102, 55, 150, 67, 150, 150, 126, 150, 150, 150, 150, 130, 150, 150, 150, 150, 69, 150, 65, 132, 150, 150, 150, 79, 150, 32, 150, 150, 150, 136, 150, 150, 150, 150, 111, 150, 150, 150, 81, 150, 150, 120, 150, 150, 92, 150, 150, 150, 150, 64, 133, 68, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 46, 150, 150, 150, 75], "policy_policy_0_reward": [-903.7578354023706, -888.5195838756721, -867.3970021597166, -862.1717448555843, -357.2573825982405, -397.74272557076137, -946.2061659969776, -553.4881706073553, -985.14921763726, -683.2855562219697, -204.0319330104397, -218.91320243078115, -723.499965776557, -448.80719087479537, -140.09589542030176, -857.0511664264994, -534.6799070661094, -517.638424556595, -793.9010336473148, -772.0687330810322, -1109.297091615624, -842.2582748993484, -640.3225618068657, -295.6267353763344, -918.6817885394157, -535.3553768581762, -182.3682633747843, -1003.9607751859985, -919.4861349587512, -621.8535893366586, -796.1436352908264, -1125.2288267881124, -857.5844642553797, -169.76119176298644, -114.81595267861935, -649.0150516844823, -58.301158544962924, -1156.0099584909574, -737.4890220422287, -469.31511172483755, -803.4033217155201, -1161.502790635733, -650.3638466014098, -543.7378205684679, -367.0133380752452, -615.5214248922856, -549.6101733496314, -760.3432653057961, -710.3512755211236, -110.53656518633439, -922.4148938626623, -59.21810030598007, -719.9424480185653, -363.8906619135569, -974.3301756807853, -709.8742796943787, -82.46637382137426, -426.31125042891745, -9.096399959874363, -1129.7414060190201, -973.8165088670481, -239.72675297915293, -369.8439465194992, -1128.942927295353, -742.2590585089573, -548.1543772317712, -991.4573251036999, -295.1621027788759, -1101.4660028615288, -1263.485153928835, -1102.5282552415017, -180.6136273991923, -646.0538035145439, -1038.1869629949626, -495.8546368376422, -681.7471059129301, -489.48241199827584, -141.73350937939483, -644.0123158987274, -1157.0967403857107, -717.721232560089, -861.5351914273767, -60.5012436883024, -237.36682768184252, -59.29548164913042, -576.2222248012772, -849.3662451503568, -883.9916856344777, -896.4880358832972, -790.7200981874727, -831.9818835130573, -782.3448153715663, -833.7714759949947, -495.47585757610375, -90.31650282325889, -11.054623989254353, -1146.0298556218534, -400.3258926904135, -1100.8782767513571, -65.20966105823955]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30218026273487736, "mean_inference_ms": 0.9477060779625955, "mean_action_processing_ms": 0.16820668099794767, "mean_env_wait_ms": 1.6870272275565457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006064891815185547, "StateBufferConnector_ms": 0.004220008850097656, "ViewRequirementAgentConnector_ms": 0.10572338104248047}, "num_episodes": 31, "episode_return_max": -9.096399959874363, "episode_return_min": -1263.485153928835, "episode_return_mean": -634.5042825167967, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 278.8173285239833, "num_env_steps_trained_throughput_per_sec": 278.8173285239833, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 13137.313, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13137.24, "sample_time_ms": 2614.164, "learn_time_ms": 10506.381, "learn_throughput": 380.721, "synch_weights_time_ms": 15.841}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "6d52d_00000", "date": "2024-07-26_22-48-44", "timestamp": 1722014324, "time_this_iter_s": 14.354780673980713, "time_total_s": 280.1232182979584, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c39f5b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 280.1232182979584, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 12.83333333333333, "ram_util_percent": 28.752380952380957}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 155.4198445002238, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.995747599254052, "policy_loss": -0.012881257609114983, "vf_loss": 4.014583086967468, "vf_explained_var": 0.957277005041639, "kl": 0.019143721943752728, "entropy": 1.1697354381904006, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -9.096399959874363, "episode_reward_min": -1283.9125438591893, "episode_reward_mean": -648.4042068342983, "episode_len_mean": 131.9, "episode_media": {}, "episodes_timesteps_total": 13190, "policy_reward_min": {"policy_0": -1283.9125438591893}, "policy_reward_max": {"policy_0": -9.096399959874363}, "policy_reward_mean": {"policy_0": -648.4042068342983}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-621.8535893366586, -796.1436352908264, -1125.2288267881124, -857.5844642553797, -169.76119176298644, -114.81595267861935, -649.0150516844823, -58.301158544962924, -1156.0099584909574, -737.4890220422287, -469.31511172483755, -803.4033217155201, -1161.502790635733, -650.3638466014098, -543.7378205684679, -367.0133380752452, -615.5214248922856, -549.6101733496314, -760.3432653057961, -710.3512755211236, -110.53656518633439, -922.4148938626623, -59.21810030598007, -719.9424480185653, -363.8906619135569, -974.3301756807853, -709.8742796943787, -82.46637382137426, -426.31125042891745, -9.096399959874363, -1129.7414060190201, -973.8165088670481, -239.72675297915293, -369.8439465194992, -1128.942927295353, -742.2590585089573, -548.1543772317712, -991.4573251036999, -295.1621027788759, -1101.4660028615288, -1263.485153928835, -1102.5282552415017, -180.6136273991923, -646.0538035145439, -1038.1869629949626, -495.8546368376422, -681.7471059129301, -489.48241199827584, -141.73350937939483, -644.0123158987274, -1157.0967403857107, -717.721232560089, -861.5351914273767, -60.5012436883024, -237.36682768184252, -59.29548164913042, -576.2222248012772, -849.3662451503568, -883.9916856344777, -896.4880358832972, -790.7200981874727, -831.9818835130573, -782.3448153715663, -833.7714759949947, -495.47585757610375, -90.31650282325889, -11.054623989254353, -1146.0298556218534, -400.3258926904135, -1100.8782767513571, -65.20966105823955, -923.3923565511164, -1030.1136164095124, -890.4958379811169, -186.93928552362598, -480.1376296207296, -1084.7398029329543, -861.9235311753596, -232.16358797892144, -762.8441938329887, -801.4753360538864, -1073.1159629177105, -770.9593095432447, -53.14924228652916, -1050.004206197048, -1283.9125438591893, -525.8398019847524, -401.4816398156112, -939.5987407837488, -165.50146698075415, -747.9314867366139, -940.4056331920792, -247.72348991436513, -410.97317566712945, -994.6972891600207, -961.4430332166331, -765.1368647966607, -209.73008935807565, -835.7501727119491, -861.4329443994566], "episode_lengths": [150, 150, 150, 150, 102, 55, 150, 67, 150, 150, 126, 150, 150, 150, 150, 130, 150, 150, 150, 150, 69, 150, 65, 132, 150, 150, 150, 79, 150, 32, 150, 150, 150, 136, 150, 150, 150, 150, 111, 150, 150, 150, 81, 150, 150, 120, 150, 150, 92, 150, 150, 150, 150, 64, 133, 68, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 46, 150, 150, 150, 75, 150, 150, 150, 80, 117, 150, 150, 69, 150, 150, 150, 150, 59, 150, 150, 150, 106, 150, 87, 150, 150, 106, 117, 150, 150, 150, 96, 150, 150], "policy_policy_0_reward": [-621.8535893366586, -796.1436352908264, -1125.2288267881124, -857.5844642553797, -169.76119176298644, -114.81595267861935, -649.0150516844823, -58.301158544962924, -1156.0099584909574, -737.4890220422287, -469.31511172483755, -803.4033217155201, -1161.502790635733, -650.3638466014098, -543.7378205684679, -367.0133380752452, -615.5214248922856, -549.6101733496314, -760.3432653057961, -710.3512755211236, -110.53656518633439, -922.4148938626623, -59.21810030598007, -719.9424480185653, -363.8906619135569, -974.3301756807853, -709.8742796943787, -82.46637382137426, -426.31125042891745, -9.096399959874363, -1129.7414060190201, -973.8165088670481, -239.72675297915293, -369.8439465194992, -1128.942927295353, -742.2590585089573, -548.1543772317712, -991.4573251036999, -295.1621027788759, -1101.4660028615288, -1263.485153928835, -1102.5282552415017, -180.6136273991923, -646.0538035145439, -1038.1869629949626, -495.8546368376422, -681.7471059129301, -489.48241199827584, -141.73350937939483, -644.0123158987274, -1157.0967403857107, -717.721232560089, -861.5351914273767, -60.5012436883024, -237.36682768184252, -59.29548164913042, -576.2222248012772, -849.3662451503568, -883.9916856344777, -896.4880358832972, -790.7200981874727, -831.9818835130573, -782.3448153715663, -833.7714759949947, -495.47585757610375, -90.31650282325889, -11.054623989254353, -1146.0298556218534, -400.3258926904135, -1100.8782767513571, -65.20966105823955, -923.3923565511164, -1030.1136164095124, -890.4958379811169, -186.93928552362598, -480.1376296207296, -1084.7398029329543, -861.9235311753596, -232.16358797892144, -762.8441938329887, -801.4753360538864, -1073.1159629177105, -770.9593095432447, -53.14924228652916, -1050.004206197048, -1283.9125438591893, -525.8398019847524, -401.4816398156112, -939.5987407837488, -165.50146698075415, -747.9314867366139, -940.4056331920792, -247.72348991436513, -410.97317566712945, -994.6972891600207, -961.4430332166331, -765.1368647966607, -209.73008935807565, -835.7501727119491, -861.4329443994566]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3021595311012468, "mean_inference_ms": 0.9468876012010129, "mean_action_processing_ms": 0.168156666393616, "mean_env_wait_ms": 1.6884883669442792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005852460861206055, "StateBufferConnector_ms": 0.00410771369934082, "ViewRequirementAgentConnector_ms": 0.10373520851135254}, "num_episodes": 29, "episode_return_max": -9.096399959874363, "episode_return_min": -1283.9125438591893, "episode_return_mean": -648.4042068342983, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.1767423445829, "num_env_steps_trained_throughput_per_sec": 292.1767423445829, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 13133.633, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13133.56, "sample_time_ms": 2624.171, "learn_time_ms": 10492.431, "learn_throughput": 381.227, "synch_weights_time_ms": 16.117}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "6d52d_00000", "date": "2024-07-26_22-48-57", "timestamp": 1722014337, "time_this_iter_s": 13.699611902236938, "time_total_s": 293.8228302001953, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c312cb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 293.8228302001953, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 11.647368421052633, "ram_util_percent": 28.673684210526318}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 137.10597720742226, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.873413210362196, "policy_loss": -0.008988866057673779, "vf_loss": 3.8888444932798545, "vf_explained_var": 0.9676238314559062, "kl": 0.016178385782344196, "entropy": 1.1295945919429262, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -2.1280009930567734, "episode_reward_min": -1283.9125438591893, "episode_reward_mean": -659.4433781587115, "episode_len_mean": 132.84, "episode_media": {}, "episodes_timesteps_total": 13284, "policy_reward_min": {"policy_0": -1283.9125438591893}, "policy_reward_max": {"policy_0": -2.1280009930567734}, "policy_reward_mean": {"policy_0": -659.4433781587115}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1129.7414060190201, -973.8165088670481, -239.72675297915293, -369.8439465194992, -1128.942927295353, -742.2590585089573, -548.1543772317712, -991.4573251036999, -295.1621027788759, -1101.4660028615288, -1263.485153928835, -1102.5282552415017, -180.6136273991923, -646.0538035145439, -1038.1869629949626, -495.8546368376422, -681.7471059129301, -489.48241199827584, -141.73350937939483, -644.0123158987274, -1157.0967403857107, -717.721232560089, -861.5351914273767, -60.5012436883024, -237.36682768184252, -59.29548164913042, -576.2222248012772, -849.3662451503568, -883.9916856344777, -896.4880358832972, -790.7200981874727, -831.9818835130573, -782.3448153715663, -833.7714759949947, -495.47585757610375, -90.31650282325889, -11.054623989254353, -1146.0298556218534, -400.3258926904135, -1100.8782767513571, -65.20966105823955, -923.3923565511164, -1030.1136164095124, -890.4958379811169, -186.93928552362598, -480.1376296207296, -1084.7398029329543, -861.9235311753596, -232.16358797892144, -762.8441938329887, -801.4753360538864, -1073.1159629177105, -770.9593095432447, -53.14924228652916, -1050.004206197048, -1283.9125438591893, -525.8398019847524, -401.4816398156112, -939.5987407837488, -165.50146698075415, -747.9314867366139, -940.4056331920792, -247.72348991436513, -410.97317566712945, -994.6972891600207, -961.4430332166331, -765.1368647966607, -209.73008935807565, -835.7501727119491, -861.4329443994566, -386.04707607459363, -882.1402159779824, -834.6002589939778, -828.6526325943889, -257.7260970995548, -384.0802368263588, -531.4498169316133, -741.9488531577813, -675.8088513293483, -1138.055798756953, -468.95200334595796, -563.8786825636134, -441.396936181366, -1139.516999179667, -2.1280009930567734, -390.87705086655444, -542.530031228753, -165.356274489962, -576.6448863284605, -745.4825575049188, -830.863761186492, -751.2777175235473, -99.38810583689094, -871.3961871018585, -945.1301926845438, -622.6672371615873, -767.0260395561451, -875.4701025936993, -48.66052408811685, -890.2103724212819], "episode_lengths": [150, 150, 150, 136, 150, 150, 150, 150, 111, 150, 150, 150, 81, 150, 150, 120, 150, 150, 92, 150, 150, 150, 150, 64, 133, 68, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 46, 150, 150, 150, 75, 150, 150, 150, 80, 117, 150, 150, 69, 150, 150, 150, 150, 59, 150, 150, 150, 106, 150, 87, 150, 150, 106, 117, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 81, 102, 130, 150, 150, 150, 113, 150, 139, 150, 37, 150, 150, 58, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 57, 150], "policy_policy_0_reward": [-1129.7414060190201, -973.8165088670481, -239.72675297915293, -369.8439465194992, -1128.942927295353, -742.2590585089573, -548.1543772317712, -991.4573251036999, -295.1621027788759, -1101.4660028615288, -1263.485153928835, -1102.5282552415017, -180.6136273991923, -646.0538035145439, -1038.1869629949626, -495.8546368376422, -681.7471059129301, -489.48241199827584, -141.73350937939483, -644.0123158987274, -1157.0967403857107, -717.721232560089, -861.5351914273767, -60.5012436883024, -237.36682768184252, -59.29548164913042, -576.2222248012772, -849.3662451503568, -883.9916856344777, -896.4880358832972, -790.7200981874727, -831.9818835130573, -782.3448153715663, -833.7714759949947, -495.47585757610375, -90.31650282325889, -11.054623989254353, -1146.0298556218534, -400.3258926904135, -1100.8782767513571, -65.20966105823955, -923.3923565511164, -1030.1136164095124, -890.4958379811169, -186.93928552362598, -480.1376296207296, -1084.7398029329543, -861.9235311753596, -232.16358797892144, -762.8441938329887, -801.4753360538864, -1073.1159629177105, -770.9593095432447, -53.14924228652916, -1050.004206197048, -1283.9125438591893, -525.8398019847524, -401.4816398156112, -939.5987407837488, -165.50146698075415, -747.9314867366139, -940.4056331920792, -247.72348991436513, -410.97317566712945, -994.6972891600207, -961.4430332166331, -765.1368647966607, -209.73008935807565, -835.7501727119491, -861.4329443994566, -386.04707607459363, -882.1402159779824, -834.6002589939778, -828.6526325943889, -257.7260970995548, -384.0802368263588, -531.4498169316133, -741.9488531577813, -675.8088513293483, -1138.055798756953, -468.95200334595796, -563.8786825636134, -441.396936181366, -1139.516999179667, -2.1280009930567734, -390.87705086655444, -542.530031228753, -165.356274489962, -576.6448863284605, -745.4825575049188, -830.863761186492, -751.2777175235473, -99.38810583689094, -871.3961871018585, -945.1301926845438, -622.6672371615873, -767.0260395561451, -875.4701025936993, -48.66052408811685, -890.2103724212819]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3024322229039695, "mean_inference_ms": 0.9466171631707422, "mean_action_processing_ms": 0.16817400365408772, "mean_env_wait_ms": 1.6901668085558708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005919933319091797, "StateBufferConnector_ms": 0.004178047180175781, "ViewRequirementAgentConnector_ms": 0.1062154769897461}, "num_episodes": 30, "episode_return_max": -2.1280009930567734, "episode_return_min": -1283.9125438591893, "episode_return_mean": -659.4433781587115, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 289.3343441825791, "num_env_steps_trained_throughput_per_sec": 289.3343441825791, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 13217.35, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13217.28, "sample_time_ms": 2629.368, "learn_time_ms": 10571.483, "learn_throughput": 378.376, "synch_weights_time_ms": 15.602}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "6d52d_00000", "date": "2024-07-26_22-49-11", "timestamp": 1722014351, "time_this_iter_s": 13.833096981048584, "time_total_s": 307.6559271812439, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c313010>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 307.6559271812439, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 10.715, "ram_util_percent": 28.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 179.79166163603466, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.727118358264367, "policy_loss": -0.008430553680712667, "vf_loss": 3.7419147796928884, "vf_explained_var": 0.9647857019056877, "kl": 0.01927040388163735, "entropy": 1.2146986894930403, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -2.1280009930567734, "episode_reward_min": -1283.9125438591893, "episode_reward_mean": -669.2689374788348, "episode_len_mean": 133.1, "episode_media": {}, "episodes_timesteps_total": 13310, "policy_reward_min": {"policy_0": -1283.9125438591893}, "policy_reward_max": {"policy_0": -2.1280009930567734}, "policy_reward_mean": {"policy_0": -669.2689374788348}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-790.7200981874727, -831.9818835130573, -782.3448153715663, -833.7714759949947, -495.47585757610375, -90.31650282325889, -11.054623989254353, -1146.0298556218534, -400.3258926904135, -1100.8782767513571, -65.20966105823955, -923.3923565511164, -1030.1136164095124, -890.4958379811169, -186.93928552362598, -480.1376296207296, -1084.7398029329543, -861.9235311753596, -232.16358797892144, -762.8441938329887, -801.4753360538864, -1073.1159629177105, -770.9593095432447, -53.14924228652916, -1050.004206197048, -1283.9125438591893, -525.8398019847524, -401.4816398156112, -939.5987407837488, -165.50146698075415, -747.9314867366139, -940.4056331920792, -247.72348991436513, -410.97317566712945, -994.6972891600207, -961.4430332166331, -765.1368647966607, -209.73008935807565, -835.7501727119491, -861.4329443994566, -386.04707607459363, -882.1402159779824, -834.6002589939778, -828.6526325943889, -257.7260970995548, -384.0802368263588, -531.4498169316133, -741.9488531577813, -675.8088513293483, -1138.055798756953, -468.95200334595796, -563.8786825636134, -441.396936181366, -1139.516999179667, -2.1280009930567734, -390.87705086655444, -542.530031228753, -165.356274489962, -576.6448863284605, -745.4825575049188, -830.863761186492, -751.2777175235473, -99.38810583689094, -871.3961871018585, -945.1301926845438, -622.6672371615873, -767.0260395561451, -875.4701025936993, -48.66052408811685, -890.2103724212819, -607.9344021088468, -796.6527937915923, -263.67637840977306, -83.10177970983834, -920.1277109424349, -716.3760308376332, -388.60134546702596, -985.8771044268899, -208.53704881865698, -404.60327979670086, -1236.3210032921386, -775.0806898474025, -26.098397865799384, -1044.5699450198078, -989.9021595736742, -1156.7710771893787, -779.7415652296709, -26.565267162341904, -559.3326964864833, -987.0748144948116, -758.3446104605089, -758.0302748677037, -706.9395309776472, -938.494442408185, -333.10015385858674, -1116.2042760291429, -939.9060717933015, -899.1051455061198, -896.5337812636343, -1182.805254509377], "episode_lengths": [150, 150, 150, 150, 150, 70, 46, 150, 150, 150, 75, 150, 150, 150, 80, 117, 150, 150, 69, 150, 150, 150, 150, 59, 150, 150, 150, 106, 150, 87, 150, 150, 106, 117, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 81, 102, 130, 150, 150, 150, 113, 150, 139, 150, 37, 150, 150, 58, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 57, 150, 150, 150, 150, 61, 150, 150, 150, 150, 76, 150, 150, 150, 53, 150, 150, 150, 150, 61, 137, 150, 150, 143, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-790.7200981874727, -831.9818835130573, -782.3448153715663, -833.7714759949947, -495.47585757610375, -90.31650282325889, -11.054623989254353, -1146.0298556218534, -400.3258926904135, -1100.8782767513571, -65.20966105823955, -923.3923565511164, -1030.1136164095124, -890.4958379811169, -186.93928552362598, -480.1376296207296, -1084.7398029329543, -861.9235311753596, -232.16358797892144, -762.8441938329887, -801.4753360538864, -1073.1159629177105, -770.9593095432447, -53.14924228652916, -1050.004206197048, -1283.9125438591893, -525.8398019847524, -401.4816398156112, -939.5987407837488, -165.50146698075415, -747.9314867366139, -940.4056331920792, -247.72348991436513, -410.97317566712945, -994.6972891600207, -961.4430332166331, -765.1368647966607, -209.73008935807565, -835.7501727119491, -861.4329443994566, -386.04707607459363, -882.1402159779824, -834.6002589939778, -828.6526325943889, -257.7260970995548, -384.0802368263588, -531.4498169316133, -741.9488531577813, -675.8088513293483, -1138.055798756953, -468.95200334595796, -563.8786825636134, -441.396936181366, -1139.516999179667, -2.1280009930567734, -390.87705086655444, -542.530031228753, -165.356274489962, -576.6448863284605, -745.4825575049188, -830.863761186492, -751.2777175235473, -99.38810583689094, -871.3961871018585, -945.1301926845438, -622.6672371615873, -767.0260395561451, -875.4701025936993, -48.66052408811685, -890.2103724212819, -607.9344021088468, -796.6527937915923, -263.67637840977306, -83.10177970983834, -920.1277109424349, -716.3760308376332, -388.60134546702596, -985.8771044268899, -208.53704881865698, -404.60327979670086, -1236.3210032921386, -775.0806898474025, -26.098397865799384, -1044.5699450198078, -989.9021595736742, -1156.7710771893787, -779.7415652296709, -26.565267162341904, -559.3326964864833, -987.0748144948116, -758.3446104605089, -758.0302748677037, -706.9395309776472, -938.494442408185, -333.10015385858674, -1116.2042760291429, -939.9060717933015, -899.1051455061198, -896.5337812636343, -1182.805254509377]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3023382909679339, "mean_inference_ms": 0.9459351605260997, "mean_action_processing_ms": 0.16806264560013795, "mean_env_wait_ms": 1.6891732940038424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058040618896484375, "StateBufferConnector_ms": 0.004163265228271484, "ViewRequirementAgentConnector_ms": 0.10574078559875488}, "num_episodes": 30, "episode_return_max": -2.1280009930567734, "episode_return_min": -1283.9125438591893, "episode_return_mean": -669.2689374788348, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.25528586012155, "num_env_steps_trained_throughput_per_sec": 292.25528586012155, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 13258.575, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13258.504, "sample_time_ms": 2636.77, "learn_time_ms": 10605.457, "learn_throughput": 377.164, "synch_weights_time_ms": 15.454}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "6d52d_00000", "date": "2024-07-26_22-49-25", "timestamp": 1722014365, "time_this_iter_s": 13.692437410354614, "time_total_s": 321.3483645915985, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c39cee0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 321.3483645915985, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 10.357894736842104, "ram_util_percent": 28.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 166.80328356226286, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.7523411894838015, "policy_loss": -0.013304420634328077, "vf_loss": 3.7706354392071564, "vf_explained_var": 0.9894835108891129, "kl": 0.019094273518749136, "entropy": 1.0718111981948217, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -2.1280009930567734, "episode_reward_min": -1236.3210032921386, "episode_reward_mean": -644.0956273203972, "episode_len_mean": 133.64, "episode_media": {}, "episodes_timesteps_total": 13364, "policy_reward_min": {"policy_0": -1236.3210032921386}, "policy_reward_max": {"policy_0": -2.1280009930567734}, "policy_reward_mean": {"policy_0": -644.0956273203972}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-165.50146698075415, -747.9314867366139, -940.4056331920792, -247.72348991436513, -410.97317566712945, -994.6972891600207, -961.4430332166331, -765.1368647966607, -209.73008935807565, -835.7501727119491, -861.4329443994566, -386.04707607459363, -882.1402159779824, -834.6002589939778, -828.6526325943889, -257.7260970995548, -384.0802368263588, -531.4498169316133, -741.9488531577813, -675.8088513293483, -1138.055798756953, -468.95200334595796, -563.8786825636134, -441.396936181366, -1139.516999179667, -2.1280009930567734, -390.87705086655444, -542.530031228753, -165.356274489962, -576.6448863284605, -745.4825575049188, -830.863761186492, -751.2777175235473, -99.38810583689094, -871.3961871018585, -945.1301926845438, -622.6672371615873, -767.0260395561451, -875.4701025936993, -48.66052408811685, -890.2103724212819, -607.9344021088468, -796.6527937915923, -263.67637840977306, -83.10177970983834, -920.1277109424349, -716.3760308376332, -388.60134546702596, -985.8771044268899, -208.53704881865698, -404.60327979670086, -1236.3210032921386, -775.0806898474025, -26.098397865799384, -1044.5699450198078, -989.9021595736742, -1156.7710771893787, -779.7415652296709, -26.565267162341904, -559.3326964864833, -987.0748144948116, -758.3446104605089, -758.0302748677037, -706.9395309776472, -938.494442408185, -333.10015385858674, -1116.2042760291429, -939.9060717933015, -899.1051455061198, -896.5337812636343, -1182.805254509377, -604.2982272210708, -508.87022558606856, -1128.3538035404267, -999.7749694044974, -381.912250410528, -783.3541331919691, -1089.8332549927882, -714.9654835839609, -728.4032892849625, -854.5192962268333, -286.38766940938433, -657.4797521624263, -284.49461430948224, -106.50251203108968, -903.7120684998882, -298.6557444435335, -134.73498683234595, -272.4527658343241, -213.49531415005285, -581.1063373693905, -914.311730654061, -167.8543640106327, -1091.4484959286706, -1108.1534405664463, -139.4928714505437, -1109.7505548680633, -328.5380809295367, -27.953574399309513, -962.2547418895592], "episode_lengths": [87, 150, 150, 106, 117, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 81, 102, 130, 150, 150, 150, 113, 150, 139, 150, 37, 150, 150, 58, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 57, 150, 150, 150, 150, 61, 150, 150, 150, 150, 76, 150, 150, 150, 53, 150, 150, 150, 150, 61, 137, 150, 150, 143, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 120, 150, 150, 63, 150, 145, 67, 89, 120, 150, 150, 94, 150, 150, 78, 150, 150, 50, 150], "policy_policy_0_reward": [-165.50146698075415, -747.9314867366139, -940.4056331920792, -247.72348991436513, -410.97317566712945, -994.6972891600207, -961.4430332166331, -765.1368647966607, -209.73008935807565, -835.7501727119491, -861.4329443994566, -386.04707607459363, -882.1402159779824, -834.6002589939778, -828.6526325943889, -257.7260970995548, -384.0802368263588, -531.4498169316133, -741.9488531577813, -675.8088513293483, -1138.055798756953, -468.95200334595796, -563.8786825636134, -441.396936181366, -1139.516999179667, -2.1280009930567734, -390.87705086655444, -542.530031228753, -165.356274489962, -576.6448863284605, -745.4825575049188, -830.863761186492, -751.2777175235473, -99.38810583689094, -871.3961871018585, -945.1301926845438, -622.6672371615873, -767.0260395561451, -875.4701025936993, -48.66052408811685, -890.2103724212819, -607.9344021088468, -796.6527937915923, -263.67637840977306, -83.10177970983834, -920.1277109424349, -716.3760308376332, -388.60134546702596, -985.8771044268899, -208.53704881865698, -404.60327979670086, -1236.3210032921386, -775.0806898474025, -26.098397865799384, -1044.5699450198078, -989.9021595736742, -1156.7710771893787, -779.7415652296709, -26.565267162341904, -559.3326964864833, -987.0748144948116, -758.3446104605089, -758.0302748677037, -706.9395309776472, -938.494442408185, -333.10015385858674, -1116.2042760291429, -939.9060717933015, -899.1051455061198, -896.5337812636343, -1182.805254509377, -604.2982272210708, -508.87022558606856, -1128.3538035404267, -999.7749694044974, -381.912250410528, -783.3541331919691, -1089.8332549927882, -714.9654835839609, -728.4032892849625, -854.5192962268333, -286.38766940938433, -657.4797521624263, -284.49461430948224, -106.50251203108968, -903.7120684998882, -298.6557444435335, -134.73498683234595, -272.4527658343241, -213.49531415005285, -581.1063373693905, -914.311730654061, -167.8543640106327, -1091.4484959286706, -1108.1534405664463, -139.4928714505437, -1109.7505548680633, -328.5380809295367, -27.953574399309513, -962.2547418895592]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30229146013005853, "mean_inference_ms": 0.944853561015793, "mean_action_processing_ms": 0.1679550032834296, "mean_env_wait_ms": 1.6904968447593616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00584721565246582, "StateBufferConnector_ms": 0.004162788391113281, "ViewRequirementAgentConnector_ms": 0.10572934150695801}, "num_episodes": 29, "episode_return_max": -2.1280009930567734, "episode_return_min": -1236.3210032921386, "episode_return_mean": -644.0956273203972, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.6713303179871, "num_env_steps_trained_throughput_per_sec": 299.6713303179871, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 13273.518, "restore_workers_time_ms": 0.023, "training_step_time_ms": 13273.449, "sample_time_ms": 2614.266, "learn_time_ms": 10642.781, "learn_throughput": 375.842, "synch_weights_time_ms": 15.574}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "training_iteration": 25, "trial_id": "6d52d_00000", "date": "2024-07-26_22-49-38", "timestamp": 1722014378, "time_this_iter_s": 13.355302810668945, "time_total_s": 334.70366740226746, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c39ce50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 334.70366740226746, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 16.23157894736842, "ram_util_percent": 28.599999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 152.80093172589937, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.460418038566908, "policy_loss": -0.010080568266857881, "vf_loss": 4.476180862387022, "vf_explained_var": 0.9468029159431656, "kl": 0.0169320804011174, "entropy": 1.0761872058734299, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "env_runners": {"episode_reward_max": -26.098397865799384, "episode_reward_min": -1236.3210032921386, "episode_reward_mean": -642.5013216070037, "episode_len_mean": 134.15, "episode_media": {}, "episodes_timesteps_total": 13415, "policy_reward_min": {"policy_0": -1236.3210032921386}, "policy_reward_max": {"policy_0": -26.098397865799384}, "policy_reward_mean": {"policy_0": -642.5013216070037}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-751.2777175235473, -99.38810583689094, -871.3961871018585, -945.1301926845438, -622.6672371615873, -767.0260395561451, -875.4701025936993, -48.66052408811685, -890.2103724212819, -607.9344021088468, -796.6527937915923, -263.67637840977306, -83.10177970983834, -920.1277109424349, -716.3760308376332, -388.60134546702596, -985.8771044268899, -208.53704881865698, -404.60327979670086, -1236.3210032921386, -775.0806898474025, -26.098397865799384, -1044.5699450198078, -989.9021595736742, -1156.7710771893787, -779.7415652296709, -26.565267162341904, -559.3326964864833, -987.0748144948116, -758.3446104605089, -758.0302748677037, -706.9395309776472, -938.494442408185, -333.10015385858674, -1116.2042760291429, -939.9060717933015, -899.1051455061198, -896.5337812636343, -1182.805254509377, -604.2982272210708, -508.87022558606856, -1128.3538035404267, -999.7749694044974, -381.912250410528, -783.3541331919691, -1089.8332549927882, -714.9654835839609, -728.4032892849625, -854.5192962268333, -286.38766940938433, -657.4797521624263, -284.49461430948224, -106.50251203108968, -903.7120684998882, -298.6557444435335, -134.73498683234595, -272.4527658343241, -213.49531415005285, -581.1063373693905, -914.311730654061, -167.8543640106327, -1091.4484959286706, -1108.1534405664463, -139.4928714505437, -1109.7505548680633, -328.5380809295367, -27.953574399309513, -962.2547418895592, -1224.033502525397, -450.23645432085834, -378.01157251792444, -723.062762980911, -551.8171336842433, -444.20037699253163, -852.3684267195223, -995.3123422012651, -517.7683531719488, -144.41611646280546, -330.08265788661686, -421.0490184988051, -797.089233794144, -205.0476886609233, -700.3430488044187, -643.3898617106987, -402.7352481115938, -1017.5597973881922, -899.3644135494964, -531.9182844425111, -254.2327505901001, -295.51346074363556, -127.14785082941629, -241.66173067451965, -1159.010357587797, -1026.7209381330206, -838.2500292978332, -1076.9962597178076, -754.5954560959276, -600.4983830070246, -740.7964738697623, -164.20211143409145], "episode_lengths": [150, 84, 150, 150, 150, 150, 150, 57, 150, 150, 150, 150, 61, 150, 150, 150, 150, 76, 150, 150, 150, 53, 150, 150, 150, 150, 61, 137, 150, 150, 143, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 120, 150, 150, 63, 150, 145, 67, 89, 120, 150, 150, 94, 150, 150, 78, 150, 150, 50, 150, 150, 150, 112, 150, 122, 150, 150, 150, 150, 77, 87, 101, 150, 111, 150, 141, 150, 150, 150, 150, 138, 112, 91, 79, 150, 150, 150, 150, 150, 150, 150, 96], "policy_policy_0_reward": [-751.2777175235473, -99.38810583689094, -871.3961871018585, -945.1301926845438, -622.6672371615873, -767.0260395561451, -875.4701025936993, -48.66052408811685, -890.2103724212819, -607.9344021088468, -796.6527937915923, -263.67637840977306, -83.10177970983834, -920.1277109424349, -716.3760308376332, -388.60134546702596, -985.8771044268899, -208.53704881865698, -404.60327979670086, -1236.3210032921386, -775.0806898474025, -26.098397865799384, -1044.5699450198078, -989.9021595736742, -1156.7710771893787, -779.7415652296709, -26.565267162341904, -559.3326964864833, -987.0748144948116, -758.3446104605089, -758.0302748677037, -706.9395309776472, -938.494442408185, -333.10015385858674, -1116.2042760291429, -939.9060717933015, -899.1051455061198, -896.5337812636343, -1182.805254509377, -604.2982272210708, -508.87022558606856, -1128.3538035404267, -999.7749694044974, -381.912250410528, -783.3541331919691, -1089.8332549927882, -714.9654835839609, -728.4032892849625, -854.5192962268333, -286.38766940938433, -657.4797521624263, -284.49461430948224, -106.50251203108968, -903.7120684998882, -298.6557444435335, -134.73498683234595, -272.4527658343241, -213.49531415005285, -581.1063373693905, -914.311730654061, -167.8543640106327, -1091.4484959286706, -1108.1534405664463, -139.4928714505437, -1109.7505548680633, -328.5380809295367, -27.953574399309513, -962.2547418895592, -1224.033502525397, -450.23645432085834, -378.01157251792444, -723.062762980911, -551.8171336842433, -444.20037699253163, -852.3684267195223, -995.3123422012651, -517.7683531719488, -144.41611646280546, -330.08265788661686, -421.0490184988051, -797.089233794144, -205.0476886609233, -700.3430488044187, -643.3898617106987, -402.7352481115938, -1017.5597973881922, -899.3644135494964, -531.9182844425111, -254.2327505901001, -295.51346074363556, -127.14785082941629, -241.66173067451965, -1159.010357587797, -1026.7209381330206, -838.2500292978332, -1076.9962597178076, -754.5954560959276, -600.4983830070246, -740.7964738697623, -164.20211143409145]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30191832774258065, "mean_inference_ms": 0.9437824555189593, "mean_action_processing_ms": 0.16780980374173537, "mean_env_wait_ms": 1.6881177744443618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005944013595581055, "StateBufferConnector_ms": 0.004246711730957031, "ViewRequirementAgentConnector_ms": 0.10754203796386719}, "num_episodes": 32, "episode_return_max": -26.098397865799384, "episode_return_min": -1236.3210032921386, "episode_return_mean": -642.5013216070037, "episodes_this_iter": 32}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 273.43264094719484, "num_env_steps_trained_throughput_per_sec": 273.43264094719484, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 13548.183, "restore_workers_time_ms": 0.022, "training_step_time_ms": 13548.115, "sample_time_ms": 2653.832, "learn_time_ms": 10877.724, "learn_throughput": 367.724, "synch_weights_time_ms": 15.741}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "training_iteration": 26, "trial_id": "6d52d_00000", "date": "2024-07-26_22-49-53", "timestamp": 1722014393, "time_this_iter_s": 14.63792610168457, "time_total_s": 349.341593503952, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c39fac0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 349.341593503952, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 15.238095238095235, "ram_util_percent": 28.79047619047619}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 159.19748302499454, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.021480527023474, "policy_loss": -0.010125985848814405, "vf_loss": 4.037922825912634, "vf_explained_var": 0.9772393356387814, "kl": 0.017475483411787254, "entropy": 1.1558952441439032, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "env_runners": {"episode_reward_max": -26.565267162341904, "episode_reward_min": -1224.033502525397, "episode_reward_mean": -641.3646885981384, "episode_len_mean": 135.34, "episode_media": {}, "episodes_timesteps_total": 13534, "policy_reward_min": {"policy_0": -1224.033502525397}, "policy_reward_max": {"policy_0": -26.565267162341904}, "policy_reward_mean": {"policy_0": -641.3646885981384}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.565267162341904, -559.3326964864833, -987.0748144948116, -758.3446104605089, -758.0302748677037, -706.9395309776472, -938.494442408185, -333.10015385858674, -1116.2042760291429, -939.9060717933015, -899.1051455061198, -896.5337812636343, -1182.805254509377, -604.2982272210708, -508.87022558606856, -1128.3538035404267, -999.7749694044974, -381.912250410528, -783.3541331919691, -1089.8332549927882, -714.9654835839609, -728.4032892849625, -854.5192962268333, -286.38766940938433, -657.4797521624263, -284.49461430948224, -106.50251203108968, -903.7120684998882, -298.6557444435335, -134.73498683234595, -272.4527658343241, -213.49531415005285, -581.1063373693905, -914.311730654061, -167.8543640106327, -1091.4484959286706, -1108.1534405664463, -139.4928714505437, -1109.7505548680633, -328.5380809295367, -27.953574399309513, -962.2547418895592, -1224.033502525397, -450.23645432085834, -378.01157251792444, -723.062762980911, -551.8171336842433, -444.20037699253163, -852.3684267195223, -995.3123422012651, -517.7683531719488, -144.41611646280546, -330.08265788661686, -421.0490184988051, -797.089233794144, -205.0476886609233, -700.3430488044187, -643.3898617106987, -402.7352481115938, -1017.5597973881922, -899.3644135494964, -531.9182844425111, -254.2327505901001, -295.51346074363556, -127.14785082941629, -241.66173067451965, -1159.010357587797, -1026.7209381330206, -838.2500292978332, -1076.9962597178076, -754.5954560959276, -600.4983830070246, -740.7964738697623, -164.20211143409145, -1029.18033623099, -1187.0184488440605, -969.5501433191299, -434.68929598254414, -135.46848468041136, -573.8042167898592, -932.7970411019573, -784.3504894695436, -466.0873548801246, -957.3070639959077, -348.5189868828287, -396.6353755626913, -379.9263685822027, -1040.969281526721, -269.726649190859, -254.2183596885028, -718.8675058633868, -416.29057765976717, -450.07626921732196, -847.4932255455055, -1008.1403551232779, -464.47195540606737, -1058.1718833316893, -899.0205210382354, -891.762922989549, -226.99277750527926], "episode_lengths": [61, 137, 150, 150, 143, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 120, 150, 150, 63, 150, 145, 67, 89, 120, 150, 150, 94, 150, 150, 78, 150, 150, 50, 150, 150, 150, 112, 150, 122, 150, 150, 150, 150, 77, 87, 101, 150, 111, 150, 141, 150, 150, 150, 150, 138, 112, 91, 79, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 82, 150, 150, 150, 150, 150, 96, 150, 150, 150, 102, 85, 150, 109, 141, 150, 150, 148, 150, 150, 150, 137], "policy_policy_0_reward": [-26.565267162341904, -559.3326964864833, -987.0748144948116, -758.3446104605089, -758.0302748677037, -706.9395309776472, -938.494442408185, -333.10015385858674, -1116.2042760291429, -939.9060717933015, -899.1051455061198, -896.5337812636343, -1182.805254509377, -604.2982272210708, -508.87022558606856, -1128.3538035404267, -999.7749694044974, -381.912250410528, -783.3541331919691, -1089.8332549927882, -714.9654835839609, -728.4032892849625, -854.5192962268333, -286.38766940938433, -657.4797521624263, -284.49461430948224, -106.50251203108968, -903.7120684998882, -298.6557444435335, -134.73498683234595, -272.4527658343241, -213.49531415005285, -581.1063373693905, -914.311730654061, -167.8543640106327, -1091.4484959286706, -1108.1534405664463, -139.4928714505437, -1109.7505548680633, -328.5380809295367, -27.953574399309513, -962.2547418895592, -1224.033502525397, -450.23645432085834, -378.01157251792444, -723.062762980911, -551.8171336842433, -444.20037699253163, -852.3684267195223, -995.3123422012651, -517.7683531719488, -144.41611646280546, -330.08265788661686, -421.0490184988051, -797.089233794144, -205.0476886609233, -700.3430488044187, -643.3898617106987, -402.7352481115938, -1017.5597973881922, -899.3644135494964, -531.9182844425111, -254.2327505901001, -295.51346074363556, -127.14785082941629, -241.66173067451965, -1159.010357587797, -1026.7209381330206, -838.2500292978332, -1076.9962597178076, -754.5954560959276, -600.4983830070246, -740.7964738697623, -164.20211143409145, -1029.18033623099, -1187.0184488440605, -969.5501433191299, -434.68929598254414, -135.46848468041136, -573.8042167898592, -932.7970411019573, -784.3504894695436, -466.0873548801246, -957.3070639959077, -348.5189868828287, -396.6353755626913, -379.9263685822027, -1040.969281526721, -269.726649190859, -254.2183596885028, -718.8675058633868, -416.29057765976717, -450.07626921732196, -847.4932255455055, -1008.1403551232779, -464.47195540606737, -1058.1718833316893, -899.0205210382354, -891.762922989549, -226.99277750527926]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3021632525403116, "mean_inference_ms": 0.9434015082069525, "mean_action_processing_ms": 0.16786668911773653, "mean_env_wait_ms": 1.690685836056082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005948305130004883, "StateBufferConnector_ms": 0.004185199737548828, "ViewRequirementAgentConnector_ms": 0.10580277442932129}, "num_episodes": 26, "episode_return_max": -26.565267162341904, "episode_return_min": -1224.033502525397, "episode_return_mean": -641.3646885981384, "episodes_this_iter": 26}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 286.4144127435479, "num_env_steps_trained_throughput_per_sec": 286.4144127435479, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 13593.12, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13593.046, "sample_time_ms": 2651.376, "learn_time_ms": 10924.971, "learn_throughput": 366.134, "synch_weights_time_ms": 15.885}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "training_iteration": 27, "trial_id": "6d52d_00000", "date": "2024-07-26_22-50-07", "timestamp": 1722014407, "time_this_iter_s": 13.971335172653198, "time_total_s": 363.3129286766052, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c39fc70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 363.3129286766052, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 12.325, "ram_util_percent": 28.580000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 193.20163022677104, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.6444223838547867, "policy_loss": -0.013515923968710316, "vf_loss": 3.665950711071491, "vf_explained_var": 0.9716060290113091, "kl": 0.018755163604146252, "entropy": 1.3638957096884647, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": -27.953574399309513, "episode_reward_min": -1224.033502525397, "episode_reward_mean": -634.583198439213, "episode_len_mean": 135.33, "episode_media": {}, "episodes_timesteps_total": 13533, "policy_reward_min": {"policy_0": -1224.033502525397}, "policy_reward_max": {"policy_0": -27.953574399309513}, "policy_reward_mean": {"policy_0": -634.583198439213}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-272.4527658343241, -213.49531415005285, -581.1063373693905, -914.311730654061, -167.8543640106327, -1091.4484959286706, -1108.1534405664463, -139.4928714505437, -1109.7505548680633, -328.5380809295367, -27.953574399309513, -962.2547418895592, -1224.033502525397, -450.23645432085834, -378.01157251792444, -723.062762980911, -551.8171336842433, -444.20037699253163, -852.3684267195223, -995.3123422012651, -517.7683531719488, -144.41611646280546, -330.08265788661686, -421.0490184988051, -797.089233794144, -205.0476886609233, -700.3430488044187, -643.3898617106987, -402.7352481115938, -1017.5597973881922, -899.3644135494964, -531.9182844425111, -254.2327505901001, -295.51346074363556, -127.14785082941629, -241.66173067451965, -1159.010357587797, -1026.7209381330206, -838.2500292978332, -1076.9962597178076, -754.5954560959276, -600.4983830070246, -740.7964738697623, -164.20211143409145, -1029.18033623099, -1187.0184488440605, -969.5501433191299, -434.68929598254414, -135.46848468041136, -573.8042167898592, -932.7970411019573, -784.3504894695436, -466.0873548801246, -957.3070639959077, -348.5189868828287, -396.6353755626913, -379.9263685822027, -1040.969281526721, -269.726649190859, -254.2183596885028, -718.8675058633868, -416.29057765976717, -450.07626921732196, -847.4932255455055, -1008.1403551232779, -464.47195540606737, -1058.1718833316893, -899.0205210382354, -891.762922989549, -226.99277750527926, -810.7961436803092, -722.8393085251146, -908.6447375271412, -228.56787049924125, -399.61302905587183, -224.7132328703481, -401.9553147113582, -1161.8607380766985, -565.5517854744164, -263.37463885363803, -421.20047839853305, -803.4048148513376, -415.65147187155986, -89.44772860935373, -1030.5840293823167, -673.2474695538793, -1087.2570429355035, -1031.836459887581, -450.4338657366339, -797.7862958422656, -664.96623307634, -1098.9729799437623, -355.2016895718779, -851.2451363767648, -872.2553430880093, -207.37883822397265, -861.0427617608407, -979.397504359031, -758.661385015032, -752.6512572978206], "episode_lengths": [89, 120, 150, 150, 94, 150, 150, 78, 150, 150, 50, 150, 150, 150, 112, 150, 122, 150, 150, 150, 150, 77, 87, 101, 150, 111, 150, 141, 150, 150, 150, 150, 138, 112, 91, 79, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 82, 150, 150, 150, 150, 150, 96, 150, 150, 150, 102, 85, 150, 109, 141, 150, 150, 148, 150, 150, 150, 137, 150, 150, 150, 150, 150, 73, 149, 150, 135, 83, 150, 150, 150, 82, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 75, 150, 150, 150, 150], "policy_policy_0_reward": [-272.4527658343241, -213.49531415005285, -581.1063373693905, -914.311730654061, -167.8543640106327, -1091.4484959286706, -1108.1534405664463, -139.4928714505437, -1109.7505548680633, -328.5380809295367, -27.953574399309513, -962.2547418895592, -1224.033502525397, -450.23645432085834, -378.01157251792444, -723.062762980911, -551.8171336842433, -444.20037699253163, -852.3684267195223, -995.3123422012651, -517.7683531719488, -144.41611646280546, -330.08265788661686, -421.0490184988051, -797.089233794144, -205.0476886609233, -700.3430488044187, -643.3898617106987, -402.7352481115938, -1017.5597973881922, -899.3644135494964, -531.9182844425111, -254.2327505901001, -295.51346074363556, -127.14785082941629, -241.66173067451965, -1159.010357587797, -1026.7209381330206, -838.2500292978332, -1076.9962597178076, -754.5954560959276, -600.4983830070246, -740.7964738697623, -164.20211143409145, -1029.18033623099, -1187.0184488440605, -969.5501433191299, -434.68929598254414, -135.46848468041136, -573.8042167898592, -932.7970411019573, -784.3504894695436, -466.0873548801246, -957.3070639959077, -348.5189868828287, -396.6353755626913, -379.9263685822027, -1040.969281526721, -269.726649190859, -254.2183596885028, -718.8675058633868, -416.29057765976717, -450.07626921732196, -847.4932255455055, -1008.1403551232779, -464.47195540606737, -1058.1718833316893, -899.0205210382354, -891.762922989549, -226.99277750527926, -810.7961436803092, -722.8393085251146, -908.6447375271412, -228.56787049924125, -399.61302905587183, -224.7132328703481, -401.9553147113582, -1161.8607380766985, -565.5517854744164, -263.37463885363803, -421.20047839853305, -803.4048148513376, -415.65147187155986, -89.44772860935373, -1030.5840293823167, -673.2474695538793, -1087.2570429355035, -1031.836459887581, -450.4338657366339, -797.7862958422656, -664.96623307634, -1098.9729799437623, -355.2016895718779, -851.2451363767648, -872.2553430880093, -207.37883822397265, -861.0427617608407, -979.397504359031, -758.661385015032, -752.6512572978206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30201844749032736, "mean_inference_ms": 0.9426773259386414, "mean_action_processing_ms": 0.1677662356726564, "mean_env_wait_ms": 1.6916333305140199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058956146240234375, "StateBufferConnector_ms": 0.0041773319244384766, "ViewRequirementAgentConnector_ms": 0.10577988624572754}, "num_episodes": 30, "episode_return_max": -27.953574399309513, "episode_return_min": -1224.033502525397, "episode_return_mean": -634.583198439213, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.30235158494906, "num_env_steps_trained_throughput_per_sec": 281.30235158494906, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 13874.41, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13874.333, "sample_time_ms": 2591.247, "learn_time_ms": 11266.225, "learn_throughput": 355.043, "synch_weights_time_ms": 16.053}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 28, "trial_id": "6d52d_00000", "date": "2024-07-26_22-50-21", "timestamp": 1722014421, "time_this_iter_s": 14.226832389831543, "time_total_s": 377.53976106643677, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c39e4d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 377.53976106643677, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 10.51, "ram_util_percent": 28.379999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 200.98634338180224, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.7252979760368663, "policy_loss": -0.010249149860464967, "vf_loss": 3.7448609564453363, "vf_explained_var": 0.9874113087852796, "kl": 0.01840634942594385, "entropy": 1.4835731251786153, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "env_runners": {"episode_reward_max": -0.02079154829241492, "episode_reward_min": -1268.3650589868118, "episode_reward_mean": -670.6226671644649, "episode_len_mean": 136.12, "episode_media": {}, "episodes_timesteps_total": 13612, "policy_reward_min": {"policy_0": -1268.3650589868118}, "policy_reward_max": {"policy_0": -0.02079154829241492}, "policy_reward_mean": {"policy_0": -670.6226671644649}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-899.3644135494964, -531.9182844425111, -254.2327505901001, -295.51346074363556, -127.14785082941629, -241.66173067451965, -1159.010357587797, -1026.7209381330206, -838.2500292978332, -1076.9962597178076, -754.5954560959276, -600.4983830070246, -740.7964738697623, -164.20211143409145, -1029.18033623099, -1187.0184488440605, -969.5501433191299, -434.68929598254414, -135.46848468041136, -573.8042167898592, -932.7970411019573, -784.3504894695436, -466.0873548801246, -957.3070639959077, -348.5189868828287, -396.6353755626913, -379.9263685822027, -1040.969281526721, -269.726649190859, -254.2183596885028, -718.8675058633868, -416.29057765976717, -450.07626921732196, -847.4932255455055, -1008.1403551232779, -464.47195540606737, -1058.1718833316893, -899.0205210382354, -891.762922989549, -226.99277750527926, -810.7961436803092, -722.8393085251146, -908.6447375271412, -228.56787049924125, -399.61302905587183, -224.7132328703481, -401.9553147113582, -1161.8607380766985, -565.5517854744164, -263.37463885363803, -421.20047839853305, -803.4048148513376, -415.65147187155986, -89.44772860935373, -1030.5840293823167, -673.2474695538793, -1087.2570429355035, -1031.836459887581, -450.4338657366339, -797.7862958422656, -664.96623307634, -1098.9729799437623, -355.2016895718779, -851.2451363767648, -872.2553430880093, -207.37883822397265, -861.0427617608407, -979.397504359031, -758.661385015032, -752.6512572978206, -898.4119014406476, -120.21061975710744, -1144.837638108641, -660.4259426121887, -743.8660921114135, -1268.3650589868118, -750.6349979211425, -863.8672209523385, -472.0697686714255, -1151.9045995889737, -824.7723819802925, -459.1118573081407, -858.353876559861, -1051.438785836724, -717.5861791497792, -661.7270625713386, -1243.6593620753952, -1089.7491895477808, -0.02079154829241492, -96.11428779248666, -844.7281516524025, -810.8444973193737, -58.65311036635665, -1025.5125112288256, -175.79888000964286, -1255.241961439826, -138.5407456145586, -476.00084418510795, -552.8990015731911, -903.9354230985048], "episode_lengths": [150, 150, 138, 112, 91, 79, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 82, 150, 150, 150, 150, 150, 96, 150, 150, 150, 102, 85, 150, 109, 141, 150, 150, 148, 150, 150, 150, 137, 150, 150, 150, 150, 150, 73, 149, 150, 135, 83, 150, 150, 150, 82, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 75, 150, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 34, 71, 150, 150, 56, 150, 99, 150, 61, 120, 150, 150], "policy_policy_0_reward": [-899.3644135494964, -531.9182844425111, -254.2327505901001, -295.51346074363556, -127.14785082941629, -241.66173067451965, -1159.010357587797, -1026.7209381330206, -838.2500292978332, -1076.9962597178076, -754.5954560959276, -600.4983830070246, -740.7964738697623, -164.20211143409145, -1029.18033623099, -1187.0184488440605, -969.5501433191299, -434.68929598254414, -135.46848468041136, -573.8042167898592, -932.7970411019573, -784.3504894695436, -466.0873548801246, -957.3070639959077, -348.5189868828287, -396.6353755626913, -379.9263685822027, -1040.969281526721, -269.726649190859, -254.2183596885028, -718.8675058633868, -416.29057765976717, -450.07626921732196, -847.4932255455055, -1008.1403551232779, -464.47195540606737, -1058.1718833316893, -899.0205210382354, -891.762922989549, -226.99277750527926, -810.7961436803092, -722.8393085251146, -908.6447375271412, -228.56787049924125, -399.61302905587183, -224.7132328703481, -401.9553147113582, -1161.8607380766985, -565.5517854744164, -263.37463885363803, -421.20047839853305, -803.4048148513376, -415.65147187155986, -89.44772860935373, -1030.5840293823167, -673.2474695538793, -1087.2570429355035, -1031.836459887581, -450.4338657366339, -797.7862958422656, -664.96623307634, -1098.9729799437623, -355.2016895718779, -851.2451363767648, -872.2553430880093, -207.37883822397265, -861.0427617608407, -979.397504359031, -758.661385015032, -752.6512572978206, -898.4119014406476, -120.21061975710744, -1144.837638108641, -660.4259426121887, -743.8660921114135, -1268.3650589868118, -750.6349979211425, -863.8672209523385, -472.0697686714255, -1151.9045995889737, -824.7723819802925, -459.1118573081407, -858.353876559861, -1051.438785836724, -717.5861791497792, -661.7270625713386, -1243.6593620753952, -1089.7491895477808, -0.02079154829241492, -96.11428779248666, -844.7281516524025, -810.8444973193737, -58.65311036635665, -1025.5125112288256, -175.79888000964286, -1255.241961439826, -138.5407456145586, -476.00084418510795, -552.8990015731911, -903.9354230985048]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30214661787705227, "mean_inference_ms": 0.9420562268506226, "mean_action_processing_ms": 0.16776594008257031, "mean_env_wait_ms": 1.6942245228097224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005906820297241211, "StateBufferConnector_ms": 0.004158735275268555, "ViewRequirementAgentConnector_ms": 0.1054840087890625}, "num_episodes": 30, "episode_return_max": -0.02079154829241492, "episode_return_min": -1268.3650589868118, "episode_return_mean": -670.6226671644649, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 330.4213094165769, "num_env_steps_trained_throughput_per_sec": 330.4213094165769, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 13736.248, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13736.171, "sample_time_ms": 2608.205, "learn_time_ms": 11110.909, "learn_throughput": 360.007, "synch_weights_time_ms": 16.278}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "training_iteration": 29, "trial_id": "6d52d_00000", "date": "2024-07-26_22-50-34", "timestamp": 1722014434, "time_this_iter_s": 12.112658977508545, "time_total_s": 389.6524200439453, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c39f370>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 389.6524200439453, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 11.577777777777778, "ram_util_percent": 28.37222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 185.83599099914233, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.012373715639114, "policy_loss": -0.012576906416506972, "vf_loss": 4.033047939340274, "vf_explained_var": 0.9766543295234442, "kl": 0.019835274396488516, "entropy": 1.4047900991514326, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": -0.02079154829241492, "episode_reward_min": -1329.7434374616191, "episode_reward_mean": -684.2332477350151, "episode_len_mean": 134.91, "episode_media": {}, "episodes_timesteps_total": 13491, "policy_reward_min": {"policy_0": -1329.7434374616191}, "policy_reward_max": {"policy_0": -0.02079154829241492}, "policy_reward_mean": {"policy_0": -684.2332477350151}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-416.29057765976717, -450.07626921732196, -847.4932255455055, -1008.1403551232779, -464.47195540606737, -1058.1718833316893, -899.0205210382354, -891.762922989549, -226.99277750527926, -810.7961436803092, -722.8393085251146, -908.6447375271412, -228.56787049924125, -399.61302905587183, -224.7132328703481, -401.9553147113582, -1161.8607380766985, -565.5517854744164, -263.37463885363803, -421.20047839853305, -803.4048148513376, -415.65147187155986, -89.44772860935373, -1030.5840293823167, -673.2474695538793, -1087.2570429355035, -1031.836459887581, -450.4338657366339, -797.7862958422656, -664.96623307634, -1098.9729799437623, -355.2016895718779, -851.2451363767648, -872.2553430880093, -207.37883822397265, -861.0427617608407, -979.397504359031, -758.661385015032, -752.6512572978206, -898.4119014406476, -120.21061975710744, -1144.837638108641, -660.4259426121887, -743.8660921114135, -1268.3650589868118, -750.6349979211425, -863.8672209523385, -472.0697686714255, -1151.9045995889737, -824.7723819802925, -459.1118573081407, -858.353876559861, -1051.438785836724, -717.5861791497792, -661.7270625713386, -1243.6593620753952, -1089.7491895477808, -0.02079154829241492, -96.11428779248666, -844.7281516524025, -810.8444973193737, -58.65311036635665, -1025.5125112288256, -175.79888000964286, -1255.241961439826, -138.5407456145586, -476.00084418510795, -552.8990015731911, -903.9354230985048, -716.0129695478988, -797.0893243195605, -1012.0118130709511, -15.349141049208615, -790.9892350846084, -828.7175592387953, -1106.3347997983751, -312.2281361281126, -117.4987116608777, -915.9120990555214, -142.00631828806107, -832.9011774882797, -1329.7434374616191, -652.183895997008, -746.0074512861551, -874.5294308292011, -244.62877125212682, -1056.9216353449715, -51.31336652302536, -876.0092818703946, -692.0857985850724, -987.1191426839412, -347.322416010306, -352.8226527362732, -190.57659697294525, -1127.9855572808835, -1087.1861148848873, -691.1598938565644, -676.5169271553738, -179.72009719033358, -1200.1982069683563], "episode_lengths": [109, 141, 150, 150, 148, 150, 150, 150, 137, 150, 150, 150, 150, 150, 73, 149, 150, 135, 83, 150, 150, 150, 82, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 75, 150, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 34, 71, 150, 150, 56, 150, 99, 150, 61, 120, 150, 150, 150, 150, 150, 41, 150, 150, 150, 131, 74, 150, 80, 150, 150, 150, 150, 150, 80, 150, 61, 150, 150, 150, 92, 150, 97, 150, 150, 150, 150, 104, 150], "policy_policy_0_reward": [-416.29057765976717, -450.07626921732196, -847.4932255455055, -1008.1403551232779, -464.47195540606737, -1058.1718833316893, -899.0205210382354, -891.762922989549, -226.99277750527926, -810.7961436803092, -722.8393085251146, -908.6447375271412, -228.56787049924125, -399.61302905587183, -224.7132328703481, -401.9553147113582, -1161.8607380766985, -565.5517854744164, -263.37463885363803, -421.20047839853305, -803.4048148513376, -415.65147187155986, -89.44772860935373, -1030.5840293823167, -673.2474695538793, -1087.2570429355035, -1031.836459887581, -450.4338657366339, -797.7862958422656, -664.96623307634, -1098.9729799437623, -355.2016895718779, -851.2451363767648, -872.2553430880093, -207.37883822397265, -861.0427617608407, -979.397504359031, -758.661385015032, -752.6512572978206, -898.4119014406476, -120.21061975710744, -1144.837638108641, -660.4259426121887, -743.8660921114135, -1268.3650589868118, -750.6349979211425, -863.8672209523385, -472.0697686714255, -1151.9045995889737, -824.7723819802925, -459.1118573081407, -858.353876559861, -1051.438785836724, -717.5861791497792, -661.7270625713386, -1243.6593620753952, -1089.7491895477808, -0.02079154829241492, -96.11428779248666, -844.7281516524025, -810.8444973193737, -58.65311036635665, -1025.5125112288256, -175.79888000964286, -1255.241961439826, -138.5407456145586, -476.00084418510795, -552.8990015731911, -903.9354230985048, -716.0129695478988, -797.0893243195605, -1012.0118130709511, -15.349141049208615, -790.9892350846084, -828.7175592387953, -1106.3347997983751, -312.2281361281126, -117.4987116608777, -915.9120990555214, -142.00631828806107, -832.9011774882797, -1329.7434374616191, -652.183895997008, -746.0074512861551, -874.5294308292011, -244.62877125212682, -1056.9216353449715, -51.31336652302536, -876.0092818703946, -692.0857985850724, -987.1191426839412, -347.322416010306, -352.8226527362732, -190.57659697294525, -1127.9855572808835, -1087.1861148848873, -691.1598938565644, -676.5169271553738, -179.72009719033358, -1200.1982069683563]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3017083876878235, "mean_inference_ms": 0.9407342348017468, "mean_action_processing_ms": 0.16752189052044408, "mean_env_wait_ms": 1.691551362980495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005795955657958984, "StateBufferConnector_ms": 0.004151821136474609, "ViewRequirementAgentConnector_ms": 0.10508847236633301}, "num_episodes": 31, "episode_return_max": -0.02079154829241492, "episode_return_min": -1329.7434374616191, "episode_return_mean": -684.2332477350151, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.12553743651364, "num_env_steps_trained_throughput_per_sec": 305.12553743651364, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 13692.556, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13692.48, "sample_time_ms": 2613.898, "learn_time_ms": 11061.728, "learn_throughput": 361.607, "synch_weights_time_ms": 16.082}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 30, "trial_id": "6d52d_00000", "date": "2024-07-26_22-50-47", "timestamp": 1722014447, "time_this_iter_s": 13.115651369094849, "time_total_s": 402.76807141304016, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d139e045a20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 402.76807141304016, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 12.372222222222222, "ram_util_percent": 28.383333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 169.38233820994694, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.1279313320914905, "policy_loss": -0.01122154687521591, "vf_loss": 4.146119076758623, "vf_explained_var": 0.982407049400111, "kl": 0.01745936338032459, "entropy": 1.2204019833977025, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "env_runners": {"episode_reward_max": -0.02079154829241492, "episode_reward_min": -1329.7434374616191, "episode_reward_mean": -663.0206718306325, "episode_len_mean": 131.99, "episode_media": {}, "episodes_timesteps_total": 13199, "policy_reward_min": {"policy_0": -1329.7434374616191}, "policy_reward_max": {"policy_0": -0.02079154829241492}, "policy_reward_mean": {"policy_0": -663.0206718306325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-355.2016895718779, -851.2451363767648, -872.2553430880093, -207.37883822397265, -861.0427617608407, -979.397504359031, -758.661385015032, -752.6512572978206, -898.4119014406476, -120.21061975710744, -1144.837638108641, -660.4259426121887, -743.8660921114135, -1268.3650589868118, -750.6349979211425, -863.8672209523385, -472.0697686714255, -1151.9045995889737, -824.7723819802925, -459.1118573081407, -858.353876559861, -1051.438785836724, -717.5861791497792, -661.7270625713386, -1243.6593620753952, -1089.7491895477808, -0.02079154829241492, -96.11428779248666, -844.7281516524025, -810.8444973193737, -58.65311036635665, -1025.5125112288256, -175.79888000964286, -1255.241961439826, -138.5407456145586, -476.00084418510795, -552.8990015731911, -903.9354230985048, -716.0129695478988, -797.0893243195605, -1012.0118130709511, -15.349141049208615, -790.9892350846084, -828.7175592387953, -1106.3347997983751, -312.2281361281126, -117.4987116608777, -915.9120990555214, -142.00631828806107, -832.9011774882797, -1329.7434374616191, -652.183895997008, -746.0074512861551, -874.5294308292011, -244.62877125212682, -1056.9216353449715, -51.31336652302536, -876.0092818703946, -692.0857985850724, -987.1191426839412, -347.322416010306, -352.8226527362732, -190.57659697294525, -1127.9855572808835, -1087.1861148848873, -691.1598938565644, -676.5169271553738, -179.72009719033358, -1200.1982069683563, -599.9562303192495, -957.6870299375349, -126.97723290141381, -845.1249062964187, -659.4537384811051, -1029.0887763655355, -45.297210308796394, -484.03219963273153, -331.7700393765689, -418.33948536934685, -501.84576321762324, -166.3083428313989, -361.1811202325483, -538.81107215942, -437.69731996741666, -924.3518819615965, -110.98750582280621, -1057.3936408454526, -1148.54418354846, -518.5784444487401, -1322.53063679892, -411.17325923929917, -814.0491767054398, -871.4663671027309, -989.7909207245132, -28.897475062811687, -1280.8403393892734, -521.4024872295888, -35.73504341145017, -295.0720053315008, -559.4847317219392], "episode_lengths": [150, 150, 150, 75, 150, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 34, 71, 150, 150, 56, 150, 99, 150, 61, 120, 150, 150, 150, 150, 150, 41, 150, 150, 150, 131, 74, 150, 80, 150, 150, 150, 150, 150, 80, 150, 61, 150, 150, 150, 92, 150, 97, 150, 150, 150, 150, 104, 150, 150, 150, 69, 150, 150, 150, 62, 150, 150, 112, 150, 83, 150, 150, 110, 150, 71, 150, 150, 150, 150, 150, 150, 150, 150, 37, 150, 150, 59, 150, 150], "policy_policy_0_reward": [-355.2016895718779, -851.2451363767648, -872.2553430880093, -207.37883822397265, -861.0427617608407, -979.397504359031, -758.661385015032, -752.6512572978206, -898.4119014406476, -120.21061975710744, -1144.837638108641, -660.4259426121887, -743.8660921114135, -1268.3650589868118, -750.6349979211425, -863.8672209523385, -472.0697686714255, -1151.9045995889737, -824.7723819802925, -459.1118573081407, -858.353876559861, -1051.438785836724, -717.5861791497792, -661.7270625713386, -1243.6593620753952, -1089.7491895477808, -0.02079154829241492, -96.11428779248666, -844.7281516524025, -810.8444973193737, -58.65311036635665, -1025.5125112288256, -175.79888000964286, -1255.241961439826, -138.5407456145586, -476.00084418510795, -552.8990015731911, -903.9354230985048, -716.0129695478988, -797.0893243195605, -1012.0118130709511, -15.349141049208615, -790.9892350846084, -828.7175592387953, -1106.3347997983751, -312.2281361281126, -117.4987116608777, -915.9120990555214, -142.00631828806107, -832.9011774882797, -1329.7434374616191, -652.183895997008, -746.0074512861551, -874.5294308292011, -244.62877125212682, -1056.9216353449715, -51.31336652302536, -876.0092818703946, -692.0857985850724, -987.1191426839412, -347.322416010306, -352.8226527362732, -190.57659697294525, -1127.9855572808835, -1087.1861148848873, -691.1598938565644, -676.5169271553738, -179.72009719033358, -1200.1982069683563, -599.9562303192495, -957.6870299375349, -126.97723290141381, -845.1249062964187, -659.4537384811051, -1029.0887763655355, -45.297210308796394, -484.03219963273153, -331.7700393765689, -418.33948536934685, -501.84576321762324, -166.3083428313989, -361.1811202325483, -538.81107215942, -437.69731996741666, -924.3518819615965, -110.98750582280621, -1057.3936408454526, -1148.54418354846, -518.5784444487401, -1322.53063679892, -411.17325923929917, -814.0491767054398, -871.4663671027309, -989.7909207245132, -28.897475062811687, -1280.8403393892734, -521.4024872295888, -35.73504341145017, -295.0720053315008, -559.4847317219392]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3013660671630095, "mean_inference_ms": 0.9393404137678152, "mean_action_processing_ms": 0.16738913838177757, "mean_env_wait_ms": 1.6893717886688018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005769968032836914, "StateBufferConnector_ms": 0.004065036773681641, "ViewRequirementAgentConnector_ms": 0.10342121124267578}, "num_episodes": 31, "episode_return_max": -0.02079154829241492, "episode_return_min": -1329.7434374616191, "episode_return_mean": -663.0206718306325, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 287.45002692421343, "num_env_steps_trained_throughput_per_sec": 287.45002692421343, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 13649.471, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13649.396, "sample_time_ms": 2590.895, "learn_time_ms": 11041.44, "learn_throughput": 362.272, "synch_weights_time_ms": 16.287}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "training_iteration": 31, "trial_id": "6d52d_00000", "date": "2024-07-26_22-51-01", "timestamp": 1722014461, "time_this_iter_s": 13.923611879348755, "time_total_s": 416.6916832923889, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d139e045b40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 416.6916832923889, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 11.290000000000003, "ram_util_percent": 28.279999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 202.35127016504606, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.8666895729800066, "policy_loss": -0.007284056338539813, "vf_loss": 3.881392516444127, "vf_explained_var": 0.9791479432334502, "kl": 0.017810339359797003, "entropy": 1.2761982759460806, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": -15.349141049208615, "episode_reward_min": -1329.7434374616191, "episode_reward_mean": -662.1874982516549, "episode_len_mean": 132.46, "episode_media": {}, "episodes_timesteps_total": 13246, "policy_reward_min": {"policy_0": -1329.7434374616191}, "policy_reward_max": {"policy_0": -15.349141049208615}, "policy_reward_mean": {"policy_0": -662.1874982516549}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-810.8444973193737, -58.65311036635665, -1025.5125112288256, -175.79888000964286, -1255.241961439826, -138.5407456145586, -476.00084418510795, -552.8990015731911, -903.9354230985048, -716.0129695478988, -797.0893243195605, -1012.0118130709511, -15.349141049208615, -790.9892350846084, -828.7175592387953, -1106.3347997983751, -312.2281361281126, -117.4987116608777, -915.9120990555214, -142.00631828806107, -832.9011774882797, -1329.7434374616191, -652.183895997008, -746.0074512861551, -874.5294308292011, -244.62877125212682, -1056.9216353449715, -51.31336652302536, -876.0092818703946, -692.0857985850724, -987.1191426839412, -347.322416010306, -352.8226527362732, -190.57659697294525, -1127.9855572808835, -1087.1861148848873, -691.1598938565644, -676.5169271553738, -179.72009719033358, -1200.1982069683563, -599.9562303192495, -957.6870299375349, -126.97723290141381, -845.1249062964187, -659.4537384811051, -1029.0887763655355, -45.297210308796394, -484.03219963273153, -331.7700393765689, -418.33948536934685, -501.84576321762324, -166.3083428313989, -361.1811202325483, -538.81107215942, -437.69731996741666, -924.3518819615965, -110.98750582280621, -1057.3936408454526, -1148.54418354846, -518.5784444487401, -1322.53063679892, -411.17325923929917, -814.0491767054398, -871.4663671027309, -989.7909207245132, -28.897475062811687, -1280.8403393892734, -521.4024872295888, -35.73504341145017, -295.0720053315008, -559.4847317219392, -677.8086364769079, -169.66150690390862, -1065.4417662842254, -628.1003093984064, -689.3321553533403, -1131.2521474158737, -1040.3825401369284, -898.8493420441164, -1141.605869932214, -457.2226343663932, -1080.952862948156, -597.0419461898877, -875.3042644478862, -1219.0757671109511, -278.155084180919, -556.977735350348, -711.7761379314263, -541.2074002087129, -84.05404095867348, -560.3229430382866, -1057.559026468687, -1062.4133668808217, -805.7368680031834, -768.300235265116, -302.9450835834005, -1023.744236168708, -316.2101146479553, -972.6145956327852, -762.3237066405622], "episode_lengths": [150, 56, 150, 99, 150, 61, 120, 150, 150, 150, 150, 150, 41, 150, 150, 150, 131, 74, 150, 80, 150, 150, 150, 150, 150, 80, 150, 61, 150, 150, 150, 92, 150, 97, 150, 150, 150, 150, 104, 150, 150, 150, 69, 150, 150, 150, 62, 150, 150, 112, 150, 83, 150, 150, 110, 150, 71, 150, 150, 150, 150, 150, 150, 150, 150, 37, 150, 150, 59, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 86, 150, 150, 150, 150, 150, 83, 150, 89, 150, 150], "policy_policy_0_reward": [-810.8444973193737, -58.65311036635665, -1025.5125112288256, -175.79888000964286, -1255.241961439826, -138.5407456145586, -476.00084418510795, -552.8990015731911, -903.9354230985048, -716.0129695478988, -797.0893243195605, -1012.0118130709511, -15.349141049208615, -790.9892350846084, -828.7175592387953, -1106.3347997983751, -312.2281361281126, -117.4987116608777, -915.9120990555214, -142.00631828806107, -832.9011774882797, -1329.7434374616191, -652.183895997008, -746.0074512861551, -874.5294308292011, -244.62877125212682, -1056.9216353449715, -51.31336652302536, -876.0092818703946, -692.0857985850724, -987.1191426839412, -347.322416010306, -352.8226527362732, -190.57659697294525, -1127.9855572808835, -1087.1861148848873, -691.1598938565644, -676.5169271553738, -179.72009719033358, -1200.1982069683563, -599.9562303192495, -957.6870299375349, -126.97723290141381, -845.1249062964187, -659.4537384811051, -1029.0887763655355, -45.297210308796394, -484.03219963273153, -331.7700393765689, -418.33948536934685, -501.84576321762324, -166.3083428313989, -361.1811202325483, -538.81107215942, -437.69731996741666, -924.3518819615965, -110.98750582280621, -1057.3936408454526, -1148.54418354846, -518.5784444487401, -1322.53063679892, -411.17325923929917, -814.0491767054398, -871.4663671027309, -989.7909207245132, -28.897475062811687, -1280.8403393892734, -521.4024872295888, -35.73504341145017, -295.0720053315008, -559.4847317219392, -677.8086364769079, -169.66150690390862, -1065.4417662842254, -628.1003093984064, -689.3321553533403, -1131.2521474158737, -1040.3825401369284, -898.8493420441164, -1141.605869932214, -457.2226343663932, -1080.952862948156, -597.0419461898877, -875.3042644478862, -1219.0757671109511, -278.155084180919, -556.977735350348, -711.7761379314263, -541.2074002087129, -84.05404095867348, -560.3229430382866, -1057.559026468687, -1062.4133668808217, -805.7368680031834, -768.300235265116, -302.9450835834005, -1023.744236168708, -316.2101146479553, -972.6145956327852, -762.3237066405622]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30092281296157014, "mean_inference_ms": 0.9379498235669845, "mean_action_processing_ms": 0.1672163637173366, "mean_env_wait_ms": 1.6861001390751045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005608558654785156, "StateBufferConnector_ms": 0.0040247440338134766, "ViewRequirementAgentConnector_ms": 0.10241150856018066}, "num_episodes": 29, "episode_return_max": -15.349141049208615, "episode_return_min": -1329.7434374616191, "episode_return_mean": -662.1874982516549, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 276.49316582691966, "num_env_steps_trained_throughput_per_sec": 276.49316582691966, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 13727.127, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13727.052, "sample_time_ms": 2582.974, "learn_time_ms": 11127.293, "learn_throughput": 359.476, "synch_weights_time_ms": 16.009}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 32, "trial_id": "6d52d_00000", "date": "2024-07-26_22-51-15", "timestamp": 1722014475, "time_this_iter_s": 14.475427627563477, "time_total_s": 431.1671109199524, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c3d8d30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 431.1671109199524, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 10.776190476190477, "ram_util_percent": 28.299999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 217.95573211312293, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.6443916987627745, "policy_loss": -0.01540502910647774, "vf_loss": 3.6666443896790346, "vf_explained_var": 0.9922334960972269, "kl": 0.022452078315018328, "entropy": 1.3583286996309956, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "env_runners": {"episode_reward_max": -28.897475062811687, "episode_reward_min": -1361.352274757507, "episode_reward_mean": -673.1561476759914, "episode_len_mean": 132.67, "episode_media": {}, "episodes_timesteps_total": 13267, "policy_reward_min": {"policy_0": -1361.352274757507}, "policy_reward_max": {"policy_0": -28.897475062811687}, "policy_reward_mean": {"policy_0": -673.1561476759914}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-347.322416010306, -352.8226527362732, -190.57659697294525, -1127.9855572808835, -1087.1861148848873, -691.1598938565644, -676.5169271553738, -179.72009719033358, -1200.1982069683563, -599.9562303192495, -957.6870299375349, -126.97723290141381, -845.1249062964187, -659.4537384811051, -1029.0887763655355, -45.297210308796394, -484.03219963273153, -331.7700393765689, -418.33948536934685, -501.84576321762324, -166.3083428313989, -361.1811202325483, -538.81107215942, -437.69731996741666, -924.3518819615965, -110.98750582280621, -1057.3936408454526, -1148.54418354846, -518.5784444487401, -1322.53063679892, -411.17325923929917, -814.0491767054398, -871.4663671027309, -989.7909207245132, -28.897475062811687, -1280.8403393892734, -521.4024872295888, -35.73504341145017, -295.0720053315008, -559.4847317219392, -677.8086364769079, -169.66150690390862, -1065.4417662842254, -628.1003093984064, -689.3321553533403, -1131.2521474158737, -1040.3825401369284, -898.8493420441164, -1141.605869932214, -457.2226343663932, -1080.952862948156, -597.0419461898877, -875.3042644478862, -1219.0757671109511, -278.155084180919, -556.977735350348, -711.7761379314263, -541.2074002087129, -84.05404095867348, -560.3229430382866, -1057.559026468687, -1062.4133668808217, -805.7368680031834, -768.300235265116, -302.9450835834005, -1023.744236168708, -316.2101146479553, -972.6145956327852, -762.3237066405622, -1171.4426760779604, -728.739152379785, -556.2907952591579, -895.3784590099916, -1118.8226242421865, -40.663490735559286, -886.5410583550264, -550.6811570614731, -694.213116379925, -256.319609493271, -1174.7660747761743, -83.23894911118859, -1037.6950660145123, -1042.1989245587242, -205.19696072426785, -925.9609580367112, -147.5484388258739, -1231.4141197952347, -1096.9577195417464, -418.9814586068006, -894.6244754652521, -107.55769625949765, -161.63770302618997, -1361.352274757507, -772.7148683046734, -101.91534154091764, -980.3507879847739, -834.1771985718677, -1139.2987915657282, -103.849551483678, -871.3559158871445], "episode_lengths": [92, 150, 97, 150, 150, 150, 150, 104, 150, 150, 150, 69, 150, 150, 150, 62, 150, 150, 112, 150, 83, 150, 150, 110, 150, 71, 150, 150, 150, 150, 150, 150, 150, 150, 37, 150, 150, 59, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 86, 150, 150, 150, 150, 150, 83, 150, 89, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 112, 150, 64, 150, 150, 74, 150, 64, 150, 150, 150, 150, 93, 109, 150, 150, 58, 150, 150, 150, 50, 150], "policy_policy_0_reward": [-347.322416010306, -352.8226527362732, -190.57659697294525, -1127.9855572808835, -1087.1861148848873, -691.1598938565644, -676.5169271553738, -179.72009719033358, -1200.1982069683563, -599.9562303192495, -957.6870299375349, -126.97723290141381, -845.1249062964187, -659.4537384811051, -1029.0887763655355, -45.297210308796394, -484.03219963273153, -331.7700393765689, -418.33948536934685, -501.84576321762324, -166.3083428313989, -361.1811202325483, -538.81107215942, -437.69731996741666, -924.3518819615965, -110.98750582280621, -1057.3936408454526, -1148.54418354846, -518.5784444487401, -1322.53063679892, -411.17325923929917, -814.0491767054398, -871.4663671027309, -989.7909207245132, -28.897475062811687, -1280.8403393892734, -521.4024872295888, -35.73504341145017, -295.0720053315008, -559.4847317219392, -677.8086364769079, -169.66150690390862, -1065.4417662842254, -628.1003093984064, -689.3321553533403, -1131.2521474158737, -1040.3825401369284, -898.8493420441164, -1141.605869932214, -457.2226343663932, -1080.952862948156, -597.0419461898877, -875.3042644478862, -1219.0757671109511, -278.155084180919, -556.977735350348, -711.7761379314263, -541.2074002087129, -84.05404095867348, -560.3229430382866, -1057.559026468687, -1062.4133668808217, -805.7368680031834, -768.300235265116, -302.9450835834005, -1023.744236168708, -316.2101146479553, -972.6145956327852, -762.3237066405622, -1171.4426760779604, -728.739152379785, -556.2907952591579, -895.3784590099916, -1118.8226242421865, -40.663490735559286, -886.5410583550264, -550.6811570614731, -694.213116379925, -256.319609493271, -1174.7660747761743, -83.23894911118859, -1037.6950660145123, -1042.1989245587242, -205.19696072426785, -925.9609580367112, -147.5484388258739, -1231.4141197952347, -1096.9577195417464, -418.9814586068006, -894.6244754652521, -107.55769625949765, -161.63770302618997, -1361.352274757507, -772.7148683046734, -101.91534154091764, -980.3507879847739, -834.1771985718677, -1139.2987915657282, -103.849551483678, -871.3559158871445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30072494906633634, "mean_inference_ms": 0.9368834326344959, "mean_action_processing_ms": 0.16714709406079908, "mean_env_wait_ms": 1.6874048839116012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005585908889770508, "StateBufferConnector_ms": 0.00400233268737793, "ViewRequirementAgentConnector_ms": 0.1020667552947998}, "num_episodes": 31, "episode_return_max": -28.897475062811687, "episode_return_min": -1361.352274757507, "episode_return_mean": -673.1561476759914, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.16514303742815, "num_env_steps_trained_throughput_per_sec": 315.16514303742815, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 13613.82, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13613.742, "sample_time_ms": 2574.735, "learn_time_ms": 11022.144, "learn_throughput": 362.906, "synch_weights_time_ms": 16.082}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "training_iteration": 33, "trial_id": "6d52d_00000", "date": "2024-07-26_22-51-28", "timestamp": 1722014488, "time_this_iter_s": 12.697173118591309, "time_total_s": 443.8642840385437, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c3d9630>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 443.8642840385437, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 12.26111111111111, "ram_util_percent": 28.56666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 205.23185164928435, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.837565836310387, "policy_loss": -0.012896861822810024, "vf_loss": 3.8547197145720324, "vf_explained_var": 0.9762789348140359, "kl": 0.016254068005764604, "entropy": 1.1571341592197617, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "env_runners": {"episode_reward_max": -28.897475062811687, "episode_reward_min": -1361.352274757507, "episode_reward_mean": -679.340314110923, "episode_len_mean": 135.77, "episode_media": {}, "episodes_timesteps_total": 13577, "policy_reward_min": {"policy_0": -1361.352274757507}, "policy_reward_max": {"policy_0": -28.897475062811687}, "policy_reward_mean": {"policy_0": -679.340314110923}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-518.5784444487401, -1322.53063679892, -411.17325923929917, -814.0491767054398, -871.4663671027309, -989.7909207245132, -28.897475062811687, -1280.8403393892734, -521.4024872295888, -35.73504341145017, -295.0720053315008, -559.4847317219392, -677.8086364769079, -169.66150690390862, -1065.4417662842254, -628.1003093984064, -689.3321553533403, -1131.2521474158737, -1040.3825401369284, -898.8493420441164, -1141.605869932214, -457.2226343663932, -1080.952862948156, -597.0419461898877, -875.3042644478862, -1219.0757671109511, -278.155084180919, -556.977735350348, -711.7761379314263, -541.2074002087129, -84.05404095867348, -560.3229430382866, -1057.559026468687, -1062.4133668808217, -805.7368680031834, -768.300235265116, -302.9450835834005, -1023.744236168708, -316.2101146479553, -972.6145956327852, -762.3237066405622, -1171.4426760779604, -728.739152379785, -556.2907952591579, -895.3784590099916, -1118.8226242421865, -40.663490735559286, -886.5410583550264, -550.6811570614731, -694.213116379925, -256.319609493271, -1174.7660747761743, -83.23894911118859, -1037.6950660145123, -1042.1989245587242, -205.19696072426785, -925.9609580367112, -147.5484388258739, -1231.4141197952347, -1096.9577195417464, -418.9814586068006, -894.6244754652521, -107.55769625949765, -161.63770302618997, -1361.352274757507, -772.7148683046734, -101.91534154091764, -980.3507879847739, -834.1771985718677, -1139.2987915657282, -103.849551483678, -871.3559158871445, -976.7922480018531, -362.80961764377696, -794.1498073518476, -906.176950394274, -795.1782660013381, -744.4781909968668, -543.2258163556687, -298.3886696563677, -402.870305933595, -796.607460564261, -1047.0166768093654, -408.2722321427819, -1051.967233586948, -450.0896751157375, -365.5600025889084, -35.065631546349955, -625.2640772540449, -727.6449459576538, -117.2263715814722, -515.428887273859, -537.4838778546819, -626.410777383854, -389.40087398229343, -752.4193495134118, -608.5632294733585, -660.8570538606875, -1054.3423388457445, -623.0622184535181], "episode_lengths": [150, 150, 150, 150, 150, 150, 37, 150, 150, 59, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 86, 150, 150, 150, 150, 150, 83, 150, 89, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 112, 150, 64, 150, 150, 74, 150, 64, 150, 150, 150, 150, 93, 109, 150, 150, 58, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 64, 150, 142, 59, 150, 121, 150, 124, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-518.5784444487401, -1322.53063679892, -411.17325923929917, -814.0491767054398, -871.4663671027309, -989.7909207245132, -28.897475062811687, -1280.8403393892734, -521.4024872295888, -35.73504341145017, -295.0720053315008, -559.4847317219392, -677.8086364769079, -169.66150690390862, -1065.4417662842254, -628.1003093984064, -689.3321553533403, -1131.2521474158737, -1040.3825401369284, -898.8493420441164, -1141.605869932214, -457.2226343663932, -1080.952862948156, -597.0419461898877, -875.3042644478862, -1219.0757671109511, -278.155084180919, -556.977735350348, -711.7761379314263, -541.2074002087129, -84.05404095867348, -560.3229430382866, -1057.559026468687, -1062.4133668808217, -805.7368680031834, -768.300235265116, -302.9450835834005, -1023.744236168708, -316.2101146479553, -972.6145956327852, -762.3237066405622, -1171.4426760779604, -728.739152379785, -556.2907952591579, -895.3784590099916, -1118.8226242421865, -40.663490735559286, -886.5410583550264, -550.6811570614731, -694.213116379925, -256.319609493271, -1174.7660747761743, -83.23894911118859, -1037.6950660145123, -1042.1989245587242, -205.19696072426785, -925.9609580367112, -147.5484388258739, -1231.4141197952347, -1096.9577195417464, -418.9814586068006, -894.6244754652521, -107.55769625949765, -161.63770302618997, -1361.352274757507, -772.7148683046734, -101.91534154091764, -980.3507879847739, -834.1771985718677, -1139.2987915657282, -103.849551483678, -871.3559158871445, -976.7922480018531, -362.80961764377696, -794.1498073518476, -906.176950394274, -795.1782660013381, -744.4781909968668, -543.2258163556687, -298.3886696563677, -402.870305933595, -796.607460564261, -1047.0166768093654, -408.2722321427819, -1051.967233586948, -450.0896751157375, -365.5600025889084, -35.065631546349955, -625.2640772540449, -727.6449459576538, -117.2263715814722, -515.428887273859, -537.4838778546819, -626.410777383854, -389.40087398229343, -752.4193495134118, -608.5632294733585, -660.8570538606875, -1054.3423388457445, -623.0622184535181]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30091240122071056, "mean_inference_ms": 0.9366892852665855, "mean_action_processing_ms": 0.1672168712133308, "mean_env_wait_ms": 1.690478662929285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005859375, "StateBufferConnector_ms": 0.004081010818481445, "ViewRequirementAgentConnector_ms": 0.10375475883483887}, "num_episodes": 28, "episode_return_max": -28.897475062811687, "episode_return_min": -1361.352274757507, "episode_return_mean": -679.340314110923, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 287.6856242427601, "num_env_steps_trained_throughput_per_sec": 287.6856242427601, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 13635.56, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13635.482, "sample_time_ms": 2660.871, "learn_time_ms": 10957.533, "learn_throughput": 365.046, "synch_weights_time_ms": 16.256}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "training_iteration": 34, "trial_id": "6d52d_00000", "date": "2024-07-26_22-51-42", "timestamp": 1722014502, "time_this_iter_s": 13.910158395767212, "time_total_s": 457.7744424343109, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c312cb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 457.7744424343109, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 11.48, "ram_util_percent": 28.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 220.88075046539308, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.923488989720742, "policy_loss": -0.007650125682509194, "vf_loss": 3.9363861021896205, "vf_explained_var": 0.9705943657706181, "kl": 0.015744596159371852, "entropy": 1.2332050491745272, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "env_runners": {"episode_reward_max": -1.8224559741354889, "episode_reward_min": -1361.352274757507, "episode_reward_mean": -639.0910535767617, "episode_len_mean": 132.12, "episode_media": {}, "episodes_timesteps_total": 13212, "policy_reward_min": {"policy_0": -1361.352274757507}, "policy_reward_max": {"policy_0": -1.8224559741354889}, "policy_reward_mean": {"policy_0": -639.0910535767617}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-560.3229430382866, -1057.559026468687, -1062.4133668808217, -805.7368680031834, -768.300235265116, -302.9450835834005, -1023.744236168708, -316.2101146479553, -972.6145956327852, -762.3237066405622, -1171.4426760779604, -728.739152379785, -556.2907952591579, -895.3784590099916, -1118.8226242421865, -40.663490735559286, -886.5410583550264, -550.6811570614731, -694.213116379925, -256.319609493271, -1174.7660747761743, -83.23894911118859, -1037.6950660145123, -1042.1989245587242, -205.19696072426785, -925.9609580367112, -147.5484388258739, -1231.4141197952347, -1096.9577195417464, -418.9814586068006, -894.6244754652521, -107.55769625949765, -161.63770302618997, -1361.352274757507, -772.7148683046734, -101.91534154091764, -980.3507879847739, -834.1771985718677, -1139.2987915657282, -103.849551483678, -871.3559158871445, -976.7922480018531, -362.80961764377696, -794.1498073518476, -906.176950394274, -795.1782660013381, -744.4781909968668, -543.2258163556687, -298.3886696563677, -402.870305933595, -796.607460564261, -1047.0166768093654, -408.2722321427819, -1051.967233586948, -450.0896751157375, -365.5600025889084, -35.065631546349955, -625.2640772540449, -727.6449459576538, -117.2263715814722, -515.428887273859, -537.4838778546819, -626.410777383854, -389.40087398229343, -752.4193495134118, -608.5632294733585, -660.8570538606875, -1054.3423388457445, -623.0622184535181, -454.5386862774782, -330.4993894290578, -421.6104381209645, -170.12417570261744, -1.8224559741354889, -412.4421159439255, -9.85086359864593, -911.5021361725869, -780.2577763364562, -356.24777401001495, -684.9243108367596, -632.33411374482, -260.1366578516098, -304.5320375279457, -482.52918143861064, -1084.5955477578923, -897.7605929277153, -757.6338755513623, -850.6005530435518, -925.8962524645469, -1015.6396507085748, -877.2498582966201, -520.9369571912039, -860.0130561854133, -699.061143180076, -714.8201692890646, -1130.2824612243653, -306.15614395881755, -506.7683819668947, -22.40040206834561, -85.12982260926907], "episode_lengths": [150, 150, 150, 150, 150, 83, 150, 89, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 112, 150, 64, 150, 150, 74, 150, 64, 150, 150, 150, 150, 93, 109, 150, 150, 58, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 64, 150, 142, 59, 150, 121, 150, 124, 150, 150, 150, 150, 150, 150, 92, 102, 69, 37, 150, 45, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 119, 46, 66], "policy_policy_0_reward": [-560.3229430382866, -1057.559026468687, -1062.4133668808217, -805.7368680031834, -768.300235265116, -302.9450835834005, -1023.744236168708, -316.2101146479553, -972.6145956327852, -762.3237066405622, -1171.4426760779604, -728.739152379785, -556.2907952591579, -895.3784590099916, -1118.8226242421865, -40.663490735559286, -886.5410583550264, -550.6811570614731, -694.213116379925, -256.319609493271, -1174.7660747761743, -83.23894911118859, -1037.6950660145123, -1042.1989245587242, -205.19696072426785, -925.9609580367112, -147.5484388258739, -1231.4141197952347, -1096.9577195417464, -418.9814586068006, -894.6244754652521, -107.55769625949765, -161.63770302618997, -1361.352274757507, -772.7148683046734, -101.91534154091764, -980.3507879847739, -834.1771985718677, -1139.2987915657282, -103.849551483678, -871.3559158871445, -976.7922480018531, -362.80961764377696, -794.1498073518476, -906.176950394274, -795.1782660013381, -744.4781909968668, -543.2258163556687, -298.3886696563677, -402.870305933595, -796.607460564261, -1047.0166768093654, -408.2722321427819, -1051.967233586948, -450.0896751157375, -365.5600025889084, -35.065631546349955, -625.2640772540449, -727.6449459576538, -117.2263715814722, -515.428887273859, -537.4838778546819, -626.410777383854, -389.40087398229343, -752.4193495134118, -608.5632294733585, -660.8570538606875, -1054.3423388457445, -623.0622184535181, -454.5386862774782, -330.4993894290578, -421.6104381209645, -170.12417570261744, -1.8224559741354889, -412.4421159439255, -9.85086359864593, -911.5021361725869, -780.2577763364562, -356.24777401001495, -684.9243108367596, -632.33411374482, -260.1366578516098, -304.5320375279457, -482.52918143861064, -1084.5955477578923, -897.7605929277153, -757.6338755513623, -850.6005530435518, -925.8962524645469, -1015.6396507085748, -877.2498582966201, -520.9369571912039, -860.0130561854133, -699.061143180076, -714.8201692890646, -1130.2824612243653, -306.15614395881755, -506.7683819668947, -22.40040206834561, -85.12982260926907]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3012027252085406, "mean_inference_ms": 0.9370395863682397, "mean_action_processing_ms": 0.16718764071957948, "mean_env_wait_ms": 1.6918322185859405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005781888961791992, "StateBufferConnector_ms": 0.004252910614013672, "ViewRequirementAgentConnector_ms": 0.1073601245880127}, "num_episodes": 31, "episode_return_max": -1.8224559741354889, "episode_return_min": -1361.352274757507, "episode_return_mean": -639.0910535767617, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.49759890376504, "num_env_steps_trained_throughput_per_sec": 295.49759890376504, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 13654.413, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13654.336, "sample_time_ms": 2771.225, "learn_time_ms": 10866.259, "learn_throughput": 368.112, "synch_weights_time_ms": 16.023}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "training_iteration": 35, "trial_id": "6d52d_00000", "date": "2024-07-26_22-51-55", "timestamp": 1722014515, "time_this_iter_s": 13.542057275772095, "time_total_s": 471.316499710083, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c39dd80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 471.316499710083, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 11.289473684210527, "ram_util_percent": 28.85263157894737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 210.91727414329847, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.7489519926408925, "policy_loss": -0.009490738827541161, "vf_loss": 3.7609364562978347, "vf_explained_var": 0.986436274026831, "kl": 0.01906296447111045, "entropy": 1.1072068285817902, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": -1.8224559741354889, "episode_reward_min": -1361.352274757507, "episode_reward_mean": -600.4987941950661, "episode_len_mean": 131.12, "episode_media": {}, "episodes_timesteps_total": 13112, "policy_reward_min": {"policy_0": -1361.352274757507}, "policy_reward_max": {"policy_0": -1.8224559741354889}, "policy_reward_mean": {"policy_0": -600.4987941950661}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-107.55769625949765, -161.63770302618997, -1361.352274757507, -772.7148683046734, -101.91534154091764, -980.3507879847739, -834.1771985718677, -1139.2987915657282, -103.849551483678, -871.3559158871445, -976.7922480018531, -362.80961764377696, -794.1498073518476, -906.176950394274, -795.1782660013381, -744.4781909968668, -543.2258163556687, -298.3886696563677, -402.870305933595, -796.607460564261, -1047.0166768093654, -408.2722321427819, -1051.967233586948, -450.0896751157375, -365.5600025889084, -35.065631546349955, -625.2640772540449, -727.6449459576538, -117.2263715814722, -515.428887273859, -537.4838778546819, -626.410777383854, -389.40087398229343, -752.4193495134118, -608.5632294733585, -660.8570538606875, -1054.3423388457445, -623.0622184535181, -454.5386862774782, -330.4993894290578, -421.6104381209645, -170.12417570261744, -1.8224559741354889, -412.4421159439255, -9.85086359864593, -911.5021361725869, -780.2577763364562, -356.24777401001495, -684.9243108367596, -632.33411374482, -260.1366578516098, -304.5320375279457, -482.52918143861064, -1084.5955477578923, -897.7605929277153, -757.6338755513623, -850.6005530435518, -925.8962524645469, -1015.6396507085748, -877.2498582966201, -520.9369571912039, -860.0130561854133, -699.061143180076, -714.8201692890646, -1130.2824612243653, -306.15614395881755, -506.7683819668947, -22.40040206834561, -85.12982260926907, -729.5061626108388, -680.563127041338, -975.1983714625119, -141.45265531223345, -640.730466879075, -172.34396054111582, -888.1217826878735, -666.2814908844942, -1055.8689850296944, -456.5639852647815, -1000.2111923693309, -998.1838026517003, -685.0399885064818, -919.6565484712497, -325.63021735145884, -113.39717426491981, -121.5934068289485, -542.3653952637632, -808.1431098312612, -180.72205075786246, -133.97439374945097, -929.0778282911099, -1090.0724703000026, -818.7030923172673, -602.3471546318876, -960.7370824143587, -378.97874082659916, -834.9976968559769, -294.8557623552025, -123.96017034667521, -661.34125651131], "episode_lengths": [93, 109, 150, 150, 58, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 64, 150, 142, 59, 150, 121, 150, 124, 150, 150, 150, 150, 150, 150, 92, 102, 69, 37, 150, 45, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 119, 46, 66, 150, 150, 150, 59, 150, 100, 150, 150, 150, 129, 150, 150, 150, 150, 122, 84, 74, 150, 150, 99, 66, 150, 150, 150, 150, 150, 112, 150, 123, 68, 150], "policy_policy_0_reward": [-107.55769625949765, -161.63770302618997, -1361.352274757507, -772.7148683046734, -101.91534154091764, -980.3507879847739, -834.1771985718677, -1139.2987915657282, -103.849551483678, -871.3559158871445, -976.7922480018531, -362.80961764377696, -794.1498073518476, -906.176950394274, -795.1782660013381, -744.4781909968668, -543.2258163556687, -298.3886696563677, -402.870305933595, -796.607460564261, -1047.0166768093654, -408.2722321427819, -1051.967233586948, -450.0896751157375, -365.5600025889084, -35.065631546349955, -625.2640772540449, -727.6449459576538, -117.2263715814722, -515.428887273859, -537.4838778546819, -626.410777383854, -389.40087398229343, -752.4193495134118, -608.5632294733585, -660.8570538606875, -1054.3423388457445, -623.0622184535181, -454.5386862774782, -330.4993894290578, -421.6104381209645, -170.12417570261744, -1.8224559741354889, -412.4421159439255, -9.85086359864593, -911.5021361725869, -780.2577763364562, -356.24777401001495, -684.9243108367596, -632.33411374482, -260.1366578516098, -304.5320375279457, -482.52918143861064, -1084.5955477578923, -897.7605929277153, -757.6338755513623, -850.6005530435518, -925.8962524645469, -1015.6396507085748, -877.2498582966201, -520.9369571912039, -860.0130561854133, -699.061143180076, -714.8201692890646, -1130.2824612243653, -306.15614395881755, -506.7683819668947, -22.40040206834561, -85.12982260926907, -729.5061626108388, -680.563127041338, -975.1983714625119, -141.45265531223345, -640.730466879075, -172.34396054111582, -888.1217826878735, -666.2814908844942, -1055.8689850296944, -456.5639852647815, -1000.2111923693309, -998.1838026517003, -685.0399885064818, -919.6565484712497, -325.63021735145884, -113.39717426491981, -121.5934068289485, -542.3653952637632, -808.1431098312612, -180.72205075786246, -133.97439374945097, -929.0778282911099, -1090.0724703000026, -818.7030923172673, -602.3471546318876, -960.7370824143587, -378.97874082659916, -834.9976968559769, -294.8557623552025, -123.96017034667521, -661.34125651131]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3014860042298607, "mean_inference_ms": 0.9373406557775198, "mean_action_processing_ms": 0.16721914148306566, "mean_env_wait_ms": 1.6931162217703888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005837678909301758, "StateBufferConnector_ms": 0.004232645034790039, "ViewRequirementAgentConnector_ms": 0.10619640350341797}, "num_episodes": 31, "episode_return_max": -1.8224559741354889, "episode_return_min": -1361.352274757507, "episode_return_mean": -600.4987941950661, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.65304279387027, "num_env_steps_trained_throughput_per_sec": 274.65304279387027, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 13647.913, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13647.836, "sample_time_ms": 2733.043, "learn_time_ms": 10898.208, "learn_throughput": 367.033, "synch_weights_time_ms": 15.757}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 36, "trial_id": "6d52d_00000", "date": "2024-07-26_22-52-10", "timestamp": 1722014530, "time_this_iter_s": 14.572383880615234, "time_total_s": 485.88888359069824, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c39fbe0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 485.88888359069824, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 10.219047619047618, "ram_util_percent": 28.700000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 184.10263749758403, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.222664845734835, "policy_loss": -0.013027441466692834, "vf_loss": 4.240921276807785, "vf_explained_var": 0.9637072018037239, "kl": 0.014409895934689642, "entropy": 1.171344949801763, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "env_runners": {"episode_reward_max": -1.8224559741354889, "episode_reward_min": -1194.9696327127162, "episode_reward_mean": -609.1791184246949, "episode_len_mean": 131.17, "episode_media": {}, "episodes_timesteps_total": 13117, "policy_reward_min": {"policy_0": -1194.9696327127162}, "policy_reward_max": {"policy_0": -1.8224559741354889}, "policy_reward_mean": {"policy_0": -609.1791184246949}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-537.4838778546819, -626.410777383854, -389.40087398229343, -752.4193495134118, -608.5632294733585, -660.8570538606875, -1054.3423388457445, -623.0622184535181, -454.5386862774782, -330.4993894290578, -421.6104381209645, -170.12417570261744, -1.8224559741354889, -412.4421159439255, -9.85086359864593, -911.5021361725869, -780.2577763364562, -356.24777401001495, -684.9243108367596, -632.33411374482, -260.1366578516098, -304.5320375279457, -482.52918143861064, -1084.5955477578923, -897.7605929277153, -757.6338755513623, -850.6005530435518, -925.8962524645469, -1015.6396507085748, -877.2498582966201, -520.9369571912039, -860.0130561854133, -699.061143180076, -714.8201692890646, -1130.2824612243653, -306.15614395881755, -506.7683819668947, -22.40040206834561, -85.12982260926907, -729.5061626108388, -680.563127041338, -975.1983714625119, -141.45265531223345, -640.730466879075, -172.34396054111582, -888.1217826878735, -666.2814908844942, -1055.8689850296944, -456.5639852647815, -1000.2111923693309, -998.1838026517003, -685.0399885064818, -919.6565484712497, -325.63021735145884, -113.39717426491981, -121.5934068289485, -542.3653952637632, -808.1431098312612, -180.72205075786246, -133.97439374945097, -929.0778282911099, -1090.0724703000026, -818.7030923172673, -602.3471546318876, -960.7370824143587, -378.97874082659916, -834.9976968559769, -294.8557623552025, -123.96017034667521, -661.34125651131, -724.2209441933982, -879.0721732522563, -709.1491134079758, -56.249806525472806, -742.2031847306116, -662.2724835238129, -112.02567279127386, -29.4539091293642, -1162.9417750926598, -585.5956538412029, -7.125087458198272, -754.3550891860808, -852.7328581769278, -1194.9696327127162, -665.4149916787269, -711.3342108968733, -367.45446116722627, -374.8817744397506, -327.46256546934757, -695.995733534694, -1032.5265595123892, -715.0426424886679, -838.4090516470184, -1099.8172892201278, -420.80617166662654, -535.3945153301445, -794.553351288941, -909.437594070355, -632.7073456619598, -672.849977007034], "episode_lengths": [121, 150, 124, 150, 150, 150, 150, 150, 150, 92, 102, 69, 37, 150, 45, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 119, 46, 66, 150, 150, 150, 59, 150, 100, 150, 150, 150, 129, 150, 150, 150, 150, 122, 84, 74, 150, 150, 99, 66, 150, 150, 150, 150, 150, 112, 150, 123, 68, 150, 150, 150, 150, 76, 150, 150, 75, 52, 150, 132, 42, 145, 150, 150, 145, 150, 150, 140, 114, 150, 150, 150, 150, 150, 125, 150, 150, 150, 134, 150], "policy_policy_0_reward": [-537.4838778546819, -626.410777383854, -389.40087398229343, -752.4193495134118, -608.5632294733585, -660.8570538606875, -1054.3423388457445, -623.0622184535181, -454.5386862774782, -330.4993894290578, -421.6104381209645, -170.12417570261744, -1.8224559741354889, -412.4421159439255, -9.85086359864593, -911.5021361725869, -780.2577763364562, -356.24777401001495, -684.9243108367596, -632.33411374482, -260.1366578516098, -304.5320375279457, -482.52918143861064, -1084.5955477578923, -897.7605929277153, -757.6338755513623, -850.6005530435518, -925.8962524645469, -1015.6396507085748, -877.2498582966201, -520.9369571912039, -860.0130561854133, -699.061143180076, -714.8201692890646, -1130.2824612243653, -306.15614395881755, -506.7683819668947, -22.40040206834561, -85.12982260926907, -729.5061626108388, -680.563127041338, -975.1983714625119, -141.45265531223345, -640.730466879075, -172.34396054111582, -888.1217826878735, -666.2814908844942, -1055.8689850296944, -456.5639852647815, -1000.2111923693309, -998.1838026517003, -685.0399885064818, -919.6565484712497, -325.63021735145884, -113.39717426491981, -121.5934068289485, -542.3653952637632, -808.1431098312612, -180.72205075786246, -133.97439374945097, -929.0778282911099, -1090.0724703000026, -818.7030923172673, -602.3471546318876, -960.7370824143587, -378.97874082659916, -834.9976968559769, -294.8557623552025, -123.96017034667521, -661.34125651131, -724.2209441933982, -879.0721732522563, -709.1491134079758, -56.249806525472806, -742.2031847306116, -662.2724835238129, -112.02567279127386, -29.4539091293642, -1162.9417750926598, -585.5956538412029, -7.125087458198272, -754.3550891860808, -852.7328581769278, -1194.9696327127162, -665.4149916787269, -711.3342108968733, -367.45446116722627, -374.8817744397506, -327.46256546934757, -695.995733534694, -1032.5265595123892, -715.0426424886679, -838.4090516470184, -1099.8172892201278, -420.80617166662654, -535.3945153301445, -794.553351288941, -909.437594070355, -632.7073456619598, -672.849977007034]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3014367465309676, "mean_inference_ms": 0.9372056012502068, "mean_action_processing_ms": 0.16709532600357282, "mean_env_wait_ms": 1.6922054456876732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005884408950805664, "StateBufferConnector_ms": 0.004244804382324219, "ViewRequirementAgentConnector_ms": 0.10569572448730469}, "num_episodes": 30, "episode_return_max": -1.8224559741354889, "episode_return_min": -1194.9696327127162, "episode_return_mean": -609.1791184246949, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 282.25985260865264, "num_env_steps_trained_throughput_per_sec": 282.25985260865264, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 13668.469, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13668.396, "sample_time_ms": 2739.338, "learn_time_ms": 10911.99, "learn_throughput": 366.569, "synch_weights_time_ms": 16.196}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "training_iteration": 37, "trial_id": "6d52d_00000", "date": "2024-07-26_22-52-24", "timestamp": 1722014544, "time_this_iter_s": 14.176897525787354, "time_total_s": 500.0657811164856, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c3d85e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 500.0657811164856, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 10.555, "ram_util_percent": 28.660000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 176.69551030596097, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.0468754060566425, "policy_loss": -0.011591157628087483, "vf_loss": 4.065059465169907, "vf_explained_var": 0.9851363352189462, "kl": 0.015567199833064175, "entropy": 1.359813277920087, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "env_runners": {"episode_reward_max": -7.125087458198272, "episode_reward_min": -1194.9696327127162, "episode_reward_mean": -636.7545391218182, "episode_len_mean": 133.18, "episode_media": {}, "episodes_timesteps_total": 13318, "policy_reward_min": {"policy_0": -1194.9696327127162}, "policy_reward_max": {"policy_0": -7.125087458198272}, "policy_reward_mean": {"policy_0": -636.7545391218182}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-877.2498582966201, -520.9369571912039, -860.0130561854133, -699.061143180076, -714.8201692890646, -1130.2824612243653, -306.15614395881755, -506.7683819668947, -22.40040206834561, -85.12982260926907, -729.5061626108388, -680.563127041338, -975.1983714625119, -141.45265531223345, -640.730466879075, -172.34396054111582, -888.1217826878735, -666.2814908844942, -1055.8689850296944, -456.5639852647815, -1000.2111923693309, -998.1838026517003, -685.0399885064818, -919.6565484712497, -325.63021735145884, -113.39717426491981, -121.5934068289485, -542.3653952637632, -808.1431098312612, -180.72205075786246, -133.97439374945097, -929.0778282911099, -1090.0724703000026, -818.7030923172673, -602.3471546318876, -960.7370824143587, -378.97874082659916, -834.9976968559769, -294.8557623552025, -123.96017034667521, -661.34125651131, -724.2209441933982, -879.0721732522563, -709.1491134079758, -56.249806525472806, -742.2031847306116, -662.2724835238129, -112.02567279127386, -29.4539091293642, -1162.9417750926598, -585.5956538412029, -7.125087458198272, -754.3550891860808, -852.7328581769278, -1194.9696327127162, -665.4149916787269, -711.3342108968733, -367.45446116722627, -374.8817744397506, -327.46256546934757, -695.995733534694, -1032.5265595123892, -715.0426424886679, -838.4090516470184, -1099.8172892201278, -420.80617166662654, -535.3945153301445, -794.553351288941, -909.437594070355, -632.7073456619598, -672.849977007034, -851.3003714980766, -748.8659696356469, -543.99975657541, -819.5675488155568, -1165.9425540496968, -1083.3906967709568, -886.2944094392258, -596.2200286687666, -372.6755775631123, -988.3377117067031, -449.7311403807479, -325.4964419013126, -558.3216778819802, -771.9102044858021, -1068.298801236651, -1043.2994793618188, -271.5358917661045, -1047.6891504582516, -449.66336965193534, -211.55822802913812, -1174.010366286535, -201.75676165332774, -1125.395836621649, -428.24846201894314, -177.85711501800802, -367.6010175111577, -891.1567103330643, -763.8619850590835, -371.57311012047523], "episode_lengths": [150, 150, 150, 150, 150, 150, 86, 119, 46, 66, 150, 150, 150, 59, 150, 100, 150, 150, 150, 129, 150, 150, 150, 150, 122, 84, 74, 150, 150, 99, 66, 150, 150, 150, 150, 150, 112, 150, 123, 68, 150, 150, 150, 150, 76, 150, 150, 75, 52, 150, 132, 42, 145, 150, 150, 145, 150, 150, 140, 114, 150, 150, 150, 150, 150, 125, 150, 150, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 128, 150, 150, 150, 94, 150, 150, 106, 150, 109, 150, 150, 102, 116, 150, 150, 131], "policy_policy_0_reward": [-877.2498582966201, -520.9369571912039, -860.0130561854133, -699.061143180076, -714.8201692890646, -1130.2824612243653, -306.15614395881755, -506.7683819668947, -22.40040206834561, -85.12982260926907, -729.5061626108388, -680.563127041338, -975.1983714625119, -141.45265531223345, -640.730466879075, -172.34396054111582, -888.1217826878735, -666.2814908844942, -1055.8689850296944, -456.5639852647815, -1000.2111923693309, -998.1838026517003, -685.0399885064818, -919.6565484712497, -325.63021735145884, -113.39717426491981, -121.5934068289485, -542.3653952637632, -808.1431098312612, -180.72205075786246, -133.97439374945097, -929.0778282911099, -1090.0724703000026, -818.7030923172673, -602.3471546318876, -960.7370824143587, -378.97874082659916, -834.9976968559769, -294.8557623552025, -123.96017034667521, -661.34125651131, -724.2209441933982, -879.0721732522563, -709.1491134079758, -56.249806525472806, -742.2031847306116, -662.2724835238129, -112.02567279127386, -29.4539091293642, -1162.9417750926598, -585.5956538412029, -7.125087458198272, -754.3550891860808, -852.7328581769278, -1194.9696327127162, -665.4149916787269, -711.3342108968733, -367.45446116722627, -374.8817744397506, -327.46256546934757, -695.995733534694, -1032.5265595123892, -715.0426424886679, -838.4090516470184, -1099.8172892201278, -420.80617166662654, -535.3945153301445, -794.553351288941, -909.437594070355, -632.7073456619598, -672.849977007034, -851.3003714980766, -748.8659696356469, -543.99975657541, -819.5675488155568, -1165.9425540496968, -1083.3906967709568, -886.2944094392258, -596.2200286687666, -372.6755775631123, -988.3377117067031, -449.7311403807479, -325.4964419013126, -558.3216778819802, -771.9102044858021, -1068.298801236651, -1043.2994793618188, -271.5358917661045, -1047.6891504582516, -449.66336965193534, -211.55822802913812, -1174.010366286535, -201.75676165332774, -1125.395836621649, -428.24846201894314, -177.85711501800802, -367.6010175111577, -891.1567103330643, -763.8619850590835, -371.57311012047523]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3015739117671263, "mean_inference_ms": 0.93704117561338, "mean_action_processing_ms": 0.16722804874282865, "mean_env_wait_ms": 1.6947798904947404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005666255950927734, "StateBufferConnector_ms": 0.004179477691650391, "ViewRequirementAgentConnector_ms": 0.10357284545898438}, "num_episodes": 29, "episode_return_max": -7.125087458198272, "episode_return_min": -1194.9696327127162, "episode_return_mean": -636.7545391218182, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.0460675198612, "num_env_steps_trained_throughput_per_sec": 292.0460675198612, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 13616.16, "restore_workers_time_ms": 0.023, "training_step_time_ms": 13616.087, "sample_time_ms": 2739.375, "learn_time_ms": 10859.613, "learn_throughput": 368.337, "synch_weights_time_ms": 16.228}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "training_iteration": 38, "trial_id": "6d52d_00000", "date": "2024-07-26_22-52-38", "timestamp": 1722014558, "time_this_iter_s": 13.702080726623535, "time_total_s": 513.7678618431091, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c3d9cf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 513.7678618431091, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 11.540000000000001, "ram_util_percent": 28.590000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 221.692184060812, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.4035969941566386, "policy_loss": -0.0060609627248292474, "vf_loss": 3.4142801079899074, "vf_explained_var": 0.988918477234741, "kl": 0.01819397803149821, "entropy": 1.280943788215518, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "env_runners": {"episode_reward_max": -7.125087458198272, "episode_reward_min": -1266.7933603308527, "episode_reward_mean": -655.7338534030341, "episode_len_mean": 133.2, "episode_media": {}, "episodes_timesteps_total": 13320, "policy_reward_min": {"policy_0": -1266.7933603308527}, "policy_reward_max": {"policy_0": -7.125087458198272}, "policy_reward_mean": {"policy_0": -655.7338534030341}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1090.0724703000026, -818.7030923172673, -602.3471546318876, -960.7370824143587, -378.97874082659916, -834.9976968559769, -294.8557623552025, -123.96017034667521, -661.34125651131, -724.2209441933982, -879.0721732522563, -709.1491134079758, -56.249806525472806, -742.2031847306116, -662.2724835238129, -112.02567279127386, -29.4539091293642, -1162.9417750926598, -585.5956538412029, -7.125087458198272, -754.3550891860808, -852.7328581769278, -1194.9696327127162, -665.4149916787269, -711.3342108968733, -367.45446116722627, -374.8817744397506, -327.46256546934757, -695.995733534694, -1032.5265595123892, -715.0426424886679, -838.4090516470184, -1099.8172892201278, -420.80617166662654, -535.3945153301445, -794.553351288941, -909.437594070355, -632.7073456619598, -672.849977007034, -851.3003714980766, -748.8659696356469, -543.99975657541, -819.5675488155568, -1165.9425540496968, -1083.3906967709568, -886.2944094392258, -596.2200286687666, -372.6755775631123, -988.3377117067031, -449.7311403807479, -325.4964419013126, -558.3216778819802, -771.9102044858021, -1068.298801236651, -1043.2994793618188, -271.5358917661045, -1047.6891504582516, -449.66336965193534, -211.55822802913812, -1174.010366286535, -201.75676165332774, -1125.395836621649, -428.24846201894314, -177.85711501800802, -367.6010175111577, -891.1567103330643, -763.8619850590835, -371.57311012047523, -24.08660778149819, -883.0771354178104, -1029.6316496501292, -975.8147990408983, -736.2704557525116, -304.6843993228555, -1206.730907018201, -1017.8569555597074, -971.5609863355072, -640.819617364142, -1015.3058869236156, -643.4925755034526, -181.87106117936298, -634.6836483068549, -330.5027707572674, -745.1904508422718, -595.3518548431762, -117.51880944538229, -1009.0933572010294, -483.12500073634345, -474.30261256011437, -867.9977757690741, -653.2892649027195, -1093.606667231154, -225.34622292836858, -8.946503481746099, -1266.7933603308527, -368.18281545871383, -1130.3769792232747, -1047.7452868619168, -76.18041001503909, -25.93909239817387], "episode_lengths": [150, 150, 150, 150, 112, 150, 123, 68, 150, 150, 150, 150, 76, 150, 150, 75, 52, 150, 132, 42, 145, 150, 150, 145, 150, 150, 140, 114, 150, 150, 150, 150, 150, 125, 150, 150, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 128, 150, 150, 150, 94, 150, 150, 106, 150, 109, 150, 150, 102, 116, 150, 150, 131, 54, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 146, 104, 133, 132, 150, 150, 56, 150, 114, 150, 150, 150, 150, 89, 40, 150, 150, 150, 150, 54, 45], "policy_policy_0_reward": [-1090.0724703000026, -818.7030923172673, -602.3471546318876, -960.7370824143587, -378.97874082659916, -834.9976968559769, -294.8557623552025, -123.96017034667521, -661.34125651131, -724.2209441933982, -879.0721732522563, -709.1491134079758, -56.249806525472806, -742.2031847306116, -662.2724835238129, -112.02567279127386, -29.4539091293642, -1162.9417750926598, -585.5956538412029, -7.125087458198272, -754.3550891860808, -852.7328581769278, -1194.9696327127162, -665.4149916787269, -711.3342108968733, -367.45446116722627, -374.8817744397506, -327.46256546934757, -695.995733534694, -1032.5265595123892, -715.0426424886679, -838.4090516470184, -1099.8172892201278, -420.80617166662654, -535.3945153301445, -794.553351288941, -909.437594070355, -632.7073456619598, -672.849977007034, -851.3003714980766, -748.8659696356469, -543.99975657541, -819.5675488155568, -1165.9425540496968, -1083.3906967709568, -886.2944094392258, -596.2200286687666, -372.6755775631123, -988.3377117067031, -449.7311403807479, -325.4964419013126, -558.3216778819802, -771.9102044858021, -1068.298801236651, -1043.2994793618188, -271.5358917661045, -1047.6891504582516, -449.66336965193534, -211.55822802913812, -1174.010366286535, -201.75676165332774, -1125.395836621649, -428.24846201894314, -177.85711501800802, -367.6010175111577, -891.1567103330643, -763.8619850590835, -371.57311012047523, -24.08660778149819, -883.0771354178104, -1029.6316496501292, -975.8147990408983, -736.2704557525116, -304.6843993228555, -1206.730907018201, -1017.8569555597074, -971.5609863355072, -640.819617364142, -1015.3058869236156, -643.4925755034526, -181.87106117936298, -634.6836483068549, -330.5027707572674, -745.1904508422718, -595.3518548431762, -117.51880944538229, -1009.0933572010294, -483.12500073634345, -474.30261256011437, -867.9977757690741, -653.2892649027195, -1093.606667231154, -225.34622292836858, -8.946503481746099, -1266.7933603308527, -368.18281545871383, -1130.3769792232747, -1047.7452868619168, -76.18041001503909, -25.93909239817387]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3014009790171718, "mean_inference_ms": 0.936324861632233, "mean_action_processing_ms": 0.16717998096383077, "mean_env_wait_ms": 1.6928614200719294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005736351013183594, "StateBufferConnector_ms": 0.00420832633972168, "ViewRequirementAgentConnector_ms": 0.10460090637207031}, "num_episodes": 32, "episode_return_max": -7.125087458198272, "episode_return_min": -1266.7933603308527, "episode_return_mean": -655.7338534030341, "episodes_this_iter": 32}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.105674645412, "num_env_steps_trained_throughput_per_sec": 304.105674645412, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 13720.916, "restore_workers_time_ms": 0.023, "training_step_time_ms": 13720.844, "sample_time_ms": 2739.465, "learn_time_ms": 10964.592, "learn_throughput": 364.811, "synch_weights_time_ms": 15.927}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "training_iteration": 39, "trial_id": "6d52d_00000", "date": "2024-07-26_22-52-51", "timestamp": 1722014571, "time_this_iter_s": 13.161918640136719, "time_total_s": 526.9297804832458, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c3d9c60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 526.9297804832458, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 14.194444444444443, "ram_util_percent": 28.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 211.03643918236097, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.088738515724739, "policy_loss": -0.011674780276371166, "vf_loss": 4.103075552235047, "vf_explained_var": 0.9793302909160654, "kl": 0.019342211793609048, "entropy": 1.1366255623598893, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": -3.133235212988277, "episode_reward_min": -1266.7933603308527, "episode_reward_mean": -665.2635967067006, "episode_len_mean": 133.16, "episode_media": {}, "episodes_timesteps_total": 13316, "policy_reward_min": {"policy_0": -1266.7933603308527}, "policy_reward_max": {"policy_0": -3.133235212988277}, "policy_reward_mean": {"policy_0": -665.2635967067006}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-838.4090516470184, -1099.8172892201278, -420.80617166662654, -535.3945153301445, -794.553351288941, -909.437594070355, -632.7073456619598, -672.849977007034, -851.3003714980766, -748.8659696356469, -543.99975657541, -819.5675488155568, -1165.9425540496968, -1083.3906967709568, -886.2944094392258, -596.2200286687666, -372.6755775631123, -988.3377117067031, -449.7311403807479, -325.4964419013126, -558.3216778819802, -771.9102044858021, -1068.298801236651, -1043.2994793618188, -271.5358917661045, -1047.6891504582516, -449.66336965193534, -211.55822802913812, -1174.010366286535, -201.75676165332774, -1125.395836621649, -428.24846201894314, -177.85711501800802, -367.6010175111577, -891.1567103330643, -763.8619850590835, -371.57311012047523, -24.08660778149819, -883.0771354178104, -1029.6316496501292, -975.8147990408983, -736.2704557525116, -304.6843993228555, -1206.730907018201, -1017.8569555597074, -971.5609863355072, -640.819617364142, -1015.3058869236156, -643.4925755034526, -181.87106117936298, -634.6836483068549, -330.5027707572674, -745.1904508422718, -595.3518548431762, -117.51880944538229, -1009.0933572010294, -483.12500073634345, -474.30261256011437, -867.9977757690741, -653.2892649027195, -1093.606667231154, -225.34622292836858, -8.946503481746099, -1266.7933603308527, -368.18281545871383, -1130.3769792232747, -1047.7452868619168, -76.18041001503909, -25.93909239817387, -1044.7184020359255, -1045.9439897159075, -398.38400363971874, -1218.1089144819623, -886.5696786836207, -981.1226512992788, -273.5166072448134, -525.4871885954091, -395.0598012423976, -890.0767425136175, -164.61130077429095, -993.2315593478581, -764.3093144084793, -709.4738829199568, -130.66235609633046, -863.3289892141834, -841.6839002532276, -307.195331121317, -276.03588868252234, -401.0828510163746, -345.99688216703663, -326.1151872164818, -631.4768142122501, -1088.5161061854392, -1152.9383289232237, -665.009916352802, -824.8854842069175, -32.15953556244376, -3.133235212988277, -1078.0778996596207, -822.5353371491507], "episode_lengths": [150, 150, 125, 150, 150, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 128, 150, 150, 150, 94, 150, 150, 106, 150, 109, 150, 150, 102, 116, 150, 150, 131, 54, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 146, 104, 133, 132, 150, 150, 56, 150, 114, 150, 150, 150, 150, 89, 40, 150, 150, 150, 150, 54, 45, 150, 150, 107, 150, 150, 150, 113, 150, 150, 150, 80, 150, 150, 150, 60, 150, 150, 118, 116, 150, 150, 95, 129, 150, 150, 150, 150, 58, 44, 150, 150], "policy_policy_0_reward": [-838.4090516470184, -1099.8172892201278, -420.80617166662654, -535.3945153301445, -794.553351288941, -909.437594070355, -632.7073456619598, -672.849977007034, -851.3003714980766, -748.8659696356469, -543.99975657541, -819.5675488155568, -1165.9425540496968, -1083.3906967709568, -886.2944094392258, -596.2200286687666, -372.6755775631123, -988.3377117067031, -449.7311403807479, -325.4964419013126, -558.3216778819802, -771.9102044858021, -1068.298801236651, -1043.2994793618188, -271.5358917661045, -1047.6891504582516, -449.66336965193534, -211.55822802913812, -1174.010366286535, -201.75676165332774, -1125.395836621649, -428.24846201894314, -177.85711501800802, -367.6010175111577, -891.1567103330643, -763.8619850590835, -371.57311012047523, -24.08660778149819, -883.0771354178104, -1029.6316496501292, -975.8147990408983, -736.2704557525116, -304.6843993228555, -1206.730907018201, -1017.8569555597074, -971.5609863355072, -640.819617364142, -1015.3058869236156, -643.4925755034526, -181.87106117936298, -634.6836483068549, -330.5027707572674, -745.1904508422718, -595.3518548431762, -117.51880944538229, -1009.0933572010294, -483.12500073634345, -474.30261256011437, -867.9977757690741, -653.2892649027195, -1093.606667231154, -225.34622292836858, -8.946503481746099, -1266.7933603308527, -368.18281545871383, -1130.3769792232747, -1047.7452868619168, -76.18041001503909, -25.93909239817387, -1044.7184020359255, -1045.9439897159075, -398.38400363971874, -1218.1089144819623, -886.5696786836207, -981.1226512992788, -273.5166072448134, -525.4871885954091, -395.0598012423976, -890.0767425136175, -164.61130077429095, -993.2315593478581, -764.3093144084793, -709.4738829199568, -130.66235609633046, -863.3289892141834, -841.6839002532276, -307.195331121317, -276.03588868252234, -401.0828510163746, -345.99688216703663, -326.1151872164818, -631.4768142122501, -1088.5161061854392, -1152.9383289232237, -665.009916352802, -824.8854842069175, -32.15953556244376, -3.133235212988277, -1078.0778996596207, -822.5353371491507]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30140805447308805, "mean_inference_ms": 0.9358051628203206, "mean_action_processing_ms": 0.16714859831710632, "mean_env_wait_ms": 1.6941194661995098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005629062652587891, "StateBufferConnector_ms": 0.004163980484008789, "ViewRequirementAgentConnector_ms": 0.10468292236328125}, "num_episodes": 31, "episode_return_max": -3.133235212988277, "episode_return_min": -1266.7933603308527, "episode_return_mean": -665.2635967067006, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.42961041650784, "num_env_steps_trained_throughput_per_sec": 320.42961041650784, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 13658.305, "restore_workers_time_ms": 0.023, "training_step_time_ms": 13658.232, "sample_time_ms": 2743.351, "learn_time_ms": 10898.129, "learn_throughput": 367.035, "synch_weights_time_ms": 15.899}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 40, "trial_id": "6d52d_00000", "date": "2024-07-26_22-53-04", "timestamp": 1722014584, "time_this_iter_s": 12.491315364837646, "time_total_s": 539.4210958480835, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c39fb50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 539.4210958480835, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 10.966666666666665, "ram_util_percent": 28.622222222222224}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 224.17401613990467, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.837443525965015, "policy_loss": -0.008910378486810562, "vf_loss": 3.8507982544600963, "vf_explained_var": 0.9714642715329925, "kl": 0.014932075638201587, "entropy": 1.1163778245449065, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "env_runners": {"episode_reward_max": -3.133235212988277, "episode_reward_min": -1299.1613616637933, "episode_reward_mean": -627.5542040002643, "episode_len_mean": 128.57, "episode_media": {}, "episodes_timesteps_total": 12857, "policy_reward_min": {"policy_0": -1299.1613616637933}, "policy_reward_max": {"policy_0": -3.133235212988277}, "policy_reward_mean": {"policy_0": -627.5542040002643}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1125.395836621649, -428.24846201894314, -177.85711501800802, -367.6010175111577, -891.1567103330643, -763.8619850590835, -371.57311012047523, -24.08660778149819, -883.0771354178104, -1029.6316496501292, -975.8147990408983, -736.2704557525116, -304.6843993228555, -1206.730907018201, -1017.8569555597074, -971.5609863355072, -640.819617364142, -1015.3058869236156, -643.4925755034526, -181.87106117936298, -634.6836483068549, -330.5027707572674, -745.1904508422718, -595.3518548431762, -117.51880944538229, -1009.0933572010294, -483.12500073634345, -474.30261256011437, -867.9977757690741, -653.2892649027195, -1093.606667231154, -225.34622292836858, -8.946503481746099, -1266.7933603308527, -368.18281545871383, -1130.3769792232747, -1047.7452868619168, -76.18041001503909, -25.93909239817387, -1044.7184020359255, -1045.9439897159075, -398.38400363971874, -1218.1089144819623, -886.5696786836207, -981.1226512992788, -273.5166072448134, -525.4871885954091, -395.0598012423976, -890.0767425136175, -164.61130077429095, -993.2315593478581, -764.3093144084793, -709.4738829199568, -130.66235609633046, -863.3289892141834, -841.6839002532276, -307.195331121317, -276.03588868252234, -401.0828510163746, -345.99688216703663, -326.1151872164818, -631.4768142122501, -1088.5161061854392, -1152.9383289232237, -665.009916352802, -824.8854842069175, -32.15953556244376, -3.133235212988277, -1078.0778996596207, -822.5353371491507, -511.02967890058505, -151.24107370348966, -241.9966891834635, -888.5447619811333, -87.2030776029597, -164.3564440085218, -321.1875969640685, -912.6828461724682, -916.7383939448366, -866.595649520061, -1299.1613616637933, -904.1629882488709, -221.78307658542414, -726.1166725062349, -493.13298566130703, -25.7642311246825, -613.1035635178467, -624.1222508173315, -226.0386579578252, -751.0754028477074, -529.9661961142459, -290.4016358645204, -1189.4680112933015, -819.0488403363801, -573.9761445479891, -783.0001222170723, -163.0179335899719, -1044.7590897644734, -598.0819809387972, -825.1448054859718], "episode_lengths": [150, 150, 102, 116, 150, 150, 131, 54, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 146, 104, 133, 132, 150, 150, 56, 150, 114, 150, 150, 150, 150, 89, 40, 150, 150, 150, 150, 54, 45, 150, 150, 107, 150, 150, 150, 113, 150, 150, 150, 80, 150, 150, 150, 60, 150, 150, 118, 116, 150, 150, 95, 129, 150, 150, 150, 150, 58, 44, 150, 150, 111, 70, 134, 150, 62, 81, 97, 150, 150, 150, 150, 150, 72, 150, 147, 34, 150, 150, 76, 150, 150, 124, 150, 150, 150, 150, 78, 150, 150, 150], "policy_policy_0_reward": [-1125.395836621649, -428.24846201894314, -177.85711501800802, -367.6010175111577, -891.1567103330643, -763.8619850590835, -371.57311012047523, -24.08660778149819, -883.0771354178104, -1029.6316496501292, -975.8147990408983, -736.2704557525116, -304.6843993228555, -1206.730907018201, -1017.8569555597074, -971.5609863355072, -640.819617364142, -1015.3058869236156, -643.4925755034526, -181.87106117936298, -634.6836483068549, -330.5027707572674, -745.1904508422718, -595.3518548431762, -117.51880944538229, -1009.0933572010294, -483.12500073634345, -474.30261256011437, -867.9977757690741, -653.2892649027195, -1093.606667231154, -225.34622292836858, -8.946503481746099, -1266.7933603308527, -368.18281545871383, -1130.3769792232747, -1047.7452868619168, -76.18041001503909, -25.93909239817387, -1044.7184020359255, -1045.9439897159075, -398.38400363971874, -1218.1089144819623, -886.5696786836207, -981.1226512992788, -273.5166072448134, -525.4871885954091, -395.0598012423976, -890.0767425136175, -164.61130077429095, -993.2315593478581, -764.3093144084793, -709.4738829199568, -130.66235609633046, -863.3289892141834, -841.6839002532276, -307.195331121317, -276.03588868252234, -401.0828510163746, -345.99688216703663, -326.1151872164818, -631.4768142122501, -1088.5161061854392, -1152.9383289232237, -665.009916352802, -824.8854842069175, -32.15953556244376, -3.133235212988277, -1078.0778996596207, -822.5353371491507, -511.02967890058505, -151.24107370348966, -241.9966891834635, -888.5447619811333, -87.2030776029597, -164.3564440085218, -321.1875969640685, -912.6828461724682, -916.7383939448366, -866.595649520061, -1299.1613616637933, -904.1629882488709, -221.78307658542414, -726.1166725062349, -493.13298566130703, -25.7642311246825, -613.1035635178467, -624.1222508173315, -226.0386579578252, -751.0754028477074, -529.9661961142459, -290.4016358645204, -1189.4680112933015, -819.0488403363801, -573.9761445479891, -783.0001222170723, -163.0179335899719, -1044.7590897644734, -598.0819809387972, -825.1448054859718]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3011653977892235, "mean_inference_ms": 0.9350375117375381, "mean_action_processing_ms": 0.16702177818004688, "mean_env_wait_ms": 1.6912643639745908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005614757537841797, "StateBufferConnector_ms": 0.004183530807495117, "ViewRequirementAgentConnector_ms": 0.10465168952941895}, "num_episodes": 30, "episode_return_max": -3.133235212988277, "episode_return_min": -1299.1613616637933, "episode_return_mean": -627.5542040002643, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.65568173153144, "num_env_steps_trained_throughput_per_sec": 303.65568173153144, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 13584.041, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13583.966, "sample_time_ms": 2745.207, "learn_time_ms": 10821.889, "learn_throughput": 369.621, "synch_weights_time_ms": 16.018}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "training_iteration": 41, "trial_id": "6d52d_00000", "date": "2024-07-26_22-53-17", "timestamp": 1722014597, "time_this_iter_s": 13.181545734405518, "time_total_s": 552.602641582489, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d139df21240>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 552.602641582489, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 10.721052631578948, "ram_util_percent": 28.563157894736843}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 212.9132245341937, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.7008807382235926, "policy_loss": -0.007492596622129592, "vf_loss": 3.712600028142333, "vf_explained_var": 0.9797160509352882, "kl": 0.016785736845364878, "entropy": 1.1780280810470383, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "env_runners": {"episode_reward_max": -3.133235212988277, "episode_reward_min": -1299.1613616637933, "episode_reward_mean": -614.4553857465695, "episode_len_mean": 126.34, "episode_media": {}, "episodes_timesteps_total": 12634, "policy_reward_min": {"policy_0": -1299.1613616637933}, "policy_reward_max": {"policy_0": -3.133235212988277}, "policy_reward_mean": {"policy_0": -614.4553857465695}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-225.34622292836858, -8.946503481746099, -1266.7933603308527, -368.18281545871383, -1130.3769792232747, -1047.7452868619168, -76.18041001503909, -25.93909239817387, -1044.7184020359255, -1045.9439897159075, -398.38400363971874, -1218.1089144819623, -886.5696786836207, -981.1226512992788, -273.5166072448134, -525.4871885954091, -395.0598012423976, -890.0767425136175, -164.61130077429095, -993.2315593478581, -764.3093144084793, -709.4738829199568, -130.66235609633046, -863.3289892141834, -841.6839002532276, -307.195331121317, -276.03588868252234, -401.0828510163746, -345.99688216703663, -326.1151872164818, -631.4768142122501, -1088.5161061854392, -1152.9383289232237, -665.009916352802, -824.8854842069175, -32.15953556244376, -3.133235212988277, -1078.0778996596207, -822.5353371491507, -511.02967890058505, -151.24107370348966, -241.9966891834635, -888.5447619811333, -87.2030776029597, -164.3564440085218, -321.1875969640685, -912.6828461724682, -916.7383939448366, -866.595649520061, -1299.1613616637933, -904.1629882488709, -221.78307658542414, -726.1166725062349, -493.13298566130703, -25.7642311246825, -613.1035635178467, -624.1222508173315, -226.0386579578252, -751.0754028477074, -529.9661961142459, -290.4016358645204, -1189.4680112933015, -819.0488403363801, -573.9761445479891, -783.0001222170723, -163.0179335899719, -1044.7590897644734, -598.0819809387972, -825.1448054859718, -1117.265229187384, -561.9331410912399, -401.38691272585964, -150.57154499830642, -110.21209158790664, -745.5264161811742, -916.9420851728624, -610.1674371553543, -714.2361465131415, -957.6503914760987, -1058.3680604448418, -213.20725990691145, -1029.575214131632, -26.51201703864006, -574.1614930869796, -656.6000927409178, -1222.9464174482573, -668.0993920283769, -634.6924429209568, -847.0139765536771, -944.2509615015066, -516.7190452425041, -802.0208690749422, -457.93866783609457, -1001.2112857820891, -106.43019328212019, -77.89919198077415, -229.79697957048836, -842.5436445425304, -478.52379696741906, -777.2752625870072], "episode_lengths": [89, 40, 150, 150, 150, 150, 54, 45, 150, 150, 107, 150, 150, 150, 113, 150, 150, 150, 80, 150, 150, 150, 60, 150, 150, 118, 116, 150, 150, 95, 129, 150, 150, 150, 150, 58, 44, 150, 150, 111, 70, 134, 150, 62, 81, 97, 150, 150, 150, 150, 150, 72, 150, 147, 34, 150, 150, 76, 150, 150, 124, 150, 150, 150, 150, 78, 150, 150, 150, 150, 119, 115, 71, 53, 150, 150, 146, 150, 150, 150, 68, 150, 44, 150, 150, 150, 150, 150, 150, 150, 150, 150, 121, 150, 66, 76, 97, 150, 124, 150], "policy_policy_0_reward": [-225.34622292836858, -8.946503481746099, -1266.7933603308527, -368.18281545871383, -1130.3769792232747, -1047.7452868619168, -76.18041001503909, -25.93909239817387, -1044.7184020359255, -1045.9439897159075, -398.38400363971874, -1218.1089144819623, -886.5696786836207, -981.1226512992788, -273.5166072448134, -525.4871885954091, -395.0598012423976, -890.0767425136175, -164.61130077429095, -993.2315593478581, -764.3093144084793, -709.4738829199568, -130.66235609633046, -863.3289892141834, -841.6839002532276, -307.195331121317, -276.03588868252234, -401.0828510163746, -345.99688216703663, -326.1151872164818, -631.4768142122501, -1088.5161061854392, -1152.9383289232237, -665.009916352802, -824.8854842069175, -32.15953556244376, -3.133235212988277, -1078.0778996596207, -822.5353371491507, -511.02967890058505, -151.24107370348966, -241.9966891834635, -888.5447619811333, -87.2030776029597, -164.3564440085218, -321.1875969640685, -912.6828461724682, -916.7383939448366, -866.595649520061, -1299.1613616637933, -904.1629882488709, -221.78307658542414, -726.1166725062349, -493.13298566130703, -25.7642311246825, -613.1035635178467, -624.1222508173315, -226.0386579578252, -751.0754028477074, -529.9661961142459, -290.4016358645204, -1189.4680112933015, -819.0488403363801, -573.9761445479891, -783.0001222170723, -163.0179335899719, -1044.7590897644734, -598.0819809387972, -825.1448054859718, -1117.265229187384, -561.9331410912399, -401.38691272585964, -150.57154499830642, -110.21209158790664, -745.5264161811742, -916.9420851728624, -610.1674371553543, -714.2361465131415, -957.6503914760987, -1058.3680604448418, -213.20725990691145, -1029.575214131632, -26.51201703864006, -574.1614930869796, -656.6000927409178, -1222.9464174482573, -668.0993920283769, -634.6924429209568, -847.0139765536771, -944.2509615015066, -516.7190452425041, -802.0208690749422, -457.93866783609457, -1001.2112857820891, -106.43019328212019, -77.89919198077415, -229.79697957048836, -842.5436445425304, -478.52379696741906, -777.2752625870072]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3008663016583494, "mean_inference_ms": 0.9343617012159245, "mean_action_processing_ms": 0.16688793468843816, "mean_env_wait_ms": 1.689569659784895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00549626350402832, "StateBufferConnector_ms": 0.004065036773681641, "ViewRequirementAgentConnector_ms": 0.10224437713623047}, "num_episodes": 31, "episode_return_max": -3.133235212988277, "episode_return_min": -1299.1613616637933, "episode_return_mean": -614.4553857465695, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.64843524383514, "num_env_steps_trained_throughput_per_sec": 301.64843524383514, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 13463.398, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13463.322, "sample_time_ms": 2743.526, "learn_time_ms": 10702.938, "learn_throughput": 373.729, "synch_weights_time_ms": 15.961}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "training_iteration": 42, "trial_id": "6d52d_00000", "date": "2024-07-26_22-53-30", "timestamp": 1722014610, "time_this_iter_s": 13.269156455993652, "time_total_s": 565.8717980384827, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c3112d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 565.8717980384827, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 10.610526315789475, "ram_util_percent": 28.515789473684208}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 237.06155516505243, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.6911446639647085, "policy_loss": -0.007020003189488004, "vf_loss": 3.704322829345862, "vf_explained_var": 0.9718222508206964, "kl": 0.01745808758808304, "entropy": 1.4014297273630898, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "env_runners": {"episode_reward_max": -3.133235212988277, "episode_reward_min": -1425.6199929892684, "episode_reward_mean": -663.8707166179832, "episode_len_mean": 129.33, "episode_media": {}, "episodes_timesteps_total": 12933, "policy_reward_min": {"policy_0": -1425.6199929892684}, "policy_reward_max": {"policy_0": -3.133235212988277}, "policy_reward_mean": {"policy_0": -663.8707166179832}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-631.4768142122501, -1088.5161061854392, -1152.9383289232237, -665.009916352802, -824.8854842069175, -32.15953556244376, -3.133235212988277, -1078.0778996596207, -822.5353371491507, -511.02967890058505, -151.24107370348966, -241.9966891834635, -888.5447619811333, -87.2030776029597, -164.3564440085218, -321.1875969640685, -912.6828461724682, -916.7383939448366, -866.595649520061, -1299.1613616637933, -904.1629882488709, -221.78307658542414, -726.1166725062349, -493.13298566130703, -25.7642311246825, -613.1035635178467, -624.1222508173315, -226.0386579578252, -751.0754028477074, -529.9661961142459, -290.4016358645204, -1189.4680112933015, -819.0488403363801, -573.9761445479891, -783.0001222170723, -163.0179335899719, -1044.7590897644734, -598.0819809387972, -825.1448054859718, -1117.265229187384, -561.9331410912399, -401.38691272585964, -150.57154499830642, -110.21209158790664, -745.5264161811742, -916.9420851728624, -610.1674371553543, -714.2361465131415, -957.6503914760987, -1058.3680604448418, -213.20725990691145, -1029.575214131632, -26.51201703864006, -574.1614930869796, -656.6000927409178, -1222.9464174482573, -668.0993920283769, -634.6924429209568, -847.0139765536771, -944.2509615015066, -516.7190452425041, -802.0208690749422, -457.93866783609457, -1001.2112857820891, -106.43019328212019, -77.89919198077415, -229.79697957048836, -842.5436445425304, -478.52379696741906, -777.2752625870072, -1006.7723956862189, -1129.7998782037785, -104.76954083441959, -860.6851513174712, -243.19743881920246, -1425.6199929892684, -813.9349388854073, -526.487134071635, -774.835353395986, -735.8953816082958, -746.3214108511038, -996.0482161802588, -39.47014751023346, -174.6827754229375, -597.3911400587699, -817.5870997473531, -1048.5579407355822, -1043.453759797469, -1155.8838444384153, -1156.8463459466147, -907.7724792274931, -1045.2288648745266, -394.1402979306814, -272.4627634636887, -613.7617219550856, -616.1768750956343, -1109.1118287879474, -1098.6850176138569, -849.7160933563373, -568.463351704481], "episode_lengths": [129, 150, 150, 150, 150, 58, 44, 150, 150, 111, 70, 134, 150, 62, 81, 97, 150, 150, 150, 150, 150, 72, 150, 147, 34, 150, 150, 76, 150, 150, 124, 150, 150, 150, 150, 78, 150, 150, 150, 150, 119, 115, 71, 53, 150, 150, 146, 150, 150, 150, 68, 150, 44, 150, 150, 150, 150, 150, 150, 150, 150, 150, 121, 150, 66, 76, 97, 150, 124, 150, 150, 150, 77, 150, 103, 150, 140, 126, 150, 150, 150, 150, 58, 96, 129, 150, 150, 150, 150, 150, 150, 150, 111, 89, 150, 150, 150, 150, 150, 137], "policy_policy_0_reward": [-631.4768142122501, -1088.5161061854392, -1152.9383289232237, -665.009916352802, -824.8854842069175, -32.15953556244376, -3.133235212988277, -1078.0778996596207, -822.5353371491507, -511.02967890058505, -151.24107370348966, -241.9966891834635, -888.5447619811333, -87.2030776029597, -164.3564440085218, -321.1875969640685, -912.6828461724682, -916.7383939448366, -866.595649520061, -1299.1613616637933, -904.1629882488709, -221.78307658542414, -726.1166725062349, -493.13298566130703, -25.7642311246825, -613.1035635178467, -624.1222508173315, -226.0386579578252, -751.0754028477074, -529.9661961142459, -290.4016358645204, -1189.4680112933015, -819.0488403363801, -573.9761445479891, -783.0001222170723, -163.0179335899719, -1044.7590897644734, -598.0819809387972, -825.1448054859718, -1117.265229187384, -561.9331410912399, -401.38691272585964, -150.57154499830642, -110.21209158790664, -745.5264161811742, -916.9420851728624, -610.1674371553543, -714.2361465131415, -957.6503914760987, -1058.3680604448418, -213.20725990691145, -1029.575214131632, -26.51201703864006, -574.1614930869796, -656.6000927409178, -1222.9464174482573, -668.0993920283769, -634.6924429209568, -847.0139765536771, -944.2509615015066, -516.7190452425041, -802.0208690749422, -457.93866783609457, -1001.2112857820891, -106.43019328212019, -77.89919198077415, -229.79697957048836, -842.5436445425304, -478.52379696741906, -777.2752625870072, -1006.7723956862189, -1129.7998782037785, -104.76954083441959, -860.6851513174712, -243.19743881920246, -1425.6199929892684, -813.9349388854073, -526.487134071635, -774.835353395986, -735.8953816082958, -746.3214108511038, -996.0482161802588, -39.47014751023346, -174.6827754229375, -597.3911400587699, -817.5870997473531, -1048.5579407355822, -1043.453759797469, -1155.8838444384153, -1156.8463459466147, -907.7724792274931, -1045.2288648745266, -394.1402979306814, -272.4627634636887, -613.7617219550856, -616.1768750956343, -1109.1118287879474, -1098.6850176138569, -849.7160933563373, -568.463351704481]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3007685706099847, "mean_inference_ms": 0.9336271462893841, "mean_action_processing_ms": 0.16681059529637732, "mean_env_wait_ms": 1.6905283191714904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00534820556640625, "StateBufferConnector_ms": 0.004038572311401367, "ViewRequirementAgentConnector_ms": 0.10114502906799316}, "num_episodes": 30, "episode_return_max": -3.133235212988277, "episode_return_min": -1425.6199929892684, "episode_return_mean": -663.8707166179832, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 287.10421707831745, "num_env_steps_trained_throughput_per_sec": 287.10421707831745, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 13587.443, "restore_workers_time_ms": 0.023, "training_step_time_ms": 13587.371, "sample_time_ms": 2748.871, "learn_time_ms": 10821.7, "learn_throughput": 369.628, "synch_weights_time_ms": 15.891}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "training_iteration": 43, "trial_id": "6d52d_00000", "date": "2024-07-26_22-53-44", "timestamp": 1722014624, "time_this_iter_s": 13.941629648208618, "time_total_s": 579.8134276866913, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c39fb50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 579.8134276866913, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 14.135000000000002, "ram_util_percent": 28.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 211.34998063246408, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.2526032269001006, "policy_loss": -0.013233060926237765, "vf_loss": 3.2705246324340504, "vf_explained_var": 0.9902857796599468, "kl": 0.01644512834259335, "entropy": 1.2088649947817127, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": -20.39228387193266, "episode_reward_min": -1425.6199929892684, "episode_reward_mean": -684.3744535709014, "episode_len_mean": 132.94, "episode_media": {}, "episodes_timesteps_total": 13294, "policy_reward_min": {"policy_0": -1425.6199929892684}, "policy_reward_max": {"policy_0": -20.39228387193266}, "policy_reward_mean": {"policy_0": -684.3744535709014}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-290.4016358645204, -1189.4680112933015, -819.0488403363801, -573.9761445479891, -783.0001222170723, -163.0179335899719, -1044.7590897644734, -598.0819809387972, -825.1448054859718, -1117.265229187384, -561.9331410912399, -401.38691272585964, -150.57154499830642, -110.21209158790664, -745.5264161811742, -916.9420851728624, -610.1674371553543, -714.2361465131415, -957.6503914760987, -1058.3680604448418, -213.20725990691145, -1029.575214131632, -26.51201703864006, -574.1614930869796, -656.6000927409178, -1222.9464174482573, -668.0993920283769, -634.6924429209568, -847.0139765536771, -944.2509615015066, -516.7190452425041, -802.0208690749422, -457.93866783609457, -1001.2112857820891, -106.43019328212019, -77.89919198077415, -229.79697957048836, -842.5436445425304, -478.52379696741906, -777.2752625870072, -1006.7723956862189, -1129.7998782037785, -104.76954083441959, -860.6851513174712, -243.19743881920246, -1425.6199929892684, -813.9349388854073, -526.487134071635, -774.835353395986, -735.8953816082958, -746.3214108511038, -996.0482161802588, -39.47014751023346, -174.6827754229375, -597.3911400587699, -817.5870997473531, -1048.5579407355822, -1043.453759797469, -1155.8838444384153, -1156.8463459466147, -907.7724792274931, -1045.2288648745266, -394.1402979306814, -272.4627634636887, -613.7617219550856, -616.1768750956343, -1109.1118287879474, -1098.6850176138569, -849.7160933563373, -568.463351704481, -760.9101980736856, -852.1999410098634, -20.39228387193266, -865.7564514390128, -692.6640997006562, -147.91361070798354, -270.608695272134, -987.1101532359579, -666.557333614999, -511.88409800317334, -740.7648691715344, -965.0054133454993, -826.5482057650204, -575.2924191543844, -861.8922687520387, -604.3049163535286, -169.50163381746245, -339.4230330531083, -840.4797827022659, -1002.223091929976, -906.8177820167364, -320.06413328593584, -121.86408768305353, -1101.243814214482, -150.22649570592105, -616.2662926976304, -459.119087996408, -1232.5916534460778, -1132.7832532007571, -1082.7008525622996], "episode_lengths": [124, 150, 150, 150, 150, 78, 150, 150, 150, 150, 119, 115, 71, 53, 150, 150, 146, 150, 150, 150, 68, 150, 44, 150, 150, 150, 150, 150, 150, 150, 150, 150, 121, 150, 66, 76, 97, 150, 124, 150, 150, 150, 77, 150, 103, 150, 140, 126, 150, 150, 150, 150, 58, 96, 129, 150, 150, 150, 150, 150, 150, 150, 111, 89, 150, 150, 150, 150, 150, 137, 150, 150, 50, 150, 150, 84, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150, 150, 117, 81, 150, 77, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-290.4016358645204, -1189.4680112933015, -819.0488403363801, -573.9761445479891, -783.0001222170723, -163.0179335899719, -1044.7590897644734, -598.0819809387972, -825.1448054859718, -1117.265229187384, -561.9331410912399, -401.38691272585964, -150.57154499830642, -110.21209158790664, -745.5264161811742, -916.9420851728624, -610.1674371553543, -714.2361465131415, -957.6503914760987, -1058.3680604448418, -213.20725990691145, -1029.575214131632, -26.51201703864006, -574.1614930869796, -656.6000927409178, -1222.9464174482573, -668.0993920283769, -634.6924429209568, -847.0139765536771, -944.2509615015066, -516.7190452425041, -802.0208690749422, -457.93866783609457, -1001.2112857820891, -106.43019328212019, -77.89919198077415, -229.79697957048836, -842.5436445425304, -478.52379696741906, -777.2752625870072, -1006.7723956862189, -1129.7998782037785, -104.76954083441959, -860.6851513174712, -243.19743881920246, -1425.6199929892684, -813.9349388854073, -526.487134071635, -774.835353395986, -735.8953816082958, -746.3214108511038, -996.0482161802588, -39.47014751023346, -174.6827754229375, -597.3911400587699, -817.5870997473531, -1048.5579407355822, -1043.453759797469, -1155.8838444384153, -1156.8463459466147, -907.7724792274931, -1045.2288648745266, -394.1402979306814, -272.4627634636887, -613.7617219550856, -616.1768750956343, -1109.1118287879474, -1098.6850176138569, -849.7160933563373, -568.463351704481, -760.9101980736856, -852.1999410098634, -20.39228387193266, -865.7564514390128, -692.6640997006562, -147.91361070798354, -270.608695272134, -987.1101532359579, -666.557333614999, -511.88409800317334, -740.7648691715344, -965.0054133454993, -826.5482057650204, -575.2924191543844, -861.8922687520387, -604.3049163535286, -169.50163381746245, -339.4230330531083, -840.4797827022659, -1002.223091929976, -906.8177820167364, -320.06413328593584, -121.86408768305353, -1101.243814214482, -150.22649570592105, -616.2662926976304, -459.119087996408, -1232.5916534460778, -1132.7832532007571, -1082.7008525622996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3005971066397795, "mean_inference_ms": 0.9331248185624267, "mean_action_processing_ms": 0.16672155788651352, "mean_env_wait_ms": 1.6918344438365376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005527973175048828, "StateBufferConnector_ms": 0.004034280776977539, "ViewRequirementAgentConnector_ms": 0.10108709335327148}, "num_episodes": 30, "episode_return_max": -20.39228387193266, "episode_return_min": -1425.6199929892684, "episode_return_mean": -684.3744535709014, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.5419927577739, "num_env_steps_trained_throughput_per_sec": 292.5419927577739, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 13564.362, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13564.286, "sample_time_ms": 2661.468, "learn_time_ms": 10886.003, "learn_throughput": 367.444, "synch_weights_time_ms": 15.883}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 44, "trial_id": "6d52d_00000", "date": "2024-07-26_22-53-58", "timestamp": 1722014638, "time_this_iter_s": 13.678617477416992, "time_total_s": 593.4920451641083, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c3dacb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 593.4920451641083, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 12.963157894736844, "ram_util_percent": 28.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 216.31666717727978, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.986547274887562, "policy_loss": -0.015501721120866325, "vf_loss": 4.006797626366218, "vf_explained_var": 0.9838674329842131, "kl": 0.01500949840741068, "entropy": 1.1502907893930872, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "env_runners": {"episode_reward_max": -20.39228387193266, "episode_reward_min": -1425.6199929892684, "episode_reward_mean": -674.1553636310332, "episode_len_mean": 132.34, "episode_media": {}, "episodes_timesteps_total": 13234, "policy_reward_min": {"policy_0": -1425.6199929892684}, "policy_reward_max": {"policy_0": -20.39228387193266}, "policy_reward_mean": {"policy_0": -674.1553636310332}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802.0208690749422, -457.93866783609457, -1001.2112857820891, -106.43019328212019, -77.89919198077415, -229.79697957048836, -842.5436445425304, -478.52379696741906, -777.2752625870072, -1006.7723956862189, -1129.7998782037785, -104.76954083441959, -860.6851513174712, -243.19743881920246, -1425.6199929892684, -813.9349388854073, -526.487134071635, -774.835353395986, -735.8953816082958, -746.3214108511038, -996.0482161802588, -39.47014751023346, -174.6827754229375, -597.3911400587699, -817.5870997473531, -1048.5579407355822, -1043.453759797469, -1155.8838444384153, -1156.8463459466147, -907.7724792274931, -1045.2288648745266, -394.1402979306814, -272.4627634636887, -613.7617219550856, -616.1768750956343, -1109.1118287879474, -1098.6850176138569, -849.7160933563373, -568.463351704481, -760.9101980736856, -852.1999410098634, -20.39228387193266, -865.7564514390128, -692.6640997006562, -147.91361070798354, -270.608695272134, -987.1101532359579, -666.557333614999, -511.88409800317334, -740.7648691715344, -965.0054133454993, -826.5482057650204, -575.2924191543844, -861.8922687520387, -604.3049163535286, -169.50163381746245, -339.4230330531083, -840.4797827022659, -1002.223091929976, -906.8177820167364, -320.06413328593584, -121.86408768305353, -1101.243814214482, -150.22649570592105, -616.2662926976304, -459.119087996408, -1232.5916534460778, -1132.7832532007571, -1082.7008525622996, -698.8813865845973, -747.1597011472593, -176.5363198127783, -728.0444170141731, -53.462674347735344, -486.2493242746241, -772.4412463846003, -1216.6363011387593, -456.45897244210397, -911.467840024607, -224.53245603447064, -122.77120925808941, -560.3004810294165, -800.4653439869081, -161.71512853729334, -81.80873323822472, -757.4686441162106, -326.60621792694485, -393.7657013867225, -942.421296464673, -673.071272586565, -715.2973808421723, -944.5935034664552, -1123.922845212144, -1094.0174310035297, -685.1701807079455, -800.3504563821743, -830.3198776348031, -394.68137058591924, -1025.5932160837813, -1036.8164095305056], "episode_lengths": [150, 121, 150, 66, 76, 97, 150, 124, 150, 150, 150, 77, 150, 103, 150, 140, 126, 150, 150, 150, 150, 58, 96, 129, 150, 150, 150, 150, 150, 150, 150, 111, 89, 150, 150, 150, 150, 150, 137, 150, 150, 50, 150, 150, 84, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150, 150, 117, 81, 150, 77, 150, 150, 150, 150, 150, 150, 150, 77, 150, 43, 117, 150, 150, 122, 150, 88, 81, 146, 150, 71, 54, 150, 114, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150], "policy_policy_0_reward": [-802.0208690749422, -457.93866783609457, -1001.2112857820891, -106.43019328212019, -77.89919198077415, -229.79697957048836, -842.5436445425304, -478.52379696741906, -777.2752625870072, -1006.7723956862189, -1129.7998782037785, -104.76954083441959, -860.6851513174712, -243.19743881920246, -1425.6199929892684, -813.9349388854073, -526.487134071635, -774.835353395986, -735.8953816082958, -746.3214108511038, -996.0482161802588, -39.47014751023346, -174.6827754229375, -597.3911400587699, -817.5870997473531, -1048.5579407355822, -1043.453759797469, -1155.8838444384153, -1156.8463459466147, -907.7724792274931, -1045.2288648745266, -394.1402979306814, -272.4627634636887, -613.7617219550856, -616.1768750956343, -1109.1118287879474, -1098.6850176138569, -849.7160933563373, -568.463351704481, -760.9101980736856, -852.1999410098634, -20.39228387193266, -865.7564514390128, -692.6640997006562, -147.91361070798354, -270.608695272134, -987.1101532359579, -666.557333614999, -511.88409800317334, -740.7648691715344, -965.0054133454993, -826.5482057650204, -575.2924191543844, -861.8922687520387, -604.3049163535286, -169.50163381746245, -339.4230330531083, -840.4797827022659, -1002.223091929976, -906.8177820167364, -320.06413328593584, -121.86408768305353, -1101.243814214482, -150.22649570592105, -616.2662926976304, -459.119087996408, -1232.5916534460778, -1132.7832532007571, -1082.7008525622996, -698.8813865845973, -747.1597011472593, -176.5363198127783, -728.0444170141731, -53.462674347735344, -486.2493242746241, -772.4412463846003, -1216.6363011387593, -456.45897244210397, -911.467840024607, -224.53245603447064, -122.77120925808941, -560.3004810294165, -800.4653439869081, -161.71512853729334, -81.80873323822472, -757.4686441162106, -326.60621792694485, -393.7657013867225, -942.421296464673, -673.071272586565, -715.2973808421723, -944.5935034664552, -1123.922845212144, -1094.0174310035297, -685.1701807079455, -800.3504563821743, -830.3198776348031, -394.68137058591924, -1025.5932160837813, -1036.8164095305056]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3005010116986205, "mean_inference_ms": 0.9325441926383342, "mean_action_processing_ms": 0.16669611466121978, "mean_env_wait_ms": 1.6908699512149155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005651235580444336, "StateBufferConnector_ms": 0.00407099723815918, "ViewRequirementAgentConnector_ms": 0.10225558280944824}, "num_episodes": 31, "episode_return_max": -20.39228387193266, "episode_return_min": -1425.6199929892684, "episode_return_mean": -674.1553636310332, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 322.5184140418369, "num_env_steps_trained_throughput_per_sec": 322.5184140418369, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 13450.953, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13450.877, "sample_time_ms": 2563.929, "learn_time_ms": 10870.225, "learn_throughput": 367.978, "synch_weights_time_ms": 15.774}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "training_iteration": 45, "trial_id": "6d52d_00000", "date": "2024-07-26_22-54-11", "timestamp": 1722014651, "time_this_iter_s": 12.408064126968384, "time_total_s": 605.9001092910767, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c3db5b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 605.9001092910767, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 14.188888888888888, "ram_util_percent": 28.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 220.248165367047, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.05097668406864, "policy_loss": -0.008699916106221887, "vf_loss": 4.064123391360044, "vf_explained_var": 0.9689461264759303, "kl": 0.015327316226770004, "entropy": 1.1344086989760398, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "env_runners": {"episode_reward_max": -20.39228387193266, "episode_reward_min": -1232.5916534460778, "episode_reward_mean": -662.8463160466071, "episode_len_mean": 133.8, "episode_media": {}, "episodes_timesteps_total": 13380, "policy_reward_min": {"policy_0": -1232.5916534460778}, "policy_reward_max": {"policy_0": -20.39228387193266}, "policy_reward_mean": {"policy_0": -662.8463160466071}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-907.7724792274931, -1045.2288648745266, -394.1402979306814, -272.4627634636887, -613.7617219550856, -616.1768750956343, -1109.1118287879474, -1098.6850176138569, -849.7160933563373, -568.463351704481, -760.9101980736856, -852.1999410098634, -20.39228387193266, -865.7564514390128, -692.6640997006562, -147.91361070798354, -270.608695272134, -987.1101532359579, -666.557333614999, -511.88409800317334, -740.7648691715344, -965.0054133454993, -826.5482057650204, -575.2924191543844, -861.8922687520387, -604.3049163535286, -169.50163381746245, -339.4230330531083, -840.4797827022659, -1002.223091929976, -906.8177820167364, -320.06413328593584, -121.86408768305353, -1101.243814214482, -150.22649570592105, -616.2662926976304, -459.119087996408, -1232.5916534460778, -1132.7832532007571, -1082.7008525622996, -698.8813865845973, -747.1597011472593, -176.5363198127783, -728.0444170141731, -53.462674347735344, -486.2493242746241, -772.4412463846003, -1216.6363011387593, -456.45897244210397, -911.467840024607, -224.53245603447064, -122.77120925808941, -560.3004810294165, -800.4653439869081, -161.71512853729334, -81.80873323822472, -757.4686441162106, -326.60621792694485, -393.7657013867225, -942.421296464673, -673.071272586565, -715.2973808421723, -944.5935034664552, -1123.922845212144, -1094.0174310035297, -685.1701807079455, -800.3504563821743, -830.3198776348031, -394.68137058591924, -1025.5932160837813, -1036.8164095305056, -422.3824400525248, -207.31887464769264, -1026.8648944469196, -860.7722089145402, -847.173163377674, -986.5401537333175, -1060.7453988225634, -595.0984828522478, -698.226207395559, -603.2206819189681, -1060.8839273072633, -536.6626804430477, -1123.5669691392388, -864.3019238193249, -492.5429437652864, -310.8786210695903, -1019.3108614084946, -470.0632236769844, -735.4946118324689, -107.42401415593064, -471.64583096558385, -850.1912201884097, -360.11143810281914, -840.9610976874854, -863.5484931885046, -138.93260071225197, -586.477202060424, -737.2793939377268, -162.3554600584366], "episode_lengths": [150, 150, 111, 89, 150, 150, 150, 150, 150, 137, 150, 150, 50, 150, 150, 84, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150, 150, 117, 81, 150, 77, 150, 150, 150, 150, 150, 150, 150, 77, 150, 43, 117, 150, 150, 122, 150, 88, 81, 146, 150, 71, 54, 150, 114, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150, 104, 98, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 91, 150, 150, 150, 60, 150, 150, 110, 150, 150, 98, 150, 142, 82], "policy_policy_0_reward": [-907.7724792274931, -1045.2288648745266, -394.1402979306814, -272.4627634636887, -613.7617219550856, -616.1768750956343, -1109.1118287879474, -1098.6850176138569, -849.7160933563373, -568.463351704481, -760.9101980736856, -852.1999410098634, -20.39228387193266, -865.7564514390128, -692.6640997006562, -147.91361070798354, -270.608695272134, -987.1101532359579, -666.557333614999, -511.88409800317334, -740.7648691715344, -965.0054133454993, -826.5482057650204, -575.2924191543844, -861.8922687520387, -604.3049163535286, -169.50163381746245, -339.4230330531083, -840.4797827022659, -1002.223091929976, -906.8177820167364, -320.06413328593584, -121.86408768305353, -1101.243814214482, -150.22649570592105, -616.2662926976304, -459.119087996408, -1232.5916534460778, -1132.7832532007571, -1082.7008525622996, -698.8813865845973, -747.1597011472593, -176.5363198127783, -728.0444170141731, -53.462674347735344, -486.2493242746241, -772.4412463846003, -1216.6363011387593, -456.45897244210397, -911.467840024607, -224.53245603447064, -122.77120925808941, -560.3004810294165, -800.4653439869081, -161.71512853729334, -81.80873323822472, -757.4686441162106, -326.60621792694485, -393.7657013867225, -942.421296464673, -673.071272586565, -715.2973808421723, -944.5935034664552, -1123.922845212144, -1094.0174310035297, -685.1701807079455, -800.3504563821743, -830.3198776348031, -394.68137058591924, -1025.5932160837813, -1036.8164095305056, -422.3824400525248, -207.31887464769264, -1026.8648944469196, -860.7722089145402, -847.173163377674, -986.5401537333175, -1060.7453988225634, -595.0984828522478, -698.226207395559, -603.2206819189681, -1060.8839273072633, -536.6626804430477, -1123.5669691392388, -864.3019238193249, -492.5429437652864, -310.8786210695903, -1019.3108614084946, -470.0632236769844, -735.4946118324689, -107.42401415593064, -471.64583096558385, -850.1912201884097, -360.11143810281914, -840.9610976874854, -863.5484931885046, -138.93260071225197, -586.477202060424, -737.2793939377268, -162.3554600584366]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30047013640794923, "mean_inference_ms": 0.9322835028867377, "mean_action_processing_ms": 0.16665140890581503, "mean_env_wait_ms": 1.6925646123414817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005667686462402344, "StateBufferConnector_ms": 0.004038572311401367, "ViewRequirementAgentConnector_ms": 0.10234737396240234}, "num_episodes": 29, "episode_return_max": -20.39228387193266, "episode_return_min": -1232.5916534460778, "episode_return_mean": -662.8463160466071, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 353.4509361557471, "num_env_steps_trained_throughput_per_sec": 353.4509361557471, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 13126.268, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13126.193, "sample_time_ms": 2563.177, "learn_time_ms": 10546.021, "learn_throughput": 379.29, "synch_weights_time_ms": 16.02}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "training_iteration": 46, "trial_id": "6d52d_00000", "date": "2024-07-26_22-54-22", "timestamp": 1722014662, "time_this_iter_s": 11.323347091674805, "time_total_s": 617.2234563827515, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c39f760>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 617.2234563827515, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 13.325, "ram_util_percent": 28.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 267.7873495101929, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.540615496287743, "policy_loss": -0.016095951639969523, "vf_loss": 3.5630262597153584, "vf_explained_var": 0.9901382615789771, "kl": 0.016513971102115995, "entropy": 1.3746098718295494, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "env_runners": {"episode_reward_max": -17.46493981433742, "episode_reward_min": -1324.6431479594648, "episode_reward_mean": -673.5211503342919, "episode_len_mean": 132.82, "episode_media": {}, "episodes_timesteps_total": 13282, "policy_reward_min": {"policy_0": -1324.6431479594648}, "policy_reward_max": {"policy_0": -17.46493981433742}, "policy_reward_mean": {"policy_0": -673.5211503342919}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-320.06413328593584, -121.86408768305353, -1101.243814214482, -150.22649570592105, -616.2662926976304, -459.119087996408, -1232.5916534460778, -1132.7832532007571, -1082.7008525622996, -698.8813865845973, -747.1597011472593, -176.5363198127783, -728.0444170141731, -53.462674347735344, -486.2493242746241, -772.4412463846003, -1216.6363011387593, -456.45897244210397, -911.467840024607, -224.53245603447064, -122.77120925808941, -560.3004810294165, -800.4653439869081, -161.71512853729334, -81.80873323822472, -757.4686441162106, -326.60621792694485, -393.7657013867225, -942.421296464673, -673.071272586565, -715.2973808421723, -944.5935034664552, -1123.922845212144, -1094.0174310035297, -685.1701807079455, -800.3504563821743, -830.3198776348031, -394.68137058591924, -1025.5932160837813, -1036.8164095305056, -422.3824400525248, -207.31887464769264, -1026.8648944469196, -860.7722089145402, -847.173163377674, -986.5401537333175, -1060.7453988225634, -595.0984828522478, -698.226207395559, -603.2206819189681, -1060.8839273072633, -536.6626804430477, -1123.5669691392388, -864.3019238193249, -492.5429437652864, -310.8786210695903, -1019.3108614084946, -470.0632236769844, -735.4946118324689, -107.42401415593064, -471.64583096558385, -850.1912201884097, -360.11143810281914, -840.9610976874854, -863.5484931885046, -138.93260071225197, -586.477202060424, -737.2793939377268, -162.3554600584366, -1105.5691454062583, -1324.6431479594648, -206.5434743988557, -699.8054925202293, -728.8591710688033, -667.9100521130438, -377.52615011074687, -1060.4778681019816, -1322.9679563081625, -683.2861477269421, -210.7253014518648, -878.757167423167, -519.5530942616194, -693.1690045322141, -70.10352350315128, -17.46493981433742, -909.7892517820211, -369.52998972668763, -1066.0630099027492, -569.3009273754866, -1102.8672862524145, -1097.6551084782702, -920.4710269064017, -607.6433768276584, -119.25753201786875, -1253.7894801668556, -495.7601171520087, -1223.2404003888587, -945.9318871885578, -151.18929269426005, -751.4026802082176], "episode_lengths": [117, 81, 150, 77, 150, 150, 150, 150, 150, 150, 150, 77, 150, 43, 117, 150, 150, 122, 150, 88, 81, 146, 150, 71, 54, 150, 114, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150, 104, 98, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 91, 150, 150, 150, 60, 150, 150, 110, 150, 150, 98, 150, 142, 82, 150, 150, 71, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 69, 42, 150, 107, 150, 150, 150, 150, 150, 150, 77, 150, 150, 150, 150, 79, 150], "policy_policy_0_reward": [-320.06413328593584, -121.86408768305353, -1101.243814214482, -150.22649570592105, -616.2662926976304, -459.119087996408, -1232.5916534460778, -1132.7832532007571, -1082.7008525622996, -698.8813865845973, -747.1597011472593, -176.5363198127783, -728.0444170141731, -53.462674347735344, -486.2493242746241, -772.4412463846003, -1216.6363011387593, -456.45897244210397, -911.467840024607, -224.53245603447064, -122.77120925808941, -560.3004810294165, -800.4653439869081, -161.71512853729334, -81.80873323822472, -757.4686441162106, -326.60621792694485, -393.7657013867225, -942.421296464673, -673.071272586565, -715.2973808421723, -944.5935034664552, -1123.922845212144, -1094.0174310035297, -685.1701807079455, -800.3504563821743, -830.3198776348031, -394.68137058591924, -1025.5932160837813, -1036.8164095305056, -422.3824400525248, -207.31887464769264, -1026.8648944469196, -860.7722089145402, -847.173163377674, -986.5401537333175, -1060.7453988225634, -595.0984828522478, -698.226207395559, -603.2206819189681, -1060.8839273072633, -536.6626804430477, -1123.5669691392388, -864.3019238193249, -492.5429437652864, -310.8786210695903, -1019.3108614084946, -470.0632236769844, -735.4946118324689, -107.42401415593064, -471.64583096558385, -850.1912201884097, -360.11143810281914, -840.9610976874854, -863.5484931885046, -138.93260071225197, -586.477202060424, -737.2793939377268, -162.3554600584366, -1105.5691454062583, -1324.6431479594648, -206.5434743988557, -699.8054925202293, -728.8591710688033, -667.9100521130438, -377.52615011074687, -1060.4778681019816, -1322.9679563081625, -683.2861477269421, -210.7253014518648, -878.757167423167, -519.5530942616194, -693.1690045322141, -70.10352350315128, -17.46493981433742, -909.7892517820211, -369.52998972668763, -1066.0630099027492, -569.3009273754866, -1102.8672862524145, -1097.6551084782702, -920.4710269064017, -607.6433768276584, -119.25753201786875, -1253.7894801668556, -495.7601171520087, -1223.2404003888587, -945.9318871885578, -151.18929269426005, -751.4026802082176]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30038636509900374, "mean_inference_ms": 0.9319185052173071, "mean_action_processing_ms": 0.16668655788093914, "mean_env_wait_ms": 1.6916082728370003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005766391754150391, "StateBufferConnector_ms": 0.004052400588989258, "ViewRequirementAgentConnector_ms": 0.10309600830078125}, "num_episodes": 31, "episode_return_max": -17.46493981433742, "episode_return_min": -1324.6431479594648, "episode_return_mean": -673.5211503342919, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 286.84665091996794, "num_env_steps_trained_throughput_per_sec": 286.84665091996794, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 13103.607, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13103.534, "sample_time_ms": 2561.41, "learn_time_ms": 10525.436, "learn_throughput": 380.032, "synch_weights_time_ms": 15.698}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "training_iteration": 47, "trial_id": "6d52d_00000", "date": "2024-07-26_22-54-36", "timestamp": 1722014676, "time_this_iter_s": 13.951618194580078, "time_total_s": 631.1750745773315, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c39e440>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 631.1750745773315, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 12.8, "ram_util_percent": 28.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 231.82978433569272, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.8160571036239466, "policy_loss": -0.008137415754026734, "vf_loss": 3.832542891552051, "vf_explained_var": 0.9837683156132698, "kl": 0.01617926495315871, "entropy": 1.5629045614351829, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": -17.46493981433742, "episode_reward_min": -1336.9217218272452, "episode_reward_mean": -729.1472094801632, "episode_len_mean": 138.14, "episode_media": {}, "episodes_timesteps_total": 13814, "policy_reward_min": {"policy_0": -1336.9217218272452}, "policy_reward_max": {"policy_0": -17.46493981433742}, "policy_reward_mean": {"policy_0": -729.1472094801632}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-942.421296464673, -673.071272586565, -715.2973808421723, -944.5935034664552, -1123.922845212144, -1094.0174310035297, -685.1701807079455, -800.3504563821743, -830.3198776348031, -394.68137058591924, -1025.5932160837813, -1036.8164095305056, -422.3824400525248, -207.31887464769264, -1026.8648944469196, -860.7722089145402, -847.173163377674, -986.5401537333175, -1060.7453988225634, -595.0984828522478, -698.226207395559, -603.2206819189681, -1060.8839273072633, -536.6626804430477, -1123.5669691392388, -864.3019238193249, -492.5429437652864, -310.8786210695903, -1019.3108614084946, -470.0632236769844, -735.4946118324689, -107.42401415593064, -471.64583096558385, -850.1912201884097, -360.11143810281914, -840.9610976874854, -863.5484931885046, -138.93260071225197, -586.477202060424, -737.2793939377268, -162.3554600584366, -1105.5691454062583, -1324.6431479594648, -206.5434743988557, -699.8054925202293, -728.8591710688033, -667.9100521130438, -377.52615011074687, -1060.4778681019816, -1322.9679563081625, -683.2861477269421, -210.7253014518648, -878.757167423167, -519.5530942616194, -693.1690045322141, -70.10352350315128, -17.46493981433742, -909.7892517820211, -369.52998972668763, -1066.0630099027492, -569.3009273754866, -1102.8672862524145, -1097.6551084782702, -920.4710269064017, -607.6433768276584, -119.25753201786875, -1253.7894801668556, -495.7601171520087, -1223.2404003888587, -945.9318871885578, -151.18929269426005, -751.4026802082176, -751.5323892155415, -638.9148943600693, -676.8800227832643, -410.7884595802874, -1082.3549858726692, -852.4444063845373, -885.9917499993356, -804.3168585112151, -46.47216883464124, -99.02635728436536, -937.716574537669, -536.9577910306697, -716.8078255097986, -890.9431096104236, -1117.8658491298, -949.4086816784961, -110.3930909751869, -1336.9217218272452, -820.7117226062827, -936.8771724714461, -828.9061247942212, -878.075818482817, -834.9129157640622, -628.2782641453617, -1175.6779655057912, -792.5037896984903, -866.6176241593607, -847.9393493121639], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150, 104, 98, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 91, 150, 150, 150, 60, 150, 150, 110, 150, 150, 98, 150, 142, 82, 150, 150, 71, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 69, 42, 150, 107, 150, 150, 150, 150, 150, 150, 77, 150, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 57, 86, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 132, 150, 150, 150, 150], "policy_policy_0_reward": [-942.421296464673, -673.071272586565, -715.2973808421723, -944.5935034664552, -1123.922845212144, -1094.0174310035297, -685.1701807079455, -800.3504563821743, -830.3198776348031, -394.68137058591924, -1025.5932160837813, -1036.8164095305056, -422.3824400525248, -207.31887464769264, -1026.8648944469196, -860.7722089145402, -847.173163377674, -986.5401537333175, -1060.7453988225634, -595.0984828522478, -698.226207395559, -603.2206819189681, -1060.8839273072633, -536.6626804430477, -1123.5669691392388, -864.3019238193249, -492.5429437652864, -310.8786210695903, -1019.3108614084946, -470.0632236769844, -735.4946118324689, -107.42401415593064, -471.64583096558385, -850.1912201884097, -360.11143810281914, -840.9610976874854, -863.5484931885046, -138.93260071225197, -586.477202060424, -737.2793939377268, -162.3554600584366, -1105.5691454062583, -1324.6431479594648, -206.5434743988557, -699.8054925202293, -728.8591710688033, -667.9100521130438, -377.52615011074687, -1060.4778681019816, -1322.9679563081625, -683.2861477269421, -210.7253014518648, -878.757167423167, -519.5530942616194, -693.1690045322141, -70.10352350315128, -17.46493981433742, -909.7892517820211, -369.52998972668763, -1066.0630099027492, -569.3009273754866, -1102.8672862524145, -1097.6551084782702, -920.4710269064017, -607.6433768276584, -119.25753201786875, -1253.7894801668556, -495.7601171520087, -1223.2404003888587, -945.9318871885578, -151.18929269426005, -751.4026802082176, -751.5323892155415, -638.9148943600693, -676.8800227832643, -410.7884595802874, -1082.3549858726692, -852.4444063845373, -885.9917499993356, -804.3168585112151, -46.47216883464124, -99.02635728436536, -937.716574537669, -536.9577910306697, -716.8078255097986, -890.9431096104236, -1117.8658491298, -949.4086816784961, -110.3930909751869, -1336.9217218272452, -820.7117226062827, -936.8771724714461, -828.9061247942212, -878.075818482817, -834.9129157640622, -628.2782641453617, -1175.6779655057912, -792.5037896984903, -866.6176241593607, -847.9393493121639]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30038052892839767, "mean_inference_ms": 0.9318071100312804, "mean_action_processing_ms": 0.16675549522356095, "mean_env_wait_ms": 1.6935661677052605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005769968032836914, "StateBufferConnector_ms": 0.004070281982421875, "ViewRequirementAgentConnector_ms": 0.10340499877929688}, "num_episodes": 28, "episode_return_max": -17.46493981433742, "episode_return_min": -1336.9217218272452, "episode_return_mean": -729.1472094801632, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.54104099564955, "num_env_steps_trained_throughput_per_sec": 290.54104099564955, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 13110.7, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13110.629, "sample_time_ms": 2565.143, "learn_time_ms": 10528.875, "learn_throughput": 379.908, "synch_weights_time_ms": 15.587}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 48, "trial_id": "6d52d_00000", "date": "2024-07-26_22-54-50", "timestamp": 1722014690, "time_this_iter_s": 13.774233341217041, "time_total_s": 644.9493079185486, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c3da950>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 644.9493079185486, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 12.221052631578948, "ram_util_percent": 28.62105263157895}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 186.55136356949805, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.3533373082677524, "policy_loss": -0.007724922647078832, "vf_loss": 4.363303437083959, "vf_explained_var": 0.9642116264129679, "kl": 0.020087468053679964, "entropy": 1.1280578751116992, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "env_runners": {"episode_reward_max": -17.46493981433742, "episode_reward_min": -1336.9217218272452, "episode_reward_mean": -667.0367797472828, "episode_len_mean": 133.29, "episode_media": {}, "episodes_timesteps_total": 13329, "policy_reward_min": {"policy_0": -1336.9217218272452}, "policy_reward_max": {"policy_0": -17.46493981433742}, "policy_reward_mean": {"policy_0": -667.0367797472828}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-471.64583096558385, -850.1912201884097, -360.11143810281914, -840.9610976874854, -863.5484931885046, -138.93260071225197, -586.477202060424, -737.2793939377268, -162.3554600584366, -1105.5691454062583, -1324.6431479594648, -206.5434743988557, -699.8054925202293, -728.8591710688033, -667.9100521130438, -377.52615011074687, -1060.4778681019816, -1322.9679563081625, -683.2861477269421, -210.7253014518648, -878.757167423167, -519.5530942616194, -693.1690045322141, -70.10352350315128, -17.46493981433742, -909.7892517820211, -369.52998972668763, -1066.0630099027492, -569.3009273754866, -1102.8672862524145, -1097.6551084782702, -920.4710269064017, -607.6433768276584, -119.25753201786875, -1253.7894801668556, -495.7601171520087, -1223.2404003888587, -945.9318871885578, -151.18929269426005, -751.4026802082176, -751.5323892155415, -638.9148943600693, -676.8800227832643, -410.7884595802874, -1082.3549858726692, -852.4444063845373, -885.9917499993356, -804.3168585112151, -46.47216883464124, -99.02635728436536, -937.716574537669, -536.9577910306697, -716.8078255097986, -890.9431096104236, -1117.8658491298, -949.4086816784961, -110.3930909751869, -1336.9217218272452, -820.7117226062827, -936.8771724714461, -828.9061247942212, -878.075818482817, -834.9129157640622, -628.2782641453617, -1175.6779655057912, -792.5037896984903, -866.6176241593607, -847.9393493121639, -578.5282447430499, -490.62651013642704, -893.0669088466308, -282.50169412968364, -282.21654986686326, -883.0960911011235, -368.94035379566503, -835.8683681883393, -242.9997681453561, -977.7442876514721, -510.59890646589724, -164.0202645410956, -56.890436031523215, -188.43702610222476, -887.8588854164357, -1041.859237181187, -812.0714898604183, -615.3252867667766, -1061.227270590874, -213.9452044287495, -102.65450512848695, -704.5585671296476, -683.7074747040843, -67.72264371975507, -710.1806666735788, -784.8719821390968, -603.2091836174908, -755.1190114723781, -989.7161342245488, -768.8840804541725, -451.7943684869786, -74.44314825225368], "episode_lengths": [150, 150, 110, 150, 150, 98, 150, 142, 82, 150, 150, 71, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 69, 42, 150, 107, 150, 150, 150, 150, 150, 150, 77, 150, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 57, 86, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 132, 150, 150, 150, 150, 150, 106, 150, 86, 150, 150, 92, 150, 120, 150, 115, 88, 67, 98, 150, 150, 150, 150, 150, 105, 71, 150, 150, 75, 135, 150, 150, 150, 150, 150, 106, 73], "policy_policy_0_reward": [-471.64583096558385, -850.1912201884097, -360.11143810281914, -840.9610976874854, -863.5484931885046, -138.93260071225197, -586.477202060424, -737.2793939377268, -162.3554600584366, -1105.5691454062583, -1324.6431479594648, -206.5434743988557, -699.8054925202293, -728.8591710688033, -667.9100521130438, -377.52615011074687, -1060.4778681019816, -1322.9679563081625, -683.2861477269421, -210.7253014518648, -878.757167423167, -519.5530942616194, -693.1690045322141, -70.10352350315128, -17.46493981433742, -909.7892517820211, -369.52998972668763, -1066.0630099027492, -569.3009273754866, -1102.8672862524145, -1097.6551084782702, -920.4710269064017, -607.6433768276584, -119.25753201786875, -1253.7894801668556, -495.7601171520087, -1223.2404003888587, -945.9318871885578, -151.18929269426005, -751.4026802082176, -751.5323892155415, -638.9148943600693, -676.8800227832643, -410.7884595802874, -1082.3549858726692, -852.4444063845373, -885.9917499993356, -804.3168585112151, -46.47216883464124, -99.02635728436536, -937.716574537669, -536.9577910306697, -716.8078255097986, -890.9431096104236, -1117.8658491298, -949.4086816784961, -110.3930909751869, -1336.9217218272452, -820.7117226062827, -936.8771724714461, -828.9061247942212, -878.075818482817, -834.9129157640622, -628.2782641453617, -1175.6779655057912, -792.5037896984903, -866.6176241593607, -847.9393493121639, -578.5282447430499, -490.62651013642704, -893.0669088466308, -282.50169412968364, -282.21654986686326, -883.0960911011235, -368.94035379566503, -835.8683681883393, -242.9997681453561, -977.7442876514721, -510.59890646589724, -164.0202645410956, -56.890436031523215, -188.43702610222476, -887.8588854164357, -1041.859237181187, -812.0714898604183, -615.3252867667766, -1061.227270590874, -213.9452044287495, -102.65450512848695, -704.5585671296476, -683.7074747040843, -67.72264371975507, -710.1806666735788, -784.8719821390968, -603.2091836174908, -755.1190114723781, -989.7161342245488, -768.8840804541725, -451.7943684869786, -74.44314825225368]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30007804186657744, "mean_inference_ms": 0.9314487023553966, "mean_action_processing_ms": 0.16663172785525623, "mean_env_wait_ms": 1.6911534272704807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00573277473449707, "StateBufferConnector_ms": 0.0041179656982421875, "ViewRequirementAgentConnector_ms": 0.10396409034729004}, "num_episodes": 32, "episode_return_max": -17.46493981433742, "episode_return_min": -1336.9217218272452, "episode_return_mean": -667.0367797472828, "episodes_this_iter": 32}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.3594428401407, "num_env_steps_trained_throughput_per_sec": 301.3594428401407, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 13122.687, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13122.613, "sample_time_ms": 2548.698, "learn_time_ms": 10557.322, "learn_throughput": 378.884, "synch_weights_time_ms": 15.546}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "training_iteration": 49, "trial_id": "6d52d_00000", "date": "2024-07-26_22-55-03", "timestamp": 1722014703, "time_this_iter_s": 13.281204223632812, "time_total_s": 658.2305121421814, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c3dab90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 658.2305121421814, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 10.842105263157896, "ram_util_percent": 28.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 239.1631603360176, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.5405437807242075, "policy_loss": -0.014880592282376407, "vf_loss": 3.5630025207996368, "vf_explained_var": 0.9839443003758788, "kl": 0.012613565086576328, "entropy": 1.6092298513899246, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": -21.71018461169386, "episode_reward_min": -1336.9217218272452, "episode_reward_mean": -695.8868255208082, "episode_len_mean": 135.14, "episode_media": {}, "episodes_timesteps_total": 13514, "policy_reward_min": {"policy_0": -1336.9217218272452}, "policy_reward_max": {"policy_0": -21.71018461169386}, "policy_reward_mean": {"policy_0": -695.8868255208082}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1102.8672862524145, -1097.6551084782702, -920.4710269064017, -607.6433768276584, -119.25753201786875, -1253.7894801668556, -495.7601171520087, -1223.2404003888587, -945.9318871885578, -151.18929269426005, -751.4026802082176, -751.5323892155415, -638.9148943600693, -676.8800227832643, -410.7884595802874, -1082.3549858726692, -852.4444063845373, -885.9917499993356, -804.3168585112151, -46.47216883464124, -99.02635728436536, -937.716574537669, -536.9577910306697, -716.8078255097986, -890.9431096104236, -1117.8658491298, -949.4086816784961, -110.3930909751869, -1336.9217218272452, -820.7117226062827, -936.8771724714461, -828.9061247942212, -878.075818482817, -834.9129157640622, -628.2782641453617, -1175.6779655057912, -792.5037896984903, -866.6176241593607, -847.9393493121639, -578.5282447430499, -490.62651013642704, -893.0669088466308, -282.50169412968364, -282.21654986686326, -883.0960911011235, -368.94035379566503, -835.8683681883393, -242.9997681453561, -977.7442876514721, -510.59890646589724, -164.0202645410956, -56.890436031523215, -188.43702610222476, -887.8588854164357, -1041.859237181187, -812.0714898604183, -615.3252867667766, -1061.227270590874, -213.9452044287495, -102.65450512848695, -704.5585671296476, -683.7074747040843, -67.72264371975507, -710.1806666735788, -784.8719821390968, -603.2091836174908, -755.1190114723781, -989.7161342245488, -768.8840804541725, -451.7943684869786, -74.44314825225368, -588.82742301907, -894.2182141511195, -507.9544957963476, -1080.7548124153586, -390.8088553534678, -758.2398482759164, -23.853967769826536, -1103.6739815423146, -1083.273306295569, -326.3594838861252, -1136.8368848912041, -885.713644667381, -859.6440378367632, -930.0071423863259, -645.4077995608285, -851.1103102323808, -268.0857494877361, -809.6720294771601, -331.1747230236627, -1012.7003063298038, -844.9354567597435, -1046.4289963151673, -21.71018461169386, -734.7670861154829, -959.5306619109698, -497.5003976631096, -1144.5301384429736, -934.8317045763188, -706.0004869481343], "episode_lengths": [150, 150, 150, 150, 77, 150, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 57, 86, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 132, 150, 150, 150, 150, 150, 106, 150, 86, 150, 150, 92, 150, 120, 150, 115, 88, 67, 98, 150, 150, 150, 150, 150, 105, 71, 150, 150, 75, 135, 150, 150, 150, 150, 150, 106, 73, 135, 150, 150, 150, 150, 150, 47, 150, 150, 150, 150, 150, 150, 150, 146, 150, 94, 150, 104, 150, 150, 150, 51, 150, 150, 124, 150, 150, 150], "policy_policy_0_reward": [-1102.8672862524145, -1097.6551084782702, -920.4710269064017, -607.6433768276584, -119.25753201786875, -1253.7894801668556, -495.7601171520087, -1223.2404003888587, -945.9318871885578, -151.18929269426005, -751.4026802082176, -751.5323892155415, -638.9148943600693, -676.8800227832643, -410.7884595802874, -1082.3549858726692, -852.4444063845373, -885.9917499993356, -804.3168585112151, -46.47216883464124, -99.02635728436536, -937.716574537669, -536.9577910306697, -716.8078255097986, -890.9431096104236, -1117.8658491298, -949.4086816784961, -110.3930909751869, -1336.9217218272452, -820.7117226062827, -936.8771724714461, -828.9061247942212, -878.075818482817, -834.9129157640622, -628.2782641453617, -1175.6779655057912, -792.5037896984903, -866.6176241593607, -847.9393493121639, -578.5282447430499, -490.62651013642704, -893.0669088466308, -282.50169412968364, -282.21654986686326, -883.0960911011235, -368.94035379566503, -835.8683681883393, -242.9997681453561, -977.7442876514721, -510.59890646589724, -164.0202645410956, -56.890436031523215, -188.43702610222476, -887.8588854164357, -1041.859237181187, -812.0714898604183, -615.3252867667766, -1061.227270590874, -213.9452044287495, -102.65450512848695, -704.5585671296476, -683.7074747040843, -67.72264371975507, -710.1806666735788, -784.8719821390968, -603.2091836174908, -755.1190114723781, -989.7161342245488, -768.8840804541725, -451.7943684869786, -74.44314825225368, -588.82742301907, -894.2182141511195, -507.9544957963476, -1080.7548124153586, -390.8088553534678, -758.2398482759164, -23.853967769826536, -1103.6739815423146, -1083.273306295569, -326.3594838861252, -1136.8368848912041, -885.713644667381, -859.6440378367632, -930.0071423863259, -645.4077995608285, -851.1103102323808, -268.0857494877361, -809.6720294771601, -331.1747230236627, -1012.7003063298038, -844.9354567597435, -1046.4289963151673, -21.71018461169386, -734.7670861154829, -959.5306619109698, -497.5003976631096, -1144.5301384429736, -934.8317045763188, -706.0004869481343]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3001310474273881, "mean_inference_ms": 0.93143802453045, "mean_action_processing_ms": 0.1666952040556852, "mean_env_wait_ms": 1.6938899686838291, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005779266357421875, "StateBufferConnector_ms": 0.0041615962982177734, "ViewRequirementAgentConnector_ms": 0.10464048385620117}, "num_episodes": 29, "episode_return_max": -21.71018461169386, "episode_return_min": -1336.9217218272452, "episode_return_mean": -695.8868255208082, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.67383284268766, "num_env_steps_trained_throughput_per_sec": 315.67383284268766, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 13141.492, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13141.421, "sample_time_ms": 2553.267, "learn_time_ms": 10570.698, "learn_throughput": 378.405, "synch_weights_time_ms": 16.321}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "training_iteration": 50, "trial_id": "6d52d_00000", "date": "2024-07-26_22-55-16", "timestamp": 1722014716, "time_this_iter_s": 12.67785096168518, "time_total_s": 670.9083631038666, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c39e440>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 670.9083631038666, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 12.472222222222223, "ram_util_percent": 28.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 223.25797670086226, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.3110373194019, "policy_loss": -0.013604473086403838, "vf_loss": 3.3274909102668366, "vf_explained_var": 0.993928950962921, "kl": 0.0154476042886624, "entropy": 1.3276261165738106, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 48480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "env_runners": {"episode_reward_max": -21.71018461169386, "episode_reward_min": -1368.5982422747195, "episode_reward_mean": -677.572034739022, "episode_len_mean": 132.11, "episode_media": {}, "episodes_timesteps_total": 13211, "policy_reward_min": {"policy_0": -1368.5982422747195}, "policy_reward_max": {"policy_0": -21.71018461169386}, "policy_reward_mean": {"policy_0": -677.572034739022}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-936.8771724714461, -828.9061247942212, -878.075818482817, -834.9129157640622, -628.2782641453617, -1175.6779655057912, -792.5037896984903, -866.6176241593607, -847.9393493121639, -578.5282447430499, -490.62651013642704, -893.0669088466308, -282.50169412968364, -282.21654986686326, -883.0960911011235, -368.94035379566503, -835.8683681883393, -242.9997681453561, -977.7442876514721, -510.59890646589724, -164.0202645410956, -56.890436031523215, -188.43702610222476, -887.8588854164357, -1041.859237181187, -812.0714898604183, -615.3252867667766, -1061.227270590874, -213.9452044287495, -102.65450512848695, -704.5585671296476, -683.7074747040843, -67.72264371975507, -710.1806666735788, -784.8719821390968, -603.2091836174908, -755.1190114723781, -989.7161342245488, -768.8840804541725, -451.7943684869786, -74.44314825225368, -588.82742301907, -894.2182141511195, -507.9544957963476, -1080.7548124153586, -390.8088553534678, -758.2398482759164, -23.853967769826536, -1103.6739815423146, -1083.273306295569, -326.3594838861252, -1136.8368848912041, -885.713644667381, -859.6440378367632, -930.0071423863259, -645.4077995608285, -851.1103102323808, -268.0857494877361, -809.6720294771601, -331.1747230236627, -1012.7003063298038, -844.9354567597435, -1046.4289963151673, -21.71018461169386, -734.7670861154829, -959.5306619109698, -497.5003976631096, -1144.5301384429736, -934.8317045763188, -706.0004869481343, -129.71110914995498, -112.58782613857834, -115.44244122004305, -81.88484592224054, -174.78719186126352, -401.8165304465185, -975.1915558760929, -934.1444200346323, -1008.4360258593322, -208.39930574592725, -923.5227273986044, -1039.4968727248636, -1202.5177045314715, -124.86834862274225, -1100.9918871357766, -582.8316230541669, -965.9419781799323, -1220.5559863112426, -71.27771504407572, -890.0766617451025, -1368.5982422747195, -847.2446934005754, -985.0829569990251, -936.9969445802295, -881.6727308300237, -728.59803220637, -845.4334669127668, -937.9390671180847, -613.348071200284, -94.7808073096457], "episode_lengths": [150, 150, 150, 150, 132, 150, 150, 150, 150, 150, 106, 150, 86, 150, 150, 92, 150, 120, 150, 115, 88, 67, 98, 150, 150, 150, 150, 150, 105, 71, 150, 150, 75, 135, 150, 150, 150, 150, 150, 106, 73, 135, 150, 150, 150, 150, 150, 47, 150, 150, 150, 150, 150, 150, 150, 146, 150, 94, 150, 104, 150, 150, 150, 51, 150, 150, 124, 150, 150, 150, 94, 68, 91, 75, 74, 131, 150, 150, 150, 118, 150, 150, 150, 67, 150, 134, 150, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 57], "policy_policy_0_reward": [-936.8771724714461, -828.9061247942212, -878.075818482817, -834.9129157640622, -628.2782641453617, -1175.6779655057912, -792.5037896984903, -866.6176241593607, -847.9393493121639, -578.5282447430499, -490.62651013642704, -893.0669088466308, -282.50169412968364, -282.21654986686326, -883.0960911011235, -368.94035379566503, -835.8683681883393, -242.9997681453561, -977.7442876514721, -510.59890646589724, -164.0202645410956, -56.890436031523215, -188.43702610222476, -887.8588854164357, -1041.859237181187, -812.0714898604183, -615.3252867667766, -1061.227270590874, -213.9452044287495, -102.65450512848695, -704.5585671296476, -683.7074747040843, -67.72264371975507, -710.1806666735788, -784.8719821390968, -603.2091836174908, -755.1190114723781, -989.7161342245488, -768.8840804541725, -451.7943684869786, -74.44314825225368, -588.82742301907, -894.2182141511195, -507.9544957963476, -1080.7548124153586, -390.8088553534678, -758.2398482759164, -23.853967769826536, -1103.6739815423146, -1083.273306295569, -326.3594838861252, -1136.8368848912041, -885.713644667381, -859.6440378367632, -930.0071423863259, -645.4077995608285, -851.1103102323808, -268.0857494877361, -809.6720294771601, -331.1747230236627, -1012.7003063298038, -844.9354567597435, -1046.4289963151673, -21.71018461169386, -734.7670861154829, -959.5306619109698, -497.5003976631096, -1144.5301384429736, -934.8317045763188, -706.0004869481343, -129.71110914995498, -112.58782613857834, -115.44244122004305, -81.88484592224054, -174.78719186126352, -401.8165304465185, -975.1915558760929, -934.1444200346323, -1008.4360258593322, -208.39930574592725, -923.5227273986044, -1039.4968727248636, -1202.5177045314715, -124.86834862274225, -1100.9918871357766, -582.8316230541669, -965.9419781799323, -1220.5559863112426, -71.27771504407572, -890.0766617451025, -1368.5982422747195, -847.2446934005754, -985.0829569990251, -936.9969445802295, -881.6727308300237, -728.59803220637, -845.4334669127668, -937.9390671180847, -613.348071200284, -94.7808073096457]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2999806210849876, "mean_inference_ms": 0.9308905007183199, "mean_action_processing_ms": 0.16650258964833511, "mean_env_wait_ms": 1.6925368752168635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058746337890625, "StateBufferConnector_ms": 0.004141092300415039, "ViewRequirementAgentConnector_ms": 0.10422921180725098}, "num_episodes": 30, "episode_return_max": -21.71018461169386, "episode_return_min": -1368.5982422747195, "episode_return_mean": -677.572034739022, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 286.6180119906503, "num_env_steps_trained_throughput_per_sec": 286.6180119906503, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 13219.797, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13219.726, "sample_time_ms": 2554.365, "learn_time_ms": 10648.174, "learn_throughput": 375.651, "synch_weights_time_ms": 16.033}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "training_iteration": 51, "trial_id": "6d52d_00000", "date": "2024-07-26_22-55-30", "timestamp": 1722014730, "time_this_iter_s": 13.96143889427185, "time_total_s": 684.8698019981384, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d12547285e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 684.8698019981384, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 12.415000000000001, "ram_util_percent": 28.725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 250.1156950910886, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.718270305171609, "policy_loss": -0.009695869047815601, "vf_loss": 3.734475517272949, "vf_explained_var": 0.9841497708112001, "kl": 0.013084935965253015, "entropy": 1.5341667061050732, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 49440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": -21.71018461169386, "episode_reward_min": -1401.2310738174017, "episode_reward_mean": -711.8066216316, "episode_len_mean": 133.67, "episode_media": {}, "episodes_timesteps_total": 13367, "policy_reward_min": {"policy_0": -1401.2310738174017}, "policy_reward_max": {"policy_0": -21.71018461169386}, "policy_reward_mean": {"policy_0": -711.8066216316}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-683.7074747040843, -67.72264371975507, -710.1806666735788, -784.8719821390968, -603.2091836174908, -755.1190114723781, -989.7161342245488, -768.8840804541725, -451.7943684869786, -74.44314825225368, -588.82742301907, -894.2182141511195, -507.9544957963476, -1080.7548124153586, -390.8088553534678, -758.2398482759164, -23.853967769826536, -1103.6739815423146, -1083.273306295569, -326.3594838861252, -1136.8368848912041, -885.713644667381, -859.6440378367632, -930.0071423863259, -645.4077995608285, -851.1103102323808, -268.0857494877361, -809.6720294771601, -331.1747230236627, -1012.7003063298038, -844.9354567597435, -1046.4289963151673, -21.71018461169386, -734.7670861154829, -959.5306619109698, -497.5003976631096, -1144.5301384429736, -934.8317045763188, -706.0004869481343, -129.71110914995498, -112.58782613857834, -115.44244122004305, -81.88484592224054, -174.78719186126352, -401.8165304465185, -975.1915558760929, -934.1444200346323, -1008.4360258593322, -208.39930574592725, -923.5227273986044, -1039.4968727248636, -1202.5177045314715, -124.86834862274225, -1100.9918871357766, -582.8316230541669, -965.9419781799323, -1220.5559863112426, -71.27771504407572, -890.0766617451025, -1368.5982422747195, -847.2446934005754, -985.0829569990251, -936.9969445802295, -881.6727308300237, -728.59803220637, -845.4334669127668, -937.9390671180847, -613.348071200284, -94.7808073096457, -754.1082098413572, -214.706819340153, -276.07937586895264, -897.0378741977104, -942.4960048384343, -1067.015503311635, -703.5754014429167, -1139.4257691802625, -1401.2310738174017, -867.512333688663, -120.06583327442641, -565.7339350574798, -603.7205054099759, -412.88047081014184, -1216.1346409365383, -990.849594326883, -547.9894638526564, -1143.7329557785479, -1027.8163754672123, -171.01949495305954, -1012.7616734981204, -837.3515292990654, -279.828448833228, -1024.2400657374974, -830.9628983672919, -289.8799146068636, -751.794641588769, -1170.804595152254, -824.3203265021033, -688.6602623489723, -634.547578510849], "episode_lengths": [150, 75, 135, 150, 150, 150, 150, 150, 106, 73, 135, 150, 150, 150, 150, 150, 47, 150, 150, 150, 150, 150, 150, 150, 146, 150, 94, 150, 104, 150, 150, 150, 51, 150, 150, 124, 150, 150, 150, 94, 68, 91, 75, 74, 131, 150, 150, 150, 118, 150, 150, 150, 67, 150, 134, 150, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 57, 150, 109, 95, 150, 150, 150, 150, 150, 150, 150, 62, 150, 150, 150, 150, 150, 133, 150, 150, 77, 150, 150, 84, 150, 150, 87, 139, 150, 150, 150, 150], "policy_policy_0_reward": [-683.7074747040843, -67.72264371975507, -710.1806666735788, -784.8719821390968, -603.2091836174908, -755.1190114723781, -989.7161342245488, -768.8840804541725, -451.7943684869786, -74.44314825225368, -588.82742301907, -894.2182141511195, -507.9544957963476, -1080.7548124153586, -390.8088553534678, -758.2398482759164, -23.853967769826536, -1103.6739815423146, -1083.273306295569, -326.3594838861252, -1136.8368848912041, -885.713644667381, -859.6440378367632, -930.0071423863259, -645.4077995608285, -851.1103102323808, -268.0857494877361, -809.6720294771601, -331.1747230236627, -1012.7003063298038, -844.9354567597435, -1046.4289963151673, -21.71018461169386, -734.7670861154829, -959.5306619109698, -497.5003976631096, -1144.5301384429736, -934.8317045763188, -706.0004869481343, -129.71110914995498, -112.58782613857834, -115.44244122004305, -81.88484592224054, -174.78719186126352, -401.8165304465185, -975.1915558760929, -934.1444200346323, -1008.4360258593322, -208.39930574592725, -923.5227273986044, -1039.4968727248636, -1202.5177045314715, -124.86834862274225, -1100.9918871357766, -582.8316230541669, -965.9419781799323, -1220.5559863112426, -71.27771504407572, -890.0766617451025, -1368.5982422747195, -847.2446934005754, -985.0829569990251, -936.9969445802295, -881.6727308300237, -728.59803220637, -845.4334669127668, -937.9390671180847, -613.348071200284, -94.7808073096457, -754.1082098413572, -214.706819340153, -276.07937586895264, -897.0378741977104, -942.4960048384343, -1067.015503311635, -703.5754014429167, -1139.4257691802625, -1401.2310738174017, -867.512333688663, -120.06583327442641, -565.7339350574798, -603.7205054099759, -412.88047081014184, -1216.1346409365383, -990.849594326883, -547.9894638526564, -1143.7329557785479, -1027.8163754672123, -171.01949495305954, -1012.7616734981204, -837.3515292990654, -279.828448833228, -1024.2400657374974, -830.9628983672919, -289.8799146068636, -751.794641588769, -1170.804595152254, -824.3203265021033, -688.6602623489723, -634.547578510849]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3001765573576754, "mean_inference_ms": 0.931151583706571, "mean_action_processing_ms": 0.16665399186144964, "mean_env_wait_ms": 1.6946437743914773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005742549896240234, "StateBufferConnector_ms": 0.004150390625, "ViewRequirementAgentConnector_ms": 0.10542035102844238}, "num_episodes": 31, "episode_return_max": -21.71018461169386, "episode_return_min": -1401.2310738174017, "episode_return_mean": -711.8066216316, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.1795348015834, "num_env_steps_trained_throughput_per_sec": 274.1795348015834, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 13352.648, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13352.577, "sample_time_ms": 2658.822, "learn_time_ms": 10676.679, "learn_throughput": 374.648, "synch_weights_time_ms": 15.936}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 52, "trial_id": "6d52d_00000", "date": "2024-07-26_22-55-44", "timestamp": 1722014744, "time_this_iter_s": 14.593993425369263, "time_total_s": 699.4637954235077, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c3dbd00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 699.4637954235077, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 11.438095238095237, "ram_util_percent": 28.847619047619045}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 170.04448678692182, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.147765920311213, "policy_loss": -0.014081913139186024, "vf_loss": 4.162741985668739, "vf_explained_var": 0.9610374848668773, "kl": 0.013238869737574533, "entropy": 0.9830389522016049, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 50400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "env_runners": {"episode_reward_max": -21.71018461169386, "episode_reward_min": -1401.2310738174017, "episode_reward_mean": -656.0475046014321, "episode_len_mean": 129.56, "episode_media": {}, "episodes_timesteps_total": 12956, "policy_reward_min": {"policy_0": -1401.2310738174017}, "policy_reward_max": {"policy_0": -21.71018461169386}, "policy_reward_mean": {"policy_0": -656.0475046014321}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1046.4289963151673, -21.71018461169386, -734.7670861154829, -959.5306619109698, -497.5003976631096, -1144.5301384429736, -934.8317045763188, -706.0004869481343, -129.71110914995498, -112.58782613857834, -115.44244122004305, -81.88484592224054, -174.78719186126352, -401.8165304465185, -975.1915558760929, -934.1444200346323, -1008.4360258593322, -208.39930574592725, -923.5227273986044, -1039.4968727248636, -1202.5177045314715, -124.86834862274225, -1100.9918871357766, -582.8316230541669, -965.9419781799323, -1220.5559863112426, -71.27771504407572, -890.0766617451025, -1368.5982422747195, -847.2446934005754, -985.0829569990251, -936.9969445802295, -881.6727308300237, -728.59803220637, -845.4334669127668, -937.9390671180847, -613.348071200284, -94.7808073096457, -754.1082098413572, -214.706819340153, -276.07937586895264, -897.0378741977104, -942.4960048384343, -1067.015503311635, -703.5754014429167, -1139.4257691802625, -1401.2310738174017, -867.512333688663, -120.06583327442641, -565.7339350574798, -603.7205054099759, -412.88047081014184, -1216.1346409365383, -990.849594326883, -547.9894638526564, -1143.7329557785479, -1027.8163754672123, -171.01949495305954, -1012.7616734981204, -837.3515292990654, -279.828448833228, -1024.2400657374974, -830.9628983672919, -289.8799146068636, -751.794641588769, -1170.804595152254, -824.3203265021033, -688.6602623489723, -634.547578510849, -226.28712784962676, -836.8539810163816, -762.3206746031896, -415.1156292125286, -311.1922713402325, -557.5904829733444, -973.4101950517855, -773.845258462704, -420.5948259993229, -317.8535546733512, -410.7829589279269, -571.1371516193256, -591.5147985791365, -40.21885298754675, -958.4119075737393, -709.7524946773004, -631.3939530785062, -105.16514668025896, -1095.2345403285044, -738.0929521629586, -767.5621698720042, -25.662862858761414, -354.1110736327319, -599.8297225367243, -266.520728870538, -480.9798425628234, -906.6992704763901, -193.35018364098255, -492.26973056413686, -87.02122481267389, -26.213896260223024], "episode_lengths": [150, 51, 150, 150, 124, 150, 150, 150, 94, 68, 91, 75, 74, 131, 150, 150, 150, 118, 150, 150, 150, 67, 150, 134, 150, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 57, 150, 109, 95, 150, 150, 150, 150, 150, 150, 150, 62, 150, 150, 150, 150, 150, 133, 150, 150, 77, 150, 150, 84, 150, 150, 87, 139, 150, 150, 150, 150, 71, 150, 150, 150, 138, 146, 150, 150, 119, 110, 150, 140, 150, 49, 150, 150, 139, 49, 150, 150, 150, 52, 150, 137, 109, 150, 150, 69, 108, 59, 59], "policy_policy_0_reward": [-1046.4289963151673, -21.71018461169386, -734.7670861154829, -959.5306619109698, -497.5003976631096, -1144.5301384429736, -934.8317045763188, -706.0004869481343, -129.71110914995498, -112.58782613857834, -115.44244122004305, -81.88484592224054, -174.78719186126352, -401.8165304465185, -975.1915558760929, -934.1444200346323, -1008.4360258593322, -208.39930574592725, -923.5227273986044, -1039.4968727248636, -1202.5177045314715, -124.86834862274225, -1100.9918871357766, -582.8316230541669, -965.9419781799323, -1220.5559863112426, -71.27771504407572, -890.0766617451025, -1368.5982422747195, -847.2446934005754, -985.0829569990251, -936.9969445802295, -881.6727308300237, -728.59803220637, -845.4334669127668, -937.9390671180847, -613.348071200284, -94.7808073096457, -754.1082098413572, -214.706819340153, -276.07937586895264, -897.0378741977104, -942.4960048384343, -1067.015503311635, -703.5754014429167, -1139.4257691802625, -1401.2310738174017, -867.512333688663, -120.06583327442641, -565.7339350574798, -603.7205054099759, -412.88047081014184, -1216.1346409365383, -990.849594326883, -547.9894638526564, -1143.7329557785479, -1027.8163754672123, -171.01949495305954, -1012.7616734981204, -837.3515292990654, -279.828448833228, -1024.2400657374974, -830.9628983672919, -289.8799146068636, -751.794641588769, -1170.804595152254, -824.3203265021033, -688.6602623489723, -634.547578510849, -226.28712784962676, -836.8539810163816, -762.3206746031896, -415.1156292125286, -311.1922713402325, -557.5904829733444, -973.4101950517855, -773.845258462704, -420.5948259993229, -317.8535546733512, -410.7829589279269, -571.1371516193256, -591.5147985791365, -40.21885298754675, -958.4119075737393, -709.7524946773004, -631.3939530785062, -105.16514668025896, -1095.2345403285044, -738.0929521629586, -767.5621698720042, -25.662862858761414, -354.1110736327319, -599.8297225367243, -266.520728870538, -480.9798425628234, -906.6992704763901, -193.35018364098255, -492.26973056413686, -87.02122481267389, -26.213896260223024]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30023063190019733, "mean_inference_ms": 0.9314228971120718, "mean_action_processing_ms": 0.1666651933579751, "mean_env_wait_ms": 1.6941408557478745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005574703216552734, "StateBufferConnector_ms": 0.004178762435913086, "ViewRequirementAgentConnector_ms": 0.10681271553039551}, "num_episodes": 31, "episode_return_max": -21.71018461169386, "episode_return_min": -1401.2310738174017, "episode_return_mean": -656.0475046014321, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.8373776189353, "num_env_steps_trained_throughput_per_sec": 266.8373776189353, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 212000, "timers": {"training_iteration_time_ms": 13458.466, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13458.396, "sample_time_ms": 2683.163, "learn_time_ms": 10758.116, "learn_throughput": 371.812, "synch_weights_time_ms": 15.929}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "done": false, "training_iteration": 53, "trial_id": "6d52d_00000", "date": "2024-07-26_22-55-59", "timestamp": 1722014759, "time_this_iter_s": 14.99773907661438, "time_total_s": 714.4615345001221, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c3d9630>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 714.4615345001221, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 10.495454545454548, "ram_util_percent": 28.87727272727272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 189.3576368590196, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.6160712661842505, "policy_loss": -0.01517276501787516, "vf_loss": 3.634356891612212, "vf_explained_var": 0.9843899965286255, "kl": 0.014226999125215476, "entropy": 1.2716083589941263, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 51360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "env_runners": {"episode_reward_max": -25.662862858761414, "episode_reward_min": -1401.2310738174017, "episode_reward_mean": -654.7626537638852, "episode_len_mean": 132.97, "episode_media": {}, "episodes_timesteps_total": 13297, "policy_reward_min": {"policy_0": -1401.2310738174017}, "policy_reward_max": {"policy_0": -25.662862858761414}, "policy_reward_mean": {"policy_0": -654.7626537638852}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-847.2446934005754, -985.0829569990251, -936.9969445802295, -881.6727308300237, -728.59803220637, -845.4334669127668, -937.9390671180847, -613.348071200284, -94.7808073096457, -754.1082098413572, -214.706819340153, -276.07937586895264, -897.0378741977104, -942.4960048384343, -1067.015503311635, -703.5754014429167, -1139.4257691802625, -1401.2310738174017, -867.512333688663, -120.06583327442641, -565.7339350574798, -603.7205054099759, -412.88047081014184, -1216.1346409365383, -990.849594326883, -547.9894638526564, -1143.7329557785479, -1027.8163754672123, -171.01949495305954, -1012.7616734981204, -837.3515292990654, -279.828448833228, -1024.2400657374974, -830.9628983672919, -289.8799146068636, -751.794641588769, -1170.804595152254, -824.3203265021033, -688.6602623489723, -634.547578510849, -226.28712784962676, -836.8539810163816, -762.3206746031896, -415.1156292125286, -311.1922713402325, -557.5904829733444, -973.4101950517855, -773.845258462704, -420.5948259993229, -317.8535546733512, -410.7829589279269, -571.1371516193256, -591.5147985791365, -40.21885298754675, -958.4119075737393, -709.7524946773004, -631.3939530785062, -105.16514668025896, -1095.2345403285044, -738.0929521629586, -767.5621698720042, -25.662862858761414, -354.1110736327319, -599.8297225367243, -266.520728870538, -480.9798425628234, -906.6992704763901, -193.35018364098255, -492.26973056413686, -87.02122481267389, -26.213896260223024, -31.685489753892945, -1078.5026823477465, -118.74093924435132, -916.4394369822686, -625.9800025448543, -517.826801323626, -105.38361969542649, -765.9404081950856, -314.14641531165, -176.21104606217767, -1137.22757928933, -489.5029718527617, -1046.237397226791, -774.2281427744423, -1188.1091334696212, -921.5194596207376, -944.6327492010441, -608.5295686885993, -769.6572749398359, -817.500023461763, -754.7994556668089, -473.68126281319195, -280.8901999358524, -1186.2356770633305, -915.2787038406848, -476.9461768428504, -407.79212189969235, -545.3269118970732, -1160.9439201609323], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 57, 150, 109, 95, 150, 150, 150, 150, 150, 150, 150, 62, 150, 150, 150, 150, 150, 133, 150, 150, 77, 150, 150, 84, 150, 150, 87, 139, 150, 150, 150, 150, 71, 150, 150, 150, 138, 146, 150, 150, 119, 110, 150, 140, 150, 49, 150, 150, 139, 49, 150, 150, 150, 52, 150, 137, 109, 150, 150, 69, 108, 59, 59, 64, 150, 87, 150, 150, 150, 76, 150, 150, 89, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 142, 117, 150, 150], "policy_policy_0_reward": [-847.2446934005754, -985.0829569990251, -936.9969445802295, -881.6727308300237, -728.59803220637, -845.4334669127668, -937.9390671180847, -613.348071200284, -94.7808073096457, -754.1082098413572, -214.706819340153, -276.07937586895264, -897.0378741977104, -942.4960048384343, -1067.015503311635, -703.5754014429167, -1139.4257691802625, -1401.2310738174017, -867.512333688663, -120.06583327442641, -565.7339350574798, -603.7205054099759, -412.88047081014184, -1216.1346409365383, -990.849594326883, -547.9894638526564, -1143.7329557785479, -1027.8163754672123, -171.01949495305954, -1012.7616734981204, -837.3515292990654, -279.828448833228, -1024.2400657374974, -830.9628983672919, -289.8799146068636, -751.794641588769, -1170.804595152254, -824.3203265021033, -688.6602623489723, -634.547578510849, -226.28712784962676, -836.8539810163816, -762.3206746031896, -415.1156292125286, -311.1922713402325, -557.5904829733444, -973.4101950517855, -773.845258462704, -420.5948259993229, -317.8535546733512, -410.7829589279269, -571.1371516193256, -591.5147985791365, -40.21885298754675, -958.4119075737393, -709.7524946773004, -631.3939530785062, -105.16514668025896, -1095.2345403285044, -738.0929521629586, -767.5621698720042, -25.662862858761414, -354.1110736327319, -599.8297225367243, -266.520728870538, -480.9798425628234, -906.6992704763901, -193.35018364098255, -492.26973056413686, -87.02122481267389, -26.213896260223024, -31.685489753892945, -1078.5026823477465, -118.74093924435132, -916.4394369822686, -625.9800025448543, -517.826801323626, -105.38361969542649, -765.9404081950856, -314.14641531165, -176.21104606217767, -1137.22757928933, -489.5029718527617, -1046.237397226791, -774.2281427744423, -1188.1091334696212, -921.5194596207376, -944.6327492010441, -608.5295686885993, -769.6572749398359, -817.500023461763, -754.7994556668089, -473.68126281319195, -280.8901999358524, -1186.2356770633305, -915.2787038406848, -476.9461768428504, -407.79212189969235, -545.3269118970732, -1160.9439201609323]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30046511312377544, "mean_inference_ms": 0.9319841500113667, "mean_action_processing_ms": 0.16685063753699553, "mean_env_wait_ms": 1.6969124724411615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005507469177246094, "StateBufferConnector_ms": 0.004203319549560547, "ViewRequirementAgentConnector_ms": 0.10753417015075684}, "num_episodes": 29, "episode_return_max": -25.662862858761414, "episode_return_min": -1401.2310738174017, "episode_return_mean": -654.7626537638852, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 321.53398464288216, "num_env_steps_trained_throughput_per_sec": 321.53398464288216, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 13335.176, "restore_workers_time_ms": 0.022, "training_step_time_ms": 13335.111, "sample_time_ms": 2682.205, "learn_time_ms": 10635.935, "learn_throughput": 376.084, "synch_weights_time_ms": 15.808}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "training_iteration": 54, "trial_id": "6d52d_00000", "date": "2024-07-26_22-56-12", "timestamp": 1722014772, "time_this_iter_s": 12.444707870483398, "time_total_s": 726.9062423706055, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c3db5b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 726.9062423706055, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 11.423529411764704, "ram_util_percent": 28.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 190.18121951818466, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.928533363590638, "policy_loss": -0.0038816723584507904, "vf_loss": 3.937414051964879, "vf_explained_var": 0.9708365334197879, "kl": 0.010519096866119123, "entropy": 1.2099391139422855, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 52320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "env_runners": {"episode_reward_max": -25.662862858761414, "episode_reward_min": -1188.8503649869797, "episode_reward_mean": -597.7451781547379, "episode_len_mean": 130.24, "episode_media": {}, "episodes_timesteps_total": 13024, "policy_reward_min": {"policy_0": -1188.8503649869797}, "policy_reward_max": {"policy_0": -25.662862858761414}, "policy_reward_mean": {"policy_0": -597.7451781547379}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-279.828448833228, -1024.2400657374974, -830.9628983672919, -289.8799146068636, -751.794641588769, -1170.804595152254, -824.3203265021033, -688.6602623489723, -634.547578510849, -226.28712784962676, -836.8539810163816, -762.3206746031896, -415.1156292125286, -311.1922713402325, -557.5904829733444, -973.4101950517855, -773.845258462704, -420.5948259993229, -317.8535546733512, -410.7829589279269, -571.1371516193256, -591.5147985791365, -40.21885298754675, -958.4119075737393, -709.7524946773004, -631.3939530785062, -105.16514668025896, -1095.2345403285044, -738.0929521629586, -767.5621698720042, -25.662862858761414, -354.1110736327319, -599.8297225367243, -266.520728870538, -480.9798425628234, -906.6992704763901, -193.35018364098255, -492.26973056413686, -87.02122481267389, -26.213896260223024, -31.685489753892945, -1078.5026823477465, -118.74093924435132, -916.4394369822686, -625.9800025448543, -517.826801323626, -105.38361969542649, -765.9404081950856, -314.14641531165, -176.21104606217767, -1137.22757928933, -489.5029718527617, -1046.237397226791, -774.2281427744423, -1188.1091334696212, -921.5194596207376, -944.6327492010441, -608.5295686885993, -769.6572749398359, -817.500023461763, -754.7994556668089, -473.68126281319195, -280.8901999358524, -1186.2356770633305, -915.2787038406848, -476.9461768428504, -407.79212189969235, -545.3269118970732, -1160.9439201609323, -1050.7627335688262, -88.81538994627077, -1021.0477833412219, -756.9486247751181, -335.8076230820855, -943.4548717320282, -360.987623335058, -829.4889719444493, -78.31046433492976, -594.1718466321063, -939.3857717301877, -543.2215463586272, -952.2956173185131, -315.81398691213695, -540.4178289269643, -312.1671160751168, -238.30778151329818, -492.53226418244907, -634.3322129885024, -44.6908125264781, -977.0450148620315, -221.7089138857039, -394.0269490650096, -457.22608775346436, -909.2275391172076, -371.26361365043925, -220.30663024096253, -938.7025823232221, -454.97373724404116, -876.301743480452, -1188.8503649869797], "episode_lengths": [84, 150, 150, 87, 139, 150, 150, 150, 150, 71, 150, 150, 150, 138, 146, 150, 150, 119, 110, 150, 140, 150, 49, 150, 150, 139, 49, 150, 150, 150, 52, 150, 137, 109, 150, 150, 69, 108, 59, 59, 64, 150, 87, 150, 150, 150, 76, 150, 150, 89, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 142, 117, 150, 150, 150, 71, 150, 150, 113, 150, 130, 150, 72, 130, 150, 150, 150, 92, 150, 104, 114, 119, 143, 50, 150, 101, 124, 150, 150, 150, 117, 150, 130, 150, 150], "policy_policy_0_reward": [-279.828448833228, -1024.2400657374974, -830.9628983672919, -289.8799146068636, -751.794641588769, -1170.804595152254, -824.3203265021033, -688.6602623489723, -634.547578510849, -226.28712784962676, -836.8539810163816, -762.3206746031896, -415.1156292125286, -311.1922713402325, -557.5904829733444, -973.4101950517855, -773.845258462704, -420.5948259993229, -317.8535546733512, -410.7829589279269, -571.1371516193256, -591.5147985791365, -40.21885298754675, -958.4119075737393, -709.7524946773004, -631.3939530785062, -105.16514668025896, -1095.2345403285044, -738.0929521629586, -767.5621698720042, -25.662862858761414, -354.1110736327319, -599.8297225367243, -266.520728870538, -480.9798425628234, -906.6992704763901, -193.35018364098255, -492.26973056413686, -87.02122481267389, -26.213896260223024, -31.685489753892945, -1078.5026823477465, -118.74093924435132, -916.4394369822686, -625.9800025448543, -517.826801323626, -105.38361969542649, -765.9404081950856, -314.14641531165, -176.21104606217767, -1137.22757928933, -489.5029718527617, -1046.237397226791, -774.2281427744423, -1188.1091334696212, -921.5194596207376, -944.6327492010441, -608.5295686885993, -769.6572749398359, -817.500023461763, -754.7994556668089, -473.68126281319195, -280.8901999358524, -1186.2356770633305, -915.2787038406848, -476.9461768428504, -407.79212189969235, -545.3269118970732, -1160.9439201609323, -1050.7627335688262, -88.81538994627077, -1021.0477833412219, -756.9486247751181, -335.8076230820855, -943.4548717320282, -360.987623335058, -829.4889719444493, -78.31046433492976, -594.1718466321063, -939.3857717301877, -543.2215463586272, -952.2956173185131, -315.81398691213695, -540.4178289269643, -312.1671160751168, -238.30778151329818, -492.53226418244907, -634.3322129885024, -44.6908125264781, -977.0450148620315, -221.7089138857039, -394.0269490650096, -457.22608775346436, -909.2275391172076, -371.26361365043925, -220.30663024096253, -938.7025823232221, -454.97373724404116, -876.301743480452, -1188.8503649869797]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3005631825948803, "mean_inference_ms": 0.9321526034729731, "mean_action_processing_ms": 0.16688057734217232, "mean_env_wait_ms": 1.6975785026178454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005544900894165039, "StateBufferConnector_ms": 0.004221677780151367, "ViewRequirementAgentConnector_ms": 0.10747385025024414}, "num_episodes": 31, "episode_return_max": -25.662862858761414, "episode_return_min": -1188.8503649869797, "episode_return_mean": -597.7451781547379, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 273.93080600518084, "num_env_steps_trained_throughput_per_sec": 273.93080600518084, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 13555.16, "restore_workers_time_ms": 0.022, "training_step_time_ms": 13555.094, "sample_time_ms": 2728.042, "learn_time_ms": 10809.957, "learn_throughput": 370.029, "synch_weights_time_ms": 15.885}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "done": false, "training_iteration": 55, "trial_id": "6d52d_00000", "date": "2024-07-26_22-56-27", "timestamp": 1722014787, "time_this_iter_s": 14.610161066055298, "time_total_s": 741.5164034366608, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c312680>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 741.5164034366608, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 12.390476190476189, "ram_util_percent": 28.880952380952387}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 228.3721366206805, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.537063456326723, "policy_loss": -0.012250654749126018, "vf_loss": 3.5566300579657155, "vf_explained_var": 0.9842778681466977, "kl": 0.012461836799229848, "entropy": 1.5727691197146971, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 53280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": -25.662862858761414, "episode_reward_min": -1305.3386083638482, "episode_reward_mean": -646.5405813494392, "episode_len_mean": 134.85, "episode_media": {}, "episodes_timesteps_total": 13485, "policy_reward_min": {"policy_0": -1305.3386083638482}, "policy_reward_max": {"policy_0": -25.662862858761414}, "policy_reward_mean": {"policy_0": -646.5405813494392}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1095.2345403285044, -738.0929521629586, -767.5621698720042, -25.662862858761414, -354.1110736327319, -599.8297225367243, -266.520728870538, -480.9798425628234, -906.6992704763901, -193.35018364098255, -492.26973056413686, -87.02122481267389, -26.213896260223024, -31.685489753892945, -1078.5026823477465, -118.74093924435132, -916.4394369822686, -625.9800025448543, -517.826801323626, -105.38361969542649, -765.9404081950856, -314.14641531165, -176.21104606217767, -1137.22757928933, -489.5029718527617, -1046.237397226791, -774.2281427744423, -1188.1091334696212, -921.5194596207376, -944.6327492010441, -608.5295686885993, -769.6572749398359, -817.500023461763, -754.7994556668089, -473.68126281319195, -280.8901999358524, -1186.2356770633305, -915.2787038406848, -476.9461768428504, -407.79212189969235, -545.3269118970732, -1160.9439201609323, -1050.7627335688262, -88.81538994627077, -1021.0477833412219, -756.9486247751181, -335.8076230820855, -943.4548717320282, -360.987623335058, -829.4889719444493, -78.31046433492976, -594.1718466321063, -939.3857717301877, -543.2215463586272, -952.2956173185131, -315.81398691213695, -540.4178289269643, -312.1671160751168, -238.30778151329818, -492.53226418244907, -634.3322129885024, -44.6908125264781, -977.0450148620315, -221.7089138857039, -394.0269490650096, -457.22608775346436, -909.2275391172076, -371.26361365043925, -220.30663024096253, -938.7025823232221, -454.97373724404116, -876.301743480452, -1188.8503649869797, -851.1433393848779, -1032.359815235361, -447.48829085691335, -959.3932789354418, -391.06138363720925, -1084.6084689424795, -918.3773751453577, -943.0869312171349, -809.0200620597535, -228.88731701602856, -878.2055163201253, -1305.3386083638482, -636.0689765041859, -1193.6354951203268, -904.9466939011087, -538.8335933774574, -502.92993878332703, -1052.1143559413854, -999.0709941265023, -590.1968603464303, -974.1345432912519, -531.105803481482, -786.2416199468062, -691.4916428021326, -542.1765999410206, -366.9696238484576, -829.1331878977605], "episode_lengths": [150, 150, 150, 52, 150, 137, 109, 150, 150, 69, 108, 59, 59, 64, 150, 87, 150, 150, 150, 76, 150, 150, 89, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 142, 117, 150, 150, 150, 71, 150, 150, 113, 150, 130, 150, 72, 130, 150, 150, 150, 92, 150, 104, 114, 119, 143, 50, 150, 101, 124, 150, 150, 150, 117, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 132, 150, 150, 150, 136, 150], "policy_policy_0_reward": [-1095.2345403285044, -738.0929521629586, -767.5621698720042, -25.662862858761414, -354.1110736327319, -599.8297225367243, -266.520728870538, -480.9798425628234, -906.6992704763901, -193.35018364098255, -492.26973056413686, -87.02122481267389, -26.213896260223024, -31.685489753892945, -1078.5026823477465, -118.74093924435132, -916.4394369822686, -625.9800025448543, -517.826801323626, -105.38361969542649, -765.9404081950856, -314.14641531165, -176.21104606217767, -1137.22757928933, -489.5029718527617, -1046.237397226791, -774.2281427744423, -1188.1091334696212, -921.5194596207376, -944.6327492010441, -608.5295686885993, -769.6572749398359, -817.500023461763, -754.7994556668089, -473.68126281319195, -280.8901999358524, -1186.2356770633305, -915.2787038406848, -476.9461768428504, -407.79212189969235, -545.3269118970732, -1160.9439201609323, -1050.7627335688262, -88.81538994627077, -1021.0477833412219, -756.9486247751181, -335.8076230820855, -943.4548717320282, -360.987623335058, -829.4889719444493, -78.31046433492976, -594.1718466321063, -939.3857717301877, -543.2215463586272, -952.2956173185131, -315.81398691213695, -540.4178289269643, -312.1671160751168, -238.30778151329818, -492.53226418244907, -634.3322129885024, -44.6908125264781, -977.0450148620315, -221.7089138857039, -394.0269490650096, -457.22608775346436, -909.2275391172076, -371.26361365043925, -220.30663024096253, -938.7025823232221, -454.97373724404116, -876.301743480452, -1188.8503649869797, -851.1433393848779, -1032.359815235361, -447.48829085691335, -959.3932789354418, -391.06138363720925, -1084.6084689424795, -918.3773751453577, -943.0869312171349, -809.0200620597535, -228.88731701602856, -878.2055163201253, -1305.3386083638482, -636.0689765041859, -1193.6354951203268, -904.9466939011087, -538.8335933774574, -502.92993878332703, -1052.1143559413854, -999.0709941265023, -590.1968603464303, -974.1345432912519, -531.105803481482, -786.2416199468062, -691.4916428021326, -542.1765999410206, -366.9696238484576, -829.1331878977605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30059425360675696, "mean_inference_ms": 0.9320600220606322, "mean_action_processing_ms": 0.16684736115338253, "mean_env_wait_ms": 1.6994386599854905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00539851188659668, "StateBufferConnector_ms": 0.004168272018432617, "ViewRequirementAgentConnector_ms": 0.10599613189697266}, "num_episodes": 27, "episode_return_max": -25.662862858761414, "episode_return_min": -1305.3386083638482, "episode_return_mean": -646.5405813494392, "episodes_this_iter": 27}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 331.7513077728408, "num_env_steps_trained_throughput_per_sec": 331.7513077728408, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 13629.183, "restore_workers_time_ms": 0.023, "training_step_time_ms": 13629.116, "sample_time_ms": 2730.988, "learn_time_ms": 10881.276, "learn_throughput": 367.604, "synch_weights_time_ms": 15.625}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 56, "trial_id": "6d52d_00000", "date": "2024-07-26_22-56-39", "timestamp": 1722014799, "time_this_iter_s": 12.064982175827026, "time_total_s": 753.5813856124878, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d1254728550>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 753.5813856124878, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 10.441176470588236, "ram_util_percent": 28.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 189.55460786819458, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.7340608194470404, "policy_loss": -0.007547761751629878, "vf_loss": 3.7435891022284826, "vf_explained_var": 0.9683837773278355, "kl": 0.012902070399043977, "entropy": 1.0689397366096576, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 54240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "env_runners": {"episode_reward_max": -44.6908125264781, "episode_reward_min": -1305.3386083638482, "episode_reward_mean": -655.7346668917073, "episode_len_mean": 136.02, "episode_media": {}, "episodes_timesteps_total": 13602, "policy_reward_min": {"policy_0": -1305.3386083638482}, "policy_reward_max": {"policy_0": -44.6908125264781}, "policy_reward_mean": {"policy_0": -655.7346668917073}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-769.6572749398359, -817.500023461763, -754.7994556668089, -473.68126281319195, -280.8901999358524, -1186.2356770633305, -915.2787038406848, -476.9461768428504, -407.79212189969235, -545.3269118970732, -1160.9439201609323, -1050.7627335688262, -88.81538994627077, -1021.0477833412219, -756.9486247751181, -335.8076230820855, -943.4548717320282, -360.987623335058, -829.4889719444493, -78.31046433492976, -594.1718466321063, -939.3857717301877, -543.2215463586272, -952.2956173185131, -315.81398691213695, -540.4178289269643, -312.1671160751168, -238.30778151329818, -492.53226418244907, -634.3322129885024, -44.6908125264781, -977.0450148620315, -221.7089138857039, -394.0269490650096, -457.22608775346436, -909.2275391172076, -371.26361365043925, -220.30663024096253, -938.7025823232221, -454.97373724404116, -876.301743480452, -1188.8503649869797, -851.1433393848779, -1032.359815235361, -447.48829085691335, -959.3932789354418, -391.06138363720925, -1084.6084689424795, -918.3773751453577, -943.0869312171349, -809.0200620597535, -228.88731701602856, -878.2055163201253, -1305.3386083638482, -636.0689765041859, -1193.6354951203268, -904.9466939011087, -538.8335933774574, -502.92993878332703, -1052.1143559413854, -999.0709941265023, -590.1968603464303, -974.1345432912519, -531.105803481482, -786.2416199468062, -691.4916428021326, -542.1765999410206, -366.9696238484576, -829.1331878977605, -540.8695748752215, -929.1968602635834, -113.60647798906918, -606.2829433250627, -934.6023182312102, -678.9604205516056, -449.3646595720488, -216.87646567875134, -53.687855815570806, -104.37922675453811, -959.5871728708096, -63.51795594182768, -984.3165886165118, -603.1663740085717, -938.8627118352614, -623.5432259826586, -520.0631159115375, -278.6029387917781, -1033.4665878416326, -1197.684935802598, -959.6804646335947, -852.6532823729881, -157.60782271682095, -880.1282452942838, -459.74788897435894, -934.6648992447562, -635.2118068010537, -162.8164477778533, -749.3997697525039, -793.7498952688754, -297.5016628937285], "episode_lengths": [150, 150, 150, 150, 125, 150, 150, 142, 117, 150, 150, 150, 71, 150, 150, 113, 150, 130, 150, 72, 130, 150, 150, 150, 92, 150, 104, 114, 119, 143, 50, 150, 101, 124, 150, 150, 150, 117, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 132, 150, 150, 150, 136, 150, 111, 150, 73, 150, 150, 150, 108, 134, 63, 90, 150, 58, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 63, 150, 150, 150, 150, 87, 150, 150, 89], "policy_policy_0_reward": [-769.6572749398359, -817.500023461763, -754.7994556668089, -473.68126281319195, -280.8901999358524, -1186.2356770633305, -915.2787038406848, -476.9461768428504, -407.79212189969235, -545.3269118970732, -1160.9439201609323, -1050.7627335688262, -88.81538994627077, -1021.0477833412219, -756.9486247751181, -335.8076230820855, -943.4548717320282, -360.987623335058, -829.4889719444493, -78.31046433492976, -594.1718466321063, -939.3857717301877, -543.2215463586272, -952.2956173185131, -315.81398691213695, -540.4178289269643, -312.1671160751168, -238.30778151329818, -492.53226418244907, -634.3322129885024, -44.6908125264781, -977.0450148620315, -221.7089138857039, -394.0269490650096, -457.22608775346436, -909.2275391172076, -371.26361365043925, -220.30663024096253, -938.7025823232221, -454.97373724404116, -876.301743480452, -1188.8503649869797, -851.1433393848779, -1032.359815235361, -447.48829085691335, -959.3932789354418, -391.06138363720925, -1084.6084689424795, -918.3773751453577, -943.0869312171349, -809.0200620597535, -228.88731701602856, -878.2055163201253, -1305.3386083638482, -636.0689765041859, -1193.6354951203268, -904.9466939011087, -538.8335933774574, -502.92993878332703, -1052.1143559413854, -999.0709941265023, -590.1968603464303, -974.1345432912519, -531.105803481482, -786.2416199468062, -691.4916428021326, -542.1765999410206, -366.9696238484576, -829.1331878977605, -540.8695748752215, -929.1968602635834, -113.60647798906918, -606.2829433250627, -934.6023182312102, -678.9604205516056, -449.3646595720488, -216.87646567875134, -53.687855815570806, -104.37922675453811, -959.5871728708096, -63.51795594182768, -984.3165886165118, -603.1663740085717, -938.8627118352614, -623.5432259826586, -520.0631159115375, -278.6029387917781, -1033.4665878416326, -1197.684935802598, -959.6804646335947, -852.6532823729881, -157.60782271682095, -880.1282452942838, -459.74788897435894, -934.6648992447562, -635.2118068010537, -162.8164477778533, -749.3997697525039, -793.7498952688754, -297.5016628937285]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3004838610772058, "mean_inference_ms": 0.9318598415058293, "mean_action_processing_ms": 0.16679199417940965, "mean_env_wait_ms": 1.699152045587689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005257368087768555, "StateBufferConnector_ms": 0.0041239261627197266, "ViewRequirementAgentConnector_ms": 0.10445833206176758}, "num_episodes": 31, "episode_return_max": -44.6908125264781, "episode_return_min": -1305.3386083638482, "episode_return_mean": -655.7346668917073, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 286.3105032842773, "num_env_steps_trained_throughput_per_sec": 286.3105032842773, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 13631.795, "restore_workers_time_ms": 0.023, "training_step_time_ms": 13631.727, "sample_time_ms": 2738.797, "learn_time_ms": 10876.223, "learn_throughput": 367.775, "synch_weights_time_ms": 15.495}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "training_iteration": 57, "trial_id": "6d52d_00000", "date": "2024-07-26_22-56-53", "timestamp": 1722014813, "time_this_iter_s": 13.978873252868652, "time_total_s": 767.5602588653564, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d12547295a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 767.5602588653564, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 10.245000000000001, "ram_util_percent": 28.665000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 173.95369842251142, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.8133835514386494, "policy_loss": -0.014745000854115156, "vf_loss": 3.833197416116794, "vf_explained_var": 0.959841313585639, "kl": 0.014200976527354258, "entropy": 1.465451876198252, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 55200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "env_runners": {"episode_reward_max": -44.6908125264781, "episode_reward_min": -1305.3386083638482, "episode_reward_mean": -661.4867823445804, "episode_len_mean": 136.4, "episode_media": {}, "episodes_timesteps_total": 13640, "policy_reward_min": {"policy_0": -1305.3386083638482}, "policy_reward_max": {"policy_0": -44.6908125264781}, "policy_reward_mean": {"policy_0": -661.4867823445804}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-44.6908125264781, -977.0450148620315, -221.7089138857039, -394.0269490650096, -457.22608775346436, -909.2275391172076, -371.26361365043925, -220.30663024096253, -938.7025823232221, -454.97373724404116, -876.301743480452, -1188.8503649869797, -851.1433393848779, -1032.359815235361, -447.48829085691335, -959.3932789354418, -391.06138363720925, -1084.6084689424795, -918.3773751453577, -943.0869312171349, -809.0200620597535, -228.88731701602856, -878.2055163201253, -1305.3386083638482, -636.0689765041859, -1193.6354951203268, -904.9466939011087, -538.8335933774574, -502.92993878332703, -1052.1143559413854, -999.0709941265023, -590.1968603464303, -974.1345432912519, -531.105803481482, -786.2416199468062, -691.4916428021326, -542.1765999410206, -366.9696238484576, -829.1331878977605, -540.8695748752215, -929.1968602635834, -113.60647798906918, -606.2829433250627, -934.6023182312102, -678.9604205516056, -449.3646595720488, -216.87646567875134, -53.687855815570806, -104.37922675453811, -959.5871728708096, -63.51795594182768, -984.3165886165118, -603.1663740085717, -938.8627118352614, -623.5432259826586, -520.0631159115375, -278.6029387917781, -1033.4665878416326, -1197.684935802598, -959.6804646335947, -852.6532823729881, -157.60782271682095, -880.1282452942838, -459.74788897435894, -934.6648992447562, -635.2118068010537, -162.8164477778533, -749.3997697525039, -793.7498952688754, -297.5016628937285, -457.2766878336326, -258.58354984580814, -603.1973927873717, -1060.8197400210654, -333.4375482143006, -52.33514474788466, -818.6727141578176, -725.1747429679938, -214.20487110411293, -593.9185759114581, -1026.5766384832682, -521.5382679723405, -570.3291774544903, -152.7304324772702, -565.9037340823099, -1231.6115282409405, -479.6602086573079, -633.0225662934015, -666.5870084920577, -817.3147839293864, -405.1411435239102, -570.7126944919364, -500.2751794611328, -761.7672738811909, -1076.7724075684312, -701.3160010210498, -1052.877972582393, -553.0404815738771, -919.0845091856851, -1068.650355543394], "episode_lengths": [50, 150, 101, 124, 150, 150, 150, 117, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 132, 150, 150, 150, 136, 150, 111, 150, 73, 150, 150, 150, 108, 134, 63, 90, 150, 58, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 63, 150, 150, 150, 150, 87, 150, 150, 89, 150, 89, 150, 150, 116, 48, 140, 150, 85, 150, 150, 122, 150, 81, 124, 150, 150, 150, 150, 150, 114, 150, 141, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-44.6908125264781, -977.0450148620315, -221.7089138857039, -394.0269490650096, -457.22608775346436, -909.2275391172076, -371.26361365043925, -220.30663024096253, -938.7025823232221, -454.97373724404116, -876.301743480452, -1188.8503649869797, -851.1433393848779, -1032.359815235361, -447.48829085691335, -959.3932789354418, -391.06138363720925, -1084.6084689424795, -918.3773751453577, -943.0869312171349, -809.0200620597535, -228.88731701602856, -878.2055163201253, -1305.3386083638482, -636.0689765041859, -1193.6354951203268, -904.9466939011087, -538.8335933774574, -502.92993878332703, -1052.1143559413854, -999.0709941265023, -590.1968603464303, -974.1345432912519, -531.105803481482, -786.2416199468062, -691.4916428021326, -542.1765999410206, -366.9696238484576, -829.1331878977605, -540.8695748752215, -929.1968602635834, -113.60647798906918, -606.2829433250627, -934.6023182312102, -678.9604205516056, -449.3646595720488, -216.87646567875134, -53.687855815570806, -104.37922675453811, -959.5871728708096, -63.51795594182768, -984.3165886165118, -603.1663740085717, -938.8627118352614, -623.5432259826586, -520.0631159115375, -278.6029387917781, -1033.4665878416326, -1197.684935802598, -959.6804646335947, -852.6532823729881, -157.60782271682095, -880.1282452942838, -459.74788897435894, -934.6648992447562, -635.2118068010537, -162.8164477778533, -749.3997697525039, -793.7498952688754, -297.5016628937285, -457.2766878336326, -258.58354984580814, -603.1973927873717, -1060.8197400210654, -333.4375482143006, -52.33514474788466, -818.6727141578176, -725.1747429679938, -214.20487110411293, -593.9185759114581, -1026.5766384832682, -521.5382679723405, -570.3291774544903, -152.7304324772702, -565.9037340823099, -1231.6115282409405, -479.6602086573079, -633.0225662934015, -666.5870084920577, -817.3147839293864, -405.1411435239102, -570.7126944919364, -500.2751794611328, -761.7672738811909, -1076.7724075684312, -701.3160010210498, -1052.877972582393, -553.0404815738771, -919.0845091856851, -1068.650355543394]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30032855501838546, "mean_inference_ms": 0.9313413399197324, "mean_action_processing_ms": 0.16672584081668787, "mean_env_wait_ms": 1.69881381515428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005369663238525391, "StateBufferConnector_ms": 0.004031658172607422, "ViewRequirementAgentConnector_ms": 0.10207176208496094}, "num_episodes": 30, "episode_return_max": -44.6908125264781, "episode_return_min": -1305.3386083638482, "episode_return_mean": -661.4867823445804, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.0267955785613, "num_env_steps_trained_throughput_per_sec": 294.0267955785613, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 13615.474, "restore_workers_time_ms": 0.023, "training_step_time_ms": 13615.405, "sample_time_ms": 2725.45, "learn_time_ms": 10873.157, "learn_throughput": 367.878, "synch_weights_time_ms": 15.578}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "training_iteration": 58, "trial_id": "6d52d_00000", "date": "2024-07-26_22-57-06", "timestamp": 1722014826, "time_this_iter_s": 13.612308263778687, "time_total_s": 781.1725671291351, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c312680>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 781.1725671291351, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 10.000000000000002, "ram_util_percent": 28.620000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 180.6290944159031, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.935665652404229, "policy_loss": -0.012307181731254483, "vf_loss": 3.9543474817027646, "vf_explained_var": 0.9794732470686237, "kl": 0.012395492003755292, "entropy": 1.474159778530399, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 56160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "env_runners": {"episode_reward_max": -21.078853747503704, "episode_reward_min": -1259.1708030269058, "episode_reward_mean": -593.8318189433402, "episode_len_mean": 127.91, "episode_media": {}, "episodes_timesteps_total": 12791, "policy_reward_min": {"policy_0": -1259.1708030269058}, "policy_reward_max": {"policy_0": -21.078853747503704}, "policy_reward_mean": {"policy_0": -593.8318189433402}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-531.105803481482, -786.2416199468062, -691.4916428021326, -542.1765999410206, -366.9696238484576, -829.1331878977605, -540.8695748752215, -929.1968602635834, -113.60647798906918, -606.2829433250627, -934.6023182312102, -678.9604205516056, -449.3646595720488, -216.87646567875134, -53.687855815570806, -104.37922675453811, -959.5871728708096, -63.51795594182768, -984.3165886165118, -603.1663740085717, -938.8627118352614, -623.5432259826586, -520.0631159115375, -278.6029387917781, -1033.4665878416326, -1197.684935802598, -959.6804646335947, -852.6532823729881, -157.60782271682095, -880.1282452942838, -459.74788897435894, -934.6648992447562, -635.2118068010537, -162.8164477778533, -749.3997697525039, -793.7498952688754, -297.5016628937285, -457.2766878336326, -258.58354984580814, -603.1973927873717, -1060.8197400210654, -333.4375482143006, -52.33514474788466, -818.6727141578176, -725.1747429679938, -214.20487110411293, -593.9185759114581, -1026.5766384832682, -521.5382679723405, -570.3291774544903, -152.7304324772702, -565.9037340823099, -1231.6115282409405, -479.6602086573079, -633.0225662934015, -666.5870084920577, -817.3147839293864, -405.1411435239102, -570.7126944919364, -500.2751794611328, -761.7672738811909, -1076.7724075684312, -701.3160010210498, -1052.877972582393, -553.0404815738771, -919.0845091856851, -1068.650355543394, -1259.1708030269058, -276.6489948090985, -92.51264292613628, -57.75527764769251, -499.36736021023614, -317.9408589420658, -596.7018188466184, -879.9188291122996, -607.0989193113071, -1103.4119509745708, -939.1602848365286, -1172.3437024087925, -661.5784641334297, -312.77226435231296, -142.6012386407187, -115.37854163442911, -103.13044695065011, -393.85000117885335, -710.952925077289, -1055.6724574729315, -938.4831146589052, -468.83158233827464, -120.32689528440069, -579.289853675723, -21.078853747503704, -968.9620678481705, -103.03241004896974, -1114.5562888958386, -39.177332017174294, -192.67070219371772, -394.69053785852407, -987.3383327358395, -303.3237337225669], "episode_lengths": [132, 150, 150, 150, 136, 150, 111, 150, 73, 150, 150, 150, 108, 134, 63, 90, 150, 58, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 63, 150, 150, 150, 150, 87, 150, 150, 89, 150, 89, 150, 150, 116, 48, 140, 150, 85, 150, 150, 122, 150, 81, 124, 150, 150, 150, 150, 150, 114, 150, 141, 150, 150, 150, 150, 150, 150, 150, 150, 97, 61, 76, 150, 109, 150, 150, 117, 150, 150, 150, 123, 103, 69, 80, 73, 150, 150, 150, 150, 150, 53, 150, 40, 150, 82, 150, 41, 77, 150, 150, 86], "policy_policy_0_reward": [-531.105803481482, -786.2416199468062, -691.4916428021326, -542.1765999410206, -366.9696238484576, -829.1331878977605, -540.8695748752215, -929.1968602635834, -113.60647798906918, -606.2829433250627, -934.6023182312102, -678.9604205516056, -449.3646595720488, -216.87646567875134, -53.687855815570806, -104.37922675453811, -959.5871728708096, -63.51795594182768, -984.3165886165118, -603.1663740085717, -938.8627118352614, -623.5432259826586, -520.0631159115375, -278.6029387917781, -1033.4665878416326, -1197.684935802598, -959.6804646335947, -852.6532823729881, -157.60782271682095, -880.1282452942838, -459.74788897435894, -934.6648992447562, -635.2118068010537, -162.8164477778533, -749.3997697525039, -793.7498952688754, -297.5016628937285, -457.2766878336326, -258.58354984580814, -603.1973927873717, -1060.8197400210654, -333.4375482143006, -52.33514474788466, -818.6727141578176, -725.1747429679938, -214.20487110411293, -593.9185759114581, -1026.5766384832682, -521.5382679723405, -570.3291774544903, -152.7304324772702, -565.9037340823099, -1231.6115282409405, -479.6602086573079, -633.0225662934015, -666.5870084920577, -817.3147839293864, -405.1411435239102, -570.7126944919364, -500.2751794611328, -761.7672738811909, -1076.7724075684312, -701.3160010210498, -1052.877972582393, -553.0404815738771, -919.0845091856851, -1068.650355543394, -1259.1708030269058, -276.6489948090985, -92.51264292613628, -57.75527764769251, -499.36736021023614, -317.9408589420658, -596.7018188466184, -879.9188291122996, -607.0989193113071, -1103.4119509745708, -939.1602848365286, -1172.3437024087925, -661.5784641334297, -312.77226435231296, -142.6012386407187, -115.37854163442911, -103.13044695065011, -393.85000117885335, -710.952925077289, -1055.6724574729315, -938.4831146589052, -468.83158233827464, -120.32689528440069, -579.289853675723, -21.078853747503704, -968.9620678481705, -103.03241004896974, -1114.5562888958386, -39.177332017174294, -192.67070219371772, -394.69053785852407, -987.3383327358395, -303.3237337225669]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3000416614174778, "mean_inference_ms": 0.9306835570960112, "mean_action_processing_ms": 0.16662224697021497, "mean_env_wait_ms": 1.6945425100553455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005659580230712891, "StateBufferConnector_ms": 0.0040242671966552734, "ViewRequirementAgentConnector_ms": 0.10207772254943848}, "num_episodes": 33, "episode_return_max": -21.078853747503704, "episode_return_min": -1259.1708030269058, "episode_return_mean": -593.8318189433402, "episodes_this_iter": 33}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 280.62908144294045, "num_env_steps_trained_throughput_per_sec": 280.62908144294045, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 236000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 236000, "timers": {"training_iteration_time_ms": 13713.524, "restore_workers_time_ms": 0.022, "training_step_time_ms": 13713.456, "sample_time_ms": 2737.877, "learn_time_ms": 10958.635, "learn_throughput": 365.009, "synch_weights_time_ms": 15.677}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "done": false, "training_iteration": 59, "trial_id": "6d52d_00000", "date": "2024-07-26_22-57-21", "timestamp": 1722014841, "time_this_iter_s": 14.260346412658691, "time_total_s": 795.4329135417938, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c3d9cf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 795.4329135417938, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 10.145, "ram_util_percent": 28.635}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 225.47534304062526, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.5532314203679563, "policy_loss": -0.01543670125004913, "vf_loss": 3.5735069046417873, "vf_explained_var": 0.9865317190686862, "kl": 0.015581528356506237, "entropy": 1.5356305191914241, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 57120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": -21.078853747503704, "episode_reward_min": -1259.1708030269058, "episode_reward_mean": -641.9819107889103, "episode_len_mean": 131.03, "episode_media": {}, "episodes_timesteps_total": 13103, "policy_reward_min": {"policy_0": -1259.1708030269058}, "policy_reward_max": {"policy_0": -21.078853747503704}, "policy_reward_mean": {"policy_0": -641.9819107889103}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-459.74788897435894, -934.6648992447562, -635.2118068010537, -162.8164477778533, -749.3997697525039, -793.7498952688754, -297.5016628937285, -457.2766878336326, -258.58354984580814, -603.1973927873717, -1060.8197400210654, -333.4375482143006, -52.33514474788466, -818.6727141578176, -725.1747429679938, -214.20487110411293, -593.9185759114581, -1026.5766384832682, -521.5382679723405, -570.3291774544903, -152.7304324772702, -565.9037340823099, -1231.6115282409405, -479.6602086573079, -633.0225662934015, -666.5870084920577, -817.3147839293864, -405.1411435239102, -570.7126944919364, -500.2751794611328, -761.7672738811909, -1076.7724075684312, -701.3160010210498, -1052.877972582393, -553.0404815738771, -919.0845091856851, -1068.650355543394, -1259.1708030269058, -276.6489948090985, -92.51264292613628, -57.75527764769251, -499.36736021023614, -317.9408589420658, -596.7018188466184, -879.9188291122996, -607.0989193113071, -1103.4119509745708, -939.1602848365286, -1172.3437024087925, -661.5784641334297, -312.77226435231296, -142.6012386407187, -115.37854163442911, -103.13044695065011, -393.85000117885335, -710.952925077289, -1055.6724574729315, -938.4831146589052, -468.83158233827464, -120.32689528440069, -579.289853675723, -21.078853747503704, -968.9620678481705, -103.03241004896974, -1114.5562888958386, -39.177332017174294, -192.67070219371772, -394.69053785852407, -987.3383327358395, -303.3237337225669, -397.3868857367801, -402.2001869849263, -407.5442411527426, -225.43049829521914, -574.4970679656367, -245.83650002478112, -817.2367684508779, -1234.267975631224, -377.00650989188426, -904.8522028614226, -1243.4851834559947, -1187.291252784214, -528.5265547633778, -402.96380164906185, -747.5836868583359, -1073.184085582998, -1107.7115674686713, -919.956722070411, -612.7369550451672, -1086.6797199704076, -1137.211843347399, -1178.1240682480093, -636.2498428439575, -759.7896249834931, -1098.2947949626277, -511.6487323082932, -1089.377785029111, -887.4383493923739, -785.573165541091, -662.7493148517149], "episode_lengths": [150, 150, 150, 87, 150, 150, 89, 150, 89, 150, 150, 116, 48, 140, 150, 85, 150, 150, 122, 150, 81, 124, 150, 150, 150, 150, 150, 114, 150, 141, 150, 150, 150, 150, 150, 150, 150, 150, 97, 61, 76, 150, 109, 150, 150, 117, 150, 150, 150, 123, 103, 69, 80, 73, 150, 150, 150, 150, 150, 53, 150, 40, 150, 82, 150, 41, 77, 150, 150, 86, 150, 150, 115, 78, 150, 106, 150, 150, 150, 150, 150, 150, 120, 111, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-459.74788897435894, -934.6648992447562, -635.2118068010537, -162.8164477778533, -749.3997697525039, -793.7498952688754, -297.5016628937285, -457.2766878336326, -258.58354984580814, -603.1973927873717, -1060.8197400210654, -333.4375482143006, -52.33514474788466, -818.6727141578176, -725.1747429679938, -214.20487110411293, -593.9185759114581, -1026.5766384832682, -521.5382679723405, -570.3291774544903, -152.7304324772702, -565.9037340823099, -1231.6115282409405, -479.6602086573079, -633.0225662934015, -666.5870084920577, -817.3147839293864, -405.1411435239102, -570.7126944919364, -500.2751794611328, -761.7672738811909, -1076.7724075684312, -701.3160010210498, -1052.877972582393, -553.0404815738771, -919.0845091856851, -1068.650355543394, -1259.1708030269058, -276.6489948090985, -92.51264292613628, -57.75527764769251, -499.36736021023614, -317.9408589420658, -596.7018188466184, -879.9188291122996, -607.0989193113071, -1103.4119509745708, -939.1602848365286, -1172.3437024087925, -661.5784641334297, -312.77226435231296, -142.6012386407187, -115.37854163442911, -103.13044695065011, -393.85000117885335, -710.952925077289, -1055.6724574729315, -938.4831146589052, -468.83158233827464, -120.32689528440069, -579.289853675723, -21.078853747503704, -968.9620678481705, -103.03241004896974, -1114.5562888958386, -39.177332017174294, -192.67070219371772, -394.69053785852407, -987.3383327358395, -303.3237337225669, -397.3868857367801, -402.2001869849263, -407.5442411527426, -225.43049829521914, -574.4970679656367, -245.83650002478112, -817.2367684508779, -1234.267975631224, -377.00650989188426, -904.8522028614226, -1243.4851834559947, -1187.291252784214, -528.5265547633778, -402.96380164906185, -747.5836868583359, -1073.184085582998, -1107.7115674686713, -919.956722070411, -612.7369550451672, -1086.6797199704076, -1137.211843347399, -1178.1240682480093, -636.2498428439575, -759.7896249834931, -1098.2947949626277, -511.6487323082932, -1089.377785029111, -887.4383493923739, -785.573165541091, -662.7493148517149]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2999334425635573, "mean_inference_ms": 0.9301935631680646, "mean_action_processing_ms": 0.16652113580518865, "mean_env_wait_ms": 1.6940868868887446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005865573883056641, "StateBufferConnector_ms": 0.004027843475341797, "ViewRequirementAgentConnector_ms": 0.1026773452758789}, "num_episodes": 30, "episode_return_max": -21.078853747503704, "episode_return_min": -1259.1708030269058, "episode_return_mean": -641.9819107889103, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 279.0848981066287, "num_env_steps_trained_throughput_per_sec": 279.0848981066287, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 13879.65, "restore_workers_time_ms": 0.023, "training_step_time_ms": 13879.579, "sample_time_ms": 2732.973, "learn_time_ms": 11130.375, "learn_throughput": 359.377, "synch_weights_time_ms": 14.982}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 60, "trial_id": "6d52d_00000", "date": "2024-07-26_22-57-35", "timestamp": 1722014855, "time_this_iter_s": 14.338864803314209, "time_total_s": 809.771778345108, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c3d9990>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 809.771778345108, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 10.235000000000001, "ram_util_percent": 28.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 199.43963830073673, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.087428738673528, "policy_loss": -0.004817652118314679, "vf_loss": 4.093384990344445, "vf_explained_var": 0.9770196037987868, "kl": 0.0207019088456643, "entropy": 1.5112413403888543, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 58080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "env_runners": {"episode_reward_max": -21.078853747503704, "episode_reward_min": -1259.1708030269058, "episode_reward_mean": -641.3693194523908, "episode_len_mean": 129.55, "episode_media": {}, "episodes_timesteps_total": 12955, "policy_reward_min": {"policy_0": -1259.1708030269058}, "policy_reward_max": {"policy_0": -21.078853747503704}, "policy_reward_mean": {"policy_0": -641.3693194523908}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-761.7672738811909, -1076.7724075684312, -701.3160010210498, -1052.877972582393, -553.0404815738771, -919.0845091856851, -1068.650355543394, -1259.1708030269058, -276.6489948090985, -92.51264292613628, -57.75527764769251, -499.36736021023614, -317.9408589420658, -596.7018188466184, -879.9188291122996, -607.0989193113071, -1103.4119509745708, -939.1602848365286, -1172.3437024087925, -661.5784641334297, -312.77226435231296, -142.6012386407187, -115.37854163442911, -103.13044695065011, -393.85000117885335, -710.952925077289, -1055.6724574729315, -938.4831146589052, -468.83158233827464, -120.32689528440069, -579.289853675723, -21.078853747503704, -968.9620678481705, -103.03241004896974, -1114.5562888958386, -39.177332017174294, -192.67070219371772, -394.69053785852407, -987.3383327358395, -303.3237337225669, -397.3868857367801, -402.2001869849263, -407.5442411527426, -225.43049829521914, -574.4970679656367, -245.83650002478112, -817.2367684508779, -1234.267975631224, -377.00650989188426, -904.8522028614226, -1243.4851834559947, -1187.291252784214, -528.5265547633778, -402.96380164906185, -747.5836868583359, -1073.184085582998, -1107.7115674686713, -919.956722070411, -612.7369550451672, -1086.6797199704076, -1137.211843347399, -1178.1240682480093, -636.2498428439575, -759.7896249834931, -1098.2947949626277, -511.6487323082932, -1089.377785029111, -887.4383493923739, -785.573165541091, -662.7493148517149, -612.4879593249752, -276.567448090064, -522.3498037108143, -704.9855708250108, -120.62459390726653, -619.4327055273125, -158.44187142888393, -1034.3059523607476, -151.4780821241654, -361.55512717053347, -315.8114264851223, -922.457591057442, -149.48695711596062, -778.701356432601, -1201.4829118057798, -645.2873911241923, -878.9649071624528, -222.66277506979262, -319.1830514229825, -726.1175177111385, -808.525282168692, -324.2039360567221, -1063.112968391608, -828.8687407946832, -1152.8166682972378, -409.19855473303073, -325.68046794202564, -1216.2692171008118, -329.24250750299933, -50.55422536732732], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 97, 61, 76, 150, 109, 150, 150, 117, 150, 150, 150, 123, 103, 69, 80, 73, 150, 150, 150, 150, 150, 53, 150, 40, 150, 82, 150, 41, 77, 150, 150, 86, 150, 150, 115, 78, 150, 106, 150, 150, 150, 150, 150, 150, 120, 111, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 87, 150, 150, 67, 150, 91, 150, 73, 124, 99, 150, 94, 150, 150, 150, 150, 84, 126, 150, 150, 121, 150, 150, 150, 102, 133, 150, 132, 55], "policy_policy_0_reward": [-761.7672738811909, -1076.7724075684312, -701.3160010210498, -1052.877972582393, -553.0404815738771, -919.0845091856851, -1068.650355543394, -1259.1708030269058, -276.6489948090985, -92.51264292613628, -57.75527764769251, -499.36736021023614, -317.9408589420658, -596.7018188466184, -879.9188291122996, -607.0989193113071, -1103.4119509745708, -939.1602848365286, -1172.3437024087925, -661.5784641334297, -312.77226435231296, -142.6012386407187, -115.37854163442911, -103.13044695065011, -393.85000117885335, -710.952925077289, -1055.6724574729315, -938.4831146589052, -468.83158233827464, -120.32689528440069, -579.289853675723, -21.078853747503704, -968.9620678481705, -103.03241004896974, -1114.5562888958386, -39.177332017174294, -192.67070219371772, -394.69053785852407, -987.3383327358395, -303.3237337225669, -397.3868857367801, -402.2001869849263, -407.5442411527426, -225.43049829521914, -574.4970679656367, -245.83650002478112, -817.2367684508779, -1234.267975631224, -377.00650989188426, -904.8522028614226, -1243.4851834559947, -1187.291252784214, -528.5265547633778, -402.96380164906185, -747.5836868583359, -1073.184085582998, -1107.7115674686713, -919.956722070411, -612.7369550451672, -1086.6797199704076, -1137.211843347399, -1178.1240682480093, -636.2498428439575, -759.7896249834931, -1098.2947949626277, -511.6487323082932, -1089.377785029111, -887.4383493923739, -785.573165541091, -662.7493148517149, -612.4879593249752, -276.567448090064, -522.3498037108143, -704.9855708250108, -120.62459390726653, -619.4327055273125, -158.44187142888393, -1034.3059523607476, -151.4780821241654, -361.55512717053347, -315.8114264851223, -922.457591057442, -149.48695711596062, -778.701356432601, -1201.4829118057798, -645.2873911241923, -878.9649071624528, -222.66277506979262, -319.1830514229825, -726.1175177111385, -808.525282168692, -324.2039360567221, -1063.112968391608, -828.8687407946832, -1152.8166682972378, -409.19855473303073, -325.68046794202564, -1216.2692171008118, -329.24250750299933, -50.55422536732732]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29986065677412194, "mean_inference_ms": 0.9299609038015194, "mean_action_processing_ms": 0.16650918967892994, "mean_env_wait_ms": 1.694101267578299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056915283203125, "StateBufferConnector_ms": 0.004057168960571289, "ViewRequirementAgentConnector_ms": 0.10333728790283203}, "num_episodes": 30, "episode_return_max": -21.078853747503704, "episode_return_min": -1259.1708030269058, "episode_return_mean": -641.3693194523908, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 282.9660286933338, "num_env_steps_trained_throughput_per_sec": 282.9660286933338, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 244000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 244000, "timers": {"training_iteration_time_ms": 13897.662, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13897.587, "sample_time_ms": 2740.953, "learn_time_ms": 11140.349, "learn_throughput": 359.055, "synch_weights_time_ms": 15.024}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "done": false, "training_iteration": 61, "trial_id": "6d52d_00000", "date": "2024-07-26_22-57-49", "timestamp": 1722014869, "time_this_iter_s": 14.142533779144287, "time_total_s": 823.9143121242523, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d1254728ca0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 823.9143121242523, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 9.942857142857141, "ram_util_percent": 28.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 270.37897793650626, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 3.3655732138703267, "policy_loss": -0.010800379010712883, "vf_loss": 3.38153384650747, "vf_explained_var": 0.9795620309809844, "kl": 0.010524198195647289, "entropy": 1.5816004841277997, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 59040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "env_runners": {"episode_reward_max": -21.078853747503704, "episode_reward_min": -1243.4851834559947, "episode_reward_mean": -664.0763074970247, "episode_len_mean": 131.02, "episode_media": {}, "episodes_timesteps_total": 13102, "policy_reward_min": {"policy_0": -1243.4851834559947}, "policy_reward_max": {"policy_0": -21.078853747503704}, "policy_reward_mean": {"policy_0": -664.0763074970247}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-120.32689528440069, -579.289853675723, -21.078853747503704, -968.9620678481705, -103.03241004896974, -1114.5562888958386, -39.177332017174294, -192.67070219371772, -394.69053785852407, -987.3383327358395, -303.3237337225669, -397.3868857367801, -402.2001869849263, -407.5442411527426, -225.43049829521914, -574.4970679656367, -245.83650002478112, -817.2367684508779, -1234.267975631224, -377.00650989188426, -904.8522028614226, -1243.4851834559947, -1187.291252784214, -528.5265547633778, -402.96380164906185, -747.5836868583359, -1073.184085582998, -1107.7115674686713, -919.956722070411, -612.7369550451672, -1086.6797199704076, -1137.211843347399, -1178.1240682480093, -636.2498428439575, -759.7896249834931, -1098.2947949626277, -511.6487323082932, -1089.377785029111, -887.4383493923739, -785.573165541091, -662.7493148517149, -612.4879593249752, -276.567448090064, -522.3498037108143, -704.9855708250108, -120.62459390726653, -619.4327055273125, -158.44187142888393, -1034.3059523607476, -151.4780821241654, -361.55512717053347, -315.8114264851223, -922.457591057442, -149.48695711596062, -778.701356432601, -1201.4829118057798, -645.2873911241923, -878.9649071624528, -222.66277506979262, -319.1830514229825, -726.1175177111385, -808.525282168692, -324.2039360567221, -1063.112968391608, -828.8687407946832, -1152.8166682972378, -409.19855473303073, -325.68046794202564, -1216.2692171008118, -329.24250750299933, -50.55422536732732, -1109.3052183097452, -869.8475726532417, -998.2552876111135, -907.22119950058, -966.0183376339453, -599.0790717382318, -95.56985453610592, -746.027530763987, -180.4329142131434, -876.8773884316693, -1051.9115085637752, -1008.6591590090665, -1142.2707679227374, -601.665749801828, -607.5537638065844, -828.0918957829542, -97.5076708301397, -670.3859878376425, -1098.565439766719, -976.6456274105788, -973.947062778394, -826.0081712483194, -1037.315541533512, -530.659964030897, -244.80682724312473, -276.8059396406604, -345.41115236615065, -710.5594593382178, -732.0842210063961], "episode_lengths": [53, 150, 40, 150, 82, 150, 41, 77, 150, 150, 86, 150, 150, 115, 78, 150, 106, 150, 150, 150, 150, 150, 150, 120, 111, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 87, 150, 150, 67, 150, 91, 150, 73, 124, 99, 150, 94, 150, 150, 150, 150, 84, 126, 150, 150, 121, 150, 150, 150, 102, 133, 150, 132, 55, 150, 150, 150, 150, 150, 150, 52, 150, 86, 150, 150, 150, 150, 136, 150, 150, 47, 150, 150, 150, 150, 150, 150, 150, 93, 82, 109, 150, 150], "policy_policy_0_reward": [-120.32689528440069, -579.289853675723, -21.078853747503704, -968.9620678481705, -103.03241004896974, -1114.5562888958386, -39.177332017174294, -192.67070219371772, -394.69053785852407, -987.3383327358395, -303.3237337225669, -397.3868857367801, -402.2001869849263, -407.5442411527426, -225.43049829521914, -574.4970679656367, -245.83650002478112, -817.2367684508779, -1234.267975631224, -377.00650989188426, -904.8522028614226, -1243.4851834559947, -1187.291252784214, -528.5265547633778, -402.96380164906185, -747.5836868583359, -1073.184085582998, -1107.7115674686713, -919.956722070411, -612.7369550451672, -1086.6797199704076, -1137.211843347399, -1178.1240682480093, -636.2498428439575, -759.7896249834931, -1098.2947949626277, -511.6487323082932, -1089.377785029111, -887.4383493923739, -785.573165541091, -662.7493148517149, -612.4879593249752, -276.567448090064, -522.3498037108143, -704.9855708250108, -120.62459390726653, -619.4327055273125, -158.44187142888393, -1034.3059523607476, -151.4780821241654, -361.55512717053347, -315.8114264851223, -922.457591057442, -149.48695711596062, -778.701356432601, -1201.4829118057798, -645.2873911241923, -878.9649071624528, -222.66277506979262, -319.1830514229825, -726.1175177111385, -808.525282168692, -324.2039360567221, -1063.112968391608, -828.8687407946832, -1152.8166682972378, -409.19855473303073, -325.68046794202564, -1216.2692171008118, -329.24250750299933, -50.55422536732732, -1109.3052183097452, -869.8475726532417, -998.2552876111135, -907.22119950058, -966.0183376339453, -599.0790717382318, -95.56985453610592, -746.027530763987, -180.4329142131434, -876.8773884316693, -1051.9115085637752, -1008.6591590090665, -1142.2707679227374, -601.665749801828, -607.5537638065844, -828.0918957829542, -97.5076708301397, -670.3859878376425, -1098.565439766719, -976.6456274105788, -973.947062778394, -826.0081712483194, -1037.315541533512, -530.659964030897, -244.80682724312473, -276.8059396406604, -345.41115236615065, -710.5594593382178, -732.0842210063961]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29984408325052536, "mean_inference_ms": 0.9298352414048572, "mean_action_processing_ms": 0.16658674108759133, "mean_env_wait_ms": 1.696151535714459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005563497543334961, "StateBufferConnector_ms": 0.004031658172607422, "ViewRequirementAgentConnector_ms": 0.10223054885864258}, "num_episodes": 29, "episode_return_max": -21.078853747503704, "episode_return_min": -1243.4851834559947, "episode_return_mean": -664.0763074970247, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.91571776840084, "num_env_steps_trained_throughput_per_sec": 297.91571776840084, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 13781.426, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13781.35, "sample_time_ms": 2634.91, "learn_time_ms": 11130.187, "learn_throughput": 359.383, "synch_weights_time_ms": 14.993}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "done": false, "training_iteration": 62, "trial_id": "6d52d_00000", "date": "2024-07-26_22-58-03", "timestamp": 1722014883, "time_this_iter_s": 13.431684017181396, "time_total_s": 837.3459961414337, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d12547289d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 837.3459961414337, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 10.557894736842107, "ram_util_percent": 28.605263157894743}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 204.94196552236875, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 3.9853228318194547, "policy_loss": -0.01791078607008482, "vf_loss": 4.010080844412247, "vf_explained_var": 0.9812447162345052, "kl": 0.009624024775212148, "entropy": 1.6591550605992476, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "env_runners": {"episode_reward_max": -6.262349108526059, "episode_reward_min": -1245.6997899092426, "episode_reward_mean": -673.4895909542175, "episode_len_mean": 131.48, "episode_media": {}, "episodes_timesteps_total": 13148, "policy_reward_min": {"policy_0": -1245.6997899092426}, "policy_reward_max": {"policy_0": -6.262349108526059}, "policy_reward_mean": {"policy_0": -673.4895909542175}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1178.1240682480093, -636.2498428439575, -759.7896249834931, -1098.2947949626277, -511.6487323082932, -1089.377785029111, -887.4383493923739, -785.573165541091, -662.7493148517149, -612.4879593249752, -276.567448090064, -522.3498037108143, -704.9855708250108, -120.62459390726653, -619.4327055273125, -158.44187142888393, -1034.3059523607476, -151.4780821241654, -361.55512717053347, -315.8114264851223, -922.457591057442, -149.48695711596062, -778.701356432601, -1201.4829118057798, -645.2873911241923, -878.9649071624528, -222.66277506979262, -319.1830514229825, -726.1175177111385, -808.525282168692, -324.2039360567221, -1063.112968391608, -828.8687407946832, -1152.8166682972378, -409.19855473303073, -325.68046794202564, -1216.2692171008118, -329.24250750299933, -50.55422536732732, -1109.3052183097452, -869.8475726532417, -998.2552876111135, -907.22119950058, -966.0183376339453, -599.0790717382318, -95.56985453610592, -746.027530763987, -180.4329142131434, -876.8773884316693, -1051.9115085637752, -1008.6591590090665, -1142.2707679227374, -601.665749801828, -607.5537638065844, -828.0918957829542, -97.5076708301397, -670.3859878376425, -1098.565439766719, -976.6456274105788, -973.947062778394, -826.0081712483194, -1037.315541533512, -530.659964030897, -244.80682724312473, -276.8059396406604, -345.41115236615065, -710.5594593382178, -732.0842210063961, -916.4627029574054, -1070.2200077207215, -974.8458494250993, -679.7895901356835, -600.6599808816094, -413.05343572392906, -1017.689353950155, -1076.6922258395227, -942.6532307626289, -221.96329436242186, -40.061620790176015, -266.5207744401612, -1057.4917279963697, -184.2270354611441, -482.30234614650726, -890.5358319048776, -1143.2689606561657, -861.0233193751177, -104.76956141926928, -809.1904877097131, -986.5445766682799, -741.4914763964845, -6.262349108526059, -938.7057375660979, -1245.6997899092426, -1088.526097334132, -111.02562383127412, -476.9606846240591, -271.6943745848134, -686.3141616359412, -130.86977140250877, -961.8495830192268], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 87, 150, 150, 67, 150, 91, 150, 73, 124, 99, 150, 94, 150, 150, 150, 150, 84, 126, 150, 150, 121, 150, 150, 150, 102, 133, 150, 132, 55, 150, 150, 150, 150, 150, 150, 52, 150, 86, 150, 150, 150, 150, 136, 150, 150, 47, 150, 150, 150, 150, 150, 150, 150, 93, 82, 109, 150, 150, 150, 150, 150, 150, 141, 150, 150, 150, 150, 121, 51, 105, 150, 65, 150, 150, 150, 150, 69, 150, 150, 139, 42, 150, 150, 150, 50, 119, 94, 150, 109, 150], "policy_policy_0_reward": [-1178.1240682480093, -636.2498428439575, -759.7896249834931, -1098.2947949626277, -511.6487323082932, -1089.377785029111, -887.4383493923739, -785.573165541091, -662.7493148517149, -612.4879593249752, -276.567448090064, -522.3498037108143, -704.9855708250108, -120.62459390726653, -619.4327055273125, -158.44187142888393, -1034.3059523607476, -151.4780821241654, -361.55512717053347, -315.8114264851223, -922.457591057442, -149.48695711596062, -778.701356432601, -1201.4829118057798, -645.2873911241923, -878.9649071624528, -222.66277506979262, -319.1830514229825, -726.1175177111385, -808.525282168692, -324.2039360567221, -1063.112968391608, -828.8687407946832, -1152.8166682972378, -409.19855473303073, -325.68046794202564, -1216.2692171008118, -329.24250750299933, -50.55422536732732, -1109.3052183097452, -869.8475726532417, -998.2552876111135, -907.22119950058, -966.0183376339453, -599.0790717382318, -95.56985453610592, -746.027530763987, -180.4329142131434, -876.8773884316693, -1051.9115085637752, -1008.6591590090665, -1142.2707679227374, -601.665749801828, -607.5537638065844, -828.0918957829542, -97.5076708301397, -670.3859878376425, -1098.565439766719, -976.6456274105788, -973.947062778394, -826.0081712483194, -1037.315541533512, -530.659964030897, -244.80682724312473, -276.8059396406604, -345.41115236615065, -710.5594593382178, -732.0842210063961, -916.4627029574054, -1070.2200077207215, -974.8458494250993, -679.7895901356835, -600.6599808816094, -413.05343572392906, -1017.689353950155, -1076.6922258395227, -942.6532307626289, -221.96329436242186, -40.061620790176015, -266.5207744401612, -1057.4917279963697, -184.2270354611441, -482.30234614650726, -890.5358319048776, -1143.2689606561657, -861.0233193751177, -104.76956141926928, -809.1904877097131, -986.5445766682799, -741.4914763964845, -6.262349108526059, -938.7057375660979, -1245.6997899092426, -1088.526097334132, -111.02562383127412, -476.9606846240591, -271.6943745848134, -686.3141616359412, -130.86977140250877, -961.8495830192268]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29978106615065364, "mean_inference_ms": 0.9293997900756662, "mean_action_processing_ms": 0.1665967967721127, "mean_env_wait_ms": 1.6961587623547418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005323648452758789, "StateBufferConnector_ms": 0.003973960876464844, "ViewRequirementAgentConnector_ms": 0.10099077224731445}, "num_episodes": 32, "episode_return_max": -6.262349108526059, "episode_return_min": -1245.6997899092426, "episode_return_mean": -673.4895909542175, "episodes_this_iter": 32}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 360.3356660598864, "num_env_steps_trained_throughput_per_sec": 360.3356660598864, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 252000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 13392.462, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13392.386, "sample_time_ms": 2603.567, "learn_time_ms": 10772.575, "learn_throughput": 371.313, "synch_weights_time_ms": 15.007}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "training_iteration": 63, "trial_id": "6d52d_00000", "date": "2024-07-26_22-58-14", "timestamp": 1722014894, "time_this_iter_s": 11.10750961303711, "time_total_s": 848.4535057544708, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125472a560>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 848.4535057544708, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 10.4875, "ram_util_percent": 28.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 171.34404899676642, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 4.064526215692362, "policy_loss": -0.010648785876886299, "vf_loss": 4.077481932441393, "vf_explained_var": 0.9704748790711164, "kl": 0.010029708074459192, "entropy": 1.2462012315789859, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": -6.262349108526059, "episode_reward_min": -1245.6997899092426, "episode_reward_mean": -669.2324782854998, "episode_len_mean": 132.34, "episode_media": {}, "episodes_timesteps_total": 13234, "policy_reward_min": {"policy_0": -1245.6997899092426}, "policy_reward_max": {"policy_0": -6.262349108526059}, "policy_reward_mean": {"policy_0": -669.2324782854998}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-808.525282168692, -324.2039360567221, -1063.112968391608, -828.8687407946832, -1152.8166682972378, -409.19855473303073, -325.68046794202564, -1216.2692171008118, -329.24250750299933, -50.55422536732732, -1109.3052183097452, -869.8475726532417, -998.2552876111135, -907.22119950058, -966.0183376339453, -599.0790717382318, -95.56985453610592, -746.027530763987, -180.4329142131434, -876.8773884316693, -1051.9115085637752, -1008.6591590090665, -1142.2707679227374, -601.665749801828, -607.5537638065844, -828.0918957829542, -97.5076708301397, -670.3859878376425, -1098.565439766719, -976.6456274105788, -973.947062778394, -826.0081712483194, -1037.315541533512, -530.659964030897, -244.80682724312473, -276.8059396406604, -345.41115236615065, -710.5594593382178, -732.0842210063961, -916.4627029574054, -1070.2200077207215, -974.8458494250993, -679.7895901356835, -600.6599808816094, -413.05343572392906, -1017.689353950155, -1076.6922258395227, -942.6532307626289, -221.96329436242186, -40.061620790176015, -266.5207744401612, -1057.4917279963697, -184.2270354611441, -482.30234614650726, -890.5358319048776, -1143.2689606561657, -861.0233193751177, -104.76956141926928, -809.1904877097131, -986.5445766682799, -741.4914763964845, -6.262349108526059, -938.7057375660979, -1245.6997899092426, -1088.526097334132, -111.02562383127412, -476.9606846240591, -271.6943745848134, -686.3141616359412, -130.86977140250877, -961.8495830192268, -195.7934999292342, -352.3262660195173, -530.7713368844453, -166.34800438051917, -663.3571575249672, -498.5081263185684, -703.8297233501033, -1179.3546246190608, -834.5197649239514, -578.65167994878, -816.4136206123137, -210.65721746245438, -327.8464800440376, -801.9334251259844, -423.8896267095204, -975.1545925127906, -935.1860910924416, -529.4351120738103, -913.3606929241133, -1125.379832104467, -744.2810360512849, -343.35595762683516, -515.3214487042883, -349.8369149956029, -496.022104982511, -833.6382974095415, -741.5511389159709, -834.0359947295398, -285.1596431694799], "episode_lengths": [150, 121, 150, 150, 150, 102, 133, 150, 132, 55, 150, 150, 150, 150, 150, 150, 52, 150, 86, 150, 150, 150, 150, 136, 150, 150, 47, 150, 150, 150, 150, 150, 150, 150, 93, 82, 109, 150, 150, 150, 150, 150, 150, 141, 150, 150, 150, 150, 121, 51, 105, 150, 65, 150, 150, 150, 150, 69, 150, 150, 139, 42, 150, 150, 150, 50, 119, 94, 150, 109, 150, 94, 111, 150, 79, 150, 150, 150, 150, 150, 123, 150, 95, 127, 150, 150, 150, 150, 150, 150, 150, 150, 90, 116, 109, 137, 150, 150, 150, 150], "policy_policy_0_reward": [-808.525282168692, -324.2039360567221, -1063.112968391608, -828.8687407946832, -1152.8166682972378, -409.19855473303073, -325.68046794202564, -1216.2692171008118, -329.24250750299933, -50.55422536732732, -1109.3052183097452, -869.8475726532417, -998.2552876111135, -907.22119950058, -966.0183376339453, -599.0790717382318, -95.56985453610592, -746.027530763987, -180.4329142131434, -876.8773884316693, -1051.9115085637752, -1008.6591590090665, -1142.2707679227374, -601.665749801828, -607.5537638065844, -828.0918957829542, -97.5076708301397, -670.3859878376425, -1098.565439766719, -976.6456274105788, -973.947062778394, -826.0081712483194, -1037.315541533512, -530.659964030897, -244.80682724312473, -276.8059396406604, -345.41115236615065, -710.5594593382178, -732.0842210063961, -916.4627029574054, -1070.2200077207215, -974.8458494250993, -679.7895901356835, -600.6599808816094, -413.05343572392906, -1017.689353950155, -1076.6922258395227, -942.6532307626289, -221.96329436242186, -40.061620790176015, -266.5207744401612, -1057.4917279963697, -184.2270354611441, -482.30234614650726, -890.5358319048776, -1143.2689606561657, -861.0233193751177, -104.76956141926928, -809.1904877097131, -986.5445766682799, -741.4914763964845, -6.262349108526059, -938.7057375660979, -1245.6997899092426, -1088.526097334132, -111.02562383127412, -476.9606846240591, -271.6943745848134, -686.3141616359412, -130.86977140250877, -961.8495830192268, -195.7934999292342, -352.3262660195173, -530.7713368844453, -166.34800438051917, -663.3571575249672, -498.5081263185684, -703.8297233501033, -1179.3546246190608, -834.5197649239514, -578.65167994878, -816.4136206123137, -210.65721746245438, -327.8464800440376, -801.9334251259844, -423.8896267095204, -975.1545925127906, -935.1860910924416, -529.4351120738103, -913.3606929241133, -1125.379832104467, -744.2810360512849, -343.35595762683516, -515.3214487042883, -349.8369149956029, -496.022104982511, -833.6382974095415, -741.5511389159709, -834.0359947295398, -285.1596431694799]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2996614971838662, "mean_inference_ms": 0.9290264667745486, "mean_action_processing_ms": 0.16657309326882083, "mean_env_wait_ms": 1.695234568660227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0053141117095947266, "StateBufferConnector_ms": 0.0040073394775390625, "ViewRequirementAgentConnector_ms": 0.10181593894958496}, "num_episodes": 29, "episode_return_max": -6.262349108526059, "episode_return_min": -1245.6997899092426, "episode_return_mean": -669.2324782854998, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.2896334331791, "num_env_steps_trained_throughput_per_sec": 277.2896334331791, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 13590.961, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13590.884, "sample_time_ms": 2611.768, "learn_time_ms": 10962.893, "learn_throughput": 364.867, "synch_weights_time_ms": 14.928}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 64, "trial_id": "6d52d_00000", "date": "2024-07-26_22-58-28", "timestamp": 1722014908, "time_this_iter_s": 14.43269419670105, "time_total_s": 862.8861999511719, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c3d9a20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 862.8861999511719, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 10.21, "ram_util_percent": 28.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 195.47794972459477, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 4.247373268504938, "policy_loss": -0.009226469694597957, "vf_loss": 4.257113383462031, "vf_explained_var": 0.9485846685245634, "kl": 0.011814145452929907, "entropy": 1.247547043301165, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 61920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "env_runners": {"episode_reward_max": -6.262349108526059, "episode_reward_min": -1245.6997899092426, "episode_reward_mean": -658.7969908252076, "episode_len_mean": 134.8, "episode_media": {}, "episodes_timesteps_total": 13480, "policy_reward_min": {"policy_0": -1245.6997899092426}, "policy_reward_max": {"policy_0": -6.262349108526059}, "policy_reward_mean": {"policy_0": -658.7969908252076}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-976.6456274105788, -973.947062778394, -826.0081712483194, -1037.315541533512, -530.659964030897, -244.80682724312473, -276.8059396406604, -345.41115236615065, -710.5594593382178, -732.0842210063961, -916.4627029574054, -1070.2200077207215, -974.8458494250993, -679.7895901356835, -600.6599808816094, -413.05343572392906, -1017.689353950155, -1076.6922258395227, -942.6532307626289, -221.96329436242186, -40.061620790176015, -266.5207744401612, -1057.4917279963697, -184.2270354611441, -482.30234614650726, -890.5358319048776, -1143.2689606561657, -861.0233193751177, -104.76956141926928, -809.1904877097131, -986.5445766682799, -741.4914763964845, -6.262349108526059, -938.7057375660979, -1245.6997899092426, -1088.526097334132, -111.02562383127412, -476.9606846240591, -271.6943745848134, -686.3141616359412, -130.86977140250877, -961.8495830192268, -195.7934999292342, -352.3262660195173, -530.7713368844453, -166.34800438051917, -663.3571575249672, -498.5081263185684, -703.8297233501033, -1179.3546246190608, -834.5197649239514, -578.65167994878, -816.4136206123137, -210.65721746245438, -327.8464800440376, -801.9334251259844, -423.8896267095204, -975.1545925127906, -935.1860910924416, -529.4351120738103, -913.3606929241133, -1125.379832104467, -744.2810360512849, -343.35595762683516, -515.3214487042883, -349.8369149956029, -496.022104982511, -833.6382974095415, -741.5511389159709, -834.0359947295398, -285.1596431694799, -781.3379151175782, -605.1279680622332, -864.8417436117328, -629.6523670708, -674.6614969447837, -875.6915713324731, -808.0425220727059, -1154.246578051911, -427.4324115056253, -655.5238972208487, -610.6058703907196, -40.75427497154271, -785.1608767314228, -391.70874775181966, -494.03339190235016, -621.0218073578268, -970.6386554208, -588.9327026659083, -708.2866610569079, -814.4285685671141, -425.21550224860965, -464.64466524899564, -694.2215751198886, -616.9540055439087, -534.7374046228921, -1156.57259307657, -844.7386318080707, -879.4296847937729, -801.5260507692972], "episode_lengths": [150, 150, 150, 150, 150, 93, 82, 109, 150, 150, 150, 150, 150, 150, 141, 150, 150, 150, 150, 121, 51, 105, 150, 65, 150, 150, 150, 150, 69, 150, 150, 139, 42, 150, 150, 150, 50, 119, 94, 150, 109, 150, 94, 111, 150, 79, 150, 150, 150, 150, 150, 123, 150, 95, 127, 150, 150, 150, 150, 150, 150, 150, 150, 90, 116, 109, 137, 150, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 131, 55, 150, 150, 119, 150, 150, 138, 150, 150, 147, 140, 150, 117, 115, 150, 150, 150, 150], "policy_policy_0_reward": [-976.6456274105788, -973.947062778394, -826.0081712483194, -1037.315541533512, -530.659964030897, -244.80682724312473, -276.8059396406604, -345.41115236615065, -710.5594593382178, -732.0842210063961, -916.4627029574054, -1070.2200077207215, -974.8458494250993, -679.7895901356835, -600.6599808816094, -413.05343572392906, -1017.689353950155, -1076.6922258395227, -942.6532307626289, -221.96329436242186, -40.061620790176015, -266.5207744401612, -1057.4917279963697, -184.2270354611441, -482.30234614650726, -890.5358319048776, -1143.2689606561657, -861.0233193751177, -104.76956141926928, -809.1904877097131, -986.5445766682799, -741.4914763964845, -6.262349108526059, -938.7057375660979, -1245.6997899092426, -1088.526097334132, -111.02562383127412, -476.9606846240591, -271.6943745848134, -686.3141616359412, -130.86977140250877, -961.8495830192268, -195.7934999292342, -352.3262660195173, -530.7713368844453, -166.34800438051917, -663.3571575249672, -498.5081263185684, -703.8297233501033, -1179.3546246190608, -834.5197649239514, -578.65167994878, -816.4136206123137, -210.65721746245438, -327.8464800440376, -801.9334251259844, -423.8896267095204, -975.1545925127906, -935.1860910924416, -529.4351120738103, -913.3606929241133, -1125.379832104467, -744.2810360512849, -343.35595762683516, -515.3214487042883, -349.8369149956029, -496.022104982511, -833.6382974095415, -741.5511389159709, -834.0359947295398, -285.1596431694799, -781.3379151175782, -605.1279680622332, -864.8417436117328, -629.6523670708, -674.6614969447837, -875.6915713324731, -808.0425220727059, -1154.246578051911, -427.4324115056253, -655.5238972208487, -610.6058703907196, -40.75427497154271, -785.1608767314228, -391.70874775181966, -494.03339190235016, -621.0218073578268, -970.6386554208, -588.9327026659083, -708.2866610569079, -814.4285685671141, -425.21550224860965, -464.64466524899564, -694.2215751198886, -616.9540055439087, -534.7374046228921, -1156.57259307657, -844.7386318080707, -879.4296847937729, -801.5260507692972]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29961218889619884, "mean_inference_ms": 0.9285847945610642, "mean_action_processing_ms": 0.16644374941789342, "mean_env_wait_ms": 1.6962214412713539, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005310773849487305, "StateBufferConnector_ms": 0.004035472869873047, "ViewRequirementAgentConnector_ms": 0.10275888442993164}, "num_episodes": 29, "episode_return_max": -6.262349108526059, "episode_return_min": -1245.6997899092426, "episode_return_mean": -658.7969908252076, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.55176420745926, "num_env_steps_trained_throughput_per_sec": 307.55176420745926, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 260000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 260000, "timers": {"training_iteration_time_ms": 13431.332, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13431.253, "sample_time_ms": 2573.307, "learn_time_ms": 10841.461, "learn_throughput": 368.954, "synch_weights_time_ms": 15.217}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "done": false, "training_iteration": 65, "trial_id": "6d52d_00000", "date": "2024-07-26_22-58-41", "timestamp": 1722014921, "time_this_iter_s": 13.01240086555481, "time_total_s": 875.8986008167267, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c3da7a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 875.8986008167267, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 10.368421052631577, "ram_util_percent": 28.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 182.87941165367764, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 3.411322989190618, "policy_loss": -0.011706211168590623, "vf_loss": 3.4279344608386357, "vf_explained_var": 0.986973242337505, "kl": 0.01058453345540336, "entropy": 1.562209825962782, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 62880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "env_runners": {"episode_reward_max": -6.262349108526059, "episode_reward_min": -1245.6997899092426, "episode_reward_mean": -652.0050758355957, "episode_len_mean": 135.15, "episode_media": {}, "episodes_timesteps_total": 13515, "policy_reward_min": {"policy_0": -1245.6997899092426}, "policy_reward_max": {"policy_0": -6.262349108526059}, "policy_reward_mean": {"policy_0": -652.0050758355957}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-741.4914763964845, -6.262349108526059, -938.7057375660979, -1245.6997899092426, -1088.526097334132, -111.02562383127412, -476.9606846240591, -271.6943745848134, -686.3141616359412, -130.86977140250877, -961.8495830192268, -195.7934999292342, -352.3262660195173, -530.7713368844453, -166.34800438051917, -663.3571575249672, -498.5081263185684, -703.8297233501033, -1179.3546246190608, -834.5197649239514, -578.65167994878, -816.4136206123137, -210.65721746245438, -327.8464800440376, -801.9334251259844, -423.8896267095204, -975.1545925127906, -935.1860910924416, -529.4351120738103, -913.3606929241133, -1125.379832104467, -744.2810360512849, -343.35595762683516, -515.3214487042883, -349.8369149956029, -496.022104982511, -833.6382974095415, -741.5511389159709, -834.0359947295398, -285.1596431694799, -781.3379151175782, -605.1279680622332, -864.8417436117328, -629.6523670708, -674.6614969447837, -875.6915713324731, -808.0425220727059, -1154.246578051911, -427.4324115056253, -655.5238972208487, -610.6058703907196, -40.75427497154271, -785.1608767314228, -391.70874775181966, -494.03339190235016, -621.0218073578268, -970.6386554208, -588.9327026659083, -708.2866610569079, -814.4285685671141, -425.21550224860965, -464.64466524899564, -694.2215751198886, -616.9540055439087, -534.7374046228921, -1156.57259307657, -844.7386318080707, -879.4296847937729, -801.5260507692972, -634.0225138171157, -951.2888143568808, -991.0321478306502, -775.787998444372, -432.08102695086404, -639.7033506786389, -693.2331774364868, -89.5316867219361, -1211.1488804585695, -1105.5932887891233, -657.0247889766707, -666.5728351965734, -798.3125112615452, -114.45131566867026, -442.6250666229884, -276.5449235765198, -410.2760663861255, -130.12631255784598, -304.3039753874462, -864.0719524352266, -1107.7473116472115, -988.9329288245629, -998.1876042374814, -243.34646450257713, -596.4868456027851, -989.7232947033416, -1063.7948166060203, -1107.4236046363887, -140.11667391343056, -1200.3534009248594, -91.17280280910732], "episode_lengths": [139, 42, 150, 150, 150, 50, 119, 94, 150, 109, 150, 94, 111, 150, 79, 150, 150, 150, 150, 150, 123, 150, 95, 127, 150, 150, 150, 150, 150, 150, 150, 150, 90, 116, 109, 137, 150, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 131, 55, 150, 150, 119, 150, 150, 138, 150, 150, 147, 140, 150, 117, 115, 150, 150, 150, 150, 150, 150, 150, 150, 137, 150, 150, 69, 150, 150, 149, 139, 150, 72, 150, 80, 150, 92, 123, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 99], "policy_policy_0_reward": [-741.4914763964845, -6.262349108526059, -938.7057375660979, -1245.6997899092426, -1088.526097334132, -111.02562383127412, -476.9606846240591, -271.6943745848134, -686.3141616359412, -130.86977140250877, -961.8495830192268, -195.7934999292342, -352.3262660195173, -530.7713368844453, -166.34800438051917, -663.3571575249672, -498.5081263185684, -703.8297233501033, -1179.3546246190608, -834.5197649239514, -578.65167994878, -816.4136206123137, -210.65721746245438, -327.8464800440376, -801.9334251259844, -423.8896267095204, -975.1545925127906, -935.1860910924416, -529.4351120738103, -913.3606929241133, -1125.379832104467, -744.2810360512849, -343.35595762683516, -515.3214487042883, -349.8369149956029, -496.022104982511, -833.6382974095415, -741.5511389159709, -834.0359947295398, -285.1596431694799, -781.3379151175782, -605.1279680622332, -864.8417436117328, -629.6523670708, -674.6614969447837, -875.6915713324731, -808.0425220727059, -1154.246578051911, -427.4324115056253, -655.5238972208487, -610.6058703907196, -40.75427497154271, -785.1608767314228, -391.70874775181966, -494.03339190235016, -621.0218073578268, -970.6386554208, -588.9327026659083, -708.2866610569079, -814.4285685671141, -425.21550224860965, -464.64466524899564, -694.2215751198886, -616.9540055439087, -534.7374046228921, -1156.57259307657, -844.7386318080707, -879.4296847937729, -801.5260507692972, -634.0225138171157, -951.2888143568808, -991.0321478306502, -775.787998444372, -432.08102695086404, -639.7033506786389, -693.2331774364868, -89.5316867219361, -1211.1488804585695, -1105.5932887891233, -657.0247889766707, -666.5728351965734, -798.3125112615452, -114.45131566867026, -442.6250666229884, -276.5449235765198, -410.2760663861255, -130.12631255784598, -304.3039753874462, -864.0719524352266, -1107.7473116472115, -988.9329288245629, -998.1876042374814, -243.34646450257713, -596.4868456027851, -989.7232947033416, -1063.7948166060203, -1107.4236046363887, -140.11667391343056, -1200.3534009248594, -91.17280280910732]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29956249101805904, "mean_inference_ms": 0.928373413883179, "mean_action_processing_ms": 0.16650244337690404, "mean_env_wait_ms": 1.6965609066701257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005318164825439453, "StateBufferConnector_ms": 0.004068613052368164, "ViewRequirementAgentConnector_ms": 0.10370135307312012}, "num_episodes": 31, "episode_return_max": -6.262349108526059, "episode_return_min": -1245.6997899092426, "episode_return_mean": -652.0050758355957, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 284.5258382919227, "num_env_steps_trained_throughput_per_sec": 284.5258382919227, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 13631.458, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13631.377, "sample_time_ms": 2564.275, "learn_time_ms": 11050.623, "learn_throughput": 361.971, "synch_weights_time_ms": 15.213}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "training_iteration": 66, "trial_id": "6d52d_00000", "date": "2024-07-26_22-58-56", "timestamp": 1722014936, "time_this_iter_s": 14.064798831939697, "time_total_s": 889.9633996486664, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d139e045b40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 889.9633996486664, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 9.885, "ram_util_percent": 28.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 252.58290281295777, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 3.4456480383872985, "policy_loss": -0.013484833329372729, "vf_loss": 3.464056854819258, "vf_explained_var": 0.9780074448014299, "kl": 0.010251541603186887, "entropy": 1.5303667321801186, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 63840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "env_runners": {"episode_reward_max": -40.75427497154271, "episode_reward_min": -1314.2861280099305, "episode_reward_mean": -694.512920430221, "episode_len_mean": 138.92, "episode_media": {}, "episodes_timesteps_total": 13892, "policy_reward_min": {"policy_0": -1314.2861280099305}, "policy_reward_max": {"policy_0": -40.75427497154271}, "policy_reward_mean": {"policy_0": -694.512920430221}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-529.4351120738103, -913.3606929241133, -1125.379832104467, -744.2810360512849, -343.35595762683516, -515.3214487042883, -349.8369149956029, -496.022104982511, -833.6382974095415, -741.5511389159709, -834.0359947295398, -285.1596431694799, -781.3379151175782, -605.1279680622332, -864.8417436117328, -629.6523670708, -674.6614969447837, -875.6915713324731, -808.0425220727059, -1154.246578051911, -427.4324115056253, -655.5238972208487, -610.6058703907196, -40.75427497154271, -785.1608767314228, -391.70874775181966, -494.03339190235016, -621.0218073578268, -970.6386554208, -588.9327026659083, -708.2866610569079, -814.4285685671141, -425.21550224860965, -464.64466524899564, -694.2215751198886, -616.9540055439087, -534.7374046228921, -1156.57259307657, -844.7386318080707, -879.4296847937729, -801.5260507692972, -634.0225138171157, -951.2888143568808, -991.0321478306502, -775.787998444372, -432.08102695086404, -639.7033506786389, -693.2331774364868, -89.5316867219361, -1211.1488804585695, -1105.5932887891233, -657.0247889766707, -666.5728351965734, -798.3125112615452, -114.45131566867026, -442.6250666229884, -276.5449235765198, -410.2760663861255, -130.12631255784598, -304.3039753874462, -864.0719524352266, -1107.7473116472115, -988.9329288245629, -998.1876042374814, -243.34646450257713, -596.4868456027851, -989.7232947033416, -1063.7948166060203, -1107.4236046363887, -140.11667391343056, -1200.3534009248594, -91.17280280910732, -926.2375911465965, -996.3659131840149, -698.2142218501206, -391.2995731262132, -953.888035698701, -975.3589650322036, -742.6004922509632, -961.7408658849959, -730.2337345939676, -1314.2861280099305, -401.40946217275047, -471.4385513861139, -748.7857328152801, -1036.837382325915, -255.53362447640723, -621.7162846170352, -900.4503996599299, -1015.5251127163764, -927.64299310601, -254.5469433073619, -802.1285337368213, -801.8478362139643, -301.81735273895686, -506.34869292717815, -389.8133710899146, -1060.7247720553303, -916.0032962162948, -1001.9294839941904], "episode_lengths": [150, 150, 150, 150, 90, 116, 109, 137, 150, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 131, 55, 150, 150, 119, 150, 150, 138, 150, 150, 147, 140, 150, 117, 115, 150, 150, 150, 150, 150, 150, 150, 150, 137, 150, 150, 69, 150, 150, 149, 139, 150, 72, 150, 80, 150, 92, 123, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 100, 115, 150, 150, 110, 150, 150, 150, 150, 90, 150, 150, 94, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-529.4351120738103, -913.3606929241133, -1125.379832104467, -744.2810360512849, -343.35595762683516, -515.3214487042883, -349.8369149956029, -496.022104982511, -833.6382974095415, -741.5511389159709, -834.0359947295398, -285.1596431694799, -781.3379151175782, -605.1279680622332, -864.8417436117328, -629.6523670708, -674.6614969447837, -875.6915713324731, -808.0425220727059, -1154.246578051911, -427.4324115056253, -655.5238972208487, -610.6058703907196, -40.75427497154271, -785.1608767314228, -391.70874775181966, -494.03339190235016, -621.0218073578268, -970.6386554208, -588.9327026659083, -708.2866610569079, -814.4285685671141, -425.21550224860965, -464.64466524899564, -694.2215751198886, -616.9540055439087, -534.7374046228921, -1156.57259307657, -844.7386318080707, -879.4296847937729, -801.5260507692972, -634.0225138171157, -951.2888143568808, -991.0321478306502, -775.787998444372, -432.08102695086404, -639.7033506786389, -693.2331774364868, -89.5316867219361, -1211.1488804585695, -1105.5932887891233, -657.0247889766707, -666.5728351965734, -798.3125112615452, -114.45131566867026, -442.6250666229884, -276.5449235765198, -410.2760663861255, -130.12631255784598, -304.3039753874462, -864.0719524352266, -1107.7473116472115, -988.9329288245629, -998.1876042374814, -243.34646450257713, -596.4868456027851, -989.7232947033416, -1063.7948166060203, -1107.4236046363887, -140.11667391343056, -1200.3534009248594, -91.17280280910732, -926.2375911465965, -996.3659131840149, -698.2142218501206, -391.2995731262132, -953.888035698701, -975.3589650322036, -742.6004922509632, -961.7408658849959, -730.2337345939676, -1314.2861280099305, -401.40946217275047, -471.4385513861139, -748.7857328152801, -1036.837382325915, -255.53362447640723, -621.7162846170352, -900.4503996599299, -1015.5251127163764, -927.64299310601, -254.5469433073619, -802.1285337368213, -801.8478362139643, -301.81735273895686, -506.34869292717815, -389.8133710899146, -1060.7247720553303, -916.0032962162948, -1001.9294839941904]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2995365399174505, "mean_inference_ms": 0.9280410376159591, "mean_action_processing_ms": 0.16648978838260342, "mean_env_wait_ms": 1.6979626763931543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005207538604736328, "StateBufferConnector_ms": 0.0040895938873291016, "ViewRequirementAgentConnector_ms": 0.1032719612121582}, "num_episodes": 28, "episode_return_max": -40.75427497154271, "episode_return_min": -1314.2861280099305, "episode_return_mean": -694.512920430221, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.85407230964296, "num_env_steps_trained_throughput_per_sec": 272.85407230964296, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 268000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 268000, "timers": {"training_iteration_time_ms": 13700.358, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13700.278, "sample_time_ms": 2551.667, "learn_time_ms": 11132.038, "learn_throughput": 359.323, "synch_weights_time_ms": 15.305}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "done": false, "training_iteration": 67, "trial_id": "6d52d_00000", "date": "2024-07-26_22-59-10", "timestamp": 1722014950, "time_this_iter_s": 14.667532682418823, "time_total_s": 904.6309323310852, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d1254728a60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 904.6309323310852, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 9.98, "ram_util_percent": 28.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 200.6070982237657, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 3.6148135367780925, "policy_loss": -0.007815599231495678, "vf_loss": 3.6262784998863937, "vf_explained_var": 0.9779652605454127, "kl": 0.010280340518450733, "entropy": 1.4058213270579776, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 64800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": -22.90159469243924, "episode_reward_min": -1388.7515171846585, "episode_reward_mean": -680.131260520463, "episode_len_mean": 135.69, "episode_media": {}, "episodes_timesteps_total": 13569, "policy_reward_min": {"policy_0": -1388.7515171846585}, "policy_reward_max": {"policy_0": -22.90159469243924}, "policy_reward_mean": {"policy_0": -680.131260520463}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-708.2866610569079, -814.4285685671141, -425.21550224860965, -464.64466524899564, -694.2215751198886, -616.9540055439087, -534.7374046228921, -1156.57259307657, -844.7386318080707, -879.4296847937729, -801.5260507692972, -634.0225138171157, -951.2888143568808, -991.0321478306502, -775.787998444372, -432.08102695086404, -639.7033506786389, -693.2331774364868, -89.5316867219361, -1211.1488804585695, -1105.5932887891233, -657.0247889766707, -666.5728351965734, -798.3125112615452, -114.45131566867026, -442.6250666229884, -276.5449235765198, -410.2760663861255, -130.12631255784598, -304.3039753874462, -864.0719524352266, -1107.7473116472115, -988.9329288245629, -998.1876042374814, -243.34646450257713, -596.4868456027851, -989.7232947033416, -1063.7948166060203, -1107.4236046363887, -140.11667391343056, -1200.3534009248594, -91.17280280910732, -926.2375911465965, -996.3659131840149, -698.2142218501206, -391.2995731262132, -953.888035698701, -975.3589650322036, -742.6004922509632, -961.7408658849959, -730.2337345939676, -1314.2861280099305, -401.40946217275047, -471.4385513861139, -748.7857328152801, -1036.837382325915, -255.53362447640723, -621.7162846170352, -900.4503996599299, -1015.5251127163764, -927.64299310601, -254.5469433073619, -802.1285337368213, -801.8478362139643, -301.81735273895686, -506.34869292717815, -389.8133710899146, -1060.7247720553303, -916.0032962162948, -1001.9294839941904, -380.0126866122241, -968.0925768194326, -809.0833811196584, -885.9625607635068, -100.32519426821655, -929.324706330801, -79.86049844395885, -967.1657428049128, -1388.7515171846585, -875.5000168006497, -402.31852030721126, -351.99620048403875, -603.5679145136885, -53.65255920734392, -22.90159469243924, -1167.0613784919565, -1107.662421411899, -917.0730311727588, -83.93683461430062, -499.4895670468051, -64.77777412154164, -283.9784328248218, -966.7722861632898, -731.2648893870264, -501.3691039247197, -838.2346190912561, -545.1054976904729, -688.0757656774442, -701.848604578483, -337.461104345183], "episode_lengths": [150, 150, 147, 140, 150, 117, 115, 150, 150, 150, 150, 150, 150, 150, 150, 137, 150, 150, 69, 150, 150, 149, 139, 150, 72, 150, 80, 150, 92, 123, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 100, 115, 150, 150, 110, 150, 150, 150, 150, 90, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 65, 150, 78, 150, 150, 150, 139, 122, 150, 46, 47, 150, 150, 150, 78, 150, 81, 129, 150, 150, 116, 150, 150, 150, 150, 119], "policy_policy_0_reward": [-708.2866610569079, -814.4285685671141, -425.21550224860965, -464.64466524899564, -694.2215751198886, -616.9540055439087, -534.7374046228921, -1156.57259307657, -844.7386318080707, -879.4296847937729, -801.5260507692972, -634.0225138171157, -951.2888143568808, -991.0321478306502, -775.787998444372, -432.08102695086404, -639.7033506786389, -693.2331774364868, -89.5316867219361, -1211.1488804585695, -1105.5932887891233, -657.0247889766707, -666.5728351965734, -798.3125112615452, -114.45131566867026, -442.6250666229884, -276.5449235765198, -410.2760663861255, -130.12631255784598, -304.3039753874462, -864.0719524352266, -1107.7473116472115, -988.9329288245629, -998.1876042374814, -243.34646450257713, -596.4868456027851, -989.7232947033416, -1063.7948166060203, -1107.4236046363887, -140.11667391343056, -1200.3534009248594, -91.17280280910732, -926.2375911465965, -996.3659131840149, -698.2142218501206, -391.2995731262132, -953.888035698701, -975.3589650322036, -742.6004922509632, -961.7408658849959, -730.2337345939676, -1314.2861280099305, -401.40946217275047, -471.4385513861139, -748.7857328152801, -1036.837382325915, -255.53362447640723, -621.7162846170352, -900.4503996599299, -1015.5251127163764, -927.64299310601, -254.5469433073619, -802.1285337368213, -801.8478362139643, -301.81735273895686, -506.34869292717815, -389.8133710899146, -1060.7247720553303, -916.0032962162948, -1001.9294839941904, -380.0126866122241, -968.0925768194326, -809.0833811196584, -885.9625607635068, -100.32519426821655, -929.324706330801, -79.86049844395885, -967.1657428049128, -1388.7515171846585, -875.5000168006497, -402.31852030721126, -351.99620048403875, -603.5679145136885, -53.65255920734392, -22.90159469243924, -1167.0613784919565, -1107.662421411899, -917.0730311727588, -83.93683461430062, -499.4895670468051, -64.77777412154164, -283.9784328248218, -966.7722861632898, -731.2648893870264, -501.3691039247197, -838.2346190912561, -545.1054976904729, -688.0757656774442, -701.848604578483, -337.461104345183]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29942245005737894, "mean_inference_ms": 0.9276236522750644, "mean_action_processing_ms": 0.1663947060669386, "mean_env_wait_ms": 1.6974656481032186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005234241485595703, "StateBufferConnector_ms": 0.004056453704833984, "ViewRequirementAgentConnector_ms": 0.10250425338745117}, "num_episodes": 30, "episode_return_max": -22.90159469243924, "episode_return_min": -1388.7515171846585, "episode_return_mean": -680.131260520463, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 275.416122186329, "num_env_steps_trained_throughput_per_sec": 275.416122186329, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 13792.285, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13792.206, "sample_time_ms": 2559.558, "learn_time_ms": 11215.499, "learn_throughput": 356.649, "synch_weights_time_ms": 15.842}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 68, "trial_id": "6d52d_00000", "date": "2024-07-26_22-59-25", "timestamp": 1722014965, "time_this_iter_s": 14.529058694839478, "time_total_s": 919.1599910259247, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c3da7a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 919.1599910259247, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 10.033333333333335, "ram_util_percent": 28.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 229.46646538178126, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 3.3523226662228507, "policy_loss": -0.014618338587752078, "vf_loss": 3.375280031437675, "vf_explained_var": 0.9854094098632534, "kl": 0.00966171528240624, "entropy": 1.8121507254739602, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 65760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "env_runners": {"episode_reward_max": -22.90159469243924, "episode_reward_min": -1388.7515171846585, "episode_reward_mean": -702.7659782749892, "episode_len_mean": 136.25, "episode_media": {}, "episodes_timesteps_total": 13625, "policy_reward_min": {"policy_0": -1388.7515171846585}, "policy_reward_max": {"policy_0": -22.90159469243924}, "policy_reward_mean": {"policy_0": -702.7659782749892}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-304.3039753874462, -864.0719524352266, -1107.7473116472115, -988.9329288245629, -998.1876042374814, -243.34646450257713, -596.4868456027851, -989.7232947033416, -1063.7948166060203, -1107.4236046363887, -140.11667391343056, -1200.3534009248594, -91.17280280910732, -926.2375911465965, -996.3659131840149, -698.2142218501206, -391.2995731262132, -953.888035698701, -975.3589650322036, -742.6004922509632, -961.7408658849959, -730.2337345939676, -1314.2861280099305, -401.40946217275047, -471.4385513861139, -748.7857328152801, -1036.837382325915, -255.53362447640723, -621.7162846170352, -900.4503996599299, -1015.5251127163764, -927.64299310601, -254.5469433073619, -802.1285337368213, -801.8478362139643, -301.81735273895686, -506.34869292717815, -389.8133710899146, -1060.7247720553303, -916.0032962162948, -1001.9294839941904, -380.0126866122241, -968.0925768194326, -809.0833811196584, -885.9625607635068, -100.32519426821655, -929.324706330801, -79.86049844395885, -967.1657428049128, -1388.7515171846585, -875.5000168006497, -402.31852030721126, -351.99620048403875, -603.5679145136885, -53.65255920734392, -22.90159469243924, -1167.0613784919565, -1107.662421411899, -917.0730311727588, -83.93683461430062, -499.4895670468051, -64.77777412154164, -283.9784328248218, -966.7722861632898, -731.2648893870264, -501.3691039247197, -838.2346190912561, -545.1054976904729, -688.0757656774442, -701.848604578483, -337.461104345183, -461.45758895923973, -1211.6952260625997, -443.7873366538959, -906.1876136631616, -425.81697839484985, -371.4600948098269, -334.4876645803085, -1079.9717038610183, -972.1599015219009, -615.4347043335425, -305.75609713659236, -1063.0816977498719, -1152.1850320740184, -46.85680548111614, -1036.7696332410346, -713.5252903423393, -1045.794629152117, -1255.3740771031628, -46.093461066509214, -875.5541018489156, -335.41155677656496, -940.8905044562309, -1181.0835026892796, -1001.1376812341883, -209.18609988264143, -1105.0974594916738, -438.6171809876311, -964.9316813402589, -683.7785191457585], "episode_lengths": [123, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 100, 115, 150, 150, 110, 150, 150, 150, 150, 90, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 65, 150, 78, 150, 150, 150, 139, 122, 150, 46, 47, 150, 150, 150, 78, 150, 81, 129, 150, 150, 116, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 150, 130, 150, 150, 127, 115, 150, 150, 63, 150, 150, 150, 150, 48, 150, 150, 150, 150, 150, 93, 150, 137, 150, 150], "policy_policy_0_reward": [-304.3039753874462, -864.0719524352266, -1107.7473116472115, -988.9329288245629, -998.1876042374814, -243.34646450257713, -596.4868456027851, -989.7232947033416, -1063.7948166060203, -1107.4236046363887, -140.11667391343056, -1200.3534009248594, -91.17280280910732, -926.2375911465965, -996.3659131840149, -698.2142218501206, -391.2995731262132, -953.888035698701, -975.3589650322036, -742.6004922509632, -961.7408658849959, -730.2337345939676, -1314.2861280099305, -401.40946217275047, -471.4385513861139, -748.7857328152801, -1036.837382325915, -255.53362447640723, -621.7162846170352, -900.4503996599299, -1015.5251127163764, -927.64299310601, -254.5469433073619, -802.1285337368213, -801.8478362139643, -301.81735273895686, -506.34869292717815, -389.8133710899146, -1060.7247720553303, -916.0032962162948, -1001.9294839941904, -380.0126866122241, -968.0925768194326, -809.0833811196584, -885.9625607635068, -100.32519426821655, -929.324706330801, -79.86049844395885, -967.1657428049128, -1388.7515171846585, -875.5000168006497, -402.31852030721126, -351.99620048403875, -603.5679145136885, -53.65255920734392, -22.90159469243924, -1167.0613784919565, -1107.662421411899, -917.0730311727588, -83.93683461430062, -499.4895670468051, -64.77777412154164, -283.9784328248218, -966.7722861632898, -731.2648893870264, -501.3691039247197, -838.2346190912561, -545.1054976904729, -688.0757656774442, -701.848604578483, -337.461104345183, -461.45758895923973, -1211.6952260625997, -443.7873366538959, -906.1876136631616, -425.81697839484985, -371.4600948098269, -334.4876645803085, -1079.9717038610183, -972.1599015219009, -615.4347043335425, -305.75609713659236, -1063.0816977498719, -1152.1850320740184, -46.85680548111614, -1036.7696332410346, -713.5252903423393, -1045.794629152117, -1255.3740771031628, -46.093461066509214, -875.5541018489156, -335.41155677656496, -940.8905044562309, -1181.0835026892796, -1001.1376812341883, -209.18609988264143, -1105.0974594916738, -438.6171809876311, -964.9316813402589, -683.7785191457585]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2993153569170159, "mean_inference_ms": 0.9273682761501221, "mean_action_processing_ms": 0.16638069222056884, "mean_env_wait_ms": 1.6973876678927082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005324125289916992, "StateBufferConnector_ms": 0.004065990447998047, "ViewRequirementAgentConnector_ms": 0.10301947593688965}, "num_episodes": 29, "episode_return_max": -22.90159469243924, "episode_return_min": -1388.7515171846585, "episode_return_mean": -702.7659782749892, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 356.4093426608545, "num_env_steps_trained_throughput_per_sec": 356.4093426608545, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 276000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 13489.222, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13489.142, "sample_time_ms": 2547.287, "learn_time_ms": 10924.715, "learn_throughput": 366.142, "synch_weights_time_ms": 15.861}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "training_iteration": 69, "trial_id": "6d52d_00000", "date": "2024-07-26_22-59-36", "timestamp": 1722014976, "time_this_iter_s": 11.229886770248413, "time_total_s": 930.3898777961731, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125472acb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 930.3898777961731, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 11.25, "ram_util_percent": 28.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 220.11905649503072, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 3.4098767060786486, "policy_loss": -0.010838651420878401, "vf_loss": 3.426167584583163, "vf_explained_var": 0.9858402416110039, "kl": 0.011915841707923458, "entropy": 1.7517025722811619, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 66720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "env_runners": {"episode_reward_max": -3.3161397862596727, "episode_reward_min": -1388.7515171846585, "episode_reward_mean": -679.7404304032083, "episode_len_mean": 132.96, "episode_media": {}, "episodes_timesteps_total": 13296, "policy_reward_min": {"policy_0": -1388.7515171846585}, "policy_reward_max": {"policy_0": -3.3161397862596727}, "policy_reward_mean": {"policy_0": -679.7404304032083}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-927.64299310601, -254.5469433073619, -802.1285337368213, -801.8478362139643, -301.81735273895686, -506.34869292717815, -389.8133710899146, -1060.7247720553303, -916.0032962162948, -1001.9294839941904, -380.0126866122241, -968.0925768194326, -809.0833811196584, -885.9625607635068, -100.32519426821655, -929.324706330801, -79.86049844395885, -967.1657428049128, -1388.7515171846585, -875.5000168006497, -402.31852030721126, -351.99620048403875, -603.5679145136885, -53.65255920734392, -22.90159469243924, -1167.0613784919565, -1107.662421411899, -917.0730311727588, -83.93683461430062, -499.4895670468051, -64.77777412154164, -283.9784328248218, -966.7722861632898, -731.2648893870264, -501.3691039247197, -838.2346190912561, -545.1054976904729, -688.0757656774442, -701.848604578483, -337.461104345183, -461.45758895923973, -1211.6952260625997, -443.7873366538959, -906.1876136631616, -425.81697839484985, -371.4600948098269, -334.4876645803085, -1079.9717038610183, -972.1599015219009, -615.4347043335425, -305.75609713659236, -1063.0816977498719, -1152.1850320740184, -46.85680548111614, -1036.7696332410346, -713.5252903423393, -1045.794629152117, -1255.3740771031628, -46.093461066509214, -875.5541018489156, -335.41155677656496, -940.8905044562309, -1181.0835026892796, -1001.1376812341883, -209.18609988264143, -1105.0974594916738, -438.6171809876311, -964.9316813402589, -683.7785191457585, -926.9441453171047, -389.5896189470963, -1066.4027288604213, -821.2568802686462, -87.80016274789534, -115.17868739876967, -141.8154128741504, -689.9785356054841, -239.15089501303507, -1069.0134508284168, -873.970451372173, -1174.0644692606502, -895.390387961361, -809.3711330034589, -852.1184037607957, -662.5134879639016, -889.1151237067164, -622.0551653841072, -1059.1572945648334, -1049.4656527584507, -719.6613948827595, -1195.8261587101654, -82.00447842732822, -1020.5894656971084, -361.01592996399233, -973.2841664955325, -3.3161397862596727, -362.0039013840614, -1221.8219652852013, -233.04323483798132, -928.1100369320084], "episode_lengths": [150, 90, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 65, 150, 78, 150, 150, 150, 139, 122, 150, 46, 47, 150, 150, 150, 78, 150, 81, 129, 150, 150, 116, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 150, 130, 150, 150, 127, 115, 150, 150, 63, 150, 150, 150, 150, 48, 150, 150, 150, 150, 150, 93, 150, 137, 150, 150, 150, 109, 150, 150, 85, 52, 60, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 150, 97, 150, 37, 116, 150, 107, 150], "policy_policy_0_reward": [-927.64299310601, -254.5469433073619, -802.1285337368213, -801.8478362139643, -301.81735273895686, -506.34869292717815, -389.8133710899146, -1060.7247720553303, -916.0032962162948, -1001.9294839941904, -380.0126866122241, -968.0925768194326, -809.0833811196584, -885.9625607635068, -100.32519426821655, -929.324706330801, -79.86049844395885, -967.1657428049128, -1388.7515171846585, -875.5000168006497, -402.31852030721126, -351.99620048403875, -603.5679145136885, -53.65255920734392, -22.90159469243924, -1167.0613784919565, -1107.662421411899, -917.0730311727588, -83.93683461430062, -499.4895670468051, -64.77777412154164, -283.9784328248218, -966.7722861632898, -731.2648893870264, -501.3691039247197, -838.2346190912561, -545.1054976904729, -688.0757656774442, -701.848604578483, -337.461104345183, -461.45758895923973, -1211.6952260625997, -443.7873366538959, -906.1876136631616, -425.81697839484985, -371.4600948098269, -334.4876645803085, -1079.9717038610183, -972.1599015219009, -615.4347043335425, -305.75609713659236, -1063.0816977498719, -1152.1850320740184, -46.85680548111614, -1036.7696332410346, -713.5252903423393, -1045.794629152117, -1255.3740771031628, -46.093461066509214, -875.5541018489156, -335.41155677656496, -940.8905044562309, -1181.0835026892796, -1001.1376812341883, -209.18609988264143, -1105.0974594916738, -438.6171809876311, -964.9316813402589, -683.7785191457585, -926.9441453171047, -389.5896189470963, -1066.4027288604213, -821.2568802686462, -87.80016274789534, -115.17868739876967, -141.8154128741504, -689.9785356054841, -239.15089501303507, -1069.0134508284168, -873.970451372173, -1174.0644692606502, -895.390387961361, -809.3711330034589, -852.1184037607957, -662.5134879639016, -889.1151237067164, -622.0551653841072, -1059.1572945648334, -1049.4656527584507, -719.6613948827595, -1195.8261587101654, -82.00447842732822, -1020.5894656971084, -361.01592996399233, -973.2841664955325, -3.3161397862596727, -362.0039013840614, -1221.8219652852013, -233.04323483798132, -928.1100369320084]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2991041319146483, "mean_inference_ms": 0.9270345693405306, "mean_action_processing_ms": 0.16622110670943613, "mean_env_wait_ms": 1.6954518042676028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005398750305175781, "StateBufferConnector_ms": 0.004015922546386719, "ViewRequirementAgentConnector_ms": 0.10166811943054199}, "num_episodes": 31, "episode_return_max": -3.3161397862596727, "episode_return_min": -1388.7515171846585, "episode_return_mean": -679.7404304032083, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 341.7844704767984, "num_env_steps_trained_throughput_per_sec": 341.7844704767984, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 13226.294, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13226.214, "sample_time_ms": 2546.9, "learn_time_ms": 10661.902, "learn_throughput": 375.168, "synch_weights_time_ms": 16.162}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "training_iteration": 70, "trial_id": "6d52d_00000", "date": "2024-07-26_22-59-48", "timestamp": 1722014988, "time_this_iter_s": 11.709988117218018, "time_total_s": 942.0998659133911, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c3d9cf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 942.0998659133911, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 10.688235294117646, "ram_util_percent": 28.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 182.62526869575183, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 3.754357003917297, "policy_loss": -0.006726952343403051, "vf_loss": 3.760396711776654, "vf_explained_var": 0.9714976310109099, "kl": 0.013826875426351214, "entropy": 1.3312464813391367, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 67680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "env_runners": {"episode_reward_max": -3.3161397862596727, "episode_reward_min": -1255.3740771031628, "episode_reward_mean": -685.148916128736, "episode_len_mean": 135.14, "episode_media": {}, "episodes_timesteps_total": 13514, "policy_reward_min": {"policy_0": -1255.3740771031628}, "policy_reward_max": {"policy_0": -3.3161397862596727}, "policy_reward_mean": {"policy_0": -685.148916128736}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-499.4895670468051, -64.77777412154164, -283.9784328248218, -966.7722861632898, -731.2648893870264, -501.3691039247197, -838.2346190912561, -545.1054976904729, -688.0757656774442, -701.848604578483, -337.461104345183, -461.45758895923973, -1211.6952260625997, -443.7873366538959, -906.1876136631616, -425.81697839484985, -371.4600948098269, -334.4876645803085, -1079.9717038610183, -972.1599015219009, -615.4347043335425, -305.75609713659236, -1063.0816977498719, -1152.1850320740184, -46.85680548111614, -1036.7696332410346, -713.5252903423393, -1045.794629152117, -1255.3740771031628, -46.093461066509214, -875.5541018489156, -335.41155677656496, -940.8905044562309, -1181.0835026892796, -1001.1376812341883, -209.18609988264143, -1105.0974594916738, -438.6171809876311, -964.9316813402589, -683.7785191457585, -926.9441453171047, -389.5896189470963, -1066.4027288604213, -821.2568802686462, -87.80016274789534, -115.17868739876967, -141.8154128741504, -689.9785356054841, -239.15089501303507, -1069.0134508284168, -873.970451372173, -1174.0644692606502, -895.390387961361, -809.3711330034589, -852.1184037607957, -662.5134879639016, -889.1151237067164, -622.0551653841072, -1059.1572945648334, -1049.4656527584507, -719.6613948827595, -1195.8261587101654, -82.00447842732822, -1020.5894656971084, -361.01592996399233, -973.2841664955325, -3.3161397862596727, -362.0039013840614, -1221.8219652852013, -233.04323483798132, -928.1100369320084, -1034.6852422512861, -474.58776299449426, -791.8630473827212, -817.4860762068143, -193.39670922001665, -602.3365764991682, -838.5619094479014, -419.2530886447784, -1031.7152791316935, -389.7712184864516, -1068.4533888681067, -740.2938837251356, -298.81699179421565, -993.4061255129741, -908.9123132070647, -412.35880352313023, -1117.554475218564, -673.4662333064898, -834.3085990179273, -124.6244681895197, -201.71996167928287, -653.9315119619059, -566.3597207973368, -676.3953922782815, -683.3040885531318, -963.4881047064387, -652.9584426263418, -969.1052453488827, -464.786523402372], "episode_lengths": [150, 81, 129, 150, 150, 116, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 150, 130, 150, 150, 127, 115, 150, 150, 63, 150, 150, 150, 150, 48, 150, 150, 150, 150, 150, 93, 150, 137, 150, 150, 150, 109, 150, 150, 85, 52, 60, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 150, 97, 150, 37, 116, 150, 107, 150, 150, 150, 150, 150, 85, 133, 150, 132, 150, 119, 150, 150, 80, 150, 150, 103, 150, 150, 150, 75, 100, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-499.4895670468051, -64.77777412154164, -283.9784328248218, -966.7722861632898, -731.2648893870264, -501.3691039247197, -838.2346190912561, -545.1054976904729, -688.0757656774442, -701.848604578483, -337.461104345183, -461.45758895923973, -1211.6952260625997, -443.7873366538959, -906.1876136631616, -425.81697839484985, -371.4600948098269, -334.4876645803085, -1079.9717038610183, -972.1599015219009, -615.4347043335425, -305.75609713659236, -1063.0816977498719, -1152.1850320740184, -46.85680548111614, -1036.7696332410346, -713.5252903423393, -1045.794629152117, -1255.3740771031628, -46.093461066509214, -875.5541018489156, -335.41155677656496, -940.8905044562309, -1181.0835026892796, -1001.1376812341883, -209.18609988264143, -1105.0974594916738, -438.6171809876311, -964.9316813402589, -683.7785191457585, -926.9441453171047, -389.5896189470963, -1066.4027288604213, -821.2568802686462, -87.80016274789534, -115.17868739876967, -141.8154128741504, -689.9785356054841, -239.15089501303507, -1069.0134508284168, -873.970451372173, -1174.0644692606502, -895.390387961361, -809.3711330034589, -852.1184037607957, -662.5134879639016, -889.1151237067164, -622.0551653841072, -1059.1572945648334, -1049.4656527584507, -719.6613948827595, -1195.8261587101654, -82.00447842732822, -1020.5894656971084, -361.01592996399233, -973.2841664955325, -3.3161397862596727, -362.0039013840614, -1221.8219652852013, -233.04323483798132, -928.1100369320084, -1034.6852422512861, -474.58776299449426, -791.8630473827212, -817.4860762068143, -193.39670922001665, -602.3365764991682, -838.5619094479014, -419.2530886447784, -1031.7152791316935, -389.7712184864516, -1068.4533888681067, -740.2938837251356, -298.81699179421565, -993.4061255129741, -908.9123132070647, -412.35880352313023, -1117.554475218564, -673.4662333064898, -834.3085990179273, -124.6244681895197, -201.71996167928287, -653.9315119619059, -566.3597207973368, -676.3953922782815, -683.3040885531318, -963.4881047064387, -652.9584426263418, -969.1052453488827, -464.786523402372]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29911020480807926, "mean_inference_ms": 0.926965140006476, "mean_action_processing_ms": 0.16628257579825031, "mean_env_wait_ms": 1.6958284661179976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005763530731201172, "StateBufferConnector_ms": 0.0040361881256103516, "ViewRequirementAgentConnector_ms": 0.1028444766998291}, "num_episodes": 29, "episode_return_max": -3.3161397862596727, "episode_return_min": -1255.3740771031628, "episode_return_mean": -685.148916128736, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.1784983839149, "num_env_steps_trained_throughput_per_sec": 290.1784983839149, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 284000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 284000, "timers": {"training_iteration_time_ms": 13191.158, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13191.081, "sample_time_ms": 2543.374, "learn_time_ms": 10630.001, "learn_throughput": 376.293, "synch_weights_time_ms": 16.392}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "done": false, "training_iteration": 71, "trial_id": "6d52d_00000", "date": "2024-07-26_23-00-02", "timestamp": 1722015002, "time_this_iter_s": 13.792046546936035, "time_total_s": 955.8919124603271, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c3daf80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 955.8919124603271, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 10.114999999999998, "ram_util_percent": 28.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 235.40183278520902, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 3.382936751221617, "policy_loss": -0.011974086416012142, "vf_loss": 3.397257321452101, "vf_explained_var": 0.9882717110837499, "kl": 0.01254427455963499, "entropy": 1.504755835235119, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 68640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": -3.3161397862596727, "episode_reward_min": -1221.8219652852013, "episode_reward_mean": -670.2119254410405, "episode_len_mean": 131.44, "episode_media": {}, "episodes_timesteps_total": 13144, "policy_reward_min": {"policy_0": -1221.8219652852013}, "policy_reward_max": {"policy_0": -3.3161397862596727}, "policy_reward_mean": {"policy_0": -670.2119254410405}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1181.0835026892796, -1001.1376812341883, -209.18609988264143, -1105.0974594916738, -438.6171809876311, -964.9316813402589, -683.7785191457585, -926.9441453171047, -389.5896189470963, -1066.4027288604213, -821.2568802686462, -87.80016274789534, -115.17868739876967, -141.8154128741504, -689.9785356054841, -239.15089501303507, -1069.0134508284168, -873.970451372173, -1174.0644692606502, -895.390387961361, -809.3711330034589, -852.1184037607957, -662.5134879639016, -889.1151237067164, -622.0551653841072, -1059.1572945648334, -1049.4656527584507, -719.6613948827595, -1195.8261587101654, -82.00447842732822, -1020.5894656971084, -361.01592996399233, -973.2841664955325, -3.3161397862596727, -362.0039013840614, -1221.8219652852013, -233.04323483798132, -928.1100369320084, -1034.6852422512861, -474.58776299449426, -791.8630473827212, -817.4860762068143, -193.39670922001665, -602.3365764991682, -838.5619094479014, -419.2530886447784, -1031.7152791316935, -389.7712184864516, -1068.4533888681067, -740.2938837251356, -298.81699179421565, -993.4061255129741, -908.9123132070647, -412.35880352313023, -1117.554475218564, -673.4662333064898, -834.3085990179273, -124.6244681895197, -201.71996167928287, -653.9315119619059, -566.3597207973368, -676.3953922782815, -683.3040885531318, -963.4881047064387, -652.9584426263418, -969.1052453488827, -464.786523402372, -1046.1987399239413, -434.65254330886665, -877.5429493657691, -978.1529873280749, -224.37437350208407, -20.48816184762302, -1101.1385034982384, -593.890653144606, -1036.2991281404247, -618.3105429448151, -439.4760970785855, -996.1087959340942, -1153.1294346029536, -949.2239809286189, -142.52723722547782, -906.2831865921235, -1049.746265419136, -34.981949323173566, -766.3559868917744, -91.19463262978836, -923.040984443892, -537.6606434243348, -612.2404044982819, -83.79726775441013, -974.8005569282163, -776.6648418860722, -598.4798293203949, -127.13200122159543, -1077.3106949559917, -510.19050094549846, -177.1174525525915, -20.073026449077485, -425.84592133981494], "episode_lengths": [150, 150, 93, 150, 137, 150, 150, 150, 109, 150, 150, 85, 52, 60, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 150, 97, 150, 37, 116, 150, 107, 150, 150, 150, 150, 150, 85, 133, 150, 132, 150, 119, 150, 150, 80, 150, 150, 103, 150, 150, 150, 75, 100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 110, 39, 150, 150, 150, 150, 150, 150, 150, 150, 73, 150, 150, 44, 150, 69, 150, 150, 150, 73, 150, 150, 150, 90, 150, 150, 60, 51, 150], "policy_policy_0_reward": [-1181.0835026892796, -1001.1376812341883, -209.18609988264143, -1105.0974594916738, -438.6171809876311, -964.9316813402589, -683.7785191457585, -926.9441453171047, -389.5896189470963, -1066.4027288604213, -821.2568802686462, -87.80016274789534, -115.17868739876967, -141.8154128741504, -689.9785356054841, -239.15089501303507, -1069.0134508284168, -873.970451372173, -1174.0644692606502, -895.390387961361, -809.3711330034589, -852.1184037607957, -662.5134879639016, -889.1151237067164, -622.0551653841072, -1059.1572945648334, -1049.4656527584507, -719.6613948827595, -1195.8261587101654, -82.00447842732822, -1020.5894656971084, -361.01592996399233, -973.2841664955325, -3.3161397862596727, -362.0039013840614, -1221.8219652852013, -233.04323483798132, -928.1100369320084, -1034.6852422512861, -474.58776299449426, -791.8630473827212, -817.4860762068143, -193.39670922001665, -602.3365764991682, -838.5619094479014, -419.2530886447784, -1031.7152791316935, -389.7712184864516, -1068.4533888681067, -740.2938837251356, -298.81699179421565, -993.4061255129741, -908.9123132070647, -412.35880352313023, -1117.554475218564, -673.4662333064898, -834.3085990179273, -124.6244681895197, -201.71996167928287, -653.9315119619059, -566.3597207973368, -676.3953922782815, -683.3040885531318, -963.4881047064387, -652.9584426263418, -969.1052453488827, -464.786523402372, -1046.1987399239413, -434.65254330886665, -877.5429493657691, -978.1529873280749, -224.37437350208407, -20.48816184762302, -1101.1385034982384, -593.890653144606, -1036.2991281404247, -618.3105429448151, -439.4760970785855, -996.1087959340942, -1153.1294346029536, -949.2239809286189, -142.52723722547782, -906.2831865921235, -1049.746265419136, -34.981949323173566, -766.3559868917744, -91.19463262978836, -923.040984443892, -537.6606434243348, -612.2404044982819, -83.79726775441013, -974.8005569282163, -776.6648418860722, -598.4798293203949, -127.13200122159543, -1077.3106949559917, -510.19050094549846, -177.1174525525915, -20.073026449077485, -425.84592133981494]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29888601317494873, "mean_inference_ms": 0.9266431001061289, "mean_action_processing_ms": 0.16616157629763598, "mean_env_wait_ms": 1.6914220019321613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005922079086303711, "StateBufferConnector_ms": 0.004063844680786133, "ViewRequirementAgentConnector_ms": 0.10269856452941895}, "num_episodes": 33, "episode_return_max": -3.3161397862596727, "episode_return_min": -1221.8219652852013, "episode_return_mean": -670.2119254410405, "episodes_this_iter": 33}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 324.27744292755693, "num_env_steps_trained_throughput_per_sec": 324.27744292755693, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 13082.008, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13081.93, "sample_time_ms": 2546.773, "learn_time_ms": 10517.752, "learn_throughput": 380.309, "synch_weights_time_ms": 16.103}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 72, "trial_id": "6d52d_00000", "date": "2024-07-26_23-00-14", "timestamp": 1722015014, "time_this_iter_s": 12.34183406829834, "time_total_s": 968.2337465286255, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125472ab00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 968.2337465286255, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 10.511764705882355, "ram_util_percent": 28.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 181.03598279356956, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 3.719980789224307, "policy_loss": -0.01936413770163199, "vf_loss": 3.74358942185839, "vf_explained_var": 0.9872852324818572, "kl": 0.010416126076900947, "entropy": 1.4790827931215367, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 69600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "env_runners": {"episode_reward_max": -3.3161397862596727, "episode_reward_min": -1321.0686397285624, "episode_reward_mean": -638.9120347500096, "episode_len_mean": 129.64, "episode_media": {}, "episodes_timesteps_total": 12964, "policy_reward_min": {"policy_0": -1321.0686397285624}, "policy_reward_max": {"policy_0": -3.3161397862596727}, "policy_reward_mean": {"policy_0": -638.9120347500096}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-82.00447842732822, -1020.5894656971084, -361.01592996399233, -973.2841664955325, -3.3161397862596727, -362.0039013840614, -1221.8219652852013, -233.04323483798132, -928.1100369320084, -1034.6852422512861, -474.58776299449426, -791.8630473827212, -817.4860762068143, -193.39670922001665, -602.3365764991682, -838.5619094479014, -419.2530886447784, -1031.7152791316935, -389.7712184864516, -1068.4533888681067, -740.2938837251356, -298.81699179421565, -993.4061255129741, -908.9123132070647, -412.35880352313023, -1117.554475218564, -673.4662333064898, -834.3085990179273, -124.6244681895197, -201.71996167928287, -653.9315119619059, -566.3597207973368, -676.3953922782815, -683.3040885531318, -963.4881047064387, -652.9584426263418, -969.1052453488827, -464.786523402372, -1046.1987399239413, -434.65254330886665, -877.5429493657691, -978.1529873280749, -224.37437350208407, -20.48816184762302, -1101.1385034982384, -593.890653144606, -1036.2991281404247, -618.3105429448151, -439.4760970785855, -996.1087959340942, -1153.1294346029536, -949.2239809286189, -142.52723722547782, -906.2831865921235, -1049.746265419136, -34.981949323173566, -766.3559868917744, -91.19463262978836, -923.040984443892, -537.6606434243348, -612.2404044982819, -83.79726775441013, -974.8005569282163, -776.6648418860722, -598.4798293203949, -127.13200122159543, -1077.3106949559917, -510.19050094549846, -177.1174525525915, -20.073026449077485, -425.84592133981494, -479.41112573501505, -728.3507041195037, -646.802731408241, -817.5029014168979, -244.78194181954922, -174.28368089517247, -976.6336880945089, -786.7037571296515, -1160.7215460021619, -66.47886299322354, -532.311256740542, -314.7629060345675, -1321.0686397285624, -660.929678970806, -217.03256426046278, -1013.914668306413, -368.4209463421863, -136.72988135877895, -991.375251930025, -1263.6945184715416, -1083.6061188570875, -88.05652397145336, -726.2422071404723, -872.7848546239328, -714.075598293361, -918.01375748039, -702.3593851889542, -612.5349482460261, -184.09805129924231], "episode_lengths": [86, 150, 97, 150, 37, 116, 150, 107, 150, 150, 150, 150, 150, 85, 133, 150, 132, 150, 119, 150, 150, 80, 150, 150, 103, 150, 150, 150, 75, 100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 110, 39, 150, 150, 150, 150, 150, 150, 150, 150, 73, 150, 150, 44, 150, 69, 150, 150, 150, 73, 150, 150, 150, 90, 150, 150, 60, 51, 150, 104, 150, 150, 150, 119, 85, 150, 150, 150, 68, 150, 150, 150, 150, 97, 150, 116, 54, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 76], "policy_policy_0_reward": [-82.00447842732822, -1020.5894656971084, -361.01592996399233, -973.2841664955325, -3.3161397862596727, -362.0039013840614, -1221.8219652852013, -233.04323483798132, -928.1100369320084, -1034.6852422512861, -474.58776299449426, -791.8630473827212, -817.4860762068143, -193.39670922001665, -602.3365764991682, -838.5619094479014, -419.2530886447784, -1031.7152791316935, -389.7712184864516, -1068.4533888681067, -740.2938837251356, -298.81699179421565, -993.4061255129741, -908.9123132070647, -412.35880352313023, -1117.554475218564, -673.4662333064898, -834.3085990179273, -124.6244681895197, -201.71996167928287, -653.9315119619059, -566.3597207973368, -676.3953922782815, -683.3040885531318, -963.4881047064387, -652.9584426263418, -969.1052453488827, -464.786523402372, -1046.1987399239413, -434.65254330886665, -877.5429493657691, -978.1529873280749, -224.37437350208407, -20.48816184762302, -1101.1385034982384, -593.890653144606, -1036.2991281404247, -618.3105429448151, -439.4760970785855, -996.1087959340942, -1153.1294346029536, -949.2239809286189, -142.52723722547782, -906.2831865921235, -1049.746265419136, -34.981949323173566, -766.3559868917744, -91.19463262978836, -923.040984443892, -537.6606434243348, -612.2404044982819, -83.79726775441013, -974.8005569282163, -776.6648418860722, -598.4798293203949, -127.13200122159543, -1077.3106949559917, -510.19050094549846, -177.1174525525915, -20.073026449077485, -425.84592133981494, -479.41112573501505, -728.3507041195037, -646.802731408241, -817.5029014168979, -244.78194181954922, -174.28368089517247, -976.6336880945089, -786.7037571296515, -1160.7215460021619, -66.47886299322354, -532.311256740542, -314.7629060345675, -1321.0686397285624, -660.929678970806, -217.03256426046278, -1013.914668306413, -368.4209463421863, -136.72988135877895, -991.375251930025, -1263.6945184715416, -1083.6061188570875, -88.05652397145336, -726.2422071404723, -872.7848546239328, -714.075598293361, -918.01375748039, -702.3593851889542, -612.5349482460261, -184.09805129924231]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29899335644211583, "mean_inference_ms": 0.9265128894570165, "mean_action_processing_ms": 0.16622424328840857, "mean_env_wait_ms": 1.6937239304462648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00579071044921875, "StateBufferConnector_ms": 0.0040264129638671875, "ViewRequirementAgentConnector_ms": 0.10248351097106934}, "num_episodes": 29, "episode_return_max": -3.3161397862596727, "episode_return_min": -1321.0686397285624, "episode_return_mean": -638.9120347500096, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 377.8378575101407, "num_env_steps_trained_throughput_per_sec": 377.8378575101407, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 292000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 292000, "timers": {"training_iteration_time_ms": 13030.588, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13030.506, "sample_time_ms": 2543.999, "learn_time_ms": 10469.551, "learn_throughput": 382.06, "synch_weights_time_ms": 15.672}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "done": false, "training_iteration": 73, "trial_id": "6d52d_00000", "date": "2024-07-26_23-00-25", "timestamp": 1722015025, "time_this_iter_s": 10.593256950378418, "time_total_s": 978.8270034790039, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c3d9cf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 978.8270034790039, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 11.26, "ram_util_percent": 28.600000000000012}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 229.73121880690258, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 3.9739525688191253, "policy_loss": -0.009146986461322134, "vf_loss": 3.990108236918847, "vf_explained_var": 0.965287724447747, "kl": 0.007635765496737271, "entropy": 1.473990409821272, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 70560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "env_runners": {"episode_reward_max": -20.073026449077485, "episode_reward_min": -1321.0686397285624, "episode_reward_mean": -664.3249283522407, "episode_len_mean": 132.76, "episode_media": {}, "episodes_timesteps_total": 13276, "policy_reward_min": {"policy_0": -1321.0686397285624}, "policy_reward_max": {"policy_0": -20.073026449077485}, "policy_reward_mean": {"policy_0": -664.3249283522407}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-201.71996167928287, -653.9315119619059, -566.3597207973368, -676.3953922782815, -683.3040885531318, -963.4881047064387, -652.9584426263418, -969.1052453488827, -464.786523402372, -1046.1987399239413, -434.65254330886665, -877.5429493657691, -978.1529873280749, -224.37437350208407, -20.48816184762302, -1101.1385034982384, -593.890653144606, -1036.2991281404247, -618.3105429448151, -439.4760970785855, -996.1087959340942, -1153.1294346029536, -949.2239809286189, -142.52723722547782, -906.2831865921235, -1049.746265419136, -34.981949323173566, -766.3559868917744, -91.19463262978836, -923.040984443892, -537.6606434243348, -612.2404044982819, -83.79726775441013, -974.8005569282163, -776.6648418860722, -598.4798293203949, -127.13200122159543, -1077.3106949559917, -510.19050094549846, -177.1174525525915, -20.073026449077485, -425.84592133981494, -479.41112573501505, -728.3507041195037, -646.802731408241, -817.5029014168979, -244.78194181954922, -174.28368089517247, -976.6336880945089, -786.7037571296515, -1160.7215460021619, -66.47886299322354, -532.311256740542, -314.7629060345675, -1321.0686397285624, -660.929678970806, -217.03256426046278, -1013.914668306413, -368.4209463421863, -136.72988135877895, -991.375251930025, -1263.6945184715416, -1083.6061188570875, -88.05652397145336, -726.2422071404723, -872.7848546239328, -714.075598293361, -918.01375748039, -702.3593851889542, -612.5349482460261, -184.09805129924231, -1111.3448167645702, -118.49748715001991, -839.3864893547707, -499.9598285066843, -104.0814224193679, -761.3016215747083, -133.27049263929212, -744.5946807912109, -857.4777088444162, -936.0900298236602, -992.4830842108406, -594.4135761543422, -338.7167818043702, -1045.847186658389, -1159.999808780201, -1170.6099511378397, -106.818905702685, -1023.2362797248234, -878.2798875998657, -387.77736028401335, -886.020778360193, -824.5003640484161, -971.4398454336717, -873.4891415051565, -787.4568355020155, -1001.0966891857552, -701.2944413713384, -759.9735568299816, -882.871819498428], "episode_lengths": [100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 110, 39, 150, 150, 150, 150, 150, 150, 150, 150, 73, 150, 150, 44, 150, 69, 150, 150, 150, 73, 150, 150, 150, 90, 150, 150, 60, 51, 150, 104, 150, 150, 150, 119, 85, 150, 150, 150, 68, 150, 150, 150, 150, 97, 150, 116, 54, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 76, 150, 73, 150, 135, 81, 150, 81, 150, 150, 150, 150, 150, 150, 150, 150, 150, 65, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-201.71996167928287, -653.9315119619059, -566.3597207973368, -676.3953922782815, -683.3040885531318, -963.4881047064387, -652.9584426263418, -969.1052453488827, -464.786523402372, -1046.1987399239413, -434.65254330886665, -877.5429493657691, -978.1529873280749, -224.37437350208407, -20.48816184762302, -1101.1385034982384, -593.890653144606, -1036.2991281404247, -618.3105429448151, -439.4760970785855, -996.1087959340942, -1153.1294346029536, -949.2239809286189, -142.52723722547782, -906.2831865921235, -1049.746265419136, -34.981949323173566, -766.3559868917744, -91.19463262978836, -923.040984443892, -537.6606434243348, -612.2404044982819, -83.79726775441013, -974.8005569282163, -776.6648418860722, -598.4798293203949, -127.13200122159543, -1077.3106949559917, -510.19050094549846, -177.1174525525915, -20.073026449077485, -425.84592133981494, -479.41112573501505, -728.3507041195037, -646.802731408241, -817.5029014168979, -244.78194181954922, -174.28368089517247, -976.6336880945089, -786.7037571296515, -1160.7215460021619, -66.47886299322354, -532.311256740542, -314.7629060345675, -1321.0686397285624, -660.929678970806, -217.03256426046278, -1013.914668306413, -368.4209463421863, -136.72988135877895, -991.375251930025, -1263.6945184715416, -1083.6061188570875, -88.05652397145336, -726.2422071404723, -872.7848546239328, -714.075598293361, -918.01375748039, -702.3593851889542, -612.5349482460261, -184.09805129924231, -1111.3448167645702, -118.49748715001991, -839.3864893547707, -499.9598285066843, -104.0814224193679, -761.3016215747083, -133.27049263929212, -744.5946807912109, -857.4777088444162, -936.0900298236602, -992.4830842108406, -594.4135761543422, -338.7167818043702, -1045.847186658389, -1159.999808780201, -1170.6099511378397, -106.818905702685, -1023.2362797248234, -878.2798875998657, -387.77736028401335, -886.020778360193, -824.5003640484161, -971.4398454336717, -873.4891415051565, -787.4568355020155, -1001.0966891857552, -701.2944413713384, -759.9735568299816, -882.871819498428]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2988338802308849, "mean_inference_ms": 0.9261601849846486, "mean_action_processing_ms": 0.1660637374499373, "mean_env_wait_ms": 1.6933118017644688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005617380142211914, "StateBufferConnector_ms": 0.004054546356201172, "ViewRequirementAgentConnector_ms": 0.10321855545043945}, "num_episodes": 29, "episode_return_max": -20.073026449077485, "episode_return_min": -1321.0686397285624, "episode_return_mean": -664.3249283522407, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.92954251285727, "num_env_steps_trained_throughput_per_sec": 277.92954251285727, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 296000, "timers": {"training_iteration_time_ms": 13027.266, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13027.185, "sample_time_ms": 2542.435, "learn_time_ms": 10467.985, "learn_throughput": 382.117, "synch_weights_time_ms": 15.529}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "done": false, "training_iteration": 74, "trial_id": "6d52d_00000", "date": "2024-07-26_23-00-39", "timestamp": 1722015039, "time_this_iter_s": 14.398637294769287, "time_total_s": 993.2256407737732, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125472bc70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 993.2256407737732, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 10.376190476190478, "ram_util_percent": 28.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 188.14369851549466, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 3.8883125739792983, "policy_loss": -0.012882787864267204, "vf_loss": 3.903040304283301, "vf_explained_var": 0.9714764925340812, "kl": 0.011591249755201791, "entropy": 1.3581072690586249, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 71520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "env_runners": {"episode_reward_max": -8.114869797570394, "episode_reward_min": -1321.0686397285624, "episode_reward_mean": -630.3882590867375, "episode_len_mean": 130.07, "episode_media": {}, "episodes_timesteps_total": 13007, "policy_reward_min": {"policy_0": -1321.0686397285624}, "policy_reward_max": {"policy_0": -8.114869797570394}, "policy_reward_mean": {"policy_0": -630.3882590867375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-974.8005569282163, -776.6648418860722, -598.4798293203949, -127.13200122159543, -1077.3106949559917, -510.19050094549846, -177.1174525525915, -20.073026449077485, -425.84592133981494, -479.41112573501505, -728.3507041195037, -646.802731408241, -817.5029014168979, -244.78194181954922, -174.28368089517247, -976.6336880945089, -786.7037571296515, -1160.7215460021619, -66.47886299322354, -532.311256740542, -314.7629060345675, -1321.0686397285624, -660.929678970806, -217.03256426046278, -1013.914668306413, -368.4209463421863, -136.72988135877895, -991.375251930025, -1263.6945184715416, -1083.6061188570875, -88.05652397145336, -726.2422071404723, -872.7848546239328, -714.075598293361, -918.01375748039, -702.3593851889542, -612.5349482460261, -184.09805129924231, -1111.3448167645702, -118.49748715001991, -839.3864893547707, -499.9598285066843, -104.0814224193679, -761.3016215747083, -133.27049263929212, -744.5946807912109, -857.4777088444162, -936.0900298236602, -992.4830842108406, -594.4135761543422, -338.7167818043702, -1045.847186658389, -1159.999808780201, -1170.6099511378397, -106.818905702685, -1023.2362797248234, -878.2798875998657, -387.77736028401335, -886.020778360193, -824.5003640484161, -971.4398454336717, -873.4891415051565, -787.4568355020155, -1001.0966891857552, -701.2944413713384, -759.9735568299816, -882.871819498428, -522.6726746215533, -784.4906002621711, -704.520443101504, -164.9298791726408, -916.0606856076259, -94.61110339256099, -55.3849022610099, -877.7988387103637, -590.9352451636753, -856.5852186477473, -331.426378445511, -1110.293307133563, -437.3664981604543, -722.0042240118738, -954.3174741989337, -288.01599535634716, -998.0314727267098, -850.7040386572961, -17.95543148076765, -475.6359706889559, -1210.5525386522495, -98.12980477879152, -611.0777406529699, -712.2765868517399, -408.9350036151965, -8.114869797570394, -665.8652417276991, -567.4021804794795, -226.84210598462505, -157.03793438064716, -1040.1116211396813, -27.03442416698045, -568.0770805258608], "episode_lengths": [150, 150, 150, 90, 150, 150, 60, 51, 150, 104, 150, 150, 150, 119, 85, 150, 150, 150, 68, 150, 150, 150, 150, 97, 150, 116, 54, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 76, 150, 73, 150, 135, 81, 150, 81, 150, 150, 150, 150, 150, 150, 150, 150, 150, 65, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 86, 57, 150, 150, 150, 142, 150, 146, 150, 150, 109, 150, 150, 53, 118, 150, 57, 150, 150, 131, 40, 150, 123, 100, 86, 150, 57, 150], "policy_policy_0_reward": [-974.8005569282163, -776.6648418860722, -598.4798293203949, -127.13200122159543, -1077.3106949559917, -510.19050094549846, -177.1174525525915, -20.073026449077485, -425.84592133981494, -479.41112573501505, -728.3507041195037, -646.802731408241, -817.5029014168979, -244.78194181954922, -174.28368089517247, -976.6336880945089, -786.7037571296515, -1160.7215460021619, -66.47886299322354, -532.311256740542, -314.7629060345675, -1321.0686397285624, -660.929678970806, -217.03256426046278, -1013.914668306413, -368.4209463421863, -136.72988135877895, -991.375251930025, -1263.6945184715416, -1083.6061188570875, -88.05652397145336, -726.2422071404723, -872.7848546239328, -714.075598293361, -918.01375748039, -702.3593851889542, -612.5349482460261, -184.09805129924231, -1111.3448167645702, -118.49748715001991, -839.3864893547707, -499.9598285066843, -104.0814224193679, -761.3016215747083, -133.27049263929212, -744.5946807912109, -857.4777088444162, -936.0900298236602, -992.4830842108406, -594.4135761543422, -338.7167818043702, -1045.847186658389, -1159.999808780201, -1170.6099511378397, -106.818905702685, -1023.2362797248234, -878.2798875998657, -387.77736028401335, -886.020778360193, -824.5003640484161, -971.4398454336717, -873.4891415051565, -787.4568355020155, -1001.0966891857552, -701.2944413713384, -759.9735568299816, -882.871819498428, -522.6726746215533, -784.4906002621711, -704.520443101504, -164.9298791726408, -916.0606856076259, -94.61110339256099, -55.3849022610099, -877.7988387103637, -590.9352451636753, -856.5852186477473, -331.426378445511, -1110.293307133563, -437.3664981604543, -722.0042240118738, -954.3174741989337, -288.01599535634716, -998.0314727267098, -850.7040386572961, -17.95543148076765, -475.6359706889559, -1210.5525386522495, -98.12980477879152, -611.0777406529699, -712.2765868517399, -408.9350036151965, -8.114869797570394, -665.8652417276991, -567.4021804794795, -226.84210598462505, -157.03793438064716, -1040.1116211396813, -27.03442416698045, -568.0770805258608]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29884503875149365, "mean_inference_ms": 0.925957740022335, "mean_action_processing_ms": 0.16609597663395026, "mean_env_wait_ms": 1.6929107907063161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005608797073364258, "StateBufferConnector_ms": 0.004054546356201172, "ViewRequirementAgentConnector_ms": 0.10314035415649414}, "num_episodes": 33, "episode_return_max": -8.114869797570394, "episode_return_min": -1321.0686397285624, "episode_return_mean": -630.3882590867375, "episodes_this_iter": 33}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 280.7155814366884, "num_env_steps_trained_throughput_per_sec": 280.7155814366884, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 300000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 13151.602, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13151.522, "sample_time_ms": 2528.42, "learn_time_ms": 10606.622, "learn_throughput": 377.123, "synch_weights_time_ms": 15.245}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "training_iteration": 75, "trial_id": "6d52d_00000", "date": "2024-07-26_23-00-53", "timestamp": 1722015053, "time_this_iter_s": 14.255996704101562, "time_total_s": 1007.4816374778748, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125472beb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1007.4816374778748, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 10.649999999999999, "ram_util_percent": 28.625000000000007}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 187.76893413464228, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 3.328018978362282, "policy_loss": -0.015255552897967088, "vf_loss": 3.3441566249976558, "vf_explained_var": 0.9851849256083369, "kl": 0.012553673254084735, "entropy": 1.3592682837198178, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 72480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": -8.114869797570394, "episode_reward_min": -1210.5525386522495, "episode_reward_mean": -639.1560233232132, "episode_len_mean": 131.67, "episode_media": {}, "episodes_timesteps_total": 13167, "policy_reward_min": {"policy_0": -1210.5525386522495}, "policy_reward_max": {"policy_0": -8.114869797570394}, "policy_reward_mean": {"policy_0": -639.1560233232132}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-726.2422071404723, -872.7848546239328, -714.075598293361, -918.01375748039, -702.3593851889542, -612.5349482460261, -184.09805129924231, -1111.3448167645702, -118.49748715001991, -839.3864893547707, -499.9598285066843, -104.0814224193679, -761.3016215747083, -133.27049263929212, -744.5946807912109, -857.4777088444162, -936.0900298236602, -992.4830842108406, -594.4135761543422, -338.7167818043702, -1045.847186658389, -1159.999808780201, -1170.6099511378397, -106.818905702685, -1023.2362797248234, -878.2798875998657, -387.77736028401335, -886.020778360193, -824.5003640484161, -971.4398454336717, -873.4891415051565, -787.4568355020155, -1001.0966891857552, -701.2944413713384, -759.9735568299816, -882.871819498428, -522.6726746215533, -784.4906002621711, -704.520443101504, -164.9298791726408, -916.0606856076259, -94.61110339256099, -55.3849022610099, -877.7988387103637, -590.9352451636753, -856.5852186477473, -331.426378445511, -1110.293307133563, -437.3664981604543, -722.0042240118738, -954.3174741989337, -288.01599535634716, -998.0314727267098, -850.7040386572961, -17.95543148076765, -475.6359706889559, -1210.5525386522495, -98.12980477879152, -611.0777406529699, -712.2765868517399, -408.9350036151965, -8.114869797570394, -665.8652417276991, -567.4021804794795, -226.84210598462505, -157.03793438064716, -1040.1116211396813, -27.03442416698045, -568.0770805258608, -939.7461292395544, -1010.5260424159187, -643.8748924484061, -711.44467201817, -58.00635398888969, -950.440578074407, -978.7777639115574, -594.2559130282832, -639.3655275533772, -380.4676822726965, -1004.0793288457289, -824.7247586713115, -1050.8479886846678, -618.580794308927, -133.59446295397237, -201.9412070234897, -933.6678083798791, -1133.0697791750547, -128.60540426474446, -1053.5728121074949, -889.2291652759554, -778.6946522474468, -148.23358791371442, -608.122889771981, -434.34352265251135, -141.52446262442083, -591.642304588171, -278.88250387511766, -650.1959886387004, -321.4782893523644, -806.0278775262444], "episode_lengths": [150, 150, 150, 150, 150, 150, 76, 150, 73, 150, 135, 81, 150, 81, 150, 150, 150, 150, 150, 150, 150, 150, 150, 65, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 86, 57, 150, 150, 150, 142, 150, 146, 150, 150, 109, 150, 150, 53, 118, 150, 57, 150, 150, 131, 40, 150, 123, 100, 86, 150, 57, 150, 150, 150, 150, 150, 63, 150, 150, 150, 150, 135, 150, 150, 150, 150, 71, 65, 150, 150, 57, 150, 150, 150, 66, 150, 150, 115, 150, 86, 148, 115, 150], "policy_policy_0_reward": [-726.2422071404723, -872.7848546239328, -714.075598293361, -918.01375748039, -702.3593851889542, -612.5349482460261, -184.09805129924231, -1111.3448167645702, -118.49748715001991, -839.3864893547707, -499.9598285066843, -104.0814224193679, -761.3016215747083, -133.27049263929212, -744.5946807912109, -857.4777088444162, -936.0900298236602, -992.4830842108406, -594.4135761543422, -338.7167818043702, -1045.847186658389, -1159.999808780201, -1170.6099511378397, -106.818905702685, -1023.2362797248234, -878.2798875998657, -387.77736028401335, -886.020778360193, -824.5003640484161, -971.4398454336717, -873.4891415051565, -787.4568355020155, -1001.0966891857552, -701.2944413713384, -759.9735568299816, -882.871819498428, -522.6726746215533, -784.4906002621711, -704.520443101504, -164.9298791726408, -916.0606856076259, -94.61110339256099, -55.3849022610099, -877.7988387103637, -590.9352451636753, -856.5852186477473, -331.426378445511, -1110.293307133563, -437.3664981604543, -722.0042240118738, -954.3174741989337, -288.01599535634716, -998.0314727267098, -850.7040386572961, -17.95543148076765, -475.6359706889559, -1210.5525386522495, -98.12980477879152, -611.0777406529699, -712.2765868517399, -408.9350036151965, -8.114869797570394, -665.8652417276991, -567.4021804794795, -226.84210598462505, -157.03793438064716, -1040.1116211396813, -27.03442416698045, -568.0770805258608, -939.7461292395544, -1010.5260424159187, -643.8748924484061, -711.44467201817, -58.00635398888969, -950.440578074407, -978.7777639115574, -594.2559130282832, -639.3655275533772, -380.4676822726965, -1004.0793288457289, -824.7247586713115, -1050.8479886846678, -618.580794308927, -133.59446295397237, -201.9412070234897, -933.6678083798791, -1133.0697791750547, -128.60540426474446, -1053.5728121074949, -889.2291652759554, -778.6946522474468, -148.23358791371442, -608.122889771981, -434.34352265251135, -141.52446262442083, -591.642304588171, -278.88250387511766, -650.1959886387004, -321.4782893523644, -806.0278775262444]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2986698284894233, "mean_inference_ms": 0.9256404036825563, "mean_action_processing_ms": 0.16603632543495192, "mean_env_wait_ms": 1.6903770492300458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005497455596923828, "StateBufferConnector_ms": 0.004041433334350586, "ViewRequirementAgentConnector_ms": 0.10262131690979004}, "num_episodes": 31, "episode_return_max": -8.114869797570394, "episode_return_min": -1210.5525386522495, "episode_return_mean": -639.1560233232132, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 371.1849494969742, "num_env_steps_trained_throughput_per_sec": 371.1849494969742, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 12823.384, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12823.305, "sample_time_ms": 2541.243, "learn_time_ms": 10265.946, "learn_throughput": 389.638, "synch_weights_time_ms": 14.906}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 76, "trial_id": "6d52d_00000", "date": "2024-07-26_23-01-04", "timestamp": 1722015064, "time_this_iter_s": 10.783378839492798, "time_total_s": 1018.2650163173676, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125472ba30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1018.2650163173676, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 10.71875, "ram_util_percent": 28.63125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 168.09212403496107, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 3.8087998571495216, "policy_loss": -0.012939864707004745, "vf_loss": 3.824903439854582, "vf_explained_var": 0.9814833482106526, "kl": 0.010245285773877854, "entropy": 1.3537080014745395, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 73440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "env_runners": {"episode_reward_max": -8.114869797570394, "episode_reward_min": -1210.5525386522495, "episode_reward_mean": -604.8923108496233, "episode_len_mean": 129.42, "episode_media": {}, "episodes_timesteps_total": 12942, "policy_reward_min": {"policy_0": -1210.5525386522495}, "policy_reward_max": {"policy_0": -8.114869797570394}, "policy_reward_mean": {"policy_0": -604.8923108496233}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-971.4398454336717, -873.4891415051565, -787.4568355020155, -1001.0966891857552, -701.2944413713384, -759.9735568299816, -882.871819498428, -522.6726746215533, -784.4906002621711, -704.520443101504, -164.9298791726408, -916.0606856076259, -94.61110339256099, -55.3849022610099, -877.7988387103637, -590.9352451636753, -856.5852186477473, -331.426378445511, -1110.293307133563, -437.3664981604543, -722.0042240118738, -954.3174741989337, -288.01599535634716, -998.0314727267098, -850.7040386572961, -17.95543148076765, -475.6359706889559, -1210.5525386522495, -98.12980477879152, -611.0777406529699, -712.2765868517399, -408.9350036151965, -8.114869797570394, -665.8652417276991, -567.4021804794795, -226.84210598462505, -157.03793438064716, -1040.1116211396813, -27.03442416698045, -568.0770805258608, -939.7461292395544, -1010.5260424159187, -643.8748924484061, -711.44467201817, -58.00635398888969, -950.440578074407, -978.7777639115574, -594.2559130282832, -639.3655275533772, -380.4676822726965, -1004.0793288457289, -824.7247586713115, -1050.8479886846678, -618.580794308927, -133.59446295397237, -201.9412070234897, -933.6678083798791, -1133.0697791750547, -128.60540426474446, -1053.5728121074949, -889.2291652759554, -778.6946522474468, -148.23358791371442, -608.122889771981, -434.34352265251135, -141.52446262442083, -591.642304588171, -278.88250387511766, -650.1959886387004, -321.4782893523644, -806.0278775262444, -818.4762266606103, -315.832533706987, -827.1597065839736, -92.78665407254879, -1000.7946989632184, -15.004144949020489, -918.5795097080245, -198.55059159181377, -98.86558947469145, -506.9390390691116, -482.9182536224955, -1165.773859205142, -65.06194984543927, -387.6281461567319, -612.5588142421301, -639.5098752189514, -719.7698155971209, -234.50378219491932, -725.7638642205555, -558.2904368382285, -373.37506877155437, -376.8391515614816, -593.2059102522089, -654.7048241273083, -461.25915535379124, -1001.656972825657, -1061.3707318111094, -1077.7715443293928, -833.4952462938346], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 86, 57, 150, 150, 150, 142, 150, 146, 150, 150, 109, 150, 150, 53, 118, 150, 57, 150, 150, 131, 40, 150, 123, 100, 86, 150, 57, 150, 150, 150, 150, 150, 63, 150, 150, 150, 150, 135, 150, 150, 150, 150, 71, 65, 150, 150, 57, 150, 150, 150, 66, 150, 150, 115, 150, 86, 148, 115, 150, 150, 121, 150, 95, 150, 41, 150, 72, 81, 150, 150, 150, 45, 150, 134, 150, 150, 69, 150, 150, 150, 109, 150, 150, 116, 150, 150, 150, 150], "policy_policy_0_reward": [-971.4398454336717, -873.4891415051565, -787.4568355020155, -1001.0966891857552, -701.2944413713384, -759.9735568299816, -882.871819498428, -522.6726746215533, -784.4906002621711, -704.520443101504, -164.9298791726408, -916.0606856076259, -94.61110339256099, -55.3849022610099, -877.7988387103637, -590.9352451636753, -856.5852186477473, -331.426378445511, -1110.293307133563, -437.3664981604543, -722.0042240118738, -954.3174741989337, -288.01599535634716, -998.0314727267098, -850.7040386572961, -17.95543148076765, -475.6359706889559, -1210.5525386522495, -98.12980477879152, -611.0777406529699, -712.2765868517399, -408.9350036151965, -8.114869797570394, -665.8652417276991, -567.4021804794795, -226.84210598462505, -157.03793438064716, -1040.1116211396813, -27.03442416698045, -568.0770805258608, -939.7461292395544, -1010.5260424159187, -643.8748924484061, -711.44467201817, -58.00635398888969, -950.440578074407, -978.7777639115574, -594.2559130282832, -639.3655275533772, -380.4676822726965, -1004.0793288457289, -824.7247586713115, -1050.8479886846678, -618.580794308927, -133.59446295397237, -201.9412070234897, -933.6678083798791, -1133.0697791750547, -128.60540426474446, -1053.5728121074949, -889.2291652759554, -778.6946522474468, -148.23358791371442, -608.122889771981, -434.34352265251135, -141.52446262442083, -591.642304588171, -278.88250387511766, -650.1959886387004, -321.4782893523644, -806.0278775262444, -818.4762266606103, -315.832533706987, -827.1597065839736, -92.78665407254879, -1000.7946989632184, -15.004144949020489, -918.5795097080245, -198.55059159181377, -98.86558947469145, -506.9390390691116, -482.9182536224955, -1165.773859205142, -65.06194984543927, -387.6281461567319, -612.5588142421301, -639.5098752189514, -719.7698155971209, -234.50378219491932, -725.7638642205555, -558.2904368382285, -373.37506877155437, -376.8391515614816, -593.2059102522089, -654.7048241273083, -461.25915535379124, -1001.656972825657, -1061.3707318111094, -1077.7715443293928, -833.4952462938346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29870148971618193, "mean_inference_ms": 0.92551866912501, "mean_action_processing_ms": 0.1660779891894369, "mean_env_wait_ms": 1.6915531967720085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005413055419921875, "StateBufferConnector_ms": 0.0039958953857421875, "ViewRequirementAgentConnector_ms": 0.10109376907348633}, "num_episodes": 29, "episode_return_max": -8.114869797570394, "episode_return_min": -1210.5525386522495, "episode_return_mean": -604.8923108496233, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 328.4421075723813, "num_env_steps_trained_throughput_per_sec": 328.4421075723813, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 308000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 308000, "timers": {"training_iteration_time_ms": 12575.27, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12575.191, "sample_time_ms": 2548.69, "learn_time_ms": 10010.461, "learn_throughput": 399.582, "synch_weights_time_ms": 14.827}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "done": false, "training_iteration": 77, "trial_id": "6d52d_00000", "date": "2024-07-26_23-01-17", "timestamp": 1722015077, "time_this_iter_s": 12.186789274215698, "time_total_s": 1030.4518055915833, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d139e045b40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1030.4518055915833, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 10.92941176470588, "ram_util_percent": 28.658823529411762}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 217.9994896352291, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 3.49300385179619, "policy_loss": -0.0066955680134318145, "vf_loss": 3.504239557310939, "vf_explained_var": 0.9808200826868415, "kl": 0.01311222092711744, "entropy": 1.7816259118417899, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 74400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "env_runners": {"episode_reward_max": -15.004144949020489, "episode_reward_min": -1297.926227739581, "episode_reward_mean": -622.1992561510193, "episode_len_mean": 129.37, "episode_media": {}, "episodes_timesteps_total": 12937, "policy_reward_min": {"policy_0": -1297.926227739581}, "policy_reward_max": {"policy_0": -15.004144949020489}, "policy_reward_mean": {"policy_0": -622.1992561510193}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-665.8652417276991, -567.4021804794795, -226.84210598462505, -157.03793438064716, -1040.1116211396813, -27.03442416698045, -568.0770805258608, -939.7461292395544, -1010.5260424159187, -643.8748924484061, -711.44467201817, -58.00635398888969, -950.440578074407, -978.7777639115574, -594.2559130282832, -639.3655275533772, -380.4676822726965, -1004.0793288457289, -824.7247586713115, -1050.8479886846678, -618.580794308927, -133.59446295397237, -201.9412070234897, -933.6678083798791, -1133.0697791750547, -128.60540426474446, -1053.5728121074949, -889.2291652759554, -778.6946522474468, -148.23358791371442, -608.122889771981, -434.34352265251135, -141.52446262442083, -591.642304588171, -278.88250387511766, -650.1959886387004, -321.4782893523644, -806.0278775262444, -818.4762266606103, -315.832533706987, -827.1597065839736, -92.78665407254879, -1000.7946989632184, -15.004144949020489, -918.5795097080245, -198.55059159181377, -98.86558947469145, -506.9390390691116, -482.9182536224955, -1165.773859205142, -65.06194984543927, -387.6281461567319, -612.5588142421301, -639.5098752189514, -719.7698155971209, -234.50378219491932, -725.7638642205555, -558.2904368382285, -373.37506877155437, -376.8391515614816, -593.2059102522089, -654.7048241273083, -461.25915535379124, -1001.656972825657, -1061.3707318111094, -1077.7715443293928, -833.4952462938346, -1134.239890765683, -961.3526359205046, -778.5302248070036, -475.69303938833644, -549.208810245597, -1006.914700805992, -1028.3132069418941, -1020.6267623400649, -496.9368449383826, -41.837507722501336, -1044.0251952875014, -669.8186307669382, -227.17927265690162, -319.9951728301891, -1105.686214269393, -1297.926227739581, -218.64449157100623, -825.125635756593, -102.7067485517653, -715.0325188689368, -973.651894582472, -755.0297347072583, -753.0263195309818, -168.0942734047137, -133.0851195191645, -281.2591354061284, -975.3896703137553, -1096.4529218188568, -644.3050021337021, -769.6015201783592, -1070.9463712182405, -93.04622100971348, -777.4618696176478], "episode_lengths": [150, 123, 100, 86, 150, 57, 150, 150, 150, 150, 150, 63, 150, 150, 150, 150, 135, 150, 150, 150, 150, 71, 65, 150, 150, 57, 150, 150, 150, 66, 150, 150, 115, 150, 86, 148, 115, 150, 150, 121, 150, 95, 150, 41, 150, 72, 81, 150, 150, 150, 45, 150, 134, 150, 150, 69, 150, 150, 150, 109, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 130, 56, 150, 136, 73, 150, 150, 150, 70, 150, 86, 150, 150, 150, 150, 72, 88, 91, 150, 150, 150, 150, 150, 77, 150], "policy_policy_0_reward": [-665.8652417276991, -567.4021804794795, -226.84210598462505, -157.03793438064716, -1040.1116211396813, -27.03442416698045, -568.0770805258608, -939.7461292395544, -1010.5260424159187, -643.8748924484061, -711.44467201817, -58.00635398888969, -950.440578074407, -978.7777639115574, -594.2559130282832, -639.3655275533772, -380.4676822726965, -1004.0793288457289, -824.7247586713115, -1050.8479886846678, -618.580794308927, -133.59446295397237, -201.9412070234897, -933.6678083798791, -1133.0697791750547, -128.60540426474446, -1053.5728121074949, -889.2291652759554, -778.6946522474468, -148.23358791371442, -608.122889771981, -434.34352265251135, -141.52446262442083, -591.642304588171, -278.88250387511766, -650.1959886387004, -321.4782893523644, -806.0278775262444, -818.4762266606103, -315.832533706987, -827.1597065839736, -92.78665407254879, -1000.7946989632184, -15.004144949020489, -918.5795097080245, -198.55059159181377, -98.86558947469145, -506.9390390691116, -482.9182536224955, -1165.773859205142, -65.06194984543927, -387.6281461567319, -612.5588142421301, -639.5098752189514, -719.7698155971209, -234.50378219491932, -725.7638642205555, -558.2904368382285, -373.37506877155437, -376.8391515614816, -593.2059102522089, -654.7048241273083, -461.25915535379124, -1001.656972825657, -1061.3707318111094, -1077.7715443293928, -833.4952462938346, -1134.239890765683, -961.3526359205046, -778.5302248070036, -475.69303938833644, -549.208810245597, -1006.914700805992, -1028.3132069418941, -1020.6267623400649, -496.9368449383826, -41.837507722501336, -1044.0251952875014, -669.8186307669382, -227.17927265690162, -319.9951728301891, -1105.686214269393, -1297.926227739581, -218.64449157100623, -825.125635756593, -102.7067485517653, -715.0325188689368, -973.651894582472, -755.0297347072583, -753.0263195309818, -168.0942734047137, -133.0851195191645, -281.2591354061284, -975.3896703137553, -1096.4529218188568, -644.3050021337021, -769.6015201783592, -1070.9463712182405, -93.04622100971348, -777.4618696176478]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29853399445323253, "mean_inference_ms": 0.9254104348872767, "mean_action_processing_ms": 0.16611114639410793, "mean_env_wait_ms": 1.689746522956363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005369424819946289, "StateBufferConnector_ms": 0.004047870635986328, "ViewRequirementAgentConnector_ms": 0.1024177074432373}, "num_episodes": 33, "episode_return_max": -15.004144949020489, "episode_return_min": -1297.926227739581, "episode_return_mean": -622.1992561510193, "episodes_this_iter": 33}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 351.6872132477025, "num_env_steps_trained_throughput_per_sec": 351.6872132477025, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 12260.296, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12260.219, "sample_time_ms": 2549.171, "learn_time_ms": 9695.901, "learn_throughput": 412.545, "synch_weights_time_ms": 13.992}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "training_iteration": 78, "trial_id": "6d52d_00000", "date": "2024-07-26_23-01-28", "timestamp": 1722015088, "time_this_iter_s": 11.38080358505249, "time_total_s": 1041.8326091766357, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125472ac20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1041.8326091766357, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 10.825, "ram_util_percent": 28.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 181.13717439174653, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 3.5653412327170373, "policy_loss": -0.016559570431127213, "vf_loss": 3.5880842650930087, "vf_explained_var": 0.9885574464996656, "kl": 0.009824921552596384, "entropy": 1.6131206852694353, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 75360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "env_runners": {"episode_reward_max": -15.004144949020489, "episode_reward_min": -1297.926227739581, "episode_reward_mean": -614.504495225031, "episode_len_mean": 128.39, "episode_media": {}, "episodes_timesteps_total": 12839, "policy_reward_min": {"policy_0": -1297.926227739581}, "policy_reward_max": {"policy_0": -15.004144949020489}, "policy_reward_mean": {"policy_0": -614.504495225031}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-608.122889771981, -434.34352265251135, -141.52446262442083, -591.642304588171, -278.88250387511766, -650.1959886387004, -321.4782893523644, -806.0278775262444, -818.4762266606103, -315.832533706987, -827.1597065839736, -92.78665407254879, -1000.7946989632184, -15.004144949020489, -918.5795097080245, -198.55059159181377, -98.86558947469145, -506.9390390691116, -482.9182536224955, -1165.773859205142, -65.06194984543927, -387.6281461567319, -612.5588142421301, -639.5098752189514, -719.7698155971209, -234.50378219491932, -725.7638642205555, -558.2904368382285, -373.37506877155437, -376.8391515614816, -593.2059102522089, -654.7048241273083, -461.25915535379124, -1001.656972825657, -1061.3707318111094, -1077.7715443293928, -833.4952462938346, -1134.239890765683, -961.3526359205046, -778.5302248070036, -475.69303938833644, -549.208810245597, -1006.914700805992, -1028.3132069418941, -1020.6267623400649, -496.9368449383826, -41.837507722501336, -1044.0251952875014, -669.8186307669382, -227.17927265690162, -319.9951728301891, -1105.686214269393, -1297.926227739581, -218.64449157100623, -825.125635756593, -102.7067485517653, -715.0325188689368, -973.651894582472, -755.0297347072583, -753.0263195309818, -168.0942734047137, -133.0851195191645, -281.2591354061284, -975.3896703137553, -1096.4529218188568, -644.3050021337021, -769.6015201783592, -1070.9463712182405, -93.04622100971348, -777.4618696176478, -806.9119107641914, -951.1912426428426, -464.15643404258685, -249.32796493611838, -58.469568188170534, -608.0449646130838, -354.7249180195829, -1053.1096702286186, -1063.9242546059825, -1111.083334891421, -211.64554327898972, -914.2623073295821, -55.89844332432147, -1190.3472321160007, -937.1636643115381, -55.34861582298296, -861.5422857656232, -201.77045167136316, -31.85040338520797, -1001.0866805968651, -717.9225908505114, -722.9438597501073, -338.07863392040935, -981.1011317956086, -155.74106447946716, -816.5254084692527, -122.88579925994199, -67.69650619232014, -1026.7258316586285, -1157.1610836984537], "episode_lengths": [150, 150, 115, 150, 86, 148, 115, 150, 150, 121, 150, 95, 150, 41, 150, 72, 81, 150, 150, 150, 45, 150, 134, 150, 150, 69, 150, 150, 150, 109, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 130, 56, 150, 136, 73, 150, 150, 150, 70, 150, 86, 150, 150, 150, 150, 72, 88, 91, 150, 150, 150, 150, 150, 77, 150, 150, 150, 150, 86, 58, 122, 150, 150, 150, 150, 110, 150, 59, 150, 150, 58, 150, 93, 72, 150, 150, 150, 105, 150, 102, 150, 82, 78, 150, 150], "policy_policy_0_reward": [-608.122889771981, -434.34352265251135, -141.52446262442083, -591.642304588171, -278.88250387511766, -650.1959886387004, -321.4782893523644, -806.0278775262444, -818.4762266606103, -315.832533706987, -827.1597065839736, -92.78665407254879, -1000.7946989632184, -15.004144949020489, -918.5795097080245, -198.55059159181377, -98.86558947469145, -506.9390390691116, -482.9182536224955, -1165.773859205142, -65.06194984543927, -387.6281461567319, -612.5588142421301, -639.5098752189514, -719.7698155971209, -234.50378219491932, -725.7638642205555, -558.2904368382285, -373.37506877155437, -376.8391515614816, -593.2059102522089, -654.7048241273083, -461.25915535379124, -1001.656972825657, -1061.3707318111094, -1077.7715443293928, -833.4952462938346, -1134.239890765683, -961.3526359205046, -778.5302248070036, -475.69303938833644, -549.208810245597, -1006.914700805992, -1028.3132069418941, -1020.6267623400649, -496.9368449383826, -41.837507722501336, -1044.0251952875014, -669.8186307669382, -227.17927265690162, -319.9951728301891, -1105.686214269393, -1297.926227739581, -218.64449157100623, -825.125635756593, -102.7067485517653, -715.0325188689368, -973.651894582472, -755.0297347072583, -753.0263195309818, -168.0942734047137, -133.0851195191645, -281.2591354061284, -975.3896703137553, -1096.4529218188568, -644.3050021337021, -769.6015201783592, -1070.9463712182405, -93.04622100971348, -777.4618696176478, -806.9119107641914, -951.1912426428426, -464.15643404258685, -249.32796493611838, -58.469568188170534, -608.0449646130838, -354.7249180195829, -1053.1096702286186, -1063.9242546059825, -1111.083334891421, -211.64554327898972, -914.2623073295821, -55.89844332432147, -1190.3472321160007, -937.1636643115381, -55.34861582298296, -861.5422857656232, -201.77045167136316, -31.85040338520797, -1001.0866805968651, -717.9225908505114, -722.9438597501073, -338.07863392040935, -981.1011317956086, -155.74106447946716, -816.5254084692527, -122.88579925994199, -67.69650619232014, -1026.7258316586285, -1157.1610836984537]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29862812671775624, "mean_inference_ms": 0.9252986359947383, "mean_action_processing_ms": 0.1660890495479247, "mean_env_wait_ms": 1.6926569666186522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005349636077880859, "StateBufferConnector_ms": 0.004068613052368164, "ViewRequirementAgentConnector_ms": 0.10382294654846191}, "num_episodes": 30, "episode_return_max": -15.004144949020489, "episode_return_min": -1297.926227739581, "episode_return_mean": -614.504495225031, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 284.00312597473, "num_env_steps_trained_throughput_per_sec": 284.00312597473, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 316000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 316000, "timers": {"training_iteration_time_ms": 12546.425, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12546.35, "sample_time_ms": 2546.379, "learn_time_ms": 9984.867, "learn_throughput": 400.606, "synch_weights_time_ms": 13.952}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "done": false, "training_iteration": 79, "trial_id": "6d52d_00000", "date": "2024-07-26_23-01-42", "timestamp": 1722015102, "time_this_iter_s": 14.092708587646484, "time_total_s": 1055.9253177642822, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d12547284c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1055.9253177642822, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 10.25, "ram_util_percent": 28.700000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 212.61528372367223, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 3.601549822712938, "policy_loss": -0.011458313244899425, "vf_loss": 3.6182814901073774, "vf_explained_var": 0.9864437680070599, "kl": 0.012240020265380827, "entropy": 1.7666366159915925, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 76320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": -17.896245837648763, "episode_reward_min": -1396.700144495694, "episode_reward_mean": -656.5411796575146, "episode_len_mean": 129.14, "episode_media": {}, "episodes_timesteps_total": 12914, "policy_reward_min": {"policy_0": -1396.700144495694}, "policy_reward_max": {"policy_0": -17.896245837648763}, "policy_reward_mean": {"policy_0": -656.5411796575146}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-461.25915535379124, -1001.656972825657, -1061.3707318111094, -1077.7715443293928, -833.4952462938346, -1134.239890765683, -961.3526359205046, -778.5302248070036, -475.69303938833644, -549.208810245597, -1006.914700805992, -1028.3132069418941, -1020.6267623400649, -496.9368449383826, -41.837507722501336, -1044.0251952875014, -669.8186307669382, -227.17927265690162, -319.9951728301891, -1105.686214269393, -1297.926227739581, -218.64449157100623, -825.125635756593, -102.7067485517653, -715.0325188689368, -973.651894582472, -755.0297347072583, -753.0263195309818, -168.0942734047137, -133.0851195191645, -281.2591354061284, -975.3896703137553, -1096.4529218188568, -644.3050021337021, -769.6015201783592, -1070.9463712182405, -93.04622100971348, -777.4618696176478, -806.9119107641914, -951.1912426428426, -464.15643404258685, -249.32796493611838, -58.469568188170534, -608.0449646130838, -354.7249180195829, -1053.1096702286186, -1063.9242546059825, -1111.083334891421, -211.64554327898972, -914.2623073295821, -55.89844332432147, -1190.3472321160007, -937.1636643115381, -55.34861582298296, -861.5422857656232, -201.77045167136316, -31.85040338520797, -1001.0866805968651, -717.9225908505114, -722.9438597501073, -338.07863392040935, -981.1011317956086, -155.74106447946716, -816.5254084692527, -122.88579925994199, -67.69650619232014, -1026.7258316586285, -1157.1610836984537, -241.9673993750378, -345.0057412227748, -410.37089760570683, -172.25812102644124, -995.5549731870582, -787.6047531633541, -376.6003505710081, -409.12031222974775, -1287.9734855589497, -1122.4241533073682, -993.9912648223514, -853.7669393481876, -473.27811998949187, -1032.8729231378977, -803.5031878627086, -179.2821611411769, -478.3094615404136, -375.58053598735086, -17.896245837648763, -832.6320064504163, -52.45079997414726, -275.3598670319645, -533.8046143513633, -1130.638959033293, -807.3296635316408, -1396.700144495694, -749.6959750957151, -244.5917838291083, -166.67111701578256, -1209.1500347603605, -982.898112241543, -679.4946241864452], "episode_lengths": [116, 150, 150, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 130, 56, 150, 136, 73, 150, 150, 150, 70, 150, 86, 150, 150, 150, 150, 72, 88, 91, 150, 150, 150, 150, 150, 77, 150, 150, 150, 150, 86, 58, 122, 150, 150, 150, 150, 110, 150, 59, 150, 150, 58, 150, 93, 72, 150, 150, 150, 105, 150, 102, 150, 82, 78, 150, 150, 124, 98, 107, 64, 150, 150, 114, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 43, 150, 58, 93, 150, 150, 150, 150, 150, 122, 99, 150, 150, 150], "policy_policy_0_reward": [-461.25915535379124, -1001.656972825657, -1061.3707318111094, -1077.7715443293928, -833.4952462938346, -1134.239890765683, -961.3526359205046, -778.5302248070036, -475.69303938833644, -549.208810245597, -1006.914700805992, -1028.3132069418941, -1020.6267623400649, -496.9368449383826, -41.837507722501336, -1044.0251952875014, -669.8186307669382, -227.17927265690162, -319.9951728301891, -1105.686214269393, -1297.926227739581, -218.64449157100623, -825.125635756593, -102.7067485517653, -715.0325188689368, -973.651894582472, -755.0297347072583, -753.0263195309818, -168.0942734047137, -133.0851195191645, -281.2591354061284, -975.3896703137553, -1096.4529218188568, -644.3050021337021, -769.6015201783592, -1070.9463712182405, -93.04622100971348, -777.4618696176478, -806.9119107641914, -951.1912426428426, -464.15643404258685, -249.32796493611838, -58.469568188170534, -608.0449646130838, -354.7249180195829, -1053.1096702286186, -1063.9242546059825, -1111.083334891421, -211.64554327898972, -914.2623073295821, -55.89844332432147, -1190.3472321160007, -937.1636643115381, -55.34861582298296, -861.5422857656232, -201.77045167136316, -31.85040338520797, -1001.0866805968651, -717.9225908505114, -722.9438597501073, -338.07863392040935, -981.1011317956086, -155.74106447946716, -816.5254084692527, -122.88579925994199, -67.69650619232014, -1026.7258316586285, -1157.1610836984537, -241.9673993750378, -345.0057412227748, -410.37089760570683, -172.25812102644124, -995.5549731870582, -787.6047531633541, -376.6003505710081, -409.12031222974775, -1287.9734855589497, -1122.4241533073682, -993.9912648223514, -853.7669393481876, -473.27811998949187, -1032.8729231378977, -803.5031878627086, -179.2821611411769, -478.3094615404136, -375.58053598735086, -17.896245837648763, -832.6320064504163, -52.45079997414726, -275.3598670319645, -533.8046143513633, -1130.638959033293, -807.3296635316408, -1396.700144495694, -749.6959750957151, -244.5917838291083, -166.67111701578256, -1209.1500347603605, -982.898112241543, -679.4946241864452]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29849557778119334, "mean_inference_ms": 0.9249736723225566, "mean_action_processing_ms": 0.16598296335936, "mean_env_wait_ms": 1.6912088785243509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005609989166259766, "StateBufferConnector_ms": 0.004067420959472656, "ViewRequirementAgentConnector_ms": 0.1040489673614502}, "num_episodes": 32, "episode_return_max": -17.896245837648763, "episode_return_min": -1396.700144495694, "episode_return_mean": -656.5411796575146, "episodes_this_iter": 32}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.6135979138735, "num_env_steps_trained_throughput_per_sec": 292.6135979138735, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 12743.088, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12743.012, "sample_time_ms": 2563.173, "learn_time_ms": 10164.621, "learn_throughput": 393.522, "synch_weights_time_ms": 14.014}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 80, "trial_id": "6d52d_00000", "date": "2024-07-26_23-01-56", "timestamp": 1722015116, "time_this_iter_s": 13.677159309387207, "time_total_s": 1069.6024770736694, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d139e045b40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1069.6024770736694, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 9.965, "ram_util_percent": 28.700000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 199.04551896850268, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 3.424287067229549, "policy_loss": -0.021327146729648423, "vf_loss": 3.4501772919048865, "vf_explained_var": 0.9857210469121734, "kl": 0.01053677794349527, "entropy": 1.5231558777391911, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 77280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "env_runners": {"episode_reward_max": -13.574969541261297, "episode_reward_min": -1396.700144495694, "episode_reward_mean": -667.3471392509495, "episode_len_mean": 130.03, "episode_media": {}, "episodes_timesteps_total": 13003, "policy_reward_min": {"policy_0": -1396.700144495694}, "policy_reward_max": {"policy_0": -13.574969541261297}, "policy_reward_mean": {"policy_0": -667.3471392509495}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-168.0942734047137, -133.0851195191645, -281.2591354061284, -975.3896703137553, -1096.4529218188568, -644.3050021337021, -769.6015201783592, -1070.9463712182405, -93.04622100971348, -777.4618696176478, -806.9119107641914, -951.1912426428426, -464.15643404258685, -249.32796493611838, -58.469568188170534, -608.0449646130838, -354.7249180195829, -1053.1096702286186, -1063.9242546059825, -1111.083334891421, -211.64554327898972, -914.2623073295821, -55.89844332432147, -1190.3472321160007, -937.1636643115381, -55.34861582298296, -861.5422857656232, -201.77045167136316, -31.85040338520797, -1001.0866805968651, -717.9225908505114, -722.9438597501073, -338.07863392040935, -981.1011317956086, -155.74106447946716, -816.5254084692527, -122.88579925994199, -67.69650619232014, -1026.7258316586285, -1157.1610836984537, -241.9673993750378, -345.0057412227748, -410.37089760570683, -172.25812102644124, -995.5549731870582, -787.6047531633541, -376.6003505710081, -409.12031222974775, -1287.9734855589497, -1122.4241533073682, -993.9912648223514, -853.7669393481876, -473.27811998949187, -1032.8729231378977, -803.5031878627086, -179.2821611411769, -478.3094615404136, -375.58053598735086, -17.896245837648763, -832.6320064504163, -52.45079997414726, -275.3598670319645, -533.8046143513633, -1130.638959033293, -807.3296635316408, -1396.700144495694, -749.6959750957151, -244.5917838291083, -166.67111701578256, -1209.1500347603605, -982.898112241543, -679.4946241864452, -1032.1778718017167, -1041.77033258949, -1092.7330483908024, -500.09362782605854, -1105.1112043790095, -698.1374992902272, -641.0735985999935, -1080.0488329369362, -762.7822848082433, -1160.3777750869076, -484.60776139989736, -76.06070458850691, -1036.799914929177, -414.60366694172296, -185.21913852816138, -845.8549280057665, -644.069067670937, -912.0266724177866, -702.8572324395689, -840.3787521189807, -442.3198854254462, -962.6825624752562, -1230.886068559792, -1084.3212682455528, -1156.2609676866207, -909.3375462027814, -13.574969541261297, -961.4841080661308], "episode_lengths": [72, 88, 91, 150, 150, 150, 150, 150, 77, 150, 150, 150, 150, 86, 58, 122, 150, 150, 150, 150, 110, 150, 59, 150, 150, 58, 150, 93, 72, 150, 150, 150, 105, 150, 102, 150, 82, 78, 150, 150, 124, 98, 107, 64, 150, 150, 114, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 43, 150, 58, 93, 150, 150, 150, 150, 150, 122, 99, 150, 150, 150, 150, 150, 150, 134, 150, 150, 150, 150, 150, 150, 121, 70, 150, 150, 104, 150, 150, 150, 150, 150, 129, 150, 150, 150, 150, 150, 36, 150], "policy_policy_0_reward": [-168.0942734047137, -133.0851195191645, -281.2591354061284, -975.3896703137553, -1096.4529218188568, -644.3050021337021, -769.6015201783592, -1070.9463712182405, -93.04622100971348, -777.4618696176478, -806.9119107641914, -951.1912426428426, -464.15643404258685, -249.32796493611838, -58.469568188170534, -608.0449646130838, -354.7249180195829, -1053.1096702286186, -1063.9242546059825, -1111.083334891421, -211.64554327898972, -914.2623073295821, -55.89844332432147, -1190.3472321160007, -937.1636643115381, -55.34861582298296, -861.5422857656232, -201.77045167136316, -31.85040338520797, -1001.0866805968651, -717.9225908505114, -722.9438597501073, -338.07863392040935, -981.1011317956086, -155.74106447946716, -816.5254084692527, -122.88579925994199, -67.69650619232014, -1026.7258316586285, -1157.1610836984537, -241.9673993750378, -345.0057412227748, -410.37089760570683, -172.25812102644124, -995.5549731870582, -787.6047531633541, -376.6003505710081, -409.12031222974775, -1287.9734855589497, -1122.4241533073682, -993.9912648223514, -853.7669393481876, -473.27811998949187, -1032.8729231378977, -803.5031878627086, -179.2821611411769, -478.3094615404136, -375.58053598735086, -17.896245837648763, -832.6320064504163, -52.45079997414726, -275.3598670319645, -533.8046143513633, -1130.638959033293, -807.3296635316408, -1396.700144495694, -749.6959750957151, -244.5917838291083, -166.67111701578256, -1209.1500347603605, -982.898112241543, -679.4946241864452, -1032.1778718017167, -1041.77033258949, -1092.7330483908024, -500.09362782605854, -1105.1112043790095, -698.1374992902272, -641.0735985999935, -1080.0488329369362, -762.7822848082433, -1160.3777750869076, -484.60776139989736, -76.06070458850691, -1036.799914929177, -414.60366694172296, -185.21913852816138, -845.8549280057665, -644.069067670937, -912.0266724177866, -702.8572324395689, -840.3787521189807, -442.3198854254462, -962.6825624752562, -1230.886068559792, -1084.3212682455528, -1156.2609676866207, -909.3375462027814, -13.574969541261297, -961.4841080661308]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29862766430650467, "mean_inference_ms": 0.9247997793937403, "mean_action_processing_ms": 0.166007924807056, "mean_env_wait_ms": 1.6937977691245876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005645751953125, "StateBufferConnector_ms": 0.003977060317993164, "ViewRequirementAgentConnector_ms": 0.10202240943908691}, "num_episodes": 28, "episode_return_max": -13.574969541261297, "episode_return_min": -1396.700144495694, "episode_return_mean": -667.3471392509495, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.44917019104116, "num_env_steps_trained_throughput_per_sec": 308.44917019104116, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 324000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 12661.436, "restore_workers_time_ms": 0.024, "training_step_time_ms": 12661.362, "sample_time_ms": 2557.156, "learn_time_ms": 10088.869, "learn_throughput": 396.477, "synch_weights_time_ms": 14.156}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "training_iteration": 81, "trial_id": "6d52d_00000", "date": "2024-07-26_23-02-09", "timestamp": 1722015129, "time_this_iter_s": 12.974850177764893, "time_total_s": 1082.5773272514343, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c39dd80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1082.5773272514343, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 10.555555555555555, "ram_util_percent": 28.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 181.67859387993812, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 3.826230483750502, "policy_loss": -0.013610774464905263, "vf_loss": 3.84613155250748, "vf_explained_var": 0.9836260806769133, "kl": 0.010869268935372722, "entropy": 1.7295420188456774, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 78240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "env_runners": {"episode_reward_max": -0.4056155080251339, "episode_reward_min": -1396.700144495694, "episode_reward_mean": -660.7946575947311, "episode_len_mean": 131.17, "episode_media": {}, "episodes_timesteps_total": 13117, "policy_reward_min": {"policy_0": -1396.700144495694}, "policy_reward_max": {"policy_0": -0.4056155080251339}, "policy_reward_mean": {"policy_0": -660.7946575947311}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-722.9438597501073, -338.07863392040935, -981.1011317956086, -155.74106447946716, -816.5254084692527, -122.88579925994199, -67.69650619232014, -1026.7258316586285, -1157.1610836984537, -241.9673993750378, -345.0057412227748, -410.37089760570683, -172.25812102644124, -995.5549731870582, -787.6047531633541, -376.6003505710081, -409.12031222974775, -1287.9734855589497, -1122.4241533073682, -993.9912648223514, -853.7669393481876, -473.27811998949187, -1032.8729231378977, -803.5031878627086, -179.2821611411769, -478.3094615404136, -375.58053598735086, -17.896245837648763, -832.6320064504163, -52.45079997414726, -275.3598670319645, -533.8046143513633, -1130.638959033293, -807.3296635316408, -1396.700144495694, -749.6959750957151, -244.5917838291083, -166.67111701578256, -1209.1500347603605, -982.898112241543, -679.4946241864452, -1032.1778718017167, -1041.77033258949, -1092.7330483908024, -500.09362782605854, -1105.1112043790095, -698.1374992902272, -641.0735985999935, -1080.0488329369362, -762.7822848082433, -1160.3777750869076, -484.60776139989736, -76.06070458850691, -1036.799914929177, -414.60366694172296, -185.21913852816138, -845.8549280057665, -644.069067670937, -912.0266724177866, -702.8572324395689, -840.3787521189807, -442.3198854254462, -962.6825624752562, -1230.886068559792, -1084.3212682455528, -1156.2609676866207, -909.3375462027814, -13.574969541261297, -961.4841080661308, -368.3635031677304, -1061.1561693910337, -982.1172389896374, -612.5367889049403, -0.4056155080251339, -595.2913942152676, -913.4803629397566, -1026.1373960539322, -152.5975479764987, -621.2599467710007, -1214.2276261804504, -59.1726374205709, -1033.9286849799773, -554.2032754615739, -768.8368207056293, -1057.1857876699362, -778.3335629606364, -347.35001693753856, -130.15344116502808, -444.880784410149, -469.3269321824012, -1074.2308433153946, -54.587979550161236, -645.2135010554181, -981.0072873388118, -550.8575952405554, -80.95183086990752, -163.95139076543555, -792.0212297130022, -194.87787070846127, -525.5313578351813], "episode_lengths": [150, 105, 150, 102, 150, 82, 78, 150, 150, 124, 98, 107, 64, 150, 150, 114, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 43, 150, 58, 93, 150, 150, 150, 150, 150, 122, 99, 150, 150, 150, 150, 150, 150, 134, 150, 150, 150, 150, 150, 150, 121, 70, 150, 150, 104, 150, 150, 150, 150, 150, 129, 150, 150, 150, 150, 150, 36, 150, 132, 150, 150, 150, 34, 150, 150, 150, 80, 150, 150, 66, 150, 150, 150, 150, 150, 150, 99, 113, 150, 150, 50, 150, 150, 116, 77, 89, 150, 94, 150], "policy_policy_0_reward": [-722.9438597501073, -338.07863392040935, -981.1011317956086, -155.74106447946716, -816.5254084692527, -122.88579925994199, -67.69650619232014, -1026.7258316586285, -1157.1610836984537, -241.9673993750378, -345.0057412227748, -410.37089760570683, -172.25812102644124, -995.5549731870582, -787.6047531633541, -376.6003505710081, -409.12031222974775, -1287.9734855589497, -1122.4241533073682, -993.9912648223514, -853.7669393481876, -473.27811998949187, -1032.8729231378977, -803.5031878627086, -179.2821611411769, -478.3094615404136, -375.58053598735086, -17.896245837648763, -832.6320064504163, -52.45079997414726, -275.3598670319645, -533.8046143513633, -1130.638959033293, -807.3296635316408, -1396.700144495694, -749.6959750957151, -244.5917838291083, -166.67111701578256, -1209.1500347603605, -982.898112241543, -679.4946241864452, -1032.1778718017167, -1041.77033258949, -1092.7330483908024, -500.09362782605854, -1105.1112043790095, -698.1374992902272, -641.0735985999935, -1080.0488329369362, -762.7822848082433, -1160.3777750869076, -484.60776139989736, -76.06070458850691, -1036.799914929177, -414.60366694172296, -185.21913852816138, -845.8549280057665, -644.069067670937, -912.0266724177866, -702.8572324395689, -840.3787521189807, -442.3198854254462, -962.6825624752562, -1230.886068559792, -1084.3212682455528, -1156.2609676866207, -909.3375462027814, -13.574969541261297, -961.4841080661308, -368.3635031677304, -1061.1561693910337, -982.1172389896374, -612.5367889049403, -0.4056155080251339, -595.2913942152676, -913.4803629397566, -1026.1373960539322, -152.5975479764987, -621.2599467710007, -1214.2276261804504, -59.1726374205709, -1033.9286849799773, -554.2032754615739, -768.8368207056293, -1057.1857876699362, -778.3335629606364, -347.35001693753856, -130.15344116502808, -444.880784410149, -469.3269321824012, -1074.2308433153946, -54.587979550161236, -645.2135010554181, -981.0072873388118, -550.8575952405554, -80.95183086990752, -163.95139076543555, -792.0212297130022, -194.87787070846127, -525.5313578351813]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29848358450688095, "mean_inference_ms": 0.9245519048320213, "mean_action_processing_ms": 0.1659753080552904, "mean_env_wait_ms": 1.6926955326481739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00578618049621582, "StateBufferConnector_ms": 0.004053592681884766, "ViewRequirementAgentConnector_ms": 0.10306525230407715}, "num_episodes": 31, "episode_return_max": -0.4056155080251339, "episode_return_min": -1396.700144495694, "episode_return_mean": -660.7946575947311, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.28450353299394, "num_env_steps_trained_throughput_per_sec": 315.28450353299394, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 328000, "timers": {"training_iteration_time_ms": 12696.621, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12696.543, "sample_time_ms": 2559.209, "learn_time_ms": 10121.599, "learn_throughput": 395.194, "synch_weights_time_ms": 14.505}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "done": false, "training_iteration": 82, "trial_id": "6d52d_00000", "date": "2024-07-26_23-02-22", "timestamp": 1722015142, "time_this_iter_s": 12.694925308227539, "time_total_s": 1095.2722525596619, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c39e9e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1095.2722525596619, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 10.47777777777778, "ram_util_percent": 28.622222222222224}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 230.36087238788605, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 3.3002343338603777, "policy_loss": -0.015166119713103398, "vf_loss": 3.3213897557308276, "vf_explained_var": 0.9847159753243129, "kl": 0.010946620572940527, "entropy": 1.7072763677686453, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 79200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "env_runners": {"episode_reward_max": -0.4056155080251339, "episode_reward_min": -1396.700144495694, "episode_reward_mean": -705.3323984951073, "episode_len_mean": 135.11, "episode_media": {}, "episodes_timesteps_total": 13511, "policy_reward_min": {"policy_0": -1396.700144495694}, "policy_reward_max": {"policy_0": -0.4056155080251339}, "policy_reward_mean": {"policy_0": -705.3323984951073}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-275.3598670319645, -533.8046143513633, -1130.638959033293, -807.3296635316408, -1396.700144495694, -749.6959750957151, -244.5917838291083, -166.67111701578256, -1209.1500347603605, -982.898112241543, -679.4946241864452, -1032.1778718017167, -1041.77033258949, -1092.7330483908024, -500.09362782605854, -1105.1112043790095, -698.1374992902272, -641.0735985999935, -1080.0488329369362, -762.7822848082433, -1160.3777750869076, -484.60776139989736, -76.06070458850691, -1036.799914929177, -414.60366694172296, -185.21913852816138, -845.8549280057665, -644.069067670937, -912.0266724177866, -702.8572324395689, -840.3787521189807, -442.3198854254462, -962.6825624752562, -1230.886068559792, -1084.3212682455528, -1156.2609676866207, -909.3375462027814, -13.574969541261297, -961.4841080661308, -368.3635031677304, -1061.1561693910337, -982.1172389896374, -612.5367889049403, -0.4056155080251339, -595.2913942152676, -913.4803629397566, -1026.1373960539322, -152.5975479764987, -621.2599467710007, -1214.2276261804504, -59.1726374205709, -1033.9286849799773, -554.2032754615739, -768.8368207056293, -1057.1857876699362, -778.3335629606364, -347.35001693753856, -130.15344116502808, -444.880784410149, -469.3269321824012, -1074.2308433153946, -54.587979550161236, -645.2135010554181, -981.0072873388118, -550.8575952405554, -80.95183086990752, -163.95139076543555, -792.0212297130022, -194.87787070846127, -525.5313578351813, -1018.8365474498901, -255.19187859674264, -70.99299031424542, -260.5274543987002, -808.7133853492485, -446.25224391986677, -1316.1088978906969, -881.8104611151707, -788.8255605068267, -1075.855578386265, -844.5184824025592, -952.277303122347, -802.051812305004, -761.4411284922744, -1076.851282287057, -648.0691910304598, -165.51959485278482, -952.9668197701591, -740.3666548671441, -684.8564738114678, -905.9345447080825, -1091.8866964656195, -851.5163661153031, -378.96617904958737, -814.0264135592153, -1022.3241543013758, -963.1983223202933, -243.97893643657503, -508.67206627246003, -752.5398225036381], "episode_lengths": [93, 150, 150, 150, 150, 150, 122, 99, 150, 150, 150, 150, 150, 150, 134, 150, 150, 150, 150, 150, 150, 121, 70, 150, 150, 104, 150, 150, 150, 150, 150, 129, 150, 150, 150, 150, 150, 36, 150, 132, 150, 150, 150, 34, 150, 150, 150, 80, 150, 150, 66, 150, 150, 150, 150, 150, 150, 99, 113, 150, 150, 50, 150, 150, 116, 77, 89, 150, 94, 150, 150, 77, 52, 126, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 88, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 132, 150], "policy_policy_0_reward": [-275.3598670319645, -533.8046143513633, -1130.638959033293, -807.3296635316408, -1396.700144495694, -749.6959750957151, -244.5917838291083, -166.67111701578256, -1209.1500347603605, -982.898112241543, -679.4946241864452, -1032.1778718017167, -1041.77033258949, -1092.7330483908024, -500.09362782605854, -1105.1112043790095, -698.1374992902272, -641.0735985999935, -1080.0488329369362, -762.7822848082433, -1160.3777750869076, -484.60776139989736, -76.06070458850691, -1036.799914929177, -414.60366694172296, -185.21913852816138, -845.8549280057665, -644.069067670937, -912.0266724177866, -702.8572324395689, -840.3787521189807, -442.3198854254462, -962.6825624752562, -1230.886068559792, -1084.3212682455528, -1156.2609676866207, -909.3375462027814, -13.574969541261297, -961.4841080661308, -368.3635031677304, -1061.1561693910337, -982.1172389896374, -612.5367889049403, -0.4056155080251339, -595.2913942152676, -913.4803629397566, -1026.1373960539322, -152.5975479764987, -621.2599467710007, -1214.2276261804504, -59.1726374205709, -1033.9286849799773, -554.2032754615739, -768.8368207056293, -1057.1857876699362, -778.3335629606364, -347.35001693753856, -130.15344116502808, -444.880784410149, -469.3269321824012, -1074.2308433153946, -54.587979550161236, -645.2135010554181, -981.0072873388118, -550.8575952405554, -80.95183086990752, -163.95139076543555, -792.0212297130022, -194.87787070846127, -525.5313578351813, -1018.8365474498901, -255.19187859674264, -70.99299031424542, -260.5274543987002, -808.7133853492485, -446.25224391986677, -1316.1088978906969, -881.8104611151707, -788.8255605068267, -1075.855578386265, -844.5184824025592, -952.277303122347, -802.051812305004, -761.4411284922744, -1076.851282287057, -648.0691910304598, -165.51959485278482, -952.9668197701591, -740.3666548671441, -684.8564738114678, -905.9345447080825, -1091.8866964656195, -851.5163661153031, -378.96617904958737, -814.0264135592153, -1022.3241543013758, -963.1983223202933, -243.97893643657503, -508.67206627246003, -752.5398225036381]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2984492813798301, "mean_inference_ms": 0.9243028126467903, "mean_action_processing_ms": 0.16593202189341152, "mean_env_wait_ms": 1.6935992796118473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005625009536743164, "StateBufferConnector_ms": 0.004050016403198242, "ViewRequirementAgentConnector_ms": 0.10301446914672852}, "num_episodes": 30, "episode_return_max": -0.4056155080251339, "episode_return_min": -1396.700144495694, "episode_return_mean": -705.3323984951073, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 280.27537298095996, "num_env_steps_trained_throughput_per_sec": 280.27537298095996, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 332000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 332000, "timers": {"training_iteration_time_ms": 13065.133, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13065.058, "sample_time_ms": 2563.62, "learn_time_ms": 10484.993, "learn_throughput": 381.498, "synch_weights_time_ms": 15.139}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "done": false, "training_iteration": 83, "trial_id": "6d52d_00000", "date": "2024-07-26_23-02-36", "timestamp": 1722015156, "time_this_iter_s": 14.278664112091064, "time_total_s": 1109.550916671753, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d139e045b40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1109.550916671753, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 10.19047619047619, "ram_util_percent": 28.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 210.22300121386846, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 3.8265556366493305, "policy_loss": -0.011987118186516455, "vf_loss": 3.8389370578030744, "vf_explained_var": 0.9786849829678734, "kl": 0.01234102945551672, "entropy": 1.288959709306558, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 80160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": -0.4056155080251339, "episode_reward_min": -1316.1088978906969, "episode_reward_mean": -627.9907919088118, "episode_len_mean": 128.86, "episode_media": {}, "episodes_timesteps_total": 12886, "policy_reward_min": {"policy_0": -1316.1088978906969}, "policy_reward_max": {"policy_0": -0.4056155080251339}, "policy_reward_mean": {"policy_0": -627.9907919088118}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-962.6825624752562, -1230.886068559792, -1084.3212682455528, -1156.2609676866207, -909.3375462027814, -13.574969541261297, -961.4841080661308, -368.3635031677304, -1061.1561693910337, -982.1172389896374, -612.5367889049403, -0.4056155080251339, -595.2913942152676, -913.4803629397566, -1026.1373960539322, -152.5975479764987, -621.2599467710007, -1214.2276261804504, -59.1726374205709, -1033.9286849799773, -554.2032754615739, -768.8368207056293, -1057.1857876699362, -778.3335629606364, -347.35001693753856, -130.15344116502808, -444.880784410149, -469.3269321824012, -1074.2308433153946, -54.587979550161236, -645.2135010554181, -981.0072873388118, -550.8575952405554, -80.95183086990752, -163.95139076543555, -792.0212297130022, -194.87787070846127, -525.5313578351813, -1018.8365474498901, -255.19187859674264, -70.99299031424542, -260.5274543987002, -808.7133853492485, -446.25224391986677, -1316.1088978906969, -881.8104611151707, -788.8255605068267, -1075.855578386265, -844.5184824025592, -952.277303122347, -802.051812305004, -761.4411284922744, -1076.851282287057, -648.0691910304598, -165.51959485278482, -952.9668197701591, -740.3666548671441, -684.8564738114678, -905.9345447080825, -1091.8866964656195, -851.5163661153031, -378.96617904958737, -814.0264135592153, -1022.3241543013758, -963.1983223202933, -243.97893643657503, -508.67206627246003, -752.5398225036381, -732.5080753620092, -745.9475776239859, -837.8586673953758, -37.233562137785015, -792.8700383913009, -315.7500931476222, -964.6609576062615, -101.77192699770458, -149.4591485999431, -436.22131949336904, -48.55186503141255, -310.76652960807166, -707.8496442502013, -151.35520484386024, -871.3837396160536, -217.29222122845428, -366.7258714377591, -332.5756314663845, -1051.5747227888896, -556.9807695934286, -607.672969125856, -917.3395454683044, -9.790810206485515, -507.35128574704373, -787.3450026686114, -364.4497527270286, -632.2090262710224, -363.4036325802674, -954.2776405392308, -970.7701464797123, -221.86262380451265, -75.46803488074278], "episode_lengths": [150, 150, 150, 150, 150, 36, 150, 132, 150, 150, 150, 34, 150, 150, 150, 80, 150, 150, 66, 150, 150, 150, 150, 150, 150, 99, 113, 150, 150, 50, 150, 150, 116, 77, 89, 150, 94, 150, 150, 77, 52, 126, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 88, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 132, 150, 150, 150, 150, 47, 150, 91, 150, 78, 73, 150, 41, 94, 150, 68, 150, 80, 150, 124, 150, 150, 150, 150, 55, 150, 150, 116, 150, 112, 150, 150, 109, 59], "policy_policy_0_reward": [-962.6825624752562, -1230.886068559792, -1084.3212682455528, -1156.2609676866207, -909.3375462027814, -13.574969541261297, -961.4841080661308, -368.3635031677304, -1061.1561693910337, -982.1172389896374, -612.5367889049403, -0.4056155080251339, -595.2913942152676, -913.4803629397566, -1026.1373960539322, -152.5975479764987, -621.2599467710007, -1214.2276261804504, -59.1726374205709, -1033.9286849799773, -554.2032754615739, -768.8368207056293, -1057.1857876699362, -778.3335629606364, -347.35001693753856, -130.15344116502808, -444.880784410149, -469.3269321824012, -1074.2308433153946, -54.587979550161236, -645.2135010554181, -981.0072873388118, -550.8575952405554, -80.95183086990752, -163.95139076543555, -792.0212297130022, -194.87787070846127, -525.5313578351813, -1018.8365474498901, -255.19187859674264, -70.99299031424542, -260.5274543987002, -808.7133853492485, -446.25224391986677, -1316.1088978906969, -881.8104611151707, -788.8255605068267, -1075.855578386265, -844.5184824025592, -952.277303122347, -802.051812305004, -761.4411284922744, -1076.851282287057, -648.0691910304598, -165.51959485278482, -952.9668197701591, -740.3666548671441, -684.8564738114678, -905.9345447080825, -1091.8866964656195, -851.5163661153031, -378.96617904958737, -814.0264135592153, -1022.3241543013758, -963.1983223202933, -243.97893643657503, -508.67206627246003, -752.5398225036381, -732.5080753620092, -745.9475776239859, -837.8586673953758, -37.233562137785015, -792.8700383913009, -315.7500931476222, -964.6609576062615, -101.77192699770458, -149.4591485999431, -436.22131949336904, -48.55186503141255, -310.76652960807166, -707.8496442502013, -151.35520484386024, -871.3837396160536, -217.29222122845428, -366.7258714377591, -332.5756314663845, -1051.5747227888896, -556.9807695934286, -607.672969125856, -917.3395454683044, -9.790810206485515, -507.35128574704373, -787.3450026686114, -364.4497527270286, -632.2090262710224, -363.4036325802674, -954.2776405392308, -970.7701464797123, -221.86262380451265, -75.46803488074278]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29818240534284796, "mean_inference_ms": 0.9240248677360404, "mean_action_processing_ms": 0.16588194420044494, "mean_env_wait_ms": 1.6902079509744266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005482196807861328, "StateBufferConnector_ms": 0.0041124820709228516, "ViewRequirementAgentConnector_ms": 0.10375690460205078}, "num_episodes": 32, "episode_return_max": -0.4056155080251339, "episode_return_min": -1316.1088978906969, "episode_return_mean": -627.9907919088118, "episodes_this_iter": 32}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.8632511470157, "num_env_steps_trained_throughput_per_sec": 290.8632511470157, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 13001.136, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13001.061, "sample_time_ms": 2546.919, "learn_time_ms": 10437.827, "learn_throughput": 383.222, "synch_weights_time_ms": 15.028}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 84, "trial_id": "6d52d_00000", "date": "2024-07-26_23-02-50", "timestamp": 1722015170, "time_this_iter_s": 13.760361433029175, "time_total_s": 1123.311278104782, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125472ae60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1123.311278104782, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 13.826315789473687, "ram_util_percent": 28.68421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 210.7284649193287, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 3.3105445304264625, "policy_loss": -0.015661591437916893, "vf_loss": 3.3321225358794133, "vf_explained_var": 0.9843617775167028, "kl": 0.010058732203591181, "entropy": 1.6100883344809214, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 81120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "env_runners": {"episode_reward_max": -9.790810206485515, "episode_reward_min": -1316.1088978906969, "episode_reward_mean": -619.0610907502991, "episode_len_mean": 129.55, "episode_media": {}, "episodes_timesteps_total": 12955, "policy_reward_min": {"policy_0": -1316.1088978906969}, "policy_reward_max": {"policy_0": -9.790810206485515}, "policy_reward_mean": {"policy_0": -619.0610907502991}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-550.8575952405554, -80.95183086990752, -163.95139076543555, -792.0212297130022, -194.87787070846127, -525.5313578351813, -1018.8365474498901, -255.19187859674264, -70.99299031424542, -260.5274543987002, -808.7133853492485, -446.25224391986677, -1316.1088978906969, -881.8104611151707, -788.8255605068267, -1075.855578386265, -844.5184824025592, -952.277303122347, -802.051812305004, -761.4411284922744, -1076.851282287057, -648.0691910304598, -165.51959485278482, -952.9668197701591, -740.3666548671441, -684.8564738114678, -905.9345447080825, -1091.8866964656195, -851.5163661153031, -378.96617904958737, -814.0264135592153, -1022.3241543013758, -963.1983223202933, -243.97893643657503, -508.67206627246003, -752.5398225036381, -732.5080753620092, -745.9475776239859, -837.8586673953758, -37.233562137785015, -792.8700383913009, -315.7500931476222, -964.6609576062615, -101.77192699770458, -149.4591485999431, -436.22131949336904, -48.55186503141255, -310.76652960807166, -707.8496442502013, -151.35520484386024, -871.3837396160536, -217.29222122845428, -366.7258714377591, -332.5756314663845, -1051.5747227888896, -556.9807695934286, -607.672969125856, -917.3395454683044, -9.790810206485515, -507.35128574704373, -787.3450026686114, -364.4497527270286, -632.2090262710224, -363.4036325802674, -954.2776405392308, -970.7701464797123, -221.86262380451265, -75.46803488074278, -552.5279249215918, -620.3288184712031, -560.0766305235824, -1067.2929649332868, -1011.417471101789, -659.1157055878392, -989.6134548703558, -547.0416221096043, -1236.526540698454, -1027.6576091963113, -436.87077116290396, -964.5312210394801, -661.0240664142497, -496.30347134893435, -64.45724851289656, -489.8166440418839, -684.9307705291491, -1140.7717323175987, -62.38772303021859, -830.1683441066639, -742.2993963333253, -197.74014409813856, -979.2778954801804, -1063.121328674358, -855.8124785918017, -13.418937278071903, -172.30529538312112, -199.32998434761433, -834.700250685381, -888.2005365363285, -363.69156908127127, -958.8039687700152], "episode_lengths": [116, 77, 89, 150, 94, 150, 150, 77, 52, 126, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 88, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 132, 150, 150, 150, 150, 47, 150, 91, 150, 78, 73, 150, 41, 94, 150, 68, 150, 80, 150, 124, 150, 150, 150, 150, 55, 150, 150, 116, 150, 112, 150, 150, 109, 59, 139, 150, 150, 150, 150, 134, 150, 150, 150, 150, 145, 150, 150, 150, 68, 137, 150, 150, 68, 150, 150, 95, 150, 150, 150, 37, 74, 82, 150, 150, 150, 150], "policy_policy_0_reward": [-550.8575952405554, -80.95183086990752, -163.95139076543555, -792.0212297130022, -194.87787070846127, -525.5313578351813, -1018.8365474498901, -255.19187859674264, -70.99299031424542, -260.5274543987002, -808.7133853492485, -446.25224391986677, -1316.1088978906969, -881.8104611151707, -788.8255605068267, -1075.855578386265, -844.5184824025592, -952.277303122347, -802.051812305004, -761.4411284922744, -1076.851282287057, -648.0691910304598, -165.51959485278482, -952.9668197701591, -740.3666548671441, -684.8564738114678, -905.9345447080825, -1091.8866964656195, -851.5163661153031, -378.96617904958737, -814.0264135592153, -1022.3241543013758, -963.1983223202933, -243.97893643657503, -508.67206627246003, -752.5398225036381, -732.5080753620092, -745.9475776239859, -837.8586673953758, -37.233562137785015, -792.8700383913009, -315.7500931476222, -964.6609576062615, -101.77192699770458, -149.4591485999431, -436.22131949336904, -48.55186503141255, -310.76652960807166, -707.8496442502013, -151.35520484386024, -871.3837396160536, -217.29222122845428, -366.7258714377591, -332.5756314663845, -1051.5747227888896, -556.9807695934286, -607.672969125856, -917.3395454683044, -9.790810206485515, -507.35128574704373, -787.3450026686114, -364.4497527270286, -632.2090262710224, -363.4036325802674, -954.2776405392308, -970.7701464797123, -221.86262380451265, -75.46803488074278, -552.5279249215918, -620.3288184712031, -560.0766305235824, -1067.2929649332868, -1011.417471101789, -659.1157055878392, -989.6134548703558, -547.0416221096043, -1236.526540698454, -1027.6576091963113, -436.87077116290396, -964.5312210394801, -661.0240664142497, -496.30347134893435, -64.45724851289656, -489.8166440418839, -684.9307705291491, -1140.7717323175987, -62.38772303021859, -830.1683441066639, -742.2993963333253, -197.74014409813856, -979.2778954801804, -1063.121328674358, -855.8124785918017, -13.418937278071903, -172.30529538312112, -199.32998434761433, -834.700250685381, -888.2005365363285, -363.69156908127127, -958.8039687700152]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2981084858811684, "mean_inference_ms": 0.9237871684949589, "mean_action_processing_ms": 0.1658430032481985, "mean_env_wait_ms": 1.6890142167006112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005324125289916992, "StateBufferConnector_ms": 0.0040781497955322266, "ViewRequirementAgentConnector_ms": 0.10325908660888672}, "num_episodes": 32, "episode_return_max": -9.790810206485515, "episode_return_min": -1316.1088978906969, "episode_return_mean": -619.0610907502991, "episodes_this_iter": 32}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 275.42294492631487, "num_env_steps_trained_throughput_per_sec": 275.42294492631487, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 340000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 340000, "timers": {"training_iteration_time_ms": 13028.518, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13028.445, "sample_time_ms": 2556.086, "learn_time_ms": 10456.039, "learn_throughput": 382.554, "synch_weights_time_ms": 15.053}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "done": false, "training_iteration": 85, "trial_id": "6d52d_00000", "date": "2024-07-26_23-03-04", "timestamp": 1722015184, "time_this_iter_s": 14.532035827636719, "time_total_s": 1137.8433139324188, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125472bbe0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1137.8433139324188, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 11.609523809523811, "ram_util_percent": 28.819047619047616}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 205.97590629259744, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 3.6761200321217378, "policy_loss": -0.017876040534853626, "vf_loss": 3.701017677535613, "vf_explained_var": 0.9918185892204444, "kl": 0.011781681169759394, "entropy": 1.8950562838464975, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 82080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "env_runners": {"episode_reward_max": -9.790810206485515, "episode_reward_min": -1236.526540698454, "episode_reward_mean": -583.4335264359851, "episode_len_mean": 124.9, "episode_media": {}, "episodes_timesteps_total": 12490, "policy_reward_min": {"policy_0": -1236.526540698454}, "policy_reward_max": {"policy_0": -9.790810206485515}, "policy_reward_mean": {"policy_0": -583.4335264359851}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1022.3241543013758, -963.1983223202933, -243.97893643657503, -508.67206627246003, -752.5398225036381, -732.5080753620092, -745.9475776239859, -837.8586673953758, -37.233562137785015, -792.8700383913009, -315.7500931476222, -964.6609576062615, -101.77192699770458, -149.4591485999431, -436.22131949336904, -48.55186503141255, -310.76652960807166, -707.8496442502013, -151.35520484386024, -871.3837396160536, -217.29222122845428, -366.7258714377591, -332.5756314663845, -1051.5747227888896, -556.9807695934286, -607.672969125856, -917.3395454683044, -9.790810206485515, -507.35128574704373, -787.3450026686114, -364.4497527270286, -632.2090262710224, -363.4036325802674, -954.2776405392308, -970.7701464797123, -221.86262380451265, -75.46803488074278, -552.5279249215918, -620.3288184712031, -560.0766305235824, -1067.2929649332868, -1011.417471101789, -659.1157055878392, -989.6134548703558, -547.0416221096043, -1236.526540698454, -1027.6576091963113, -436.87077116290396, -964.5312210394801, -661.0240664142497, -496.30347134893435, -64.45724851289656, -489.8166440418839, -684.9307705291491, -1140.7717323175987, -62.38772303021859, -830.1683441066639, -742.2993963333253, -197.74014409813856, -979.2778954801804, -1063.121328674358, -855.8124785918017, -13.418937278071903, -172.30529538312112, -199.32998434761433, -834.700250685381, -888.2005365363285, -363.69156908127127, -958.8039687700152, -818.0893109594787, -1190.7596617120928, -179.84173502757113, -478.7973846536252, -859.3901911301496, -106.57070225094989, -1038.6867843709697, -890.8977063599283, -690.658078271926, -117.77514193304152, -1032.0099887992815, -1063.34690755899, -1151.0405077133225, -820.695455382761, -163.4997103369609, -103.38305680225385, -224.3619207057172, -1211.63476649501, -460.8293205379298, -1034.961020681977, -156.73558970717488, -777.9851199238627, -39.73723568617218, -677.8814161974564, -898.1785350051272, -323.7562799216858, -354.7491844946471, -38.889863533967365, -351.4795387538774, -68.97603445745992, -14.200635102497715], "episode_lengths": [150, 150, 79, 132, 150, 150, 150, 150, 47, 150, 91, 150, 78, 73, 150, 41, 94, 150, 68, 150, 80, 150, 124, 150, 150, 150, 150, 55, 150, 150, 116, 150, 112, 150, 150, 109, 59, 139, 150, 150, 150, 150, 134, 150, 150, 150, 150, 145, 150, 150, 150, 68, 137, 150, 150, 68, 150, 150, 95, 150, 150, 150, 37, 74, 82, 150, 150, 150, 150, 150, 150, 69, 150, 150, 70, 150, 150, 150, 78, 150, 150, 150, 150, 99, 75, 114, 150, 150, 150, 63, 150, 40, 150, 150, 150, 96, 56, 126, 76, 41], "policy_policy_0_reward": [-1022.3241543013758, -963.1983223202933, -243.97893643657503, -508.67206627246003, -752.5398225036381, -732.5080753620092, -745.9475776239859, -837.8586673953758, -37.233562137785015, -792.8700383913009, -315.7500931476222, -964.6609576062615, -101.77192699770458, -149.4591485999431, -436.22131949336904, -48.55186503141255, -310.76652960807166, -707.8496442502013, -151.35520484386024, -871.3837396160536, -217.29222122845428, -366.7258714377591, -332.5756314663845, -1051.5747227888896, -556.9807695934286, -607.672969125856, -917.3395454683044, -9.790810206485515, -507.35128574704373, -787.3450026686114, -364.4497527270286, -632.2090262710224, -363.4036325802674, -954.2776405392308, -970.7701464797123, -221.86262380451265, -75.46803488074278, -552.5279249215918, -620.3288184712031, -560.0766305235824, -1067.2929649332868, -1011.417471101789, -659.1157055878392, -989.6134548703558, -547.0416221096043, -1236.526540698454, -1027.6576091963113, -436.87077116290396, -964.5312210394801, -661.0240664142497, -496.30347134893435, -64.45724851289656, -489.8166440418839, -684.9307705291491, -1140.7717323175987, -62.38772303021859, -830.1683441066639, -742.2993963333253, -197.74014409813856, -979.2778954801804, -1063.121328674358, -855.8124785918017, -13.418937278071903, -172.30529538312112, -199.32998434761433, -834.700250685381, -888.2005365363285, -363.69156908127127, -958.8039687700152, -818.0893109594787, -1190.7596617120928, -179.84173502757113, -478.7973846536252, -859.3901911301496, -106.57070225094989, -1038.6867843709697, -890.8977063599283, -690.658078271926, -117.77514193304152, -1032.0099887992815, -1063.34690755899, -1151.0405077133225, -820.695455382761, -163.4997103369609, -103.38305680225385, -224.3619207057172, -1211.63476649501, -460.8293205379298, -1034.961020681977, -156.73558970717488, -777.9851199238627, -39.73723568617218, -677.8814161974564, -898.1785350051272, -323.7562799216858, -354.7491844946471, -38.889863533967365, -351.4795387538774, -68.97603445745992, -14.200635102497715]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2982640015716081, "mean_inference_ms": 0.9239176300221701, "mean_action_processing_ms": 0.16595597757872807, "mean_env_wait_ms": 1.6910427725183275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005480289459228516, "StateBufferConnector_ms": 0.004075765609741211, "ViewRequirementAgentConnector_ms": 0.10271739959716797}, "num_episodes": 31, "episode_return_max": -9.790810206485515, "episode_return_min": -1236.526540698454, "episode_return_mean": -583.4335264359851, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 282.029001157822, "num_env_steps_trained_throughput_per_sec": 282.029001157822, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 344000, "timers": {"training_iteration_time_ms": 13369.181, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13369.109, "sample_time_ms": 2559.253, "learn_time_ms": 10793.202, "learn_throughput": 370.604, "synch_weights_time_ms": 15.365}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "done": false, "training_iteration": 86, "trial_id": "6d52d_00000", "date": "2024-07-26_23-03-19", "timestamp": 1722015199, "time_this_iter_s": 14.192298650741577, "time_total_s": 1152.0356125831604, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d139e045b40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1152.0356125831604, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 13.23, "ram_util_percent": 28.845}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 193.4796388864517, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 3.405908301472664, "policy_loss": -0.015714547649743813, "vf_loss": 3.4260328876475494, "vf_explained_var": 0.9876583694169919, "kl": 0.012984710073578827, "entropy": 1.7557063383360705, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 83040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "env_runners": {"episode_reward_max": -13.418937278071903, "episode_reward_min": -1344.9731206587032, "episode_reward_mean": -644.7410272343101, "episode_len_mean": 131.13, "episode_media": {}, "episodes_timesteps_total": 13113, "policy_reward_min": {"policy_0": -1344.9731206587032}, "policy_reward_max": {"policy_0": -13.418937278071903}, "policy_reward_mean": {"policy_0": -644.7410272343101}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-787.3450026686114, -364.4497527270286, -632.2090262710224, -363.4036325802674, -954.2776405392308, -970.7701464797123, -221.86262380451265, -75.46803488074278, -552.5279249215918, -620.3288184712031, -560.0766305235824, -1067.2929649332868, -1011.417471101789, -659.1157055878392, -989.6134548703558, -547.0416221096043, -1236.526540698454, -1027.6576091963113, -436.87077116290396, -964.5312210394801, -661.0240664142497, -496.30347134893435, -64.45724851289656, -489.8166440418839, -684.9307705291491, -1140.7717323175987, -62.38772303021859, -830.1683441066639, -742.2993963333253, -197.74014409813856, -979.2778954801804, -1063.121328674358, -855.8124785918017, -13.418937278071903, -172.30529538312112, -199.32998434761433, -834.700250685381, -888.2005365363285, -363.69156908127127, -958.8039687700152, -818.0893109594787, -1190.7596617120928, -179.84173502757113, -478.7973846536252, -859.3901911301496, -106.57070225094989, -1038.6867843709697, -890.8977063599283, -690.658078271926, -117.77514193304152, -1032.0099887992815, -1063.34690755899, -1151.0405077133225, -820.695455382761, -163.4997103369609, -103.38305680225385, -224.3619207057172, -1211.63476649501, -460.8293205379298, -1034.961020681977, -156.73558970717488, -777.9851199238627, -39.73723568617218, -677.8814161974564, -898.1785350051272, -323.7562799216858, -354.7491844946471, -38.889863533967365, -351.4795387538774, -68.97603445745992, -14.200635102497715, -790.4161011242378, -138.65368400278345, -944.009520253045, -548.226125930601, -1120.6657168071374, -1010.0155384873875, -696.0521669171168, -739.043178893679, -254.87464491714633, -428.6284056918229, -1225.6609519058964, -1344.9731206587032, -470.04530434630755, -972.4938791278013, -331.3060390734148, -329.50143717276273, -422.21197407293477, -889.5974089404207, -1113.382833288167, -349.59948467435174, -923.8582810860297, -1196.8706642172845, -555.9367679032088, -326.9158407788965, -812.759565344474, -998.7334216689659, -260.5981889933917, -1013.4267590449533, -1184.4985535114965], "episode_lengths": [150, 116, 150, 112, 150, 150, 109, 59, 139, 150, 150, 150, 150, 134, 150, 150, 150, 150, 145, 150, 150, 150, 68, 137, 150, 150, 68, 150, 150, 95, 150, 150, 150, 37, 74, 82, 150, 150, 150, 150, 150, 150, 69, 150, 150, 70, 150, 150, 150, 78, 150, 150, 150, 150, 99, 75, 114, 150, 150, 150, 63, 150, 40, 150, 150, 150, 96, 56, 126, 76, 41, 150, 86, 150, 150, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 93, 150, 150, 150, 150, 150, 150, 95, 150, 150], "policy_policy_0_reward": [-787.3450026686114, -364.4497527270286, -632.2090262710224, -363.4036325802674, -954.2776405392308, -970.7701464797123, -221.86262380451265, -75.46803488074278, -552.5279249215918, -620.3288184712031, -560.0766305235824, -1067.2929649332868, -1011.417471101789, -659.1157055878392, -989.6134548703558, -547.0416221096043, -1236.526540698454, -1027.6576091963113, -436.87077116290396, -964.5312210394801, -661.0240664142497, -496.30347134893435, -64.45724851289656, -489.8166440418839, -684.9307705291491, -1140.7717323175987, -62.38772303021859, -830.1683441066639, -742.2993963333253, -197.74014409813856, -979.2778954801804, -1063.121328674358, -855.8124785918017, -13.418937278071903, -172.30529538312112, -199.32998434761433, -834.700250685381, -888.2005365363285, -363.69156908127127, -958.8039687700152, -818.0893109594787, -1190.7596617120928, -179.84173502757113, -478.7973846536252, -859.3901911301496, -106.57070225094989, -1038.6867843709697, -890.8977063599283, -690.658078271926, -117.77514193304152, -1032.0099887992815, -1063.34690755899, -1151.0405077133225, -820.695455382761, -163.4997103369609, -103.38305680225385, -224.3619207057172, -1211.63476649501, -460.8293205379298, -1034.961020681977, -156.73558970717488, -777.9851199238627, -39.73723568617218, -677.8814161974564, -898.1785350051272, -323.7562799216858, -354.7491844946471, -38.889863533967365, -351.4795387538774, -68.97603445745992, -14.200635102497715, -790.4161011242378, -138.65368400278345, -944.009520253045, -548.226125930601, -1120.6657168071374, -1010.0155384873875, -696.0521669171168, -739.043178893679, -254.87464491714633, -428.6284056918229, -1225.6609519058964, -1344.9731206587032, -470.04530434630755, -972.4938791278013, -331.3060390734148, -329.50143717276273, -422.21197407293477, -889.5974089404207, -1113.382833288167, -349.59948467435174, -923.8582810860297, -1196.8706642172845, -555.9367679032088, -326.9158407788965, -812.759565344474, -998.7334216689659, -260.5981889933917, -1013.4267590449533, -1184.4985535114965]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2983496437640429, "mean_inference_ms": 0.9239356407385547, "mean_action_processing_ms": 0.16597743030941153, "mean_env_wait_ms": 1.692616613992228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057947635650634766, "StateBufferConnector_ms": 0.0041506290435791016, "ViewRequirementAgentConnector_ms": 0.10398507118225098}, "num_episodes": 29, "episode_return_max": -13.418937278071903, "episode_return_min": -1344.9731206587032, "episode_return_mean": -644.7410272343101, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 282.37545100469464, "num_env_steps_trained_throughput_per_sec": 282.37545100469464, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 348000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 13567.865, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13567.791, "sample_time_ms": 2580.64, "learn_time_ms": 10970.284, "learn_throughput": 364.621, "synch_weights_time_ms": 15.547}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "training_iteration": 87, "trial_id": "6d52d_00000", "date": "2024-07-26_23-03-33", "timestamp": 1722015213, "time_this_iter_s": 14.173368453979492, "time_total_s": 1166.20898103714, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d1254791120>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1166.20898103714, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 10.47, "ram_util_percent": 28.804999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 218.15144576827686, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 3.4657278936356306, "policy_loss": -0.014683424481093728, "vf_loss": 3.485211937253674, "vf_explained_var": 0.9807476182778676, "kl": 0.012920628423065345, "entropy": 1.788276373470823, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": -13.418937278071903, "episode_reward_min": -1344.9731206587032, "episode_reward_mean": -656.474713012826, "episode_len_mean": 130.91, "episode_media": {}, "episodes_timesteps_total": 13091, "policy_reward_min": {"policy_0": -1344.9731206587032}, "policy_reward_max": {"policy_0": -13.418937278071903}, "policy_reward_mean": {"policy_0": -656.474713012826}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-197.74014409813856, -979.2778954801804, -1063.121328674358, -855.8124785918017, -13.418937278071903, -172.30529538312112, -199.32998434761433, -834.700250685381, -888.2005365363285, -363.69156908127127, -958.8039687700152, -818.0893109594787, -1190.7596617120928, -179.84173502757113, -478.7973846536252, -859.3901911301496, -106.57070225094989, -1038.6867843709697, -890.8977063599283, -690.658078271926, -117.77514193304152, -1032.0099887992815, -1063.34690755899, -1151.0405077133225, -820.695455382761, -163.4997103369609, -103.38305680225385, -224.3619207057172, -1211.63476649501, -460.8293205379298, -1034.961020681977, -156.73558970717488, -777.9851199238627, -39.73723568617218, -677.8814161974564, -898.1785350051272, -323.7562799216858, -354.7491844946471, -38.889863533967365, -351.4795387538774, -68.97603445745992, -14.200635102497715, -790.4161011242378, -138.65368400278345, -944.009520253045, -548.226125930601, -1120.6657168071374, -1010.0155384873875, -696.0521669171168, -739.043178893679, -254.87464491714633, -428.6284056918229, -1225.6609519058964, -1344.9731206587032, -470.04530434630755, -972.4938791278013, -331.3060390734148, -329.50143717276273, -422.21197407293477, -889.5974089404207, -1113.382833288167, -349.59948467435174, -923.8582810860297, -1196.8706642172845, -555.9367679032088, -326.9158407788965, -812.759565344474, -998.7334216689659, -260.5981889933917, -1013.4267590449533, -1184.4985535114965, -514.0939943507647, -1021.8329831749222, -429.2670500223784, -1320.8740612391982, -1306.6541585696818, -820.2913667476713, -654.2954227598682, -67.5767674917765, -49.34084807059605, -774.053144045893, -239.99616468332675, -789.6396922932241, -478.182607908581, -978.2966346933285, -815.919930936719, -669.8322019186398, -388.38950265053694, -956.4812219651695, -1017.7705061801411, -1064.2396307746787, -823.8758003767844, -694.4278949647706, -49.60163234806846, -745.1754176621047, -740.0907015393773, -820.3153909720903, -961.3947141753717, -1149.2572015863625, -47.14792495200929], "episode_lengths": [95, 150, 150, 150, 37, 74, 82, 150, 150, 150, 150, 150, 150, 69, 150, 150, 70, 150, 150, 150, 78, 150, 150, 150, 150, 99, 75, 114, 150, 150, 150, 63, 150, 40, 150, 150, 150, 96, 56, 126, 76, 41, 150, 86, 150, 150, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 93, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 148, 150, 150, 150, 150, 75, 56, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 146, 150, 150, 150, 150, 44], "policy_policy_0_reward": [-197.74014409813856, -979.2778954801804, -1063.121328674358, -855.8124785918017, -13.418937278071903, -172.30529538312112, -199.32998434761433, -834.700250685381, -888.2005365363285, -363.69156908127127, -958.8039687700152, -818.0893109594787, -1190.7596617120928, -179.84173502757113, -478.7973846536252, -859.3901911301496, -106.57070225094989, -1038.6867843709697, -890.8977063599283, -690.658078271926, -117.77514193304152, -1032.0099887992815, -1063.34690755899, -1151.0405077133225, -820.695455382761, -163.4997103369609, -103.38305680225385, -224.3619207057172, -1211.63476649501, -460.8293205379298, -1034.961020681977, -156.73558970717488, -777.9851199238627, -39.73723568617218, -677.8814161974564, -898.1785350051272, -323.7562799216858, -354.7491844946471, -38.889863533967365, -351.4795387538774, -68.97603445745992, -14.200635102497715, -790.4161011242378, -138.65368400278345, -944.009520253045, -548.226125930601, -1120.6657168071374, -1010.0155384873875, -696.0521669171168, -739.043178893679, -254.87464491714633, -428.6284056918229, -1225.6609519058964, -1344.9731206587032, -470.04530434630755, -972.4938791278013, -331.3060390734148, -329.50143717276273, -422.21197407293477, -889.5974089404207, -1113.382833288167, -349.59948467435174, -923.8582810860297, -1196.8706642172845, -555.9367679032088, -326.9158407788965, -812.759565344474, -998.7334216689659, -260.5981889933917, -1013.4267590449533, -1184.4985535114965, -514.0939943507647, -1021.8329831749222, -429.2670500223784, -1320.8740612391982, -1306.6541585696818, -820.2913667476713, -654.2954227598682, -67.5767674917765, -49.34084807059605, -774.053144045893, -239.99616468332675, -789.6396922932241, -478.182607908581, -978.2966346933285, -815.919930936719, -669.8322019186398, -388.38950265053694, -956.4812219651695, -1017.7705061801411, -1064.2396307746787, -823.8758003767844, -694.4278949647706, -49.60163234806846, -745.1754176621047, -740.0907015393773, -820.3153909720903, -961.3947141753717, -1149.2572015863625, -47.14792495200929]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2984129850049611, "mean_inference_ms": 0.924107105426501, "mean_action_processing_ms": 0.16600899111408998, "mean_env_wait_ms": 1.6956149960712292, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006072044372558594, "StateBufferConnector_ms": 0.0041656494140625, "ViewRequirementAgentConnector_ms": 0.10391616821289062}, "num_episodes": 29, "episode_return_max": -13.418937278071903, "episode_return_min": -1344.9731206587032, "episode_return_mean": -656.474713012826, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.3682179202235, "num_env_steps_trained_throughput_per_sec": 297.3682179202235, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 13775.625, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13775.548, "sample_time_ms": 2586.74, "learn_time_ms": 11171.972, "learn_throughput": 358.039, "synch_weights_time_ms": 15.515}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 88, "trial_id": "6d52d_00000", "date": "2024-07-26_23-03-46", "timestamp": 1722015226, "time_this_iter_s": 13.460190534591675, "time_total_s": 1179.6691715717316, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125472bbe0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1179.6691715717316, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 13.209999999999999, "ram_util_percent": 28.839999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 178.85492010513943, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 4.3633576693634195, "policy_loss": -0.012580673077415365, "vf_loss": 4.379223810384671, "vf_explained_var": 0.9739773680145541, "kl": 0.011835418095506707, "entropy": 1.5268837990239263, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "env_runners": {"episode_reward_max": -14.200635102497715, "episode_reward_min": -1344.9731206587032, "episode_reward_mean": -660.8444719528118, "episode_len_mean": 133.26, "episode_media": {}, "episodes_timesteps_total": 13326, "policy_reward_min": {"policy_0": -1344.9731206587032}, "policy_reward_max": {"policy_0": -14.200635102497715}, "policy_reward_mean": {"policy_0": -660.8444719528118}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1034.961020681977, -156.73558970717488, -777.9851199238627, -39.73723568617218, -677.8814161974564, -898.1785350051272, -323.7562799216858, -354.7491844946471, -38.889863533967365, -351.4795387538774, -68.97603445745992, -14.200635102497715, -790.4161011242378, -138.65368400278345, -944.009520253045, -548.226125930601, -1120.6657168071374, -1010.0155384873875, -696.0521669171168, -739.043178893679, -254.87464491714633, -428.6284056918229, -1225.6609519058964, -1344.9731206587032, -470.04530434630755, -972.4938791278013, -331.3060390734148, -329.50143717276273, -422.21197407293477, -889.5974089404207, -1113.382833288167, -349.59948467435174, -923.8582810860297, -1196.8706642172845, -555.9367679032088, -326.9158407788965, -812.759565344474, -998.7334216689659, -260.5981889933917, -1013.4267590449533, -1184.4985535114965, -514.0939943507647, -1021.8329831749222, -429.2670500223784, -1320.8740612391982, -1306.6541585696818, -820.2913667476713, -654.2954227598682, -67.5767674917765, -49.34084807059605, -774.053144045893, -239.99616468332675, -789.6396922932241, -478.182607908581, -978.2966346933285, -815.919930936719, -669.8322019186398, -388.38950265053694, -956.4812219651695, -1017.7705061801411, -1064.2396307746787, -823.8758003767844, -694.4278949647706, -49.60163234806846, -745.1754176621047, -740.0907015393773, -820.3153909720903, -961.3947141753717, -1149.2572015863625, -47.14792495200929, -1091.746167093578, -17.427572823747123, -1260.8151723434298, -927.1907734856795, -1089.0279042771124, -573.1720338102016, -552.0380889150825, -524.9167080316807, -538.2664845264901, -773.4055702003296, -818.1244405373167, -1054.3801840658384, -650.3201362484084, -543.6717477005407, -823.8648712979627, -266.53839755345905, -644.9357471165243, -391.47415364085316, -128.02703216446278, -283.6720914187299, -818.5267481169358, -462.0164122189075, -727.402397150758, -666.7661663727821, -214.63404412040748, -945.1616076072928, -496.1542742072185, -1205.2033243299877, -877.1093039698267, -199.65705858127623], "episode_lengths": [150, 63, 150, 40, 150, 150, 150, 96, 56, 126, 76, 41, 150, 86, 150, 150, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 93, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 148, 150, 150, 150, 150, 75, 56, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 146, 150, 150, 150, 150, 44, 150, 44, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 150, 87, 150, 150, 64, 107, 150, 150, 150, 150, 75, 150, 121, 150, 150, 111], "policy_policy_0_reward": [-1034.961020681977, -156.73558970717488, -777.9851199238627, -39.73723568617218, -677.8814161974564, -898.1785350051272, -323.7562799216858, -354.7491844946471, -38.889863533967365, -351.4795387538774, -68.97603445745992, -14.200635102497715, -790.4161011242378, -138.65368400278345, -944.009520253045, -548.226125930601, -1120.6657168071374, -1010.0155384873875, -696.0521669171168, -739.043178893679, -254.87464491714633, -428.6284056918229, -1225.6609519058964, -1344.9731206587032, -470.04530434630755, -972.4938791278013, -331.3060390734148, -329.50143717276273, -422.21197407293477, -889.5974089404207, -1113.382833288167, -349.59948467435174, -923.8582810860297, -1196.8706642172845, -555.9367679032088, -326.9158407788965, -812.759565344474, -998.7334216689659, -260.5981889933917, -1013.4267590449533, -1184.4985535114965, -514.0939943507647, -1021.8329831749222, -429.2670500223784, -1320.8740612391982, -1306.6541585696818, -820.2913667476713, -654.2954227598682, -67.5767674917765, -49.34084807059605, -774.053144045893, -239.99616468332675, -789.6396922932241, -478.182607908581, -978.2966346933285, -815.919930936719, -669.8322019186398, -388.38950265053694, -956.4812219651695, -1017.7705061801411, -1064.2396307746787, -823.8758003767844, -694.4278949647706, -49.60163234806846, -745.1754176621047, -740.0907015393773, -820.3153909720903, -961.3947141753717, -1149.2572015863625, -47.14792495200929, -1091.746167093578, -17.427572823747123, -1260.8151723434298, -927.1907734856795, -1089.0279042771124, -573.1720338102016, -552.0380889150825, -524.9167080316807, -538.2664845264901, -773.4055702003296, -818.1244405373167, -1054.3801840658384, -650.3201362484084, -543.6717477005407, -823.8648712979627, -266.53839755345905, -644.9357471165243, -391.47415364085316, -128.02703216446278, -283.6720914187299, -818.5267481169358, -462.0164122189075, -727.402397150758, -666.7661663727821, -214.63404412040748, -945.1616076072928, -496.1542742072185, -1205.2033243299877, -877.1093039698267, -199.65705858127623]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2983794422492475, "mean_inference_ms": 0.9241502057244969, "mean_action_processing_ms": 0.16604182995845015, "mean_env_wait_ms": 1.6952969725868625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006102323532104492, "StateBufferConnector_ms": 0.004169464111328125, "ViewRequirementAgentConnector_ms": 0.10478901863098145}, "num_episodes": 30, "episode_return_max": -14.200635102497715, "episode_return_min": -1344.9731206587032, "episode_return_mean": -660.8444719528118, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 328.39700225960144, "num_env_steps_trained_throughput_per_sec": 328.39700225960144, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 356000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 356000, "timers": {"training_iteration_time_ms": 13585.228, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13585.15, "sample_time_ms": 2599.365, "learn_time_ms": 10968.273, "learn_throughput": 364.688, "synch_weights_time_ms": 16.14}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "done": false, "training_iteration": 89, "trial_id": "6d52d_00000", "date": "2024-07-26_23-03-58", "timestamp": 1722015238, "time_this_iter_s": 12.187146186828613, "time_total_s": 1191.8563177585602, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125472b5b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1191.8563177585602, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 12.205882352941176, "ram_util_percent": 28.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 140.82979267636935, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 4.058331108341615, "policy_loss": -0.013007601354426393, "vf_loss": 4.0727910354733465, "vf_explained_var": 0.9528822022800644, "kl": 0.011571763085279055, "entropy": 1.3168727175022166, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 85920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": -15.896351826812294, "episode_reward_min": -1320.8740612391982, "episode_reward_mean": -612.0178493280272, "episode_len_mean": 130.15, "episode_media": {}, "episodes_timesteps_total": 13015, "policy_reward_min": {"policy_0": -1320.8740612391982}, "policy_reward_max": {"policy_0": -15.896351826812294}, "policy_reward_mean": {"policy_0": -612.0178493280272}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1196.8706642172845, -555.9367679032088, -326.9158407788965, -812.759565344474, -998.7334216689659, -260.5981889933917, -1013.4267590449533, -1184.4985535114965, -514.0939943507647, -1021.8329831749222, -429.2670500223784, -1320.8740612391982, -1306.6541585696818, -820.2913667476713, -654.2954227598682, -67.5767674917765, -49.34084807059605, -774.053144045893, -239.99616468332675, -789.6396922932241, -478.182607908581, -978.2966346933285, -815.919930936719, -669.8322019186398, -388.38950265053694, -956.4812219651695, -1017.7705061801411, -1064.2396307746787, -823.8758003767844, -694.4278949647706, -49.60163234806846, -745.1754176621047, -740.0907015393773, -820.3153909720903, -961.3947141753717, -1149.2572015863625, -47.14792495200929, -1091.746167093578, -17.427572823747123, -1260.8151723434298, -927.1907734856795, -1089.0279042771124, -573.1720338102016, -552.0380889150825, -524.9167080316807, -538.2664845264901, -773.4055702003296, -818.1244405373167, -1054.3801840658384, -650.3201362484084, -543.6717477005407, -823.8648712979627, -266.53839755345905, -644.9357471165243, -391.47415364085316, -128.02703216446278, -283.6720914187299, -818.5267481169358, -462.0164122189075, -727.402397150758, -666.7661663727821, -214.63404412040748, -945.1616076072928, -496.1542742072185, -1205.2033243299877, -877.1093039698267, -199.65705858127623, -435.635336384958, -540.1919335114676, -634.2430819157648, -763.5839353114064, -693.5101395503207, -360.1669588103109, -521.5936564102169, -345.66823263488357, -235.0242628970685, -880.1960898205549, -39.73858372101547, -18.883562331869538, -203.1076502044502, -391.6254529057158, -253.68143804340727, -197.49870299400266, -382.0262929308659, -766.6002017950942, -396.8226631203537, -958.9714166670323, -923.9666687719673, -524.3506416583617, -616.4403591764168, -121.62285769109025, -853.1318522461501, -423.8840217049977, -193.7969885965432, -1068.2677983518704, -183.25771797700054, -404.32584350109136, -509.24096712828543, -41.1323277678442, -15.896351826812294], "episode_lengths": [150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 148, 150, 150, 150, 150, 75, 56, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 146, 150, 150, 150, 150, 44, 150, 44, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 150, 87, 150, 150, 64, 107, 150, 150, 150, 150, 75, 150, 121, 150, 150, 111, 150, 150, 150, 149, 150, 97, 150, 123, 116, 150, 57, 39, 82, 109, 79, 82, 122, 150, 149, 150, 150, 150, 150, 62, 150, 123, 103, 150, 85, 150, 150, 55, 45], "policy_policy_0_reward": [-1196.8706642172845, -555.9367679032088, -326.9158407788965, -812.759565344474, -998.7334216689659, -260.5981889933917, -1013.4267590449533, -1184.4985535114965, -514.0939943507647, -1021.8329831749222, -429.2670500223784, -1320.8740612391982, -1306.6541585696818, -820.2913667476713, -654.2954227598682, -67.5767674917765, -49.34084807059605, -774.053144045893, -239.99616468332675, -789.6396922932241, -478.182607908581, -978.2966346933285, -815.919930936719, -669.8322019186398, -388.38950265053694, -956.4812219651695, -1017.7705061801411, -1064.2396307746787, -823.8758003767844, -694.4278949647706, -49.60163234806846, -745.1754176621047, -740.0907015393773, -820.3153909720903, -961.3947141753717, -1149.2572015863625, -47.14792495200929, -1091.746167093578, -17.427572823747123, -1260.8151723434298, -927.1907734856795, -1089.0279042771124, -573.1720338102016, -552.0380889150825, -524.9167080316807, -538.2664845264901, -773.4055702003296, -818.1244405373167, -1054.3801840658384, -650.3201362484084, -543.6717477005407, -823.8648712979627, -266.53839755345905, -644.9357471165243, -391.47415364085316, -128.02703216446278, -283.6720914187299, -818.5267481169358, -462.0164122189075, -727.402397150758, -666.7661663727821, -214.63404412040748, -945.1616076072928, -496.1542742072185, -1205.2033243299877, -877.1093039698267, -199.65705858127623, -435.635336384958, -540.1919335114676, -634.2430819157648, -763.5839353114064, -693.5101395503207, -360.1669588103109, -521.5936564102169, -345.66823263488357, -235.0242628970685, -880.1960898205549, -39.73858372101547, -18.883562331869538, -203.1076502044502, -391.6254529057158, -253.68143804340727, -197.49870299400266, -382.0262929308659, -766.6002017950942, -396.8226631203537, -958.9714166670323, -923.9666687719673, -524.3506416583617, -616.4403591764168, -121.62285769109025, -853.1318522461501, -423.8840217049977, -193.7969885965432, -1068.2677983518704, -183.25771797700054, -404.32584350109136, -509.24096712828543, -41.1323277678442, -15.896351826812294]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29820436220626007, "mean_inference_ms": 0.924121055575844, "mean_action_processing_ms": 0.16599233761536122, "mean_env_wait_ms": 1.6938959531602444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059604644775390625, "StateBufferConnector_ms": 0.004087209701538086, "ViewRequirementAgentConnector_ms": 0.1031196117401123}, "num_episodes": 33, "episode_return_max": -15.896351826812294, "episode_return_min": -1320.8740612391982, "episode_return_mean": -612.0178493280272, "episodes_this_iter": 33}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 286.52870291695683, "num_env_steps_trained_throughput_per_sec": 286.52870291695683, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 13614.259, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13614.177, "sample_time_ms": 2579.295, "learn_time_ms": 11017.876, "learn_throughput": 363.046, "synch_weights_time_ms": 15.698}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 90, "trial_id": "6d52d_00000", "date": "2024-07-26_23-04-12", "timestamp": 1722015252, "time_this_iter_s": 13.967862844467163, "time_total_s": 1205.8241806030273, "pid": 273544, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7d125c3db520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1205.8241806030273, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 10.48, "ram_util_percent": 28.899999999999995}}
