{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 46.027244424621266, "cur_kl_coeff": 0.2, "cur_lr": 0.0010000000000000005, "total_loss": 6.064476516814459, "policy_loss": -0.0015908065612339193, "vf_loss": 6.066220979236421, "vf_explained_var": 0.45718398522763026, "kl": 0.006346185350176668, "entropy": 1.4228913563489913, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.5, "num_grad_updates_lifetime": 2100.5, "diff_num_grad_updates_vs_sampler_policy": 2099.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 17850, "num_agent_steps_trained": 17850}, "env_runners": {"episode_reward_max": -2374.6552461130136, "episode_reward_min": -6170.748793190867, "episode_reward_mean": -3899.6616133394677, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 3450, "policy_reward_min": {"policy_0": -1454.1848787375302}, "policy_reward_max": {"policy_0": -16.985458885504634}, "policy_reward_mean": {"policy_0": -779.9323226678935}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4630.116080431452, -4183.792191439001, -4546.788311064345, -6170.748793190867, -3637.6393903338844, -3734.6644736171615, -3768.1951627114604, -4067.8696467776717, -3082.257550484871, -3687.675482335333, -4679.156073632878, -2515.4061387900924, -5652.441831438084, -3066.534891510915, -3192.05178690562, -4161.979725942118, -3122.850888633845, -5351.3187344315775, -4161.057233628691, -3288.4550631652346, -2881.0696287883634, -3735.4927814412836, -2374.6552461130136], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-659.5561524351345, -562.4009896210041, -993.8098911032089, -1228.4861191267223, -1185.8629281453839, -1090.8291640634693, -1030.0451104872404, -1115.0369327939254, -142.5011698183732, -805.3798142759877, -965.2608830954994, -891.7138327403006, -1026.5686136048685, -1112.0153306267075, -551.2296509969668, -1454.1848787375302, -1048.782451874807, -1021.4245720882124, -1209.146562222886, -1437.210328267425, -967.0051775455255, -1288.8674726696634, -161.196289765728, -227.23376896197612, -993.3366813909911, -860.6759636962868, -1194.5080223161858, -354.2102287570584, -1002.6904579689775, -322.57980087865377, -1252.7121941771998, -1234.4334875557943, -77.0786727078723, -818.5042162148551, -385.46659205573974, -1207.5451540209233, -669.054231254124, -319.2363495058336, -1080.8635767370874, -791.1703352597033, -851.6707444251753, -534.9011953073729, -1010.3688986170484, -423.89204895727164, -261.4246631780044, -671.4512635821533, -484.9467093728906, -761.8987073531011, -701.0074545448059, -1068.371347482381, -232.22940746978796, -1041.6535814923855, -1324.0312679075287, -969.1265870485687, -1112.1152297146052, -732.7247272601228, -152.08794507371275, -902.260473783768, -263.2515379718108, -465.0814547006787, -1091.8421564449927, -1104.5573826320192, -1224.4519354196827, -834.0222250423709, -1397.5681318990157, -59.3190502652084, -954.9813450213819, -977.4828919460799, -388.31919162600354, -686.4324126522425, -263.2645670315897, -959.4907344030778, -560.6364946422811, -721.7960354231443, -686.863955405526, -261.40534572391607, -768.7983083114714, -1054.9891280817214, -1026.5963925221142, -1050.190551302891, -779.5153757703295, -773.6143415744807, -375.1498491381214, -996.3218424133298, -198.2494797375833, -788.1032605963768, -1102.1760994783835, -1285.032138072623, -1157.0575332415121, -1018.9497030426818, -1144.7157906544412, -636.9233823705184, -1126.2233686039167, -1107.2881320098836, -145.9065599899331, -199.34309732059052, -346.5850390111208, -722.4158674173442, -816.4418589390802, -1203.6692004771007, -774.103640356225, -1014.1369032500336, -1036.9476375948202, -16.985458885504634, -38.89598870178023, -632.6216999856775, -395.52498826473123, -1121.3866127070576, -1361.4071313944853, -224.5523490893296, -323.48891594679424, -996.3610051295591, -133.18286691518355, -890.4771203953975, -31.145337726077205]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.012537280624868, "mean_inference_ms": 2.157183961915265, "mean_action_processing_ms": 0.9847694441772951, "mean_env_wait_ms": 14.616108811828457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021782128707222317, "StateBufferConnector_ms": 0.016990951869798744, "ViewRequirementAgentConnector_ms": 0.5420684814453125}, "num_episodes": 23, "episode_return_max": -2374.6552461130136, "episode_return_min": -6170.748793190867, "episode_return_mean": -3899.6616133394677, "episodes_this_iter": 23}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17850, "num_agent_steps_trained": 17850, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 67.90360672667126, "num_env_steps_trained_throughput_per_sec": 67.90360672667126, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 17850, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 17850, "timers": {"training_iteration_time_ms": 58907.043, "restore_workers_time_ms": 0.025, "training_step_time_ms": 58906.98, "sample_time_ms": 3891.567, "learn_time_ms": 54953.713, "learn_throughput": 72.789, "synch_weights_time_ms": 59.013}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 17850, "num_agent_steps_trained": 17850}, "done": false, "training_iteration": 1, "trial_id": "fafd3_00000", "date": "2024-08-05_11-31-29", "timestamp": 1722837689, "time_this_iter_s": 58.9190354347229, "time_total_s": 58.9190354347229, "pid": 668605, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a020f03eb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 58.9190354347229, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 16.753571428571426, "ram_util_percent": 30.736904761904768}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 166.162499355218, "cur_kl_coeff": 0.20000000000000007, "cur_lr": 0.0010000000000000005, "total_loss": 2.249023293995974, "policy_loss": -0.00027256277366997857, "vf_loss": 2.2491678432251017, "vf_explained_var": 0.9688190075696683, "kl": 0.007525498558343137, "entropy": 1.3770846514433037, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.08823529411765, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 2039.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 35134, "num_agent_steps_trained": 35134}, "env_runners": {"episode_reward_max": -1951.0013867032517, "episode_reward_min": -6170.748793190867, "episode_reward_mean": -3773.5948307198555, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 6900, "policy_reward_min": {"policy_0": -1454.1848787375302}, "policy_reward_max": {"policy_0": -16.985458885504634}, "policy_reward_mean": {"policy_0": -754.7189661439708}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4630.116080431452, -4183.792191439001, -4546.788311064345, -6170.748793190867, -3637.6393903338844, -3734.6644736171615, -3768.1951627114604, -4067.8696467776717, -3082.257550484871, -3687.675482335333, -4679.156073632878, -2515.4061387900924, -5652.441831438084, -3066.534891510915, -3192.05178690562, -4161.979725942118, -3122.850888633845, -5351.3187344315775, -4161.057233628691, -3288.4550631652346, -2881.0696287883634, -3735.4927814412836, -2374.6552461130136, -3958.5791009272048, -2815.3485111732643, -2299.447652270046, -5681.430425725693, -4410.857066907215, -2170.3413423711354, -1951.0013867032517, -3817.0041609417226, -2535.9718946911516, -4200.94491479458, -4679.168324027105, -3018.147377821824, -3510.4934265115917, -5072.368946947111, -4344.14380055521, -3951.295851701288, -3207.085899679402, -3597.560097923539, -4228.187069038884, -3450.203583602009, -3451.1111872453266, -4162.307977328559, -3380.145107418459], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-659.5561524351345, -562.4009896210041, -993.8098911032089, -1228.4861191267223, -1185.8629281453839, -1090.8291640634693, -1030.0451104872404, -1115.0369327939254, -142.5011698183732, -805.3798142759877, -965.2608830954994, -891.7138327403006, -1026.5686136048685, -1112.0153306267075, -551.2296509969668, -1454.1848787375302, -1048.782451874807, -1021.4245720882124, -1209.146562222886, -1437.210328267425, -967.0051775455255, -1288.8674726696634, -161.196289765728, -227.23376896197612, -993.3366813909911, -860.6759636962868, -1194.5080223161858, -354.2102287570584, -1002.6904579689775, -322.57980087865377, -1252.7121941771998, -1234.4334875557943, -77.0786727078723, -818.5042162148551, -385.46659205573974, -1207.5451540209233, -669.054231254124, -319.2363495058336, -1080.8635767370874, -791.1703352597033, -851.6707444251753, -534.9011953073729, -1010.3688986170484, -423.89204895727164, -261.4246631780044, -671.4512635821533, -484.9467093728906, -761.8987073531011, -701.0074545448059, -1068.371347482381, -232.22940746978796, -1041.6535814923855, -1324.0312679075287, -969.1265870485687, -1112.1152297146052, -732.7247272601228, -152.08794507371275, -902.260473783768, -263.2515379718108, -465.0814547006787, -1091.8421564449927, -1104.5573826320192, -1224.4519354196827, -834.0222250423709, -1397.5681318990157, -59.3190502652084, -954.9813450213819, -977.4828919460799, -388.31919162600354, -686.4324126522425, -263.2645670315897, -959.4907344030778, -560.6364946422811, -721.7960354231443, -686.863955405526, -261.40534572391607, -768.7983083114714, -1054.9891280817214, -1026.5963925221142, -1050.190551302891, -779.5153757703295, -773.6143415744807, -375.1498491381214, -996.3218424133298, -198.2494797375833, -788.1032605963768, -1102.1760994783835, -1285.032138072623, -1157.0575332415121, -1018.9497030426818, -1144.7157906544412, -636.9233823705184, -1126.2233686039167, -1107.2881320098836, -145.9065599899331, -199.34309732059052, -346.5850390111208, -722.4158674173442, -816.4418589390802, -1203.6692004771007, -774.103640356225, -1014.1369032500336, -1036.9476375948202, -16.985458885504634, -38.89598870178023, -632.6216999856775, -395.52498826473123, -1121.3866127070576, -1361.4071313944853, -224.5523490893296, -323.48891594679424, -996.3610051295591, -133.18286691518355, -890.4771203953975, -31.145337726077205, -1215.219905579339, -459.16390278514444, -759.3620882133729, -413.75634187216934, -1111.0768624771813, -68.86149726442223, -182.11207829480088, -646.4427502547899, -998.3622456147216, -919.5699397445266, -110.71084934477769, -244.85695561979898, -1129.7493774387592, -413.9681037969708, -400.1623660697405, -1244.889624692992, -886.3241976983625, -1049.6069070592025, -1275.6110276200714, -1224.9986686550646, -302.7827656229329, -952.5937235395189, -1245.4484004578885, -805.3709870110617, -1104.661190275808, -786.4025530407012, -285.371207972213, -267.9286743244879, -28.85320750467523, -801.7856995290589, -879.4644823824589, -454.01057408671335, -209.0920807004528, -383.6453797203854, -24.788869813241195, -592.5991061058253, -1177.927349157176, -957.2441718597814, -119.64880748800049, -969.5847263309395, -772.6517266700506, -452.52449773593463, -783.5957983703407, -152.25163376477295, -374.9482381500511, -1105.9403723413666, -787.4796799978268, -281.3520314207689, -1100.7914820231465, -925.3813490114707, -1017.5255116509587, -997.9456313696265, -131.84579125350322, -1303.423332342158, -1228.4280574108589, -195.25275718165645, -915.2994590180007, -864.6145284391959, -320.1929813606064, -722.7876518223654, -462.8772357489692, -912.5515822791932, -943.1967154760929, -1071.7089086670148, -120.15898434032206, -1086.8857124454246, -840.2071840144696, -1061.7345852757708, -1225.5820781530995, -857.9593870583493, -972.9988760430198, -985.536482328548, -827.8562315571797, -1045.9220618417942, -511.8301487846699, -622.0056955705847, -868.7992304381847, -912.1411719560235, -492.0374788751691, -1056.3122748613243, -679.3281010441648, -1193.7800639402135, -1000.4202512964865, -204.34272208422874, -129.21476131430464, -901.2458943744737, -232.7233394598842, -950.2317739787841, -1080.6087455042252, -432.75034460617223, -730.0568988373983, -1137.2019680933383, -873.836860221455, -872.5452643553064, -614.5460775313859, -1274.223240111809, -1076.2445138310256, -183.17840595766393, -815.0290124019705, -101.52841129953734, -1326.8116032874343, -1015.8543003253556, -579.1122725130888, -72.82921338371543, -456.503797735736, -810.5437309486736, -1066.2949371007437, -216.28029242409542, -1226.6633273655016, -842.5256894895473, -1021.6502269350223, -649.9666603958307, -1204.3432219910658, -174.10075261133292, -330.0842454852059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.952590713474439, "mean_inference_ms": 2.100693582982456, "mean_action_processing_ms": 0.9677371258468269, "mean_env_wait_ms": 14.281065982397411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02057604167772376, "StateBufferConnector_ms": 0.015149945798127548, "ViewRequirementAgentConnector_ms": 0.5062932553498641}, "num_episodes": 23, "episode_return_max": -1951.0013867032517, "episode_return_min": -6170.748793190867, "episode_return_mean": -3773.5948307198555, "episodes_this_iter": 23}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35134, "num_agent_steps_trained": 35134, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.37045126671016, "num_env_steps_trained_throughput_per_sec": 83.37045126671016, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 35134, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 35134, "timers": {"training_iteration_time_ms": 53442.843, "restore_workers_time_ms": 0.03, "training_step_time_ms": 53442.773, "sample_time_ms": 3676.727, "learn_time_ms": 49705.704, "learn_throughput": 80.474, "synch_weights_time_ms": 57.622}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 35134, "num_agent_steps_trained": 35134}, "done": false, "training_iteration": 2, "trial_id": "fafd3_00000", "date": "2024-08-05_11-32-17", "timestamp": 1722837737, "time_this_iter_s": 47.98994994163513, "time_total_s": 106.90898537635803, "pid": 668605, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a020f00a60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 106.90898537635803, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 39.38823529411765, "ram_util_percent": 34.152941176470584}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 212.18397528840967, "cur_kl_coeff": 0.20000000000000007, "cur_lr": 0.0010000000000000005, "total_loss": 1.8239475575386752, "policy_loss": -0.003046636642061668, "vf_loss": 1.8262863075356124, "vf_explained_var": 0.9872404002940278, "kl": 0.010385664997221856, "entropy": 1.3692482732798352, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.4014598540146, "num_grad_updates_lifetime": 10335.5, "diff_num_grad_updates_vs_sampler_policy": 2054.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 52588, "num_agent_steps_trained": 52588}, "env_runners": {"episode_reward_max": -1951.0013867032517, "episode_reward_min": -6170.748793190867, "episode_reward_mean": -3760.6323987040128, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 10350, "policy_reward_min": {"policy_0": -1454.1848787375302}, "policy_reward_max": {"policy_0": -14.294743538292199}, "policy_reward_mean": {"policy_0": -752.1264797408024}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4630.116080431452, -4183.792191439001, -4546.788311064345, -6170.748793190867, -3637.6393903338844, -3734.6644736171615, -3768.1951627114604, -4067.8696467776717, -3082.257550484871, -3687.675482335333, -4679.156073632878, -2515.4061387900924, -5652.441831438084, -3066.534891510915, -3192.05178690562, -4161.979725942118, -3122.850888633845, -5351.3187344315775, -4161.057233628691, -3288.4550631652346, -2881.0696287883634, -3735.4927814412836, -2374.6552461130136, -3958.5791009272048, -2815.3485111732643, -2299.447652270046, -5681.430425725693, -4410.857066907215, -2170.3413423711354, -1951.0013867032517, -3817.0041609417226, -2535.9718946911516, -4200.94491479458, -4679.168324027105, -3018.147377821824, -3510.4934265115917, -5072.368946947111, -4344.14380055521, -3951.295851701288, -3207.085899679402, -3597.560097923539, -4228.187069038884, -3450.203583602009, -3451.1111872453266, -4162.307977328559, -3380.145107418459, -5126.40746013185, -5045.3213101237225, -4054.087756846201, -4253.700471189849, -2599.061447423127, -2160.5639698317473, -4164.215078819591, -4788.933786458754, -3232.029852711319, -2994.058557839731, -4028.479375665782, -2175.8568627313557, -4768.462772971958, -3881.0207899252255, -3641.1699996587977, -2808.495233774895, -2104.01367081599, -3568.8454919806572, -3560.9114755422347, -4167.602390129176, -2721.1270129038844, -5298.982656747484, -4754.925873240215], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-659.5561524351345, -562.4009896210041, -993.8098911032089, -1228.4861191267223, -1185.8629281453839, -1090.8291640634693, -1030.0451104872404, -1115.0369327939254, -142.5011698183732, -805.3798142759877, -965.2608830954994, -891.7138327403006, -1026.5686136048685, -1112.0153306267075, -551.2296509969668, -1454.1848787375302, -1048.782451874807, -1021.4245720882124, -1209.146562222886, -1437.210328267425, -967.0051775455255, -1288.8674726696634, -161.196289765728, -227.23376896197612, -993.3366813909911, -860.6759636962868, -1194.5080223161858, -354.2102287570584, -1002.6904579689775, -322.57980087865377, -1252.7121941771998, -1234.4334875557943, -77.0786727078723, -818.5042162148551, -385.46659205573974, -1207.5451540209233, -669.054231254124, -319.2363495058336, -1080.8635767370874, -791.1703352597033, -851.6707444251753, -534.9011953073729, -1010.3688986170484, -423.89204895727164, -261.4246631780044, -671.4512635821533, -484.9467093728906, -761.8987073531011, -701.0074545448059, -1068.371347482381, -232.22940746978796, -1041.6535814923855, -1324.0312679075287, -969.1265870485687, -1112.1152297146052, -732.7247272601228, -152.08794507371275, -902.260473783768, -263.2515379718108, -465.0814547006787, -1091.8421564449927, -1104.5573826320192, -1224.4519354196827, -834.0222250423709, -1397.5681318990157, -59.3190502652084, -954.9813450213819, -977.4828919460799, -388.31919162600354, -686.4324126522425, -263.2645670315897, -959.4907344030778, -560.6364946422811, -721.7960354231443, -686.863955405526, -261.40534572391607, -768.7983083114714, -1054.9891280817214, -1026.5963925221142, -1050.190551302891, -779.5153757703295, -773.6143415744807, -375.1498491381214, -996.3218424133298, -198.2494797375833, -788.1032605963768, -1102.1760994783835, -1285.032138072623, -1157.0575332415121, -1018.9497030426818, -1144.7157906544412, -636.9233823705184, -1126.2233686039167, -1107.2881320098836, -145.9065599899331, -199.34309732059052, -346.5850390111208, -722.4158674173442, -816.4418589390802, -1203.6692004771007, -774.103640356225, -1014.1369032500336, -1036.9476375948202, -16.985458885504634, -38.89598870178023, -632.6216999856775, -395.52498826473123, -1121.3866127070576, -1361.4071313944853, -224.5523490893296, -323.48891594679424, -996.3610051295591, -133.18286691518355, -890.4771203953975, -31.145337726077205, -1215.219905579339, -459.16390278514444, -759.3620882133729, -413.75634187216934, -1111.0768624771813, -68.86149726442223, -182.11207829480088, -646.4427502547899, -998.3622456147216, -919.5699397445266, -110.71084934477769, -244.85695561979898, -1129.7493774387592, -413.9681037969708, -400.1623660697405, -1244.889624692992, -886.3241976983625, -1049.6069070592025, -1275.6110276200714, -1224.9986686550646, -302.7827656229329, -952.5937235395189, -1245.4484004578885, -805.3709870110617, -1104.661190275808, -786.4025530407012, -285.371207972213, -267.9286743244879, -28.85320750467523, -801.7856995290589, -879.4644823824589, -454.01057408671335, -209.0920807004528, -383.6453797203854, -24.788869813241195, -592.5991061058253, -1177.927349157176, -957.2441718597814, -119.64880748800049, -969.5847263309395, -772.6517266700506, -452.52449773593463, -783.5957983703407, -152.25163376477295, -374.9482381500511, -1105.9403723413666, -787.4796799978268, -281.3520314207689, -1100.7914820231465, -925.3813490114707, -1017.5255116509587, -997.9456313696265, -131.84579125350322, -1303.423332342158, -1228.4280574108589, -195.25275718165645, -915.2994590180007, -864.6145284391959, -320.1929813606064, -722.7876518223654, -462.8772357489692, -912.5515822791932, -943.1967154760929, -1071.7089086670148, -120.15898434032206, -1086.8857124454246, -840.2071840144696, -1061.7345852757708, -1225.5820781530995, -857.9593870583493, -972.9988760430198, -985.536482328548, -827.8562315571797, -1045.9220618417942, -511.8301487846699, -622.0056955705847, -868.7992304381847, -912.1411719560235, -492.0374788751691, -1056.3122748613243, -679.3281010441648, -1193.7800639402135, -1000.4202512964865, -204.34272208422874, -129.21476131430464, -901.2458943744737, -232.7233394598842, -950.2317739787841, -1080.6087455042252, -432.75034460617223, -730.0568988373983, -1137.2019680933383, -873.836860221455, -872.5452643553064, -614.5460775313859, -1274.223240111809, -1076.2445138310256, -183.17840595766393, -815.0290124019705, -101.52841129953734, -1326.8116032874343, -1015.8543003253556, -579.1122725130888, -72.82921338371543, -456.503797735736, -810.5437309486736, -1066.2949371007437, -216.28029242409542, -1226.6633273655016, -842.5256894895473, -1021.6502269350223, -649.9666603958307, -1204.3432219910658, -174.10075261133292, -330.0842454852059, -923.9339104235262, -961.286054298328, -1281.531857980205, -633.7395189710868, -1325.916118458712, -1178.048927572304, -1106.6400190768918, -919.8166847828527, -993.1659665069355, -847.6497121847366, -403.03913732181246, -1013.0667233971778, -969.8386198733342, -591.2690833921404, -1076.8741928617374, -1179.6863491288038, -1028.3257572617017, -464.1229490328038, -819.7403382170382, -761.8250775494987, -1351.914905338983, -403.8980818966658, -528.7105862712119, -146.02922821939367, -168.50864569687332, -573.7613025898738, -101.59983593138506, -51.344347985129616, -581.4681178719638, -852.3903654533962, -1022.7244174385626, -1142.1932207752557, -861.8608051267084, -232.10238526984864, -905.3342502092138, -964.9987607099331, -759.5430114635878, -925.0984961354098, -1058.6823442621023, -1080.611173887718, -313.8498411110776, -1248.0030794336901, -1053.852289925662, -449.8555779890023, -166.46906425188686, -805.9655062198254, -1209.072211394051, -82.12731000997694, -14.294743538292199, -882.5987866775865, -550.6008361244396, -722.7342845111933, -1006.5359945948001, -578.3966676437907, -1170.2115927915581, -470.7440701553869, -201.19421918028937, -43.78484987376163, -1174.8099626729822, -285.3237608489355, -1314.2374725533484, -403.7060404333818, -751.2682504429248, -1034.8974708850922, -1264.3535386572157, -909.1052171860101, -354.37748211512394, -954.9265683515224, -499.6273849556332, -1162.9841373169359, -817.5334169264852, -976.461839262781, -285.15777944892847, -1083.0986899617824, -478.9182740588225, -984.9578610891742, -333.0957003651783, -109.33860220430952, -998.7247869872575, -382.3782831289803, -28.340587113808898, -350.8619475133388, -549.8949882430744, -1074.199885635974, -100.71626230979204, -783.1952311638809, -40.1768825980614, -1057.6508668071383, -1159.2333995253928, -528.5891118861832, -961.058779131617, -1034.340081223813, -209.95933865596538, -102.69051729309192, -1252.862759237746, -674.8941361703505, -1091.3009599696045, -1004.6504544732783, -301.8872791985521, -1094.8695603173862, -467.83902320871744, -665.772927386439, -234.80948568049726, -1185.3484909991491, -167.35708562908314, -1076.6500591617555, -1043.902033073192, -1053.4407575193277, -994.1748530555581, -1130.8149539376466, -954.8331565544931, -1021.3255681626051, -1109.3068368165627, -504.1516773884428, -1165.308634318113]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0550620496703105, "mean_inference_ms": 2.207992050719209, "mean_action_processing_ms": 1.0120747003905624, "mean_env_wait_ms": 14.96395312419524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021011933036472485, "StateBufferConnector_ms": 0.015513447747714277, "ViewRequirementAgentConnector_ms": 0.6341091100720392}, "num_episodes": 23, "episode_return_max": -1951.0013867032517, "episode_return_min": -6170.748793190867, "episode_return_mean": -3760.6323987040128, "episodes_this_iter": 23}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52588, "num_agent_steps_trained": 52588, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 68.39853980843242, "num_env_steps_trained_throughput_per_sec": 68.39853980843242, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 52588, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52588, "timers": {"training_iteration_time_ms": 55122.16, "restore_workers_time_ms": 0.029, "training_step_time_ms": 55122.091, "sample_time_ms": 4517.946, "learn_time_ms": 50545.968, "learn_throughput": 79.136, "synch_weights_time_ms": 55.416}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 52588, "num_agent_steps_trained": 52588}, "done": false, "training_iteration": 3, "trial_id": "fafd3_00000", "date": "2024-08-05_11-33-15", "timestamp": 1722837795, "time_this_iter_s": 58.49310064315796, "time_total_s": 165.402086019516, "pid": 668605, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a020f61510>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 165.402086019516, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 28.732142857142858, "ram_util_percent": 50.13214285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 233.28683289882642, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000007, "total_loss": 1.541632018731412, "policy_loss": -0.0005293782709328376, "vf_loss": 1.5417394071313495, "vf_explained_var": 0.987434681976475, "kl": 0.008888829748131051, "entropy": 1.3557737234421974, "entropy_coeff": 0.0010000000000000007}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.15217391304348, "num_grad_updates_lifetime": 14460.5, "diff_num_grad_updates_vs_sampler_policy": 2069.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 70135, "num_agent_steps_trained": 70135}, "env_runners": {"episode_reward_max": -1730.7953705711175, "episode_reward_min": -6170.748793190867, "episode_reward_mean": -3661.3929621861885, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 13800, "policy_reward_min": {"policy_0": -1454.1848787375302}, "policy_reward_max": {"policy_0": -14.294743538292199}, "policy_reward_mean": {"policy_0": -732.2785924372374}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4630.116080431452, -4183.792191439001, -4546.788311064345, -6170.748793190867, -3637.6393903338844, -3734.6644736171615, -3768.1951627114604, -4067.8696467776717, -3082.257550484871, -3687.675482335333, -4679.156073632878, -2515.4061387900924, -5652.441831438084, -3066.534891510915, -3192.05178690562, -4161.979725942118, -3122.850888633845, -5351.3187344315775, -4161.057233628691, -3288.4550631652346, -2881.0696287883634, -3735.4927814412836, -2374.6552461130136, -3958.5791009272048, -2815.3485111732643, -2299.447652270046, -5681.430425725693, -4410.857066907215, -2170.3413423711354, -1951.0013867032517, -3817.0041609417226, -2535.9718946911516, -4200.94491479458, -4679.168324027105, -3018.147377821824, -3510.4934265115917, -5072.368946947111, -4344.14380055521, -3951.295851701288, -3207.085899679402, -3597.560097923539, -4228.187069038884, -3450.203583602009, -3451.1111872453266, -4162.307977328559, -3380.145107418459, -5126.40746013185, -5045.3213101237225, -4054.087756846201, -4253.700471189849, -2599.061447423127, -2160.5639698317473, -4164.215078819591, -4788.933786458754, -3232.029852711319, -2994.058557839731, -4028.479375665782, -2175.8568627313557, -4768.462772971958, -3881.0207899252255, -3641.1699996587977, -2808.495233774895, -2104.01367081599, -3568.8454919806572, -3560.9114755422347, -4167.602390129176, -2721.1270129038844, -5298.982656747484, -4754.925873240215, -3701.926432011102, -2369.7692975164014, -4197.172392469258, -3775.067590395002, -4478.397709269595, -3679.4814054697217, -3106.466633954554, -2086.9271691237873, -3881.1772446429018, -3583.4799957502864, -3173.4986711901925, -2892.434113490542, -2281.349701840197, -3652.7930058501815, -4014.47757685833, -3697.514726261576, -3647.9826403257375, -4214.7246953649565, -1730.7953705711175, -3655.7856865012345, -3345.7810094093215, -3538.9550156817413, -2658.5589266046954], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-659.5561524351345, -562.4009896210041, -993.8098911032089, -1228.4861191267223, -1185.8629281453839, -1090.8291640634693, -1030.0451104872404, -1115.0369327939254, -142.5011698183732, -805.3798142759877, -965.2608830954994, -891.7138327403006, -1026.5686136048685, -1112.0153306267075, -551.2296509969668, -1454.1848787375302, -1048.782451874807, -1021.4245720882124, -1209.146562222886, -1437.210328267425, -967.0051775455255, -1288.8674726696634, -161.196289765728, -227.23376896197612, -993.3366813909911, -860.6759636962868, -1194.5080223161858, -354.2102287570584, -1002.6904579689775, -322.57980087865377, -1252.7121941771998, -1234.4334875557943, -77.0786727078723, -818.5042162148551, -385.46659205573974, -1207.5451540209233, -669.054231254124, -319.2363495058336, -1080.8635767370874, -791.1703352597033, -851.6707444251753, -534.9011953073729, -1010.3688986170484, -423.89204895727164, -261.4246631780044, -671.4512635821533, -484.9467093728906, -761.8987073531011, -701.0074545448059, -1068.371347482381, -232.22940746978796, -1041.6535814923855, -1324.0312679075287, -969.1265870485687, -1112.1152297146052, -732.7247272601228, -152.08794507371275, -902.260473783768, -263.2515379718108, -465.0814547006787, -1091.8421564449927, -1104.5573826320192, -1224.4519354196827, -834.0222250423709, -1397.5681318990157, -59.3190502652084, -954.9813450213819, -977.4828919460799, -388.31919162600354, -686.4324126522425, -263.2645670315897, -959.4907344030778, -560.6364946422811, -721.7960354231443, -686.863955405526, -261.40534572391607, -768.7983083114714, -1054.9891280817214, -1026.5963925221142, -1050.190551302891, -779.5153757703295, -773.6143415744807, -375.1498491381214, -996.3218424133298, -198.2494797375833, -788.1032605963768, -1102.1760994783835, -1285.032138072623, -1157.0575332415121, -1018.9497030426818, -1144.7157906544412, -636.9233823705184, -1126.2233686039167, -1107.2881320098836, -145.9065599899331, -199.34309732059052, -346.5850390111208, -722.4158674173442, -816.4418589390802, -1203.6692004771007, -774.103640356225, -1014.1369032500336, -1036.9476375948202, -16.985458885504634, -38.89598870178023, -632.6216999856775, -395.52498826473123, -1121.3866127070576, -1361.4071313944853, -224.5523490893296, -323.48891594679424, -996.3610051295591, -133.18286691518355, -890.4771203953975, -31.145337726077205, -1215.219905579339, -459.16390278514444, -759.3620882133729, -413.75634187216934, -1111.0768624771813, -68.86149726442223, -182.11207829480088, -646.4427502547899, -998.3622456147216, -919.5699397445266, -110.71084934477769, -244.85695561979898, -1129.7493774387592, -413.9681037969708, -400.1623660697405, -1244.889624692992, -886.3241976983625, -1049.6069070592025, -1275.6110276200714, -1224.9986686550646, -302.7827656229329, -952.5937235395189, -1245.4484004578885, -805.3709870110617, -1104.661190275808, -786.4025530407012, -285.371207972213, -267.9286743244879, -28.85320750467523, -801.7856995290589, -879.4644823824589, -454.01057408671335, -209.0920807004528, -383.6453797203854, -24.788869813241195, -592.5991061058253, -1177.927349157176, -957.2441718597814, -119.64880748800049, -969.5847263309395, -772.6517266700506, -452.52449773593463, -783.5957983703407, -152.25163376477295, -374.9482381500511, -1105.9403723413666, -787.4796799978268, -281.3520314207689, -1100.7914820231465, -925.3813490114707, -1017.5255116509587, -997.9456313696265, -131.84579125350322, -1303.423332342158, -1228.4280574108589, -195.25275718165645, -915.2994590180007, -864.6145284391959, -320.1929813606064, -722.7876518223654, -462.8772357489692, -912.5515822791932, -943.1967154760929, -1071.7089086670148, -120.15898434032206, -1086.8857124454246, -840.2071840144696, -1061.7345852757708, -1225.5820781530995, -857.9593870583493, -972.9988760430198, -985.536482328548, -827.8562315571797, -1045.9220618417942, -511.8301487846699, -622.0056955705847, -868.7992304381847, -912.1411719560235, -492.0374788751691, -1056.3122748613243, -679.3281010441648, -1193.7800639402135, -1000.4202512964865, -204.34272208422874, -129.21476131430464, -901.2458943744737, -232.7233394598842, -950.2317739787841, -1080.6087455042252, -432.75034460617223, -730.0568988373983, -1137.2019680933383, -873.836860221455, -872.5452643553064, -614.5460775313859, -1274.223240111809, -1076.2445138310256, -183.17840595766393, -815.0290124019705, -101.52841129953734, -1326.8116032874343, -1015.8543003253556, -579.1122725130888, -72.82921338371543, -456.503797735736, -810.5437309486736, -1066.2949371007437, -216.28029242409542, -1226.6633273655016, -842.5256894895473, -1021.6502269350223, -649.9666603958307, -1204.3432219910658, -174.10075261133292, -330.0842454852059, -923.9339104235262, -961.286054298328, -1281.531857980205, -633.7395189710868, -1325.916118458712, -1178.048927572304, -1106.6400190768918, -919.8166847828527, -993.1659665069355, -847.6497121847366, -403.03913732181246, -1013.0667233971778, -969.8386198733342, -591.2690833921404, -1076.8741928617374, -1179.6863491288038, -1028.3257572617017, -464.1229490328038, -819.7403382170382, -761.8250775494987, -1351.914905338983, -403.8980818966658, -528.7105862712119, -146.02922821939367, -168.50864569687332, -573.7613025898738, -101.59983593138506, -51.344347985129616, -581.4681178719638, -852.3903654533962, -1022.7244174385626, -1142.1932207752557, -861.8608051267084, -232.10238526984864, -905.3342502092138, -964.9987607099331, -759.5430114635878, -925.0984961354098, -1058.6823442621023, -1080.611173887718, -313.8498411110776, -1248.0030794336901, -1053.852289925662, -449.8555779890023, -166.46906425188686, -805.9655062198254, -1209.072211394051, -82.12731000997694, -14.294743538292199, -882.5987866775865, -550.6008361244396, -722.7342845111933, -1006.5359945948001, -578.3966676437907, -1170.2115927915581, -470.7440701553869, -201.19421918028937, -43.78484987376163, -1174.8099626729822, -285.3237608489355, -1314.2374725533484, -403.7060404333818, -751.2682504429248, -1034.8974708850922, -1264.3535386572157, -909.1052171860101, -354.37748211512394, -954.9265683515224, -499.6273849556332, -1162.9841373169359, -817.5334169264852, -976.461839262781, -285.15777944892847, -1083.0986899617824, -478.9182740588225, -984.9578610891742, -333.0957003651783, -109.33860220430952, -998.7247869872575, -382.3782831289803, -28.340587113808898, -350.8619475133388, -549.8949882430744, -1074.199885635974, -100.71626230979204, -783.1952311638809, -40.1768825980614, -1057.6508668071383, -1159.2333995253928, -528.5891118861832, -961.058779131617, -1034.340081223813, -209.95933865596538, -102.69051729309192, -1252.862759237746, -674.8941361703505, -1091.3009599696045, -1004.6504544732783, -301.8872791985521, -1094.8695603173862, -467.83902320871744, -665.772927386439, -234.80948568049726, -1185.3484909991491, -167.35708562908314, -1076.6500591617555, -1043.902033073192, -1053.4407575193277, -994.1748530555581, -1130.8149539376466, -954.8331565544931, -1021.3255681626051, -1109.3068368165627, -504.1516773884428, -1165.308634318113, -956.6781095054577, -994.5605341902149, -31.380091163855266, -918.8461471675398, -800.4615499840343, -1120.1651192488735, -1019.7393779293881, -100.47662557647176, -100.42116746205886, -28.96700729960905, -585.9465007944162, -1348.5694470006913, -201.3998595362457, -885.8650223499401, -1175.3915627879596, -1398.0049876013813, -106.53416822176925, -1145.644051635349, -1067.5987905817478, -57.28559235475, -1086.8474911389753, -1094.887133794528, -673.4915613036078, -710.541761169199, -912.6297618632863, -618.3367827358248, -614.825979814404, -891.8960062808285, -538.3392612117364, -1016.0833754269252, -30.873619732464746, -1088.158353584394, -1280.8949283394766, -350.6931504336019, -355.84658186461746, -899.5169667384629, -840.7598617158116, -170.90129734697229, -116.37836545955025, -59.3706778629922, -1246.3261261033063, -898.639185218317, -219.07547186905003, -608.9265402128424, -908.2099212393864, -929.7060253963269, -216.57848784095242, -1232.7284644795927, -984.4545803287256, -220.01243770468986, -115.51812855587649, -1207.0115378770056, -724.7332020926276, -969.9764789102273, -156.2593237544543, -237.61513562315952, -642.2035214576409, -644.5969965223796, -1279.2084953001317, -88.80996458722942, -468.6996934577654, -742.4129741041914, -60.376628291938886, -26.334142288709973, -983.5262636975909, -818.8551958161122, -117.09629396835264, -1021.5895148321607, -1304.6792513345315, -390.5727498990208, -825.9661598738072, -846.4456960294234, -786.1601401994601, -658.8177850812448, -897.0877956743889, -384.9505906049795, -955.0640469201961, -369.08811970796296, -1105.2358353283685, -883.1761337000688, -1122.8937168534194, -923.5636699211681, -379.85255827315103, -80.10568341765645, -1141.5670118603439, -548.0561299413861, -920.6996087555189, -1113.3294591299643, -667.1939834468651, -965.4455140912188, -246.6292554327155, -930.7140853209207, -235.09790714488102, -111.09884822721203, -207.2552744453877, -1043.419934493541, -1122.5758690796888, -191.62517681097728, -371.6257295653343, -926.5389765516949, -53.719259023079346, -1041.6175917335665, -80.75308372231297, -1253.3168487145122, -916.374226215851, -816.6879663132098, -522.8801551067505, -135.47265929432936, -861.8722717174408, -1202.0419632500107, -592.3043107155978, -1008.8915546206365, -116.7207550330058, -434.0527057643539, -506.5896004710986]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.13656272800173, "mean_inference_ms": 2.3150630865272417, "mean_action_processing_ms": 1.048617062058586, "mean_env_wait_ms": 15.560515278631302, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020783362181290337, "StateBufferConnector_ms": 0.015711266061534054, "ViewRequirementAgentConnector_ms": 0.7576688476230787}, "num_episodes": 23, "episode_return_max": -1730.7953705711175, "episode_return_min": -6170.748793190867, "episode_return_mean": -3661.3929621861885, "episodes_this_iter": 23}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 70135, "num_agent_steps_trained": 70135, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 60.94433434259804, "num_env_steps_trained_throughput_per_sec": 60.94433434259804, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 70135, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 70135, "timers": {"training_iteration_time_ms": 57750.039, "restore_workers_time_ms": 0.032, "training_step_time_ms": 57749.966, "sample_time_ms": 4879.275, "learn_time_ms": 52809.676, "learn_throughput": 75.744, "synch_weights_time_ms": 58.209}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 70135, "num_agent_steps_trained": 70135}, "done": false, "training_iteration": 4, "trial_id": "fafd3_00000", "date": "2024-08-05_11-34-21", "timestamp": 1722837861, "time_this_iter_s": 65.64520502090454, "time_total_s": 231.04729104042053, "pid": 668605, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a020f62170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 231.04729104042053, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 22.01075268817204, "ram_util_percent": 35.22795698924731}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 206.51888620969984, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.001, "total_loss": 1.4143483485513264, "policy_loss": -0.002267601553040246, "vf_loss": 1.4162495495610767, "vf_explained_var": 0.9857161804305182, "kl": 0.008756787836810368, "entropy": 1.384955932855606, "entropy_coeff": 0.001}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65333333333334, "num_grad_updates_lifetime": 18780.5, "diff_num_grad_updates_vs_sampler_policy": 2249.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 89283, "num_agent_steps_trained": 89283}, "env_runners": {"episode_reward_max": -1067.6920259052943, "episode_reward_min": -5681.430425725693, "episode_reward_mean": -3553.7632838802806, "episode_len_mean": 149.78, "episode_media": {}, "episodes_timesteps_total": 14978, "policy_reward_min": {"policy_0": -1398.0049876013813}, "policy_reward_max": {"policy_0": -13.06365972948414}, "policy_reward_mean": {"policy_0": -710.752656776056}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4161.979725942118, -3122.850888633845, -5351.3187344315775, -4161.057233628691, -3288.4550631652346, -2881.0696287883634, -3735.4927814412836, -2374.6552461130136, -3958.5791009272048, -2815.3485111732643, -2299.447652270046, -5681.430425725693, -4410.857066907215, -2170.3413423711354, -1951.0013867032517, -3817.0041609417226, -2535.9718946911516, -4200.94491479458, -4679.168324027105, -3018.147377821824, -3510.4934265115917, -5072.368946947111, -4344.14380055521, -3951.295851701288, -3207.085899679402, -3597.560097923539, -4228.187069038884, -3450.203583602009, -3451.1111872453266, -4162.307977328559, -3380.145107418459, -5126.40746013185, -5045.3213101237225, -4054.087756846201, -4253.700471189849, -2599.061447423127, -2160.5639698317473, -4164.215078819591, -4788.933786458754, -3232.029852711319, -2994.058557839731, -4028.479375665782, -2175.8568627313557, -4768.462772971958, -3881.0207899252255, -3641.1699996587977, -2808.495233774895, -2104.01367081599, -3568.8454919806572, -3560.9114755422347, -4167.602390129176, -2721.1270129038844, -5298.982656747484, -4754.925873240215, -3701.926432011102, -2369.7692975164014, -4197.172392469258, -3775.067590395002, -4478.397709269595, -3679.4814054697217, -3106.466633954554, -2086.9271691237873, -3881.1772446429018, -3583.4799957502864, -3173.4986711901925, -2892.434113490542, -2281.349701840197, -3652.7930058501815, -4014.47757685833, -3697.514726261576, -3647.9826403257375, -4214.7246953649565, -1730.7953705711175, -3655.7856865012345, -3345.7810094093215, -3538.9550156817413, -2658.5589266046954, -4281.047680487459, -2853.718020257593, -3569.753808841906, -3441.2318081367166, -1659.1171881552561, -3558.7228244329, -2944.6608494503866, -4021.6575256631436, -1541.6041969325127, -4633.123931200638, -1067.6920259052943, -3048.3250687679656, -5298.746029942447, -2653.7188233257443, -4345.357557725613, -3257.5572249571965, -4425.886037396352, -2829.5115537294587, -3654.412065269806, -4171.446586700805, -4249.132537196139, -4251.677308122293, -3385.413018964734], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-261.40534572391607, -768.7983083114714, -1054.9891280817214, -1026.5963925221142, -1050.190551302891, -779.5153757703295, -773.6143415744807, -375.1498491381214, -996.3218424133298, -198.2494797375833, -788.1032605963768, -1102.1760994783835, -1285.032138072623, -1157.0575332415121, -1018.9497030426818, -1144.7157906544412, -636.9233823705184, -1126.2233686039167, -1107.2881320098836, -145.9065599899331, -199.34309732059052, -346.5850390111208, -722.4158674173442, -816.4418589390802, -1203.6692004771007, -774.103640356225, -1014.1369032500336, -1036.9476375948202, -16.985458885504634, -38.89598870178023, -632.6216999856775, -395.52498826473123, -1121.3866127070576, -1361.4071313944853, -224.5523490893296, -323.48891594679424, -996.3610051295591, -133.18286691518355, -890.4771203953975, -31.145337726077205, -1215.219905579339, -459.16390278514444, -759.3620882133729, -413.75634187216934, -1111.0768624771813, -68.86149726442223, -182.11207829480088, -646.4427502547899, -998.3622456147216, -919.5699397445266, -110.71084934477769, -244.85695561979898, -1129.7493774387592, -413.9681037969708, -400.1623660697405, -1244.889624692992, -886.3241976983625, -1049.6069070592025, -1275.6110276200714, -1224.9986686550646, -302.7827656229329, -952.5937235395189, -1245.4484004578885, -805.3709870110617, -1104.661190275808, -786.4025530407012, -285.371207972213, -267.9286743244879, -28.85320750467523, -801.7856995290589, -879.4644823824589, -454.01057408671335, -209.0920807004528, -383.6453797203854, -24.788869813241195, -592.5991061058253, -1177.927349157176, -957.2441718597814, -119.64880748800049, -969.5847263309395, -772.6517266700506, -452.52449773593463, -783.5957983703407, -152.25163376477295, -374.9482381500511, -1105.9403723413666, -787.4796799978268, -281.3520314207689, -1100.7914820231465, -925.3813490114707, -1017.5255116509587, -997.9456313696265, -131.84579125350322, -1303.423332342158, -1228.4280574108589, -195.25275718165645, -915.2994590180007, -864.6145284391959, -320.1929813606064, -722.7876518223654, -462.8772357489692, -912.5515822791932, -943.1967154760929, -1071.7089086670148, -120.15898434032206, -1086.8857124454246, -840.2071840144696, -1061.7345852757708, -1225.5820781530995, -857.9593870583493, -972.9988760430198, -985.536482328548, -827.8562315571797, -1045.9220618417942, -511.8301487846699, -622.0056955705847, -868.7992304381847, -912.1411719560235, -492.0374788751691, -1056.3122748613243, -679.3281010441648, -1193.7800639402135, -1000.4202512964865, -204.34272208422874, -129.21476131430464, -901.2458943744737, -232.7233394598842, -950.2317739787841, -1080.6087455042252, -432.75034460617223, -730.0568988373983, -1137.2019680933383, -873.836860221455, -872.5452643553064, -614.5460775313859, -1274.223240111809, -1076.2445138310256, -183.17840595766393, -815.0290124019705, -101.52841129953734, -1326.8116032874343, -1015.8543003253556, -579.1122725130888, -72.82921338371543, -456.503797735736, -810.5437309486736, -1066.2949371007437, -216.28029242409542, -1226.6633273655016, -842.5256894895473, -1021.6502269350223, -649.9666603958307, -1204.3432219910658, -174.10075261133292, -330.0842454852059, -923.9339104235262, -961.286054298328, -1281.531857980205, -633.7395189710868, -1325.916118458712, -1178.048927572304, -1106.6400190768918, -919.8166847828527, -993.1659665069355, -847.6497121847366, -403.03913732181246, -1013.0667233971778, -969.8386198733342, -591.2690833921404, -1076.8741928617374, -1179.6863491288038, -1028.3257572617017, -464.1229490328038, -819.7403382170382, -761.8250775494987, -1351.914905338983, -403.8980818966658, -528.7105862712119, -146.02922821939367, -168.50864569687332, -573.7613025898738, -101.59983593138506, -51.344347985129616, -581.4681178719638, -852.3903654533962, -1022.7244174385626, -1142.1932207752557, -861.8608051267084, -232.10238526984864, -905.3342502092138, -964.9987607099331, -759.5430114635878, -925.0984961354098, -1058.6823442621023, -1080.611173887718, -313.8498411110776, -1248.0030794336901, -1053.852289925662, -449.8555779890023, -166.46906425188686, -805.9655062198254, -1209.072211394051, -82.12731000997694, -14.294743538292199, -882.5987866775865, -550.6008361244396, -722.7342845111933, -1006.5359945948001, -578.3966676437907, -1170.2115927915581, -470.7440701553869, -201.19421918028937, -43.78484987376163, -1174.8099626729822, -285.3237608489355, -1314.2374725533484, -403.7060404333818, -751.2682504429248, -1034.8974708850922, -1264.3535386572157, -909.1052171860101, -354.37748211512394, -954.9265683515224, -499.6273849556332, -1162.9841373169359, -817.5334169264852, -976.461839262781, -285.15777944892847, -1083.0986899617824, -478.9182740588225, -984.9578610891742, -333.0957003651783, -109.33860220430952, -998.7247869872575, -382.3782831289803, -28.340587113808898, -350.8619475133388, -549.8949882430744, -1074.199885635974, -100.71626230979204, -783.1952311638809, -40.1768825980614, -1057.6508668071383, -1159.2333995253928, -528.5891118861832, -961.058779131617, -1034.340081223813, -209.95933865596538, -102.69051729309192, -1252.862759237746, -674.8941361703505, -1091.3009599696045, -1004.6504544732783, -301.8872791985521, -1094.8695603173862, -467.83902320871744, -665.772927386439, -234.80948568049726, -1185.3484909991491, -167.35708562908314, -1076.6500591617555, -1043.902033073192, -1053.4407575193277, -994.1748530555581, -1130.8149539376466, -954.8331565544931, -1021.3255681626051, -1109.3068368165627, -504.1516773884428, -1165.308634318113, -956.6781095054577, -994.5605341902149, -31.380091163855266, -918.8461471675398, -800.4615499840343, -1120.1651192488735, -1019.7393779293881, -100.47662557647176, -100.42116746205886, -28.96700729960905, -585.9465007944162, -1348.5694470006913, -201.3998595362457, -885.8650223499401, -1175.3915627879596, -1398.0049876013813, -106.53416822176925, -1145.644051635349, -1067.5987905817478, -57.28559235475, -1086.8474911389753, -1094.887133794528, -673.4915613036078, -710.541761169199, -912.6297618632863, -618.3367827358248, -614.825979814404, -891.8960062808285, -538.3392612117364, -1016.0833754269252, -30.873619732464746, -1088.158353584394, -1280.8949283394766, -350.6931504336019, -355.84658186461746, -899.5169667384629, -840.7598617158116, -170.90129734697229, -116.37836545955025, -59.3706778629922, -1246.3261261033063, -898.639185218317, -219.07547186905003, -608.9265402128424, -908.2099212393864, -929.7060253963269, -216.57848784095242, -1232.7284644795927, -984.4545803287256, -220.01243770468986, -115.51812855587649, -1207.0115378770056, -724.7332020926276, -969.9764789102273, -156.2593237544543, -237.61513562315952, -642.2035214576409, -644.5969965223796, -1279.2084953001317, -88.80996458722942, -468.6996934577654, -742.4129741041914, -60.376628291938886, -26.334142288709973, -983.5262636975909, -818.8551958161122, -117.09629396835264, -1021.5895148321607, -1304.6792513345315, -390.5727498990208, -825.9661598738072, -846.4456960294234, -786.1601401994601, -658.8177850812448, -897.0877956743889, -384.9505906049795, -955.0640469201961, -369.08811970796296, -1105.2358353283685, -883.1761337000688, -1122.8937168534194, -923.5636699211681, -379.85255827315103, -80.10568341765645, -1141.5670118603439, -548.0561299413861, -920.6996087555189, -1113.3294591299643, -667.1939834468651, -965.4455140912188, -246.6292554327155, -930.7140853209207, -235.09790714488102, -111.09884822721203, -207.2552744453877, -1043.419934493541, -1122.5758690796888, -191.62517681097728, -371.6257295653343, -926.5389765516949, -53.719259023079346, -1041.6175917335665, -80.75308372231297, -1253.3168487145122, -916.374226215851, -816.6879663132098, -522.8801551067505, -135.47265929432936, -861.8722717174408, -1202.0419632500107, -592.3043107155978, -1008.8915546206365, -116.7207550330058, -434.0527057643539, -506.5896004710986, -1141.7652560943636, -775.5661952060698, -134.87173725273126, -1117.4191327798897, -1111.4253591544013, -1063.5271082324869, -925.4293271671979, -679.6445585580304, -135.10989007126867, -50.007136228608935, -1016.1917563733739, -878.3376066392104, -807.4902570803636, -724.0027749040673, -143.73141384489116, -152.9649652616544, -1049.3662458129795, -1003.3405336817559, -915.5979418464186, -319.9621215339058, -226.36285129305296, -649.4923576378142, -188.4473344180973, -560.8297523372876, -33.984892469003796, -738.1000302718189, -649.5441724198631, -364.05872482765784, -788.135610353294, -1018.8842865602671, -164.12346120540232, -859.3559130608006, -622.8615408365681, -929.2196912448537, -369.1002431027607, -1087.0300364375837, -742.5807858402358, -929.0591437163205, -128.85631893213875, -1134.1312407368653, -128.30688191318558, -362.9005608012635, -870.5253218056591, -71.50255206374563, -108.36888034865959, -347.98121890105534, -1363.2799395729712, -1094.9590973906602, -737.7349514617215, -1089.1687238742318, -685.1343629932937, -175.56702363211798, -13.06365972948414, -133.9057390443517, -60.02124050604715, -364.510451730692, -898.4985578303359, -52.24600914717083, -756.4529328057274, -976.6171172540411, -1037.164450664084, -942.6265769812651, -1158.4168178712948, -959.6658004053628, -1200.8723840204364, -611.66781675032, -358.864198722565, -446.11403911629014, -1091.3018969929803, -145.7708717435889, -774.5633296106776, -1119.6672113951427, -995.6841376189861, -371.7634100659019, -1083.679469034901, -151.18901479455585, -739.824390890118, -1132.180997445223, -991.757264388843, -242.6055574384569, -1240.4907723849824, -380.5197304466046, -1093.4540747116548, -1026.9597976173202, -684.4616622357906, -754.1591404749768, -249.65880341063598, -68.30459346421092, -1104.3633335871516, -653.0256827924856, -1181.4616469640196, -697.1760950385112, -360.8590135209945, -71.47058027300714, -1343.4447294732715, -764.2036979515863, -233.83291643759856, -1093.3378377468332, -951.2936169838322, -1128.778517580958, -1240.377077365388, -323.23692163901876, -841.1535827616067, -994.2537883498486, -850.1111670802766, -1035.1957018303813, -912.1675183147494, -233.8738469900957, -1046.8540597345034, -1023.5861812525606, -377.5988825352582, -233.5093637132599, -1088.1836602313977, -550.2784056544549, -1135.8427068303613]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1849200688109054, "mean_inference_ms": 2.378999311393085, "mean_action_processing_ms": 1.0666293410594616, "mean_env_wait_ms": 15.872021847967414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019870996475219727, "StateBufferConnector_ms": 0.014954090118408203, "ViewRequirementAgentConnector_ms": 0.7258737087249756}, "num_episodes": 23, "episode_return_max": -1067.6920259052943, "episode_return_min": -5681.430425725693, "episode_return_mean": -3553.7632838802806, "episodes_this_iter": 23}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 89283, "num_agent_steps_trained": 89283, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 75.66860051266092, "num_env_steps_trained_throughput_per_sec": 75.66860051266092, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 89283, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 89283, "timers": {"training_iteration_time_ms": 56772.451, "restore_workers_time_ms": 0.034, "training_step_time_ms": 56772.376, "sample_time_ms": 4588.591, "learn_time_ms": 52125.183, "learn_throughput": 76.738, "synch_weights_time_ms": 55.768}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 89283, "num_agent_steps_trained": 89283}, "done": false, "training_iteration": 5, "trial_id": "fafd3_00000", "date": "2024-08-05_11-35-14", "timestamp": 1722837914, "time_this_iter_s": 52.8731107711792, "time_total_s": 283.92040181159973, "pid": 668605, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a020f62e60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 283.92040181159973, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 15.92, "ram_util_percent": 30.906666666666673}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 201.32518126294505, "cur_kl_coeff": 0.2, "cur_lr": 0.0010000000000000002, "total_loss": 1.378803538237262, "policy_loss": -0.0024450491412166377, "vf_loss": 1.3810717592961388, "vf_explained_var": 0.9872272085779892, "kl": 0.00804571179614234, "entropy": 1.4323147294568082, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.7124183006536, "num_grad_updates_lifetime": 23325.5, "diff_num_grad_updates_vs_sampler_policy": 2294.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 108823, "num_agent_steps_trained": 108823}, "env_runners": {"episode_reward_max": -1067.6920259052943, "episode_reward_min": -5298.982656747484, "episode_reward_mean": -3583.062558605044, "episode_len_mean": 149.78, "episode_media": {}, "episodes_timesteps_total": 14978, "policy_reward_min": {"policy_0": -1438.0884998329645}, "policy_reward_max": {"policy_0": -13.06365972948414}, "policy_reward_mean": {"policy_0": -716.6125117210087}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3207.085899679402, -3597.560097923539, -4228.187069038884, -3450.203583602009, -3451.1111872453266, -4162.307977328559, -3380.145107418459, -5126.40746013185, -5045.3213101237225, -4054.087756846201, -4253.700471189849, -2599.061447423127, -2160.5639698317473, -4164.215078819591, -4788.933786458754, -3232.029852711319, -2994.058557839731, -4028.479375665782, -2175.8568627313557, -4768.462772971958, -3881.0207899252255, -3641.1699996587977, -2808.495233774895, -2104.01367081599, -3568.8454919806572, -3560.9114755422347, -4167.602390129176, -2721.1270129038844, -5298.982656747484, -4754.925873240215, -3701.926432011102, -2369.7692975164014, -4197.172392469258, -3775.067590395002, -4478.397709269595, -3679.4814054697217, -3106.466633954554, -2086.9271691237873, -3881.1772446429018, -3583.4799957502864, -3173.4986711901925, -2892.434113490542, -2281.349701840197, -3652.7930058501815, -4014.47757685833, -3697.514726261576, -3647.9826403257375, -4214.7246953649565, -1730.7953705711175, -3655.7856865012345, -3345.7810094093215, -3538.9550156817413, -2658.5589266046954, -4281.047680487459, -2853.718020257593, -3569.753808841906, -3441.2318081367166, -1659.1171881552561, -3558.7228244329, -2944.6608494503866, -4021.6575256631436, -1541.6041969325127, -4633.123931200638, -1067.6920259052943, -3048.3250687679656, -5298.746029942447, -2653.7188233257443, -4345.357557725613, -3257.5572249571965, -4425.886037396352, -2829.5115537294587, -3654.412065269806, -4171.446586700805, -4249.132537196139, -4251.677308122293, -3385.413018964734, -3082.1067122609816, -3757.433468764454, -4436.408437887877, -3177.020884028712, -1609.2272515132418, -5185.0737267217655, -2699.69747059122, -4861.899343743893, -4815.345168678651, -5163.671734471823, -4258.273268180429, -3499.8818535144437, -4300.416652385912, -3995.097089028125, -4705.928712019355, -4208.583898450537, -5012.91012027224, -3814.958654792151, -3129.0821333965773, -2937.1020267439517, -3739.070475839611, -3313.003395390983, -2525.3019949497398, -2195.8564850632156], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-679.3281010441648, -1193.7800639402135, -1000.4202512964865, -204.34272208422874, -129.21476131430464, -901.2458943744737, -232.7233394598842, -950.2317739787841, -1080.6087455042252, -432.75034460617223, -730.0568988373983, -1137.2019680933383, -873.836860221455, -872.5452643553064, -614.5460775313859, -1274.223240111809, -1076.2445138310256, -183.17840595766393, -815.0290124019705, -101.52841129953734, -1326.8116032874343, -1015.8543003253556, -579.1122725130888, -72.82921338371543, -456.503797735736, -810.5437309486736, -1066.2949371007437, -216.28029242409542, -1226.6633273655016, -842.5256894895473, -1021.6502269350223, -649.9666603958307, -1204.3432219910658, -174.10075261133292, -330.0842454852059, -923.9339104235262, -961.286054298328, -1281.531857980205, -633.7395189710868, -1325.916118458712, -1178.048927572304, -1106.6400190768918, -919.8166847828527, -993.1659665069355, -847.6497121847366, -403.03913732181246, -1013.0667233971778, -969.8386198733342, -591.2690833921404, -1076.8741928617374, -1179.6863491288038, -1028.3257572617017, -464.1229490328038, -819.7403382170382, -761.8250775494987, -1351.914905338983, -403.8980818966658, -528.7105862712119, -146.02922821939367, -168.50864569687332, -573.7613025898738, -101.59983593138506, -51.344347985129616, -581.4681178719638, -852.3903654533962, -1022.7244174385626, -1142.1932207752557, -861.8608051267084, -232.10238526984864, -905.3342502092138, -964.9987607099331, -759.5430114635878, -925.0984961354098, -1058.6823442621023, -1080.611173887718, -313.8498411110776, -1248.0030794336901, -1053.852289925662, -449.8555779890023, -166.46906425188686, -805.9655062198254, -1209.072211394051, -82.12731000997694, -14.294743538292199, -882.5987866775865, -550.6008361244396, -722.7342845111933, -1006.5359945948001, -578.3966676437907, -1170.2115927915581, -470.7440701553869, -201.19421918028937, -43.78484987376163, -1174.8099626729822, -285.3237608489355, -1314.2374725533484, -403.7060404333818, -751.2682504429248, -1034.8974708850922, -1264.3535386572157, -909.1052171860101, -354.37748211512394, -954.9265683515224, -499.6273849556332, -1162.9841373169359, -817.5334169264852, -976.461839262781, -285.15777944892847, -1083.0986899617824, -478.9182740588225, -984.9578610891742, -333.0957003651783, -109.33860220430952, -998.7247869872575, -382.3782831289803, -28.340587113808898, -350.8619475133388, -549.8949882430744, -1074.199885635974, -100.71626230979204, -783.1952311638809, -40.1768825980614, -1057.6508668071383, -1159.2333995253928, -528.5891118861832, -961.058779131617, -1034.340081223813, -209.95933865596538, -102.69051729309192, -1252.862759237746, -674.8941361703505, -1091.3009599696045, -1004.6504544732783, -301.8872791985521, -1094.8695603173862, -467.83902320871744, -665.772927386439, -234.80948568049726, -1185.3484909991491, -167.35708562908314, -1076.6500591617555, -1043.902033073192, -1053.4407575193277, -994.1748530555581, -1130.8149539376466, -954.8331565544931, -1021.3255681626051, -1109.3068368165627, -504.1516773884428, -1165.308634318113, -956.6781095054577, -994.5605341902149, -31.380091163855266, -918.8461471675398, -800.4615499840343, -1120.1651192488735, -1019.7393779293881, -100.47662557647176, -100.42116746205886, -28.96700729960905, -585.9465007944162, -1348.5694470006913, -201.3998595362457, -885.8650223499401, -1175.3915627879596, -1398.0049876013813, -106.53416822176925, -1145.644051635349, -1067.5987905817478, -57.28559235475, -1086.8474911389753, -1094.887133794528, -673.4915613036078, -710.541761169199, -912.6297618632863, -618.3367827358248, -614.825979814404, -891.8960062808285, -538.3392612117364, -1016.0833754269252, -30.873619732464746, -1088.158353584394, -1280.8949283394766, -350.6931504336019, -355.84658186461746, -899.5169667384629, -840.7598617158116, -170.90129734697229, -116.37836545955025, -59.3706778629922, -1246.3261261033063, -898.639185218317, -219.07547186905003, -608.9265402128424, -908.2099212393864, -929.7060253963269, -216.57848784095242, -1232.7284644795927, -984.4545803287256, -220.01243770468986, -115.51812855587649, -1207.0115378770056, -724.7332020926276, -969.9764789102273, -156.2593237544543, -237.61513562315952, -642.2035214576409, -644.5969965223796, -1279.2084953001317, -88.80996458722942, -468.6996934577654, -742.4129741041914, -60.376628291938886, -26.334142288709973, -983.5262636975909, -818.8551958161122, -117.09629396835264, -1021.5895148321607, -1304.6792513345315, -390.5727498990208, -825.9661598738072, -846.4456960294234, -786.1601401994601, -658.8177850812448, -897.0877956743889, -384.9505906049795, -955.0640469201961, -369.08811970796296, -1105.2358353283685, -883.1761337000688, -1122.8937168534194, -923.5636699211681, -379.85255827315103, -80.10568341765645, -1141.5670118603439, -548.0561299413861, -920.6996087555189, -1113.3294591299643, -667.1939834468651, -965.4455140912188, -246.6292554327155, -930.7140853209207, -235.09790714488102, -111.09884822721203, -207.2552744453877, -1043.419934493541, -1122.5758690796888, -191.62517681097728, -371.6257295653343, -926.5389765516949, -53.719259023079346, -1041.6175917335665, -80.75308372231297, -1253.3168487145122, -916.374226215851, -816.6879663132098, -522.8801551067505, -135.47265929432936, -861.8722717174408, -1202.0419632500107, -592.3043107155978, -1008.8915546206365, -116.7207550330058, -434.0527057643539, -506.5896004710986, -1141.7652560943636, -775.5661952060698, -134.87173725273126, -1117.4191327798897, -1111.4253591544013, -1063.5271082324869, -925.4293271671979, -679.6445585580304, -135.10989007126867, -50.007136228608935, -1016.1917563733739, -878.3376066392104, -807.4902570803636, -724.0027749040673, -143.73141384489116, -152.9649652616544, -1049.3662458129795, -1003.3405336817559, -915.5979418464186, -319.9621215339058, -226.36285129305296, -649.4923576378142, -188.4473344180973, -560.8297523372876, -33.984892469003796, -738.1000302718189, -649.5441724198631, -364.05872482765784, -788.135610353294, -1018.8842865602671, -164.12346120540232, -859.3559130608006, -622.8615408365681, -929.2196912448537, -369.1002431027607, -1087.0300364375837, -742.5807858402358, -929.0591437163205, -128.85631893213875, -1134.1312407368653, -128.30688191318558, -362.9005608012635, -870.5253218056591, -71.50255206374563, -108.36888034865959, -347.98121890105534, -1363.2799395729712, -1094.9590973906602, -737.7349514617215, -1089.1687238742318, -685.1343629932937, -175.56702363211798, -13.06365972948414, -133.9057390443517, -60.02124050604715, -364.510451730692, -898.4985578303359, -52.24600914717083, -756.4529328057274, -976.6171172540411, -1037.164450664084, -942.6265769812651, -1158.4168178712948, -959.6658004053628, -1200.8723840204364, -611.66781675032, -358.864198722565, -446.11403911629014, -1091.3018969929803, -145.7708717435889, -774.5633296106776, -1119.6672113951427, -995.6841376189861, -371.7634100659019, -1083.679469034901, -151.18901479455585, -739.824390890118, -1132.180997445223, -991.757264388843, -242.6055574384569, -1240.4907723849824, -380.5197304466046, -1093.4540747116548, -1026.9597976173202, -684.4616622357906, -754.1591404749768, -249.65880341063598, -68.30459346421092, -1104.3633335871516, -653.0256827924856, -1181.4616469640196, -697.1760950385112, -360.8590135209945, -71.47058027300714, -1343.4447294732715, -764.2036979515863, -233.83291643759856, -1093.3378377468332, -951.2936169838322, -1128.778517580958, -1240.377077365388, -323.23692163901876, -841.1535827616067, -994.2537883498486, -850.1111670802766, -1035.1957018303813, -912.1675183147494, -233.8738469900957, -1046.8540597345034, -1023.5861812525606, -377.5988825352582, -233.5093637132599, -1088.1836602313977, -550.2784056544549, -1135.8427068303613, -1304.3830599465596, -38.26724219663784, -583.8644831099533, -948.2707602956342, -207.32116671219617, -206.94916991564762, -1031.3458950510344, -960.4564391777034, -917.1799910507582, -641.5019735693106, -1111.251985962133, -1154.705682306154, -633.13195328549, -1157.2356023778093, -380.0832139562901, -637.6746450659025, -283.7881451680629, -1130.4226033070513, -931.535857092191, -193.59963339550316, -250.79727427753988, -276.35405148110084, -67.18810734901352, -779.585653990305, -235.30216441528287, -1317.4989084389972, -949.7368371741264, -807.980910040541, -1109.584306350995, -1000.2727647171041, -163.20378492613906, -607.0035683962624, -623.242381288046, -184.39049410645507, -1121.857241874318, -567.3709237734809, -1200.3616599203567, -1142.0533305312172, -945.7752671386386, -1006.3381623802001, -1030.758786050276, -1396.7004986775855, -879.5473130885692, -1026.459365733987, -481.8792051282321, -298.8993974055757, -1333.79945233141, -1277.6210684658024, -1173.5569819343564, -1079.7948343346802, -402.4823127787871, -1008.6495076150692, -1230.0234211079812, -805.6502612816319, -811.4677653969611, -1199.0448641643497, -329.2293832169515, -991.3357172498819, -189.66838617011223, -790.6035027131462, -216.11122892052785, -1061.1240691408088, -1042.68289694604, -698.5294971619393, -1281.968960216596, -1281.2536849325531, -1157.808670042465, -31.455219380645136, -647.6118383929787, -876.9676762794847, -295.5335505521262, -843.0435279153838, -1256.003457917398, -1186.891769595397, -1124.4564060390449, -1205.7444080631183, -1314.7984832081947, -191.25383014695623, -385.54554508045175, -1111.2416319518147, -1438.0884998329645, -941.1006360667526, -930.8259221471178, -822.6179154600597, -880.2771467653477, -1003.3114248394911, -1359.429529134823, -975.6754096240549, -214.50571702605893, -262.0365741677271, -658.6942114833537, -837.5099411999386, -155.86296647602677, -914.3701754342553, -562.6448388029976, -875.3934365206861, -45.24741227127798, -1189.9787565299118, -413.07660271572325, -413.4058187063527, -1170.497029875701, -234.9142843277767, -608.7212268907965, -1335.7827281142822, -389.1552066310537, -1045.4536451284619, -316.2375497007228, -1133.1376679370796, -786.3337698554373, -31.84076276927949, -99.93864858409783, -364.0698573251927, -1159.9174876088027, -846.3860789830765, -54.98992244857036, -98.5790715730485, -886.6637385396814, -239.25237617011834, -454.4507036496565, -516.9105951307127]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2443545726040823, "mean_inference_ms": 2.4665291251755126, "mean_action_processing_ms": 1.1428819786380235, "mean_env_wait_ms": 16.340203633011985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01975727081298828, "StateBufferConnector_ms": 0.014983892440795898, "ViewRequirementAgentConnector_ms": 0.7412660121917725}, "num_episodes": 24, "episode_return_max": -1067.6920259052943, "episode_return_min": -5298.982656747484, "episode_return_mean": -3583.062558605044, "episodes_this_iter": 24}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108823, "num_agent_steps_trained": 108823, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 70.4582783528628, "num_env_steps_trained_throughput_per_sec": 70.4582783528628, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 108823, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108823, "timers": {"training_iteration_time_ms": 56772.242, "restore_workers_time_ms": 0.032, "training_step_time_ms": 56772.169, "sample_time_ms": 4459.917, "learn_time_ms": 52251.171, "learn_throughput": 76.553, "synch_weights_time_ms": 58.163}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 108823, "num_agent_steps_trained": 108823}, "done": false, "training_iteration": 6, "trial_id": "fafd3_00000", "date": "2024-08-05_11-36-11", "timestamp": 1722837971, "time_this_iter_s": 56.78240966796875, "time_total_s": 340.7028114795685, "pid": 668605, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a020f60310>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 340.7028114795685, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 16.426250000000003, "ram_util_percent": 30.90625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 192.67718596713533, "cur_kl_coeff": 0.2, "cur_lr": 0.0010000000000000002, "total_loss": 1.4675917224874222, "policy_loss": -0.0011471766995748988, "vf_loss": 1.4686262025754637, "vf_explained_var": 0.9825702871927999, "kl": 0.007675924299092227, "entropy": 1.422487510746889, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.41975308641975, "num_grad_updates_lifetime": 28050.5, "diff_num_grad_updates_vs_sampler_policy": 2429.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 129465, "num_agent_steps_trained": 129465}, "env_runners": {"episode_reward_max": -1067.6920259052943, "episode_reward_min": -5323.1057093983145, "episode_reward_mean": -3620.413862580633, "episode_len_mean": 149.78, "episode_media": {}, "episodes_timesteps_total": 14978, "policy_reward_min": {"policy_0": -1466.5693007424966}, "policy_reward_max": {"policy_0": -12.761208766821255}, "policy_reward_mean": {"policy_0": -724.0827725161267}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3697.514726261576, -3647.9826403257375, -4214.7246953649565, -1730.7953705711175, -3655.7856865012345, -3345.7810094093215, -3538.9550156817413, -2658.5589266046954, -4281.047680487459, -2853.718020257593, -3569.753808841906, -3441.2318081367166, -1659.1171881552561, -3558.7228244329, -2944.6608494503866, -4021.6575256631436, -1541.6041969325127, -4633.123931200638, -1067.6920259052943, -3048.3250687679656, -5298.746029942447, -2653.7188233257443, -4345.357557725613, -3257.5572249571965, -4425.886037396352, -2829.5115537294587, -3654.412065269806, -4171.446586700805, -4249.132537196139, -4251.677308122293, -3385.413018964734, -3082.1067122609816, -3757.433468764454, -4436.408437887877, -3177.020884028712, -1609.2272515132418, -5185.0737267217655, -2699.69747059122, -4861.899343743893, -4815.345168678651, -5163.671734471823, -4258.273268180429, -3499.8818535144437, -4300.416652385912, -3995.097089028125, -4705.928712019355, -4208.583898450537, -5012.91012027224, -3814.958654792151, -3129.0821333965773, -2937.1020267439517, -3739.070475839611, -3313.003395390983, -2525.3019949497398, -2195.8564850632156, -2158.951125357701, -3714.091849515126, -2408.939538780926, -3993.0030918231823, -3978.6856031695847, -4722.0321709309155, -5036.942391563648, -4899.873244329826, -4457.409660686745, -2177.5190176341594, -2424.1952010466885, -2137.112134207447, -4364.776050964272, -3927.3058863328365, -1733.3562266987806, -3491.2137536570026, -4411.690161799409, -4001.472505855259, -4723.201111735821, -5009.4844309468945, -3975.1457048104867, -3297.1435147488114, -5216.081686798648, -3001.427634050949, -3146.612510442328, -3822.875176803635, -4525.442810937719, -4151.539403248984, -1619.5889199893977, -4315.626371324601, -4028.9439772591386, -3857.413754533081, -3597.012888913928, -3586.442763650204, -2894.5795805379335, -2842.6263316872783, -2533.0856421822295, -3680.099998808565, -3812.411108768633, -5238.28069679778, -5323.1057093983145, -3452.612246941074, -3260.8398919627107, -3385.1372951533704, -3649.0927803046843], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-384.9505906049795, -955.0640469201961, -369.08811970796296, -1105.2358353283685, -883.1761337000688, -1122.8937168534194, -923.5636699211681, -379.85255827315103, -80.10568341765645, -1141.5670118603439, -548.0561299413861, -920.6996087555189, -1113.3294591299643, -667.1939834468651, -965.4455140912188, -246.6292554327155, -930.7140853209207, -235.09790714488102, -111.09884822721203, -207.2552744453877, -1043.419934493541, -1122.5758690796888, -191.62517681097728, -371.6257295653343, -926.5389765516949, -53.719259023079346, -1041.6175917335665, -80.75308372231297, -1253.3168487145122, -916.374226215851, -816.6879663132098, -522.8801551067505, -135.47265929432936, -861.8722717174408, -1202.0419632500107, -592.3043107155978, -1008.8915546206365, -116.7207550330058, -434.0527057643539, -506.5896004710986, -1141.7652560943636, -775.5661952060698, -134.87173725273126, -1117.4191327798897, -1111.4253591544013, -1063.5271082324869, -925.4293271671979, -679.6445585580304, -135.10989007126867, -50.007136228608935, -1016.1917563733739, -878.3376066392104, -807.4902570803636, -724.0027749040673, -143.73141384489116, -152.9649652616544, -1049.3662458129795, -1003.3405336817559, -915.5979418464186, -319.9621215339058, -226.36285129305296, -649.4923576378142, -188.4473344180973, -560.8297523372876, -33.984892469003796, -738.1000302718189, -649.5441724198631, -364.05872482765784, -788.135610353294, -1018.8842865602671, -164.12346120540232, -859.3559130608006, -622.8615408365681, -929.2196912448537, -369.1002431027607, -1087.0300364375837, -742.5807858402358, -929.0591437163205, -128.85631893213875, -1134.1312407368653, -128.30688191318558, -362.9005608012635, -870.5253218056591, -71.50255206374563, -108.36888034865959, -347.98121890105534, -1363.2799395729712, -1094.9590973906602, -737.7349514617215, -1089.1687238742318, -685.1343629932937, -175.56702363211798, -13.06365972948414, -133.9057390443517, -60.02124050604715, -364.510451730692, -898.4985578303359, -52.24600914717083, -756.4529328057274, -976.6171172540411, -1037.164450664084, -942.6265769812651, -1158.4168178712948, -959.6658004053628, -1200.8723840204364, -611.66781675032, -358.864198722565, -446.11403911629014, -1091.3018969929803, -145.7708717435889, -774.5633296106776, -1119.6672113951427, -995.6841376189861, -371.7634100659019, -1083.679469034901, -151.18901479455585, -739.824390890118, -1132.180997445223, -991.757264388843, -242.6055574384569, -1240.4907723849824, -380.5197304466046, -1093.4540747116548, -1026.9597976173202, -684.4616622357906, -754.1591404749768, -249.65880341063598, -68.30459346421092, -1104.3633335871516, -653.0256827924856, -1181.4616469640196, -697.1760950385112, -360.8590135209945, -71.47058027300714, -1343.4447294732715, -764.2036979515863, -233.83291643759856, -1093.3378377468332, -951.2936169838322, -1128.778517580958, -1240.377077365388, -323.23692163901876, -841.1535827616067, -994.2537883498486, -850.1111670802766, -1035.1957018303813, -912.1675183147494, -233.8738469900957, -1046.8540597345034, -1023.5861812525606, -377.5988825352582, -233.5093637132599, -1088.1836602313977, -550.2784056544549, -1135.8427068303613, -1304.3830599465596, -38.26724219663784, -583.8644831099533, -948.2707602956342, -207.32116671219617, -206.94916991564762, -1031.3458950510344, -960.4564391777034, -917.1799910507582, -641.5019735693106, -1111.251985962133, -1154.705682306154, -633.13195328549, -1157.2356023778093, -380.0832139562901, -637.6746450659025, -283.7881451680629, -1130.4226033070513, -931.535857092191, -193.59963339550316, -250.79727427753988, -276.35405148110084, -67.18810734901352, -779.585653990305, -235.30216441528287, -1317.4989084389972, -949.7368371741264, -807.980910040541, -1109.584306350995, -1000.2727647171041, -163.20378492613906, -607.0035683962624, -623.242381288046, -184.39049410645507, -1121.857241874318, -567.3709237734809, -1200.3616599203567, -1142.0533305312172, -945.7752671386386, -1006.3381623802001, -1030.758786050276, -1396.7004986775855, -879.5473130885692, -1026.459365733987, -481.8792051282321, -298.8993974055757, -1333.79945233141, -1277.6210684658024, -1173.5569819343564, -1079.7948343346802, -402.4823127787871, -1008.6495076150692, -1230.0234211079812, -805.6502612816319, -811.4677653969611, -1199.0448641643497, -329.2293832169515, -991.3357172498819, -189.66838617011223, -790.6035027131462, -216.11122892052785, -1061.1240691408088, -1042.68289694604, -698.5294971619393, -1281.968960216596, -1281.2536849325531, -1157.808670042465, -31.455219380645136, -647.6118383929787, -876.9676762794847, -295.5335505521262, -843.0435279153838, -1256.003457917398, -1186.891769595397, -1124.4564060390449, -1205.7444080631183, -1314.7984832081947, -191.25383014695623, -385.54554508045175, -1111.2416319518147, -1438.0884998329645, -941.1006360667526, -930.8259221471178, -822.6179154600597, -880.2771467653477, -1003.3114248394911, -1359.429529134823, -975.6754096240549, -214.50571702605893, -262.0365741677271, -658.6942114833537, -837.5099411999386, -155.86296647602677, -914.3701754342553, -562.6448388029976, -875.3934365206861, -45.24741227127798, -1189.9787565299118, -413.07660271572325, -413.4058187063527, -1170.497029875701, -234.9142843277767, -608.7212268907965, -1335.7827281142822, -389.1552066310537, -1045.4536451284619, -316.2375497007228, -1133.1376679370796, -786.3337698554373, -31.84076276927949, -99.93864858409783, -364.0698573251927, -1159.9174876088027, -846.3860789830765, -54.98992244857036, -98.5790715730485, -886.6637385396814, -239.25237617011834, -454.4507036496565, -516.9105951307127, -345.4970699107783, -539.955611890753, -82.1877674912931, -208.2653223040837, -983.0453537607941, -1116.3495463160407, -546.4341058339426, -214.07223262800878, -776.7887383419031, -1060.447226395229, -15.388610173898893, -719.9767593387761, -162.58051968077504, -44.42434884497849, -1466.5693007424966, -1060.660016121077, -316.54085943282837, -929.2684487404945, -666.0092821154877, -1020.5244854132926, -749.8636088186562, -1127.0978115476755, -1096.4672531345836, -661.0932362702829, -344.16369339838724, -1173.0843064683586, -1082.6449901937892, -1011.7185107915572, -107.29762545027585, -1347.286738026941, -1303.3509300196347, -1130.6821511466032, -1012.0899800453544, -1272.6919629028546, -318.1273674492073, -1440.772811797975, -506.40872599543616, -938.0835694246779, -1107.3871283093315, -907.2210088024059, -861.2405441983799, -1080.5549433513272, -1001.07398766214, -760.1025270279491, -754.4376584469486, -894.9014993392473, -982.7611730610097, -187.8597605572394, -17.14206322249497, -94.8545214541671, -164.85418023060765, -880.8387261434581, -107.74859813517847, -188.71019714581283, -1082.0434993916308, -728.8650573941135, -774.908512529132, -220.64634391986448, -62.63428565072743, -350.0579347136064, -737.512300511783, -847.3319032988409, -1182.3788552695773, -1187.9657448270548, -409.5872470570151, -1123.4727499926762, -613.4841982437734, -1236.850099641704, -366.9658110186331, -586.5330274360512, -391.4972909294407, -284.8946852769965, -29.599567189871635, -70.13687057057469, -957.2278127318973, -1342.4820957053184, -270.938967526016, -942.0738231602604, -474.8851099194885, -460.83375734592016, -804.0990005159869, -684.9427552849526, -749.7524207398534, -843.6155072573185, -1329.2804780012987, -930.6566879096104, -885.7414141476886, -62.19088872221889, -999.5319761162458, -1123.3515389594916, -987.1893943228927, -1207.9816132493936, -388.4339208344978, -1049.6242382040198, -1089.9719451250114, -799.2393361824577, -1094.4006617635555, -1028.0506984649396, -947.7366957983037, -1140.0570387376417, -1121.4326015196384, -729.7476514375593, -271.14263130673294, -1064.7855966192276, -788.0372239273329, -190.29265817001, -1192.557973473777, -893.7748450910162, -754.6815264497611, -265.83651156424526, -915.8991226717101, -991.3604799156101, -1213.7573450507211, -1043.293038584379, -1051.7717005762188, -12.761208766821255, -967.4475381546347, -1003.0683491406389, -387.00275357822153, -631.1477844106312, -1117.1115402654796, -447.57571637401907, -780.4410103111665, -356.97188988073873, -444.5123536109282, -1150.205963287297, -439.60748998596176, -859.3947151657197, -260.17680055001506, -1113.4902078146436, -1214.029035806975, -99.96024761460572, -769.4258318000121, -1402.7511016213214, -1039.276594094807, -1045.3656875665843, -863.91694057428, -1015.707099458768, -1111.591500112884, -114.95817553647231, -16.776517619857994, -232.1894058675888, -424.3010476810555, -92.8681164430171, -853.453832377878, -340.98121412234997, -1022.7964736731351, -1151.7085937309332, -768.075619133393, -1032.064470664791, -1334.300115017862, -224.0303931433327, -1035.9676848681509, -613.475240684761, -821.1705435450326, -899.4937385566042, -88.52165191197463, -536.6483760769084, -1121.3810821951104, -1211.3689057924869, -346.861480323595, -149.61120159687155, -442.2332141894629, -1375.3612736184596, -1282.9457191855379, -631.4925172642849, -655.7354400260838, -583.4041092992275, -1193.56921180372, -522.2414852568872, -1031.555882086624, -967.8953511671737, -571.1168901907088, -249.6175319695404, -74.3939251238905, -1069.2886175365659, -501.3001915523141, -1004.3344402163076, -191.8372144457594, -75.86586793633099, -98.01756440657184, -840.0172180699333, -447.317235065445, -842.6898553065672, -305.0437693337141, -389.999169410101, -701.8098959570343, -1360.4527671467742, -912.1277661673186, -315.71040012733846, -721.2771991186352, -290.7905186793954, -1178.2371585056203, -1086.1523334679468, -535.9538989970354, -1102.8535382013454, -559.1519149270638, -867.7467681333871, -1378.2004134379533, -1330.3280620980313, -746.4576442730944, -1416.9949970535545, -1062.7228789814053, -1048.9738072359514, -1047.9563818543108, -299.9365079641663, -998.0528701054102, -1031.1128003589579, -809.7859808069031, -313.72408770563345, -631.0232893079532, -138.50819215571195, -502.5681049043741, -1374.6241277288966, -614.1161778657741, -1346.686869245421, -436.6669500349157, -393.21853231936984, -358.83399881244185, -849.7309447412223, -898.3886813841202, -577.4797815185813, -115.97131059513183, -855.047235009352, -1202.2057717974992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2057373695821356, "mean_inference_ms": 2.430243894640912, "mean_action_processing_ms": 1.1954701006124293, "mean_env_wait_ms": 16.02708565581361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018285274505615234, "StateBufferConnector_ms": 0.013492584228515625, "ViewRequirementAgentConnector_ms": 0.589993953704834}, "num_episodes": 45, "episode_return_max": -1067.6920259052943, "episode_return_min": -5323.1057093983145, "episode_return_mean": -3620.413862580633, "episodes_this_iter": 45}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 129465, "num_agent_steps_trained": 129465, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 67.51909435285808, "num_env_steps_trained_throughput_per_sec": 67.51909435285808, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 129465, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 129465, "timers": {"training_iteration_time_ms": 57125.138, "restore_workers_time_ms": 0.033, "training_step_time_ms": 57125.064, "sample_time_ms": 4330.071, "learn_time_ms": 52728.628, "learn_throughput": 75.86, "synch_weights_time_ms": 63.34}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 129465, "num_agent_steps_trained": 129465}, "done": false, "training_iteration": 7, "trial_id": "fafd3_00000", "date": "2024-08-05_11-37-10", "timestamp": 1722838030, "time_this_iter_s": 59.255088090896606, "time_total_s": 399.9578995704651, "pid": 668605, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a020f63f40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 399.9578995704651, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 15.855294117647059, "ram_util_percent": 29.387058823529397}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 179.13907288228623, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.2591435206508395, "policy_loss": -0.003888718243700104, "vf_loss": 1.2626029475018232, "vf_explained_var": 0.9933696771811957, "kl": 0.009137919646879038, "entropy": 1.3982931218364023, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.96212121212122, "num_grad_updates_lifetime": 32460.5, "diff_num_grad_updates_vs_sampler_policy": 1979.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 146356, "num_agent_steps_trained": 146356}, "env_runners": {"episode_reward_max": -1609.2272515132418, "episode_reward_min": -5323.1057093983145, "episode_reward_mean": -3609.767927124606, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1466.5693007424966}, "policy_reward_max": {"policy_0": -12.463158280294035}, "policy_reward_mean": {"policy_0": -721.9535854249215}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3257.5572249571965, -4425.886037396352, -2829.5115537294587, -3654.412065269806, -4171.446586700805, -4249.132537196139, -4251.677308122293, -3385.413018964734, -3082.1067122609816, -3757.433468764454, -4436.408437887877, -3177.020884028712, -1609.2272515132418, -5185.0737267217655, -2699.69747059122, -4861.899343743893, -4815.345168678651, -5163.671734471823, -4258.273268180429, -3499.8818535144437, -4300.416652385912, -3995.097089028125, -4705.928712019355, -4208.583898450537, -5012.91012027224, -3814.958654792151, -3129.0821333965773, -2937.1020267439517, -3739.070475839611, -3313.003395390983, -2525.3019949497398, -2195.8564850632156, -2158.951125357701, -3714.091849515126, -2408.939538780926, -3993.0030918231823, -3978.6856031695847, -4722.0321709309155, -5036.942391563648, -4899.873244329826, -4457.409660686745, -2177.5190176341594, -2424.1952010466885, -2137.112134207447, -4364.776050964272, -3927.3058863328365, -1733.3562266987806, -3491.2137536570026, -4411.690161799409, -4001.472505855259, -4723.201111735821, -5009.4844309468945, -3975.1457048104867, -3297.1435147488114, -5216.081686798648, -3001.427634050949, -3146.612510442328, -3822.875176803635, -4525.442810937719, -4151.539403248984, -1619.5889199893977, -4315.626371324601, -4028.9439772591386, -3857.413754533081, -3597.012888913928, -3586.442763650204, -2894.5795805379335, -2842.6263316872783, -2533.0856421822295, -3680.099998808565, -3812.411108768633, -5238.28069679778, -5323.1057093983145, -3452.612246941074, -3260.8398919627107, -3385.1372951533704, -3649.0927803046843, -4056.75495896982, -3503.6265896210184, -3733.3550054510947, -4116.298868331098, -2284.7045060352407, -2530.0689701044344, -4654.300609504679, -3926.990765543736, -2722.7231036145317, -3648.3773687124935, -3626.771480708631, -3404.090311314636, -2005.6552199228674, -3565.3987339245214, -2420.306918121072, -3541.6633742191075, -3309.218464944542, -3715.3654518226936, -1986.859231086285, -2982.0733493700063, -1731.6764063258292, -3916.829826377379, -2960.8723503176197], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-151.18901479455585, -739.824390890118, -1132.180997445223, -991.757264388843, -242.6055574384569, -1240.4907723849824, -380.5197304466046, -1093.4540747116548, -1026.9597976173202, -684.4616622357906, -754.1591404749768, -249.65880341063598, -68.30459346421092, -1104.3633335871516, -653.0256827924856, -1181.4616469640196, -697.1760950385112, -360.8590135209945, -71.47058027300714, -1343.4447294732715, -764.2036979515863, -233.83291643759856, -1093.3378377468332, -951.2936169838322, -1128.778517580958, -1240.377077365388, -323.23692163901876, -841.1535827616067, -994.2537883498486, -850.1111670802766, -1035.1957018303813, -912.1675183147494, -233.8738469900957, -1046.8540597345034, -1023.5861812525606, -377.5988825352582, -233.5093637132599, -1088.1836602313977, -550.2784056544549, -1135.8427068303613, -1304.3830599465596, -38.26724219663784, -583.8644831099533, -948.2707602956342, -207.32116671219617, -206.94916991564762, -1031.3458950510344, -960.4564391777034, -917.1799910507582, -641.5019735693106, -1111.251985962133, -1154.705682306154, -633.13195328549, -1157.2356023778093, -380.0832139562901, -637.6746450659025, -283.7881451680629, -1130.4226033070513, -931.535857092191, -193.59963339550316, -250.79727427753988, -276.35405148110084, -67.18810734901352, -779.585653990305, -235.30216441528287, -1317.4989084389972, -949.7368371741264, -807.980910040541, -1109.584306350995, -1000.2727647171041, -163.20378492613906, -607.0035683962624, -623.242381288046, -184.39049410645507, -1121.857241874318, -567.3709237734809, -1200.3616599203567, -1142.0533305312172, -945.7752671386386, -1006.3381623802001, -1030.758786050276, -1396.7004986775855, -879.5473130885692, -1026.459365733987, -481.8792051282321, -298.8993974055757, -1333.79945233141, -1277.6210684658024, -1173.5569819343564, -1079.7948343346802, -402.4823127787871, -1008.6495076150692, -1230.0234211079812, -805.6502612816319, -811.4677653969611, -1199.0448641643497, -329.2293832169515, -991.3357172498819, -189.66838617011223, -790.6035027131462, -216.11122892052785, -1061.1240691408088, -1042.68289694604, -698.5294971619393, -1281.968960216596, -1281.2536849325531, -1157.808670042465, -31.455219380645136, -647.6118383929787, -876.9676762794847, -295.5335505521262, -843.0435279153838, -1256.003457917398, -1186.891769595397, -1124.4564060390449, -1205.7444080631183, -1314.7984832081947, -191.25383014695623, -385.54554508045175, -1111.2416319518147, -1438.0884998329645, -941.1006360667526, -930.8259221471178, -822.6179154600597, -880.2771467653477, -1003.3114248394911, -1359.429529134823, -975.6754096240549, -214.50571702605893, -262.0365741677271, -658.6942114833537, -837.5099411999386, -155.86296647602677, -914.3701754342553, -562.6448388029976, -875.3934365206861, -45.24741227127798, -1189.9787565299118, -413.07660271572325, -413.4058187063527, -1170.497029875701, -234.9142843277767, -608.7212268907965, -1335.7827281142822, -389.1552066310537, -1045.4536451284619, -316.2375497007228, -1133.1376679370796, -786.3337698554373, -31.84076276927949, -99.93864858409783, -364.0698573251927, -1159.9174876088027, -846.3860789830765, -54.98992244857036, -98.5790715730485, -886.6637385396814, -239.25237617011834, -454.4507036496565, -516.9105951307127, -345.4970699107783, -539.955611890753, -82.1877674912931, -208.2653223040837, -983.0453537607941, -1116.3495463160407, -546.4341058339426, -214.07223262800878, -776.7887383419031, -1060.447226395229, -15.388610173898893, -719.9767593387761, -162.58051968077504, -44.42434884497849, -1466.5693007424966, -1060.660016121077, -316.54085943282837, -929.2684487404945, -666.0092821154877, -1020.5244854132926, -749.8636088186562, -1127.0978115476755, -1096.4672531345836, -661.0932362702829, -344.16369339838724, -1173.0843064683586, -1082.6449901937892, -1011.7185107915572, -107.29762545027585, -1347.286738026941, -1303.3509300196347, -1130.6821511466032, -1012.0899800453544, -1272.6919629028546, -318.1273674492073, -1440.772811797975, -506.40872599543616, -938.0835694246779, -1107.3871283093315, -907.2210088024059, -861.2405441983799, -1080.5549433513272, -1001.07398766214, -760.1025270279491, -754.4376584469486, -894.9014993392473, -982.7611730610097, -187.8597605572394, -17.14206322249497, -94.8545214541671, -164.85418023060765, -880.8387261434581, -107.74859813517847, -188.71019714581283, -1082.0434993916308, -728.8650573941135, -774.908512529132, -220.64634391986448, -62.63428565072743, -350.0579347136064, -737.512300511783, -847.3319032988409, -1182.3788552695773, -1187.9657448270548, -409.5872470570151, -1123.4727499926762, -613.4841982437734, -1236.850099641704, -366.9658110186331, -586.5330274360512, -391.4972909294407, -284.8946852769965, -29.599567189871635, -70.13687057057469, -957.2278127318973, -1342.4820957053184, -270.938967526016, -942.0738231602604, -474.8851099194885, -460.83375734592016, -804.0990005159869, -684.9427552849526, -749.7524207398534, -843.6155072573185, -1329.2804780012987, -930.6566879096104, -885.7414141476886, -62.19088872221889, -999.5319761162458, -1123.3515389594916, -987.1893943228927, -1207.9816132493936, -388.4339208344978, -1049.6242382040198, -1089.9719451250114, -799.2393361824577, -1094.4006617635555, -1028.0506984649396, -947.7366957983037, -1140.0570387376417, -1121.4326015196384, -729.7476514375593, -271.14263130673294, -1064.7855966192276, -788.0372239273329, -190.29265817001, -1192.557973473777, -893.7748450910162, -754.6815264497611, -265.83651156424526, -915.8991226717101, -991.3604799156101, -1213.7573450507211, -1043.293038584379, -1051.7717005762188, -12.761208766821255, -967.4475381546347, -1003.0683491406389, -387.00275357822153, -631.1477844106312, -1117.1115402654796, -447.57571637401907, -780.4410103111665, -356.97188988073873, -444.5123536109282, -1150.205963287297, -439.60748998596176, -859.3947151657197, -260.17680055001506, -1113.4902078146436, -1214.029035806975, -99.96024761460572, -769.4258318000121, -1402.7511016213214, -1039.276594094807, -1045.3656875665843, -863.91694057428, -1015.707099458768, -1111.591500112884, -114.95817553647231, -16.776517619857994, -232.1894058675888, -424.3010476810555, -92.8681164430171, -853.453832377878, -340.98121412234997, -1022.7964736731351, -1151.7085937309332, -768.075619133393, -1032.064470664791, -1334.300115017862, -224.0303931433327, -1035.9676848681509, -613.475240684761, -821.1705435450326, -899.4937385566042, -88.52165191197463, -536.6483760769084, -1121.3810821951104, -1211.3689057924869, -346.861480323595, -149.61120159687155, -442.2332141894629, -1375.3612736184596, -1282.9457191855379, -631.4925172642849, -655.7354400260838, -583.4041092992275, -1193.56921180372, -522.2414852568872, -1031.555882086624, -967.8953511671737, -571.1168901907088, -249.6175319695404, -74.3939251238905, -1069.2886175365659, -501.3001915523141, -1004.3344402163076, -191.8372144457594, -75.86586793633099, -98.01756440657184, -840.0172180699333, -447.317235065445, -842.6898553065672, -305.0437693337141, -389.999169410101, -701.8098959570343, -1360.4527671467742, -912.1277661673186, -315.71040012733846, -721.2771991186352, -290.7905186793954, -1178.2371585056203, -1086.1523334679468, -535.9538989970354, -1102.8535382013454, -559.1519149270638, -867.7467681333871, -1378.2004134379533, -1330.3280620980313, -746.4576442730944, -1416.9949970535545, -1062.7228789814053, -1048.9738072359514, -1047.9563818543108, -299.9365079641663, -998.0528701054102, -1031.1128003589579, -809.7859808069031, -313.72408770563345, -631.0232893079532, -138.50819215571195, -502.5681049043741, -1374.6241277288966, -614.1161778657741, -1346.686869245421, -436.6669500349157, -393.21853231936984, -358.83399881244185, -849.7309447412223, -898.3886813841202, -577.4797815185813, -115.97131059513183, -855.047235009352, -1202.2057717974992, -1140.133961723622, -746.7652253218714, -787.1505115463265, -1038.8387722388838, -343.86648813911654, -311.80321451451834, -347.11782438773724, -964.7649935807477, -883.3812354146427, -996.5593217233721, -1331.8031372738992, -453.91029745094096, -883.8307090594942, -1013.5620540566609, -50.24880761009911, -1337.2371521701593, -469.3733160761574, -673.7298075836329, -1265.7227497084307, -370.2358427927151, -558.9564989243383, -847.960858127544, -533.9260752025391, -101.32153706649115, -242.5395367143269, -555.6066684590927, -911.7592455303907, -76.3137991809467, -105.64902143635045, -880.7402354976577, -1250.2369228164523, -857.5657186748076, -486.54029768910976, -1075.2594088448639, -984.6982614794442, -880.701434973033, -1095.0240939286612, -938.4175535085316, -103.67887436892327, -909.1688087645864, -232.58497008226246, -1227.9567856150136, -872.4567102185263, -185.7935909288535, -203.93104676987682, -742.219955213571, -1021.1189284074117, -1075.3406562838281, -736.958903972811, -72.73892483487091, -534.9034121485382, -571.0375013689056, -276.5674309206204, -1146.704209858821, -1097.5589264117473, -1203.2602572962408, -1063.5309785389065, -538.8989582517638, -142.89424937270928, -455.50586785501906, -92.03596427085994, -224.36700992147914, -581.6104508235677, -240.10428933649675, -867.5375055704635, -156.40979066690232, -1401.3178006106164, -1219.479158275901, -219.2375321730184, -568.9544521980823, -349.37111623211035, -14.625805627496801, -1269.5737896625574, -446.60869677165067, -340.12750982725674, -111.69498979958982, -554.4909751131692, -1083.0224138189012, -1151.1475016139666, -641.307493873481, -489.94986612783, -469.193173110736, -1026.6705785410861, -1152.1885395088232, -171.2163076560642, -1095.9829809375706, -70.17453432165563, -345.6479417727387, -1066.9177297622625, -1136.6422650284674, -975.8329590620808, -221.2663493530575, -20.408763313982604, -745.5001655169967, -23.850993840166872, -1004.6236209511321, -12.463158280294035, -248.00340488598036, -1082.039634099162, -634.9435311534371, -884.816614430679, -52.20013896700077, -153.9631578821681, -300.0539264972453, -340.64256854873736, -407.0739900637379, -1049.054779330083, -1226.4748750727567, -973.2638645538177, -260.9623173569849, -1166.613594452307, -238.59918441894007, -1137.764154339983, -324.66414699125573, -93.23127011513365]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.159100869932374, "mean_inference_ms": 2.3745521363209505, "mean_action_processing_ms": 1.206773343117305, "mean_env_wait_ms": 15.67295107882015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018064022064208984, "StateBufferConnector_ms": 0.013297796249389648, "ViewRequirementAgentConnector_ms": 0.49262237548828125}, "num_episodes": 23, "episode_return_max": -1609.2272515132418, "episode_return_min": -5323.1057093983145, "episode_return_mean": -3609.767927124606, "episodes_this_iter": 23}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 146356, "num_agent_steps_trained": 146356, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.51409950190937, "num_env_steps_trained_throughput_per_sec": 82.51409950190937, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 146356, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 146356, "timers": {"training_iteration_time_ms": 56044.068, "restore_workers_time_ms": 0.034, "training_step_time_ms": 56043.992, "sample_time_ms": 4221.936, "learn_time_ms": 51754.038, "learn_throughput": 77.289, "synch_weights_time_ms": 65.037}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 146356, "num_agent_steps_trained": 146356}, "done": false, "training_iteration": 8, "trial_id": "fafd3_00000", "date": "2024-08-05_11-37-59", "timestamp": 1722838079, "time_this_iter_s": 48.488807916641235, "time_total_s": 448.4467074871063, "pid": 668605, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a020f637f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 448.4467074871063, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 16.720289855072462, "ram_util_percent": 29.205797101449274}}
