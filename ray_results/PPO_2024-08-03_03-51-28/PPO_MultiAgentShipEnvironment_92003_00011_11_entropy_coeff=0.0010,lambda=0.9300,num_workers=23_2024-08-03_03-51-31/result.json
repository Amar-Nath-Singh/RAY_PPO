{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1001698018051684, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.54400027692318, "policy_loss": -0.004036109885297871, "vf_loss": 9.547887646158536, "vf_explained_var": 0.049056052478651205, "kl": 0.007806403019071695, "entropy": 1.4125350844115019, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -2.8162373798491465, "episode_reward_min": -1215.1592617415217, "episode_reward_mean": -650.0505353174908, "episode_len_mean": 129.08, "episode_media": {}, "episodes_timesteps_total": 3227, "policy_reward_min": {"policy_0": -1215.1592617415217}, "policy_reward_max": {"policy_0": -2.8162373798491465}, "policy_reward_mean": {"policy_0": -650.0505353174908}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1109.0803095162512, -334.6742247736404, -784.3149096532729, -46.78483710009282, -1098.196665655715, -681.9357191270861, -277.351781312181, -2.8162373798491465, -589.3298741875963, -1039.3818084760949, -778.268778003174, -449.3008478657804, -762.6024668689054, -835.3820757592939, -156.693904320609, -938.6802009651336, -778.4355170409289, -824.9013448259954, -1215.1592617415217, -1180.10317528503, -769.7189045720584, -478.6999568654358, -146.71888640959295, -224.1306819732661, -748.601013258768], "episode_lengths": [150, 150, 150, 51, 150, 150, 101, 41, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 112, 56, 96, 150], "policy_policy_0_reward": [-1109.0803095162512, -334.6742247736404, -784.3149096532729, -46.78483710009282, -1098.196665655715, -681.9357191270861, -277.351781312181, -2.8162373798491465, -589.3298741875963, -1039.3818084760949, -778.268778003174, -449.3008478657804, -762.6024668689054, -835.3820757592939, -156.693904320609, -938.6802009651336, -778.4355170409289, -824.9013448259954, -1215.1592617415217, -1180.10317528503, -769.7189045720584, -478.6999568654358, -146.71888640959295, -224.1306819732661, -748.601013258768]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.581430509407532, "mean_inference_ms": 1.6937445062721892, "mean_action_processing_ms": 0.2922259551550955, "mean_env_wait_ms": 2.9912188722582282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011549949645996094, "StateBufferConnector_ms": 0.007931709289550781, "ViewRequirementAgentConnector_ms": 0.1803302764892578}, "num_episodes": 25, "episode_return_max": -2.8162373798491465, "episode_return_min": -1215.1592617415217, "episode_return_mean": -650.0505353174908, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.41091533449503, "num_env_steps_trained_throughput_per_sec": 307.41091533449503, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 13011.911, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13011.845, "sample_time_ms": 1068.953, "learn_time_ms": 11878.676, "learn_throughput": 336.738, "synch_weights_time_ms": 63.372}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "92003_00011", "date": "2024-08-03_04-08-46", "timestamp": 1722638326, "time_this_iter_s": 13.022278785705566, "time_total_s": 13.022278785705566, "pid": 470944, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c7237f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13.022278785705566, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 16.757894736842108, "ram_util_percent": 27.594736842105267}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0489902068550387, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.156170902649562, "policy_loss": -0.006430552709692468, "vf_loss": 9.161525802810987, "vf_explained_var": 0.18293494066844385, "kl": 0.012504135226102638, "entropy": 1.4251834792395432, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -2.8162373798491465, "episode_reward_min": -1215.1592617415217, "episode_reward_mean": -689.4914417786314, "episode_len_mean": 132.42857142857142, "episode_media": {}, "episodes_timesteps_total": 6489, "policy_reward_min": {"policy_0": -1215.1592617415217}, "policy_reward_max": {"policy_0": -2.8162373798491465}, "policy_reward_mean": {"policy_0": -689.4914417786314}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1109.0803095162512, -334.6742247736404, -784.3149096532729, -46.78483710009282, -1098.196665655715, -681.9357191270861, -277.351781312181, -2.8162373798491465, -589.3298741875963, -1039.3818084760949, -778.268778003174, -449.3008478657804, -762.6024668689054, -835.3820757592939, -156.693904320609, -938.6802009651336, -778.4355170409289, -824.9013448259954, -1215.1592617415217, -1180.10317528503, -769.7189045720584, -478.6999568654358, -146.71888640959295, -224.1306819732661, -748.601013258768, -378.7205408085985, -1024.2604661808346, -155.2371845911134, -793.2872001577051, -333.93516770406205, -916.1379442069294, -951.3217409131014, -937.9524452697597, -765.5033300218272, -620.894193126706, -776.9732380890382, -372.09205140527195, -85.33549057714994, -977.0684360328713, -852.8760720421624, -645.4983008342841, -1001.248580292109, -928.4226795845186, -952.4202715897229, -1145.9794726896607, -938.9000388970142, -180.60172998730383, -833.0763340850265, -966.074355128891], "episode_lengths": [150, 150, 150, 51, 150, 150, 101, 41, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 112, 56, 96, 150, 109, 150, 64, 150, 150, 150, 150, 150, 150, 150, 150, 96, 80, 150, 150, 150, 150, 150, 150, 150, 150, 63, 150, 150], "policy_policy_0_reward": [-1109.0803095162512, -334.6742247736404, -784.3149096532729, -46.78483710009282, -1098.196665655715, -681.9357191270861, -277.351781312181, -2.8162373798491465, -589.3298741875963, -1039.3818084760949, -778.268778003174, -449.3008478657804, -762.6024668689054, -835.3820757592939, -156.693904320609, -938.6802009651336, -778.4355170409289, -824.9013448259954, -1215.1592617415217, -1180.10317528503, -769.7189045720584, -478.6999568654358, -146.71888640959295, -224.1306819732661, -748.601013258768, -378.7205408085985, -1024.2604661808346, -155.2371845911134, -793.2872001577051, -333.93516770406205, -916.1379442069294, -951.3217409131014, -937.9524452697597, -765.5033300218272, -620.894193126706, -776.9732380890382, -372.09205140527195, -85.33549057714994, -977.0684360328713, -852.8760720421624, -645.4983008342841, -1001.248580292109, -928.4226795845186, -952.4202715897229, -1145.9794726896607, -938.9000388970142, -180.60172998730383, -833.0763340850265, -966.074355128891]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5776719835247, "mean_inference_ms": 1.6966888819807933, "mean_action_processing_ms": 0.2914832805900265, "mean_env_wait_ms": 2.9999578544386605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014112433608697385, "StateBufferConnector_ms": 0.008439044563137755, "ViewRequirementAgentConnector_ms": 0.18346747573541136}, "num_episodes": 24, "episode_return_max": -2.8162373798491465, "episode_return_min": -1215.1592617415217, "episode_return_mean": -689.4914417786314, "episodes_this_iter": 24}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.23192236687595, "num_env_steps_trained_throughput_per_sec": 315.23192236687595, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 12850.496, "restore_workers_time_ms": 0.024, "training_step_time_ms": 12850.43, "sample_time_ms": 1064.855, "learn_time_ms": 11714.666, "learn_throughput": 341.452, "synch_weights_time_ms": 70.043}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "92003_00011", "date": "2024-08-03_04-08-58", "timestamp": 1722638338, "time_this_iter_s": 12.700905323028564, "time_total_s": 25.72318410873413, "pid": 470944, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8c37eb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25.72318410873413, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 17.772222222222226, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.713567816776534, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.671262481311958, "policy_loss": -0.0063680642182589505, "vf_loss": 8.67679161677758, "vf_explained_var": 0.31143809656302135, "kl": 0.01125865494426156, "entropy": 1.4127681879947582, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -2.8162373798491465, "episode_reward_min": -1230.0022427186798, "episode_reward_mean": -677.870515912214, "episode_len_mean": 135.42105263157896, "episode_media": {}, "episodes_timesteps_total": 10292, "policy_reward_min": {"policy_0": -1230.0022427186798}, "policy_reward_max": {"policy_0": -2.8162373798491465}, "policy_reward_mean": {"policy_0": -677.870515912214}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1109.0803095162512, -334.6742247736404, -784.3149096532729, -46.78483710009282, -1098.196665655715, -681.9357191270861, -277.351781312181, -2.8162373798491465, -589.3298741875963, -1039.3818084760949, -778.268778003174, -449.3008478657804, -762.6024668689054, -835.3820757592939, -156.693904320609, -938.6802009651336, -778.4355170409289, -824.9013448259954, -1215.1592617415217, -1180.10317528503, -769.7189045720584, -478.6999568654358, -146.71888640959295, -224.1306819732661, -748.601013258768, -378.7205408085985, -1024.2604661808346, -155.2371845911134, -793.2872001577051, -333.93516770406205, -916.1379442069294, -951.3217409131014, -937.9524452697597, -765.5033300218272, -620.894193126706, -776.9732380890382, -372.09205140527195, -85.33549057714994, -977.0684360328713, -852.8760720421624, -645.4983008342841, -1001.248580292109, -928.4226795845186, -952.4202715897229, -1145.9794726896607, -938.9000388970142, -180.60172998730383, -833.0763340850265, -966.074355128891, -338.63803210178895, -514.9735073307327, -859.9846057517451, -643.6254037620721, -546.3488654180552, -467.056637573007, -637.7175024449914, -198.1086363528548, -895.6879030693889, -616.860560236599, -165.53768986401553, -933.4336827202751, -377.5458942003821, -596.969031296416, -611.5054531642313, -652.3894330355994, -724.4947542798252, -1230.0022427186798, -984.0405153325564, -925.408870852939, -1065.9517346504533, -1213.8447866565027, -699.746579520381, -670.2659959909148, -336.50233596146626, -794.222650918588, -32.21525697088127], "episode_lengths": [150, 150, 150, 51, 150, 150, 101, 41, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 112, 56, 96, 150, 109, 150, 64, 150, 150, 150, 150, 150, 150, 150, 150, 96, 80, 150, 150, 150, 150, 150, 150, 150, 150, 63, 150, 150, 137, 150, 150, 150, 150, 102, 150, 112, 150, 150, 111, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61], "policy_policy_0_reward": [-1109.0803095162512, -334.6742247736404, -784.3149096532729, -46.78483710009282, -1098.196665655715, -681.9357191270861, -277.351781312181, -2.8162373798491465, -589.3298741875963, -1039.3818084760949, -778.268778003174, -449.3008478657804, -762.6024668689054, -835.3820757592939, -156.693904320609, -938.6802009651336, -778.4355170409289, -824.9013448259954, -1215.1592617415217, -1180.10317528503, -769.7189045720584, -478.6999568654358, -146.71888640959295, -224.1306819732661, -748.601013258768, -378.7205408085985, -1024.2604661808346, -155.2371845911134, -793.2872001577051, -333.93516770406205, -916.1379442069294, -951.3217409131014, -937.9524452697597, -765.5033300218272, -620.894193126706, -776.9732380890382, -372.09205140527195, -85.33549057714994, -977.0684360328713, -852.8760720421624, -645.4983008342841, -1001.248580292109, -928.4226795845186, -952.4202715897229, -1145.9794726896607, -938.9000388970142, -180.60172998730383, -833.0763340850265, -966.074355128891, -338.63803210178895, -514.9735073307327, -859.9846057517451, -643.6254037620721, -546.3488654180552, -467.056637573007, -637.7175024449914, -198.1086363528548, -895.6879030693889, -616.860560236599, -165.53768986401553, -933.4336827202751, -377.5458942003821, -596.969031296416, -611.5054531642313, -652.3894330355994, -724.4947542798252, -1230.0022427186798, -984.0405153325564, -925.408870852939, -1065.9517346504533, -1213.8447866565027, -699.746579520381, -670.2659959909148, -336.50233596146626, -794.222650918588, -32.21525697088127]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5755360989973424, "mean_inference_ms": 1.6931286970625785, "mean_action_processing_ms": 0.28994606874059586, "mean_env_wait_ms": 3.001079647808622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01361621053595292, "StateBufferConnector_ms": 0.008709493436311421, "ViewRequirementAgentConnector_ms": 0.18687938389025235}, "num_episodes": 27, "episode_return_max": -2.8162373798491465, "episode_return_min": -1230.0022427186798, "episode_return_mean": -677.870515912214, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 389.21302010637396, "num_env_steps_trained_throughput_per_sec": 389.21302010637396, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 11992.718, "restore_workers_time_ms": 0.024, "training_step_time_ms": 11992.653, "sample_time_ms": 1048.901, "learn_time_ms": 10873.164, "learn_throughput": 367.878, "synch_weights_time_ms": 69.758}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "92003_00011", "date": "2024-08-03_04-09-09", "timestamp": 1722638349, "time_this_iter_s": 10.2898850440979, "time_total_s": 36.01306915283203, "pid": 470944, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c722a70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 36.01306915283203, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 18.819999999999997, "ram_util_percent": 27.68666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.442247775693733, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.066123311718305, "policy_loss": -0.014158727950901569, "vf_loss": 7.078266145288945, "vf_explained_var": 0.7088581600536903, "kl": 0.017143180470702648, "entropy": 1.4127509500831366, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -2.8162373798491465, "episode_reward_min": -1230.0022427186798, "episode_reward_mean": -683.7973456761908, "episode_len_mean": 136.02, "episode_media": {}, "episodes_timesteps_total": 13602, "policy_reward_min": {"policy_0": -1230.0022427186798}, "policy_reward_max": {"policy_0": -2.8162373798491465}, "policy_reward_mean": {"policy_0": -683.7973456761908}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-681.9357191270861, -277.351781312181, -2.8162373798491465, -589.3298741875963, -1039.3818084760949, -778.268778003174, -449.3008478657804, -762.6024668689054, -835.3820757592939, -156.693904320609, -938.6802009651336, -778.4355170409289, -824.9013448259954, -1215.1592617415217, -1180.10317528503, -769.7189045720584, -478.6999568654358, -146.71888640959295, -224.1306819732661, -748.601013258768, -378.7205408085985, -1024.2604661808346, -155.2371845911134, -793.2872001577051, -333.93516770406205, -916.1379442069294, -951.3217409131014, -937.9524452697597, -765.5033300218272, -620.894193126706, -776.9732380890382, -372.09205140527195, -85.33549057714994, -977.0684360328713, -852.8760720421624, -645.4983008342841, -1001.248580292109, -928.4226795845186, -952.4202715897229, -1145.9794726896607, -938.9000388970142, -180.60172998730383, -833.0763340850265, -966.074355128891, -338.63803210178895, -514.9735073307327, -859.9846057517451, -643.6254037620721, -546.3488654180552, -467.056637573007, -637.7175024449914, -198.1086363528548, -895.6879030693889, -616.860560236599, -165.53768986401553, -933.4336827202751, -377.5458942003821, -596.969031296416, -611.5054531642313, -652.3894330355994, -724.4947542798252, -1230.0022427186798, -984.0405153325564, -925.408870852939, -1065.9517346504533, -1213.8447866565027, -699.746579520381, -670.2659959909148, -336.50233596146626, -794.222650918588, -32.21525697088127, -1158.112218174553, -562.9478295805843, -1158.3167630951168, -945.6057657243637, -874.1045423241333, -906.1711967147926, -716.383581808212, -162.63775696137472, -104.1689166295882, -550.0834985937051, -618.5124310262279, -999.9742998597402, -563.6926277727981, -422.78584070235183, -668.5260418740305, -946.7906184909194, -564.3016276371827, -711.8153442392689, -947.4163701011236, -727.3254850157142, -126.2687431214406, -901.0415181723359, -949.0301205042971, -1075.333280056858, -799.9885077946338, -690.266435133109, -853.5528925938153, -104.5462258904792, -424.92582539704074], "episode_lengths": [150, 101, 41, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 112, 56, 96, 150, 109, 150, 64, 150, 150, 150, 150, 150, 150, 150, 150, 96, 80, 150, 150, 150, 150, 150, 150, 150, 150, 63, 150, 150, 137, 150, 150, 150, 150, 102, 150, 112, 150, 150, 111, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150, 150, 150, 61, 49, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 68, 102], "policy_policy_0_reward": [-681.9357191270861, -277.351781312181, -2.8162373798491465, -589.3298741875963, -1039.3818084760949, -778.268778003174, -449.3008478657804, -762.6024668689054, -835.3820757592939, -156.693904320609, -938.6802009651336, -778.4355170409289, -824.9013448259954, -1215.1592617415217, -1180.10317528503, -769.7189045720584, -478.6999568654358, -146.71888640959295, -224.1306819732661, -748.601013258768, -378.7205408085985, -1024.2604661808346, -155.2371845911134, -793.2872001577051, -333.93516770406205, -916.1379442069294, -951.3217409131014, -937.9524452697597, -765.5033300218272, -620.894193126706, -776.9732380890382, -372.09205140527195, -85.33549057714994, -977.0684360328713, -852.8760720421624, -645.4983008342841, -1001.248580292109, -928.4226795845186, -952.4202715897229, -1145.9794726896607, -938.9000388970142, -180.60172998730383, -833.0763340850265, -966.074355128891, -338.63803210178895, -514.9735073307327, -859.9846057517451, -643.6254037620721, -546.3488654180552, -467.056637573007, -637.7175024449914, -198.1086363528548, -895.6879030693889, -616.860560236599, -165.53768986401553, -933.4336827202751, -377.5458942003821, -596.969031296416, -611.5054531642313, -652.3894330355994, -724.4947542798252, -1230.0022427186798, -984.0405153325564, -925.408870852939, -1065.9517346504533, -1213.8447866565027, -699.746579520381, -670.2659959909148, -336.50233596146626, -794.222650918588, -32.21525697088127, -1158.112218174553, -562.9478295805843, -1158.3167630951168, -945.6057657243637, -874.1045423241333, -906.1711967147926, -716.383581808212, -162.63775696137472, -104.1689166295882, -550.0834985937051, -618.5124310262279, -999.9742998597402, -563.6926277727981, -422.78584070235183, -668.5260418740305, -946.7906184909194, -564.3016276371827, -711.8153442392689, -947.4163701011236, -727.3254850157142, -126.2687431214406, -901.0415181723359, -949.0301205042971, -1075.333280056858, -799.9885077946338, -690.266435133109, -853.5528925938153, -104.5462258904792, -424.92582539704074]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5745308142904394, "mean_inference_ms": 1.693292387107517, "mean_action_processing_ms": 0.2894944558189222, "mean_env_wait_ms": 2.9993319580514908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014455556869506836, "StateBufferConnector_ms": 0.008717775344848633, "ViewRequirementAgentConnector_ms": 0.18937301635742188}, "num_episodes": 29, "episode_return_max": -2.8162373798491465, "episode_return_min": -1230.0022427186798, "episode_return_mean": -683.7973456761908, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.7472279145051, "num_env_steps_trained_throughput_per_sec": 303.7472279145051, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12286.753, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12286.683, "sample_time_ms": 1042.224, "learn_time_ms": 11174.263, "learn_throughput": 357.965, "synch_weights_time_ms": 69.272}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "92003_00011", "date": "2024-08-03_04-09-22", "timestamp": 1722638362, "time_this_iter_s": 13.181188583374023, "time_total_s": 49.194257736206055, "pid": 470944, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c78c1f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 49.194257736206055, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 17.07894736842105, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 60.853628748903674, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.850935201098522, "policy_loss": -0.009038513454045945, "vf_loss": 5.857973024249077, "vf_explained_var": 0.8709862709045411, "kl": 0.017270242406660457, "entropy": 1.4533666285375755, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -32.21525697088127, "episode_reward_min": -1230.0022427186798, "episode_reward_mean": -709.7922718787715, "episode_len_mean": 138.03, "episode_media": {}, "episodes_timesteps_total": 13803, "policy_reward_min": {"policy_0": -1230.0022427186798}, "policy_reward_max": {"policy_0": -32.21525697088127}, "policy_reward_mean": {"policy_0": -709.7922718787715}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-765.5033300218272, -620.894193126706, -776.9732380890382, -372.09205140527195, -85.33549057714994, -977.0684360328713, -852.8760720421624, -645.4983008342841, -1001.248580292109, -928.4226795845186, -952.4202715897229, -1145.9794726896607, -938.9000388970142, -180.60172998730383, -833.0763340850265, -966.074355128891, -338.63803210178895, -514.9735073307327, -859.9846057517451, -643.6254037620721, -546.3488654180552, -467.056637573007, -637.7175024449914, -198.1086363528548, -895.6879030693889, -616.860560236599, -165.53768986401553, -933.4336827202751, -377.5458942003821, -596.969031296416, -611.5054531642313, -652.3894330355994, -724.4947542798252, -1230.0022427186798, -984.0405153325564, -925.408870852939, -1065.9517346504533, -1213.8447866565027, -699.746579520381, -670.2659959909148, -336.50233596146626, -794.222650918588, -32.21525697088127, -1158.112218174553, -562.9478295805843, -1158.3167630951168, -945.6057657243637, -874.1045423241333, -906.1711967147926, -716.383581808212, -162.63775696137472, -104.1689166295882, -550.0834985937051, -618.5124310262279, -999.9742998597402, -563.6926277727981, -422.78584070235183, -668.5260418740305, -946.7906184909194, -564.3016276371827, -711.8153442392689, -947.4163701011236, -727.3254850157142, -126.2687431214406, -901.0415181723359, -949.0301205042971, -1075.333280056858, -799.9885077946338, -690.266435133109, -853.5528925938153, -104.5462258904792, -424.92582539704074, -825.0311640029126, -572.8039973087394, -1181.203493529189, -1020.8038072673011, -1016.0710560087359, -1070.5961045738077, -866.2779007851316, -1023.4806387765675, -894.3406072775043, -698.837275104232, -1107.3777161495113, -398.5880400175042, -730.6797328323838, -690.8930838027377, -369.2477964404088, -1156.0711999850807, -1109.6545545115127, -847.5162842391098, -298.9112854218291, -1090.3952178925883, -70.31273721618733, -199.500806371446, -126.318892909585, -967.4788355637913, -887.9314370105143, -1067.7018579296564, -35.606579108997806, -644.9256442915106], "episode_lengths": [150, 150, 150, 96, 80, 150, 150, 150, 150, 150, 150, 150, 150, 63, 150, 150, 137, 150, 150, 150, 150, 102, 150, 112, 150, 150, 111, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150, 150, 150, 61, 49, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 68, 102, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 56, 116, 62, 150, 150, 150, 56, 150], "policy_policy_0_reward": [-765.5033300218272, -620.894193126706, -776.9732380890382, -372.09205140527195, -85.33549057714994, -977.0684360328713, -852.8760720421624, -645.4983008342841, -1001.248580292109, -928.4226795845186, -952.4202715897229, -1145.9794726896607, -938.9000388970142, -180.60172998730383, -833.0763340850265, -966.074355128891, -338.63803210178895, -514.9735073307327, -859.9846057517451, -643.6254037620721, -546.3488654180552, -467.056637573007, -637.7175024449914, -198.1086363528548, -895.6879030693889, -616.860560236599, -165.53768986401553, -933.4336827202751, -377.5458942003821, -596.969031296416, -611.5054531642313, -652.3894330355994, -724.4947542798252, -1230.0022427186798, -984.0405153325564, -925.408870852939, -1065.9517346504533, -1213.8447866565027, -699.746579520381, -670.2659959909148, -336.50233596146626, -794.222650918588, -32.21525697088127, -1158.112218174553, -562.9478295805843, -1158.3167630951168, -945.6057657243637, -874.1045423241333, -906.1711967147926, -716.383581808212, -162.63775696137472, -104.1689166295882, -550.0834985937051, -618.5124310262279, -999.9742998597402, -563.6926277727981, -422.78584070235183, -668.5260418740305, -946.7906184909194, -564.3016276371827, -711.8153442392689, -947.4163701011236, -727.3254850157142, -126.2687431214406, -901.0415181723359, -949.0301205042971, -1075.333280056858, -799.9885077946338, -690.266435133109, -853.5528925938153, -104.5462258904792, -424.92582539704074, -825.0311640029126, -572.8039973087394, -1181.203493529189, -1020.8038072673011, -1016.0710560087359, -1070.5961045738077, -866.2779007851316, -1023.4806387765675, -894.3406072775043, -698.837275104232, -1107.3777161495113, -398.5880400175042, -730.6797328323838, -690.8930838027377, -369.2477964404088, -1156.0711999850807, -1109.6545545115127, -847.5162842391098, -298.9112854218291, -1090.3952178925883, -70.31273721618733, -199.500806371446, -126.318892909585, -967.4788355637913, -887.9314370105143, -1067.7018579296564, -35.606579108997806, -644.9256442915106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5727212778914345, "mean_inference_ms": 1.6919735478595603, "mean_action_processing_ms": 0.2884906279919925, "mean_env_wait_ms": 3.0021063688291307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014135599136352539, "StateBufferConnector_ms": 0.00866079330444336, "ViewRequirementAgentConnector_ms": 0.1906278133392334}, "num_episodes": 28, "episode_return_max": -32.21525697088127, "episode_return_min": -1230.0022427186798, "episode_return_mean": -709.7922718787715, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.0928042933939, "num_env_steps_trained_throughput_per_sec": 307.0928042933939, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 12434.481, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12434.409, "sample_time_ms": 1038.009, "learn_time_ms": 11326.1, "learn_throughput": 353.167, "synch_weights_time_ms": 69.411}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "92003_00011", "date": "2024-08-03_04-09-35", "timestamp": 1722638375, "time_this_iter_s": 13.03789234161377, "time_total_s": 62.232150077819824, "pid": 470944, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c723010>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 62.232150077819824, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 17.549999999999997, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 70.78579794565836, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.138318866491318, "policy_loss": -0.009402432797166209, "vf_loss": 6.146095760166645, "vf_explained_var": 0.854135604823629, "kl": 0.015501553468129722, "entropy": 1.4747791841626168, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -32.21525697088127, "episode_reward_min": -1275.093552920181, "episode_reward_mean": -728.8785073199995, "episode_len_mean": 138.73, "episode_media": {}, "episodes_timesteps_total": 13873, "policy_reward_min": {"policy_0": -1275.093552920181}, "policy_reward_max": {"policy_0": -32.21525697088127}, "policy_reward_mean": {"policy_0": -728.8785073199995}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-596.969031296416, -611.5054531642313, -652.3894330355994, -724.4947542798252, -1230.0022427186798, -984.0405153325564, -925.408870852939, -1065.9517346504533, -1213.8447866565027, -699.746579520381, -670.2659959909148, -336.50233596146626, -794.222650918588, -32.21525697088127, -1158.112218174553, -562.9478295805843, -1158.3167630951168, -945.6057657243637, -874.1045423241333, -906.1711967147926, -716.383581808212, -162.63775696137472, -104.1689166295882, -550.0834985937051, -618.5124310262279, -999.9742998597402, -563.6926277727981, -422.78584070235183, -668.5260418740305, -946.7906184909194, -564.3016276371827, -711.8153442392689, -947.4163701011236, -727.3254850157142, -126.2687431214406, -901.0415181723359, -949.0301205042971, -1075.333280056858, -799.9885077946338, -690.266435133109, -853.5528925938153, -104.5462258904792, -424.92582539704074, -825.0311640029126, -572.8039973087394, -1181.203493529189, -1020.8038072673011, -1016.0710560087359, -1070.5961045738077, -866.2779007851316, -1023.4806387765675, -894.3406072775043, -698.837275104232, -1107.3777161495113, -398.5880400175042, -730.6797328323838, -690.8930838027377, -369.2477964404088, -1156.0711999850807, -1109.6545545115127, -847.5162842391098, -298.9112854218291, -1090.3952178925883, -70.31273721618733, -199.500806371446, -126.318892909585, -967.4788355637913, -887.9314370105143, -1067.7018579296564, -35.606579108997806, -644.9256442915106, -910.6334467513345, -891.0757002018645, -214.26789224011168, -557.8187043000227, -920.0347013849901, -131.1760021473665, -805.9487863762237, -995.0480024670334, -763.6067244336688, -814.0287593285517, -1069.8664208108344, -668.1166674109713, -674.7181288694931, -621.7847421960448, -1021.7479073176346, -231.566049687718, -905.4239602039493, -419.2458007720893, -354.21218305782537, -723.2477067891471, -369.14453827903645, -999.6399167508482, -1275.093552920181, -1157.615443696677, -369.2783878613658, -1041.4915515318169, -509.567745678414, -755.2386217100853, -976.4689941569322], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150, 150, 150, 61, 49, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 68, 102, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 56, 116, 62, 150, 150, 150, 56, 150, 150, 150, 70, 132, 150, 86, 148, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 85, 150, 135, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-596.969031296416, -611.5054531642313, -652.3894330355994, -724.4947542798252, -1230.0022427186798, -984.0405153325564, -925.408870852939, -1065.9517346504533, -1213.8447866565027, -699.746579520381, -670.2659959909148, -336.50233596146626, -794.222650918588, -32.21525697088127, -1158.112218174553, -562.9478295805843, -1158.3167630951168, -945.6057657243637, -874.1045423241333, -906.1711967147926, -716.383581808212, -162.63775696137472, -104.1689166295882, -550.0834985937051, -618.5124310262279, -999.9742998597402, -563.6926277727981, -422.78584070235183, -668.5260418740305, -946.7906184909194, -564.3016276371827, -711.8153442392689, -947.4163701011236, -727.3254850157142, -126.2687431214406, -901.0415181723359, -949.0301205042971, -1075.333280056858, -799.9885077946338, -690.266435133109, -853.5528925938153, -104.5462258904792, -424.92582539704074, -825.0311640029126, -572.8039973087394, -1181.203493529189, -1020.8038072673011, -1016.0710560087359, -1070.5961045738077, -866.2779007851316, -1023.4806387765675, -894.3406072775043, -698.837275104232, -1107.3777161495113, -398.5880400175042, -730.6797328323838, -690.8930838027377, -369.2477964404088, -1156.0711999850807, -1109.6545545115127, -847.5162842391098, -298.9112854218291, -1090.3952178925883, -70.31273721618733, -199.500806371446, -126.318892909585, -967.4788355637913, -887.9314370105143, -1067.7018579296564, -35.606579108997806, -644.9256442915106, -910.6334467513345, -891.0757002018645, -214.26789224011168, -557.8187043000227, -920.0347013849901, -131.1760021473665, -805.9487863762237, -995.0480024670334, -763.6067244336688, -814.0287593285517, -1069.8664208108344, -668.1166674109713, -674.7181288694931, -621.7847421960448, -1021.7479073176346, -231.566049687718, -905.4239602039493, -419.2458007720893, -354.21218305782537, -723.2477067891471, -369.14453827903645, -999.6399167508482, -1275.093552920181, -1157.615443696677, -369.2783878613658, -1041.4915515318169, -509.567745678414, -755.2386217100853, -976.4689941569322]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5701654068933744, "mean_inference_ms": 1.6877441597081557, "mean_action_processing_ms": 0.2870597483772166, "mean_env_wait_ms": 3.0001503179912534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01405477523803711, "StateBufferConnector_ms": 0.008461952209472656, "ViewRequirementAgentConnector_ms": 0.18941521644592285}, "num_episodes": 29, "episode_return_max": -32.21525697088127, "episode_return_min": -1275.093552920181, "episode_return_mean": -728.8785073199995, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.4350475559426, "num_env_steps_trained_throughput_per_sec": 295.4350475559426, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12618.628, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12618.556, "sample_time_ms": 1044.303, "learn_time_ms": 11504.638, "learn_throughput": 347.686, "synch_weights_time_ms": 68.747}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "92003_00011", "date": "2024-08-03_04-09-48", "timestamp": 1722638388, "time_this_iter_s": 13.552720069885254, "time_total_s": 75.78487014770508, "pid": 470944, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c78c670>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 75.78487014770508, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 17.055, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 100.72423882285754, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.0234307813147705, "policy_loss": -0.013863723044535921, "vf_loss": 5.034765725582838, "vf_explained_var": 0.9370751111457746, "kl": 0.01930125257822511, "entropy": 1.331483925630649, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -35.606579108997806, "episode_reward_min": -1275.093552920181, "episode_reward_mean": -723.4499049248084, "episode_len_mean": 137.53, "episode_media": {}, "episodes_timesteps_total": 13753, "policy_reward_min": {"policy_0": -1275.093552920181}, "policy_reward_max": {"policy_0": -35.606579108997806}, "policy_reward_mean": {"policy_0": -723.4499049248084}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-947.4163701011236, -727.3254850157142, -126.2687431214406, -901.0415181723359, -949.0301205042971, -1075.333280056858, -799.9885077946338, -690.266435133109, -853.5528925938153, -104.5462258904792, -424.92582539704074, -825.0311640029126, -572.8039973087394, -1181.203493529189, -1020.8038072673011, -1016.0710560087359, -1070.5961045738077, -866.2779007851316, -1023.4806387765675, -894.3406072775043, -698.837275104232, -1107.3777161495113, -398.5880400175042, -730.6797328323838, -690.8930838027377, -369.2477964404088, -1156.0711999850807, -1109.6545545115127, -847.5162842391098, -298.9112854218291, -1090.3952178925883, -70.31273721618733, -199.500806371446, -126.318892909585, -967.4788355637913, -887.9314370105143, -1067.7018579296564, -35.606579108997806, -644.9256442915106, -910.6334467513345, -891.0757002018645, -214.26789224011168, -557.8187043000227, -920.0347013849901, -131.1760021473665, -805.9487863762237, -995.0480024670334, -763.6067244336688, -814.0287593285517, -1069.8664208108344, -668.1166674109713, -674.7181288694931, -621.7847421960448, -1021.7479073176346, -231.566049687718, -905.4239602039493, -419.2458007720893, -354.21218305782537, -723.2477067891471, -369.14453827903645, -999.6399167508482, -1275.093552920181, -1157.615443696677, -369.2783878613658, -1041.4915515318169, -509.567745678414, -755.2386217100853, -976.4689941569322, -776.872624987283, -631.6634021472306, -406.48575807845924, -846.840192014787, -177.22791953521207, -769.9332484051838, -969.6867709212637, -807.1487537373372, -844.1584937022235, -1119.7795387862827, -215.85271347307042, -368.2505438526697, -498.2767776672565, -1093.4263535195203, -1138.0091890683225, -1143.0527932579305, -936.5110847494034, -574.0496165580705, -912.9728699454242, -155.1347948873108, -344.3095402938085, -517.3684208296168, -1121.6377211128088, -825.6807818243502, -844.2122295393198, -224.80721961431055, -1038.8650519122814, -98.84467007134717, -929.4112258354054, -575.0257873808864, -1050.7209578188847, -673.4132575120369], "episode_lengths": [150, 150, 86, 150, 150, 150, 150, 150, 150, 68, 102, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 56, 116, 62, 150, 150, 150, 56, 150, 150, 150, 70, 132, 150, 86, 148, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 85, 150, 135, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 110, 150, 150, 150, 79, 150, 77, 150, 127, 150, 135], "policy_policy_0_reward": [-947.4163701011236, -727.3254850157142, -126.2687431214406, -901.0415181723359, -949.0301205042971, -1075.333280056858, -799.9885077946338, -690.266435133109, -853.5528925938153, -104.5462258904792, -424.92582539704074, -825.0311640029126, -572.8039973087394, -1181.203493529189, -1020.8038072673011, -1016.0710560087359, -1070.5961045738077, -866.2779007851316, -1023.4806387765675, -894.3406072775043, -698.837275104232, -1107.3777161495113, -398.5880400175042, -730.6797328323838, -690.8930838027377, -369.2477964404088, -1156.0711999850807, -1109.6545545115127, -847.5162842391098, -298.9112854218291, -1090.3952178925883, -70.31273721618733, -199.500806371446, -126.318892909585, -967.4788355637913, -887.9314370105143, -1067.7018579296564, -35.606579108997806, -644.9256442915106, -910.6334467513345, -891.0757002018645, -214.26789224011168, -557.8187043000227, -920.0347013849901, -131.1760021473665, -805.9487863762237, -995.0480024670334, -763.6067244336688, -814.0287593285517, -1069.8664208108344, -668.1166674109713, -674.7181288694931, -621.7847421960448, -1021.7479073176346, -231.566049687718, -905.4239602039493, -419.2458007720893, -354.21218305782537, -723.2477067891471, -369.14453827903645, -999.6399167508482, -1275.093552920181, -1157.615443696677, -369.2783878613658, -1041.4915515318169, -509.567745678414, -755.2386217100853, -976.4689941569322, -776.872624987283, -631.6634021472306, -406.48575807845924, -846.840192014787, -177.22791953521207, -769.9332484051838, -969.6867709212637, -807.1487537373372, -844.1584937022235, -1119.7795387862827, -215.85271347307042, -368.2505438526697, -498.2767776672565, -1093.4263535195203, -1138.0091890683225, -1143.0527932579305, -936.5110847494034, -574.0496165580705, -912.9728699454242, -155.1347948873108, -344.3095402938085, -517.3684208296168, -1121.6377211128088, -825.6807818243502, -844.2122295393198, -224.80721961431055, -1038.8650519122814, -98.84467007134717, -929.4112258354054, -575.0257873808864, -1050.7209578188847, -673.4132575120369]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5683473179302533, "mean_inference_ms": 1.6882070216432865, "mean_action_processing_ms": 0.28680163510435314, "mean_env_wait_ms": 3.0042598264789975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013839006423950195, "StateBufferConnector_ms": 0.008498668670654297, "ViewRequirementAgentConnector_ms": 0.2044539451599121}, "num_episodes": 32, "episode_return_max": -35.606579108997806, "episode_return_min": -1275.093552920181, "episode_return_mean": -723.4499049248084, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.7060342508102, "num_env_steps_trained_throughput_per_sec": 323.7060342508102, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12581.239, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12581.166, "sample_time_ms": 1049.22, "learn_time_ms": 11463.066, "learn_throughput": 348.947, "synch_weights_time_ms": 67.979}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "92003_00011", "date": "2024-08-03_04-10-01", "timestamp": 1722638401, "time_this_iter_s": 12.369109153747559, "time_total_s": 88.15397930145264, "pid": 470944, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c721b40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 88.15397930145264, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 17.91176470588235, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 130.66854166587194, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.100620469699304, "policy_loss": -0.005905590639061605, "vf_loss": 5.105314547071854, "vf_explained_var": 0.9532914631689589, "kl": 0.012733217234017501, "entropy": 1.3351143687963485, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -35.606579108997806, "episode_reward_min": -1275.093552920181, "episode_reward_mean": -677.5360719668462, "episode_len_mean": 135.28, "episode_media": {}, "episodes_timesteps_total": 13528, "policy_reward_min": {"policy_0": -1275.093552920181}, "policy_reward_max": {"policy_0": -35.606579108997806}, "policy_reward_mean": {"policy_0": -677.5360719668462}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1109.6545545115127, -847.5162842391098, -298.9112854218291, -1090.3952178925883, -70.31273721618733, -199.500806371446, -126.318892909585, -967.4788355637913, -887.9314370105143, -1067.7018579296564, -35.606579108997806, -644.9256442915106, -910.6334467513345, -891.0757002018645, -214.26789224011168, -557.8187043000227, -920.0347013849901, -131.1760021473665, -805.9487863762237, -995.0480024670334, -763.6067244336688, -814.0287593285517, -1069.8664208108344, -668.1166674109713, -674.7181288694931, -621.7847421960448, -1021.7479073176346, -231.566049687718, -905.4239602039493, -419.2458007720893, -354.21218305782537, -723.2477067891471, -369.14453827903645, -999.6399167508482, -1275.093552920181, -1157.615443696677, -369.2783878613658, -1041.4915515318169, -509.567745678414, -755.2386217100853, -976.4689941569322, -776.872624987283, -631.6634021472306, -406.48575807845924, -846.840192014787, -177.22791953521207, -769.9332484051838, -969.6867709212637, -807.1487537373372, -844.1584937022235, -1119.7795387862827, -215.85271347307042, -368.2505438526697, -498.2767776672565, -1093.4263535195203, -1138.0091890683225, -1143.0527932579305, -936.5110847494034, -574.0496165580705, -912.9728699454242, -155.1347948873108, -344.3095402938085, -517.3684208296168, -1121.6377211128088, -825.6807818243502, -844.2122295393198, -224.80721961431055, -1038.8650519122814, -98.84467007134717, -929.4112258354054, -575.0257873808864, -1050.7209578188847, -673.4132575120369, -900.0850547900025, -676.6863583211676, -418.67769747341754, -106.88393639349404, -1066.2833204240749, -651.0928619228536, -754.2157739520477, -1056.6206976896688, -908.1378940154335, -187.90985962986977, -136.58193088241484, -886.1860634520971, -710.8950144560779, -459.0529814215771, -1187.0874218756444, -880.1130842543914, -256.4525510153361, -992.6649523044931, -800.7556364622798, -388.6371611138655, -275.36895331130694, -158.03644876588757, -215.23164785803363, -729.9746328887251, -336.9813206466986, -556.6375939853642, -933.3648725401597], "episode_lengths": [150, 150, 150, 150, 56, 116, 62, 150, 150, 150, 56, 150, 150, 150, 70, 132, 150, 86, 148, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 85, 150, 135, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 110, 150, 150, 150, 79, 150, 77, 150, 127, 150, 135, 150, 150, 103, 68, 150, 150, 150, 150, 150, 90, 78, 150, 150, 126, 150, 150, 150, 150, 150, 141, 150, 63, 88, 150, 134, 150, 150], "policy_policy_0_reward": [-1109.6545545115127, -847.5162842391098, -298.9112854218291, -1090.3952178925883, -70.31273721618733, -199.500806371446, -126.318892909585, -967.4788355637913, -887.9314370105143, -1067.7018579296564, -35.606579108997806, -644.9256442915106, -910.6334467513345, -891.0757002018645, -214.26789224011168, -557.8187043000227, -920.0347013849901, -131.1760021473665, -805.9487863762237, -995.0480024670334, -763.6067244336688, -814.0287593285517, -1069.8664208108344, -668.1166674109713, -674.7181288694931, -621.7847421960448, -1021.7479073176346, -231.566049687718, -905.4239602039493, -419.2458007720893, -354.21218305782537, -723.2477067891471, -369.14453827903645, -999.6399167508482, -1275.093552920181, -1157.615443696677, -369.2783878613658, -1041.4915515318169, -509.567745678414, -755.2386217100853, -976.4689941569322, -776.872624987283, -631.6634021472306, -406.48575807845924, -846.840192014787, -177.22791953521207, -769.9332484051838, -969.6867709212637, -807.1487537373372, -844.1584937022235, -1119.7795387862827, -215.85271347307042, -368.2505438526697, -498.2767776672565, -1093.4263535195203, -1138.0091890683225, -1143.0527932579305, -936.5110847494034, -574.0496165580705, -912.9728699454242, -155.1347948873108, -344.3095402938085, -517.3684208296168, -1121.6377211128088, -825.6807818243502, -844.2122295393198, -224.80721961431055, -1038.8650519122814, -98.84467007134717, -929.4112258354054, -575.0257873808864, -1050.7209578188847, -673.4132575120369, -900.0850547900025, -676.6863583211676, -418.67769747341754, -106.88393639349404, -1066.2833204240749, -651.0928619228536, -754.2157739520477, -1056.6206976896688, -908.1378940154335, -187.90985962986977, -136.58193088241484, -886.1860634520971, -710.8950144560779, -459.0529814215771, -1187.0874218756444, -880.1130842543914, -256.4525510153361, -992.6649523044931, -800.7556364622798, -388.6371611138655, -275.36895331130694, -158.03644876588757, -215.23164785803363, -729.9746328887251, -336.9813206466986, -556.6375939853642, -933.3648725401597]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5657761967414351, "mean_inference_ms": 1.6861939515141031, "mean_action_processing_ms": 0.2856146729909922, "mean_env_wait_ms": 3.0053143223775014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013182878494262695, "StateBufferConnector_ms": 0.008266925811767578, "ViewRequirementAgentConnector_ms": 0.2011120319366455}, "num_episodes": 27, "episode_return_max": -35.606579108997806, "episode_return_min": -1275.093552920181, "episode_return_mean": -677.5360719668462, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 333.01745680162975, "num_env_steps_trained_throughput_per_sec": 333.01745680162975, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12510.011, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12509.934, "sample_time_ms": 1049.948, "learn_time_ms": 11392.194, "learn_throughput": 351.118, "synch_weights_time_ms": 66.911}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "92003_00011", "date": "2024-08-03_04-10-13", "timestamp": 1722638413, "time_this_iter_s": 12.024404287338257, "time_total_s": 100.1783835887909, "pid": 470944, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c722ef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 100.1783835887909, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 18.288235294117648, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 134.86958816448848, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.453396310905616, "policy_loss": -0.009808697408395043, "vf_loss": 4.461485738555591, "vf_explained_var": 0.9601390938585003, "kl": 0.014754557297298259, "entropy": 1.2316340214262407, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -98.84467007134717, "episode_reward_min": -1332.5757299715135, "episode_reward_mean": -669.1164952623516, "episode_len_mean": 138.29, "episode_media": {}, "episodes_timesteps_total": 13829, "policy_reward_min": {"policy_0": -1332.5757299715135}, "policy_reward_max": {"policy_0": -98.84467007134717}, "policy_reward_mean": {"policy_0": -669.1164952623516}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-419.2458007720893, -354.21218305782537, -723.2477067891471, -369.14453827903645, -999.6399167508482, -1275.093552920181, -1157.615443696677, -369.2783878613658, -1041.4915515318169, -509.567745678414, -755.2386217100853, -976.4689941569322, -776.872624987283, -631.6634021472306, -406.48575807845924, -846.840192014787, -177.22791953521207, -769.9332484051838, -969.6867709212637, -807.1487537373372, -844.1584937022235, -1119.7795387862827, -215.85271347307042, -368.2505438526697, -498.2767776672565, -1093.4263535195203, -1138.0091890683225, -1143.0527932579305, -936.5110847494034, -574.0496165580705, -912.9728699454242, -155.1347948873108, -344.3095402938085, -517.3684208296168, -1121.6377211128088, -825.6807818243502, -844.2122295393198, -224.80721961431055, -1038.8650519122814, -98.84467007134717, -929.4112258354054, -575.0257873808864, -1050.7209578188847, -673.4132575120369, -900.0850547900025, -676.6863583211676, -418.67769747341754, -106.88393639349404, -1066.2833204240749, -651.0928619228536, -754.2157739520477, -1056.6206976896688, -908.1378940154335, -187.90985962986977, -136.58193088241484, -886.1860634520971, -710.8950144560779, -459.0529814215771, -1187.0874218756444, -880.1130842543914, -256.4525510153361, -992.6649523044931, -800.7556364622798, -388.6371611138655, -275.36895331130694, -158.03644876588757, -215.23164785803363, -729.9746328887251, -336.9813206466986, -556.6375939853642, -933.3648725401597, -1076.1434893990015, -291.7705208439486, -421.64670422830113, -838.837031250497, -646.8673265923386, -738.7972904459849, -950.9862929927436, -322.96888361041215, -548.5761316195271, -580.3903764682132, -648.4107529403203, -750.0940657097364, -392.93911839207595, -1082.1220689688637, -402.8964698165091, -671.9040526533265, -271.18394513897715, -443.8156445966784, -889.3948787133176, -736.0014085214193, -475.4592088947465, -865.8456421709828, -272.7049649013814, -451.9414033049214, -1332.5757299715135, -262.36678958009816, -790.3612407619086, -369.58413815040234, -1174.5734875068965], "episode_lengths": [150, 85, 150, 135, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 110, 150, 150, 150, 79, 150, 77, 150, 127, 150, 135, 150, 150, 103, 68, 150, 150, 150, 150, 150, 90, 78, 150, 150, 126, 150, 150, 150, 150, 150, 141, 150, 63, 88, 150, 134, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 96, 144, 150, 150, 150, 150, 119, 121, 150, 91, 150, 150, 150], "policy_policy_0_reward": [-419.2458007720893, -354.21218305782537, -723.2477067891471, -369.14453827903645, -999.6399167508482, -1275.093552920181, -1157.615443696677, -369.2783878613658, -1041.4915515318169, -509.567745678414, -755.2386217100853, -976.4689941569322, -776.872624987283, -631.6634021472306, -406.48575807845924, -846.840192014787, -177.22791953521207, -769.9332484051838, -969.6867709212637, -807.1487537373372, -844.1584937022235, -1119.7795387862827, -215.85271347307042, -368.2505438526697, -498.2767776672565, -1093.4263535195203, -1138.0091890683225, -1143.0527932579305, -936.5110847494034, -574.0496165580705, -912.9728699454242, -155.1347948873108, -344.3095402938085, -517.3684208296168, -1121.6377211128088, -825.6807818243502, -844.2122295393198, -224.80721961431055, -1038.8650519122814, -98.84467007134717, -929.4112258354054, -575.0257873808864, -1050.7209578188847, -673.4132575120369, -900.0850547900025, -676.6863583211676, -418.67769747341754, -106.88393639349404, -1066.2833204240749, -651.0928619228536, -754.2157739520477, -1056.6206976896688, -908.1378940154335, -187.90985962986977, -136.58193088241484, -886.1860634520971, -710.8950144560779, -459.0529814215771, -1187.0874218756444, -880.1130842543914, -256.4525510153361, -992.6649523044931, -800.7556364622798, -388.6371611138655, -275.36895331130694, -158.03644876588757, -215.23164785803363, -729.9746328887251, -336.9813206466986, -556.6375939853642, -933.3648725401597, -1076.1434893990015, -291.7705208439486, -421.64670422830113, -838.837031250497, -646.8673265923386, -738.7972904459849, -950.9862929927436, -322.96888361041215, -548.5761316195271, -580.3903764682132, -648.4107529403203, -750.0940657097364, -392.93911839207595, -1082.1220689688637, -402.8964698165091, -671.9040526533265, -271.18394513897715, -443.8156445966784, -889.3948787133176, -736.0014085214193, -475.4592088947465, -865.8456421709828, -272.7049649013814, -451.9414033049214, -1332.5757299715135, -262.36678958009816, -790.3612407619086, -369.58413815040234, -1174.5734875068965]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5642738004357821, "mean_inference_ms": 1.6860998467379458, "mean_action_processing_ms": 0.28433966995530374, "mean_env_wait_ms": 3.0049976922380512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013267755508422852, "StateBufferConnector_ms": 0.008620262145996094, "ViewRequirementAgentConnector_ms": 0.20257878303527832}, "num_episodes": 29, "episode_return_max": -98.84467007134717, "episode_return_min": -1332.5757299715135, "episode_return_mean": -669.1164952623516, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.6544880277056, "num_env_steps_trained_throughput_per_sec": 301.6544880277056, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12593.367, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12593.292, "sample_time_ms": 1049.443, "learn_time_ms": 11476.502, "learn_throughput": 348.538, "synch_weights_time_ms": 66.446}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "92003_00011", "date": "2024-08-03_04-10-26", "timestamp": 1722638426, "time_this_iter_s": 13.273902893066406, "time_total_s": 113.4522864818573, "pid": 470944, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c7223b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 113.4522864818573, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 17.421052631578945, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 135.86636978983879, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.702314045031866, "policy_loss": -0.008771142716674755, "vf_loss": 4.709085801740487, "vf_explained_var": 0.9703265824665626, "kl": 0.015854883968828906, "entropy": 1.171600114243726, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -98.84467007134717, "episode_reward_min": -1332.5757299715135, "episode_reward_mean": -657.588502175435, "episode_len_mean": 138.33, "episode_media": {}, "episodes_timesteps_total": 13833, "policy_reward_min": {"policy_0": -1332.5757299715135}, "policy_reward_max": {"policy_0": -98.84467007134717}, "policy_reward_mean": {"policy_0": -657.588502175435}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1143.0527932579305, -936.5110847494034, -574.0496165580705, -912.9728699454242, -155.1347948873108, -344.3095402938085, -517.3684208296168, -1121.6377211128088, -825.6807818243502, -844.2122295393198, -224.80721961431055, -1038.8650519122814, -98.84467007134717, -929.4112258354054, -575.0257873808864, -1050.7209578188847, -673.4132575120369, -900.0850547900025, -676.6863583211676, -418.67769747341754, -106.88393639349404, -1066.2833204240749, -651.0928619228536, -754.2157739520477, -1056.6206976896688, -908.1378940154335, -187.90985962986977, -136.58193088241484, -886.1860634520971, -710.8950144560779, -459.0529814215771, -1187.0874218756444, -880.1130842543914, -256.4525510153361, -992.6649523044931, -800.7556364622798, -388.6371611138655, -275.36895331130694, -158.03644876588757, -215.23164785803363, -729.9746328887251, -336.9813206466986, -556.6375939853642, -933.3648725401597, -1076.1434893990015, -291.7705208439486, -421.64670422830113, -838.837031250497, -646.8673265923386, -738.7972904459849, -950.9862929927436, -322.96888361041215, -548.5761316195271, -580.3903764682132, -648.4107529403203, -750.0940657097364, -392.93911839207595, -1082.1220689688637, -402.8964698165091, -671.9040526533265, -271.18394513897715, -443.8156445966784, -889.3948787133176, -736.0014085214193, -475.4592088947465, -865.8456421709828, -272.7049649013814, -451.9414033049214, -1332.5757299715135, -262.36678958009816, -790.3612407619086, -369.58413815040234, -1174.5734875068965, -547.1768017128556, -672.7692950139028, -455.5967475225602, -333.8590105116769, -701.6872817115723, -801.2122455039133, -639.0234168923673, -939.1289370272486, -288.79192394892567, -1262.0047257472072, -914.8097469433053, -536.0806791887059, -612.9304503834613, -253.81706265841336, -1230.2102156671504, -841.3311105717044, -737.0087740853061, -1002.3733728102347, -940.7496414165805, -843.3235443121306, -902.1527720300967, -374.969857328578, -444.64283129862383, -157.9849319248135, -556.2586525090168, -463.7717083986631, -1007.3916772898657], "episode_lengths": [150, 150, 150, 150, 89, 150, 110, 150, 150, 150, 79, 150, 77, 150, 127, 150, 135, 150, 150, 103, 68, 150, 150, 150, 150, 150, 90, 78, 150, 150, 126, 150, 150, 150, 150, 150, 141, 150, 63, 88, 150, 134, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 96, 144, 150, 150, 150, 150, 119, 121, 150, 91, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 150, 100, 150, 150, 120, 150, 132, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150], "policy_policy_0_reward": [-1143.0527932579305, -936.5110847494034, -574.0496165580705, -912.9728699454242, -155.1347948873108, -344.3095402938085, -517.3684208296168, -1121.6377211128088, -825.6807818243502, -844.2122295393198, -224.80721961431055, -1038.8650519122814, -98.84467007134717, -929.4112258354054, -575.0257873808864, -1050.7209578188847, -673.4132575120369, -900.0850547900025, -676.6863583211676, -418.67769747341754, -106.88393639349404, -1066.2833204240749, -651.0928619228536, -754.2157739520477, -1056.6206976896688, -908.1378940154335, -187.90985962986977, -136.58193088241484, -886.1860634520971, -710.8950144560779, -459.0529814215771, -1187.0874218756444, -880.1130842543914, -256.4525510153361, -992.6649523044931, -800.7556364622798, -388.6371611138655, -275.36895331130694, -158.03644876588757, -215.23164785803363, -729.9746328887251, -336.9813206466986, -556.6375939853642, -933.3648725401597, -1076.1434893990015, -291.7705208439486, -421.64670422830113, -838.837031250497, -646.8673265923386, -738.7972904459849, -950.9862929927436, -322.96888361041215, -548.5761316195271, -580.3903764682132, -648.4107529403203, -750.0940657097364, -392.93911839207595, -1082.1220689688637, -402.8964698165091, -671.9040526533265, -271.18394513897715, -443.8156445966784, -889.3948787133176, -736.0014085214193, -475.4592088947465, -865.8456421709828, -272.7049649013814, -451.9414033049214, -1332.5757299715135, -262.36678958009816, -790.3612407619086, -369.58413815040234, -1174.5734875068965, -547.1768017128556, -672.7692950139028, -455.5967475225602, -333.8590105116769, -701.6872817115723, -801.2122455039133, -639.0234168923673, -939.1289370272486, -288.79192394892567, -1262.0047257472072, -914.8097469433053, -536.0806791887059, -612.9304503834613, -253.81706265841336, -1230.2102156671504, -841.3311105717044, -737.0087740853061, -1002.3733728102347, -940.7496414165805, -843.3235443121306, -902.1527720300967, -374.969857328578, -444.64283129862383, -157.9849319248135, -556.2586525090168, -463.7717083986631, -1007.3916772898657]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5633949231822896, "mean_inference_ms": 1.687939036709237, "mean_action_processing_ms": 0.2839924729115028, "mean_env_wait_ms": 3.0090973336835525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01301121711730957, "StateBufferConnector_ms": 0.008648157119750977, "ViewRequirementAgentConnector_ms": 0.20360517501831055}, "num_episodes": 27, "episode_return_max": -98.84467007134717, "episode_return_min": -1332.5757299715135, "episode_return_mean": -657.588502175435, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.19037209746216, "num_env_steps_trained_throughput_per_sec": 303.19037209746216, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12653.334, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12653.26, "sample_time_ms": 1048.188, "learn_time_ms": 11539.94, "learn_throughput": 346.622, "synch_weights_time_ms": 64.249}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "92003_00011", "date": "2024-08-03_04-10-40", "timestamp": 1722638440, "time_this_iter_s": 13.205932140350342, "time_total_s": 126.65821862220764, "pid": 470944, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c721b40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 126.65821862220764, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 17.184210526315788, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 182.2679107964039, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.2418126558264095, "policy_loss": -0.011463135858260405, "vf_loss": 4.25154746795694, "vf_explained_var": 0.9592400612309575, "kl": 0.015383254024224394, "entropy": 1.3483259989569585, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -79.81220915093331, "episode_reward_min": -1332.5757299715135, "episode_reward_mean": -655.123017110177, "episode_len_mean": 141.12, "episode_media": {}, "episodes_timesteps_total": 14112, "policy_reward_min": {"policy_0": -1332.5757299715135}, "policy_reward_max": {"policy_0": -79.81220915093331}, "policy_reward_mean": {"policy_0": -655.123017110177}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-880.1130842543914, -256.4525510153361, -992.6649523044931, -800.7556364622798, -388.6371611138655, -275.36895331130694, -158.03644876588757, -215.23164785803363, -729.9746328887251, -336.9813206466986, -556.6375939853642, -933.3648725401597, -1076.1434893990015, -291.7705208439486, -421.64670422830113, -838.837031250497, -646.8673265923386, -738.7972904459849, -950.9862929927436, -322.96888361041215, -548.5761316195271, -580.3903764682132, -648.4107529403203, -750.0940657097364, -392.93911839207595, -1082.1220689688637, -402.8964698165091, -671.9040526533265, -271.18394513897715, -443.8156445966784, -889.3948787133176, -736.0014085214193, -475.4592088947465, -865.8456421709828, -272.7049649013814, -451.9414033049214, -1332.5757299715135, -262.36678958009816, -790.3612407619086, -369.58413815040234, -1174.5734875068965, -547.1768017128556, -672.7692950139028, -455.5967475225602, -333.8590105116769, -701.6872817115723, -801.2122455039133, -639.0234168923673, -939.1289370272486, -288.79192394892567, -1262.0047257472072, -914.8097469433053, -536.0806791887059, -612.9304503834613, -253.81706265841336, -1230.2102156671504, -841.3311105717044, -737.0087740853061, -1002.3733728102347, -940.7496414165805, -843.3235443121306, -902.1527720300967, -374.969857328578, -444.64283129862383, -157.9849319248135, -556.2586525090168, -463.7717083986631, -1007.3916772898657, -823.982989701253, -705.350365951606, -534.3266338983271, -430.02841495090337, -999.4730875741076, -721.6198061512017, -1275.2410978426735, -823.2314237992841, -758.6083419711531, -399.37053289996146, -79.81220915093331, -260.93148055587375, -992.3830124154177, -247.24029024548116, -902.546831310752, -1250.0497209475814, -973.0665017927591, -926.5254313184337, -900.0819145882283, -259.6172830275119, -500.37845598548734, -1089.4885458762037, -1140.181253943959, -766.2180773458426, -777.4567806847404, -857.3917484112321, -595.4124348878321, -107.28628893342876, -810.7340978976596, -555.953460202385, -132.35990428070863, -229.51796477430563], "episode_lengths": [150, 150, 150, 150, 141, 150, 63, 88, 150, 134, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 96, 144, 150, 150, 150, 150, 119, 121, 150, 91, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 150, 100, 150, 150, 120, 150, 132, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 63, 150, 150, 93, 86], "policy_policy_0_reward": [-880.1130842543914, -256.4525510153361, -992.6649523044931, -800.7556364622798, -388.6371611138655, -275.36895331130694, -158.03644876588757, -215.23164785803363, -729.9746328887251, -336.9813206466986, -556.6375939853642, -933.3648725401597, -1076.1434893990015, -291.7705208439486, -421.64670422830113, -838.837031250497, -646.8673265923386, -738.7972904459849, -950.9862929927436, -322.96888361041215, -548.5761316195271, -580.3903764682132, -648.4107529403203, -750.0940657097364, -392.93911839207595, -1082.1220689688637, -402.8964698165091, -671.9040526533265, -271.18394513897715, -443.8156445966784, -889.3948787133176, -736.0014085214193, -475.4592088947465, -865.8456421709828, -272.7049649013814, -451.9414033049214, -1332.5757299715135, -262.36678958009816, -790.3612407619086, -369.58413815040234, -1174.5734875068965, -547.1768017128556, -672.7692950139028, -455.5967475225602, -333.8590105116769, -701.6872817115723, -801.2122455039133, -639.0234168923673, -939.1289370272486, -288.79192394892567, -1262.0047257472072, -914.8097469433053, -536.0806791887059, -612.9304503834613, -253.81706265841336, -1230.2102156671504, -841.3311105717044, -737.0087740853061, -1002.3733728102347, -940.7496414165805, -843.3235443121306, -902.1527720300967, -374.969857328578, -444.64283129862383, -157.9849319248135, -556.2586525090168, -463.7717083986631, -1007.3916772898657, -823.982989701253, -705.350365951606, -534.3266338983271, -430.02841495090337, -999.4730875741076, -721.6198061512017, -1275.2410978426735, -823.2314237992841, -758.6083419711531, -399.37053289996146, -79.81220915093331, -260.93148055587375, -992.3830124154177, -247.24029024548116, -902.546831310752, -1250.0497209475814, -973.0665017927591, -926.5254313184337, -900.0819145882283, -259.6172830275119, -500.37845598548734, -1089.4885458762037, -1140.181253943959, -766.2180773458426, -777.4567806847404, -857.3917484112321, -595.4124348878321, -107.28628893342876, -810.7340978976596, -555.953460202385, -132.35990428070863, -229.51796477430563]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5620939503031392, "mean_inference_ms": 1.6879134350552505, "mean_action_processing_ms": 0.28360235278234475, "mean_env_wait_ms": 3.008764739486829, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012786865234375, "StateBufferConnector_ms": 0.008574724197387695, "ViewRequirementAgentConnector_ms": 0.19380688667297363}, "num_episodes": 32, "episode_return_max": -79.81220915093331, "episode_return_min": -1332.5757299715135, "episode_return_mean": -655.123017110177, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.8681650829605, "num_env_steps_trained_throughput_per_sec": 306.8681650829605, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12655.636, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12655.561, "sample_time_ms": 1048.303, "learn_time_ms": 11539.744, "learn_throughput": 346.628, "synch_weights_time_ms": 66.613}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "92003_00011", "date": "2024-08-03_04-10-53", "timestamp": 1722638453, "time_this_iter_s": 13.047818899154663, "time_total_s": 139.7060375213623, "pid": 470944, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c78feb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 139.7060375213623, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 17.3, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 203.10199483633042, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.2206335837642355, "policy_loss": -0.015929691379036135, "vf_loss": 4.233919498572747, "vf_explained_var": 0.9635302895059188, "kl": 0.01995235830160406, "entropy": 1.3466938017557064, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -21.574735372984048, "episode_reward_min": -1337.4486820461925, "episode_reward_mean": -695.8306139212789, "episode_len_mean": 140.73, "episode_media": {}, "episodes_timesteps_total": 14073, "policy_reward_min": {"policy_0": -1337.4486820461925}, "policy_reward_max": {"policy_0": -21.574735372984048}, "policy_reward_mean": {"policy_0": -695.8306139212789}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-443.8156445966784, -889.3948787133176, -736.0014085214193, -475.4592088947465, -865.8456421709828, -272.7049649013814, -451.9414033049214, -1332.5757299715135, -262.36678958009816, -790.3612407619086, -369.58413815040234, -1174.5734875068965, -547.1768017128556, -672.7692950139028, -455.5967475225602, -333.8590105116769, -701.6872817115723, -801.2122455039133, -639.0234168923673, -939.1289370272486, -288.79192394892567, -1262.0047257472072, -914.8097469433053, -536.0806791887059, -612.9304503834613, -253.81706265841336, -1230.2102156671504, -841.3311105717044, -737.0087740853061, -1002.3733728102347, -940.7496414165805, -843.3235443121306, -902.1527720300967, -374.969857328578, -444.64283129862383, -157.9849319248135, -556.2586525090168, -463.7717083986631, -1007.3916772898657, -823.982989701253, -705.350365951606, -534.3266338983271, -430.02841495090337, -999.4730875741076, -721.6198061512017, -1275.2410978426735, -823.2314237992841, -758.6083419711531, -399.37053289996146, -79.81220915093331, -260.93148055587375, -992.3830124154177, -247.24029024548116, -902.546831310752, -1250.0497209475814, -973.0665017927591, -926.5254313184337, -900.0819145882283, -259.6172830275119, -500.37845598548734, -1089.4885458762037, -1140.181253943959, -766.2180773458426, -777.4567806847404, -857.3917484112321, -595.4124348878321, -107.28628893342876, -810.7340978976596, -555.953460202385, -132.35990428070863, -229.51796477430563, -864.4366879527443, -873.4903603273282, -455.4065103842843, -950.2713875634009, -1032.9618185800966, -814.9642443912572, -670.7080552521194, -1056.2151708191439, -766.3436373819768, -520.055384762771, -820.5265580663281, -775.7406947843244, -1337.4486820461925, -878.2176488435597, -44.2154908670418, -893.5623789239296, -21.574735372984048, -367.80189754748164, -935.3168535984861, -922.0000937806179, -860.7592031364451, -720.328068044449, -511.6337521487851, -1067.4776914153606, -787.8696162426817, -766.6488529279258, -491.7973833554437, -194.72029412177827, -829.0199046885677], "episode_lengths": [144, 150, 150, 150, 150, 119, 121, 150, 91, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 150, 100, 150, 150, 120, 150, 132, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 63, 150, 150, 93, 86, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 55, 150, 53, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72, 150], "policy_policy_0_reward": [-443.8156445966784, -889.3948787133176, -736.0014085214193, -475.4592088947465, -865.8456421709828, -272.7049649013814, -451.9414033049214, -1332.5757299715135, -262.36678958009816, -790.3612407619086, -369.58413815040234, -1174.5734875068965, -547.1768017128556, -672.7692950139028, -455.5967475225602, -333.8590105116769, -701.6872817115723, -801.2122455039133, -639.0234168923673, -939.1289370272486, -288.79192394892567, -1262.0047257472072, -914.8097469433053, -536.0806791887059, -612.9304503834613, -253.81706265841336, -1230.2102156671504, -841.3311105717044, -737.0087740853061, -1002.3733728102347, -940.7496414165805, -843.3235443121306, -902.1527720300967, -374.969857328578, -444.64283129862383, -157.9849319248135, -556.2586525090168, -463.7717083986631, -1007.3916772898657, -823.982989701253, -705.350365951606, -534.3266338983271, -430.02841495090337, -999.4730875741076, -721.6198061512017, -1275.2410978426735, -823.2314237992841, -758.6083419711531, -399.37053289996146, -79.81220915093331, -260.93148055587375, -992.3830124154177, -247.24029024548116, -902.546831310752, -1250.0497209475814, -973.0665017927591, -926.5254313184337, -900.0819145882283, -259.6172830275119, -500.37845598548734, -1089.4885458762037, -1140.181253943959, -766.2180773458426, -777.4567806847404, -857.3917484112321, -595.4124348878321, -107.28628893342876, -810.7340978976596, -555.953460202385, -132.35990428070863, -229.51796477430563, -864.4366879527443, -873.4903603273282, -455.4065103842843, -950.2713875634009, -1032.9618185800966, -814.9642443912572, -670.7080552521194, -1056.2151708191439, -766.3436373819768, -520.055384762771, -820.5265580663281, -775.7406947843244, -1337.4486820461925, -878.2176488435597, -44.2154908670418, -893.5623789239296, -21.574735372984048, -367.80189754748164, -935.3168535984861, -922.0000937806179, -860.7592031364451, -720.328068044449, -511.6337521487851, -1067.4776914153606, -787.8696162426817, -766.6488529279258, -491.7973833554437, -194.72029412177827, -829.0199046885677]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5613363872795915, "mean_inference_ms": 1.6872161311698872, "mean_action_processing_ms": 0.2831629835734919, "mean_env_wait_ms": 3.0068041623128567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01278376579284668, "StateBufferConnector_ms": 0.008632898330688477, "ViewRequirementAgentConnector_ms": 0.19602465629577637}, "num_episodes": 29, "episode_return_max": -21.574735372984048, "episode_return_min": -1337.4486820461925, "episode_return_mean": -695.8306139212789, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.1665714758952, "num_env_steps_trained_throughput_per_sec": 301.1665714758952, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12714.898, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12714.822, "sample_time_ms": 1045.86, "learn_time_ms": 11602.982, "learn_throughput": 344.739, "synch_weights_time_ms": 65.087}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "92003_00011", "date": "2024-08-03_04-11-06", "timestamp": 1722638466, "time_this_iter_s": 13.294021606445312, "time_total_s": 153.00005912780762, "pid": 470944, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c78fd90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 153.00005912780762, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 17.10526315789474, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 188.27424516677857, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.7368256205072004, "policy_loss": -0.014865910850736934, "vf_loss": 3.749674413104852, "vf_explained_var": 0.9730796825140715, "kl": 0.01734975769583495, "entropy": 1.452827345704039, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -21.574735372984048, "episode_reward_min": -1337.4486820461925, "episode_reward_mean": -700.9773163438076, "episode_len_mean": 140.1, "episode_media": {}, "episodes_timesteps_total": 14010, "policy_reward_min": {"policy_0": -1337.4486820461925}, "policy_reward_max": {"policy_0": -21.574735372984048}, "policy_reward_mean": {"policy_0": -700.9773163438076}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-253.81706265841336, -1230.2102156671504, -841.3311105717044, -737.0087740853061, -1002.3733728102347, -940.7496414165805, -843.3235443121306, -902.1527720300967, -374.969857328578, -444.64283129862383, -157.9849319248135, -556.2586525090168, -463.7717083986631, -1007.3916772898657, -823.982989701253, -705.350365951606, -534.3266338983271, -430.02841495090337, -999.4730875741076, -721.6198061512017, -1275.2410978426735, -823.2314237992841, -758.6083419711531, -399.37053289996146, -79.81220915093331, -260.93148055587375, -992.3830124154177, -247.24029024548116, -902.546831310752, -1250.0497209475814, -973.0665017927591, -926.5254313184337, -900.0819145882283, -259.6172830275119, -500.37845598548734, -1089.4885458762037, -1140.181253943959, -766.2180773458426, -777.4567806847404, -857.3917484112321, -595.4124348878321, -107.28628893342876, -810.7340978976596, -555.953460202385, -132.35990428070863, -229.51796477430563, -864.4366879527443, -873.4903603273282, -455.4065103842843, -950.2713875634009, -1032.9618185800966, -814.9642443912572, -670.7080552521194, -1056.2151708191439, -766.3436373819768, -520.055384762771, -820.5265580663281, -775.7406947843244, -1337.4486820461925, -878.2176488435597, -44.2154908670418, -893.5623789239296, -21.574735372984048, -367.80189754748164, -935.3168535984861, -922.0000937806179, -860.7592031364451, -720.328068044449, -511.6337521487851, -1067.4776914153606, -787.8696162426817, -766.6488529279258, -491.7973833554437, -194.72029412177827, -829.0199046885677, -445.59688324593134, -50.5780182924163, -238.47741491123338, -892.6140597503935, -841.5809829743129, -939.8118275439411, -32.30738471508824, -1081.379450985679, -305.8026373997488, -337.62023374073004, -584.5275095029156, -949.7104456760787, -912.214099204251, -1025.7245063989562, -745.544348034212, -1080.864244005208, -791.179334745941, -625.0941089486164, -426.67201705679963, -1009.0629169423134, -691.4707326138887, -712.8722380762858, -878.2277847494731, -827.0646225658107, -858.3682393546163], "episode_lengths": [132, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 63, 150, 150, 93, 86, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 55, 150, 53, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72, 150, 150, 44, 110, 150, 150, 150, 57, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 143, 150], "policy_policy_0_reward": [-253.81706265841336, -1230.2102156671504, -841.3311105717044, -737.0087740853061, -1002.3733728102347, -940.7496414165805, -843.3235443121306, -902.1527720300967, -374.969857328578, -444.64283129862383, -157.9849319248135, -556.2586525090168, -463.7717083986631, -1007.3916772898657, -823.982989701253, -705.350365951606, -534.3266338983271, -430.02841495090337, -999.4730875741076, -721.6198061512017, -1275.2410978426735, -823.2314237992841, -758.6083419711531, -399.37053289996146, -79.81220915093331, -260.93148055587375, -992.3830124154177, -247.24029024548116, -902.546831310752, -1250.0497209475814, -973.0665017927591, -926.5254313184337, -900.0819145882283, -259.6172830275119, -500.37845598548734, -1089.4885458762037, -1140.181253943959, -766.2180773458426, -777.4567806847404, -857.3917484112321, -595.4124348878321, -107.28628893342876, -810.7340978976596, -555.953460202385, -132.35990428070863, -229.51796477430563, -864.4366879527443, -873.4903603273282, -455.4065103842843, -950.2713875634009, -1032.9618185800966, -814.9642443912572, -670.7080552521194, -1056.2151708191439, -766.3436373819768, -520.055384762771, -820.5265580663281, -775.7406947843244, -1337.4486820461925, -878.2176488435597, -44.2154908670418, -893.5623789239296, -21.574735372984048, -367.80189754748164, -935.3168535984861, -922.0000937806179, -860.7592031364451, -720.328068044449, -511.6337521487851, -1067.4776914153606, -787.8696162426817, -766.6488529279258, -491.7973833554437, -194.72029412177827, -829.0199046885677, -445.59688324593134, -50.5780182924163, -238.47741491123338, -892.6140597503935, -841.5809829743129, -939.8118275439411, -32.30738471508824, -1081.379450985679, -305.8026373997488, -337.62023374073004, -584.5275095029156, -949.7104456760787, -912.214099204251, -1025.7245063989562, -745.544348034212, -1080.864244005208, -791.179334745941, -625.0941089486164, -426.67201705679963, -1009.0629169423134, -691.4707326138887, -712.8722380762858, -878.2277847494731, -827.0646225658107, -858.3682393546163]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.560350021230165, "mean_inference_ms": 1.6857087548093475, "mean_action_processing_ms": 0.2825649645627534, "mean_env_wait_ms": 3.0048951775375574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012023210525512695, "StateBufferConnector_ms": 0.008115291595458984, "ViewRequirementAgentConnector_ms": 0.1941087245941162}, "num_episodes": 25, "episode_return_max": -21.574735372984048, "episode_return_min": -1337.4486820461925, "episode_return_mean": -700.9773163438076, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.6068859000397, "num_env_steps_trained_throughput_per_sec": 300.6068859000397, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 13017.824, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13017.748, "sample_time_ms": 1045.8, "learn_time_ms": 11905.911, "learn_throughput": 335.968, "synch_weights_time_ms": 65.145}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "92003_00011", "date": "2024-08-03_04-11-19", "timestamp": 1722638479, "time_this_iter_s": 13.318974494934082, "time_total_s": 166.3190336227417, "pid": 470944, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c78ff40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 166.3190336227417, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 17.163157894736845, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 199.58585589726766, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.206065355489652, "policy_loss": -0.009408154717918175, "vf_loss": 4.213581981013219, "vf_explained_var": 0.9726345972468455, "kl": 0.016890976587433215, "entropy": 1.486682765185833, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -21.574735372984048, "episode_reward_min": -1383.5572695081219, "episode_reward_mean": -732.2054162908488, "episode_len_mean": 139.86, "episode_media": {}, "episodes_timesteps_total": 13986, "policy_reward_min": {"policy_0": -1383.5572695081219}, "policy_reward_max": {"policy_0": -21.574735372984048}, "policy_reward_mean": {"policy_0": -732.2054162908488}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-992.3830124154177, -247.24029024548116, -902.546831310752, -1250.0497209475814, -973.0665017927591, -926.5254313184337, -900.0819145882283, -259.6172830275119, -500.37845598548734, -1089.4885458762037, -1140.181253943959, -766.2180773458426, -777.4567806847404, -857.3917484112321, -595.4124348878321, -107.28628893342876, -810.7340978976596, -555.953460202385, -132.35990428070863, -229.51796477430563, -864.4366879527443, -873.4903603273282, -455.4065103842843, -950.2713875634009, -1032.9618185800966, -814.9642443912572, -670.7080552521194, -1056.2151708191439, -766.3436373819768, -520.055384762771, -820.5265580663281, -775.7406947843244, -1337.4486820461925, -878.2176488435597, -44.2154908670418, -893.5623789239296, -21.574735372984048, -367.80189754748164, -935.3168535984861, -922.0000937806179, -860.7592031364451, -720.328068044449, -511.6337521487851, -1067.4776914153606, -787.8696162426817, -766.6488529279258, -491.7973833554437, -194.72029412177827, -829.0199046885677, -445.59688324593134, -50.5780182924163, -238.47741491123338, -892.6140597503935, -841.5809829743129, -939.8118275439411, -32.30738471508824, -1081.379450985679, -305.8026373997488, -337.62023374073004, -584.5275095029156, -949.7104456760787, -912.214099204251, -1025.7245063989562, -745.544348034212, -1080.864244005208, -791.179334745941, -625.0941089486164, -426.67201705679963, -1009.0629169423134, -691.4707326138887, -712.8722380762858, -878.2277847494731, -827.0646225658107, -858.3682393546163, -1147.0554732033168, -833.6895111785548, -957.6773215753495, -1383.5572695081219, -1148.7352118060728, -111.39610504142499, -690.9204855950218, -486.82567310347827, -1337.7935134678942, -800.8019309113878, -751.4646493568691, -802.0877665498798, -964.2972872887506, -799.643340399469, -944.3338708737947, -433.24086359035743, -839.8485440176893, -461.93505590719246, -490.04506321724034, -696.9746273589737, -28.151786756546315, -1211.0401013638557, -499.4314641981965, -875.1365208064142, -893.8419094065723, -1100.847184970169], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 63, 150, 150, 93, 86, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 55, 150, 53, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72, 150, 150, 44, 110, 150, 150, 150, 57, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 143, 150, 150, 150, 150, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 150, 50, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-992.3830124154177, -247.24029024548116, -902.546831310752, -1250.0497209475814, -973.0665017927591, -926.5254313184337, -900.0819145882283, -259.6172830275119, -500.37845598548734, -1089.4885458762037, -1140.181253943959, -766.2180773458426, -777.4567806847404, -857.3917484112321, -595.4124348878321, -107.28628893342876, -810.7340978976596, -555.953460202385, -132.35990428070863, -229.51796477430563, -864.4366879527443, -873.4903603273282, -455.4065103842843, -950.2713875634009, -1032.9618185800966, -814.9642443912572, -670.7080552521194, -1056.2151708191439, -766.3436373819768, -520.055384762771, -820.5265580663281, -775.7406947843244, -1337.4486820461925, -878.2176488435597, -44.2154908670418, -893.5623789239296, -21.574735372984048, -367.80189754748164, -935.3168535984861, -922.0000937806179, -860.7592031364451, -720.328068044449, -511.6337521487851, -1067.4776914153606, -787.8696162426817, -766.6488529279258, -491.7973833554437, -194.72029412177827, -829.0199046885677, -445.59688324593134, -50.5780182924163, -238.47741491123338, -892.6140597503935, -841.5809829743129, -939.8118275439411, -32.30738471508824, -1081.379450985679, -305.8026373997488, -337.62023374073004, -584.5275095029156, -949.7104456760787, -912.214099204251, -1025.7245063989562, -745.544348034212, -1080.864244005208, -791.179334745941, -625.0941089486164, -426.67201705679963, -1009.0629169423134, -691.4707326138887, -712.8722380762858, -878.2277847494731, -827.0646225658107, -858.3682393546163, -1147.0554732033168, -833.6895111785548, -957.6773215753495, -1383.5572695081219, -1148.7352118060728, -111.39610504142499, -690.9204855950218, -486.82567310347827, -1337.7935134678942, -800.8019309113878, -751.4646493568691, -802.0877665498798, -964.2972872887506, -799.643340399469, -944.3338708737947, -433.24086359035743, -839.8485440176893, -461.93505590719246, -490.04506321724034, -696.9746273589737, -28.151786756546315, -1211.0401013638557, -499.4314641981965, -875.1365208064142, -893.8419094065723, -1100.847184970169]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5604000645482178, "mean_inference_ms": 1.6855477689347134, "mean_action_processing_ms": 0.2822616268265372, "mean_env_wait_ms": 3.005682869780555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011888265609741211, "StateBufferConnector_ms": 0.008034944534301758, "ViewRequirementAgentConnector_ms": 0.19819021224975586}, "num_episodes": 26, "episode_return_max": -21.574735372984048, "episode_return_min": -1383.5572695081219, "episode_return_mean": -732.2054162908488, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.0590315380263, "num_env_steps_trained_throughput_per_sec": 301.0590315380263, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 13029.583, "restore_workers_time_ms": 0.035, "training_step_time_ms": 13029.503, "sample_time_ms": 1058.509, "learn_time_ms": 11905.666, "learn_throughput": 335.974, "synch_weights_time_ms": 64.48}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "92003_00011", "date": "2024-08-03_04-11-33", "timestamp": 1722638493, "time_this_iter_s": 13.299959182739258, "time_total_s": 179.61899280548096, "pid": 470944, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c78f130>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 179.61899280548096, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 17.772222222222222, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 227.44953643480937, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.8485246115674574, "policy_loss": -0.015321344528153228, "vf_loss": 3.861154163877169, "vf_explained_var": 0.9849272962038715, "kl": 0.02074343021729419, "entropy": 1.4568992365151643, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -21.574735372984048, "episode_reward_min": -1423.4097169314152, "episode_reward_mean": -731.006270501883, "episode_len_mean": 139.42, "episode_media": {}, "episodes_timesteps_total": 13942, "policy_reward_min": {"policy_0": -1423.4097169314152}, "policy_reward_max": {"policy_0": -21.574735372984048}, "policy_reward_mean": {"policy_0": -731.006270501883}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1337.4486820461925, -878.2176488435597, -44.2154908670418, -893.5623789239296, -21.574735372984048, -367.80189754748164, -935.3168535984861, -922.0000937806179, -860.7592031364451, -720.328068044449, -511.6337521487851, -1067.4776914153606, -787.8696162426817, -766.6488529279258, -491.7973833554437, -194.72029412177827, -829.0199046885677, -445.59688324593134, -50.5780182924163, -238.47741491123338, -892.6140597503935, -841.5809829743129, -939.8118275439411, -32.30738471508824, -1081.379450985679, -305.8026373997488, -337.62023374073004, -584.5275095029156, -949.7104456760787, -912.214099204251, -1025.7245063989562, -745.544348034212, -1080.864244005208, -791.179334745941, -625.0941089486164, -426.67201705679963, -1009.0629169423134, -691.4707326138887, -712.8722380762858, -878.2277847494731, -827.0646225658107, -858.3682393546163, -1147.0554732033168, -833.6895111785548, -957.6773215753495, -1383.5572695081219, -1148.7352118060728, -111.39610504142499, -690.9204855950218, -486.82567310347827, -1337.7935134678942, -800.8019309113878, -751.4646493568691, -802.0877665498798, -964.2972872887506, -799.643340399469, -944.3338708737947, -433.24086359035743, -839.8485440176893, -461.93505590719246, -490.04506321724034, -696.9746273589737, -28.151786756546315, -1211.0401013638557, -499.4314641981965, -875.1365208064142, -893.8419094065723, -1100.847184970169, -438.25307496647673, -1206.2411459906452, -157.6021126740452, -1033.1337871391129, -1423.4097169314152, -734.8953364929043, -645.9389626967517, -992.9986748428589, -908.196938046123, -825.640700745173, -548.5522453939177, -552.1309563741814, -730.7819363717177, -765.8215415531607, -989.3570438266632, -786.5633605426099, -64.02085218172999, -1169.479577093125, -965.3297297654673, -1054.2759714038298, -690.4845735106665, -187.42556421715156, -169.8229366743682, -1022.8093568106025, -953.992639576342, -702.3721428593251, -708.3312624374361, -956.4670405726021, -402.1612633431517, -708.935928130248, -548.917093565507, -450.7524635098305], "episode_lengths": [150, 150, 55, 150, 53, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72, 150, 150, 44, 110, 150, 150, 150, 57, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 143, 150, 150, 150, 150, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 150, 50, 150, 150, 150, 150, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 114, 117, 150, 150, 150, 150, 150, 138, 150, 150, 149], "policy_policy_0_reward": [-1337.4486820461925, -878.2176488435597, -44.2154908670418, -893.5623789239296, -21.574735372984048, -367.80189754748164, -935.3168535984861, -922.0000937806179, -860.7592031364451, -720.328068044449, -511.6337521487851, -1067.4776914153606, -787.8696162426817, -766.6488529279258, -491.7973833554437, -194.72029412177827, -829.0199046885677, -445.59688324593134, -50.5780182924163, -238.47741491123338, -892.6140597503935, -841.5809829743129, -939.8118275439411, -32.30738471508824, -1081.379450985679, -305.8026373997488, -337.62023374073004, -584.5275095029156, -949.7104456760787, -912.214099204251, -1025.7245063989562, -745.544348034212, -1080.864244005208, -791.179334745941, -625.0941089486164, -426.67201705679963, -1009.0629169423134, -691.4707326138887, -712.8722380762858, -878.2277847494731, -827.0646225658107, -858.3682393546163, -1147.0554732033168, -833.6895111785548, -957.6773215753495, -1383.5572695081219, -1148.7352118060728, -111.39610504142499, -690.9204855950218, -486.82567310347827, -1337.7935134678942, -800.8019309113878, -751.4646493568691, -802.0877665498798, -964.2972872887506, -799.643340399469, -944.3338708737947, -433.24086359035743, -839.8485440176893, -461.93505590719246, -490.04506321724034, -696.9746273589737, -28.151786756546315, -1211.0401013638557, -499.4314641981965, -875.1365208064142, -893.8419094065723, -1100.847184970169, -438.25307496647673, -1206.2411459906452, -157.6021126740452, -1033.1337871391129, -1423.4097169314152, -734.8953364929043, -645.9389626967517, -992.9986748428589, -908.196938046123, -825.640700745173, -548.5522453939177, -552.1309563741814, -730.7819363717177, -765.8215415531607, -989.3570438266632, -786.5633605426099, -64.02085218172999, -1169.479577093125, -965.3297297654673, -1054.2759714038298, -690.4845735106665, -187.42556421715156, -169.8229366743682, -1022.8093568106025, -953.992639576342, -702.3721428593251, -708.3312624374361, -956.4670405726021, -402.1612633431517, -708.935928130248, -548.917093565507, -450.7524635098305]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5597672847637398, "mean_inference_ms": 1.6858182194938658, "mean_action_processing_ms": 0.2817075478335681, "mean_env_wait_ms": 3.0102560159243894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01186370849609375, "StateBufferConnector_ms": 0.008019685745239258, "ViewRequirementAgentConnector_ms": 0.19829463958740234}, "num_episodes": 32, "episode_return_max": -21.574735372984048, "episode_return_min": -1423.4097169314152, "episode_return_mean": -731.006270501883, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.74625592496767, "num_env_steps_trained_throughput_per_sec": 302.74625592496767, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 13048.284, "restore_workers_time_ms": 0.034, "training_step_time_ms": 13048.204, "sample_time_ms": 1060.539, "learn_time_ms": 11922.31, "learn_throughput": 335.505, "synch_weights_time_ms": 64.503}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "92003_00011", "date": "2024-08-03_04-11-46", "timestamp": 1722638506, "time_this_iter_s": 13.224726676940918, "time_total_s": 192.84371948242188, "pid": 470944, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c78f910>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 192.84371948242188, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 17.22631578947368, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 223.61817071636517, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.0073914840817455, "policy_loss": -0.008832747995620593, "vf_loss": 4.0137215703725815, "vf_explained_var": 0.9835665062069893, "kl": 0.013224752766382153, "entropy": 1.464759843920668, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -28.151786756546315, "episode_reward_min": -1423.4097169314152, "episode_reward_mean": -776.5924911708022, "episode_len_mean": 144.25, "episode_media": {}, "episodes_timesteps_total": 14425, "policy_reward_min": {"policy_0": -1423.4097169314152}, "policy_reward_max": {"policy_0": -28.151786756546315}, "policy_reward_mean": {"policy_0": -776.5924911708022}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-949.7104456760787, -912.214099204251, -1025.7245063989562, -745.544348034212, -1080.864244005208, -791.179334745941, -625.0941089486164, -426.67201705679963, -1009.0629169423134, -691.4707326138887, -712.8722380762858, -878.2277847494731, -827.0646225658107, -858.3682393546163, -1147.0554732033168, -833.6895111785548, -957.6773215753495, -1383.5572695081219, -1148.7352118060728, -111.39610504142499, -690.9204855950218, -486.82567310347827, -1337.7935134678942, -800.8019309113878, -751.4646493568691, -802.0877665498798, -964.2972872887506, -799.643340399469, -944.3338708737947, -433.24086359035743, -839.8485440176893, -461.93505590719246, -490.04506321724034, -696.9746273589737, -28.151786756546315, -1211.0401013638557, -499.4314641981965, -875.1365208064142, -893.8419094065723, -1100.847184970169, -438.25307496647673, -1206.2411459906452, -157.6021126740452, -1033.1337871391129, -1423.4097169314152, -734.8953364929043, -645.9389626967517, -992.9986748428589, -908.196938046123, -825.640700745173, -548.5522453939177, -552.1309563741814, -730.7819363717177, -765.8215415531607, -989.3570438266632, -786.5633605426099, -64.02085218172999, -1169.479577093125, -965.3297297654673, -1054.2759714038298, -690.4845735106665, -187.42556421715156, -169.8229366743682, -1022.8093568106025, -953.992639576342, -702.3721428593251, -708.3312624374361, -956.4670405726021, -402.1612633431517, -708.935928130248, -548.917093565507, -450.7524635098305, -667.7093120890175, -602.4262131144044, -1165.921066577876, -1305.3647708473484, -603.2695006901952, -480.41977884102556, -501.86394611072626, -1288.3944048741296, -433.16715208591296, -389.55719475741756, -354.29700166210847, -801.1456680546821, -934.8000369223976, -968.8229541315935, -931.1428270387349, -1065.8723439396824, -932.0824398806603, -760.9410824911456, -752.4194386015787, -693.3400942826303, -993.5974877351176, -953.5422426274454, -766.5033294880056, -867.7886345699912, -836.0780201473174, -263.0230789576337, -792.3655615649399, -833.4554349323265], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 143, 150, 150, 150, 150, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 150, 50, 150, 150, 150, 150, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 114, 117, 150, 150, 150, 150, 150, 138, 150, 150, 149, 150, 150, 150, 150, 150, 141, 150, 150, 150, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 91, 150, 150], "policy_policy_0_reward": [-949.7104456760787, -912.214099204251, -1025.7245063989562, -745.544348034212, -1080.864244005208, -791.179334745941, -625.0941089486164, -426.67201705679963, -1009.0629169423134, -691.4707326138887, -712.8722380762858, -878.2277847494731, -827.0646225658107, -858.3682393546163, -1147.0554732033168, -833.6895111785548, -957.6773215753495, -1383.5572695081219, -1148.7352118060728, -111.39610504142499, -690.9204855950218, -486.82567310347827, -1337.7935134678942, -800.8019309113878, -751.4646493568691, -802.0877665498798, -964.2972872887506, -799.643340399469, -944.3338708737947, -433.24086359035743, -839.8485440176893, -461.93505590719246, -490.04506321724034, -696.9746273589737, -28.151786756546315, -1211.0401013638557, -499.4314641981965, -875.1365208064142, -893.8419094065723, -1100.847184970169, -438.25307496647673, -1206.2411459906452, -157.6021126740452, -1033.1337871391129, -1423.4097169314152, -734.8953364929043, -645.9389626967517, -992.9986748428589, -908.196938046123, -825.640700745173, -548.5522453939177, -552.1309563741814, -730.7819363717177, -765.8215415531607, -989.3570438266632, -786.5633605426099, -64.02085218172999, -1169.479577093125, -965.3297297654673, -1054.2759714038298, -690.4845735106665, -187.42556421715156, -169.8229366743682, -1022.8093568106025, -953.992639576342, -702.3721428593251, -708.3312624374361, -956.4670405726021, -402.1612633431517, -708.935928130248, -548.917093565507, -450.7524635098305, -667.7093120890175, -602.4262131144044, -1165.921066577876, -1305.3647708473484, -603.2695006901952, -480.41977884102556, -501.86394611072626, -1288.3944048741296, -433.16715208591296, -389.55719475741756, -354.29700166210847, -801.1456680546821, -934.8000369223976, -968.8229541315935, -931.1428270387349, -1065.8723439396824, -932.0824398806603, -760.9410824911456, -752.4194386015787, -693.3400942826303, -993.5974877351176, -953.5422426274454, -766.5033294880056, -867.7886345699912, -836.0780201473174, -263.0230789576337, -792.3655615649399, -833.4554349323265]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5597701401081878, "mean_inference_ms": 1.6868564677630544, "mean_action_processing_ms": 0.28177982512171623, "mean_env_wait_ms": 3.015944010346584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011893033981323242, "StateBufferConnector_ms": 0.00790262222290039, "ViewRequirementAgentConnector_ms": 0.19541311264038086}, "num_episodes": 28, "episode_return_max": -28.151786756546315, "episode_return_min": -1423.4097169314152, "episode_return_mean": -776.5924911708022, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.4419372059641, "num_env_steps_trained_throughput_per_sec": 318.4419372059641, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12950.464, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12950.386, "sample_time_ms": 1055.413, "learn_time_ms": 11829.318, "learn_throughput": 338.143, "synch_weights_time_ms": 64.804}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "92003_00011", "date": "2024-08-03_04-11-59", "timestamp": 1722638519, "time_this_iter_s": 12.573107957839966, "time_total_s": 205.41682744026184, "pid": 470944, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c7223b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 205.41682744026184, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 17.45, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 222.9238243997097, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.5507681521276635, "policy_loss": -0.011104588481248356, "vf_loss": 3.5588038665552935, "vf_explained_var": 0.9865713355441889, "kl": 0.014999839278364886, "entropy": 1.4310807740936677, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -28.151786756546315, "episode_reward_min": -1423.4097169314152, "episode_reward_mean": -732.2927946916593, "episode_len_mean": 143.23, "episode_media": {}, "episodes_timesteps_total": 14323, "policy_reward_min": {"policy_0": -1423.4097169314152}, "policy_reward_max": {"policy_0": -28.151786756546315}, "policy_reward_mean": {"policy_0": -732.2927946916593}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-944.3338708737947, -433.24086359035743, -839.8485440176893, -461.93505590719246, -490.04506321724034, -696.9746273589737, -28.151786756546315, -1211.0401013638557, -499.4314641981965, -875.1365208064142, -893.8419094065723, -1100.847184970169, -438.25307496647673, -1206.2411459906452, -157.6021126740452, -1033.1337871391129, -1423.4097169314152, -734.8953364929043, -645.9389626967517, -992.9986748428589, -908.196938046123, -825.640700745173, -548.5522453939177, -552.1309563741814, -730.7819363717177, -765.8215415531607, -989.3570438266632, -786.5633605426099, -64.02085218172999, -1169.479577093125, -965.3297297654673, -1054.2759714038298, -690.4845735106665, -187.42556421715156, -169.8229366743682, -1022.8093568106025, -953.992639576342, -702.3721428593251, -708.3312624374361, -956.4670405726021, -402.1612633431517, -708.935928130248, -548.917093565507, -450.7524635098305, -667.7093120890175, -602.4262131144044, -1165.921066577876, -1305.3647708473484, -603.2695006901952, -480.41977884102556, -501.86394611072626, -1288.3944048741296, -433.16715208591296, -389.55719475741756, -354.29700166210847, -801.1456680546821, -934.8000369223976, -968.8229541315935, -931.1428270387349, -1065.8723439396824, -932.0824398806603, -760.9410824911456, -752.4194386015787, -693.3400942826303, -993.5974877351176, -953.5422426274454, -766.5033294880056, -867.7886345699912, -836.0780201473174, -263.0230789576337, -792.3655615649399, -833.4554349323265, -1062.1024206129425, -268.7162663055443, -367.430838069555, -902.880096900278, -47.58377940889732, -781.0843515891446, -372.3352632486252, -618.8065114975876, -423.76854984222445, -712.2213213307211, -1066.6404802223215, -282.50924189376224, -465.70589174363283, -1089.0916472996696, -1053.8894321170535, -752.2944916212793, -1023.1731516029829, -702.7451944815933, -650.8148614685675, -274.4730244330204, -973.7041713943959, -913.255451661266, -914.7493174549993, -1120.3327551041073, -418.8532662533911, -536.748944626844, -814.1349852687026, -709.9998219906425], "episode_lengths": [150, 150, 150, 150, 136, 150, 50, 150, 150, 150, 150, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 114, 117, 150, 150, 150, 150, 150, 138, 150, 150, 149, 150, 150, 150, 150, 150, 141, 150, 150, 150, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 91, 150, 150, 150, 100, 150, 150, 68, 150, 150, 150, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 146, 150, 150, 150], "policy_policy_0_reward": [-944.3338708737947, -433.24086359035743, -839.8485440176893, -461.93505590719246, -490.04506321724034, -696.9746273589737, -28.151786756546315, -1211.0401013638557, -499.4314641981965, -875.1365208064142, -893.8419094065723, -1100.847184970169, -438.25307496647673, -1206.2411459906452, -157.6021126740452, -1033.1337871391129, -1423.4097169314152, -734.8953364929043, -645.9389626967517, -992.9986748428589, -908.196938046123, -825.640700745173, -548.5522453939177, -552.1309563741814, -730.7819363717177, -765.8215415531607, -989.3570438266632, -786.5633605426099, -64.02085218172999, -1169.479577093125, -965.3297297654673, -1054.2759714038298, -690.4845735106665, -187.42556421715156, -169.8229366743682, -1022.8093568106025, -953.992639576342, -702.3721428593251, -708.3312624374361, -956.4670405726021, -402.1612633431517, -708.935928130248, -548.917093565507, -450.7524635098305, -667.7093120890175, -602.4262131144044, -1165.921066577876, -1305.3647708473484, -603.2695006901952, -480.41977884102556, -501.86394611072626, -1288.3944048741296, -433.16715208591296, -389.55719475741756, -354.29700166210847, -801.1456680546821, -934.8000369223976, -968.8229541315935, -931.1428270387349, -1065.8723439396824, -932.0824398806603, -760.9410824911456, -752.4194386015787, -693.3400942826303, -993.5974877351176, -953.5422426274454, -766.5033294880056, -867.7886345699912, -836.0780201473174, -263.0230789576337, -792.3655615649399, -833.4554349323265, -1062.1024206129425, -268.7162663055443, -367.430838069555, -902.880096900278, -47.58377940889732, -781.0843515891446, -372.3352632486252, -618.8065114975876, -423.76854984222445, -712.2213213307211, -1066.6404802223215, -282.50924189376224, -465.70589174363283, -1089.0916472996696, -1053.8894321170535, -752.2944916212793, -1023.1731516029829, -702.7451944815933, -650.8148614685675, -274.4730244330204, -973.7041713943959, -913.255451661266, -914.7493174549993, -1120.3327551041073, -418.8532662533911, -536.748944626844, -814.1349852687026, -709.9998219906425]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5589356741922233, "mean_inference_ms": 1.6850034778594678, "mean_action_processing_ms": 0.281299990797819, "mean_env_wait_ms": 3.015237595914196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011958599090576172, "StateBufferConnector_ms": 0.007874727249145508, "ViewRequirementAgentConnector_ms": 0.19602108001708984}, "num_episodes": 28, "episode_return_max": -28.151786756546315, "episode_return_min": -1423.4097169314152, "episode_return_mean": -732.2927946916593, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.18743870721215, "num_env_steps_trained_throughput_per_sec": 295.18743870721215, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 13069.846, "restore_workers_time_ms": 0.034, "training_step_time_ms": 13069.768, "sample_time_ms": 1054.363, "learn_time_ms": 11949.689, "learn_throughput": 334.737, "synch_weights_time_ms": 64.896}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "92003_00011", "date": "2024-08-03_04-12-12", "timestamp": 1722638532, "time_this_iter_s": 13.559432029724121, "time_total_s": 218.97625946998596, "pid": 470944, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8b1af80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 218.97625946998596, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 19.72, "ram_util_percent": 27.855}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 192.66083136002223, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.096591936051846, "policy_loss": -0.007366950014450898, "vf_loss": 4.100942680239678, "vf_explained_var": 0.9818189043551684, "kl": 0.014890383324867215, "entropy": 1.4509101846565804, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -38.95027883445172, "episode_reward_min": -1305.3647708473484, "episode_reward_mean": -718.7736594055954, "episode_len_mean": 142.73, "episode_media": {}, "episodes_timesteps_total": 14273, "policy_reward_min": {"policy_0": -1305.3647708473484}, "policy_reward_max": {"policy_0": -38.95027883445172}, "policy_reward_mean": {"policy_0": -718.7736594055954}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1169.479577093125, -965.3297297654673, -1054.2759714038298, -690.4845735106665, -187.42556421715156, -169.8229366743682, -1022.8093568106025, -953.992639576342, -702.3721428593251, -708.3312624374361, -956.4670405726021, -402.1612633431517, -708.935928130248, -548.917093565507, -450.7524635098305, -667.7093120890175, -602.4262131144044, -1165.921066577876, -1305.3647708473484, -603.2695006901952, -480.41977884102556, -501.86394611072626, -1288.3944048741296, -433.16715208591296, -389.55719475741756, -354.29700166210847, -801.1456680546821, -934.8000369223976, -968.8229541315935, -931.1428270387349, -1065.8723439396824, -932.0824398806603, -760.9410824911456, -752.4194386015787, -693.3400942826303, -993.5974877351176, -953.5422426274454, -766.5033294880056, -867.7886345699912, -836.0780201473174, -263.0230789576337, -792.3655615649399, -833.4554349323265, -1062.1024206129425, -268.7162663055443, -367.430838069555, -902.880096900278, -47.58377940889732, -781.0843515891446, -372.3352632486252, -618.8065114975876, -423.76854984222445, -712.2213213307211, -1066.6404802223215, -282.50924189376224, -465.70589174363283, -1089.0916472996696, -1053.8894321170535, -752.2944916212793, -1023.1731516029829, -702.7451944815933, -650.8148614685675, -274.4730244330204, -973.7041713943959, -913.255451661266, -914.7493174549993, -1120.3327551041073, -418.8532662533911, -536.748944626844, -814.1349852687026, -709.9998219906425, -638.3637267758203, -1104.3255740896484, -768.7741543218447, -708.205480045812, -1030.239123504287, -423.6765494366584, -589.4911910754709, -965.8121846593334, -700.4741831006228, -139.11055409785874, -163.54619891301544, -324.4828022088498, -399.77862233024103, -418.1281183169963, -38.95027883445172, -591.2731063391975, -1124.1273074329522, -1155.4631302652874, -731.9441615799584, -1152.4004238021678, -487.3233693659874, -1281.2423305725508, -495.3624633747548, -1092.3360499481832, -577.070602132165, -291.1389545874619, -883.1231396931482, -612.1541551019458, -1038.1339147234225], "episode_lengths": [150, 150, 150, 150, 114, 117, 150, 150, 150, 150, 150, 138, 150, 150, 149, 150, 150, 150, 150, 150, 141, 150, 150, 150, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 91, 150, 150, 150, 100, 150, 150, 68, 150, 150, 150, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 65, 70, 150, 150, 150, 53, 150, 150, 150, 150, 150, 150, 150, 134, 150, 150, 94, 150, 150, 150], "policy_policy_0_reward": [-1169.479577093125, -965.3297297654673, -1054.2759714038298, -690.4845735106665, -187.42556421715156, -169.8229366743682, -1022.8093568106025, -953.992639576342, -702.3721428593251, -708.3312624374361, -956.4670405726021, -402.1612633431517, -708.935928130248, -548.917093565507, -450.7524635098305, -667.7093120890175, -602.4262131144044, -1165.921066577876, -1305.3647708473484, -603.2695006901952, -480.41977884102556, -501.86394611072626, -1288.3944048741296, -433.16715208591296, -389.55719475741756, -354.29700166210847, -801.1456680546821, -934.8000369223976, -968.8229541315935, -931.1428270387349, -1065.8723439396824, -932.0824398806603, -760.9410824911456, -752.4194386015787, -693.3400942826303, -993.5974877351176, -953.5422426274454, -766.5033294880056, -867.7886345699912, -836.0780201473174, -263.0230789576337, -792.3655615649399, -833.4554349323265, -1062.1024206129425, -268.7162663055443, -367.430838069555, -902.880096900278, -47.58377940889732, -781.0843515891446, -372.3352632486252, -618.8065114975876, -423.76854984222445, -712.2213213307211, -1066.6404802223215, -282.50924189376224, -465.70589174363283, -1089.0916472996696, -1053.8894321170535, -752.2944916212793, -1023.1731516029829, -702.7451944815933, -650.8148614685675, -274.4730244330204, -973.7041713943959, -913.255451661266, -914.7493174549993, -1120.3327551041073, -418.8532662533911, -536.748944626844, -814.1349852687026, -709.9998219906425, -638.3637267758203, -1104.3255740896484, -768.7741543218447, -708.205480045812, -1030.239123504287, -423.6765494366584, -589.4911910754709, -965.8121846593334, -700.4741831006228, -139.11055409785874, -163.54619891301544, -324.4828022088498, -399.77862233024103, -418.1281183169963, -38.95027883445172, -591.2731063391975, -1124.1273074329522, -1155.4631302652874, -731.9441615799584, -1152.4004238021678, -487.3233693659874, -1281.2423305725508, -495.3624633747548, -1092.3360499481832, -577.070602132165, -291.1389545874619, -883.1231396931482, -612.1541551019458, -1038.1339147234225]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5581463449246787, "mean_inference_ms": 1.6820247526382983, "mean_action_processing_ms": 0.280650267246244, "mean_env_wait_ms": 3.0133405479106528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011581182479858398, "StateBufferConnector_ms": 0.0076923370361328125, "ViewRequirementAgentConnector_ms": 0.18903231620788574}, "num_episodes": 29, "episode_return_max": -38.95027883445172, "episode_return_min": -1305.3647708473484, "episode_return_mean": -718.7736594055954, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 348.4922498394499, "num_env_steps_trained_throughput_per_sec": 348.4922498394499, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 13016.508, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13016.432, "sample_time_ms": 1051.055, "learn_time_ms": 11893.765, "learn_throughput": 336.311, "synch_weights_time_ms": 70.704}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "92003_00011", "date": "2024-08-03_04-12-24", "timestamp": 1722638544, "time_this_iter_s": 11.493079662322998, "time_total_s": 230.46933913230896, "pid": 470944, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c78f910>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 230.46933913230896, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 45.4375, "ram_util_percent": 30.11875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 254.38629711866378, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.6768187771240872, "policy_loss": -0.01192114616036027, "vf_loss": 3.6856926910579206, "vf_explained_var": 0.9890920427317421, "kl": 0.015220578127537032, "entropy": 1.5189422280838092, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -1.0208369552596426, "episode_reward_min": -1296.4894413912068, "episode_reward_mean": -711.3519690139867, "episode_len_mean": 139.32, "episode_media": {}, "episodes_timesteps_total": 13932, "policy_reward_min": {"policy_0": -1296.4894413912068}, "policy_reward_max": {"policy_0": -1.0208369552596426}, "policy_reward_mean": {"policy_0": -711.3519690139867}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-934.8000369223976, -968.8229541315935, -931.1428270387349, -1065.8723439396824, -932.0824398806603, -760.9410824911456, -752.4194386015787, -693.3400942826303, -993.5974877351176, -953.5422426274454, -766.5033294880056, -867.7886345699912, -836.0780201473174, -263.0230789576337, -792.3655615649399, -833.4554349323265, -1062.1024206129425, -268.7162663055443, -367.430838069555, -902.880096900278, -47.58377940889732, -781.0843515891446, -372.3352632486252, -618.8065114975876, -423.76854984222445, -712.2213213307211, -1066.6404802223215, -282.50924189376224, -465.70589174363283, -1089.0916472996696, -1053.8894321170535, -752.2944916212793, -1023.1731516029829, -702.7451944815933, -650.8148614685675, -274.4730244330204, -973.7041713943959, -913.255451661266, -914.7493174549993, -1120.3327551041073, -418.8532662533911, -536.748944626844, -814.1349852687026, -709.9998219906425, -638.3637267758203, -1104.3255740896484, -768.7741543218447, -708.205480045812, -1030.239123504287, -423.6765494366584, -589.4911910754709, -965.8121846593334, -700.4741831006228, -139.11055409785874, -163.54619891301544, -324.4828022088498, -399.77862233024103, -418.1281183169963, -38.95027883445172, -591.2731063391975, -1124.1273074329522, -1155.4631302652874, -731.9441615799584, -1152.4004238021678, -487.3233693659874, -1281.2423305725508, -495.3624633747548, -1092.3360499481832, -577.070602132165, -291.1389545874619, -883.1231396931482, -612.1541551019458, -1038.1339147234225, -1018.8365935331435, -382.9235247687201, -458.90801854615097, -733.4242371481671, -1062.4771803099195, -780.5344148938308, -910.4723565162044, -248.45040314603318, -1155.3242223604916, -89.2775376936056, -378.85965318452594, -1008.4962196858619, -801.9995917348248, -408.71227130575807, -728.4110168348195, -1296.4894413912068, -1.0208369552596426, -1155.8093230258266, -1193.2606205469551, -914.9473472362478, -637.9698377510055, -418.1186410466701, -1101.1588464676015, -136.3841433380216, -185.65028044416024, -506.3612531981628, -828.6467009504639], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 91, 150, 150, 150, 100, 150, 150, 68, 150, 150, 150, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 65, 70, 150, 150, 150, 53, 150, 150, 150, 150, 150, 150, 150, 134, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 55, 125, 150, 150, 115, 150, 150, 34, 150, 150, 150, 150, 150, 150, 86, 101, 150, 150], "policy_policy_0_reward": [-934.8000369223976, -968.8229541315935, -931.1428270387349, -1065.8723439396824, -932.0824398806603, -760.9410824911456, -752.4194386015787, -693.3400942826303, -993.5974877351176, -953.5422426274454, -766.5033294880056, -867.7886345699912, -836.0780201473174, -263.0230789576337, -792.3655615649399, -833.4554349323265, -1062.1024206129425, -268.7162663055443, -367.430838069555, -902.880096900278, -47.58377940889732, -781.0843515891446, -372.3352632486252, -618.8065114975876, -423.76854984222445, -712.2213213307211, -1066.6404802223215, -282.50924189376224, -465.70589174363283, -1089.0916472996696, -1053.8894321170535, -752.2944916212793, -1023.1731516029829, -702.7451944815933, -650.8148614685675, -274.4730244330204, -973.7041713943959, -913.255451661266, -914.7493174549993, -1120.3327551041073, -418.8532662533911, -536.748944626844, -814.1349852687026, -709.9998219906425, -638.3637267758203, -1104.3255740896484, -768.7741543218447, -708.205480045812, -1030.239123504287, -423.6765494366584, -589.4911910754709, -965.8121846593334, -700.4741831006228, -139.11055409785874, -163.54619891301544, -324.4828022088498, -399.77862233024103, -418.1281183169963, -38.95027883445172, -591.2731063391975, -1124.1273074329522, -1155.4631302652874, -731.9441615799584, -1152.4004238021678, -487.3233693659874, -1281.2423305725508, -495.3624633747548, -1092.3360499481832, -577.070602132165, -291.1389545874619, -883.1231396931482, -612.1541551019458, -1038.1339147234225, -1018.8365935331435, -382.9235247687201, -458.90801854615097, -733.4242371481671, -1062.4771803099195, -780.5344148938308, -910.4723565162044, -248.45040314603318, -1155.3242223604916, -89.2775376936056, -378.85965318452594, -1008.4962196858619, -801.9995917348248, -408.71227130575807, -728.4110168348195, -1296.4894413912068, -1.0208369552596426, -1155.8093230258266, -1193.2606205469551, -914.9473472362478, -637.9698377510055, -418.1186410466701, -1101.1588464676015, -136.3841433380216, -185.65028044416024, -506.3612531981628, -828.6467009504639]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5685249069877137, "mean_inference_ms": 1.7151953918581488, "mean_action_processing_ms": 0.2854540493727841, "mean_env_wait_ms": 3.068359486553758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016206741333007812, "StateBufferConnector_ms": 0.011868715286254883, "ViewRequirementAgentConnector_ms": 0.2941603660583496}, "num_episodes": 27, "episode_return_max": -1.0208369552596426, "episode_return_min": -1296.4894413912068, "episode_return_mean": -711.3519690139867, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 289.34731815293276, "num_env_steps_trained_throughput_per_sec": 289.34731815293276, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 13072.91, "restore_workers_time_ms": 0.034, "training_step_time_ms": 13072.831, "sample_time_ms": 1223.484, "learn_time_ms": 11771.849, "learn_throughput": 339.794, "synch_weights_time_ms": 76.566}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "92003_00011", "date": "2024-08-03_04-12-38", "timestamp": 1722638558, "time_this_iter_s": 13.846597671508789, "time_total_s": 244.31593680381775, "pid": 470944, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c721750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 244.31593680381775, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 79.94999999999999, "ram_util_percent": 41.89}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 277.3396242141724, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.018238812685013, "policy_loss": -0.01685947510074281, "vf_loss": 4.031914572666088, "vf_explained_var": 0.9810028439387679, "kl": 0.015227195090362045, "entropy": 1.3844341509044171, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -1.0208369552596426, "episode_reward_min": -1375.650905724819, "episode_reward_mean": -690.8357729294404, "episode_len_mean": 136.3, "episode_media": {}, "episodes_timesteps_total": 13630, "policy_reward_min": {"policy_0": -1375.650905724819}, "policy_reward_max": {"policy_0": -1.0208369552596426}, "policy_reward_mean": {"policy_0": -690.8357729294404}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-752.2944916212793, -1023.1731516029829, -702.7451944815933, -650.8148614685675, -274.4730244330204, -973.7041713943959, -913.255451661266, -914.7493174549993, -1120.3327551041073, -418.8532662533911, -536.748944626844, -814.1349852687026, -709.9998219906425, -638.3637267758203, -1104.3255740896484, -768.7741543218447, -708.205480045812, -1030.239123504287, -423.6765494366584, -589.4911910754709, -965.8121846593334, -700.4741831006228, -139.11055409785874, -163.54619891301544, -324.4828022088498, -399.77862233024103, -418.1281183169963, -38.95027883445172, -591.2731063391975, -1124.1273074329522, -1155.4631302652874, -731.9441615799584, -1152.4004238021678, -487.3233693659874, -1281.2423305725508, -495.3624633747548, -1092.3360499481832, -577.070602132165, -291.1389545874619, -883.1231396931482, -612.1541551019458, -1038.1339147234225, -1018.8365935331435, -382.9235247687201, -458.90801854615097, -733.4242371481671, -1062.4771803099195, -780.5344148938308, -910.4723565162044, -248.45040314603318, -1155.3242223604916, -89.2775376936056, -378.85965318452594, -1008.4962196858619, -801.9995917348248, -408.71227130575807, -728.4110168348195, -1296.4894413912068, -1.0208369552596426, -1155.8093230258266, -1193.2606205469551, -914.9473472362478, -637.9698377510055, -418.1186410466701, -1101.1588464676015, -136.3841433380216, -185.65028044416024, -506.3612531981628, -828.6467009504639, -1012.4236282858444, -690.4513919352855, -201.82332343632885, -624.7707382952873, -699.9107726204996, -890.1425660173558, -317.0231165980398, -597.3982479786288, -1166.2203577030434, -1375.650905724819, -261.46182639430526, -916.1982018474035, -385.0665479959888, -148.3746133712576, -224.6213143115108, -1042.3318701504631, -888.1503735130935, -736.9585276167611, -1132.9695691841875, -324.4475206544398, -815.5405859260841, -941.8625743453539, -405.6190936721613, -643.9712799456977, -1223.5233347090214, -510.2908673788403, -1012.3773895668814, -106.48306947506734, -752.3033768545184, -21.916736632084493, -738.6377687982543], "episode_lengths": [150, 150, 150, 150, 127, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 65, 70, 150, 150, 150, 53, 150, 150, 150, 150, 150, 150, 150, 134, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 55, 125, 150, 150, 115, 150, 150, 34, 150, 150, 150, 150, 150, 150, 86, 101, 150, 150, 150, 150, 77, 150, 150, 150, 94, 150, 150, 150, 89, 150, 135, 69, 81, 150, 150, 150, 150, 105, 150, 150, 150, 132, 150, 150, 150, 94, 150, 59, 150], "policy_policy_0_reward": [-752.2944916212793, -1023.1731516029829, -702.7451944815933, -650.8148614685675, -274.4730244330204, -973.7041713943959, -913.255451661266, -914.7493174549993, -1120.3327551041073, -418.8532662533911, -536.748944626844, -814.1349852687026, -709.9998219906425, -638.3637267758203, -1104.3255740896484, -768.7741543218447, -708.205480045812, -1030.239123504287, -423.6765494366584, -589.4911910754709, -965.8121846593334, -700.4741831006228, -139.11055409785874, -163.54619891301544, -324.4828022088498, -399.77862233024103, -418.1281183169963, -38.95027883445172, -591.2731063391975, -1124.1273074329522, -1155.4631302652874, -731.9441615799584, -1152.4004238021678, -487.3233693659874, -1281.2423305725508, -495.3624633747548, -1092.3360499481832, -577.070602132165, -291.1389545874619, -883.1231396931482, -612.1541551019458, -1038.1339147234225, -1018.8365935331435, -382.9235247687201, -458.90801854615097, -733.4242371481671, -1062.4771803099195, -780.5344148938308, -910.4723565162044, -248.45040314603318, -1155.3242223604916, -89.2775376936056, -378.85965318452594, -1008.4962196858619, -801.9995917348248, -408.71227130575807, -728.4110168348195, -1296.4894413912068, -1.0208369552596426, -1155.8093230258266, -1193.2606205469551, -914.9473472362478, -637.9698377510055, -418.1186410466701, -1101.1588464676015, -136.3841433380216, -185.65028044416024, -506.3612531981628, -828.6467009504639, -1012.4236282858444, -690.4513919352855, -201.82332343632885, -624.7707382952873, -699.9107726204996, -890.1425660173558, -317.0231165980398, -597.3982479786288, -1166.2203577030434, -1375.650905724819, -261.46182639430526, -916.1982018474035, -385.0665479959888, -148.3746133712576, -224.6213143115108, -1042.3318701504631, -888.1503735130935, -736.9585276167611, -1132.9695691841875, -324.4475206544398, -815.5405859260841, -941.8625743453539, -405.6190936721613, -643.9712799456977, -1223.5233347090214, -510.2908673788403, -1012.3773895668814, -106.48306947506734, -752.3033768545184, -21.916736632084493, -738.6377687982543]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5857398682573881, "mean_inference_ms": 1.7771707827437424, "mean_action_processing_ms": 0.2948755910355363, "mean_env_wait_ms": 3.160891622274261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01968526840209961, "StateBufferConnector_ms": 0.01415395736694336, "ViewRequirementAgentConnector_ms": 0.3436307907104492}, "num_episodes": 31, "episode_return_max": -1.0208369552596426, "episode_return_min": -1375.650905724819, "episode_return_mean": -690.8357729294404, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 365.69805556725345, "num_env_steps_trained_throughput_per_sec": 365.69805556725345, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12847.406, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12847.323, "sample_time_ms": 1338.214, "learn_time_ms": 11427.194, "learn_throughput": 350.042, "synch_weights_time_ms": 80.969}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "92003_00011", "date": "2024-08-03_04-12-49", "timestamp": 1722638569, "time_this_iter_s": 10.952580213546753, "time_total_s": 255.2685170173645, "pid": 470944, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c722830>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 255.2685170173645, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 32.60666666666666, "ram_util_percent": 47.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 233.67011557420093, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.522241339584192, "policy_loss": -0.012970845136927285, "vf_loss": 4.530992466459671, "vf_explained_var": 0.9848059707010786, "kl": 0.01915360504892002, "entropy": 1.5263680167496205, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -1.0208369552596426, "episode_reward_min": -1418.3573751449633, "episode_reward_mean": -721.520353724671, "episode_len_mean": 136.52, "episode_media": {}, "episodes_timesteps_total": 13652, "policy_reward_min": {"policy_0": -1418.3573751449633}, "policy_reward_max": {"policy_0": -1.0208369552596426}, "policy_reward_mean": {"policy_0": -721.520353724671}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1152.4004238021678, -487.3233693659874, -1281.2423305725508, -495.3624633747548, -1092.3360499481832, -577.070602132165, -291.1389545874619, -883.1231396931482, -612.1541551019458, -1038.1339147234225, -1018.8365935331435, -382.9235247687201, -458.90801854615097, -733.4242371481671, -1062.4771803099195, -780.5344148938308, -910.4723565162044, -248.45040314603318, -1155.3242223604916, -89.2775376936056, -378.85965318452594, -1008.4962196858619, -801.9995917348248, -408.71227130575807, -728.4110168348195, -1296.4894413912068, -1.0208369552596426, -1155.8093230258266, -1193.2606205469551, -914.9473472362478, -637.9698377510055, -418.1186410466701, -1101.1588464676015, -136.3841433380216, -185.65028044416024, -506.3612531981628, -828.6467009504639, -1012.4236282858444, -690.4513919352855, -201.82332343632885, -624.7707382952873, -699.9107726204996, -890.1425660173558, -317.0231165980398, -597.3982479786288, -1166.2203577030434, -1375.650905724819, -261.46182639430526, -916.1982018474035, -385.0665479959888, -148.3746133712576, -224.6213143115108, -1042.3318701504631, -888.1503735130935, -736.9585276167611, -1132.9695691841875, -324.4475206544398, -815.5405859260841, -941.8625743453539, -405.6190936721613, -643.9712799456977, -1223.5233347090214, -510.2908673788403, -1012.3773895668814, -106.48306947506734, -752.3033768545184, -21.916736632084493, -738.6377687982543, -364.1724375177945, -665.9416315938138, -571.4278111769199, -675.4724795175208, -868.0146851370481, -1196.1853829921397, -692.3140751044656, -204.53785366729667, -948.0253337416127, -895.1611645400932, -991.8346274595342, -1418.3573751449633, -1084.9747225408394, -534.3798328938153, -254.59083760943557, -1237.4555327390315, -737.299424304992, -375.7639121907841, -906.9072785223863, -1308.595565430234, -720.3006955511842, -314.15625754548313, -897.9184011532216, -490.7272515094932, -186.52755172631427, -1161.7685695501991, -1357.3274431460418, -1398.2885130079785, -806.6736954074262, -267.3816224019657, -943.7028825417196, -413.7191168474084], "episode_lengths": [150, 150, 150, 134, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 55, 125, 150, 150, 115, 150, 150, 34, 150, 150, 150, 150, 150, 150, 86, 101, 150, 150, 150, 150, 77, 150, 150, 150, 94, 150, 150, 150, 89, 150, 135, 69, 81, 150, 150, 150, 150, 105, 150, 150, 150, 132, 150, 150, 150, 94, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 120, 150, 123, 94, 150, 150, 150, 150, 128, 150, 150], "policy_policy_0_reward": [-1152.4004238021678, -487.3233693659874, -1281.2423305725508, -495.3624633747548, -1092.3360499481832, -577.070602132165, -291.1389545874619, -883.1231396931482, -612.1541551019458, -1038.1339147234225, -1018.8365935331435, -382.9235247687201, -458.90801854615097, -733.4242371481671, -1062.4771803099195, -780.5344148938308, -910.4723565162044, -248.45040314603318, -1155.3242223604916, -89.2775376936056, -378.85965318452594, -1008.4962196858619, -801.9995917348248, -408.71227130575807, -728.4110168348195, -1296.4894413912068, -1.0208369552596426, -1155.8093230258266, -1193.2606205469551, -914.9473472362478, -637.9698377510055, -418.1186410466701, -1101.1588464676015, -136.3841433380216, -185.65028044416024, -506.3612531981628, -828.6467009504639, -1012.4236282858444, -690.4513919352855, -201.82332343632885, -624.7707382952873, -699.9107726204996, -890.1425660173558, -317.0231165980398, -597.3982479786288, -1166.2203577030434, -1375.650905724819, -261.46182639430526, -916.1982018474035, -385.0665479959888, -148.3746133712576, -224.6213143115108, -1042.3318701504631, -888.1503735130935, -736.9585276167611, -1132.9695691841875, -324.4475206544398, -815.5405859260841, -941.8625743453539, -405.6190936721613, -643.9712799456977, -1223.5233347090214, -510.2908673788403, -1012.3773895668814, -106.48306947506734, -752.3033768545184, -21.916736632084493, -738.6377687982543, -364.1724375177945, -665.9416315938138, -571.4278111769199, -675.4724795175208, -868.0146851370481, -1196.1853829921397, -692.3140751044656, -204.53785366729667, -948.0253337416127, -895.1611645400932, -991.8346274595342, -1418.3573751449633, -1084.9747225408394, -534.3798328938153, -254.59083760943557, -1237.4555327390315, -737.299424304992, -375.7639121907841, -906.9072785223863, -1308.595565430234, -720.3006955511842, -314.15625754548313, -897.9184011532216, -490.7272515094932, -186.52755172631427, -1161.7685695501991, -1357.3274431460418, -1398.2885130079785, -806.6736954074262, -267.3816224019657, -943.7028825417196, -413.7191168474084]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6026408183318981, "mean_inference_ms": 1.8386852195760761, "mean_action_processing_ms": 0.3039904173589735, "mean_env_wait_ms": 3.254352280627989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019975662231445312, "StateBufferConnector_ms": 0.014242887496948242, "ViewRequirementAgentConnector_ms": 0.351917028427124}, "num_episodes": 32, "episode_return_max": -1.0208369552596426, "episode_return_min": -1418.3573751449633, "episode_return_mean": -721.520353724671, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.9745434132733, "num_env_steps_trained_throughput_per_sec": 311.9745434132733, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12826.071, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12825.989, "sample_time_ms": 1352.788, "learn_time_ms": 11394.394, "learn_throughput": 351.05, "synch_weights_time_ms": 77.885}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "92003_00011", "date": "2024-08-03_04-13-01", "timestamp": 1722638581, "time_this_iter_s": 12.83391261100769, "time_total_s": 268.1024296283722, "pid": 470944, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c78c280>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 268.1024296283722, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 23.13157894736842, "ram_util_percent": 47.05263157894737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 284.97590732574463, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.8034022537370524, "policy_loss": -0.012454440830818687, "vf_loss": 3.8121393946309885, "vf_explained_var": 0.9883387337128321, "kl": 0.017226367275088732, "entropy": 1.4506061458339294, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -1.0208369552596426, "episode_reward_min": -1418.3573751449633, "episode_reward_mean": -722.3323010975579, "episode_len_mean": 137.74, "episode_media": {}, "episodes_timesteps_total": 13774, "policy_reward_min": {"policy_0": -1418.3573751449633}, "policy_reward_max": {"policy_0": -1.0208369552596426}, "policy_reward_mean": {"policy_0": -722.3323010975579}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0208369552596426, -1155.8093230258266, -1193.2606205469551, -914.9473472362478, -637.9698377510055, -418.1186410466701, -1101.1588464676015, -136.3841433380216, -185.65028044416024, -506.3612531981628, -828.6467009504639, -1012.4236282858444, -690.4513919352855, -201.82332343632885, -624.7707382952873, -699.9107726204996, -890.1425660173558, -317.0231165980398, -597.3982479786288, -1166.2203577030434, -1375.650905724819, -261.46182639430526, -916.1982018474035, -385.0665479959888, -148.3746133712576, -224.6213143115108, -1042.3318701504631, -888.1503735130935, -736.9585276167611, -1132.9695691841875, -324.4475206544398, -815.5405859260841, -941.8625743453539, -405.6190936721613, -643.9712799456977, -1223.5233347090214, -510.2908673788403, -1012.3773895668814, -106.48306947506734, -752.3033768545184, -21.916736632084493, -738.6377687982543, -364.1724375177945, -665.9416315938138, -571.4278111769199, -675.4724795175208, -868.0146851370481, -1196.1853829921397, -692.3140751044656, -204.53785366729667, -948.0253337416127, -895.1611645400932, -991.8346274595342, -1418.3573751449633, -1084.9747225408394, -534.3798328938153, -254.59083760943557, -1237.4555327390315, -737.299424304992, -375.7639121907841, -906.9072785223863, -1308.595565430234, -720.3006955511842, -314.15625754548313, -897.9184011532216, -490.7272515094932, -186.52755172631427, -1161.7685695501991, -1357.3274431460418, -1398.2885130079785, -806.6736954074262, -267.3816224019657, -943.7028825417196, -413.7191168474084, -1077.5485100444953, -1281.6943056558348, -1086.4735520931022, -206.97726905520568, -438.223863672545, -1076.223298537721, -446.30505986589475, -1035.4175283633967, -1318.6167435629995, -711.7362658387963, -346.49323592129804, -944.2159691495531, -928.2699950892145, -1148.4636641281797, -663.4611987570051, -636.3793045053874, -473.3235509606301, -435.9357358980649, -767.8210888354507, -532.2935255521796, -655.874142275029, -990.8854930969424, -667.1261032587109, -153.646465141887, -1002.6163722846953, -429.0545820995338], "episode_lengths": [34, 150, 150, 150, 150, 150, 150, 86, 101, 150, 150, 150, 150, 77, 150, 150, 150, 94, 150, 150, 150, 89, 150, 135, 69, 81, 150, 150, 150, 150, 105, 150, 150, 150, 132, 150, 150, 150, 94, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 120, 150, 123, 94, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 136, 150, 150, 150, 66, 150, 150], "policy_policy_0_reward": [-1.0208369552596426, -1155.8093230258266, -1193.2606205469551, -914.9473472362478, -637.9698377510055, -418.1186410466701, -1101.1588464676015, -136.3841433380216, -185.65028044416024, -506.3612531981628, -828.6467009504639, -1012.4236282858444, -690.4513919352855, -201.82332343632885, -624.7707382952873, -699.9107726204996, -890.1425660173558, -317.0231165980398, -597.3982479786288, -1166.2203577030434, -1375.650905724819, -261.46182639430526, -916.1982018474035, -385.0665479959888, -148.3746133712576, -224.6213143115108, -1042.3318701504631, -888.1503735130935, -736.9585276167611, -1132.9695691841875, -324.4475206544398, -815.5405859260841, -941.8625743453539, -405.6190936721613, -643.9712799456977, -1223.5233347090214, -510.2908673788403, -1012.3773895668814, -106.48306947506734, -752.3033768545184, -21.916736632084493, -738.6377687982543, -364.1724375177945, -665.9416315938138, -571.4278111769199, -675.4724795175208, -868.0146851370481, -1196.1853829921397, -692.3140751044656, -204.53785366729667, -948.0253337416127, -895.1611645400932, -991.8346274595342, -1418.3573751449633, -1084.9747225408394, -534.3798328938153, -254.59083760943557, -1237.4555327390315, -737.299424304992, -375.7639121907841, -906.9072785223863, -1308.595565430234, -720.3006955511842, -314.15625754548313, -897.9184011532216, -490.7272515094932, -186.52755172631427, -1161.7685695501991, -1357.3274431460418, -1398.2885130079785, -806.6736954074262, -267.3816224019657, -943.7028825417196, -413.7191168474084, -1077.5485100444953, -1281.6943056558348, -1086.4735520931022, -206.97726905520568, -438.223863672545, -1076.223298537721, -446.30505986589475, -1035.4175283633967, -1318.6167435629995, -711.7362658387963, -346.49323592129804, -944.2159691495531, -928.2699950892145, -1148.4636641281797, -663.4611987570051, -636.3793045053874, -473.3235509606301, -435.9357358980649, -767.8210888354507, -532.2935255521796, -655.874142275029, -990.8854930969424, -667.1261032587109, -153.646465141887, -1002.6163722846953, -429.0545820995338]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6097263194798277, "mean_inference_ms": 1.8708696866210124, "mean_action_processing_ms": 0.30894210226528385, "mean_env_wait_ms": 3.3022536171622408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016173601150512695, "StateBufferConnector_ms": 0.010253429412841797, "ViewRequirementAgentConnector_ms": 0.300600528717041}, "num_episodes": 26, "episode_return_max": -1.0208369552596426, "episode_return_min": -1418.3573751449633, "episode_return_mean": -722.3323010975579, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 330.14634147877325, "num_env_steps_trained_throughput_per_sec": 330.14634147877325, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12709.486, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12709.403, "sample_time_ms": 1362.607, "learn_time_ms": 11267.006, "learn_throughput": 355.019, "synch_weights_time_ms": 78.863}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "92003_00011", "date": "2024-08-03_04-13-14", "timestamp": 1722638594, "time_this_iter_s": 12.128371715545654, "time_total_s": 280.23080134391785, "pid": 470944, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c708d30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 280.23080134391785, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 39.07058823529411, "ram_util_percent": 47.11176470588235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 230.77898791829745, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.6503390012929837, "policy_loss": -0.010508601106024192, "vf_loss": 3.657018187517921, "vf_explained_var": 0.9811393675704797, "kl": 0.017215974657604723, "entropy": 1.3353861842304469, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -21.916736632084493, "episode_reward_min": -1418.3573751449633, "episode_reward_mean": -697.9727218098054, "episode_len_mean": 136.95, "episode_media": {}, "episodes_timesteps_total": 13695, "policy_reward_min": {"policy_0": -1418.3573751449633}, "policy_reward_max": {"policy_0": -21.916736632084493}, "policy_reward_mean": {"policy_0": -697.9727218098054}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-941.8625743453539, -405.6190936721613, -643.9712799456977, -1223.5233347090214, -510.2908673788403, -1012.3773895668814, -106.48306947506734, -752.3033768545184, -21.916736632084493, -738.6377687982543, -364.1724375177945, -665.9416315938138, -571.4278111769199, -675.4724795175208, -868.0146851370481, -1196.1853829921397, -692.3140751044656, -204.53785366729667, -948.0253337416127, -895.1611645400932, -991.8346274595342, -1418.3573751449633, -1084.9747225408394, -534.3798328938153, -254.59083760943557, -1237.4555327390315, -737.299424304992, -375.7639121907841, -906.9072785223863, -1308.595565430234, -720.3006955511842, -314.15625754548313, -897.9184011532216, -490.7272515094932, -186.52755172631427, -1161.7685695501991, -1357.3274431460418, -1398.2885130079785, -806.6736954074262, -267.3816224019657, -943.7028825417196, -413.7191168474084, -1077.5485100444953, -1281.6943056558348, -1086.4735520931022, -206.97726905520568, -438.223863672545, -1076.223298537721, -446.30505986589475, -1035.4175283633967, -1318.6167435629995, -711.7362658387963, -346.49323592129804, -944.2159691495531, -928.2699950892145, -1148.4636641281797, -663.4611987570051, -636.3793045053874, -473.3235509606301, -435.9357358980649, -767.8210888354507, -532.2935255521796, -655.874142275029, -990.8854930969424, -667.1261032587109, -153.646465141887, -1002.6163722846953, -429.0545820995338, -607.2330775734947, -412.8500731316377, -129.37397299738814, -677.4756167284845, -690.4866958079833, -178.05366969352698, -788.4663405368854, -272.43417313980893, -1128.7808527739976, -118.6308670166784, -354.26980398445374, -1011.9192063522624, -521.5295064189851, -872.3368325712253, -479.82320787833453, -665.3370525601628, -716.6984583579941, -838.7554276764641, -1072.7560386192872, -123.40182837702602, -1001.9854849920689, -1196.0203786784896, -774.46179711246, -173.19024366554322, -782.0525839379912, -195.7884446674006, -93.74324143955462, -1172.9798879937296, -919.9273905033648, -78.76282814369817, -543.0616752803382, -502.7192431350352], "episode_lengths": [150, 150, 132, 150, 150, 150, 94, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 120, 150, 123, 94, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 136, 150, 150, 150, 66, 150, 150, 150, 150, 71, 150, 150, 96, 150, 95, 150, 98, 95, 150, 127, 150, 150, 150, 150, 150, 150, 65, 150, 150, 150, 108, 150, 65, 59, 150, 150, 63, 150, 150], "policy_policy_0_reward": [-941.8625743453539, -405.6190936721613, -643.9712799456977, -1223.5233347090214, -510.2908673788403, -1012.3773895668814, -106.48306947506734, -752.3033768545184, -21.916736632084493, -738.6377687982543, -364.1724375177945, -665.9416315938138, -571.4278111769199, -675.4724795175208, -868.0146851370481, -1196.1853829921397, -692.3140751044656, -204.53785366729667, -948.0253337416127, -895.1611645400932, -991.8346274595342, -1418.3573751449633, -1084.9747225408394, -534.3798328938153, -254.59083760943557, -1237.4555327390315, -737.299424304992, -375.7639121907841, -906.9072785223863, -1308.595565430234, -720.3006955511842, -314.15625754548313, -897.9184011532216, -490.7272515094932, -186.52755172631427, -1161.7685695501991, -1357.3274431460418, -1398.2885130079785, -806.6736954074262, -267.3816224019657, -943.7028825417196, -413.7191168474084, -1077.5485100444953, -1281.6943056558348, -1086.4735520931022, -206.97726905520568, -438.223863672545, -1076.223298537721, -446.30505986589475, -1035.4175283633967, -1318.6167435629995, -711.7362658387963, -346.49323592129804, -944.2159691495531, -928.2699950892145, -1148.4636641281797, -663.4611987570051, -636.3793045053874, -473.3235509606301, -435.9357358980649, -767.8210888354507, -532.2935255521796, -655.874142275029, -990.8854930969424, -667.1261032587109, -153.646465141887, -1002.6163722846953, -429.0545820995338, -607.2330775734947, -412.8500731316377, -129.37397299738814, -677.4756167284845, -690.4866958079833, -178.05366969352698, -788.4663405368854, -272.43417313980893, -1128.7808527739976, -118.6308670166784, -354.26980398445374, -1011.9192063522624, -521.5295064189851, -872.3368325712253, -479.82320787833453, -665.3370525601628, -716.6984583579941, -838.7554276764641, -1072.7560386192872, -123.40182837702602, -1001.9854849920689, -1196.0203786784896, -774.46179711246, -173.19024366554322, -782.0525839379912, -195.7884446674006, -93.74324143955462, -1172.9798879937296, -919.9273905033648, -78.76282814369817, -543.0616752803382, -502.7192431350352]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6109113089649735, "mean_inference_ms": 1.874448529148289, "mean_action_processing_ms": 0.3098567635522578, "mean_env_wait_ms": 3.311725866835504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012657642364501953, "StateBufferConnector_ms": 0.010170936584472656, "ViewRequirementAgentConnector_ms": 0.22467637062072754}, "num_episodes": 32, "episode_return_max": -21.916736632084493, "episode_return_min": -1418.3573751449633, "episode_return_mean": -697.9727218098054, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.38367138788055, "num_env_steps_trained_throughput_per_sec": 290.38367138788055, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12756.333, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12756.249, "sample_time_ms": 1386.374, "learn_time_ms": 11289.213, "learn_throughput": 354.321, "synch_weights_time_ms": 79.698}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "92003_00011", "date": "2024-08-03_04-13-27", "timestamp": 1722638607, "time_this_iter_s": 13.788245439529419, "time_total_s": 294.01904678344727, "pid": 470944, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c78f5b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 294.01904678344727, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 22.900000000000002, "ram_util_percent": 47.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 298.8160368800163, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.884519674628973, "policy_loss": -0.0059181014032219535, "vf_loss": 3.8872099680205188, "vf_explained_var": 0.980748766536514, "kl": 0.01612896906209853, "entropy": 1.6108777149269977, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -23.90191941452402, "episode_reward_min": -1398.2885130079785, "episode_reward_mean": -683.3866833224258, "episode_len_mean": 134.6, "episode_media": {}, "episodes_timesteps_total": 13460, "policy_reward_min": {"policy_0": -1398.2885130079785}, "policy_reward_max": {"policy_0": -23.90191941452402}, "policy_reward_mean": {"policy_0": -683.3866833224258}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1308.595565430234, -720.3006955511842, -314.15625754548313, -897.9184011532216, -490.7272515094932, -186.52755172631427, -1161.7685695501991, -1357.3274431460418, -1398.2885130079785, -806.6736954074262, -267.3816224019657, -943.7028825417196, -413.7191168474084, -1077.5485100444953, -1281.6943056558348, -1086.4735520931022, -206.97726905520568, -438.223863672545, -1076.223298537721, -446.30505986589475, -1035.4175283633967, -1318.6167435629995, -711.7362658387963, -346.49323592129804, -944.2159691495531, -928.2699950892145, -1148.4636641281797, -663.4611987570051, -636.3793045053874, -473.3235509606301, -435.9357358980649, -767.8210888354507, -532.2935255521796, -655.874142275029, -990.8854930969424, -667.1261032587109, -153.646465141887, -1002.6163722846953, -429.0545820995338, -607.2330775734947, -412.8500731316377, -129.37397299738814, -677.4756167284845, -690.4866958079833, -178.05366969352698, -788.4663405368854, -272.43417313980893, -1128.7808527739976, -118.6308670166784, -354.26980398445374, -1011.9192063522624, -521.5295064189851, -872.3368325712253, -479.82320787833453, -665.3370525601628, -716.6984583579941, -838.7554276764641, -1072.7560386192872, -123.40182837702602, -1001.9854849920689, -1196.0203786784896, -774.46179711246, -173.19024366554322, -782.0525839379912, -195.7884446674006, -93.74324143955462, -1172.9798879937296, -919.9273905033648, -78.76282814369817, -543.0616752803382, -502.7192431350352, -180.10555201113266, -127.8393872843668, -585.4321203034251, -857.682894363188, -949.9689385821742, -277.47182319610823, -959.5417578804273, -981.9929176930272, -23.90191941452402, -806.3732683204325, -701.3393106295617, -151.4935035511027, -436.34898577323827, -743.5430084125402, -747.4428284827634, -183.05204080978166, -203.2141298520296, -308.37169302114745, -961.6375442806064, -1084.8719323645826, -1203.8233339913868, -537.5456377730576, -1121.8578230348646, -385.40283872194516, -1155.836573127547, -1095.49574395239, -768.6327551180655, -1197.345279740986, -783.6324993480107], "episode_lengths": [150, 150, 120, 150, 123, 94, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 136, 150, 150, 150, 66, 150, 150, 150, 150, 71, 150, 150, 96, 150, 95, 150, 98, 95, 150, 127, 150, 150, 150, 150, 150, 150, 65, 150, 150, 150, 108, 150, 65, 59, 150, 150, 63, 150, 150, 78, 91, 150, 150, 150, 80, 150, 150, 48, 150, 150, 79, 150, 150, 150, 83, 121, 88, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1308.595565430234, -720.3006955511842, -314.15625754548313, -897.9184011532216, -490.7272515094932, -186.52755172631427, -1161.7685695501991, -1357.3274431460418, -1398.2885130079785, -806.6736954074262, -267.3816224019657, -943.7028825417196, -413.7191168474084, -1077.5485100444953, -1281.6943056558348, -1086.4735520931022, -206.97726905520568, -438.223863672545, -1076.223298537721, -446.30505986589475, -1035.4175283633967, -1318.6167435629995, -711.7362658387963, -346.49323592129804, -944.2159691495531, -928.2699950892145, -1148.4636641281797, -663.4611987570051, -636.3793045053874, -473.3235509606301, -435.9357358980649, -767.8210888354507, -532.2935255521796, -655.874142275029, -990.8854930969424, -667.1261032587109, -153.646465141887, -1002.6163722846953, -429.0545820995338, -607.2330775734947, -412.8500731316377, -129.37397299738814, -677.4756167284845, -690.4866958079833, -178.05366969352698, -788.4663405368854, -272.43417313980893, -1128.7808527739976, -118.6308670166784, -354.26980398445374, -1011.9192063522624, -521.5295064189851, -872.3368325712253, -479.82320787833453, -665.3370525601628, -716.6984583579941, -838.7554276764641, -1072.7560386192872, -123.40182837702602, -1001.9854849920689, -1196.0203786784896, -774.46179711246, -173.19024366554322, -782.0525839379912, -195.7884446674006, -93.74324143955462, -1172.9798879937296, -919.9273905033648, -78.76282814369817, -543.0616752803382, -502.7192431350352, -180.10555201113266, -127.8393872843668, -585.4321203034251, -857.682894363188, -949.9689385821742, -277.47182319610823, -959.5417578804273, -981.9929176930272, -23.90191941452402, -806.3732683204325, -701.3393106295617, -151.4935035511027, -436.34898577323827, -743.5430084125402, -747.4428284827634, -183.05204080978166, -203.2141298520296, -308.37169302114745, -961.6375442806064, -1084.8719323645826, -1203.8233339913868, -537.5456377730576, -1121.8578230348646, -385.40283872194516, -1155.836573127547, -1095.49574395239, -768.6327551180655, -1197.345279740986, -783.6324993480107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6144175369559478, "mean_inference_ms": 1.8889684842699401, "mean_action_processing_ms": 0.3116467018886632, "mean_env_wait_ms": 3.3350957510932733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018712759017944336, "StateBufferConnector_ms": 0.014191150665283203, "ViewRequirementAgentConnector_ms": 0.23658418655395508}, "num_episodes": 29, "episode_return_max": -23.90191941452402, "episode_return_min": -1398.2885130079785, "episode_return_mean": -683.3866833224258, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 285.713614251294, "num_env_steps_trained_throughput_per_sec": 285.713614251294, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12827.692, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12827.614, "sample_time_ms": 1501.419, "learn_time_ms": 11245.352, "learn_throughput": 355.703, "synch_weights_time_ms": 79.877}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "92003_00011", "date": "2024-08-03_04-13-41", "timestamp": 1722638621, "time_this_iter_s": 14.013570070266724, "time_total_s": 308.032616853714, "pid": 470944, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c78c280>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 308.032616853714, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 35.095, "ram_util_percent": 47.18500000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 285.6554982542992, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.5819710053503515, "policy_loss": -0.011343032545604122, "vf_loss": 3.590125174820423, "vf_explained_var": 0.9857045507058502, "kl": 0.016292502580885562, "entropy": 1.6988930510977904, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -23.90191941452402, "episode_reward_min": -1551.0560186800858, "episode_reward_mean": -665.0780153458027, "episode_len_mean": 133.4, "episode_media": {}, "episodes_timesteps_total": 13340, "policy_reward_min": {"policy_0": -1551.0560186800858}, "policy_reward_max": {"policy_0": -23.90191941452402}, "policy_reward_mean": {"policy_0": -665.0780153458027}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-636.3793045053874, -473.3235509606301, -435.9357358980649, -767.8210888354507, -532.2935255521796, -655.874142275029, -990.8854930969424, -667.1261032587109, -153.646465141887, -1002.6163722846953, -429.0545820995338, -607.2330775734947, -412.8500731316377, -129.37397299738814, -677.4756167284845, -690.4866958079833, -178.05366969352698, -788.4663405368854, -272.43417313980893, -1128.7808527739976, -118.6308670166784, -354.26980398445374, -1011.9192063522624, -521.5295064189851, -872.3368325712253, -479.82320787833453, -665.3370525601628, -716.6984583579941, -838.7554276764641, -1072.7560386192872, -123.40182837702602, -1001.9854849920689, -1196.0203786784896, -774.46179711246, -173.19024366554322, -782.0525839379912, -195.7884446674006, -93.74324143955462, -1172.9798879937296, -919.9273905033648, -78.76282814369817, -543.0616752803382, -502.7192431350352, -180.10555201113266, -127.8393872843668, -585.4321203034251, -857.682894363188, -949.9689385821742, -277.47182319610823, -959.5417578804273, -981.9929176930272, -23.90191941452402, -806.3732683204325, -701.3393106295617, -151.4935035511027, -436.34898577323827, -743.5430084125402, -747.4428284827634, -183.05204080978166, -203.2141298520296, -308.37169302114745, -961.6375442806064, -1084.8719323645826, -1203.8233339913868, -537.5456377730576, -1121.8578230348646, -385.40283872194516, -1155.836573127547, -1095.49574395239, -768.6327551180655, -1197.345279740986, -783.6324993480107, -890.9775097816974, -953.4316941979557, -1040.6049559890948, -1236.6733926282768, -805.4695714637242, -1281.8417562308673, -490.1434173386366, -1237.7903241577908, -877.0606810658231, -429.41684585786567, -328.77757842435847, -940.7315381003198, -517.9964015869177, -1101.222261351764, -682.3927234914303, -41.825884060236625, -1034.8679675646622, -826.8571608045746, -610.2875583867465, -1551.0560186800858, -553.5600025699367, -146.3864110189663, -204.77502962026554, -506.92689959539086, -707.887427411425, -859.8701806513116, -827.8416731422894, -459.6683627191609], "episode_lengths": [150, 150, 149, 150, 136, 150, 150, 150, 66, 150, 150, 150, 150, 71, 150, 150, 96, 150, 95, 150, 98, 95, 150, 127, 150, 150, 150, 150, 150, 150, 65, 150, 150, 150, 108, 150, 65, 59, 150, 150, 63, 150, 150, 78, 91, 150, 150, 150, 80, 150, 150, 48, 150, 150, 79, 150, 150, 150, 83, 121, 88, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 112, 150, 150, 104, 150, 150, 150, 150, 150, 62, 150, 150, 131, 150, 150, 97, 73, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-636.3793045053874, -473.3235509606301, -435.9357358980649, -767.8210888354507, -532.2935255521796, -655.874142275029, -990.8854930969424, -667.1261032587109, -153.646465141887, -1002.6163722846953, -429.0545820995338, -607.2330775734947, -412.8500731316377, -129.37397299738814, -677.4756167284845, -690.4866958079833, -178.05366969352698, -788.4663405368854, -272.43417313980893, -1128.7808527739976, -118.6308670166784, -354.26980398445374, -1011.9192063522624, -521.5295064189851, -872.3368325712253, -479.82320787833453, -665.3370525601628, -716.6984583579941, -838.7554276764641, -1072.7560386192872, -123.40182837702602, -1001.9854849920689, -1196.0203786784896, -774.46179711246, -173.19024366554322, -782.0525839379912, -195.7884446674006, -93.74324143955462, -1172.9798879937296, -919.9273905033648, -78.76282814369817, -543.0616752803382, -502.7192431350352, -180.10555201113266, -127.8393872843668, -585.4321203034251, -857.682894363188, -949.9689385821742, -277.47182319610823, -959.5417578804273, -981.9929176930272, -23.90191941452402, -806.3732683204325, -701.3393106295617, -151.4935035511027, -436.34898577323827, -743.5430084125402, -747.4428284827634, -183.05204080978166, -203.2141298520296, -308.37169302114745, -961.6375442806064, -1084.8719323645826, -1203.8233339913868, -537.5456377730576, -1121.8578230348646, -385.40283872194516, -1155.836573127547, -1095.49574395239, -768.6327551180655, -1197.345279740986, -783.6324993480107, -890.9775097816974, -953.4316941979557, -1040.6049559890948, -1236.6733926282768, -805.4695714637242, -1281.8417562308673, -490.1434173386366, -1237.7903241577908, -877.0606810658231, -429.41684585786567, -328.77757842435847, -940.7315381003198, -517.9964015869177, -1101.222261351764, -682.3927234914303, -41.825884060236625, -1034.8679675646622, -826.8571608045746, -610.2875583867465, -1551.0560186800858, -553.5600025699367, -146.3864110189663, -204.77502962026554, -506.92689959539086, -707.887427411425, -859.8701806513116, -827.8416731422894, -459.6683627191609]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6173800468072413, "mean_inference_ms": 1.8964982654878424, "mean_action_processing_ms": 0.3128948230338211, "mean_env_wait_ms": 3.348664354599238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018604040145874023, "StateBufferConnector_ms": 0.019398212432861328, "ViewRequirementAgentConnector_ms": 0.24115514755249023}, "num_episodes": 28, "episode_return_max": -23.90191941452402, "episode_return_min": -1551.0560186800858, "episode_return_mean": -665.0780153458027, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.31381636772244, "num_env_steps_trained_throughput_per_sec": 304.31381636772244, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12820.887, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12820.809, "sample_time_ms": 1518.921, "learn_time_ms": 11219.305, "learn_throughput": 356.528, "synch_weights_time_ms": 81.579}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "92003_00011", "date": "2024-08-03_04-13-55", "timestamp": 1722638635, "time_this_iter_s": 13.156436681747437, "time_total_s": 321.1890535354614, "pid": 470944, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c78fd90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 321.1890535354614, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 22.715789473684207, "ram_util_percent": 47.20000000000001}}
