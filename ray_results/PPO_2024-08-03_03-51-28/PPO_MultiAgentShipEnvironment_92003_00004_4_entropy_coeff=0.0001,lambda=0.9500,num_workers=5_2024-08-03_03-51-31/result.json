{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2669377690181136, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.483831544717154, "policy_loss": -0.0054405019870804, "vf_loss": 9.487503447135289, "vf_explained_var": 0.054737706171969575, "kl": 0.009556901511897802, "entropy": 1.4276479163517555, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -12.203318796790562, "episode_reward_min": -1201.6181074892002, "episode_reward_mean": -583.978562963379, "episode_len_mean": 124.0, "episode_media": {}, "episodes_timesteps_total": 3596, "policy_reward_min": {"policy_0": -1201.6181074892002}, "policy_reward_max": {"policy_0": -12.203318796790562}, "policy_reward_mean": {"policy_0": -583.978562963379}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-771.8476833987711, -1201.6181074892002, -995.1662526670365, -204.42640041248174, -376.6492180868739, -155.58988073506475, -799.3632947418862, -506.786038872133, -1084.0279888910488, -100.37515612187048, -685.0361669337867, -476.4394663932733, -740.5970258602468, -707.5256206225985, -201.40153541547957, -888.7803706198083, -74.05590300555312, -473.10208297457285, -12.203318796790562, -489.64353968750214, -1137.8460964072328, -787.2509203768302, -659.6666777475433, -52.44041777863087, -134.81549524107405, -585.7539501916427, -856.4571104607472, -939.4944907773809, -837.018115230926], "episode_lengths": [150, 150, 150, 73, 101, 90, 150, 120, 150, 63, 150, 150, 150, 140, 64, 150, 74, 127, 48, 150, 150, 150, 142, 65, 90, 149, 150, 150, 150], "policy_policy_0_reward": [-771.8476833987711, -1201.6181074892002, -995.1662526670365, -204.42640041248174, -376.6492180868739, -155.58988073506475, -799.3632947418862, -506.786038872133, -1084.0279888910488, -100.37515612187048, -685.0361669337867, -476.4394663932733, -740.5970258602468, -707.5256206225985, -201.40153541547957, -888.7803706198083, -74.05590300555312, -473.10208297457285, -12.203318796790562, -489.64353968750214, -1137.8460964072328, -787.2509203768302, -659.6666777475433, -52.44041777863087, -134.81549524107405, -585.7539501916427, -856.4571104607472, -939.4944907773809, -837.018115230926]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28183484971433476, "mean_inference_ms": 0.8730147933779315, "mean_action_processing_ms": 0.1608225536580451, "mean_env_wait_ms": 1.5283864017318904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005605303007980873, "StateBufferConnector_ms": 0.004378680525154903, "ViewRequirementAgentConnector_ms": 0.09428632670435412}, "num_episodes": 29, "episode_return_max": -12.203318796790562, "episode_return_min": -1201.6181074892002, "episode_return_mean": -583.978562963379, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 283.0087110973883, "num_env_steps_trained_throughput_per_sec": 283.0087110973883, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 14133.85, "restore_workers_time_ms": 0.02, "training_step_time_ms": 14133.794, "sample_time_ms": 2340.937, "learn_time_ms": 11777.505, "learn_throughput": 339.631, "synch_weights_time_ms": 14.604}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "92003_00004", "date": "2024-08-03_04-44-27", "timestamp": 1722640467, "time_this_iter_s": 14.139436721801758, "time_total_s": 14.139436721801758, "pid": 480833, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c70a950>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14.139436721801758, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 12.04761904761905, "ram_util_percent": 16.14285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8547966475288074, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.417610683043797, "policy_loss": -0.006403872653997193, "vf_loss": 9.42153432269891, "vf_explained_var": 0.1900322161614895, "kl": 0.013120660196712682, "entropy": 1.4389060265074174, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -12.203318796790562, "episode_reward_min": -1201.6181074892002, "episode_reward_mean": -603.9341963987457, "episode_len_mean": 126.81967213114754, "episode_media": {}, "episodes_timesteps_total": 7736, "policy_reward_min": {"policy_0": -1201.6181074892002}, "policy_reward_max": {"policy_0": -12.203318796790562}, "policy_reward_mean": {"policy_0": -603.9341963987457}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-771.8476833987711, -1201.6181074892002, -995.1662526670365, -204.42640041248174, -376.6492180868739, -155.58988073506475, -799.3632947418862, -506.786038872133, -1084.0279888910488, -100.37515612187048, -685.0361669337867, -476.4394663932733, -740.5970258602468, -707.5256206225985, -201.40153541547957, -888.7803706198083, -74.05590300555312, -473.10208297457285, -12.203318796790562, -489.64353968750214, -1137.8460964072328, -787.2509203768302, -659.6666777475433, -52.44041777863087, -134.81549524107405, -585.7539501916427, -856.4571104607472, -939.4944907773809, -837.018115230926, -718.9295737732504, -520.7991837140007, -907.7705616986389, -1019.3115137075898, -151.65547087325467, -995.6992635855879, -836.5911834184354, -307.2921333514384, -920.4351552860671, -237.05273273997386, -303.7014487954658, -691.5209461198556, -262.622384954821, -589.2953512756023, -791.6192758185088, -21.16815940321246, -1144.9291226696423, -466.0969562618894, -803.2486145960356, -747.3621844796963, -635.0468679563414, -560.6616046401883, -1073.8404428577521, -395.01806034104436, -757.791829324112, -748.8558638586611, -39.296987553078516, -1035.0230811047722, -541.3985631290399, -935.0712736029011, -26.925621632993057, -718.5762418616432], "episode_lengths": [150, 150, 150, 73, 101, 90, 150, 120, 150, 63, 150, 150, 150, 140, 64, 150, 74, 127, 48, 150, 150, 150, 142, 65, 90, 149, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 90, 150, 90, 102, 150, 74, 130, 150, 39, 150, 150, 150, 150, 150, 150, 150, 120, 150, 150, 67, 150, 150, 150, 48, 150], "policy_policy_0_reward": [-771.8476833987711, -1201.6181074892002, -995.1662526670365, -204.42640041248174, -376.6492180868739, -155.58988073506475, -799.3632947418862, -506.786038872133, -1084.0279888910488, -100.37515612187048, -685.0361669337867, -476.4394663932733, -740.5970258602468, -707.5256206225985, -201.40153541547957, -888.7803706198083, -74.05590300555312, -473.10208297457285, -12.203318796790562, -489.64353968750214, -1137.8460964072328, -787.2509203768302, -659.6666777475433, -52.44041777863087, -134.81549524107405, -585.7539501916427, -856.4571104607472, -939.4944907773809, -837.018115230926, -718.9295737732504, -520.7991837140007, -907.7705616986389, -1019.3115137075898, -151.65547087325467, -995.6992635855879, -836.5911834184354, -307.2921333514384, -920.4351552860671, -237.05273273997386, -303.7014487954658, -691.5209461198556, -262.622384954821, -589.2953512756023, -791.6192758185088, -21.16815940321246, -1144.9291226696423, -466.0969562618894, -803.2486145960356, -747.3621844796963, -635.0468679563414, -560.6616046401883, -1073.8404428577521, -395.01806034104436, -757.791829324112, -748.8558638586611, -39.296987553078516, -1035.0230811047722, -541.3985631290399, -935.0712736029011, -26.925621632993057, -718.5762418616432]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28109856142337614, "mean_inference_ms": 0.8743182348950442, "mean_action_processing_ms": 0.16058561533216717, "mean_env_wait_ms": 1.5296804986873416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0055512443917696596, "StateBufferConnector_ms": 0.004339999839907787, "ViewRequirementAgentConnector_ms": 0.09707583755743308}, "num_episodes": 32, "episode_return_max": -12.203318796790562, "episode_return_min": -1201.6181074892002, "episode_return_mean": -603.9341963987457, "episodes_this_iter": 32}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 280.67822710810526, "num_env_steps_trained_throughput_per_sec": 280.67822710810526, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 14192.528, "restore_workers_time_ms": 0.021, "training_step_time_ms": 14192.469, "sample_time_ms": 2366.522, "learn_time_ms": 11810.152, "learn_throughput": 338.692, "synch_weights_time_ms": 15.052}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "92003_00004", "date": "2024-08-03_04-44-42", "timestamp": 1722640482, "time_this_iter_s": 14.258245944976807, "time_total_s": 28.397682666778564, "pid": 480833, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c787400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 28.397682666778564, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 12.709999999999999, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9523182773341734, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.245478825767835, "policy_loss": -0.010793976195661041, "vf_loss": 9.253837636113166, "vf_explained_var": 0.15263378688444693, "kl": 0.012893464405351555, "entropy": 1.4357318967580794, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -12.203318796790562, "episode_reward_min": -1201.6181074892002, "episode_reward_mean": -627.2043224686138, "episode_len_mean": 131.5568181818182, "episode_media": {}, "episodes_timesteps_total": 11577, "policy_reward_min": {"policy_0": -1201.6181074892002}, "policy_reward_max": {"policy_0": -12.203318796790562}, "policy_reward_mean": {"policy_0": -627.2043224686138}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-771.8476833987711, -1201.6181074892002, -995.1662526670365, -204.42640041248174, -376.6492180868739, -155.58988073506475, -799.3632947418862, -506.786038872133, -1084.0279888910488, -100.37515612187048, -685.0361669337867, -476.4394663932733, -740.5970258602468, -707.5256206225985, -201.40153541547957, -888.7803706198083, -74.05590300555312, -473.10208297457285, -12.203318796790562, -489.64353968750214, -1137.8460964072328, -787.2509203768302, -659.6666777475433, -52.44041777863087, -134.81549524107405, -585.7539501916427, -856.4571104607472, -939.4944907773809, -837.018115230926, -718.9295737732504, -520.7991837140007, -907.7705616986389, -1019.3115137075898, -151.65547087325467, -995.6992635855879, -836.5911834184354, -307.2921333514384, -920.4351552860671, -237.05273273997386, -303.7014487954658, -691.5209461198556, -262.622384954821, -589.2953512756023, -791.6192758185088, -21.16815940321246, -1144.9291226696423, -466.0969562618894, -803.2486145960356, -747.3621844796963, -635.0468679563414, -560.6616046401883, -1073.8404428577521, -395.01806034104436, -757.791829324112, -748.8558638586611, -39.296987553078516, -1035.0230811047722, -541.3985631290399, -935.0712736029011, -26.925621632993057, -718.5762418616432, -906.2400877492045, -489.5042086314934, -164.59352032047403, -737.2569628350246, -414.39570959834714, -1051.6161834686484, -763.1290470662098, -955.5596494924743, -445.835785987917, -1108.0705893269874, -85.61057636996713, -668.7900109691709, -755.8673209243327, -1106.2595680054126, -647.9385413357558, -609.872206311776, -828.5862504439535, -1080.2618023377165, -585.315594727283, -495.1570897153189, -644.3902777635557, -927.4448843648198, -581.1406306905473, -626.2531349918552, -596.7290358058078, -815.6297155447808, -262.54601213569396], "episode_lengths": [150, 150, 150, 73, 101, 90, 150, 120, 150, 63, 150, 150, 150, 140, 64, 150, 74, 127, 48, 150, 150, 150, 142, 65, 90, 149, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 90, 150, 90, 102, 150, 74, 130, 150, 39, 150, 150, 150, 150, 150, 150, 150, 120, 150, 150, 67, 150, 150, 150, 48, 150, 150, 150, 71, 150, 150, 150, 150, 150, 112, 150, 71, 150, 150, 150, 150, 150, 150, 150, 137, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-771.8476833987711, -1201.6181074892002, -995.1662526670365, -204.42640041248174, -376.6492180868739, -155.58988073506475, -799.3632947418862, -506.786038872133, -1084.0279888910488, -100.37515612187048, -685.0361669337867, -476.4394663932733, -740.5970258602468, -707.5256206225985, -201.40153541547957, -888.7803706198083, -74.05590300555312, -473.10208297457285, -12.203318796790562, -489.64353968750214, -1137.8460964072328, -787.2509203768302, -659.6666777475433, -52.44041777863087, -134.81549524107405, -585.7539501916427, -856.4571104607472, -939.4944907773809, -837.018115230926, -718.9295737732504, -520.7991837140007, -907.7705616986389, -1019.3115137075898, -151.65547087325467, -995.6992635855879, -836.5911834184354, -307.2921333514384, -920.4351552860671, -237.05273273997386, -303.7014487954658, -691.5209461198556, -262.622384954821, -589.2953512756023, -791.6192758185088, -21.16815940321246, -1144.9291226696423, -466.0969562618894, -803.2486145960356, -747.3621844796963, -635.0468679563414, -560.6616046401883, -1073.8404428577521, -395.01806034104436, -757.791829324112, -748.8558638586611, -39.296987553078516, -1035.0230811047722, -541.3985631290399, -935.0712736029011, -26.925621632993057, -718.5762418616432, -906.2400877492045, -489.5042086314934, -164.59352032047403, -737.2569628350246, -414.39570959834714, -1051.6161834686484, -763.1290470662098, -955.5596494924743, -445.835785987917, -1108.0705893269874, -85.61057636996713, -668.7900109691709, -755.8673209243327, -1106.2595680054126, -647.9385413357558, -609.872206311776, -828.5862504439535, -1080.2618023377165, -585.315594727283, -495.1570897153189, -644.3902777635557, -927.4448843648198, -581.1406306905473, -626.2531349918552, -596.7290358058078, -815.6297155447808, -262.54601213569396]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28050244487991766, "mean_inference_ms": 0.8749087301806608, "mean_action_processing_ms": 0.16027826414081447, "mean_env_wait_ms": 1.5281446734008652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005407225001942028, "StateBufferConnector_ms": 0.004196437922391025, "ViewRequirementAgentConnector_ms": 0.09606426412409003}, "num_episodes": 27, "episode_return_max": -12.203318796790562, "episode_return_min": -1201.6181074892002, "episode_return_mean": -627.2043224686138, "episodes_this_iter": 27}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 282.70180587292003, "num_env_steps_trained_throughput_per_sec": 282.70180587292003, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 14178.085, "restore_workers_time_ms": 0.021, "training_step_time_ms": 14178.024, "sample_time_ms": 2348.114, "learn_time_ms": 11814.414, "learn_throughput": 338.569, "synch_weights_time_ms": 14.77}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "92003_00004", "date": "2024-08-03_04-44-56", "timestamp": 1722640496, "time_this_iter_s": 14.157025575637817, "time_total_s": 42.55470824241638, "pid": 480833, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b32765b40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 42.55470824241638, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 12.72, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.867284827741484, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.460312867164612, "policy_loss": -0.012395186395345566, "vf_loss": 8.469291311502456, "vf_explained_var": 0.5022626289476951, "kl": 0.01781153847368842, "entropy": 1.4556311866889398, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -12.203318796790562, "episode_reward_min": -1144.9291226696423, "episode_reward_mean": -655.7298479411751, "episode_len_mean": 135.04, "episode_media": {}, "episodes_timesteps_total": 13504, "policy_reward_min": {"policy_0": -1144.9291226696423}, "policy_reward_max": {"policy_0": -12.203318796790562}, "policy_reward_mean": {"policy_0": -655.7298479411751}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.203318796790562, -489.64353968750214, -1137.8460964072328, -787.2509203768302, -659.6666777475433, -52.44041777863087, -134.81549524107405, -585.7539501916427, -856.4571104607472, -939.4944907773809, -837.018115230926, -718.9295737732504, -520.7991837140007, -907.7705616986389, -1019.3115137075898, -151.65547087325467, -995.6992635855879, -836.5911834184354, -307.2921333514384, -920.4351552860671, -237.05273273997386, -303.7014487954658, -691.5209461198556, -262.622384954821, -589.2953512756023, -791.6192758185088, -21.16815940321246, -1144.9291226696423, -466.0969562618894, -803.2486145960356, -747.3621844796963, -635.0468679563414, -560.6616046401883, -1073.8404428577521, -395.01806034104436, -757.791829324112, -748.8558638586611, -39.296987553078516, -1035.0230811047722, -541.3985631290399, -935.0712736029011, -26.925621632993057, -718.5762418616432, -906.2400877492045, -489.5042086314934, -164.59352032047403, -737.2569628350246, -414.39570959834714, -1051.6161834686484, -763.1290470662098, -955.5596494924743, -445.835785987917, -1108.0705893269874, -85.61057636996713, -668.7900109691709, -755.8673209243327, -1106.2595680054126, -647.9385413357558, -609.872206311776, -828.5862504439535, -1080.2618023377165, -585.315594727283, -495.1570897153189, -644.3902777635557, -927.4448843648198, -581.1406306905473, -626.2531349918552, -596.7290358058078, -815.6297155447808, -262.54601213569396, -877.0797034360581, -776.636801352222, -266.8254708572879, -856.0680883447872, -1032.2207429014993, -388.3296163859671, -619.8710058730035, -905.3605662168505, -751.5120306862106, -257.15039231104976, -1105.8664828695976, -772.5949847211197, -94.19815982647218, -927.007309401901, -39.46325861585001, -644.0936277128703, -1071.005949597829, -624.2291819137578, -580.4292319843407, -423.783132968921, -605.238210592518, -895.4015062407565, -1081.4763823330616, -988.8393735768702, -1066.3285575621323, -783.2959531469553, -270.1961795043592, -851.0927293355954, -545.8142757268661, -720.383704124477], "episode_lengths": [48, 150, 150, 150, 142, 65, 90, 149, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 90, 150, 90, 102, 150, 74, 130, 150, 39, 150, 150, 150, 150, 150, 150, 150, 120, 150, 150, 67, 150, 150, 150, 48, 150, 150, 150, 71, 150, 150, 150, 150, 150, 112, 150, 71, 150, 150, 150, 150, 150, 150, 150, 137, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 109, 150, 150, 113, 150, 150, 150, 79, 150, 150, 55, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 150], "policy_policy_0_reward": [-12.203318796790562, -489.64353968750214, -1137.8460964072328, -787.2509203768302, -659.6666777475433, -52.44041777863087, -134.81549524107405, -585.7539501916427, -856.4571104607472, -939.4944907773809, -837.018115230926, -718.9295737732504, -520.7991837140007, -907.7705616986389, -1019.3115137075898, -151.65547087325467, -995.6992635855879, -836.5911834184354, -307.2921333514384, -920.4351552860671, -237.05273273997386, -303.7014487954658, -691.5209461198556, -262.622384954821, -589.2953512756023, -791.6192758185088, -21.16815940321246, -1144.9291226696423, -466.0969562618894, -803.2486145960356, -747.3621844796963, -635.0468679563414, -560.6616046401883, -1073.8404428577521, -395.01806034104436, -757.791829324112, -748.8558638586611, -39.296987553078516, -1035.0230811047722, -541.3985631290399, -935.0712736029011, -26.925621632993057, -718.5762418616432, -906.2400877492045, -489.5042086314934, -164.59352032047403, -737.2569628350246, -414.39570959834714, -1051.6161834686484, -763.1290470662098, -955.5596494924743, -445.835785987917, -1108.0705893269874, -85.61057636996713, -668.7900109691709, -755.8673209243327, -1106.2595680054126, -647.9385413357558, -609.872206311776, -828.5862504439535, -1080.2618023377165, -585.315594727283, -495.1570897153189, -644.3902777635557, -927.4448843648198, -581.1406306905473, -626.2531349918552, -596.7290358058078, -815.6297155447808, -262.54601213569396, -877.0797034360581, -776.636801352222, -266.8254708572879, -856.0680883447872, -1032.2207429014993, -388.3296163859671, -619.8710058730035, -905.3605662168505, -751.5120306862106, -257.15039231104976, -1105.8664828695976, -772.5949847211197, -94.19815982647218, -927.007309401901, -39.46325861585001, -644.0936277128703, -1071.005949597829, -624.2291819137578, -580.4292319843407, -423.783132968921, -605.238210592518, -895.4015062407565, -1081.4763823330616, -988.8393735768702, -1066.3285575621323, -783.2959531469553, -270.1961795043592, -851.0927293355954, -545.8142757268661, -720.383704124477]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27994808936576515, "mean_inference_ms": 0.8761551080792529, "mean_action_processing_ms": 0.1601089748687034, "mean_env_wait_ms": 1.5319638803487907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005425691604614258, "StateBufferConnector_ms": 0.004099845886230469, "ViewRequirementAgentConnector_ms": 0.09674549102783203}, "num_episodes": 30, "episode_return_max": -12.203318796790562, "episode_return_min": -1144.9291226696423, "episode_return_mean": -655.7298479411751, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 275.8861295113223, "num_env_steps_trained_throughput_per_sec": 275.8861295113223, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 14258.25, "restore_workers_time_ms": 0.021, "training_step_time_ms": 14258.19, "sample_time_ms": 2343.911, "learn_time_ms": 11898.743, "learn_throughput": 336.17, "synch_weights_time_ms": 14.814}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "92003_00004", "date": "2024-08-03_04-45-11", "timestamp": 1722640511, "time_this_iter_s": 14.506589889526367, "time_total_s": 57.06129813194275, "pid": 480833, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b32766440>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 57.06129813194275, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 12.585714285714285, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.503859764213363, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.571067580580712, "policy_loss": -0.012446161576857169, "vf_loss": 7.580607857803503, "vf_explained_var": 0.6137401638552547, "kl": 0.015255343984517828, "entropy": 1.4519162078698475, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -26.058194975743458, "episode_reward_min": -1201.8869269939912, "episode_reward_mean": -665.3127086827164, "episode_len_mean": 136.86, "episode_media": {}, "episodes_timesteps_total": 13686, "policy_reward_min": {"policy_0": -1201.8869269939912}, "policy_reward_max": {"policy_0": -26.058194975743458}, "policy_reward_mean": {"policy_0": -665.3127086827164}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-747.3621844796963, -635.0468679563414, -560.6616046401883, -1073.8404428577521, -395.01806034104436, -757.791829324112, -748.8558638586611, -39.296987553078516, -1035.0230811047722, -541.3985631290399, -935.0712736029011, -26.925621632993057, -718.5762418616432, -906.2400877492045, -489.5042086314934, -164.59352032047403, -737.2569628350246, -414.39570959834714, -1051.6161834686484, -763.1290470662098, -955.5596494924743, -445.835785987917, -1108.0705893269874, -85.61057636996713, -668.7900109691709, -755.8673209243327, -1106.2595680054126, -647.9385413357558, -609.872206311776, -828.5862504439535, -1080.2618023377165, -585.315594727283, -495.1570897153189, -644.3902777635557, -927.4448843648198, -581.1406306905473, -626.2531349918552, -596.7290358058078, -815.6297155447808, -262.54601213569396, -877.0797034360581, -776.636801352222, -266.8254708572879, -856.0680883447872, -1032.2207429014993, -388.3296163859671, -619.8710058730035, -905.3605662168505, -751.5120306862106, -257.15039231104976, -1105.8664828695976, -772.5949847211197, -94.19815982647218, -927.007309401901, -39.46325861585001, -644.0936277128703, -1071.005949597829, -624.2291819137578, -580.4292319843407, -423.783132968921, -605.238210592518, -895.4015062407565, -1081.4763823330616, -988.8393735768702, -1066.3285575621323, -783.2959531469553, -270.1961795043592, -851.0927293355954, -545.8142757268661, -720.383704124477, -864.4852504546741, -954.6589156202285, -176.26069573241617, -960.8708658597708, -1093.8887305788355, -795.034856866609, -635.8180617051817, -241.24535160392398, -472.2962747953784, -422.26550822498217, -701.9314171301194, -206.95625064204248, -1176.9456253568273, -55.58530898712308, -486.61621787158475, -830.3405445813672, -894.6820992276964, -540.771554183317, -26.058194975743458, -719.3982626061972, -888.8745801619765, -155.14099891702077, -1071.4181408648888, -704.3085456142684, -68.34951499953434, -561.2013532400325, -633.8726246685736, -1201.8869269939912, -593.8025748517906, -1005.6499915776199], "episode_lengths": [150, 150, 150, 150, 120, 150, 150, 67, 150, 150, 150, 48, 150, 150, 150, 71, 150, 150, 150, 150, 150, 112, 150, 71, 150, 150, 150, 150, 150, 150, 150, 137, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 109, 150, 150, 113, 150, 150, 150, 79, 150, 150, 55, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 143, 150, 150, 91, 150, 55, 114, 150, 150, 150, 58, 150, 150, 65, 150, 150, 69, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-747.3621844796963, -635.0468679563414, -560.6616046401883, -1073.8404428577521, -395.01806034104436, -757.791829324112, -748.8558638586611, -39.296987553078516, -1035.0230811047722, -541.3985631290399, -935.0712736029011, -26.925621632993057, -718.5762418616432, -906.2400877492045, -489.5042086314934, -164.59352032047403, -737.2569628350246, -414.39570959834714, -1051.6161834686484, -763.1290470662098, -955.5596494924743, -445.835785987917, -1108.0705893269874, -85.61057636996713, -668.7900109691709, -755.8673209243327, -1106.2595680054126, -647.9385413357558, -609.872206311776, -828.5862504439535, -1080.2618023377165, -585.315594727283, -495.1570897153189, -644.3902777635557, -927.4448843648198, -581.1406306905473, -626.2531349918552, -596.7290358058078, -815.6297155447808, -262.54601213569396, -877.0797034360581, -776.636801352222, -266.8254708572879, -856.0680883447872, -1032.2207429014993, -388.3296163859671, -619.8710058730035, -905.3605662168505, -751.5120306862106, -257.15039231104976, -1105.8664828695976, -772.5949847211197, -94.19815982647218, -927.007309401901, -39.46325861585001, -644.0936277128703, -1071.005949597829, -624.2291819137578, -580.4292319843407, -423.783132968921, -605.238210592518, -895.4015062407565, -1081.4763823330616, -988.8393735768702, -1066.3285575621323, -783.2959531469553, -270.1961795043592, -851.0927293355954, -545.8142757268661, -720.383704124477, -864.4852504546741, -954.6589156202285, -176.26069573241617, -960.8708658597708, -1093.8887305788355, -795.034856866609, -635.8180617051817, -241.24535160392398, -472.2962747953784, -422.26550822498217, -701.9314171301194, -206.95625064204248, -1176.9456253568273, -55.58530898712308, -486.61621787158475, -830.3405445813672, -894.6820992276964, -540.771554183317, -26.058194975743458, -719.3982626061972, -888.8745801619765, -155.14099891702077, -1071.4181408648888, -704.3085456142684, -68.34951499953434, -561.2013532400325, -633.8726246685736, -1201.8869269939912, -593.8025748517906, -1005.6499915776199]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27937246604573557, "mean_inference_ms": 0.8756894484377463, "mean_action_processing_ms": 0.15959893067843856, "mean_env_wait_ms": 1.529650153099758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005263566970825195, "StateBufferConnector_ms": 0.004015207290649414, "ViewRequirementAgentConnector_ms": 0.09777665138244629}, "num_episodes": 30, "episode_return_max": -26.058194975743458, "episode_return_min": -1201.8869269939912, "episode_return_mean": -665.3127086827164, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 280.3182684991719, "num_env_steps_trained_throughput_per_sec": 280.3182684991719, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 14260.502, "restore_workers_time_ms": 0.021, "training_step_time_ms": 14260.442, "sample_time_ms": 2344.376, "learn_time_ms": 11900.732, "learn_throughput": 336.114, "synch_weights_time_ms": 14.597}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "92003_00004", "date": "2024-08-03_04-45-25", "timestamp": 1722640525, "time_this_iter_s": 14.27639889717102, "time_total_s": 71.33769702911377, "pid": 480833, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b327671c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 71.33769702911377, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 12.650000000000002, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 37.642765536904335, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.272628932197889, "policy_loss": -0.016710189342848025, "vf_loss": 7.285766033828258, "vf_explained_var": 0.7806218195085725, "kl": 0.01856767701162123, "entropy": 1.4046058693279824, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -16.124850503737537, "episode_reward_min": -1201.8869269939912, "episode_reward_mean": -662.5169450415747, "episode_len_mean": 137.13, "episode_media": {}, "episodes_timesteps_total": 13713, "policy_reward_min": {"policy_0": -1201.8869269939912}, "policy_reward_max": {"policy_0": -16.124850503737537}, "policy_reward_mean": {"policy_0": -662.5169450415747}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-828.5862504439535, -1080.2618023377165, -585.315594727283, -495.1570897153189, -644.3902777635557, -927.4448843648198, -581.1406306905473, -626.2531349918552, -596.7290358058078, -815.6297155447808, -262.54601213569396, -877.0797034360581, -776.636801352222, -266.8254708572879, -856.0680883447872, -1032.2207429014993, -388.3296163859671, -619.8710058730035, -905.3605662168505, -751.5120306862106, -257.15039231104976, -1105.8664828695976, -772.5949847211197, -94.19815982647218, -927.007309401901, -39.46325861585001, -644.0936277128703, -1071.005949597829, -624.2291819137578, -580.4292319843407, -423.783132968921, -605.238210592518, -895.4015062407565, -1081.4763823330616, -988.8393735768702, -1066.3285575621323, -783.2959531469553, -270.1961795043592, -851.0927293355954, -545.8142757268661, -720.383704124477, -864.4852504546741, -954.6589156202285, -176.26069573241617, -960.8708658597708, -1093.8887305788355, -795.034856866609, -635.8180617051817, -241.24535160392398, -472.2962747953784, -422.26550822498217, -701.9314171301194, -206.95625064204248, -1176.9456253568273, -55.58530898712308, -486.61621787158475, -830.3405445813672, -894.6820992276964, -540.771554183317, -26.058194975743458, -719.3982626061972, -888.8745801619765, -155.14099891702077, -1071.4181408648888, -704.3085456142684, -68.34951499953434, -561.2013532400325, -633.8726246685736, -1201.8869269939912, -593.8025748517906, -1005.6499915776199, -481.00288490492363, -720.6396170700955, -897.7860308354595, -803.5105328913008, -975.2987011219659, -117.3403360849776, -227.3363231224504, -569.6277262125365, -913.5252517590719, -642.1266264008865, -923.5463721159745, -746.8541110531505, -375.85032449287195, -318.690750777955, -315.7112437582637, -885.8121869528618, -539.4577128935067, -1031.2862605160624, -775.843962949035, -1034.6464743470556, -274.2213004765259, -803.0832548315398, -710.348576815375, -983.0705805262407, -148.36983217280823, -805.4407594608264, -613.7442051660261, -1195.5354364077514, -16.124850503737537], "episode_lengths": [150, 150, 137, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 109, 150, 150, 113, 150, 150, 150, 79, 150, 150, 55, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 143, 150, 150, 91, 150, 55, 114, 150, 150, 150, 58, 150, 150, 65, 150, 150, 69, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 95, 112, 150, 150, 150, 150, 150, 150, 115, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 68, 150, 150, 150, 48], "policy_policy_0_reward": [-828.5862504439535, -1080.2618023377165, -585.315594727283, -495.1570897153189, -644.3902777635557, -927.4448843648198, -581.1406306905473, -626.2531349918552, -596.7290358058078, -815.6297155447808, -262.54601213569396, -877.0797034360581, -776.636801352222, -266.8254708572879, -856.0680883447872, -1032.2207429014993, -388.3296163859671, -619.8710058730035, -905.3605662168505, -751.5120306862106, -257.15039231104976, -1105.8664828695976, -772.5949847211197, -94.19815982647218, -927.007309401901, -39.46325861585001, -644.0936277128703, -1071.005949597829, -624.2291819137578, -580.4292319843407, -423.783132968921, -605.238210592518, -895.4015062407565, -1081.4763823330616, -988.8393735768702, -1066.3285575621323, -783.2959531469553, -270.1961795043592, -851.0927293355954, -545.8142757268661, -720.383704124477, -864.4852504546741, -954.6589156202285, -176.26069573241617, -960.8708658597708, -1093.8887305788355, -795.034856866609, -635.8180617051817, -241.24535160392398, -472.2962747953784, -422.26550822498217, -701.9314171301194, -206.95625064204248, -1176.9456253568273, -55.58530898712308, -486.61621787158475, -830.3405445813672, -894.6820992276964, -540.771554183317, -26.058194975743458, -719.3982626061972, -888.8745801619765, -155.14099891702077, -1071.4181408648888, -704.3085456142684, -68.34951499953434, -561.2013532400325, -633.8726246685736, -1201.8869269939912, -593.8025748517906, -1005.6499915776199, -481.00288490492363, -720.6396170700955, -897.7860308354595, -803.5105328913008, -975.2987011219659, -117.3403360849776, -227.3363231224504, -569.6277262125365, -913.5252517590719, -642.1266264008865, -923.5463721159745, -746.8541110531505, -375.85032449287195, -318.690750777955, -315.7112437582637, -885.8121869528618, -539.4577128935067, -1031.2862605160624, -775.843962949035, -1034.6464743470556, -274.2213004765259, -803.0832548315398, -710.348576815375, -983.0705805262407, -148.36983217280823, -805.4407594608264, -613.7442051660261, -1195.5354364077514, -16.124850503737537]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.278839121579269, "mean_inference_ms": 0.8756759913236268, "mean_action_processing_ms": 0.1593677514951845, "mean_env_wait_ms": 1.530395828346612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005156755447387695, "StateBufferConnector_ms": 0.003940582275390625, "ViewRequirementAgentConnector_ms": 0.09658956527709961}, "num_episodes": 29, "episode_return_max": -16.124850503737537, "episode_return_min": -1201.8869269939912, "episode_return_mean": -662.5169450415747, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 275.5591086716269, "num_env_steps_trained_throughput_per_sec": 275.5591086716269, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 14303.078, "restore_workers_time_ms": 0.021, "training_step_time_ms": 14303.016, "sample_time_ms": 2341.497, "learn_time_ms": 11946.142, "learn_throughput": 334.836, "synch_weights_time_ms": 14.632}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "92003_00004", "date": "2024-08-03_04-45-39", "timestamp": 1722640539, "time_this_iter_s": 14.522600412368774, "time_total_s": 85.86029744148254, "pid": 480833, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b32767e20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 85.86029744148254, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 12.547619047619047, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 49.813226372996965, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.842481107761462, "policy_loss": -0.00540471105875137, "vf_loss": 6.844870091726382, "vf_explained_var": 0.7682018332183361, "kl": 0.015798775239909454, "entropy": 1.440181234975656, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -16.124850503737537, "episode_reward_min": -1204.6269190751268, "episode_reward_mean": -673.1942422462137, "episode_len_mean": 138.8, "episode_media": {}, "episodes_timesteps_total": 13880, "policy_reward_min": {"policy_0": -1204.6269190751268}, "policy_reward_max": {"policy_0": -16.124850503737537}, "policy_reward_mean": {"policy_0": -673.1942422462137}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1071.005949597829, -624.2291819137578, -580.4292319843407, -423.783132968921, -605.238210592518, -895.4015062407565, -1081.4763823330616, -988.8393735768702, -1066.3285575621323, -783.2959531469553, -270.1961795043592, -851.0927293355954, -545.8142757268661, -720.383704124477, -864.4852504546741, -954.6589156202285, -176.26069573241617, -960.8708658597708, -1093.8887305788355, -795.034856866609, -635.8180617051817, -241.24535160392398, -472.2962747953784, -422.26550822498217, -701.9314171301194, -206.95625064204248, -1176.9456253568273, -55.58530898712308, -486.61621787158475, -830.3405445813672, -894.6820992276964, -540.771554183317, -26.058194975743458, -719.3982626061972, -888.8745801619765, -155.14099891702077, -1071.4181408648888, -704.3085456142684, -68.34951499953434, -561.2013532400325, -633.8726246685736, -1201.8869269939912, -593.8025748517906, -1005.6499915776199, -481.00288490492363, -720.6396170700955, -897.7860308354595, -803.5105328913008, -975.2987011219659, -117.3403360849776, -227.3363231224504, -569.6277262125365, -913.5252517590719, -642.1266264008865, -923.5463721159745, -746.8541110531505, -375.85032449287195, -318.690750777955, -315.7112437582637, -885.8121869528618, -539.4577128935067, -1031.2862605160624, -775.843962949035, -1034.6464743470556, -274.2213004765259, -803.0832548315398, -710.348576815375, -983.0705805262407, -148.36983217280823, -805.4407594608264, -613.7442051660261, -1195.5354364077514, -16.124850503737537, -608.590051465964, -899.6592462012038, -437.91449673322916, -286.7796891742854, -796.1646160558846, -775.6861158854542, -936.7021641837778, -703.0173932970579, -651.9933689378639, -891.2667726691736, -688.2637069728179, -810.0269778643204, -1075.5119334317271, -743.3334011094181, -905.391171995849, -533.8102045166413, -814.0229501309775, -72.51590448068953, -408.0971334496897, -830.5489459439071, -1204.6269190751268, -76.71072960636934, -883.5019295595018, -839.3358496095921, -680.6421593241055, -421.0212565606815, -850.3273022626609], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 143, 150, 150, 91, 150, 55, 114, 150, 150, 150, 58, 150, 150, 65, 150, 150, 69, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 95, 112, 150, 150, 150, 150, 150, 150, 115, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 68, 150, 150, 150, 48, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 71, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1071.005949597829, -624.2291819137578, -580.4292319843407, -423.783132968921, -605.238210592518, -895.4015062407565, -1081.4763823330616, -988.8393735768702, -1066.3285575621323, -783.2959531469553, -270.1961795043592, -851.0927293355954, -545.8142757268661, -720.383704124477, -864.4852504546741, -954.6589156202285, -176.26069573241617, -960.8708658597708, -1093.8887305788355, -795.034856866609, -635.8180617051817, -241.24535160392398, -472.2962747953784, -422.26550822498217, -701.9314171301194, -206.95625064204248, -1176.9456253568273, -55.58530898712308, -486.61621787158475, -830.3405445813672, -894.6820992276964, -540.771554183317, -26.058194975743458, -719.3982626061972, -888.8745801619765, -155.14099891702077, -1071.4181408648888, -704.3085456142684, -68.34951499953434, -561.2013532400325, -633.8726246685736, -1201.8869269939912, -593.8025748517906, -1005.6499915776199, -481.00288490492363, -720.6396170700955, -897.7860308354595, -803.5105328913008, -975.2987011219659, -117.3403360849776, -227.3363231224504, -569.6277262125365, -913.5252517590719, -642.1266264008865, -923.5463721159745, -746.8541110531505, -375.85032449287195, -318.690750777955, -315.7112437582637, -885.8121869528618, -539.4577128935067, -1031.2862605160624, -775.843962949035, -1034.6464743470556, -274.2213004765259, -803.0832548315398, -710.348576815375, -983.0705805262407, -148.36983217280823, -805.4407594608264, -613.7442051660261, -1195.5354364077514, -16.124850503737537, -608.590051465964, -899.6592462012038, -437.91449673322916, -286.7796891742854, -796.1646160558846, -775.6861158854542, -936.7021641837778, -703.0173932970579, -651.9933689378639, -891.2667726691736, -688.2637069728179, -810.0269778643204, -1075.5119334317271, -743.3334011094181, -905.391171995849, -533.8102045166413, -814.0229501309775, -72.51590448068953, -408.0971334496897, -830.5489459439071, -1204.6269190751268, -76.71072960636934, -883.5019295595018, -839.3358496095921, -680.6421593241055, -421.0212565606815, -850.3273022626609]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27890241680551403, "mean_inference_ms": 0.876934198113239, "mean_action_processing_ms": 0.1591774922350516, "mean_env_wait_ms": 1.532166104067578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005150556564331055, "StateBufferConnector_ms": 0.00394892692565918, "ViewRequirementAgentConnector_ms": 0.09711384773254395}, "num_episodes": 27, "episode_return_max": -16.124850503737537, "episode_return_min": -1204.6269190751268, "episode_return_mean": -673.1942422462137, "episodes_this_iter": 27}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 282.2031925303255, "num_env_steps_trained_throughput_per_sec": 282.2031925303255, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 14284.666, "restore_workers_time_ms": 0.021, "training_step_time_ms": 14284.605, "sample_time_ms": 2354.774, "learn_time_ms": 11914.582, "learn_throughput": 335.723, "synch_weights_time_ms": 14.508}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "92003_00004", "date": "2024-08-03_04-45-54", "timestamp": 1722640554, "time_this_iter_s": 14.182474374771118, "time_total_s": 100.04277181625366, "pid": 480833, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b327f5630>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 100.04277181625366, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 12.700000000000001, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 51.68188717563947, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.675016875068347, "policy_loss": -0.014697575820900966, "vf_loss": 6.685448968907197, "vf_explained_var": 0.7945984387770295, "kl": 0.02206178834312596, "entropy": 1.4686758510768414, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -16.124850503737537, "episode_reward_min": -1338.0950747022982, "episode_reward_mean": -696.9924342830677, "episode_len_mean": 138.26, "episode_media": {}, "episodes_timesteps_total": 13826, "policy_reward_min": {"policy_0": -1338.0950747022982}, "policy_reward_max": {"policy_0": -16.124850503737537}, "policy_reward_mean": {"policy_0": -696.9924342830677}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-894.6820992276964, -540.771554183317, -26.058194975743458, -719.3982626061972, -888.8745801619765, -155.14099891702077, -1071.4181408648888, -704.3085456142684, -68.34951499953434, -561.2013532400325, -633.8726246685736, -1201.8869269939912, -593.8025748517906, -1005.6499915776199, -481.00288490492363, -720.6396170700955, -897.7860308354595, -803.5105328913008, -975.2987011219659, -117.3403360849776, -227.3363231224504, -569.6277262125365, -913.5252517590719, -642.1266264008865, -923.5463721159745, -746.8541110531505, -375.85032449287195, -318.690750777955, -315.7112437582637, -885.8121869528618, -539.4577128935067, -1031.2862605160624, -775.843962949035, -1034.6464743470556, -274.2213004765259, -803.0832548315398, -710.348576815375, -983.0705805262407, -148.36983217280823, -805.4407594608264, -613.7442051660261, -1195.5354364077514, -16.124850503737537, -608.590051465964, -899.6592462012038, -437.91449673322916, -286.7796891742854, -796.1646160558846, -775.6861158854542, -936.7021641837778, -703.0173932970579, -651.9933689378639, -891.2667726691736, -688.2637069728179, -810.0269778643204, -1075.5119334317271, -743.3334011094181, -905.391171995849, -533.8102045166413, -814.0229501309775, -72.51590448068953, -408.0971334496897, -830.5489459439071, -1204.6269190751268, -76.71072960636934, -883.5019295595018, -839.3358496095921, -680.6421593241055, -421.0212565606815, -850.3273022626609, -832.9701385115575, -349.8835506905843, -307.6323620273275, -581.1884705400262, -98.23937447855843, -961.6159720575748, -1338.0950747022982, -989.9329206220061, -1025.1064655450857, -758.2783927765768, -555.1524507494048, -1123.103031533, -632.4752865518873, -41.2546449789449, -368.0611241615306, -908.5854874061015, -1254.0213544085884, -624.5231179455847, -415.412864082808, -925.901871036622, -1032.2593574681955, -783.2641243638499, -1108.4205556688325, -985.476324627597, -750.968370416702, -811.283926736159, -1286.8845405539178, -1026.6754538470843, -854.1704464988592, -231.69639331764571], "episode_lengths": [150, 150, 58, 150, 150, 65, 150, 150, 69, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 95, 112, 150, 150, 150, 150, 150, 150, 115, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 68, 150, 150, 150, 48, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 71, 150, 150, 150, 150, 150, 150, 117, 93, 150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 60, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110], "policy_policy_0_reward": [-894.6820992276964, -540.771554183317, -26.058194975743458, -719.3982626061972, -888.8745801619765, -155.14099891702077, -1071.4181408648888, -704.3085456142684, -68.34951499953434, -561.2013532400325, -633.8726246685736, -1201.8869269939912, -593.8025748517906, -1005.6499915776199, -481.00288490492363, -720.6396170700955, -897.7860308354595, -803.5105328913008, -975.2987011219659, -117.3403360849776, -227.3363231224504, -569.6277262125365, -913.5252517590719, -642.1266264008865, -923.5463721159745, -746.8541110531505, -375.85032449287195, -318.690750777955, -315.7112437582637, -885.8121869528618, -539.4577128935067, -1031.2862605160624, -775.843962949035, -1034.6464743470556, -274.2213004765259, -803.0832548315398, -710.348576815375, -983.0705805262407, -148.36983217280823, -805.4407594608264, -613.7442051660261, -1195.5354364077514, -16.124850503737537, -608.590051465964, -899.6592462012038, -437.91449673322916, -286.7796891742854, -796.1646160558846, -775.6861158854542, -936.7021641837778, -703.0173932970579, -651.9933689378639, -891.2667726691736, -688.2637069728179, -810.0269778643204, -1075.5119334317271, -743.3334011094181, -905.391171995849, -533.8102045166413, -814.0229501309775, -72.51590448068953, -408.0971334496897, -830.5489459439071, -1204.6269190751268, -76.71072960636934, -883.5019295595018, -839.3358496095921, -680.6421593241055, -421.0212565606815, -850.3273022626609, -832.9701385115575, -349.8835506905843, -307.6323620273275, -581.1884705400262, -98.23937447855843, -961.6159720575748, -1338.0950747022982, -989.9329206220061, -1025.1064655450857, -758.2783927765768, -555.1524507494048, -1123.103031533, -632.4752865518873, -41.2546449789449, -368.0611241615306, -908.5854874061015, -1254.0213544085884, -624.5231179455847, -415.412864082808, -925.901871036622, -1032.2593574681955, -783.2641243638499, -1108.4205556688325, -985.476324627597, -750.968370416702, -811.283926736159, -1286.8845405539178, -1026.6754538470843, -854.1704464988592, -231.69639331764571]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27888184527326465, "mean_inference_ms": 0.8852937211507694, "mean_action_processing_ms": 0.1589258502994517, "mean_env_wait_ms": 1.532922167613906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005263328552246094, "StateBufferConnector_ms": 0.0039424896240234375, "ViewRequirementAgentConnector_ms": 0.09728312492370605}, "num_episodes": 30, "episode_return_max": -16.124850503737537, "episode_return_min": -1338.0950747022982, "episode_return_mean": -696.9924342830677, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 370.2236833258118, "num_env_steps_trained_throughput_per_sec": 370.2236833258118, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 13849.619, "restore_workers_time_ms": 0.022, "training_step_time_ms": 13849.557, "sample_time_ms": 2380.256, "learn_time_ms": 11454.389, "learn_throughput": 349.211, "synch_weights_time_ms": 14.174}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "92003_00004", "date": "2024-08-03_04-46-04", "timestamp": 1722640564, "time_this_iter_s": 10.81290888786316, "time_total_s": 110.85568070411682, "pid": 480833, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b327677f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 110.85568070411682, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 13.866666666666667, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 64.70395716528098, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.255731034775575, "policy_loss": -0.016702380389809455, "vf_loss": 6.267209180692832, "vf_explained_var": 0.8884818202505509, "kl": 0.017909043124321528, "entropy": 1.4848287370055915, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -16.124850503737537, "episode_reward_min": -1338.0950747022982, "episode_reward_mean": -727.0009972575949, "episode_len_mean": 138.38, "episode_media": {}, "episodes_timesteps_total": 13838, "policy_reward_min": {"policy_0": -1338.0950747022982}, "policy_reward_max": {"policy_0": -16.124850503737537}, "policy_reward_mean": {"policy_0": -727.0009972575949}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-885.8121869528618, -539.4577128935067, -1031.2862605160624, -775.843962949035, -1034.6464743470556, -274.2213004765259, -803.0832548315398, -710.348576815375, -983.0705805262407, -148.36983217280823, -805.4407594608264, -613.7442051660261, -1195.5354364077514, -16.124850503737537, -608.590051465964, -899.6592462012038, -437.91449673322916, -286.7796891742854, -796.1646160558846, -775.6861158854542, -936.7021641837778, -703.0173932970579, -651.9933689378639, -891.2667726691736, -688.2637069728179, -810.0269778643204, -1075.5119334317271, -743.3334011094181, -905.391171995849, -533.8102045166413, -814.0229501309775, -72.51590448068953, -408.0971334496897, -830.5489459439071, -1204.6269190751268, -76.71072960636934, -883.5019295595018, -839.3358496095921, -680.6421593241055, -421.0212565606815, -850.3273022626609, -832.9701385115575, -349.8835506905843, -307.6323620273275, -581.1884705400262, -98.23937447855843, -961.6159720575748, -1338.0950747022982, -989.9329206220061, -1025.1064655450857, -758.2783927765768, -555.1524507494048, -1123.103031533, -632.4752865518873, -41.2546449789449, -368.0611241615306, -908.5854874061015, -1254.0213544085884, -624.5231179455847, -415.412864082808, -925.901871036622, -1032.2593574681955, -783.2641243638499, -1108.4205556688325, -985.476324627597, -750.968370416702, -811.283926736159, -1286.8845405539178, -1026.6754538470843, -854.1704464988592, -231.69639331764571, -1215.772304105902, -206.90694099071268, -868.8161901655205, -934.6909672731188, -46.28905242987472, -1114.6383746167826, -709.7559426424612, -1160.3712623407484, -360.013651996739, -1027.1805444039242, -950.7981508144863, -926.0552754495172, -1071.9703779719262, -534.4546191493117, -185.4040690033132, -918.808533857382, -577.1846043082642, -259.0326059070094, -1298.8178399959254, -320.82050010958164, -874.2532351732362, -809.3558449037594, -1104.0664860783136, -960.5329030764574, -735.3884348232792, -1029.2399854246585, -54.02843004934806, -791.7716666262369, -48.69969924944925], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 68, 150, 150, 150, 48, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 71, 150, 150, 150, 150, 150, 150, 117, 93, 150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 60, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 84, 150, 150, 56, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 54, 150, 52], "policy_policy_0_reward": [-885.8121869528618, -539.4577128935067, -1031.2862605160624, -775.843962949035, -1034.6464743470556, -274.2213004765259, -803.0832548315398, -710.348576815375, -983.0705805262407, -148.36983217280823, -805.4407594608264, -613.7442051660261, -1195.5354364077514, -16.124850503737537, -608.590051465964, -899.6592462012038, -437.91449673322916, -286.7796891742854, -796.1646160558846, -775.6861158854542, -936.7021641837778, -703.0173932970579, -651.9933689378639, -891.2667726691736, -688.2637069728179, -810.0269778643204, -1075.5119334317271, -743.3334011094181, -905.391171995849, -533.8102045166413, -814.0229501309775, -72.51590448068953, -408.0971334496897, -830.5489459439071, -1204.6269190751268, -76.71072960636934, -883.5019295595018, -839.3358496095921, -680.6421593241055, -421.0212565606815, -850.3273022626609, -832.9701385115575, -349.8835506905843, -307.6323620273275, -581.1884705400262, -98.23937447855843, -961.6159720575748, -1338.0950747022982, -989.9329206220061, -1025.1064655450857, -758.2783927765768, -555.1524507494048, -1123.103031533, -632.4752865518873, -41.2546449789449, -368.0611241615306, -908.5854874061015, -1254.0213544085884, -624.5231179455847, -415.412864082808, -925.901871036622, -1032.2593574681955, -783.2641243638499, -1108.4205556688325, -985.476324627597, -750.968370416702, -811.283926736159, -1286.8845405539178, -1026.6754538470843, -854.1704464988592, -231.69639331764571, -1215.772304105902, -206.90694099071268, -868.8161901655205, -934.6909672731188, -46.28905242987472, -1114.6383746167826, -709.7559426424612, -1160.3712623407484, -360.013651996739, -1027.1805444039242, -950.7981508144863, -926.0552754495172, -1071.9703779719262, -534.4546191493117, -185.4040690033132, -918.808533857382, -577.1846043082642, -259.0326059070094, -1298.8178399959254, -320.82050010958164, -874.2532351732362, -809.3558449037594, -1104.0664860783136, -960.5329030764574, -735.3884348232792, -1029.2399854246585, -54.02843004934806, -791.7716666262369, -48.69969924944925]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2792437160481581, "mean_inference_ms": 0.89265141820234, "mean_action_processing_ms": 0.1588129995180059, "mean_env_wait_ms": 1.5349059343525662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005314826965332031, "StateBufferConnector_ms": 0.003944873809814453, "ViewRequirementAgentConnector_ms": 0.09743833541870117}, "num_episodes": 29, "episode_return_max": -16.124850503737537, "episode_return_min": -1338.0950747022982, "episode_return_mean": -727.0009972575949, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 466.78928920873125, "num_env_steps_trained_throughput_per_sec": 466.78928920873125, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 13262.905, "restore_workers_time_ms": 0.022, "training_step_time_ms": 13262.843, "sample_time_ms": 2375.004, "learn_time_ms": 10873.202, "learn_throughput": 367.877, "synch_weights_time_ms": 13.906}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "92003_00004", "date": "2024-08-03_04-46-13", "timestamp": 1722640573, "time_this_iter_s": 8.576995372772217, "time_total_s": 119.43267607688904, "pid": 480833, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b32764c10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 119.43267607688904, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 14.65, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 75.72079138855139, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.088336329162121, "policy_loss": -0.010520608338993043, "vf_loss": 6.094491267204285, "vf_explained_var": 0.848904424905777, "kl": 0.015074724074186946, "entropy": 1.5673687073091667, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -29.25036469054832, "episode_reward_min": -1363.8339752639681, "episode_reward_mean": -744.2502545932377, "episode_len_mean": 137.29, "episode_media": {}, "episodes_timesteps_total": 13729, "policy_reward_min": {"policy_0": -1363.8339752639681}, "policy_reward_max": {"policy_0": -29.25036469054832}, "policy_reward_mean": {"policy_0": -744.2502545932377}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-533.8102045166413, -814.0229501309775, -72.51590448068953, -408.0971334496897, -830.5489459439071, -1204.6269190751268, -76.71072960636934, -883.5019295595018, -839.3358496095921, -680.6421593241055, -421.0212565606815, -850.3273022626609, -832.9701385115575, -349.8835506905843, -307.6323620273275, -581.1884705400262, -98.23937447855843, -961.6159720575748, -1338.0950747022982, -989.9329206220061, -1025.1064655450857, -758.2783927765768, -555.1524507494048, -1123.103031533, -632.4752865518873, -41.2546449789449, -368.0611241615306, -908.5854874061015, -1254.0213544085884, -624.5231179455847, -415.412864082808, -925.901871036622, -1032.2593574681955, -783.2641243638499, -1108.4205556688325, -985.476324627597, -750.968370416702, -811.283926736159, -1286.8845405539178, -1026.6754538470843, -854.1704464988592, -231.69639331764571, -1215.772304105902, -206.90694099071268, -868.8161901655205, -934.6909672731188, -46.28905242987472, -1114.6383746167826, -709.7559426424612, -1160.3712623407484, -360.013651996739, -1027.1805444039242, -950.7981508144863, -926.0552754495172, -1071.9703779719262, -534.4546191493117, -185.4040690033132, -918.808533857382, -577.1846043082642, -259.0326059070094, -1298.8178399959254, -320.82050010958164, -874.2532351732362, -809.3558449037594, -1104.0664860783136, -960.5329030764574, -735.3884348232792, -1029.2399854246585, -54.02843004934806, -791.7716666262369, -48.69969924944925, -1076.4102172317578, -724.2262093991255, -974.6973677176206, -1043.269059642397, -220.3697658430166, -627.9528319400424, -1242.241435736582, -860.3898403095704, -1214.701840237169, -1116.3754848591561, -1223.1670195465765, -351.1070694614395, -896.548490447546, -29.25036469054832, -1363.8339752639681, -488.224008623357, -1304.6579027726789, -49.49839084807549, -767.3770057213162, -471.92003067438435, -348.0500582986118, -980.7948779564674, -1128.2154967708127, -628.6017224077659, -943.4613881966357, -675.6335784128878, -851.9484984426246, -752.9686023192809, -396.3196997902859], "episode_lengths": [150, 150, 74, 150, 150, 150, 71, 150, 150, 150, 150, 150, 150, 117, 93, 150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 60, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 84, 150, 150, 56, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 54, 150, 52, 150, 150, 150, 150, 103, 150, 150, 150, 150, 150, 150, 114, 150, 57, 150, 150, 150, 73, 150, 150, 89, 150, 150, 150, 150, 150, 150, 145, 150], "policy_policy_0_reward": [-533.8102045166413, -814.0229501309775, -72.51590448068953, -408.0971334496897, -830.5489459439071, -1204.6269190751268, -76.71072960636934, -883.5019295595018, -839.3358496095921, -680.6421593241055, -421.0212565606815, -850.3273022626609, -832.9701385115575, -349.8835506905843, -307.6323620273275, -581.1884705400262, -98.23937447855843, -961.6159720575748, -1338.0950747022982, -989.9329206220061, -1025.1064655450857, -758.2783927765768, -555.1524507494048, -1123.103031533, -632.4752865518873, -41.2546449789449, -368.0611241615306, -908.5854874061015, -1254.0213544085884, -624.5231179455847, -415.412864082808, -925.901871036622, -1032.2593574681955, -783.2641243638499, -1108.4205556688325, -985.476324627597, -750.968370416702, -811.283926736159, -1286.8845405539178, -1026.6754538470843, -854.1704464988592, -231.69639331764571, -1215.772304105902, -206.90694099071268, -868.8161901655205, -934.6909672731188, -46.28905242987472, -1114.6383746167826, -709.7559426424612, -1160.3712623407484, -360.013651996739, -1027.1805444039242, -950.7981508144863, -926.0552754495172, -1071.9703779719262, -534.4546191493117, -185.4040690033132, -918.808533857382, -577.1846043082642, -259.0326059070094, -1298.8178399959254, -320.82050010958164, -874.2532351732362, -809.3558449037594, -1104.0664860783136, -960.5329030764574, -735.3884348232792, -1029.2399854246585, -54.02843004934806, -791.7716666262369, -48.69969924944925, -1076.4102172317578, -724.2262093991255, -974.6973677176206, -1043.269059642397, -220.3697658430166, -627.9528319400424, -1242.241435736582, -860.3898403095704, -1214.701840237169, -1116.3754848591561, -1223.1670195465765, -351.1070694614395, -896.548490447546, -29.25036469054832, -1363.8339752639681, -488.224008623357, -1304.6579027726789, -49.49839084807549, -767.3770057213162, -471.92003067438435, -348.0500582986118, -980.7948779564674, -1128.2154967708127, -628.6017224077659, -943.4613881966357, -675.6335784128878, -851.9484984426246, -752.9686023192809, -396.3196997902859]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27977385741857513, "mean_inference_ms": 0.8979876546333813, "mean_action_processing_ms": 0.1587507279944471, "mean_env_wait_ms": 1.53661184180584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005257844924926758, "StateBufferConnector_ms": 0.003971099853515625, "ViewRequirementAgentConnector_ms": 0.09776926040649414}, "num_episodes": 29, "episode_return_max": -29.25036469054832, "episode_return_min": -1363.8339752639681, "episode_return_mean": -744.2502545932377, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.2510976029969, "num_env_steps_trained_throughput_per_sec": 319.2510976029969, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 13189.549, "restore_workers_time_ms": 0.023, "training_step_time_ms": 13189.484, "sample_time_ms": 2372.996, "learn_time_ms": 10801.852, "learn_throughput": 370.307, "synch_weights_time_ms": 13.903}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "92003_00004", "date": "2024-08-03_04-46-26", "timestamp": 1722640586, "time_this_iter_s": 12.537289381027222, "time_total_s": 131.96996545791626, "pid": 480833, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b3270f490>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 131.96996545791626, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 12.961111111111112, "ram_util_percent": 16.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 98.91851664880912, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.561687737951676, "policy_loss": -0.008375041913435173, "vf_loss": 5.56583113198479, "vf_explained_var": 0.9359711992243925, "kl": 0.014569820525972934, "entropy": 1.3928794551640749, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -29.25036469054832, "episode_reward_min": -1363.8339752639681, "episode_reward_mean": -728.1074953456232, "episode_len_mean": 137.18, "episode_media": {}, "episodes_timesteps_total": 13718, "policy_reward_min": {"policy_0": -1363.8339752639681}, "policy_reward_max": {"policy_0": -29.25036469054832}, "policy_reward_mean": {"policy_0": -728.1074953456232}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-415.412864082808, -925.901871036622, -1032.2593574681955, -783.2641243638499, -1108.4205556688325, -985.476324627597, -750.968370416702, -811.283926736159, -1286.8845405539178, -1026.6754538470843, -854.1704464988592, -231.69639331764571, -1215.772304105902, -206.90694099071268, -868.8161901655205, -934.6909672731188, -46.28905242987472, -1114.6383746167826, -709.7559426424612, -1160.3712623407484, -360.013651996739, -1027.1805444039242, -950.7981508144863, -926.0552754495172, -1071.9703779719262, -534.4546191493117, -185.4040690033132, -918.808533857382, -577.1846043082642, -259.0326059070094, -1298.8178399959254, -320.82050010958164, -874.2532351732362, -809.3558449037594, -1104.0664860783136, -960.5329030764574, -735.3884348232792, -1029.2399854246585, -54.02843004934806, -791.7716666262369, -48.69969924944925, -1076.4102172317578, -724.2262093991255, -974.6973677176206, -1043.269059642397, -220.3697658430166, -627.9528319400424, -1242.241435736582, -860.3898403095704, -1214.701840237169, -1116.3754848591561, -1223.1670195465765, -351.1070694614395, -896.548490447546, -29.25036469054832, -1363.8339752639681, -488.224008623357, -1304.6579027726789, -49.49839084807549, -767.3770057213162, -471.92003067438435, -348.0500582986118, -980.7948779564674, -1128.2154967708127, -628.6017224077659, -943.4613881966357, -675.6335784128878, -851.9484984426246, -752.9686023192809, -396.3196997902859, -1159.5205344286067, -129.49741437766647, -615.1740003972492, -738.2388619903885, -497.17133807915576, -1101.417046312861, -669.2818417423051, -188.98407086122452, -1052.5042853175632, -423.07170881128434, -475.01724521071554, -46.21359298706928, -989.115907305333, -445.30390548378557, -605.8792035638207, -1043.7802187113848, -470.9931617289874, -234.9329550020267, -706.488107632083, -908.7172393269857, -832.0682395131253, -32.27280201486489, -931.7408854115155, -194.04417521190513, -773.8670954265757, -848.279110792892, -1218.3616800001598, -528.8784558420805, -471.86597561972553, -418.32352034175733], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 84, 150, 150, 56, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 54, 150, 52, 150, 150, 150, 150, 103, 150, 150, 150, 150, 150, 150, 114, 150, 57, 150, 150, 150, 73, 150, 150, 89, 150, 150, 150, 150, 150, 150, 145, 150, 150, 79, 150, 150, 150, 150, 150, 78, 150, 150, 150, 57, 150, 150, 150, 150, 150, 78, 150, 150, 150, 46, 150, 85, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-415.412864082808, -925.901871036622, -1032.2593574681955, -783.2641243638499, -1108.4205556688325, -985.476324627597, -750.968370416702, -811.283926736159, -1286.8845405539178, -1026.6754538470843, -854.1704464988592, -231.69639331764571, -1215.772304105902, -206.90694099071268, -868.8161901655205, -934.6909672731188, -46.28905242987472, -1114.6383746167826, -709.7559426424612, -1160.3712623407484, -360.013651996739, -1027.1805444039242, -950.7981508144863, -926.0552754495172, -1071.9703779719262, -534.4546191493117, -185.4040690033132, -918.808533857382, -577.1846043082642, -259.0326059070094, -1298.8178399959254, -320.82050010958164, -874.2532351732362, -809.3558449037594, -1104.0664860783136, -960.5329030764574, -735.3884348232792, -1029.2399854246585, -54.02843004934806, -791.7716666262369, -48.69969924944925, -1076.4102172317578, -724.2262093991255, -974.6973677176206, -1043.269059642397, -220.3697658430166, -627.9528319400424, -1242.241435736582, -860.3898403095704, -1214.701840237169, -1116.3754848591561, -1223.1670195465765, -351.1070694614395, -896.548490447546, -29.25036469054832, -1363.8339752639681, -488.224008623357, -1304.6579027726789, -49.49839084807549, -767.3770057213162, -471.92003067438435, -348.0500582986118, -980.7948779564674, -1128.2154967708127, -628.6017224077659, -943.4613881966357, -675.6335784128878, -851.9484984426246, -752.9686023192809, -396.3196997902859, -1159.5205344286067, -129.49741437766647, -615.1740003972492, -738.2388619903885, -497.17133807915576, -1101.417046312861, -669.2818417423051, -188.98407086122452, -1052.5042853175632, -423.07170881128434, -475.01724521071554, -46.21359298706928, -989.115907305333, -445.30390548378557, -605.8792035638207, -1043.7802187113848, -470.9931617289874, -234.9329550020267, -706.488107632083, -908.7172393269857, -832.0682395131253, -32.27280201486489, -931.7408854115155, -194.04417521190513, -773.8670954265757, -848.279110792892, -1218.3616800001598, -528.8784558420805, -471.86597561972553, -418.32352034175733]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2802343991830355, "mean_inference_ms": 0.899141463953627, "mean_action_processing_ms": 0.15866529711749966, "mean_env_wait_ms": 1.5390405599963517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052335262298583984, "StateBufferConnector_ms": 0.0040912628173828125, "ViewRequirementAgentConnector_ms": 0.09904193878173828}, "num_episodes": 30, "episode_return_max": -29.25036469054832, "episode_return_min": -1363.8339752639681, "episode_return_mean": -728.1074953456232, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 467.29318483236597, "num_env_steps_trained_throughput_per_sec": 467.29318483236597, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12632.159, "restore_workers_time_ms": 0.023, "training_step_time_ms": 12632.094, "sample_time_ms": 2375.955, "learn_time_ms": 10241.805, "learn_throughput": 390.556, "synch_weights_time_ms": 13.605}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "92003_00004", "date": "2024-08-03_04-46-34", "timestamp": 1722640594, "time_this_iter_s": 8.567936182022095, "time_total_s": 140.53790163993835, "pid": 480833, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c78eef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 140.53790163993835, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 14.369230769230768, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 102.01155263483524, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.315510043998559, "policy_loss": -0.013671869243747399, "vf_loss": 5.324915299067895, "vf_explained_var": 0.9279662803436319, "kl": 0.014745204276702393, "entropy": 1.569545339172085, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -29.25036469054832, "episode_reward_min": -1363.8339752639681, "episode_reward_mean": -712.2716141544842, "episode_len_mean": 136.89, "episode_media": {}, "episodes_timesteps_total": 13689, "policy_reward_min": {"policy_0": -1363.8339752639681}, "policy_reward_max": {"policy_0": -29.25036469054832}, "policy_reward_mean": {"policy_0": -712.2716141544842}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-577.1846043082642, -259.0326059070094, -1298.8178399959254, -320.82050010958164, -874.2532351732362, -809.3558449037594, -1104.0664860783136, -960.5329030764574, -735.3884348232792, -1029.2399854246585, -54.02843004934806, -791.7716666262369, -48.69969924944925, -1076.4102172317578, -724.2262093991255, -974.6973677176206, -1043.269059642397, -220.3697658430166, -627.9528319400424, -1242.241435736582, -860.3898403095704, -1214.701840237169, -1116.3754848591561, -1223.1670195465765, -351.1070694614395, -896.548490447546, -29.25036469054832, -1363.8339752639681, -488.224008623357, -1304.6579027726789, -49.49839084807549, -767.3770057213162, -471.92003067438435, -348.0500582986118, -980.7948779564674, -1128.2154967708127, -628.6017224077659, -943.4613881966357, -675.6335784128878, -851.9484984426246, -752.9686023192809, -396.3196997902859, -1159.5205344286067, -129.49741437766647, -615.1740003972492, -738.2388619903885, -497.17133807915576, -1101.417046312861, -669.2818417423051, -188.98407086122452, -1052.5042853175632, -423.07170881128434, -475.01724521071554, -46.21359298706928, -989.115907305333, -445.30390548378557, -605.8792035638207, -1043.7802187113848, -470.9931617289874, -234.9329550020267, -706.488107632083, -908.7172393269857, -832.0682395131253, -32.27280201486489, -931.7408854115155, -194.04417521190513, -773.8670954265757, -848.279110792892, -1218.3616800001598, -528.8784558420805, -471.86597561972553, -418.32352034175733, -353.40574972643213, -997.5465597997198, -580.3180634527286, -730.9847894429217, -869.8454853682778, -981.1799736274709, -348.25546200689433, -119.5410827077349, -1040.621598502884, -379.6874465139559, -82.60461543315131, -391.7767245330918, -1073.1589240792537, -1120.893850032649, -958.363469005279, -1068.155564788888, -1238.2156163495013, -674.2806778358943, -1072.3029847312955, -531.9936476202149, -1304.1949446171366, -291.2631511208013, -731.2072299747094, -808.6317562423435, -242.65222991779805, -1344.0281471245833, -947.7896587280597, -577.8529634324184], "episode_lengths": [150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 54, 150, 52, 150, 150, 150, 150, 103, 150, 150, 150, 150, 150, 150, 114, 150, 57, 150, 150, 150, 73, 150, 150, 89, 150, 150, 150, 150, 150, 150, 145, 150, 150, 79, 150, 150, 150, 150, 150, 78, 150, 150, 150, 57, 150, 150, 150, 150, 150, 78, 150, 150, 150, 46, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 139, 66, 150, 150, 150, 150, 150, 150, 150, 150, 147, 150, 113, 150, 150, 94, 150, 150, 150], "policy_policy_0_reward": [-577.1846043082642, -259.0326059070094, -1298.8178399959254, -320.82050010958164, -874.2532351732362, -809.3558449037594, -1104.0664860783136, -960.5329030764574, -735.3884348232792, -1029.2399854246585, -54.02843004934806, -791.7716666262369, -48.69969924944925, -1076.4102172317578, -724.2262093991255, -974.6973677176206, -1043.269059642397, -220.3697658430166, -627.9528319400424, -1242.241435736582, -860.3898403095704, -1214.701840237169, -1116.3754848591561, -1223.1670195465765, -351.1070694614395, -896.548490447546, -29.25036469054832, -1363.8339752639681, -488.224008623357, -1304.6579027726789, -49.49839084807549, -767.3770057213162, -471.92003067438435, -348.0500582986118, -980.7948779564674, -1128.2154967708127, -628.6017224077659, -943.4613881966357, -675.6335784128878, -851.9484984426246, -752.9686023192809, -396.3196997902859, -1159.5205344286067, -129.49741437766647, -615.1740003972492, -738.2388619903885, -497.17133807915576, -1101.417046312861, -669.2818417423051, -188.98407086122452, -1052.5042853175632, -423.07170881128434, -475.01724521071554, -46.21359298706928, -989.115907305333, -445.30390548378557, -605.8792035638207, -1043.7802187113848, -470.9931617289874, -234.9329550020267, -706.488107632083, -908.7172393269857, -832.0682395131253, -32.27280201486489, -931.7408854115155, -194.04417521190513, -773.8670954265757, -848.279110792892, -1218.3616800001598, -528.8784558420805, -471.86597561972553, -418.32352034175733, -353.40574972643213, -997.5465597997198, -580.3180634527286, -730.9847894429217, -869.8454853682778, -981.1799736274709, -348.25546200689433, -119.5410827077349, -1040.621598502884, -379.6874465139559, -82.60461543315131, -391.7767245330918, -1073.1589240792537, -1120.893850032649, -958.363469005279, -1068.155564788888, -1238.2156163495013, -674.2806778358943, -1072.3029847312955, -531.9936476202149, -1304.1949446171366, -291.2631511208013, -731.2072299747094, -808.6317562423435, -242.65222991779805, -1344.0281471245833, -947.7896587280597, -577.8529634324184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2805255646284736, "mean_inference_ms": 0.8966900890492346, "mean_action_processing_ms": 0.15860072620267926, "mean_env_wait_ms": 1.5417567062482505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0051555633544921875, "StateBufferConnector_ms": 0.004114866256713867, "ViewRequirementAgentConnector_ms": 0.09877824783325195}, "num_episodes": 28, "episode_return_max": -29.25036469054832, "episode_return_min": -1363.8339752639681, "episode_return_mean": -712.2716141544842, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 409.39430335051384, "num_env_steps_trained_throughput_per_sec": 409.39430335051384, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12184.092, "restore_workers_time_ms": 0.023, "training_step_time_ms": 12184.028, "sample_time_ms": 2374.704, "learn_time_ms": 9795.321, "learn_throughput": 408.358, "synch_weights_time_ms": 13.278}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "92003_00004", "date": "2024-08-03_04-46-44", "timestamp": 1722640604, "time_this_iter_s": 9.779729843139648, "time_total_s": 150.317631483078, "pid": 480833, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b327f4160>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 150.317631483078, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 13.985714285714286, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 111.80406737526258, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.581637731194496, "policy_loss": -0.008311771760054399, "vf_loss": 5.586048236737649, "vf_explained_var": 0.9201345549896359, "kl": 0.013502746962088481, "entropy": 1.495781135931611, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -8.442854511867047, "episode_reward_min": -1344.0281471245833, "episode_reward_mean": -687.2821623837269, "episode_len_mean": 136.38, "episode_media": {}, "episodes_timesteps_total": 13638, "policy_reward_min": {"policy_0": -1344.0281471245833}, "policy_reward_max": {"policy_0": -8.442854511867047}, "policy_reward_mean": {"policy_0": -687.2821623837269}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-49.49839084807549, -767.3770057213162, -471.92003067438435, -348.0500582986118, -980.7948779564674, -1128.2154967708127, -628.6017224077659, -943.4613881966357, -675.6335784128878, -851.9484984426246, -752.9686023192809, -396.3196997902859, -1159.5205344286067, -129.49741437766647, -615.1740003972492, -738.2388619903885, -497.17133807915576, -1101.417046312861, -669.2818417423051, -188.98407086122452, -1052.5042853175632, -423.07170881128434, -475.01724521071554, -46.21359298706928, -989.115907305333, -445.30390548378557, -605.8792035638207, -1043.7802187113848, -470.9931617289874, -234.9329550020267, -706.488107632083, -908.7172393269857, -832.0682395131253, -32.27280201486489, -931.7408854115155, -194.04417521190513, -773.8670954265757, -848.279110792892, -1218.3616800001598, -528.8784558420805, -471.86597561972553, -418.32352034175733, -353.40574972643213, -997.5465597997198, -580.3180634527286, -730.9847894429217, -869.8454853682778, -981.1799736274709, -348.25546200689433, -119.5410827077349, -1040.621598502884, -379.6874465139559, -82.60461543315131, -391.7767245330918, -1073.1589240792537, -1120.893850032649, -958.363469005279, -1068.155564788888, -1238.2156163495013, -674.2806778358943, -1072.3029847312955, -531.9936476202149, -1304.1949446171366, -291.2631511208013, -731.2072299747094, -808.6317562423435, -242.65222991779805, -1344.0281471245833, -947.7896587280597, -577.8529634324184, -547.3167217435686, -751.5709169362324, -225.66356129944165, -862.7701582058895, -363.6769025934878, -1051.638510779265, -825.1115301013187, -888.3871162985035, -987.5030359325501, -1038.703133940622, -42.37489857137322, -565.4770771872721, -1154.387684153766, -1195.9971609995687, -250.83046048071097, -1019.1328544075093, -325.3887601393306, -919.631634248136, -322.6854912341249, -1126.8419385634152, -823.442414499272, -741.5363232747758, -957.6206171723645, -1026.0224131838804, -610.6773197377535, -901.5985785528923, -239.30420866184386, -8.442854511867047, -333.0556283871996, -1014.8800365744285], "episode_lengths": [73, 150, 150, 89, 150, 150, 150, 150, 150, 150, 145, 150, 150, 79, 150, 150, 150, 150, 150, 78, 150, 150, 150, 57, 150, 150, 150, 150, 150, 78, 150, 150, 150, 46, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 139, 66, 150, 150, 150, 150, 150, 150, 150, 150, 147, 150, 113, 150, 150, 94, 150, 150, 150, 150, 150, 106, 150, 119, 150, 150, 150, 150, 150, 71, 132, 150, 150, 114, 150, 113, 150, 93, 150, 150, 150, 150, 150, 138, 150, 150, 36, 117, 150], "policy_policy_0_reward": [-49.49839084807549, -767.3770057213162, -471.92003067438435, -348.0500582986118, -980.7948779564674, -1128.2154967708127, -628.6017224077659, -943.4613881966357, -675.6335784128878, -851.9484984426246, -752.9686023192809, -396.3196997902859, -1159.5205344286067, -129.49741437766647, -615.1740003972492, -738.2388619903885, -497.17133807915576, -1101.417046312861, -669.2818417423051, -188.98407086122452, -1052.5042853175632, -423.07170881128434, -475.01724521071554, -46.21359298706928, -989.115907305333, -445.30390548378557, -605.8792035638207, -1043.7802187113848, -470.9931617289874, -234.9329550020267, -706.488107632083, -908.7172393269857, -832.0682395131253, -32.27280201486489, -931.7408854115155, -194.04417521190513, -773.8670954265757, -848.279110792892, -1218.3616800001598, -528.8784558420805, -471.86597561972553, -418.32352034175733, -353.40574972643213, -997.5465597997198, -580.3180634527286, -730.9847894429217, -869.8454853682778, -981.1799736274709, -348.25546200689433, -119.5410827077349, -1040.621598502884, -379.6874465139559, -82.60461543315131, -391.7767245330918, -1073.1589240792537, -1120.893850032649, -958.363469005279, -1068.155564788888, -1238.2156163495013, -674.2806778358943, -1072.3029847312955, -531.9936476202149, -1304.1949446171366, -291.2631511208013, -731.2072299747094, -808.6317562423435, -242.65222991779805, -1344.0281471245833, -947.7896587280597, -577.8529634324184, -547.3167217435686, -751.5709169362324, -225.66356129944165, -862.7701582058895, -363.6769025934878, -1051.638510779265, -825.1115301013187, -888.3871162985035, -987.5030359325501, -1038.703133940622, -42.37489857137322, -565.4770771872721, -1154.387684153766, -1195.9971609995687, -250.83046048071097, -1019.1328544075093, -325.3887601393306, -919.631634248136, -322.6854912341249, -1126.8419385634152, -823.442414499272, -741.5363232747758, -957.6206171723645, -1026.0224131838804, -610.6773197377535, -901.5985785528923, -239.30420866184386, -8.442854511867047, -333.0556283871996, -1014.8800365744285]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2804176752093954, "mean_inference_ms": 0.8940095922440741, "mean_action_processing_ms": 0.15842234231013871, "mean_env_wait_ms": 1.5428318513886443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0051116943359375, "StateBufferConnector_ms": 0.004084348678588867, "ViewRequirementAgentConnector_ms": 0.09799027442932129}, "num_episodes": 30, "episode_return_max": -8.442854511867047, "episode_return_min": -1344.0281471245833, "episode_return_mean": -687.2821623837269, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 376.57629954410544, "num_env_steps_trained_throughput_per_sec": 376.57629954410544, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 11831.376, "restore_workers_time_ms": 0.023, "training_step_time_ms": 11831.312, "sample_time_ms": 2380.592, "learn_time_ms": 9436.736, "learn_throughput": 423.875, "synch_weights_time_ms": 13.244}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "92003_00004", "date": "2024-08-03_04-46-55", "timestamp": 1722640615, "time_this_iter_s": 10.628495693206787, "time_total_s": 160.9461271762848, "pid": 480833, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b3270f490>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 160.9461271762848, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 13.599999999999998, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 104.0643894970417, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.877386302749316, "policy_loss": -0.012130729640678814, "vf_loss": 5.884522024293741, "vf_explained_var": 0.9152170938129226, "kl": 0.017170427359208908, "entropy": 1.5613161003837983, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -8.442854511867047, "episode_reward_min": -1356.3125150758462, "episode_reward_mean": -703.2812109549867, "episode_len_mean": 136.48, "episode_media": {}, "episodes_timesteps_total": 13648, "policy_reward_min": {"policy_0": -1356.3125150758462}, "policy_reward_max": {"policy_0": -8.442854511867047}, "policy_reward_mean": {"policy_0": -703.2812109549867}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-234.9329550020267, -706.488107632083, -908.7172393269857, -832.0682395131253, -32.27280201486489, -931.7408854115155, -194.04417521190513, -773.8670954265757, -848.279110792892, -1218.3616800001598, -528.8784558420805, -471.86597561972553, -418.32352034175733, -353.40574972643213, -997.5465597997198, -580.3180634527286, -730.9847894429217, -869.8454853682778, -981.1799736274709, -348.25546200689433, -119.5410827077349, -1040.621598502884, -379.6874465139559, -82.60461543315131, -391.7767245330918, -1073.1589240792537, -1120.893850032649, -958.363469005279, -1068.155564788888, -1238.2156163495013, -674.2806778358943, -1072.3029847312955, -531.9936476202149, -1304.1949446171366, -291.2631511208013, -731.2072299747094, -808.6317562423435, -242.65222991779805, -1344.0281471245833, -947.7896587280597, -577.8529634324184, -547.3167217435686, -751.5709169362324, -225.66356129944165, -862.7701582058895, -363.6769025934878, -1051.638510779265, -825.1115301013187, -888.3871162985035, -987.5030359325501, -1038.703133940622, -42.37489857137322, -565.4770771872721, -1154.387684153766, -1195.9971609995687, -250.83046048071097, -1019.1328544075093, -325.3887601393306, -919.631634248136, -322.6854912341249, -1126.8419385634152, -823.442414499272, -741.5363232747758, -957.6206171723645, -1026.0224131838804, -610.6773197377535, -901.5985785528923, -239.30420866184386, -8.442854511867047, -333.0556283871996, -1014.8800365744285, -712.32691287209, -836.6568481993461, -934.364269095775, -114.79602227109625, -618.5527780621821, -480.6798297372694, -1011.4212416584867, -375.46866203654605, -829.671756979067, -1061.0665485778493, -756.5883515235245, -1178.30002618872, -822.9276359933382, -1356.3125150758462, -169.96837933529702, -797.6477057393798, -352.6268446112972, -1289.38074738869, -623.2233550903676, -350.76585709772206, -993.4333746012882, -193.85358322568683, -608.030656658857, -481.3395139521633, -765.3070263085987, -1037.201026931433, -579.9505583420536, -191.9998144372454, -721.9967022833004], "episode_lengths": [78, 150, 150, 150, 46, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 139, 66, 150, 150, 150, 150, 150, 150, 150, 150, 147, 150, 113, 150, 150, 94, 150, 150, 150, 150, 150, 106, 150, 119, 150, 150, 150, 150, 150, 71, 132, 150, 150, 114, 150, 113, 150, 93, 150, 150, 150, 150, 150, 138, 150, 150, 36, 117, 150, 150, 150, 150, 65, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 114, 150, 125, 150, 150, 94, 150, 96, 150, 150, 150, 150, 150, 80, 150], "policy_policy_0_reward": [-234.9329550020267, -706.488107632083, -908.7172393269857, -832.0682395131253, -32.27280201486489, -931.7408854115155, -194.04417521190513, -773.8670954265757, -848.279110792892, -1218.3616800001598, -528.8784558420805, -471.86597561972553, -418.32352034175733, -353.40574972643213, -997.5465597997198, -580.3180634527286, -730.9847894429217, -869.8454853682778, -981.1799736274709, -348.25546200689433, -119.5410827077349, -1040.621598502884, -379.6874465139559, -82.60461543315131, -391.7767245330918, -1073.1589240792537, -1120.893850032649, -958.363469005279, -1068.155564788888, -1238.2156163495013, -674.2806778358943, -1072.3029847312955, -531.9936476202149, -1304.1949446171366, -291.2631511208013, -731.2072299747094, -808.6317562423435, -242.65222991779805, -1344.0281471245833, -947.7896587280597, -577.8529634324184, -547.3167217435686, -751.5709169362324, -225.66356129944165, -862.7701582058895, -363.6769025934878, -1051.638510779265, -825.1115301013187, -888.3871162985035, -987.5030359325501, -1038.703133940622, -42.37489857137322, -565.4770771872721, -1154.387684153766, -1195.9971609995687, -250.83046048071097, -1019.1328544075093, -325.3887601393306, -919.631634248136, -322.6854912341249, -1126.8419385634152, -823.442414499272, -741.5363232747758, -957.6206171723645, -1026.0224131838804, -610.6773197377535, -901.5985785528923, -239.30420866184386, -8.442854511867047, -333.0556283871996, -1014.8800365744285, -712.32691287209, -836.6568481993461, -934.364269095775, -114.79602227109625, -618.5527780621821, -480.6798297372694, -1011.4212416584867, -375.46866203654605, -829.671756979067, -1061.0665485778493, -756.5883515235245, -1178.30002618872, -822.9276359933382, -1356.3125150758462, -169.96837933529702, -797.6477057393798, -352.6268446112972, -1289.38074738869, -623.2233550903676, -350.76585709772206, -993.4333746012882, -193.85358322568683, -608.030656658857, -481.3395139521633, -765.3070263085987, -1037.201026931433, -579.9505583420536, -191.9998144372454, -721.9967022833004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28013123957573455, "mean_inference_ms": 0.8921351110850179, "mean_action_processing_ms": 0.15837180517623128, "mean_env_wait_ms": 1.5446606946935304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005190849304199219, "StateBufferConnector_ms": 0.003995180130004883, "ViewRequirementAgentConnector_ms": 0.09761404991149902}, "num_episodes": 29, "episode_return_max": -8.442854511867047, "episode_return_min": -1356.3125150758462, "episode_return_mean": -703.2812109549867, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 417.9419832151758, "num_env_steps_trained_throughput_per_sec": 417.9419832151758, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 11338.573, "restore_workers_time_ms": 0.023, "training_step_time_ms": 11338.509, "sample_time_ms": 2386.321, "learn_time_ms": 8938.495, "learn_throughput": 447.503, "synch_weights_time_ms": 12.955}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "92003_00004", "date": "2024-08-03_04-47-04", "timestamp": 1722640624, "time_this_iter_s": 9.577350616455078, "time_total_s": 170.52347779273987, "pid": 480833, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c78eef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 170.52347779273987, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 14.223076923076924, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 122.61402970353762, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.668632959574461, "policy_loss": -0.005901604801571618, "vf_loss": 5.670887216428915, "vf_explained_var": 0.9468947452182571, "kl": 0.012678197660928484, "entropy": 1.5611062860737244, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -8.442854511867047, "episode_reward_min": -1440.9502867478989, "episode_reward_mean": -680.8664072950097, "episode_len_mean": 132.69, "episode_media": {}, "episodes_timesteps_total": 13269, "policy_reward_min": {"policy_0": -1440.9502867478989}, "policy_reward_max": {"policy_0": -8.442854511867047}, "policy_reward_mean": {"policy_0": -680.8664072950097}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-291.2631511208013, -731.2072299747094, -808.6317562423435, -242.65222991779805, -1344.0281471245833, -947.7896587280597, -577.8529634324184, -547.3167217435686, -751.5709169362324, -225.66356129944165, -862.7701582058895, -363.6769025934878, -1051.638510779265, -825.1115301013187, -888.3871162985035, -987.5030359325501, -1038.703133940622, -42.37489857137322, -565.4770771872721, -1154.387684153766, -1195.9971609995687, -250.83046048071097, -1019.1328544075093, -325.3887601393306, -919.631634248136, -322.6854912341249, -1126.8419385634152, -823.442414499272, -741.5363232747758, -957.6206171723645, -1026.0224131838804, -610.6773197377535, -901.5985785528923, -239.30420866184386, -8.442854511867047, -333.0556283871996, -1014.8800365744285, -712.32691287209, -836.6568481993461, -934.364269095775, -114.79602227109625, -618.5527780621821, -480.6798297372694, -1011.4212416584867, -375.46866203654605, -829.671756979067, -1061.0665485778493, -756.5883515235245, -1178.30002618872, -822.9276359933382, -1356.3125150758462, -169.96837933529702, -797.6477057393798, -352.6268446112972, -1289.38074738869, -623.2233550903676, -350.76585709772206, -993.4333746012882, -193.85358322568683, -608.030656658857, -481.3395139521633, -765.3070263085987, -1037.201026931433, -579.9505583420536, -191.9998144372454, -721.9967022833004, -882.8855468866426, -228.87247925434085, -618.4119173963254, -66.54431992721402, -278.01600345515675, -937.3236522375711, -418.23866856464673, -638.7335895049521, -1132.5897349382792, -133.83081127422707, -9.273499526324713, -1161.8041052991255, -724.5836349254996, -68.78629537158143, -596.5416523414414, -68.20576946897896, -1040.9218639415317, -865.2372028316452, -825.2629879853442, -1086.7731083729934, -682.1489885160026, -166.18153627153046, -864.6414730847578, -1037.4828941346523, -1115.760964539624, -591.9616676365985, -176.12208137993846, -656.6779537728439, -281.73732447958355, -1109.61186684697, -921.8672093096134, -145.98563851837395, -1440.9502867478989, -801.7203775711596], "episode_lengths": [113, 150, 150, 94, 150, 150, 150, 150, 150, 106, 150, 119, 150, 150, 150, 150, 150, 71, 132, 150, 150, 114, 150, 113, 150, 93, 150, 150, 150, 150, 150, 138, 150, 150, 36, 117, 150, 150, 150, 150, 65, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 114, 150, 125, 150, 150, 94, 150, 96, 150, 150, 150, 150, 150, 80, 150, 150, 114, 150, 51, 94, 150, 150, 150, 150, 89, 40, 150, 150, 55, 150, 57, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 91, 150, 99, 150, 150, 69, 150, 150], "policy_policy_0_reward": [-291.2631511208013, -731.2072299747094, -808.6317562423435, -242.65222991779805, -1344.0281471245833, -947.7896587280597, -577.8529634324184, -547.3167217435686, -751.5709169362324, -225.66356129944165, -862.7701582058895, -363.6769025934878, -1051.638510779265, -825.1115301013187, -888.3871162985035, -987.5030359325501, -1038.703133940622, -42.37489857137322, -565.4770771872721, -1154.387684153766, -1195.9971609995687, -250.83046048071097, -1019.1328544075093, -325.3887601393306, -919.631634248136, -322.6854912341249, -1126.8419385634152, -823.442414499272, -741.5363232747758, -957.6206171723645, -1026.0224131838804, -610.6773197377535, -901.5985785528923, -239.30420866184386, -8.442854511867047, -333.0556283871996, -1014.8800365744285, -712.32691287209, -836.6568481993461, -934.364269095775, -114.79602227109625, -618.5527780621821, -480.6798297372694, -1011.4212416584867, -375.46866203654605, -829.671756979067, -1061.0665485778493, -756.5883515235245, -1178.30002618872, -822.9276359933382, -1356.3125150758462, -169.96837933529702, -797.6477057393798, -352.6268446112972, -1289.38074738869, -623.2233550903676, -350.76585709772206, -993.4333746012882, -193.85358322568683, -608.030656658857, -481.3395139521633, -765.3070263085987, -1037.201026931433, -579.9505583420536, -191.9998144372454, -721.9967022833004, -882.8855468866426, -228.87247925434085, -618.4119173963254, -66.54431992721402, -278.01600345515675, -937.3236522375711, -418.23866856464673, -638.7335895049521, -1132.5897349382792, -133.83081127422707, -9.273499526324713, -1161.8041052991255, -724.5836349254996, -68.78629537158143, -596.5416523414414, -68.20576946897896, -1040.9218639415317, -865.2372028316452, -825.2629879853442, -1086.7731083729934, -682.1489885160026, -166.18153627153046, -864.6414730847578, -1037.4828941346523, -1115.760964539624, -591.9616676365985, -176.12208137993846, -656.6779537728439, -281.73732447958355, -1109.61186684697, -921.8672093096134, -145.98563851837395, -1440.9502867478989, -801.7203775711596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27991796879035846, "mean_inference_ms": 0.8894933221614082, "mean_action_processing_ms": 0.15814119502214588, "mean_env_wait_ms": 1.5455333899269863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0053637027740478516, "StateBufferConnector_ms": 0.004064083099365234, "ViewRequirementAgentConnector_ms": 0.09897661209106445}, "num_episodes": 34, "episode_return_max": -8.442854511867047, "episode_return_min": -1440.9502867478989, "episode_return_mean": -680.8664072950097, "episodes_this_iter": 34}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 279.3454140580181, "num_env_steps_trained_throughput_per_sec": 279.3454140580181, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 11343.542, "restore_workers_time_ms": 0.023, "training_step_time_ms": 11343.479, "sample_time_ms": 2396.163, "learn_time_ms": 8933.593, "learn_throughput": 447.748, "synch_weights_time_ms": 12.988}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "92003_00004", "date": "2024-08-03_04-47-19", "timestamp": 1722640639, "time_this_iter_s": 14.326857328414917, "time_total_s": 184.85033512115479, "pid": 480833, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b3270fd90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 184.85033512115479, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 12.59047619047619, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 118.87776657144228, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.212239662061135, "policy_loss": -0.017156431192415767, "vf_loss": 5.224181729803482, "vf_explained_var": 0.9335624762500326, "kl": 0.01787543665897527, "entropy": 1.4825687718888123, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -8.442854511867047, "episode_reward_min": -1440.9502867478989, "episode_reward_mean": -660.8833368712804, "episode_len_mean": 131.2, "episode_media": {}, "episodes_timesteps_total": 13120, "policy_reward_min": {"policy_0": -1440.9502867478989}, "policy_reward_max": {"policy_0": -8.442854511867047}, "policy_reward_mean": {"policy_0": -660.8833368712804}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-957.6206171723645, -1026.0224131838804, -610.6773197377535, -901.5985785528923, -239.30420866184386, -8.442854511867047, -333.0556283871996, -1014.8800365744285, -712.32691287209, -836.6568481993461, -934.364269095775, -114.79602227109625, -618.5527780621821, -480.6798297372694, -1011.4212416584867, -375.46866203654605, -829.671756979067, -1061.0665485778493, -756.5883515235245, -1178.30002618872, -822.9276359933382, -1356.3125150758462, -169.96837933529702, -797.6477057393798, -352.6268446112972, -1289.38074738869, -623.2233550903676, -350.76585709772206, -993.4333746012882, -193.85358322568683, -608.030656658857, -481.3395139521633, -765.3070263085987, -1037.201026931433, -579.9505583420536, -191.9998144372454, -721.9967022833004, -882.8855468866426, -228.87247925434085, -618.4119173963254, -66.54431992721402, -278.01600345515675, -937.3236522375711, -418.23866856464673, -638.7335895049521, -1132.5897349382792, -133.83081127422707, -9.273499526324713, -1161.8041052991255, -724.5836349254996, -68.78629537158143, -596.5416523414414, -68.20576946897896, -1040.9218639415317, -865.2372028316452, -825.2629879853442, -1086.7731083729934, -682.1489885160026, -166.18153627153046, -864.6414730847578, -1037.4828941346523, -1115.760964539624, -591.9616676365985, -176.12208137993846, -656.6779537728439, -281.73732447958355, -1109.61186684697, -921.8672093096134, -145.98563851837395, -1440.9502867478989, -801.7203775711596, -95.15487580865334, -507.34141829498344, -670.715848476944, -174.18827859637412, -470.47015936065395, -732.1950582250028, -800.0948480940978, -85.92724984593553, -1031.6028093110606, -694.3621278849246, -655.0896065829799, -1288.3709279370585, -467.8897288905432, -680.0814650634777, -31.17776507241679, -1015.9602313236654, -702.8792715151101, -1169.9038584485622, -730.0954788321794, -654.8243433280977, -821.7683465992776, -573.7421246571878, -218.05743745057595, -528.630210833924, -1308.3266855530655, -991.3989355252081, -707.7967286144134, -1058.3172028626232, -108.82335676894436], "episode_lengths": [150, 150, 138, 150, 150, 36, 117, 150, 150, 150, 150, 65, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 114, 150, 125, 150, 150, 94, 150, 96, 150, 150, 150, 150, 150, 80, 150, 150, 114, 150, 51, 94, 150, 150, 150, 150, 89, 40, 150, 150, 55, 150, 57, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 91, 150, 99, 150, 150, 69, 150, 150, 82, 143, 150, 70, 111, 142, 150, 88, 150, 150, 150, 150, 130, 150, 50, 150, 150, 150, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 53], "policy_policy_0_reward": [-957.6206171723645, -1026.0224131838804, -610.6773197377535, -901.5985785528923, -239.30420866184386, -8.442854511867047, -333.0556283871996, -1014.8800365744285, -712.32691287209, -836.6568481993461, -934.364269095775, -114.79602227109625, -618.5527780621821, -480.6798297372694, -1011.4212416584867, -375.46866203654605, -829.671756979067, -1061.0665485778493, -756.5883515235245, -1178.30002618872, -822.9276359933382, -1356.3125150758462, -169.96837933529702, -797.6477057393798, -352.6268446112972, -1289.38074738869, -623.2233550903676, -350.76585709772206, -993.4333746012882, -193.85358322568683, -608.030656658857, -481.3395139521633, -765.3070263085987, -1037.201026931433, -579.9505583420536, -191.9998144372454, -721.9967022833004, -882.8855468866426, -228.87247925434085, -618.4119173963254, -66.54431992721402, -278.01600345515675, -937.3236522375711, -418.23866856464673, -638.7335895049521, -1132.5897349382792, -133.83081127422707, -9.273499526324713, -1161.8041052991255, -724.5836349254996, -68.78629537158143, -596.5416523414414, -68.20576946897896, -1040.9218639415317, -865.2372028316452, -825.2629879853442, -1086.7731083729934, -682.1489885160026, -166.18153627153046, -864.6414730847578, -1037.4828941346523, -1115.760964539624, -591.9616676365985, -176.12208137993846, -656.6779537728439, -281.73732447958355, -1109.61186684697, -921.8672093096134, -145.98563851837395, -1440.9502867478989, -801.7203775711596, -95.15487580865334, -507.34141829498344, -670.715848476944, -174.18827859637412, -470.47015936065395, -732.1950582250028, -800.0948480940978, -85.92724984593553, -1031.6028093110606, -694.3621278849246, -655.0896065829799, -1288.3709279370585, -467.8897288905432, -680.0814650634777, -31.17776507241679, -1015.9602313236654, -702.8792715151101, -1169.9038584485622, -730.0954788321794, -654.8243433280977, -821.7683465992776, -573.7421246571878, -218.05743745057595, -528.630210833924, -1308.3266855530655, -991.3989355252081, -707.7967286144134, -1058.3172028626232, -108.82335676894436]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2798393276055167, "mean_inference_ms": 0.8887225359748675, "mean_action_processing_ms": 0.15816581045827668, "mean_env_wait_ms": 1.5481704864805874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054552555084228516, "StateBufferConnector_ms": 0.004038810729980469, "ViewRequirementAgentConnector_ms": 0.09836125373840332}, "num_episodes": 29, "episode_return_max": -8.442854511867047, "episode_return_min": -1440.9502867478989, "episode_return_mean": -660.8833368712804, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 396.47350374298355, "num_env_steps_trained_throughput_per_sec": 396.47350374298355, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 10900.842, "restore_workers_time_ms": 0.022, "training_step_time_ms": 10900.78, "sample_time_ms": 2404.413, "learn_time_ms": 8483.013, "learn_throughput": 471.531, "synch_weights_time_ms": 12.628}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "92003_00004", "date": "2024-08-03_04-47-29", "timestamp": 1722640649, "time_this_iter_s": 10.096437931060791, "time_total_s": 194.94677305221558, "pid": 480833, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c787400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 194.94677305221558, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 13.971428571428573, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 162.7727720995744, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.087520006547371, "policy_loss": -0.01424593258513293, "vf_loss": 4.095953280975421, "vf_explained_var": 0.9718432721371452, "kl": 0.019903428839794894, "entropy": 1.5835493010779222, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -9.273499526324713, "episode_reward_min": -1440.9502867478989, "episode_reward_mean": -661.8610664539156, "episode_len_mean": 131.97, "episode_media": {}, "episodes_timesteps_total": 13197, "policy_reward_min": {"policy_0": -1440.9502867478989}, "policy_reward_max": {"policy_0": -9.273499526324713}, "policy_reward_mean": {"policy_0": -661.8610664539156}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-993.4333746012882, -193.85358322568683, -608.030656658857, -481.3395139521633, -765.3070263085987, -1037.201026931433, -579.9505583420536, -191.9998144372454, -721.9967022833004, -882.8855468866426, -228.87247925434085, -618.4119173963254, -66.54431992721402, -278.01600345515675, -937.3236522375711, -418.23866856464673, -638.7335895049521, -1132.5897349382792, -133.83081127422707, -9.273499526324713, -1161.8041052991255, -724.5836349254996, -68.78629537158143, -596.5416523414414, -68.20576946897896, -1040.9218639415317, -865.2372028316452, -825.2629879853442, -1086.7731083729934, -682.1489885160026, -166.18153627153046, -864.6414730847578, -1037.4828941346523, -1115.760964539624, -591.9616676365985, -176.12208137993846, -656.6779537728439, -281.73732447958355, -1109.61186684697, -921.8672093096134, -145.98563851837395, -1440.9502867478989, -801.7203775711596, -95.15487580865334, -507.34141829498344, -670.715848476944, -174.18827859637412, -470.47015936065395, -732.1950582250028, -800.0948480940978, -85.92724984593553, -1031.6028093110606, -694.3621278849246, -655.0896065829799, -1288.3709279370585, -467.8897288905432, -680.0814650634777, -31.17776507241679, -1015.9602313236654, -702.8792715151101, -1169.9038584485622, -730.0954788321794, -654.8243433280977, -821.7683465992776, -573.7421246571878, -218.05743745057595, -528.630210833924, -1308.3266855530655, -991.3989355252081, -707.7967286144134, -1058.3172028626232, -108.82335676894436, -273.5045610504456, -203.17463668942784, -975.6940190300404, -658.3092915377447, -85.51300622687548, -183.36102031194213, -661.8478217756582, -959.0020623914506, -976.1958831945977, -711.9326224904929, -654.817574164732, -444.6189401054687, -918.4611572342544, -939.769464432382, -838.1953259504468, -754.8170313726512, -1084.1891501938585, -1410.8050113232039, -774.7049767120484, -377.9722142170142, -160.58091095885217, -895.7914920737506, -894.7596036526013, -803.9807571674355, -677.2836433413521, -686.0536224301256, -1000.4917720920438, -856.293330458727], "episode_lengths": [150, 96, 150, 150, 150, 150, 150, 80, 150, 150, 114, 150, 51, 94, 150, 150, 150, 150, 89, 40, 150, 150, 55, 150, 57, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 91, 150, 99, 150, 150, 69, 150, 150, 82, 143, 150, 70, 111, 142, 150, 88, 150, 150, 150, 150, 130, 150, 50, 150, 150, 150, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 53, 107, 87, 150, 150, 44, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-993.4333746012882, -193.85358322568683, -608.030656658857, -481.3395139521633, -765.3070263085987, -1037.201026931433, -579.9505583420536, -191.9998144372454, -721.9967022833004, -882.8855468866426, -228.87247925434085, -618.4119173963254, -66.54431992721402, -278.01600345515675, -937.3236522375711, -418.23866856464673, -638.7335895049521, -1132.5897349382792, -133.83081127422707, -9.273499526324713, -1161.8041052991255, -724.5836349254996, -68.78629537158143, -596.5416523414414, -68.20576946897896, -1040.9218639415317, -865.2372028316452, -825.2629879853442, -1086.7731083729934, -682.1489885160026, -166.18153627153046, -864.6414730847578, -1037.4828941346523, -1115.760964539624, -591.9616676365985, -176.12208137993846, -656.6779537728439, -281.73732447958355, -1109.61186684697, -921.8672093096134, -145.98563851837395, -1440.9502867478989, -801.7203775711596, -95.15487580865334, -507.34141829498344, -670.715848476944, -174.18827859637412, -470.47015936065395, -732.1950582250028, -800.0948480940978, -85.92724984593553, -1031.6028093110606, -694.3621278849246, -655.0896065829799, -1288.3709279370585, -467.8897288905432, -680.0814650634777, -31.17776507241679, -1015.9602313236654, -702.8792715151101, -1169.9038584485622, -730.0954788321794, -654.8243433280977, -821.7683465992776, -573.7421246571878, -218.05743745057595, -528.630210833924, -1308.3266855530655, -991.3989355252081, -707.7967286144134, -1058.3172028626232, -108.82335676894436, -273.5045610504456, -203.17463668942784, -975.6940190300404, -658.3092915377447, -85.51300622687548, -183.36102031194213, -661.8478217756582, -959.0020623914506, -976.1958831945977, -711.9326224904929, -654.817574164732, -444.6189401054687, -918.4611572342544, -939.769464432382, -838.1953259504468, -754.8170313726512, -1084.1891501938585, -1410.8050113232039, -774.7049767120484, -377.9722142170142, -160.58091095885217, -895.7914920737506, -894.7596036526013, -803.9807571674355, -677.2836433413521, -686.0536224301256, -1000.4917720920438, -856.293330458727]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27967743166079356, "mean_inference_ms": 0.8881579854847073, "mean_action_processing_ms": 0.15824229725040548, "mean_env_wait_ms": 1.550989054190876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005443096160888672, "StateBufferConnector_ms": 0.004027605056762695, "ViewRequirementAgentConnector_ms": 0.0977325439453125}, "num_episodes": 28, "episode_return_max": -9.273499526324713, "episode_return_min": -1440.9502867478989, "episode_return_mean": -661.8610664539156, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 330.5716952738432, "num_env_steps_trained_throughput_per_sec": 330.5716952738432, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 10693.449, "restore_workers_time_ms": 0.022, "training_step_time_ms": 10693.386, "sample_time_ms": 2396.991, "learn_time_ms": 8282.704, "learn_throughput": 482.934, "synch_weights_time_ms": 12.955}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "92003_00004", "date": "2024-08-03_04-47-41", "timestamp": 1722640661, "time_this_iter_s": 12.107960939407349, "time_total_s": 207.05473399162292, "pid": 480833, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b32766b90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 207.05473399162292, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 13.305882352941177, "ram_util_percent": 16.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 143.8352791984876, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.536826654275258, "policy_loss": -0.009532953643550475, "vf_loss": 4.54201857422789, "vf_explained_var": 0.9714692647879323, "kl": 0.015064557797283386, "entropy": 1.7834150927762191, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -31.17776507241679, "episode_reward_min": -1440.9502867478989, "episode_reward_mean": -694.672103077415, "episode_len_mean": 135.72, "episode_media": {}, "episodes_timesteps_total": 13572, "policy_reward_min": {"policy_0": -1440.9502867478989}, "policy_reward_max": {"policy_0": -31.17776507241679}, "policy_reward_mean": {"policy_0": -694.672103077415}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-682.1489885160026, -166.18153627153046, -864.6414730847578, -1037.4828941346523, -1115.760964539624, -591.9616676365985, -176.12208137993846, -656.6779537728439, -281.73732447958355, -1109.61186684697, -921.8672093096134, -145.98563851837395, -1440.9502867478989, -801.7203775711596, -95.15487580865334, -507.34141829498344, -670.715848476944, -174.18827859637412, -470.47015936065395, -732.1950582250028, -800.0948480940978, -85.92724984593553, -1031.6028093110606, -694.3621278849246, -655.0896065829799, -1288.3709279370585, -467.8897288905432, -680.0814650634777, -31.17776507241679, -1015.9602313236654, -702.8792715151101, -1169.9038584485622, -730.0954788321794, -654.8243433280977, -821.7683465992776, -573.7421246571878, -218.05743745057595, -528.630210833924, -1308.3266855530655, -991.3989355252081, -707.7967286144134, -1058.3172028626232, -108.82335676894436, -273.5045610504456, -203.17463668942784, -975.6940190300404, -658.3092915377447, -85.51300622687548, -183.36102031194213, -661.8478217756582, -959.0020623914506, -976.1958831945977, -711.9326224904929, -654.817574164732, -444.6189401054687, -918.4611572342544, -939.769464432382, -838.1953259504468, -754.8170313726512, -1084.1891501938585, -1410.8050113232039, -774.7049767120484, -377.9722142170142, -160.58091095885217, -895.7914920737506, -894.7596036526013, -803.9807571674355, -677.2836433413521, -686.0536224301256, -1000.4917720920438, -856.293330458727, -942.0967642770207, -637.7335146148544, -969.866867254241, -657.3907944505984, -445.25431593597887, -206.63872100523767, -1011.0738570742872, -694.3843445451624, -1294.9753220105904, -617.2381671321037, -372.27480994612137, -174.5421452362753, -798.4219467386437, -1074.6035424565396, -1113.3323629335307, -226.3965646243779, -977.0643166426541, -353.04864014033416, -872.2608487598178, -1102.4397661265018, -683.6093475546352, -925.5260136726755, -1351.9333469073583, -189.54433438049966, -604.2979188945319, -415.7579869649107, -986.7219804013522, -419.9550765554348, -518.6691453581241], "episode_lengths": [150, 83, 150, 150, 150, 150, 91, 150, 99, 150, 150, 69, 150, 150, 82, 143, 150, 70, 111, 142, 150, 88, 150, 150, 150, 150, 130, 150, 50, 150, 150, 150, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 53, 107, 87, 150, 150, 44, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 111, 95, 150, 150, 150, 104, 150, 108, 150, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-682.1489885160026, -166.18153627153046, -864.6414730847578, -1037.4828941346523, -1115.760964539624, -591.9616676365985, -176.12208137993846, -656.6779537728439, -281.73732447958355, -1109.61186684697, -921.8672093096134, -145.98563851837395, -1440.9502867478989, -801.7203775711596, -95.15487580865334, -507.34141829498344, -670.715848476944, -174.18827859637412, -470.47015936065395, -732.1950582250028, -800.0948480940978, -85.92724984593553, -1031.6028093110606, -694.3621278849246, -655.0896065829799, -1288.3709279370585, -467.8897288905432, -680.0814650634777, -31.17776507241679, -1015.9602313236654, -702.8792715151101, -1169.9038584485622, -730.0954788321794, -654.8243433280977, -821.7683465992776, -573.7421246571878, -218.05743745057595, -528.630210833924, -1308.3266855530655, -991.3989355252081, -707.7967286144134, -1058.3172028626232, -108.82335676894436, -273.5045610504456, -203.17463668942784, -975.6940190300404, -658.3092915377447, -85.51300622687548, -183.36102031194213, -661.8478217756582, -959.0020623914506, -976.1958831945977, -711.9326224904929, -654.817574164732, -444.6189401054687, -918.4611572342544, -939.769464432382, -838.1953259504468, -754.8170313726512, -1084.1891501938585, -1410.8050113232039, -774.7049767120484, -377.9722142170142, -160.58091095885217, -895.7914920737506, -894.7596036526013, -803.9807571674355, -677.2836433413521, -686.0536224301256, -1000.4917720920438, -856.293330458727, -942.0967642770207, -637.7335146148544, -969.866867254241, -657.3907944505984, -445.25431593597887, -206.63872100523767, -1011.0738570742872, -694.3843445451624, -1294.9753220105904, -617.2381671321037, -372.27480994612137, -174.5421452362753, -798.4219467386437, -1074.6035424565396, -1113.3323629335307, -226.3965646243779, -977.0643166426541, -353.04864014033416, -872.2608487598178, -1102.4397661265018, -683.6093475546352, -925.5260136726755, -1351.9333469073583, -189.54433438049966, -604.2979188945319, -415.7579869649107, -986.7219804013522, -419.9550765554348, -518.6691453581241]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27966219848658874, "mean_inference_ms": 0.8876632360276866, "mean_action_processing_ms": 0.15833704451421232, "mean_env_wait_ms": 1.55438971240193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005476236343383789, "StateBufferConnector_ms": 0.0040891170501708984, "ViewRequirementAgentConnector_ms": 0.09913921356201172}, "num_episodes": 29, "episode_return_max": -31.17776507241679, "episode_return_min": -1440.9502867478989, "episode_return_mean": -694.672103077415, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 271.74537554510346, "num_env_steps_trained_throughput_per_sec": 271.74537554510346, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 11084.987, "restore_workers_time_ms": 0.022, "training_step_time_ms": 11084.924, "sample_time_ms": 2391.011, "learn_time_ms": 8679.862, "learn_throughput": 460.837, "synch_weights_time_ms": 13.304}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "92003_00004", "date": "2024-08-03_04-47-56", "timestamp": 1722640676, "time_this_iter_s": 14.728238821029663, "time_total_s": 221.7829728126526, "pid": 480833, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b327f57e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 221.7829728126526, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 12.599999999999998, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 160.5566195209821, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.864509180933237, "policy_loss": -0.013723173232089417, "vf_loss": 4.871970891704162, "vf_explained_var": 0.9781711731726924, "kl": 0.02148295418355704, "entropy": 1.8342635955661535, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": 5.571046619862219, "episode_reward_min": -1410.8050113232039, "episode_reward_mean": -723.0277754280949, "episode_len_mean": 136.73, "episode_media": {}, "episodes_timesteps_total": 13673, "policy_reward_min": {"policy_0": -1410.8050113232039}, "policy_reward_max": {"policy_0": 5.571046619862219}, "policy_reward_mean": {"policy_0": -723.0277754280949}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-730.0954788321794, -654.8243433280977, -821.7683465992776, -573.7421246571878, -218.05743745057595, -528.630210833924, -1308.3266855530655, -991.3989355252081, -707.7967286144134, -1058.3172028626232, -108.82335676894436, -273.5045610504456, -203.17463668942784, -975.6940190300404, -658.3092915377447, -85.51300622687548, -183.36102031194213, -661.8478217756582, -959.0020623914506, -976.1958831945977, -711.9326224904929, -654.817574164732, -444.6189401054687, -918.4611572342544, -939.769464432382, -838.1953259504468, -754.8170313726512, -1084.1891501938585, -1410.8050113232039, -774.7049767120484, -377.9722142170142, -160.58091095885217, -895.7914920737506, -894.7596036526013, -803.9807571674355, -677.2836433413521, -686.0536224301256, -1000.4917720920438, -856.293330458727, -942.0967642770207, -637.7335146148544, -969.866867254241, -657.3907944505984, -445.25431593597887, -206.63872100523767, -1011.0738570742872, -694.3843445451624, -1294.9753220105904, -617.2381671321037, -372.27480994612137, -174.5421452362753, -798.4219467386437, -1074.6035424565396, -1113.3323629335307, -226.3965646243779, -977.0643166426541, -353.04864014033416, -872.2608487598178, -1102.4397661265018, -683.6093475546352, -925.5260136726755, -1351.9333469073583, -189.54433438049966, -604.2979188945319, -415.7579869649107, -986.7219804013522, -419.9550765554348, -518.6691453581241, -379.95484251457003, -1199.6060773759461, -635.9646024230766, -1210.1116827986905, -754.6695741362275, -395.9770220001988, -1390.3788378523575, -1395.5385519122365, -287.7734487415697, 5.571046619862219, -87.72130970294408, -781.613706629658, -185.13293238356084, -1160.3701487773972, -1067.531646150867, -401.71582780183695, -483.31310044726627, -1100.1309081023865, -571.4645677528001, -272.722623979338, -1109.7821469115213, -100.83571341930022, -98.52631805534358, -1222.2378053954292, -865.6237185299689, -1119.6059178239364, -1204.4481215999213, -911.0869442210795, -1373.216042228303, -990.88827585727, -423.0099516214475, -926.4417060833672], "episode_lengths": [150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 53, 107, 87, 150, 150, 44, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 111, 95, 150, 150, 150, 104, 150, 108, 150, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 114, 150, 150, 150, 150, 150, 150, 150, 108, 39, 43, 150, 109, 150, 150, 128, 150, 150, 150, 112, 150, 69, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-730.0954788321794, -654.8243433280977, -821.7683465992776, -573.7421246571878, -218.05743745057595, -528.630210833924, -1308.3266855530655, -991.3989355252081, -707.7967286144134, -1058.3172028626232, -108.82335676894436, -273.5045610504456, -203.17463668942784, -975.6940190300404, -658.3092915377447, -85.51300622687548, -183.36102031194213, -661.8478217756582, -959.0020623914506, -976.1958831945977, -711.9326224904929, -654.817574164732, -444.6189401054687, -918.4611572342544, -939.769464432382, -838.1953259504468, -754.8170313726512, -1084.1891501938585, -1410.8050113232039, -774.7049767120484, -377.9722142170142, -160.58091095885217, -895.7914920737506, -894.7596036526013, -803.9807571674355, -677.2836433413521, -686.0536224301256, -1000.4917720920438, -856.293330458727, -942.0967642770207, -637.7335146148544, -969.866867254241, -657.3907944505984, -445.25431593597887, -206.63872100523767, -1011.0738570742872, -694.3843445451624, -1294.9753220105904, -617.2381671321037, -372.27480994612137, -174.5421452362753, -798.4219467386437, -1074.6035424565396, -1113.3323629335307, -226.3965646243779, -977.0643166426541, -353.04864014033416, -872.2608487598178, -1102.4397661265018, -683.6093475546352, -925.5260136726755, -1351.9333469073583, -189.54433438049966, -604.2979188945319, -415.7579869649107, -986.7219804013522, -419.9550765554348, -518.6691453581241, -379.95484251457003, -1199.6060773759461, -635.9646024230766, -1210.1116827986905, -754.6695741362275, -395.9770220001988, -1390.3788378523575, -1395.5385519122365, -287.7734487415697, 5.571046619862219, -87.72130970294408, -781.613706629658, -185.13293238356084, -1160.3701487773972, -1067.531646150867, -401.71582780183695, -483.31310044726627, -1100.1309081023865, -571.4645677528001, -272.722623979338, -1109.7821469115213, -100.83571341930022, -98.52631805534358, -1222.2378053954292, -865.6237185299689, -1119.6059178239364, -1204.4481215999213, -911.0869442210795, -1373.216042228303, -990.88827585727, -423.0099516214475, -926.4417060833672]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2795450436854814, "mean_inference_ms": 0.8867271336192563, "mean_action_processing_ms": 0.1582515701463948, "mean_env_wait_ms": 1.5561653224956404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052754878997802734, "StateBufferConnector_ms": 0.004018068313598633, "ViewRequirementAgentConnector_ms": 0.09771275520324707}, "num_episodes": 32, "episode_return_max": 5.571046619862219, "episode_return_min": -1410.8050113232039, "episode_return_mean": -723.0277754280949, "episodes_this_iter": 32}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.65527912660525, "num_env_steps_trained_throughput_per_sec": 292.65527912660525, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 11594.865, "restore_workers_time_ms": 0.022, "training_step_time_ms": 11594.801, "sample_time_ms": 2399.137, "learn_time_ms": 9180.93, "learn_throughput": 435.686, "synch_weights_time_ms": 13.979}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "92003_00004", "date": "2024-08-03_04-48-10", "timestamp": 1722640690, "time_this_iter_s": 13.676681756973267, "time_total_s": 235.45965456962585, "pid": 480833, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b327f6f80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 235.45965456962585, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 13.010000000000002, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 200.51068502267202, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.8946087832252183, "policy_loss": -0.015460895061066064, "vf_loss": 3.904015339662631, "vf_explained_var": 0.9847423049931725, "kl": 0.013837962782175377, "entropy": 1.7274199339250724, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 5.571046619862219, "episode_reward_min": -1410.8050113232039, "episode_reward_mean": -750.8609749125939, "episode_len_mean": 139.31, "episode_media": {}, "episodes_timesteps_total": 13931, "policy_reward_min": {"policy_0": -1410.8050113232039}, "policy_reward_max": {"policy_0": 5.571046619862219}, "policy_reward_mean": {"policy_0": -750.8609749125939}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-754.8170313726512, -1084.1891501938585, -1410.8050113232039, -774.7049767120484, -377.9722142170142, -160.58091095885217, -895.7914920737506, -894.7596036526013, -803.9807571674355, -677.2836433413521, -686.0536224301256, -1000.4917720920438, -856.293330458727, -942.0967642770207, -637.7335146148544, -969.866867254241, -657.3907944505984, -445.25431593597887, -206.63872100523767, -1011.0738570742872, -694.3843445451624, -1294.9753220105904, -617.2381671321037, -372.27480994612137, -174.5421452362753, -798.4219467386437, -1074.6035424565396, -1113.3323629335307, -226.3965646243779, -977.0643166426541, -353.04864014033416, -872.2608487598178, -1102.4397661265018, -683.6093475546352, -925.5260136726755, -1351.9333469073583, -189.54433438049966, -604.2979188945319, -415.7579869649107, -986.7219804013522, -419.9550765554348, -518.6691453581241, -379.95484251457003, -1199.6060773759461, -635.9646024230766, -1210.1116827986905, -754.6695741362275, -395.9770220001988, -1390.3788378523575, -1395.5385519122365, -287.7734487415697, 5.571046619862219, -87.72130970294408, -781.613706629658, -185.13293238356084, -1160.3701487773972, -1067.531646150867, -401.71582780183695, -483.31310044726627, -1100.1309081023865, -571.4645677528001, -272.722623979338, -1109.7821469115213, -100.83571341930022, -98.52631805534358, -1222.2378053954292, -865.6237185299689, -1119.6059178239364, -1204.4481215999213, -911.0869442210795, -1373.216042228303, -990.88827585727, -423.0099516214475, -926.4417060833672, -1186.48958802186, -1279.5169862355315, -455.9412021402283, -875.082260547082, -705.3989271603064, -1016.010932428703, -1061.586186162496, -882.9096586481478, -914.5063778864417, -636.3935143585843, -905.2518087086, -703.6118333338583, -932.8237876422692, -1215.9088163277995, -231.61623525384826, -102.08251219640196, -727.4716260340076, -604.928194018895, -181.81568967103706, -858.7962157791511, -757.5263579347084, -730.7342550096455, -421.7543748797498, -1072.7316214670582, -746.0353728821727, -762.5738513327807], "episode_lengths": [150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 111, 95, 150, 150, 150, 104, 150, 108, 150, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 114, 150, 150, 150, 150, 150, 150, 150, 108, 39, 43, 150, 109, 150, 150, 128, 150, 150, 150, 112, 150, 69, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 72, 150, 150, 96, 150, 150, 150, 136, 150, 150, 150], "policy_policy_0_reward": [-754.8170313726512, -1084.1891501938585, -1410.8050113232039, -774.7049767120484, -377.9722142170142, -160.58091095885217, -895.7914920737506, -894.7596036526013, -803.9807571674355, -677.2836433413521, -686.0536224301256, -1000.4917720920438, -856.293330458727, -942.0967642770207, -637.7335146148544, -969.866867254241, -657.3907944505984, -445.25431593597887, -206.63872100523767, -1011.0738570742872, -694.3843445451624, -1294.9753220105904, -617.2381671321037, -372.27480994612137, -174.5421452362753, -798.4219467386437, -1074.6035424565396, -1113.3323629335307, -226.3965646243779, -977.0643166426541, -353.04864014033416, -872.2608487598178, -1102.4397661265018, -683.6093475546352, -925.5260136726755, -1351.9333469073583, -189.54433438049966, -604.2979188945319, -415.7579869649107, -986.7219804013522, -419.9550765554348, -518.6691453581241, -379.95484251457003, -1199.6060773759461, -635.9646024230766, -1210.1116827986905, -754.6695741362275, -395.9770220001988, -1390.3788378523575, -1395.5385519122365, -287.7734487415697, 5.571046619862219, -87.72130970294408, -781.613706629658, -185.13293238356084, -1160.3701487773972, -1067.531646150867, -401.71582780183695, -483.31310044726627, -1100.1309081023865, -571.4645677528001, -272.722623979338, -1109.7821469115213, -100.83571341930022, -98.52631805534358, -1222.2378053954292, -865.6237185299689, -1119.6059178239364, -1204.4481215999213, -911.0869442210795, -1373.216042228303, -990.88827585727, -423.0099516214475, -926.4417060833672, -1186.48958802186, -1279.5169862355315, -455.9412021402283, -875.082260547082, -705.3989271603064, -1016.010932428703, -1061.586186162496, -882.9096586481478, -914.5063778864417, -636.3935143585843, -905.2518087086, -703.6118333338583, -932.8237876422692, -1215.9088163277995, -231.61623525384826, -102.08251219640196, -727.4716260340076, -604.928194018895, -181.81568967103706, -858.7962157791511, -757.5263579347084, -730.7342550096455, -421.7543748797498, -1072.7316214670582, -746.0353728821727, -762.5738513327807]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2794828433240125, "mean_inference_ms": 0.8866164334314199, "mean_action_processing_ms": 0.15831568473252047, "mean_env_wait_ms": 1.5587897366510979, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005178213119506836, "StateBufferConnector_ms": 0.00400090217590332, "ViewRequirementAgentConnector_ms": 0.09728240966796875}, "num_episodes": 26, "episode_return_max": 5.571046619862219, "episode_return_min": -1410.8050113232039, "episode_return_mean": -750.8609749125939, "episodes_this_iter": 26}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 278.9240350852226, "num_env_steps_trained_throughput_per_sec": 278.9240350852226, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 11776.015, "restore_workers_time_ms": 0.021, "training_step_time_ms": 11775.951, "sample_time_ms": 2400.733, "learn_time_ms": 9360.422, "learn_throughput": 427.331, "synch_weights_time_ms": 14.0}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "92003_00004", "date": "2024-08-03_04-48-24", "timestamp": 1722640704, "time_this_iter_s": 14.34600043296814, "time_total_s": 249.805655002594, "pid": 480833, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b327f77f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 249.805655002594, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 12.84, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 185.47274312973022, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.439814999823769, "policy_loss": -0.011897930176443576, "vf_loss": 4.446189755946397, "vf_explained_var": 0.9787542472903927, "kl": 0.012635712775772866, "entropy": 1.6289560096959272, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": 5.571046619862219, "episode_reward_min": -1395.5385519122365, "episode_reward_mean": -719.8599163931664, "episode_len_mean": 137.04, "episode_media": {}, "episodes_timesteps_total": 13704, "policy_reward_min": {"policy_0": -1395.5385519122365}, "policy_reward_max": {"policy_0": 5.571046619862219}, "policy_reward_mean": {"policy_0": -719.8599163931664}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-977.0643166426541, -353.04864014033416, -872.2608487598178, -1102.4397661265018, -683.6093475546352, -925.5260136726755, -1351.9333469073583, -189.54433438049966, -604.2979188945319, -415.7579869649107, -986.7219804013522, -419.9550765554348, -518.6691453581241, -379.95484251457003, -1199.6060773759461, -635.9646024230766, -1210.1116827986905, -754.6695741362275, -395.9770220001988, -1390.3788378523575, -1395.5385519122365, -287.7734487415697, 5.571046619862219, -87.72130970294408, -781.613706629658, -185.13293238356084, -1160.3701487773972, -1067.531646150867, -401.71582780183695, -483.31310044726627, -1100.1309081023865, -571.4645677528001, -272.722623979338, -1109.7821469115213, -100.83571341930022, -98.52631805534358, -1222.2378053954292, -865.6237185299689, -1119.6059178239364, -1204.4481215999213, -911.0869442210795, -1373.216042228303, -990.88827585727, -423.0099516214475, -926.4417060833672, -1186.48958802186, -1279.5169862355315, -455.9412021402283, -875.082260547082, -705.3989271603064, -1016.010932428703, -1061.586186162496, -882.9096586481478, -914.5063778864417, -636.3935143585843, -905.2518087086, -703.6118333338583, -932.8237876422692, -1215.9088163277995, -231.61623525384826, -102.08251219640196, -727.4716260340076, -604.928194018895, -181.81568967103706, -858.7962157791511, -757.5263579347084, -730.7342550096455, -421.7543748797498, -1072.7316214670582, -746.0353728821727, -762.5738513327807, -681.6586604847053, -681.8697483138192, -68.79766010157782, -394.5412484087564, -801.4657262384745, -435.80239961258246, -591.6338440855716, -1042.5956585984347, -1007.4959775580992, -438.02370007342046, -503.94122570472825, -784.4314493748415, -812.1556861093745, -135.82959960009333, -823.0981230490218, -576.7579878466868, -732.1579221036399, -286.1621101624411, -345.0002664075468, -339.58504367119156, -1107.225358633629, -949.5442929326068, -618.5472792504443, -734.8935201466618, -1110.3720784983889, -442.4830350594175, -200.21208939938663, -716.5996574250049, -1150.9603554359655], "episode_lengths": [150, 108, 150, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 114, 150, 150, 150, 150, 150, 150, 150, 108, 39, 43, 150, 109, 150, 150, 128, 150, 150, 150, 112, 150, 69, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 72, 150, 150, 96, 150, 150, 150, 136, 150, 150, 150, 150, 150, 54, 109, 150, 150, 150, 150, 150, 150, 116, 150, 150, 71, 150, 150, 150, 128, 117, 95, 150, 150, 150, 150, 150, 105, 98, 150, 150], "policy_policy_0_reward": [-977.0643166426541, -353.04864014033416, -872.2608487598178, -1102.4397661265018, -683.6093475546352, -925.5260136726755, -1351.9333469073583, -189.54433438049966, -604.2979188945319, -415.7579869649107, -986.7219804013522, -419.9550765554348, -518.6691453581241, -379.95484251457003, -1199.6060773759461, -635.9646024230766, -1210.1116827986905, -754.6695741362275, -395.9770220001988, -1390.3788378523575, -1395.5385519122365, -287.7734487415697, 5.571046619862219, -87.72130970294408, -781.613706629658, -185.13293238356084, -1160.3701487773972, -1067.531646150867, -401.71582780183695, -483.31310044726627, -1100.1309081023865, -571.4645677528001, -272.722623979338, -1109.7821469115213, -100.83571341930022, -98.52631805534358, -1222.2378053954292, -865.6237185299689, -1119.6059178239364, -1204.4481215999213, -911.0869442210795, -1373.216042228303, -990.88827585727, -423.0099516214475, -926.4417060833672, -1186.48958802186, -1279.5169862355315, -455.9412021402283, -875.082260547082, -705.3989271603064, -1016.010932428703, -1061.586186162496, -882.9096586481478, -914.5063778864417, -636.3935143585843, -905.2518087086, -703.6118333338583, -932.8237876422692, -1215.9088163277995, -231.61623525384826, -102.08251219640196, -727.4716260340076, -604.928194018895, -181.81568967103706, -858.7962157791511, -757.5263579347084, -730.7342550096455, -421.7543748797498, -1072.7316214670582, -746.0353728821727, -762.5738513327807, -681.6586604847053, -681.8697483138192, -68.79766010157782, -394.5412484087564, -801.4657262384745, -435.80239961258246, -591.6338440855716, -1042.5956585984347, -1007.4959775580992, -438.02370007342046, -503.94122570472825, -784.4314493748415, -812.1556861093745, -135.82959960009333, -823.0981230490218, -576.7579878466868, -732.1579221036399, -286.1621101624411, -345.0002664075468, -339.58504367119156, -1107.225358633629, -949.5442929326068, -618.5472792504443, -734.8935201466618, -1110.3720784983889, -442.4830350594175, -200.21208939938663, -716.5996574250049, -1150.9603554359655]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2794390660731237, "mean_inference_ms": 0.8859937369571587, "mean_action_processing_ms": 0.1583528563283314, "mean_env_wait_ms": 1.5611848078461845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005100250244140625, "StateBufferConnector_ms": 0.003953695297241211, "ViewRequirementAgentConnector_ms": 0.09658169746398926}, "num_episodes": 29, "episode_return_max": 5.571046619862219, "episode_return_min": -1395.5385519122365, "episode_return_mean": -719.8599163931664, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 278.313524368493, "num_env_steps_trained_throughput_per_sec": 278.313524368493, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12357.25, "restore_workers_time_ms": 0.022, "training_step_time_ms": 12357.185, "sample_time_ms": 2399.519, "learn_time_ms": 9942.637, "learn_throughput": 402.308, "synch_weights_time_ms": 14.23}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "92003_00004", "date": "2024-08-03_04-48-38", "timestamp": 1722640718, "time_this_iter_s": 14.379390239715576, "time_total_s": 264.18504524230957, "pid": 480833, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b5814f9a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 264.18504524230957, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 12.614285714285716, "ram_util_percent": 16.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 194.84908433357876, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.6976897325366735, "policy_loss": -0.009022094945733746, "vf_loss": 3.701160379871726, "vf_explained_var": 0.9766563488791387, "kl": 0.01271400841117917, "entropy": 1.698560170456767, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -20.03505157916737, "episode_reward_min": -1400.166955562084, "episode_reward_mean": -723.2254810464307, "episode_len_mean": 137.72, "episode_media": {}, "episodes_timesteps_total": 13772, "policy_reward_min": {"policy_0": -1400.166955562084}, "policy_reward_max": {"policy_0": -20.03505157916737}, "policy_reward_mean": {"policy_0": -723.2254810464307}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-571.4645677528001, -272.722623979338, -1109.7821469115213, -100.83571341930022, -98.52631805534358, -1222.2378053954292, -865.6237185299689, -1119.6059178239364, -1204.4481215999213, -911.0869442210795, -1373.216042228303, -990.88827585727, -423.0099516214475, -926.4417060833672, -1186.48958802186, -1279.5169862355315, -455.9412021402283, -875.082260547082, -705.3989271603064, -1016.010932428703, -1061.586186162496, -882.9096586481478, -914.5063778864417, -636.3935143585843, -905.2518087086, -703.6118333338583, -932.8237876422692, -1215.9088163277995, -231.61623525384826, -102.08251219640196, -727.4716260340076, -604.928194018895, -181.81568967103706, -858.7962157791511, -757.5263579347084, -730.7342550096455, -421.7543748797498, -1072.7316214670582, -746.0353728821727, -762.5738513327807, -681.6586604847053, -681.8697483138192, -68.79766010157782, -394.5412484087564, -801.4657262384745, -435.80239961258246, -591.6338440855716, -1042.5956585984347, -1007.4959775580992, -438.02370007342046, -503.94122570472825, -784.4314493748415, -812.1556861093745, -135.82959960009333, -823.0981230490218, -576.7579878466868, -732.1579221036399, -286.1621101624411, -345.0002664075468, -339.58504367119156, -1107.225358633629, -949.5442929326068, -618.5472792504443, -734.8935201466618, -1110.3720784983889, -442.4830350594175, -200.21208939938663, -716.5996574250049, -1150.9603554359655, -1400.166955562084, -825.0288947118761, -972.7247000640408, -560.7800153804237, -975.11240168975, -1188.6423619122688, -594.7258295829541, -1085.0387139829038, -20.03505157916737, -912.4364993199353, -1047.9079226797703, -194.74743725919623, -824.0867847465719, -392.2388837600049, -146.42615339927545, -1338.705674200275, -693.4757660268208, -891.3700644845451, -885.59777466115, -630.3882142118259, -1338.2825208154457, -763.6613956395546, -453.2254536669659, -486.49329817245285, -752.7020851371825, -519.8679245333677, -45.881797019207234, -405.81468825185215, -833.2735976889501, -123.6334009194623, -1346.8460997568757], "episode_lengths": [150, 112, 150, 69, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 72, 150, 150, 96, 150, 150, 150, 136, 150, 150, 150, 150, 150, 54, 109, 150, 150, 150, 150, 150, 150, 116, 150, 150, 71, 150, 150, 150, 128, 117, 95, 150, 150, 150, 150, 150, 105, 98, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 64, 150, 117, 111, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 136, 65, 150, 150, 106, 150], "policy_policy_0_reward": [-571.4645677528001, -272.722623979338, -1109.7821469115213, -100.83571341930022, -98.52631805534358, -1222.2378053954292, -865.6237185299689, -1119.6059178239364, -1204.4481215999213, -911.0869442210795, -1373.216042228303, -990.88827585727, -423.0099516214475, -926.4417060833672, -1186.48958802186, -1279.5169862355315, -455.9412021402283, -875.082260547082, -705.3989271603064, -1016.010932428703, -1061.586186162496, -882.9096586481478, -914.5063778864417, -636.3935143585843, -905.2518087086, -703.6118333338583, -932.8237876422692, -1215.9088163277995, -231.61623525384826, -102.08251219640196, -727.4716260340076, -604.928194018895, -181.81568967103706, -858.7962157791511, -757.5263579347084, -730.7342550096455, -421.7543748797498, -1072.7316214670582, -746.0353728821727, -762.5738513327807, -681.6586604847053, -681.8697483138192, -68.79766010157782, -394.5412484087564, -801.4657262384745, -435.80239961258246, -591.6338440855716, -1042.5956585984347, -1007.4959775580992, -438.02370007342046, -503.94122570472825, -784.4314493748415, -812.1556861093745, -135.82959960009333, -823.0981230490218, -576.7579878466868, -732.1579221036399, -286.1621101624411, -345.0002664075468, -339.58504367119156, -1107.225358633629, -949.5442929326068, -618.5472792504443, -734.8935201466618, -1110.3720784983889, -442.4830350594175, -200.21208939938663, -716.5996574250049, -1150.9603554359655, -1400.166955562084, -825.0288947118761, -972.7247000640408, -560.7800153804237, -975.11240168975, -1188.6423619122688, -594.7258295829541, -1085.0387139829038, -20.03505157916737, -912.4364993199353, -1047.9079226797703, -194.74743725919623, -824.0867847465719, -392.2388837600049, -146.42615339927545, -1338.705674200275, -693.4757660268208, -891.3700644845451, -885.59777466115, -630.3882142118259, -1338.2825208154457, -763.6613956395546, -453.2254536669659, -486.49329817245285, -752.7020851371825, -519.8679245333677, -45.881797019207234, -405.81468825185215, -833.2735976889501, -123.6334009194623, -1346.8460997568757]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27954877612273726, "mean_inference_ms": 0.8855836297518789, "mean_action_processing_ms": 0.1584304921029767, "mean_env_wait_ms": 1.5634616072743786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005411386489868164, "StateBufferConnector_ms": 0.004075050354003906, "ViewRequirementAgentConnector_ms": 0.09945106506347656}, "num_episodes": 31, "episode_return_max": -20.03505157916737, "episode_return_min": -1400.166955562084, "episode_return_mean": -723.2254810464307, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 280.0141111809445, "num_env_steps_trained_throughput_per_sec": 280.0141111809445, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12808.697, "restore_workers_time_ms": 0.024, "training_step_time_ms": 12808.627, "sample_time_ms": 2400.463, "learn_time_ms": 10392.897, "learn_throughput": 384.878, "synch_weights_time_ms": 14.427}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "92003_00004", "date": "2024-08-03_04-48-53", "timestamp": 1722640733, "time_this_iter_s": 14.290671348571777, "time_total_s": 278.47571659088135, "pid": 480833, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b327f70a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 278.47571659088135, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 12.715, "ram_util_percent": 16.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 189.05361273090045, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.335764726251364, "policy_loss": -0.011423870716438007, "vf_loss": 4.341516392926375, "vf_explained_var": 0.9810999744882186, "kl": 0.012972340203790155, "entropy": 1.6534812403221926, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -20.03505157916737, "episode_reward_min": -1400.166955562084, "episode_reward_mean": -674.8638677757149, "episode_len_mean": 135.59, "episode_media": {}, "episodes_timesteps_total": 13559, "policy_reward_min": {"policy_0": -1400.166955562084}, "policy_reward_max": {"policy_0": -20.03505157916737}, "policy_reward_mean": {"policy_0": -674.8638677757149}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-727.4716260340076, -604.928194018895, -181.81568967103706, -858.7962157791511, -757.5263579347084, -730.7342550096455, -421.7543748797498, -1072.7316214670582, -746.0353728821727, -762.5738513327807, -681.6586604847053, -681.8697483138192, -68.79766010157782, -394.5412484087564, -801.4657262384745, -435.80239961258246, -591.6338440855716, -1042.5956585984347, -1007.4959775580992, -438.02370007342046, -503.94122570472825, -784.4314493748415, -812.1556861093745, -135.82959960009333, -823.0981230490218, -576.7579878466868, -732.1579221036399, -286.1621101624411, -345.0002664075468, -339.58504367119156, -1107.225358633629, -949.5442929326068, -618.5472792504443, -734.8935201466618, -1110.3720784983889, -442.4830350594175, -200.21208939938663, -716.5996574250049, -1150.9603554359655, -1400.166955562084, -825.0288947118761, -972.7247000640408, -560.7800153804237, -975.11240168975, -1188.6423619122688, -594.7258295829541, -1085.0387139829038, -20.03505157916737, -912.4364993199353, -1047.9079226797703, -194.74743725919623, -824.0867847465719, -392.2388837600049, -146.42615339927545, -1338.705674200275, -693.4757660268208, -891.3700644845451, -885.59777466115, -630.3882142118259, -1338.2825208154457, -763.6613956395546, -453.2254536669659, -486.49329817245285, -752.7020851371825, -519.8679245333677, -45.881797019207234, -405.81468825185215, -833.2735976889501, -123.6334009194623, -1346.8460997568757, -485.7309447290897, -370.15366566184474, -723.3402112287881, -482.1725085840642, -1264.571072769965, -521.579534171329, -1156.1650521818005, -1038.9932762532296, -727.2102356835896, -917.0536522900155, -167.77945304475645, -213.2727110335911, -156.1299349793419, -1110.8715365186936, -1274.9530651819807, -257.8639737366714, -118.4380740337972, -1193.1949493350317, -1101.3671100067406, -761.749933747971, -822.7548321632281, -41.356349004071596, -569.180772203181, -674.193932678939, -617.2468478679814, -55.66494901746221, -640.2009929256121, -854.1659017054251, -378.53588468745914, -762.9677960339592], "episode_lengths": [150, 150, 96, 150, 150, 150, 136, 150, 150, 150, 150, 150, 54, 109, 150, 150, 150, 150, 150, 150, 116, 150, 150, 71, 150, 150, 150, 128, 117, 95, 150, 150, 150, 150, 150, 105, 98, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 64, 150, 117, 111, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 136, 65, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 62, 150, 76, 150, 150, 111, 81, 150, 150, 150, 150, 43, 150, 150, 137, 58, 150, 150, 119, 150], "policy_policy_0_reward": [-727.4716260340076, -604.928194018895, -181.81568967103706, -858.7962157791511, -757.5263579347084, -730.7342550096455, -421.7543748797498, -1072.7316214670582, -746.0353728821727, -762.5738513327807, -681.6586604847053, -681.8697483138192, -68.79766010157782, -394.5412484087564, -801.4657262384745, -435.80239961258246, -591.6338440855716, -1042.5956585984347, -1007.4959775580992, -438.02370007342046, -503.94122570472825, -784.4314493748415, -812.1556861093745, -135.82959960009333, -823.0981230490218, -576.7579878466868, -732.1579221036399, -286.1621101624411, -345.0002664075468, -339.58504367119156, -1107.225358633629, -949.5442929326068, -618.5472792504443, -734.8935201466618, -1110.3720784983889, -442.4830350594175, -200.21208939938663, -716.5996574250049, -1150.9603554359655, -1400.166955562084, -825.0288947118761, -972.7247000640408, -560.7800153804237, -975.11240168975, -1188.6423619122688, -594.7258295829541, -1085.0387139829038, -20.03505157916737, -912.4364993199353, -1047.9079226797703, -194.74743725919623, -824.0867847465719, -392.2388837600049, -146.42615339927545, -1338.705674200275, -693.4757660268208, -891.3700644845451, -885.59777466115, -630.3882142118259, -1338.2825208154457, -763.6613956395546, -453.2254536669659, -486.49329817245285, -752.7020851371825, -519.8679245333677, -45.881797019207234, -405.81468825185215, -833.2735976889501, -123.6334009194623, -1346.8460997568757, -485.7309447290897, -370.15366566184474, -723.3402112287881, -482.1725085840642, -1264.571072769965, -521.579534171329, -1156.1650521818005, -1038.9932762532296, -727.2102356835896, -917.0536522900155, -167.77945304475645, -213.2727110335911, -156.1299349793419, -1110.8715365186936, -1274.9530651819807, -257.8639737366714, -118.4380740337972, -1193.1949493350317, -1101.3671100067406, -761.749933747971, -822.7548321632281, -41.356349004071596, -569.180772203181, -674.193932678939, -617.2468478679814, -55.66494901746221, -640.2009929256121, -854.1659017054251, -378.53588468745914, -762.9677960339592]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.279642898831482, "mean_inference_ms": 0.884843124791692, "mean_action_processing_ms": 0.1583778666808753, "mean_env_wait_ms": 1.563654675548135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00565028190612793, "StateBufferConnector_ms": 0.004091501235961914, "ViewRequirementAgentConnector_ms": 0.09929656982421875}, "num_episodes": 30, "episode_return_max": -20.03505157916737, "episode_return_min": -1400.166955562084, "episode_return_mean": -674.8638677757149, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 278.97024739222627, "num_env_steps_trained_throughput_per_sec": 278.97024739222627, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 13180.34, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13180.27, "sample_time_ms": 2403.216, "learn_time_ms": 10761.759, "learn_throughput": 371.686, "synch_weights_time_ms": 14.464}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "92003_00004", "date": "2024-08-03_04-49-07", "timestamp": 1722640747, "time_this_iter_s": 14.345579624176025, "time_total_s": 292.8212962150574, "pid": 480833, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b3270edd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 292.8212962150574, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 12.604761904761904, "ram_util_percent": 16.204761904761902}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 255.3655268927415, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.478732416778803, "policy_loss": -0.007065658839807535, "vf_loss": 3.4806200090795754, "vf_explained_var": 0.9830653835088015, "kl": 0.01193342424691463, "entropy": 1.919740875934561, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -16.634930803627842, "episode_reward_min": -1400.166955562084, "episode_reward_mean": -706.7440972744549, "episode_len_mean": 135.7, "episode_media": {}, "episodes_timesteps_total": 13570, "policy_reward_min": {"policy_0": -1400.166955562084}, "policy_reward_max": {"policy_0": -16.634930803627842}, "policy_reward_mean": {"policy_0": -706.7440972744549}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-345.0002664075468, -339.58504367119156, -1107.225358633629, -949.5442929326068, -618.5472792504443, -734.8935201466618, -1110.3720784983889, -442.4830350594175, -200.21208939938663, -716.5996574250049, -1150.9603554359655, -1400.166955562084, -825.0288947118761, -972.7247000640408, -560.7800153804237, -975.11240168975, -1188.6423619122688, -594.7258295829541, -1085.0387139829038, -20.03505157916737, -912.4364993199353, -1047.9079226797703, -194.74743725919623, -824.0867847465719, -392.2388837600049, -146.42615339927545, -1338.705674200275, -693.4757660268208, -891.3700644845451, -885.59777466115, -630.3882142118259, -1338.2825208154457, -763.6613956395546, -453.2254536669659, -486.49329817245285, -752.7020851371825, -519.8679245333677, -45.881797019207234, -405.81468825185215, -833.2735976889501, -123.6334009194623, -1346.8460997568757, -485.7309447290897, -370.15366566184474, -723.3402112287881, -482.1725085840642, -1264.571072769965, -521.579534171329, -1156.1650521818005, -1038.9932762532296, -727.2102356835896, -917.0536522900155, -167.77945304475645, -213.2727110335911, -156.1299349793419, -1110.8715365186936, -1274.9530651819807, -257.8639737366714, -118.4380740337972, -1193.1949493350317, -1101.3671100067406, -761.749933747971, -822.7548321632281, -41.356349004071596, -569.180772203181, -674.193932678939, -617.2468478679814, -55.66494901746221, -640.2009929256121, -854.1659017054251, -378.53588468745914, -762.9677960339592, -990.6898092116245, -574.5727529531009, -456.49249628023676, -975.5723954122321, -525.0524153431911, -829.3868197386561, -1028.940537284575, -1056.6960392710914, -1209.8394135654733, -878.1744866105965, -998.9578396198854, -582.6469834892856, -16.634930803627842, -1394.3882301836604, -459.21647080275903, -979.9029111899112, -605.7020467004603, -443.9340134483948, -883.2464470101316, -1052.1387139560782, -1201.3424600922974, -103.74963418967849, -1026.1073216426607, -733.477087232053, -101.45917921347738, -295.298408823517, -819.455113720234, -627.7342785205989], "episode_lengths": [117, 95, 150, 150, 150, 150, 150, 105, 98, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 64, 150, 117, 111, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 136, 65, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 62, 150, 76, 150, 150, 111, 81, 150, 150, 150, 150, 43, 150, 150, 137, 58, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 45, 150, 150, 150, 138, 150, 150, 150, 150, 62, 150, 150, 96, 104, 150, 126], "policy_policy_0_reward": [-345.0002664075468, -339.58504367119156, -1107.225358633629, -949.5442929326068, -618.5472792504443, -734.8935201466618, -1110.3720784983889, -442.4830350594175, -200.21208939938663, -716.5996574250049, -1150.9603554359655, -1400.166955562084, -825.0288947118761, -972.7247000640408, -560.7800153804237, -975.11240168975, -1188.6423619122688, -594.7258295829541, -1085.0387139829038, -20.03505157916737, -912.4364993199353, -1047.9079226797703, -194.74743725919623, -824.0867847465719, -392.2388837600049, -146.42615339927545, -1338.705674200275, -693.4757660268208, -891.3700644845451, -885.59777466115, -630.3882142118259, -1338.2825208154457, -763.6613956395546, -453.2254536669659, -486.49329817245285, -752.7020851371825, -519.8679245333677, -45.881797019207234, -405.81468825185215, -833.2735976889501, -123.6334009194623, -1346.8460997568757, -485.7309447290897, -370.15366566184474, -723.3402112287881, -482.1725085840642, -1264.571072769965, -521.579534171329, -1156.1650521818005, -1038.9932762532296, -727.2102356835896, -917.0536522900155, -167.77945304475645, -213.2727110335911, -156.1299349793419, -1110.8715365186936, -1274.9530651819807, -257.8639737366714, -118.4380740337972, -1193.1949493350317, -1101.3671100067406, -761.749933747971, -822.7548321632281, -41.356349004071596, -569.180772203181, -674.193932678939, -617.2468478679814, -55.66494901746221, -640.2009929256121, -854.1659017054251, -378.53588468745914, -762.9677960339592, -990.6898092116245, -574.5727529531009, -456.49249628023676, -975.5723954122321, -525.0524153431911, -829.3868197386561, -1028.940537284575, -1056.6960392710914, -1209.8394135654733, -878.1744866105965, -998.9578396198854, -582.6469834892856, -16.634930803627842, -1394.3882301836604, -459.21647080275903, -979.9029111899112, -605.7020467004603, -443.9340134483948, -883.2464470101316, -1052.1387139560782, -1201.3424600922974, -103.74963418967849, -1026.1073216426607, -733.477087232053, -101.45917921347738, -295.298408823517, -819.455113720234, -627.7342785205989]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2797455451188531, "mean_inference_ms": 0.8845560909345664, "mean_action_processing_ms": 0.15841853177602955, "mean_env_wait_ms": 1.5655002249504104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005739450454711914, "StateBufferConnector_ms": 0.0041272640228271484, "ViewRequirementAgentConnector_ms": 0.09933757781982422}, "num_episodes": 28, "episode_return_max": -16.634930803627842, "episode_return_min": -1400.166955562084, "episode_return_mean": -706.7440972744549, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 278.17161842083556, "num_env_steps_trained_throughput_per_sec": 278.17161842083556, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 13661.231, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13661.159, "sample_time_ms": 2410.195, "learn_time_ms": 11235.469, "learn_throughput": 356.015, "synch_weights_time_ms": 14.658}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "92003_00004", "date": "2024-08-03_04-49-22", "timestamp": 1722640762, "time_this_iter_s": 14.388394355773926, "time_total_s": 307.2096905708313, "pid": 480833, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b327f5d80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 307.2096905708313, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 12.66, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 236.3557170589765, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.788149596999089, "policy_loss": -0.01713072191487299, "vf_loss": 3.798770991216103, "vf_explained_var": 0.984431640803814, "kl": 0.014811737496567449, "entropy": 1.559460176775853, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -16.634930803627842, "episode_reward_min": -1394.3882301836604, "episode_reward_mean": -661.7702231939629, "episode_len_mean": 132.61, "episode_media": {}, "episodes_timesteps_total": 13261, "policy_reward_min": {"policy_0": -1394.3882301836604}, "policy_reward_max": {"policy_0": -16.634930803627842}, "policy_reward_mean": {"policy_0": -661.7702231939629}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-453.2254536669659, -486.49329817245285, -752.7020851371825, -519.8679245333677, -45.881797019207234, -405.81468825185215, -833.2735976889501, -123.6334009194623, -1346.8460997568757, -485.7309447290897, -370.15366566184474, -723.3402112287881, -482.1725085840642, -1264.571072769965, -521.579534171329, -1156.1650521818005, -1038.9932762532296, -727.2102356835896, -917.0536522900155, -167.77945304475645, -213.2727110335911, -156.1299349793419, -1110.8715365186936, -1274.9530651819807, -257.8639737366714, -118.4380740337972, -1193.1949493350317, -1101.3671100067406, -761.749933747971, -822.7548321632281, -41.356349004071596, -569.180772203181, -674.193932678939, -617.2468478679814, -55.66494901746221, -640.2009929256121, -854.1659017054251, -378.53588468745914, -762.9677960339592, -990.6898092116245, -574.5727529531009, -456.49249628023676, -975.5723954122321, -525.0524153431911, -829.3868197386561, -1028.940537284575, -1056.6960392710914, -1209.8394135654733, -878.1744866105965, -998.9578396198854, -582.6469834892856, -16.634930803627842, -1394.3882301836604, -459.21647080275903, -979.9029111899112, -605.7020467004603, -443.9340134483948, -883.2464470101316, -1052.1387139560782, -1201.3424600922974, -103.74963418967849, -1026.1073216426607, -733.477087232053, -101.45917921347738, -295.298408823517, -819.455113720234, -627.7342785205989, -884.9863358068296, -1041.2546724832243, -675.7909144295327, -937.4306137649934, -198.31218718208086, -69.9486974432952, -370.9541140178075, -23.32186039653953, -925.9256760846132, -140.27406242599622, -693.319963690677, -723.6951284316045, -1258.3433662219638, -892.693199629664, -147.66361257080018, -273.79485473201953, -427.79688971745173, -503.77808339368545, -1025.9021448388348, -556.2646213383158, -1247.5374063739766, -116.08975710001127, -686.6229361233367, -683.8228015392367, -226.58219738708408, -871.9440747795043, -230.85790433643686, -978.8694535623168, -927.7136377964258, -904.7797021841636, -1188.8409215409579, -439.34972680836984, -625.1540663491115], "episode_lengths": [150, 150, 150, 136, 65, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 62, 150, 76, 150, 150, 111, 81, 150, 150, 150, 150, 43, 150, 150, 137, 58, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 45, 150, 150, 150, 138, 150, 150, 150, 150, 62, 150, 150, 96, 104, 150, 126, 150, 150, 150, 150, 80, 63, 97, 43, 150, 76, 150, 150, 150, 150, 72, 79, 150, 150, 150, 150, 150, 84, 150, 150, 103, 150, 81, 150, 150, 150, 150, 118, 150], "policy_policy_0_reward": [-453.2254536669659, -486.49329817245285, -752.7020851371825, -519.8679245333677, -45.881797019207234, -405.81468825185215, -833.2735976889501, -123.6334009194623, -1346.8460997568757, -485.7309447290897, -370.15366566184474, -723.3402112287881, -482.1725085840642, -1264.571072769965, -521.579534171329, -1156.1650521818005, -1038.9932762532296, -727.2102356835896, -917.0536522900155, -167.77945304475645, -213.2727110335911, -156.1299349793419, -1110.8715365186936, -1274.9530651819807, -257.8639737366714, -118.4380740337972, -1193.1949493350317, -1101.3671100067406, -761.749933747971, -822.7548321632281, -41.356349004071596, -569.180772203181, -674.193932678939, -617.2468478679814, -55.66494901746221, -640.2009929256121, -854.1659017054251, -378.53588468745914, -762.9677960339592, -990.6898092116245, -574.5727529531009, -456.49249628023676, -975.5723954122321, -525.0524153431911, -829.3868197386561, -1028.940537284575, -1056.6960392710914, -1209.8394135654733, -878.1744866105965, -998.9578396198854, -582.6469834892856, -16.634930803627842, -1394.3882301836604, -459.21647080275903, -979.9029111899112, -605.7020467004603, -443.9340134483948, -883.2464470101316, -1052.1387139560782, -1201.3424600922974, -103.74963418967849, -1026.1073216426607, -733.477087232053, -101.45917921347738, -295.298408823517, -819.455113720234, -627.7342785205989, -884.9863358068296, -1041.2546724832243, -675.7909144295327, -937.4306137649934, -198.31218718208086, -69.9486974432952, -370.9541140178075, -23.32186039653953, -925.9256760846132, -140.27406242599622, -693.319963690677, -723.6951284316045, -1258.3433662219638, -892.693199629664, -147.66361257080018, -273.79485473201953, -427.79688971745173, -503.77808339368545, -1025.9021448388348, -556.2646213383158, -1247.5374063739766, -116.08975710001127, -686.6229361233367, -683.8228015392367, -226.58219738708408, -871.9440747795043, -230.85790433643686, -978.8694535623168, -927.7136377964258, -904.7797021841636, -1188.8409215409579, -439.34972680836984, -625.1540663491115]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27981465430635155, "mean_inference_ms": 0.8839825206952503, "mean_action_processing_ms": 0.15839869519066305, "mean_env_wait_ms": 1.5660713884467576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005624532699584961, "StateBufferConnector_ms": 0.004016399383544922, "ViewRequirementAgentConnector_ms": 0.09713554382324219}, "num_episodes": 33, "episode_return_max": -16.634930803627842, "episode_return_min": -1394.3882301836604, "episode_return_mean": -661.7702231939629, "episodes_this_iter": 33}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 280.4043004577716, "num_env_steps_trained_throughput_per_sec": 280.4043004577716, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 13655.824, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13655.751, "sample_time_ms": 2404.986, "learn_time_ms": 11234.942, "learn_throughput": 356.032, "synch_weights_time_ms": 14.989}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "92003_00004", "date": "2024-08-03_04-49-36", "timestamp": 1722640776, "time_this_iter_s": 14.271428346633911, "time_total_s": 321.4811189174652, "pid": 480833, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b327f7f40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 321.4811189174652, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 12.552380952380954, "ram_util_percent": 16.20952380952381}}
