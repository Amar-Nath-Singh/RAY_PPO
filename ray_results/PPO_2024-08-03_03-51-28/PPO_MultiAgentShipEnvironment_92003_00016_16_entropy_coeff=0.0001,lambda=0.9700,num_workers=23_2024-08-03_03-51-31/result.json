{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.045521394815296, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.529061858852705, "policy_loss": -0.0072452879889169704, "vf_loss": 9.534394399325054, "vf_explained_var": 0.011578727637728055, "kl": 0.010269443722412083, "entropy": 1.4115485659490028, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -73.38962283492586, "episode_reward_min": -1145.080532140103, "episode_reward_mean": -678.3649167640331, "episode_len_mean": 136.2, "episode_media": {}, "episodes_timesteps_total": 3405, "policy_reward_min": {"policy_0": -1145.080532140103}, "policy_reward_max": {"policy_0": -73.38962283492586}, "policy_reward_mean": {"policy_0": -678.3649167640331}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-933.454965439166, -526.9650181002909, -715.7615419322605, -669.9501573914148, -535.5837801594519, -896.7065463017352, -868.3087540095386, -1012.7111689481451, -688.95990330513, -403.07659934447526, -656.6882930621634, -1056.5336626546473, -809.6805891465226, -734.546570979659, -399.2718312274349, -1145.080532140103, -611.20199160488, -272.45133851862454, -73.38962283492586, -854.8324774897508, -769.5017810783779, -897.3130838783977, -1029.4373688462729, -124.52034835397147, -273.1949923534886], "episode_lengths": [150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 52, 150, 150, 150, 150, 72, 81], "policy_policy_0_reward": [-933.454965439166, -526.9650181002909, -715.7615419322605, -669.9501573914148, -535.5837801594519, -896.7065463017352, -868.3087540095386, -1012.7111689481451, -688.95990330513, -403.07659934447526, -656.6882930621634, -1056.5336626546473, -809.6805891465226, -734.546570979659, -399.2718312274349, -1145.080532140103, -611.20199160488, -272.45133851862454, -73.38962283492586, -854.8324774897508, -769.5017810783779, -897.3130838783977, -1029.4373688462729, -124.52034835397147, -273.1949923534886]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5755802574220354, "mean_inference_ms": 1.678250022474768, "mean_action_processing_ms": 0.28342368215175684, "mean_env_wait_ms": 2.990829362853603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010924339294433594, "StateBufferConnector_ms": 0.007939338684082031, "ViewRequirementAgentConnector_ms": 0.17663955688476562}, "num_episodes": 25, "episode_return_max": -73.38962283492586, "episode_return_min": -1145.080532140103, "episode_return_mean": -678.3649167640331, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 348.7861247402121, "num_env_steps_trained_throughput_per_sec": 348.7861247402121, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 11468.357, "restore_workers_time_ms": 0.025, "training_step_time_ms": 11468.292, "sample_time_ms": 1037.557, "learn_time_ms": 10375.06, "learn_throughput": 385.54, "synch_weights_time_ms": 54.964}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "92003_00016", "date": "2024-08-03_05-01-10", "timestamp": 1722641470, "time_this_iter_s": 11.479685544967651, "time_total_s": 11.479685544967651, "pid": 484683, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b30fa3eb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11.479685544967651, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 17.500000000000004, "ram_util_percent": 27.794117647058826}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.293281077221036, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.27054629921913, "policy_loss": -0.007443183648380606, "vf_loss": 9.275836204489073, "vf_explained_var": -0.00751145879427592, "kl": 0.011469256296474365, "entropy": 1.4057048859695593, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -44.85593971043013, "episode_reward_min": -1145.080532140103, "episode_reward_mean": -620.9213587637465, "episode_len_mean": 135.44, "episode_media": {}, "episodes_timesteps_total": 6772, "policy_reward_min": {"policy_0": -1145.080532140103}, "policy_reward_max": {"policy_0": -44.85593971043013}, "policy_reward_mean": {"policy_0": -620.9213587637465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-933.454965439166, -526.9650181002909, -715.7615419322605, -669.9501573914148, -535.5837801594519, -896.7065463017352, -868.3087540095386, -1012.7111689481451, -688.95990330513, -403.07659934447526, -656.6882930621634, -1056.5336626546473, -809.6805891465226, -734.546570979659, -399.2718312274349, -1145.080532140103, -611.20199160488, -272.45133851862454, -73.38962283492586, -854.8324774897508, -769.5017810783779, -897.3130838783977, -1029.4373688462729, -124.52034835397147, -273.1949923534886, -815.9444130343231, -702.6657894717351, -743.0712662122804, -342.98146151564333, -535.093977691024, -491.53223388757004, -570.3748405176569, -814.557864406683, -317.1943396544763, -80.44830992109026, -1137.5511333979262, -604.1609583048594, -517.3792582053558, -815.1981914325165, -571.9667850325723, -652.7605863610585, -473.33812167763307, -499.18994144974187, -179.821116262192, -1034.7045307165818, -952.874048174991, -44.85593971043013, -130.87463262129785, -369.8552411996191, -688.5500382272447], "episode_lengths": [150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 52, 150, 150, 150, 150, 72, 81, 150, 150, 150, 150, 150, 120, 150, 150, 150, 47, 150, 150, 150, 150, 134, 150, 118, 150, 104, 150, 150, 54, 102, 150, 138], "policy_policy_0_reward": [-933.454965439166, -526.9650181002909, -715.7615419322605, -669.9501573914148, -535.5837801594519, -896.7065463017352, -868.3087540095386, -1012.7111689481451, -688.95990330513, -403.07659934447526, -656.6882930621634, -1056.5336626546473, -809.6805891465226, -734.546570979659, -399.2718312274349, -1145.080532140103, -611.20199160488, -272.45133851862454, -73.38962283492586, -854.8324774897508, -769.5017810783779, -897.3130838783977, -1029.4373688462729, -124.52034835397147, -273.1949923534886, -815.9444130343231, -702.6657894717351, -743.0712662122804, -342.98146151564333, -535.093977691024, -491.53223388757004, -570.3748405176569, -814.557864406683, -317.1943396544763, -80.44830992109026, -1137.5511333979262, -604.1609583048594, -517.3792582053558, -815.1981914325165, -571.9667850325723, -652.7605863610585, -473.33812167763307, -499.18994144974187, -179.821116262192, -1034.7045307165818, -952.874048174991, -44.85593971043013, -130.87463262129785, -369.8552411996191, -688.5500382272447]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5699999875348462, "mean_inference_ms": 1.6738715081732567, "mean_action_processing_ms": 0.2830510088717792, "mean_env_wait_ms": 2.979852516612513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013729095458984375, "StateBufferConnector_ms": 0.008032798767089844, "ViewRequirementAgentConnector_ms": 0.17899608612060547}, "num_episodes": 25, "episode_return_max": -44.85593971043013, "episode_return_min": -1145.080532140103, "episode_return_mean": -620.9213587637465, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 328.0128176929521, "num_env_steps_trained_throughput_per_sec": 328.0128176929521, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 11831.506, "restore_workers_time_ms": 0.025, "training_step_time_ms": 11831.443, "sample_time_ms": 1031.941, "learn_time_ms": 10742.722, "learn_throughput": 372.345, "synch_weights_time_ms": 56.062}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "92003_00016", "date": "2024-08-03_05-01-23", "timestamp": 1722641483, "time_this_iter_s": 12.207093477249146, "time_total_s": 23.686779022216797, "pid": 484683, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b32764c10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23.686779022216797, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 18.435294117647057, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3773599119546514, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.549778307477633, "policy_loss": -0.007325995194454056, "vf_loss": 9.554692986607552, "vf_explained_var": 0.06688602392872174, "kl": 0.012780198483839437, "entropy": 1.4473117691775164, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -44.85593971043013, "episode_reward_min": -1344.0820650025448, "episode_reward_mean": -620.7674420008913, "episode_len_mean": 135.1578947368421, "episode_media": {}, "episodes_timesteps_total": 10272, "policy_reward_min": {"policy_0": -1344.0820650025448}, "policy_reward_max": {"policy_0": -44.85593971043013}, "policy_reward_mean": {"policy_0": -620.7674420008913}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-933.454965439166, -526.9650181002909, -715.7615419322605, -669.9501573914148, -535.5837801594519, -896.7065463017352, -868.3087540095386, -1012.7111689481451, -688.95990330513, -403.07659934447526, -656.6882930621634, -1056.5336626546473, -809.6805891465226, -734.546570979659, -399.2718312274349, -1145.080532140103, -611.20199160488, -272.45133851862454, -73.38962283492586, -854.8324774897508, -769.5017810783779, -897.3130838783977, -1029.4373688462729, -124.52034835397147, -273.1949923534886, -815.9444130343231, -702.6657894717351, -743.0712662122804, -342.98146151564333, -535.093977691024, -491.53223388757004, -570.3748405176569, -814.557864406683, -317.1943396544763, -80.44830992109026, -1137.5511333979262, -604.1609583048594, -517.3792582053558, -815.1981914325165, -571.9667850325723, -652.7605863610585, -473.33812167763307, -499.18994144974187, -179.821116262192, -1034.7045307165818, -952.874048174991, -44.85593971043013, -130.87463262129785, -369.8552411996191, -688.5500382272447, -67.26447511018837, -177.69956112663021, -1132.1696286800245, -499.74391601091173, -577.3062750418635, -99.83325138559626, -940.309287638464, -644.9993930903463, -745.5390111807832, -952.630603867989, -931.3732610682723, -618.7324568195193, -84.57621691524167, -777.5517426478536, -890.8270275472466, -1038.5842584659392, -627.6092800603338, -1344.0820650025448, -368.389034748352, -213.45469556602444, -334.00391489568426, -1059.3331537796655, -789.7627150623445, -521.1691402976331, -414.00235521332695, -281.31093265762973], "episode_lengths": [150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 52, 150, 150, 150, 150, 72, 81, 150, 150, 150, 150, 150, 120, 150, 150, 150, 47, 150, 150, 150, 150, 134, 150, 118, 150, 104, 150, 150, 54, 102, 150, 138, 60, 79, 150, 123, 150, 70, 150, 150, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 118, 150, 108, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-933.454965439166, -526.9650181002909, -715.7615419322605, -669.9501573914148, -535.5837801594519, -896.7065463017352, -868.3087540095386, -1012.7111689481451, -688.95990330513, -403.07659934447526, -656.6882930621634, -1056.5336626546473, -809.6805891465226, -734.546570979659, -399.2718312274349, -1145.080532140103, -611.20199160488, -272.45133851862454, -73.38962283492586, -854.8324774897508, -769.5017810783779, -897.3130838783977, -1029.4373688462729, -124.52034835397147, -273.1949923534886, -815.9444130343231, -702.6657894717351, -743.0712662122804, -342.98146151564333, -535.093977691024, -491.53223388757004, -570.3748405176569, -814.557864406683, -317.1943396544763, -80.44830992109026, -1137.5511333979262, -604.1609583048594, -517.3792582053558, -815.1981914325165, -571.9667850325723, -652.7605863610585, -473.33812167763307, -499.18994144974187, -179.821116262192, -1034.7045307165818, -952.874048174991, -44.85593971043013, -130.87463262129785, -369.8552411996191, -688.5500382272447, -67.26447511018837, -177.69956112663021, -1132.1696286800245, -499.74391601091173, -577.3062750418635, -99.83325138559626, -940.309287638464, -644.9993930903463, -745.5390111807832, -952.630603867989, -931.3732610682723, -618.7324568195193, -84.57621691524167, -777.5517426478536, -890.8270275472466, -1038.5842584659392, -627.6092800603338, -1344.0820650025448, -368.389034748352, -213.45469556602444, -334.00391489568426, -1059.3331537796655, -789.7627150623445, -521.1691402976331, -414.00235521332695, -281.31093265762973]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5697419268435194, "mean_inference_ms": 1.679953197586537, "mean_action_processing_ms": 0.2836631105860582, "mean_env_wait_ms": 2.9841413856663754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013650718488191304, "StateBufferConnector_ms": 0.008277516616018195, "ViewRequirementAgentConnector_ms": 0.18548557632847837}, "num_episodes": 26, "episode_return_max": -44.85593971043013, "episode_return_min": -1344.0820650025448, "episode_return_mean": -620.7674420008913, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.5580036243374, "num_env_steps_trained_throughput_per_sec": 308.5580036243374, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 12208.851, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12208.783, "sample_time_ms": 1047.614, "learn_time_ms": 11096.295, "learn_throughput": 360.481, "synch_weights_time_ms": 64.139}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "92003_00016", "date": "2024-08-03_05-01-36", "timestamp": 1722641496, "time_this_iter_s": 12.975691795349121, "time_total_s": 36.66247081756592, "pid": 484683, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b30fa13f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 36.66247081756592, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 17.4421052631579, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6041136036626995, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.547670943538348, "policy_loss": -0.009136726395081497, "vf_loss": 9.554209344585736, "vf_explained_var": 0.07509984535475572, "kl": 0.013738860740856278, "entropy": 1.4945715978741645, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -44.85593971043013, "episode_reward_min": -1344.0820650025448, "episode_reward_mean": -624.7537153662232, "episode_len_mean": 134.42, "episode_media": {}, "episodes_timesteps_total": 13442, "policy_reward_min": {"policy_0": -1344.0820650025448}, "policy_reward_max": {"policy_0": -44.85593971043013}, "policy_reward_mean": {"policy_0": -624.7537153662232}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-669.9501573914148, -535.5837801594519, -896.7065463017352, -868.3087540095386, -1012.7111689481451, -688.95990330513, -403.07659934447526, -656.6882930621634, -1056.5336626546473, -809.6805891465226, -734.546570979659, -399.2718312274349, -1145.080532140103, -611.20199160488, -272.45133851862454, -73.38962283492586, -854.8324774897508, -769.5017810783779, -897.3130838783977, -1029.4373688462729, -124.52034835397147, -273.1949923534886, -815.9444130343231, -702.6657894717351, -743.0712662122804, -342.98146151564333, -535.093977691024, -491.53223388757004, -570.3748405176569, -814.557864406683, -317.1943396544763, -80.44830992109026, -1137.5511333979262, -604.1609583048594, -517.3792582053558, -815.1981914325165, -571.9667850325723, -652.7605863610585, -473.33812167763307, -499.18994144974187, -179.821116262192, -1034.7045307165818, -952.874048174991, -44.85593971043013, -130.87463262129785, -369.8552411996191, -688.5500382272447, -67.26447511018837, -177.69956112663021, -1132.1696286800245, -499.74391601091173, -577.3062750418635, -99.83325138559626, -940.309287638464, -644.9993930903463, -745.5390111807832, -952.630603867989, -931.3732610682723, -618.7324568195193, -84.57621691524167, -777.5517426478536, -890.8270275472466, -1038.5842584659392, -627.6092800603338, -1344.0820650025448, -368.389034748352, -213.45469556602444, -334.00391489568426, -1059.3331537796655, -789.7627150623445, -521.1691402976331, -414.00235521332695, -281.31093265762973, -743.0509662141311, -873.0289650202308, -872.89575675022, -974.7894344015774, -144.8488016134051, -787.7512397084062, -381.2227526877423, -1006.7804634483584, -832.4032149563197, -110.02644695191411, -661.2425495300783, -385.3992159715527, -1073.8914586703659, -173.63746056661876, -931.1288809097185, -977.6710650384049, -290.33546542670405, -675.4772341269795, -279.39981401932135, -896.7212409606492, -560.4645331841355, -517.2166716556728, -787.1762212114605, -995.7835250166441, -788.1762156910573, -296.05028113901574, -456.6575951556104], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 52, 150, 150, 150, 150, 72, 81, 150, 150, 150, 150, 150, 120, 150, 150, 150, 47, 150, 150, 150, 150, 134, 150, 118, 150, 104, 150, 150, 54, 102, 150, 138, 60, 79, 150, 123, 150, 70, 150, 150, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 118, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 148, 150, 150, 69, 150, 104, 150, 85, 150, 150, 86, 150, 111, 150, 150, 150, 150, 150, 150, 116, 104], "policy_policy_0_reward": [-669.9501573914148, -535.5837801594519, -896.7065463017352, -868.3087540095386, -1012.7111689481451, -688.95990330513, -403.07659934447526, -656.6882930621634, -1056.5336626546473, -809.6805891465226, -734.546570979659, -399.2718312274349, -1145.080532140103, -611.20199160488, -272.45133851862454, -73.38962283492586, -854.8324774897508, -769.5017810783779, -897.3130838783977, -1029.4373688462729, -124.52034835397147, -273.1949923534886, -815.9444130343231, -702.6657894717351, -743.0712662122804, -342.98146151564333, -535.093977691024, -491.53223388757004, -570.3748405176569, -814.557864406683, -317.1943396544763, -80.44830992109026, -1137.5511333979262, -604.1609583048594, -517.3792582053558, -815.1981914325165, -571.9667850325723, -652.7605863610585, -473.33812167763307, -499.18994144974187, -179.821116262192, -1034.7045307165818, -952.874048174991, -44.85593971043013, -130.87463262129785, -369.8552411996191, -688.5500382272447, -67.26447511018837, -177.69956112663021, -1132.1696286800245, -499.74391601091173, -577.3062750418635, -99.83325138559626, -940.309287638464, -644.9993930903463, -745.5390111807832, -952.630603867989, -931.3732610682723, -618.7324568195193, -84.57621691524167, -777.5517426478536, -890.8270275472466, -1038.5842584659392, -627.6092800603338, -1344.0820650025448, -368.389034748352, -213.45469556602444, -334.00391489568426, -1059.3331537796655, -789.7627150623445, -521.1691402976331, -414.00235521332695, -281.31093265762973, -743.0509662141311, -873.0289650202308, -872.89575675022, -974.7894344015774, -144.8488016134051, -787.7512397084062, -381.2227526877423, -1006.7804634483584, -832.4032149563197, -110.02644695191411, -661.2425495300783, -385.3992159715527, -1073.8914586703659, -173.63746056661876, -931.1288809097185, -977.6710650384049, -290.33546542670405, -675.4772341269795, -279.39981401932135, -896.7212409606492, -560.4645331841355, -517.2166716556728, -787.1762212114605, -995.7835250166441, -788.1762156910573, -296.05028113901574, -456.6575951556104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5690274269990432, "mean_inference_ms": 1.6814777844711413, "mean_action_processing_ms": 0.2842012260883849, "mean_env_wait_ms": 2.9833779147529595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014016151428222656, "StateBufferConnector_ms": 0.008437871932983398, "ViewRequirementAgentConnector_ms": 0.18799209594726562}, "num_episodes": 27, "episode_return_max": -44.85593971043013, "episode_return_min": -1344.0820650025448, "episode_return_mean": -624.7537153662232, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 486.50714723067557, "num_env_steps_trained_throughput_per_sec": 486.50714723067557, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 11212.109, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11212.043, "sample_time_ms": 1043.435, "learn_time_ms": 10108.369, "learn_throughput": 395.712, "synch_weights_time_ms": 59.51}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "92003_00016", "date": "2024-08-03_05-01-44", "timestamp": 1722641504, "time_this_iter_s": 8.235371589660645, "time_total_s": 44.89784240722656, "pid": 484683, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b30fa2d40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 44.89784240722656, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 21.89090909090909, "ram_util_percent": 27.854545454545452}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.486852199708422, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.632452966769536, "policy_loss": -0.016274522902191772, "vf_loss": 9.645211416482926, "vf_explained_var": 0.16684822955479225, "kl": 0.018344537984376078, "entropy": 1.5287238417814175, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -44.85593971043013, "episode_reward_min": -1344.0820650025448, "episode_reward_mean": -666.5564909763815, "episode_len_mean": 135.24, "episode_media": {}, "episodes_timesteps_total": 13524, "policy_reward_min": {"policy_0": -1344.0820650025448}, "policy_reward_max": {"policy_0": -44.85593971043013}, "policy_reward_mean": {"policy_0": -666.5564909763815}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-814.557864406683, -317.1943396544763, -80.44830992109026, -1137.5511333979262, -604.1609583048594, -517.3792582053558, -815.1981914325165, -571.9667850325723, -652.7605863610585, -473.33812167763307, -499.18994144974187, -179.821116262192, -1034.7045307165818, -952.874048174991, -44.85593971043013, -130.87463262129785, -369.8552411996191, -688.5500382272447, -67.26447511018837, -177.69956112663021, -1132.1696286800245, -499.74391601091173, -577.3062750418635, -99.83325138559626, -940.309287638464, -644.9993930903463, -745.5390111807832, -952.630603867989, -931.3732610682723, -618.7324568195193, -84.57621691524167, -777.5517426478536, -890.8270275472466, -1038.5842584659392, -627.6092800603338, -1344.0820650025448, -368.389034748352, -213.45469556602444, -334.00391489568426, -1059.3331537796655, -789.7627150623445, -521.1691402976331, -414.00235521332695, -281.31093265762973, -743.0509662141311, -873.0289650202308, -872.89575675022, -974.7894344015774, -144.8488016134051, -787.7512397084062, -381.2227526877423, -1006.7804634483584, -832.4032149563197, -110.02644695191411, -661.2425495300783, -385.3992159715527, -1073.8914586703659, -173.63746056661876, -931.1288809097185, -977.6710650384049, -290.33546542670405, -675.4772341269795, -279.39981401932135, -896.7212409606492, -560.4645331841355, -517.2166716556728, -787.1762212114605, -995.7835250166441, -788.1762156910573, -296.05028113901574, -456.6575951556104, -751.3141574422152, -959.6894970693405, -1016.43135793612, -1200.8187842447485, -849.9672973907786, -1010.6856744702131, -338.03215684230906, -763.856573866106, -699.2230035123928, -84.60940724103993, -402.15945489140944, -703.2536488435511, -1001.6070515566627, -503.54146915482505, -417.90157763411696, -1213.3502110632026, -383.09714171018777, -834.5554168495113, -1137.3426166912652, -786.0572964971932, -912.4409736524003, -464.6955068597808, -860.3821205430944, -869.1760006065502, -1000.9316742887607, -1105.3925565977072, -852.9974179524263, -1005.242437681182, -1036.1304538860877], "episode_lengths": [150, 150, 47, 150, 150, 150, 150, 134, 150, 118, 150, 104, 150, 150, 54, 102, 150, 138, 60, 79, 150, 123, 150, 70, 150, 150, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 118, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 148, 150, 150, 69, 150, 104, 150, 85, 150, 150, 86, 150, 111, 150, 150, 150, 150, 150, 150, 116, 104, 150, 150, 150, 150, 144, 150, 120, 150, 135, 83, 126, 150, 150, 150, 105, 150, 107, 150, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-814.557864406683, -317.1943396544763, -80.44830992109026, -1137.5511333979262, -604.1609583048594, -517.3792582053558, -815.1981914325165, -571.9667850325723, -652.7605863610585, -473.33812167763307, -499.18994144974187, -179.821116262192, -1034.7045307165818, -952.874048174991, -44.85593971043013, -130.87463262129785, -369.8552411996191, -688.5500382272447, -67.26447511018837, -177.69956112663021, -1132.1696286800245, -499.74391601091173, -577.3062750418635, -99.83325138559626, -940.309287638464, -644.9993930903463, -745.5390111807832, -952.630603867989, -931.3732610682723, -618.7324568195193, -84.57621691524167, -777.5517426478536, -890.8270275472466, -1038.5842584659392, -627.6092800603338, -1344.0820650025448, -368.389034748352, -213.45469556602444, -334.00391489568426, -1059.3331537796655, -789.7627150623445, -521.1691402976331, -414.00235521332695, -281.31093265762973, -743.0509662141311, -873.0289650202308, -872.89575675022, -974.7894344015774, -144.8488016134051, -787.7512397084062, -381.2227526877423, -1006.7804634483584, -832.4032149563197, -110.02644695191411, -661.2425495300783, -385.3992159715527, -1073.8914586703659, -173.63746056661876, -931.1288809097185, -977.6710650384049, -290.33546542670405, -675.4772341269795, -279.39981401932135, -896.7212409606492, -560.4645331841355, -517.2166716556728, -787.1762212114605, -995.7835250166441, -788.1762156910573, -296.05028113901574, -456.6575951556104, -751.3141574422152, -959.6894970693405, -1016.43135793612, -1200.8187842447485, -849.9672973907786, -1010.6856744702131, -338.03215684230906, -763.856573866106, -699.2230035123928, -84.60940724103993, -402.15945489140944, -703.2536488435511, -1001.6070515566627, -503.54146915482505, -417.90157763411696, -1213.3502110632026, -383.09714171018777, -834.5554168495113, -1137.3426166912652, -786.0572964971932, -912.4409736524003, -464.6955068597808, -860.3821205430944, -869.1760006065502, -1000.9316742887607, -1105.3925565977072, -852.9974179524263, -1005.242437681182, -1036.1304538860877]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.564174825933834, "mean_inference_ms": 1.6841112704251677, "mean_action_processing_ms": 0.2844709020820328, "mean_env_wait_ms": 2.9852610336520264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014088153839111328, "StateBufferConnector_ms": 0.008628368377685547, "ViewRequirementAgentConnector_ms": 0.19022417068481445}, "num_episodes": 29, "episode_return_max": -44.85593971043013, "episode_return_min": -1344.0820650025448, "episode_return_mean": -666.5564909763815, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.5250816852242, "num_env_steps_trained_throughput_per_sec": 306.5250816852242, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 11579.59, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11579.522, "sample_time_ms": 1052.23, "learn_time_ms": 10464.407, "learn_throughput": 382.248, "synch_weights_time_ms": 62.145}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "92003_00016", "date": "2024-08-03_05-01-57", "timestamp": 1722641517, "time_this_iter_s": 13.062467098236084, "time_total_s": 57.96030950546265, "pid": 484683, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b327f4ca0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 57.96030950546265, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 17.526315789473685, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.137991736084223, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.227900686860085, "policy_loss": -0.008803660763563433, "vf_loss": 9.234282624721526, "vf_explained_var": 0.12905414663255216, "kl": 0.012878972144699219, "entropy": 1.5400659096737703, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -10.609284078612912, "episode_reward_min": -1351.505612317497, "episode_reward_mean": -711.9079018794168, "episode_len_mean": 137.8, "episode_media": {}, "episodes_timesteps_total": 13780, "policy_reward_min": {"policy_0": -1351.505612317497}, "policy_reward_max": {"policy_0": -10.609284078612912}, "policy_reward_mean": {"policy_0": -711.9079018794168}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1344.0820650025448, -368.389034748352, -213.45469556602444, -334.00391489568426, -1059.3331537796655, -789.7627150623445, -521.1691402976331, -414.00235521332695, -281.31093265762973, -743.0509662141311, -873.0289650202308, -872.89575675022, -974.7894344015774, -144.8488016134051, -787.7512397084062, -381.2227526877423, -1006.7804634483584, -832.4032149563197, -110.02644695191411, -661.2425495300783, -385.3992159715527, -1073.8914586703659, -173.63746056661876, -931.1288809097185, -977.6710650384049, -290.33546542670405, -675.4772341269795, -279.39981401932135, -896.7212409606492, -560.4645331841355, -517.2166716556728, -787.1762212114605, -995.7835250166441, -788.1762156910573, -296.05028113901574, -456.6575951556104, -751.3141574422152, -959.6894970693405, -1016.43135793612, -1200.8187842447485, -849.9672973907786, -1010.6856744702131, -338.03215684230906, -763.856573866106, -699.2230035123928, -84.60940724103993, -402.15945489140944, -703.2536488435511, -1001.6070515566627, -503.54146915482505, -417.90157763411696, -1213.3502110632026, -383.09714171018777, -834.5554168495113, -1137.3426166912652, -786.0572964971932, -912.4409736524003, -464.6955068597808, -860.3821205430944, -869.1760006065502, -1000.9316742887607, -1105.3925565977072, -852.9974179524263, -1005.242437681182, -1036.1304538860877, -807.6367101357457, -1069.687083341108, -739.7496234100068, -749.3669096803196, -1046.4799904522056, -589.741695793768, -778.6048273076013, -10.609284078612912, -656.1486786133976, -1031.115222520955, -709.2214174269908, -911.6203113979574, -79.38811546447792, -599.2380105047979, -586.1210135254914, -691.42741283787, -740.0085647867355, -183.95714569180615, -1181.0045627268291, -633.5917565343574, -410.08227717747144, -704.765326675209, -1351.505612317497, -795.5885210486452, -696.4558646378232, -259.2213548225484, -1025.2227625498247, -167.7013986333184, -657.9172185846887, -384.6340021992598, -838.8873755881688, -1133.451217274728, -1064.2920729737857, -888.000499612337, -1054.7279333906777], "episode_lengths": [150, 118, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 148, 150, 150, 69, 150, 104, 150, 85, 150, 150, 86, 150, 111, 150, 150, 150, 150, 150, 150, 116, 104, 150, 150, 150, 150, 144, 150, 120, 150, 135, 83, 126, 150, 150, 150, 105, 150, 107, 150, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 48, 150, 150, 150, 150, 64, 150, 150, 150, 150, 88, 150, 150, 150, 150, 150, 150, 140, 124, 150, 60, 150, 103, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1344.0820650025448, -368.389034748352, -213.45469556602444, -334.00391489568426, -1059.3331537796655, -789.7627150623445, -521.1691402976331, -414.00235521332695, -281.31093265762973, -743.0509662141311, -873.0289650202308, -872.89575675022, -974.7894344015774, -144.8488016134051, -787.7512397084062, -381.2227526877423, -1006.7804634483584, -832.4032149563197, -110.02644695191411, -661.2425495300783, -385.3992159715527, -1073.8914586703659, -173.63746056661876, -931.1288809097185, -977.6710650384049, -290.33546542670405, -675.4772341269795, -279.39981401932135, -896.7212409606492, -560.4645331841355, -517.2166716556728, -787.1762212114605, -995.7835250166441, -788.1762156910573, -296.05028113901574, -456.6575951556104, -751.3141574422152, -959.6894970693405, -1016.43135793612, -1200.8187842447485, -849.9672973907786, -1010.6856744702131, -338.03215684230906, -763.856573866106, -699.2230035123928, -84.60940724103993, -402.15945489140944, -703.2536488435511, -1001.6070515566627, -503.54146915482505, -417.90157763411696, -1213.3502110632026, -383.09714171018777, -834.5554168495113, -1137.3426166912652, -786.0572964971932, -912.4409736524003, -464.6955068597808, -860.3821205430944, -869.1760006065502, -1000.9316742887607, -1105.3925565977072, -852.9974179524263, -1005.242437681182, -1036.1304538860877, -807.6367101357457, -1069.687083341108, -739.7496234100068, -749.3669096803196, -1046.4799904522056, -589.741695793768, -778.6048273076013, -10.609284078612912, -656.1486786133976, -1031.115222520955, -709.2214174269908, -911.6203113979574, -79.38811546447792, -599.2380105047979, -586.1210135254914, -691.42741283787, -740.0085647867355, -183.95714569180615, -1181.0045627268291, -633.5917565343574, -410.08227717747144, -704.765326675209, -1351.505612317497, -795.5885210486452, -696.4558646378232, -259.2213548225484, -1025.2227625498247, -167.7013986333184, -657.9172185846887, -384.6340021992598, -838.8873755881688, -1133.451217274728, -1064.2920729737857, -888.000499612337, -1054.7279333906777]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5621173459940028, "mean_inference_ms": 1.6900188386457033, "mean_action_processing_ms": 0.2850041204152921, "mean_env_wait_ms": 3.001502327229155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013413429260253906, "StateBufferConnector_ms": 0.008652687072753906, "ViewRequirementAgentConnector_ms": 0.19005990028381348}, "num_episodes": 35, "episode_return_max": -10.609284078612912, "episode_return_min": -1351.505612317497, "episode_return_mean": -711.9079018794168, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.71847473230673, "num_env_steps_trained_throughput_per_sec": 301.71847473230673, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 11859.225, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11859.158, "sample_time_ms": 1058.329, "learn_time_ms": 10737.863, "learn_throughput": 372.514, "synch_weights_time_ms": 62.224}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "92003_00016", "date": "2024-08-03_05-02-10", "timestamp": 1722641530, "time_this_iter_s": 13.271345615386963, "time_total_s": 71.23165512084961, "pid": 484683, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b13529ab0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 71.23165512084961, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 17.410526315789475, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.277207115168373, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.970903474092484, "policy_loss": -0.011654521826615867, "vf_loss": 8.979644122719765, "vf_explained_var": 0.17448767069727183, "kl": 0.015309732980783034, "entropy": 1.480656152094404, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -10.609284078612912, "episode_reward_min": -1351.505612317497, "episode_reward_mean": -694.0685124970693, "episode_len_mean": 134.75, "episode_media": {}, "episodes_timesteps_total": 13475, "policy_reward_min": {"policy_0": -1351.505612317497}, "policy_reward_max": {"policy_0": -10.609284078612912}, "policy_reward_mean": {"policy_0": -694.0685124970693}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-560.4645331841355, -517.2166716556728, -787.1762212114605, -995.7835250166441, -788.1762156910573, -296.05028113901574, -456.6575951556104, -751.3141574422152, -959.6894970693405, -1016.43135793612, -1200.8187842447485, -849.9672973907786, -1010.6856744702131, -338.03215684230906, -763.856573866106, -699.2230035123928, -84.60940724103993, -402.15945489140944, -703.2536488435511, -1001.6070515566627, -503.54146915482505, -417.90157763411696, -1213.3502110632026, -383.09714171018777, -834.5554168495113, -1137.3426166912652, -786.0572964971932, -912.4409736524003, -464.6955068597808, -860.3821205430944, -869.1760006065502, -1000.9316742887607, -1105.3925565977072, -852.9974179524263, -1005.242437681182, -1036.1304538860877, -807.6367101357457, -1069.687083341108, -739.7496234100068, -749.3669096803196, -1046.4799904522056, -589.741695793768, -778.6048273076013, -10.609284078612912, -656.1486786133976, -1031.115222520955, -709.2214174269908, -911.6203113979574, -79.38811546447792, -599.2380105047979, -586.1210135254914, -691.42741283787, -740.0085647867355, -183.95714569180615, -1181.0045627268291, -633.5917565343574, -410.08227717747144, -704.765326675209, -1351.505612317497, -795.5885210486452, -696.4558646378232, -259.2213548225484, -1025.2227625498247, -167.7013986333184, -657.9172185846887, -384.6340021992598, -838.8873755881688, -1133.451217274728, -1064.2920729737857, -888.000499612337, -1054.7279333906777, -685.2369586037986, -1190.2350309490573, -974.2066551336331, -473.4095010100879, -19.95263209487613, -32.58251836290103, -929.2986414354773, -363.09989112237395, -334.22782107856136, -485.27951317406456, -955.5998026728977, -129.52744000977646, -108.04511337354441, -349.1201425618955, -922.784087664138, -572.2054787015026, -246.82431061559274, -96.57472833038564, -799.1524097257477, -761.1677048019768, -1034.1187109793764, -698.7417485008001, -849.2503437870524, -127.06039006347692, -204.61076704569734, -1229.5625856308939, -718.6753783260582, -639.9140261035199, -682.807164101965], "episode_lengths": [150, 150, 150, 150, 150, 116, 104, 150, 150, 150, 150, 144, 150, 120, 150, 135, 83, 126, 150, 150, 150, 105, 150, 107, 150, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 48, 150, 150, 150, 150, 64, 150, 150, 150, 150, 88, 150, 150, 150, 150, 150, 150, 140, 124, 150, 60, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 48, 50, 150, 103, 150, 150, 150, 62, 79, 94, 150, 150, 150, 50, 150, 150, 150, 150, 150, 56, 68, 150, 150, 135, 150], "policy_policy_0_reward": [-560.4645331841355, -517.2166716556728, -787.1762212114605, -995.7835250166441, -788.1762156910573, -296.05028113901574, -456.6575951556104, -751.3141574422152, -959.6894970693405, -1016.43135793612, -1200.8187842447485, -849.9672973907786, -1010.6856744702131, -338.03215684230906, -763.856573866106, -699.2230035123928, -84.60940724103993, -402.15945489140944, -703.2536488435511, -1001.6070515566627, -503.54146915482505, -417.90157763411696, -1213.3502110632026, -383.09714171018777, -834.5554168495113, -1137.3426166912652, -786.0572964971932, -912.4409736524003, -464.6955068597808, -860.3821205430944, -869.1760006065502, -1000.9316742887607, -1105.3925565977072, -852.9974179524263, -1005.242437681182, -1036.1304538860877, -807.6367101357457, -1069.687083341108, -739.7496234100068, -749.3669096803196, -1046.4799904522056, -589.741695793768, -778.6048273076013, -10.609284078612912, -656.1486786133976, -1031.115222520955, -709.2214174269908, -911.6203113979574, -79.38811546447792, -599.2380105047979, -586.1210135254914, -691.42741283787, -740.0085647867355, -183.95714569180615, -1181.0045627268291, -633.5917565343574, -410.08227717747144, -704.765326675209, -1351.505612317497, -795.5885210486452, -696.4558646378232, -259.2213548225484, -1025.2227625498247, -167.7013986333184, -657.9172185846887, -384.6340021992598, -838.8873755881688, -1133.451217274728, -1064.2920729737857, -888.000499612337, -1054.7279333906777, -685.2369586037986, -1190.2350309490573, -974.2066551336331, -473.4095010100879, -19.95263209487613, -32.58251836290103, -929.2986414354773, -363.09989112237395, -334.22782107856136, -485.27951317406456, -955.5998026728977, -129.52744000977646, -108.04511337354441, -349.1201425618955, -922.784087664138, -572.2054787015026, -246.82431061559274, -96.57472833038564, -799.1524097257477, -761.1677048019768, -1034.1187109793764, -698.7417485008001, -849.2503437870524, -127.06039006347692, -204.61076704569734, -1229.5625856308939, -718.6753783260582, -639.9140261035199, -682.807164101965]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.559817819137315, "mean_inference_ms": 1.690853288004481, "mean_action_processing_ms": 0.28443567790097535, "mean_env_wait_ms": 3.0067497057285357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01287221908569336, "StateBufferConnector_ms": 0.008463382720947266, "ViewRequirementAgentConnector_ms": 0.18888497352600098}, "num_episodes": 29, "episode_return_max": -10.609284078612912, "episode_return_min": -1351.505612317497, "episode_return_mean": -694.0685124970693, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.3858162637533, "num_env_steps_trained_throughput_per_sec": 302.3858162637533, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12054.786, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12054.718, "sample_time_ms": 1056.846, "learn_time_ms": 10933.909, "learn_throughput": 365.834, "synch_weights_time_ms": 63.223}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "92003_00016", "date": "2024-08-03_05-02-24", "timestamp": 1722641544, "time_this_iter_s": 13.239481449127197, "time_total_s": 84.4711365699768, "pid": 484683, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b30fa3ac0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 84.4711365699768, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 17.573684210526313, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.482063555344939, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.784602212409178, "policy_loss": -0.00791436843428528, "vf_loss": 8.78996031532685, "vf_explained_var": 0.23053840287029742, "kl": 0.013529643516858415, "entropy": 1.4967933217684428, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -10.609284078612912, "episode_reward_min": -1351.505612317497, "episode_reward_mean": -688.8556204688734, "episode_len_mean": 134.62, "episode_media": {}, "episodes_timesteps_total": 13462, "policy_reward_min": {"policy_0": -1351.505612317497}, "policy_reward_max": {"policy_0": -10.609284078612912}, "policy_reward_mean": {"policy_0": -688.8556204688734}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-869.1760006065502, -1000.9316742887607, -1105.3925565977072, -852.9974179524263, -1005.242437681182, -1036.1304538860877, -807.6367101357457, -1069.687083341108, -739.7496234100068, -749.3669096803196, -1046.4799904522056, -589.741695793768, -778.6048273076013, -10.609284078612912, -656.1486786133976, -1031.115222520955, -709.2214174269908, -911.6203113979574, -79.38811546447792, -599.2380105047979, -586.1210135254914, -691.42741283787, -740.0085647867355, -183.95714569180615, -1181.0045627268291, -633.5917565343574, -410.08227717747144, -704.765326675209, -1351.505612317497, -795.5885210486452, -696.4558646378232, -259.2213548225484, -1025.2227625498247, -167.7013986333184, -657.9172185846887, -384.6340021992598, -838.8873755881688, -1133.451217274728, -1064.2920729737857, -888.000499612337, -1054.7279333906777, -685.2369586037986, -1190.2350309490573, -974.2066551336331, -473.4095010100879, -19.95263209487613, -32.58251836290103, -929.2986414354773, -363.09989112237395, -334.22782107856136, -485.27951317406456, -955.5998026728977, -129.52744000977646, -108.04511337354441, -349.1201425618955, -922.784087664138, -572.2054787015026, -246.82431061559274, -96.57472833038564, -799.1524097257477, -761.1677048019768, -1034.1187109793764, -698.7417485008001, -849.2503437870524, -127.06039006347692, -204.61076704569734, -1229.5625856308939, -718.6753783260582, -639.9140261035199, -682.807164101965, -788.2819789424223, -912.0057597676434, -1099.4783982070705, -940.770266397592, -1166.0853463766755, -922.3969783564798, -736.4315791066156, -837.9591347123671, -255.40484407478098, -811.499317395548, -438.0575338353015, -882.6226146102879, -527.2459447883858, -611.3475181948469, -222.79764786445156, -800.3596763172441, -874.8870020588389, -977.6893679058135, -850.5461444670526, -1035.429173380695, -490.1859936400029, -662.7985372003757, -107.63700254452587, -429.5837772402229, -204.2750745207442, -763.9501290344324, -862.4159083494807, -919.4477640330396, -789.2803230028021, -254.3774998707448], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 48, 150, 150, 150, 150, 64, 150, 150, 150, 150, 88, 150, 150, 150, 150, 150, 150, 140, 124, 150, 60, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 48, 50, 150, 103, 150, 150, 150, 62, 79, 94, 150, 150, 150, 50, 150, 150, 150, 150, 150, 56, 68, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 143, 150, 95, 150, 150, 150, 150, 150, 79, 150, 150, 150, 150, 150, 123, 150, 86, 150, 69, 150, 150, 150, 150, 95], "policy_policy_0_reward": [-869.1760006065502, -1000.9316742887607, -1105.3925565977072, -852.9974179524263, -1005.242437681182, -1036.1304538860877, -807.6367101357457, -1069.687083341108, -739.7496234100068, -749.3669096803196, -1046.4799904522056, -589.741695793768, -778.6048273076013, -10.609284078612912, -656.1486786133976, -1031.115222520955, -709.2214174269908, -911.6203113979574, -79.38811546447792, -599.2380105047979, -586.1210135254914, -691.42741283787, -740.0085647867355, -183.95714569180615, -1181.0045627268291, -633.5917565343574, -410.08227717747144, -704.765326675209, -1351.505612317497, -795.5885210486452, -696.4558646378232, -259.2213548225484, -1025.2227625498247, -167.7013986333184, -657.9172185846887, -384.6340021992598, -838.8873755881688, -1133.451217274728, -1064.2920729737857, -888.000499612337, -1054.7279333906777, -685.2369586037986, -1190.2350309490573, -974.2066551336331, -473.4095010100879, -19.95263209487613, -32.58251836290103, -929.2986414354773, -363.09989112237395, -334.22782107856136, -485.27951317406456, -955.5998026728977, -129.52744000977646, -108.04511337354441, -349.1201425618955, -922.784087664138, -572.2054787015026, -246.82431061559274, -96.57472833038564, -799.1524097257477, -761.1677048019768, -1034.1187109793764, -698.7417485008001, -849.2503437870524, -127.06039006347692, -204.61076704569734, -1229.5625856308939, -718.6753783260582, -639.9140261035199, -682.807164101965, -788.2819789424223, -912.0057597676434, -1099.4783982070705, -940.770266397592, -1166.0853463766755, -922.3969783564798, -736.4315791066156, -837.9591347123671, -255.40484407478098, -811.499317395548, -438.0575338353015, -882.6226146102879, -527.2459447883858, -611.3475181948469, -222.79764786445156, -800.3596763172441, -874.8870020588389, -977.6893679058135, -850.5461444670526, -1035.429173380695, -490.1859936400029, -662.7985372003757, -107.63700254452587, -429.5837772402229, -204.2750745207442, -763.9501290344324, -862.4159083494807, -919.4477640330396, -789.2803230028021, -254.3774998707448]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5589269832074337, "mean_inference_ms": 1.689612834216368, "mean_action_processing_ms": 0.28372106120695295, "mean_env_wait_ms": 3.0063620260544313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012521743774414062, "StateBufferConnector_ms": 0.008220672607421875, "ViewRequirementAgentConnector_ms": 0.1895906925201416}, "num_episodes": 30, "episode_return_max": -10.609284078612912, "episode_return_min": -1351.505612317497, "episode_return_mean": -688.8556204688734, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.27826079350945, "num_env_steps_trained_throughput_per_sec": 308.27826079350945, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12169.85, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12169.783, "sample_time_ms": 1055.195, "learn_time_ms": 11050.399, "learn_throughput": 361.978, "synch_weights_time_ms": 63.438}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "92003_00016", "date": "2024-08-03_05-02-37", "timestamp": 1722641557, "time_this_iter_s": 12.98713731765747, "time_total_s": 97.45827388763428, "pid": 484683, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b327f7be0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 97.45827388763428, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 17.749999999999996, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.312018729497989, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.90546324402094, "policy_loss": -0.019076586732019982, "vf_loss": 8.920342979828517, "vf_explained_var": 0.2937935105835398, "kl": 0.021786286431961344, "entropy": 1.604115802794695, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -19.95263209487613, "episode_reward_min": -1308.422386616087, "episode_reward_mean": -690.2877799662441, "episode_len_mean": 134.38, "episode_media": {}, "episodes_timesteps_total": 13438, "policy_reward_min": {"policy_0": -1308.422386616087}, "policy_reward_max": {"policy_0": -19.95263209487613}, "policy_reward_mean": {"policy_0": -690.2877799662441}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-795.5885210486452, -696.4558646378232, -259.2213548225484, -1025.2227625498247, -167.7013986333184, -657.9172185846887, -384.6340021992598, -838.8873755881688, -1133.451217274728, -1064.2920729737857, -888.000499612337, -1054.7279333906777, -685.2369586037986, -1190.2350309490573, -974.2066551336331, -473.4095010100879, -19.95263209487613, -32.58251836290103, -929.2986414354773, -363.09989112237395, -334.22782107856136, -485.27951317406456, -955.5998026728977, -129.52744000977646, -108.04511337354441, -349.1201425618955, -922.784087664138, -572.2054787015026, -246.82431061559274, -96.57472833038564, -799.1524097257477, -761.1677048019768, -1034.1187109793764, -698.7417485008001, -849.2503437870524, -127.06039006347692, -204.61076704569734, -1229.5625856308939, -718.6753783260582, -639.9140261035199, -682.807164101965, -788.2819789424223, -912.0057597676434, -1099.4783982070705, -940.770266397592, -1166.0853463766755, -922.3969783564798, -736.4315791066156, -837.9591347123671, -255.40484407478098, -811.499317395548, -438.0575338353015, -882.6226146102879, -527.2459447883858, -611.3475181948469, -222.79764786445156, -800.3596763172441, -874.8870020588389, -977.6893679058135, -850.5461444670526, -1035.429173380695, -490.1859936400029, -662.7985372003757, -107.63700254452587, -429.5837772402229, -204.2750745207442, -763.9501290344324, -862.4159083494807, -919.4477640330396, -789.2803230028021, -254.3774998707448, -656.5148217760533, -728.4776826452024, -792.671911515161, -884.6063072300994, -1037.367324505367, -1005.5974067934627, -994.2280763138891, -108.82536144395428, -736.0738750730053, -634.0109325677447, -800.6153667754672, -525.4254873830165, -482.0219337158487, -1011.2868012767747, -1097.990879688143, -751.9371672238367, -870.271767742882, -93.59444685660311, -985.4668174835905, -664.7921833289482, -964.7103994608997, -773.1284946715938, -922.2074869180506, -850.3703055071161, -815.2726740187555, -840.3542000667948, -94.6272502099383, -843.2882943426946, -1308.422386616087], "episode_lengths": [150, 140, 124, 150, 60, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 48, 50, 150, 103, 150, 150, 150, 62, 79, 94, 150, 150, 150, 50, 150, 150, 150, 150, 150, 56, 68, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 143, 150, 95, 150, 150, 150, 150, 150, 79, 150, 150, 150, 150, 150, 123, 150, 86, 150, 69, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 150, 60, 150, 150, 150, 150, 137, 150, 150, 150, 150, 71, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150], "policy_policy_0_reward": [-795.5885210486452, -696.4558646378232, -259.2213548225484, -1025.2227625498247, -167.7013986333184, -657.9172185846887, -384.6340021992598, -838.8873755881688, -1133.451217274728, -1064.2920729737857, -888.000499612337, -1054.7279333906777, -685.2369586037986, -1190.2350309490573, -974.2066551336331, -473.4095010100879, -19.95263209487613, -32.58251836290103, -929.2986414354773, -363.09989112237395, -334.22782107856136, -485.27951317406456, -955.5998026728977, -129.52744000977646, -108.04511337354441, -349.1201425618955, -922.784087664138, -572.2054787015026, -246.82431061559274, -96.57472833038564, -799.1524097257477, -761.1677048019768, -1034.1187109793764, -698.7417485008001, -849.2503437870524, -127.06039006347692, -204.61076704569734, -1229.5625856308939, -718.6753783260582, -639.9140261035199, -682.807164101965, -788.2819789424223, -912.0057597676434, -1099.4783982070705, -940.770266397592, -1166.0853463766755, -922.3969783564798, -736.4315791066156, -837.9591347123671, -255.40484407478098, -811.499317395548, -438.0575338353015, -882.6226146102879, -527.2459447883858, -611.3475181948469, -222.79764786445156, -800.3596763172441, -874.8870020588389, -977.6893679058135, -850.5461444670526, -1035.429173380695, -490.1859936400029, -662.7985372003757, -107.63700254452587, -429.5837772402229, -204.2750745207442, -763.9501290344324, -862.4159083494807, -919.4477640330396, -789.2803230028021, -254.3774998707448, -656.5148217760533, -728.4776826452024, -792.671911515161, -884.6063072300994, -1037.367324505367, -1005.5974067934627, -994.2280763138891, -108.82536144395428, -736.0738750730053, -634.0109325677447, -800.6153667754672, -525.4254873830165, -482.0219337158487, -1011.2868012767747, -1097.990879688143, -751.9371672238367, -870.271767742882, -93.59444685660311, -985.4668174835905, -664.7921833289482, -964.7103994608997, -773.1284946715938, -922.2074869180506, -850.3703055071161, -815.2726740187555, -840.3542000667948, -94.6272502099383, -843.2882943426946, -1308.422386616087]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.557423688248288, "mean_inference_ms": 1.687768135465174, "mean_action_processing_ms": 0.2826708141327619, "mean_env_wait_ms": 3.006258065125028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012172698974609375, "StateBufferConnector_ms": 0.007927179336547852, "ViewRequirementAgentConnector_ms": 0.18774175643920898}, "num_episodes": 29, "episode_return_max": -19.95263209487613, "episode_return_min": -1308.422386616087, "episode_return_mean": -690.2877799662441, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.7234564468307, "num_env_steps_trained_throughput_per_sec": 303.7234564468307, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12280.965, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12280.898, "sample_time_ms": 1051.659, "learn_time_ms": 11165.111, "learn_throughput": 358.259, "synch_weights_time_ms": 63.37}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "92003_00016", "date": "2024-08-03_05-02-50", "timestamp": 1722641570, "time_this_iter_s": 13.182560920715332, "time_total_s": 110.64083480834961, "pid": 484683, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b135289d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 110.64083480834961, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 17.49473684210526, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.165781994909048, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.480619277060033, "policy_loss": -0.017272176564438267, "vf_loss": 8.4924648274978, "vf_explained_var": 0.4077830654258529, "kl": 0.018671681655238605, "entropy": 1.7486988907059033, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -85.25093552376936, "episode_reward_min": -1358.2023528092298, "episode_reward_mean": -738.8820970823201, "episode_len_mean": 137.76, "episode_media": {}, "episodes_timesteps_total": 13776, "policy_reward_min": {"policy_0": -1358.2023528092298}, "policy_reward_max": {"policy_0": -85.25093552376936}, "policy_reward_mean": {"policy_0": -738.8820970823201}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-246.82431061559274, -96.57472833038564, -799.1524097257477, -761.1677048019768, -1034.1187109793764, -698.7417485008001, -849.2503437870524, -127.06039006347692, -204.61076704569734, -1229.5625856308939, -718.6753783260582, -639.9140261035199, -682.807164101965, -788.2819789424223, -912.0057597676434, -1099.4783982070705, -940.770266397592, -1166.0853463766755, -922.3969783564798, -736.4315791066156, -837.9591347123671, -255.40484407478098, -811.499317395548, -438.0575338353015, -882.6226146102879, -527.2459447883858, -611.3475181948469, -222.79764786445156, -800.3596763172441, -874.8870020588389, -977.6893679058135, -850.5461444670526, -1035.429173380695, -490.1859936400029, -662.7985372003757, -107.63700254452587, -429.5837772402229, -204.2750745207442, -763.9501290344324, -862.4159083494807, -919.4477640330396, -789.2803230028021, -254.3774998707448, -656.5148217760533, -728.4776826452024, -792.671911515161, -884.6063072300994, -1037.367324505367, -1005.5974067934627, -994.2280763138891, -108.82536144395428, -736.0738750730053, -634.0109325677447, -800.6153667754672, -525.4254873830165, -482.0219337158487, -1011.2868012767747, -1097.990879688143, -751.9371672238367, -870.271767742882, -93.59444685660311, -985.4668174835905, -664.7921833289482, -964.7103994608997, -773.1284946715938, -922.2074869180506, -850.3703055071161, -815.2726740187555, -840.3542000667948, -94.6272502099383, -843.2882943426946, -1308.422386616087, -863.8533434722115, -105.21881985954893, -314.3647051110753, -1053.6757105702552, -270.42492275231865, -606.4343590269259, -85.25093552376936, -1016.6316016628082, -1335.0022168816504, -1081.12196321928, -818.3395777407321, -477.49081841325574, -525.4318270515445, -866.2574831738837, -1090.6584277172512, -969.168542973827, -1125.4155465297952, -933.4406001501077, -1003.9595851568489, -1031.6604285516269, -811.9911068393823, -320.4666018455091, -886.4186992870044, -551.3433013904471, -586.6048087434193, -1072.6834682978274, -1188.8314061204799, -1358.2023528092298], "episode_lengths": [150, 50, 150, 150, 150, 150, 150, 56, 68, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 143, 150, 95, 150, 150, 150, 150, 150, 79, 150, 150, 150, 150, 150, 123, 150, 86, 150, 69, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 150, 60, 150, 150, 150, 150, 137, 150, 150, 150, 150, 71, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 95, 150, 150, 77, 150, 69, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 116, 150, 150, 150, 150], "policy_policy_0_reward": [-246.82431061559274, -96.57472833038564, -799.1524097257477, -761.1677048019768, -1034.1187109793764, -698.7417485008001, -849.2503437870524, -127.06039006347692, -204.61076704569734, -1229.5625856308939, -718.6753783260582, -639.9140261035199, -682.807164101965, -788.2819789424223, -912.0057597676434, -1099.4783982070705, -940.770266397592, -1166.0853463766755, -922.3969783564798, -736.4315791066156, -837.9591347123671, -255.40484407478098, -811.499317395548, -438.0575338353015, -882.6226146102879, -527.2459447883858, -611.3475181948469, -222.79764786445156, -800.3596763172441, -874.8870020588389, -977.6893679058135, -850.5461444670526, -1035.429173380695, -490.1859936400029, -662.7985372003757, -107.63700254452587, -429.5837772402229, -204.2750745207442, -763.9501290344324, -862.4159083494807, -919.4477640330396, -789.2803230028021, -254.3774998707448, -656.5148217760533, -728.4776826452024, -792.671911515161, -884.6063072300994, -1037.367324505367, -1005.5974067934627, -994.2280763138891, -108.82536144395428, -736.0738750730053, -634.0109325677447, -800.6153667754672, -525.4254873830165, -482.0219337158487, -1011.2868012767747, -1097.990879688143, -751.9371672238367, -870.271767742882, -93.59444685660311, -985.4668174835905, -664.7921833289482, -964.7103994608997, -773.1284946715938, -922.2074869180506, -850.3703055071161, -815.2726740187555, -840.3542000667948, -94.6272502099383, -843.2882943426946, -1308.422386616087, -863.8533434722115, -105.21881985954893, -314.3647051110753, -1053.6757105702552, -270.42492275231865, -606.4343590269259, -85.25093552376936, -1016.6316016628082, -1335.0022168816504, -1081.12196321928, -818.3395777407321, -477.49081841325574, -525.4318270515445, -866.2574831738837, -1090.6584277172512, -969.168542973827, -1125.4155465297952, -933.4406001501077, -1003.9595851568489, -1031.6604285516269, -811.9911068393823, -320.4666018455091, -886.4186992870044, -551.3433013904471, -586.6048087434193, -1072.6834682978274, -1188.8314061204799, -1358.2023528092298]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.556438549999986, "mean_inference_ms": 1.6855995996337905, "mean_action_processing_ms": 0.2819562226874914, "mean_env_wait_ms": 3.0127979556043893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011870145797729492, "StateBufferConnector_ms": 0.007793903350830078, "ViewRequirementAgentConnector_ms": 0.18827581405639648}, "num_episodes": 28, "episode_return_max": -85.25093552376936, "episode_return_min": -1358.2023528092298, "episode_return_mean": -738.8820970823201, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.2107196180321, "num_env_steps_trained_throughput_per_sec": 310.2107196180321, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12342.316, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12342.249, "sample_time_ms": 1064.712, "learn_time_ms": 11213.26, "learn_throughput": 356.721, "synch_weights_time_ms": 63.523}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "92003_00016", "date": "2024-08-03_05-03-03", "timestamp": 1722641583, "time_this_iter_s": 12.906384944915771, "time_total_s": 123.54721975326538, "pid": 484683, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b1352b640>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 123.54721975326538, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 17.72105263157895, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.915916530042885, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.553374626239141, "policy_loss": -0.014715935808878082, "vf_loss": 7.5634701614578566, "vf_explained_var": 0.5940390680606167, "kl": 0.015914441363990287, "entropy": 1.5394919445117314, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -67.2370282440025, "episode_reward_min": -1358.2023528092298, "episode_reward_mean": -729.641281553149, "episode_len_mean": 136.77, "episode_media": {}, "episodes_timesteps_total": 13677, "policy_reward_min": {"policy_0": -1358.2023528092298}, "policy_reward_max": {"policy_0": -67.2370282440025}, "policy_reward_mean": {"policy_0": -729.641281553149}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-874.8870020588389, -977.6893679058135, -850.5461444670526, -1035.429173380695, -490.1859936400029, -662.7985372003757, -107.63700254452587, -429.5837772402229, -204.2750745207442, -763.9501290344324, -862.4159083494807, -919.4477640330396, -789.2803230028021, -254.3774998707448, -656.5148217760533, -728.4776826452024, -792.671911515161, -884.6063072300994, -1037.367324505367, -1005.5974067934627, -994.2280763138891, -108.82536144395428, -736.0738750730053, -634.0109325677447, -800.6153667754672, -525.4254873830165, -482.0219337158487, -1011.2868012767747, -1097.990879688143, -751.9371672238367, -870.271767742882, -93.59444685660311, -985.4668174835905, -664.7921833289482, -964.7103994608997, -773.1284946715938, -922.2074869180506, -850.3703055071161, -815.2726740187555, -840.3542000667948, -94.6272502099383, -843.2882943426946, -1308.422386616087, -863.8533434722115, -105.21881985954893, -314.3647051110753, -1053.6757105702552, -270.42492275231865, -606.4343590269259, -85.25093552376936, -1016.6316016628082, -1335.0022168816504, -1081.12196321928, -818.3395777407321, -477.49081841325574, -525.4318270515445, -866.2574831738837, -1090.6584277172512, -969.168542973827, -1125.4155465297952, -933.4406001501077, -1003.9595851568489, -1031.6604285516269, -811.9911068393823, -320.4666018455091, -886.4186992870044, -551.3433013904471, -586.6048087434193, -1072.6834682978274, -1188.8314061204799, -1358.2023528092298, -1039.6235809080217, -478.4412268469356, -1119.4261263888106, -85.18882948932867, -1136.380867627619, -934.7488020362977, -538.3669076652419, -478.76191783127325, -927.7727043166914, -600.3311848058385, -940.8140064840563, -350.9708313539429, -449.0988073360045, -668.0727913358485, -488.69000168648563, -1327.9964241776104, -67.2370282440025, -1023.3437551610009, -1044.6310195347291, -666.1165562697396, -80.88279899012592, -958.9202610167346, -379.58263024545505, -531.8632993117233, -203.7143357882413, -1254.8078308378656, -241.8685542652465, -523.4823589901024, -575.9878150981552], "episode_lengths": [150, 150, 150, 150, 123, 150, 86, 150, 69, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 150, 60, 150, 150, 150, 150, 137, 150, 150, 150, 150, 71, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 95, 150, 150, 77, 150, 69, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 116, 150, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 115, 150, 150, 150, 111, 150, 150, 150, 150, 65, 150, 150, 150, 53, 150, 97, 150, 99, 150, 85, 150, 150], "policy_policy_0_reward": [-874.8870020588389, -977.6893679058135, -850.5461444670526, -1035.429173380695, -490.1859936400029, -662.7985372003757, -107.63700254452587, -429.5837772402229, -204.2750745207442, -763.9501290344324, -862.4159083494807, -919.4477640330396, -789.2803230028021, -254.3774998707448, -656.5148217760533, -728.4776826452024, -792.671911515161, -884.6063072300994, -1037.367324505367, -1005.5974067934627, -994.2280763138891, -108.82536144395428, -736.0738750730053, -634.0109325677447, -800.6153667754672, -525.4254873830165, -482.0219337158487, -1011.2868012767747, -1097.990879688143, -751.9371672238367, -870.271767742882, -93.59444685660311, -985.4668174835905, -664.7921833289482, -964.7103994608997, -773.1284946715938, -922.2074869180506, -850.3703055071161, -815.2726740187555, -840.3542000667948, -94.6272502099383, -843.2882943426946, -1308.422386616087, -863.8533434722115, -105.21881985954893, -314.3647051110753, -1053.6757105702552, -270.42492275231865, -606.4343590269259, -85.25093552376936, -1016.6316016628082, -1335.0022168816504, -1081.12196321928, -818.3395777407321, -477.49081841325574, -525.4318270515445, -866.2574831738837, -1090.6584277172512, -969.168542973827, -1125.4155465297952, -933.4406001501077, -1003.9595851568489, -1031.6604285516269, -811.9911068393823, -320.4666018455091, -886.4186992870044, -551.3433013904471, -586.6048087434193, -1072.6834682978274, -1188.8314061204799, -1358.2023528092298, -1039.6235809080217, -478.4412268469356, -1119.4261263888106, -85.18882948932867, -1136.380867627619, -934.7488020362977, -538.3669076652419, -478.76191783127325, -927.7727043166914, -600.3311848058385, -940.8140064840563, -350.9708313539429, -449.0988073360045, -668.0727913358485, -488.69000168648563, -1327.9964241776104, -67.2370282440025, -1023.3437551610009, -1044.6310195347291, -666.1165562697396, -80.88279899012592, -958.9202610167346, -379.58263024545505, -531.8632993117233, -203.7143357882413, -1254.8078308378656, -241.8685542652465, -523.4823589901024, -575.9878150981552]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5556537376543571, "mean_inference_ms": 1.6856123477235991, "mean_action_processing_ms": 0.281144138572189, "mean_env_wait_ms": 3.0225222041329785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01214742660522461, "StateBufferConnector_ms": 0.007685661315917969, "ViewRequirementAgentConnector_ms": 0.18570280075073242}, "num_episodes": 29, "episode_return_max": -67.2370282440025, "episode_return_min": -1358.2023528092298, "episode_return_mean": -729.641281553149, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 382.4693115472329, "num_env_steps_trained_throughput_per_sec": 382.4693115472329, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12241.317, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12241.25, "sample_time_ms": 1068.196, "learn_time_ms": 11108.829, "learn_throughput": 360.074, "synch_weights_time_ms": 63.468}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "92003_00016", "date": "2024-08-03_05-03-13", "timestamp": 1722641593, "time_this_iter_s": 10.469781398773193, "time_total_s": 134.01700115203857, "pid": 484683, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b1352b9a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 134.01700115203857, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 19.764285714285712, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34.542330950001876, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.532283619046211, "policy_loss": -0.015067071797481428, "vf_loss": 7.541760111351808, "vf_explained_var": 0.5910627936944366, "kl": 0.019259533476179057, "entropy": 1.8728230490038793, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -33.42277164243082, "episode_reward_min": -1358.2023528092298, "episode_reward_mean": -771.7939940709855, "episode_len_mean": 138.11, "episode_media": {}, "episodes_timesteps_total": 13811, "policy_reward_min": {"policy_0": -1358.2023528092298}, "policy_reward_max": {"policy_0": -33.42277164243082}, "policy_reward_mean": {"policy_0": -771.7939940709855}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011.2868012767747, -1097.990879688143, -751.9371672238367, -870.271767742882, -93.59444685660311, -985.4668174835905, -664.7921833289482, -964.7103994608997, -773.1284946715938, -922.2074869180506, -850.3703055071161, -815.2726740187555, -840.3542000667948, -94.6272502099383, -843.2882943426946, -1308.422386616087, -863.8533434722115, -105.21881985954893, -314.3647051110753, -1053.6757105702552, -270.42492275231865, -606.4343590269259, -85.25093552376936, -1016.6316016628082, -1335.0022168816504, -1081.12196321928, -818.3395777407321, -477.49081841325574, -525.4318270515445, -866.2574831738837, -1090.6584277172512, -969.168542973827, -1125.4155465297952, -933.4406001501077, -1003.9595851568489, -1031.6604285516269, -811.9911068393823, -320.4666018455091, -886.4186992870044, -551.3433013904471, -586.6048087434193, -1072.6834682978274, -1188.8314061204799, -1358.2023528092298, -1039.6235809080217, -478.4412268469356, -1119.4261263888106, -85.18882948932867, -1136.380867627619, -934.7488020362977, -538.3669076652419, -478.76191783127325, -927.7727043166914, -600.3311848058385, -940.8140064840563, -350.9708313539429, -449.0988073360045, -668.0727913358485, -488.69000168648563, -1327.9964241776104, -67.2370282440025, -1023.3437551610009, -1044.6310195347291, -666.1165562697396, -80.88279899012592, -958.9202610167346, -379.58263024545505, -531.8632993117233, -203.7143357882413, -1254.8078308378656, -241.8685542652465, -523.4823589901024, -575.9878150981552, -1030.0056462659672, -942.9829328587981, -1088.0681616924835, -344.5737898188065, -798.4749343037691, -1002.118245375352, -190.41410641991592, -671.0479612611831, -958.0573036633567, -369.51518219385053, -452.33121570051816, -786.0692201167906, -1039.3394190914148, -33.42277164243082, -1025.5416610985574, -953.3112836025656, -1202.8637682793617, -941.6263505711117, -969.2892374903407, -1162.834216357094, -985.0868487358431, -540.0780435486508, -1315.8868013546792, -973.9411040340432, -1044.537423211077, -975.9620311014575, -1026.8317769812666], "episode_lengths": [150, 150, 150, 150, 71, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 95, 150, 150, 77, 150, 69, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 116, 150, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 115, 150, 150, 150, 111, 150, 150, 150, 150, 65, 150, 150, 150, 53, 150, 97, 150, 99, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 143, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1011.2868012767747, -1097.990879688143, -751.9371672238367, -870.271767742882, -93.59444685660311, -985.4668174835905, -664.7921833289482, -964.7103994608997, -773.1284946715938, -922.2074869180506, -850.3703055071161, -815.2726740187555, -840.3542000667948, -94.6272502099383, -843.2882943426946, -1308.422386616087, -863.8533434722115, -105.21881985954893, -314.3647051110753, -1053.6757105702552, -270.42492275231865, -606.4343590269259, -85.25093552376936, -1016.6316016628082, -1335.0022168816504, -1081.12196321928, -818.3395777407321, -477.49081841325574, -525.4318270515445, -866.2574831738837, -1090.6584277172512, -969.168542973827, -1125.4155465297952, -933.4406001501077, -1003.9595851568489, -1031.6604285516269, -811.9911068393823, -320.4666018455091, -886.4186992870044, -551.3433013904471, -586.6048087434193, -1072.6834682978274, -1188.8314061204799, -1358.2023528092298, -1039.6235809080217, -478.4412268469356, -1119.4261263888106, -85.18882948932867, -1136.380867627619, -934.7488020362977, -538.3669076652419, -478.76191783127325, -927.7727043166914, -600.3311848058385, -940.8140064840563, -350.9708313539429, -449.0988073360045, -668.0727913358485, -488.69000168648563, -1327.9964241776104, -67.2370282440025, -1023.3437551610009, -1044.6310195347291, -666.1165562697396, -80.88279899012592, -958.9202610167346, -379.58263024545505, -531.8632993117233, -203.7143357882413, -1254.8078308378656, -241.8685542652465, -523.4823589901024, -575.9878150981552, -1030.0056462659672, -942.9829328587981, -1088.0681616924835, -344.5737898188065, -798.4749343037691, -1002.118245375352, -190.41410641991592, -671.0479612611831, -958.0573036633567, -369.51518219385053, -452.33121570051816, -786.0692201167906, -1039.3394190914148, -33.42277164243082, -1025.5416610985574, -953.3112836025656, -1202.8637682793617, -941.6263505711117, -969.2892374903407, -1162.834216357094, -985.0868487358431, -540.0780435486508, -1315.8868013546792, -973.9411040340432, -1044.537423211077, -975.9620311014575, -1026.8317769812666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5553780404043449, "mean_inference_ms": 1.684087446817399, "mean_action_processing_ms": 0.28049529912193305, "mean_env_wait_ms": 3.028886811711176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012183666229248047, "StateBufferConnector_ms": 0.007701396942138672, "ViewRequirementAgentConnector_ms": 0.1851367950439453}, "num_episodes": 27, "episode_return_max": -33.42277164243082, "episode_return_min": -1358.2023528092298, "episode_return_mean": -771.7939940709855, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 363.8447070840587, "num_env_steps_trained_throughput_per_sec": 363.8447070840587, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12121.223, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12121.155, "sample_time_ms": 1069.032, "learn_time_ms": 10987.448, "learn_throughput": 364.052, "synch_weights_time_ms": 63.921}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "92003_00016", "date": "2024-08-03_05-03-24", "timestamp": 1722641604, "time_this_iter_s": 11.006062746047974, "time_total_s": 145.02306389808655, "pid": 484683, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b1352b1c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 145.02306389808655, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 18.793750000000003, "ram_util_percent": 27.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 45.112207506597045, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.077282831072807, "policy_loss": -0.011095975424783926, "vf_loss": 7.083290169139703, "vf_explained_var": 0.6759484408423304, "kl": 0.017550049674476518, "entropy": 1.7638630669564008, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -15.099349911251796, "episode_reward_min": -1526.1998380201178, "episode_reward_mean": -790.842476023189, "episode_len_mean": 140.01, "episode_media": {}, "episodes_timesteps_total": 14001, "policy_reward_min": {"policy_0": -1526.1998380201178}, "policy_reward_max": {"policy_0": -15.099349911251796}, "policy_reward_mean": {"policy_0": -790.842476023189}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-477.49081841325574, -525.4318270515445, -866.2574831738837, -1090.6584277172512, -969.168542973827, -1125.4155465297952, -933.4406001501077, -1003.9595851568489, -1031.6604285516269, -811.9911068393823, -320.4666018455091, -886.4186992870044, -551.3433013904471, -586.6048087434193, -1072.6834682978274, -1188.8314061204799, -1358.2023528092298, -1039.6235809080217, -478.4412268469356, -1119.4261263888106, -85.18882948932867, -1136.380867627619, -934.7488020362977, -538.3669076652419, -478.76191783127325, -927.7727043166914, -600.3311848058385, -940.8140064840563, -350.9708313539429, -449.0988073360045, -668.0727913358485, -488.69000168648563, -1327.9964241776104, -67.2370282440025, -1023.3437551610009, -1044.6310195347291, -666.1165562697396, -80.88279899012592, -958.9202610167346, -379.58263024545505, -531.8632993117233, -203.7143357882413, -1254.8078308378656, -241.8685542652465, -523.4823589901024, -575.9878150981552, -1030.0056462659672, -942.9829328587981, -1088.0681616924835, -344.5737898188065, -798.4749343037691, -1002.118245375352, -190.41410641991592, -671.0479612611831, -958.0573036633567, -369.51518219385053, -452.33121570051816, -786.0692201167906, -1039.3394190914148, -33.42277164243082, -1025.5416610985574, -953.3112836025656, -1202.8637682793617, -941.6263505711117, -969.2892374903407, -1162.834216357094, -985.0868487358431, -540.0780435486508, -1315.8868013546792, -973.9411040340432, -1044.537423211077, -975.9620311014575, -1026.8317769812666, -912.3640561894143, -1107.0417712953717, -788.5852927059668, -15.099349911251796, -1158.43004848389, -759.3403175900955, -884.3543980883601, -711.663509989529, -1075.133918441973, -1200.4670126456847, -390.3855724003099, -1120.301026010149, -1526.1998380201178, -589.4574376948399, -35.08651735037479, -863.1545907545615, -407.4530751046479, -886.7896431648568, -1171.843850388195, -950.1410002794777, -914.1529829403463, -498.6007586437806, -729.0320951336682, -906.7972677791571, -779.0893484452101, -1125.5814726015778, -836.3417544008305], "episode_lengths": [150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 116, 150, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 115, 150, 150, 150, 111, 150, 150, 150, 150, 65, 150, 150, 150, 53, 150, 97, 150, 99, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 143, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 54, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-477.49081841325574, -525.4318270515445, -866.2574831738837, -1090.6584277172512, -969.168542973827, -1125.4155465297952, -933.4406001501077, -1003.9595851568489, -1031.6604285516269, -811.9911068393823, -320.4666018455091, -886.4186992870044, -551.3433013904471, -586.6048087434193, -1072.6834682978274, -1188.8314061204799, -1358.2023528092298, -1039.6235809080217, -478.4412268469356, -1119.4261263888106, -85.18882948932867, -1136.380867627619, -934.7488020362977, -538.3669076652419, -478.76191783127325, -927.7727043166914, -600.3311848058385, -940.8140064840563, -350.9708313539429, -449.0988073360045, -668.0727913358485, -488.69000168648563, -1327.9964241776104, -67.2370282440025, -1023.3437551610009, -1044.6310195347291, -666.1165562697396, -80.88279899012592, -958.9202610167346, -379.58263024545505, -531.8632993117233, -203.7143357882413, -1254.8078308378656, -241.8685542652465, -523.4823589901024, -575.9878150981552, -1030.0056462659672, -942.9829328587981, -1088.0681616924835, -344.5737898188065, -798.4749343037691, -1002.118245375352, -190.41410641991592, -671.0479612611831, -958.0573036633567, -369.51518219385053, -452.33121570051816, -786.0692201167906, -1039.3394190914148, -33.42277164243082, -1025.5416610985574, -953.3112836025656, -1202.8637682793617, -941.6263505711117, -969.2892374903407, -1162.834216357094, -985.0868487358431, -540.0780435486508, -1315.8868013546792, -973.9411040340432, -1044.537423211077, -975.9620311014575, -1026.8317769812666, -912.3640561894143, -1107.0417712953717, -788.5852927059668, -15.099349911251796, -1158.43004848389, -759.3403175900955, -884.3543980883601, -711.663509989529, -1075.133918441973, -1200.4670126456847, -390.3855724003099, -1120.301026010149, -1526.1998380201178, -589.4574376948399, -35.08651735037479, -863.1545907545615, -407.4530751046479, -886.7896431648568, -1171.843850388195, -950.1410002794777, -914.1529829403463, -498.6007586437806, -729.0320951336682, -906.7972677791571, -779.0893484452101, -1125.5814726015778, -836.3417544008305]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5550485025490569, "mean_inference_ms": 1.6830785091315272, "mean_action_processing_ms": 0.2802362337063558, "mean_env_wait_ms": 3.034848782073553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01235055923461914, "StateBufferConnector_ms": 0.007784366607666016, "ViewRequirementAgentConnector_ms": 0.18676400184631348}, "num_episodes": 27, "episode_return_max": -15.099349911251796, "episode_return_min": -1526.1998380201178, "episode_return_mean": -790.842476023189, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.48320823559163, "num_env_steps_trained_throughput_per_sec": 305.48320823559163, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12134.271, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12134.205, "sample_time_ms": 1065.017, "learn_time_ms": 11005.38, "learn_throughput": 363.459, "synch_weights_time_ms": 63.057}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "92003_00016", "date": "2024-08-03_05-03-37", "timestamp": 1722641617, "time_this_iter_s": 13.107208967208862, "time_total_s": 158.1302728652954, "pid": 484683, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b1352b400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 158.1302728652954, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 17.499999999999996, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 37.608037217954795, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.1934398824969925, "policy_loss": -0.011802256222775516, "vf_loss": 7.20092321584622, "vf_explained_var": 0.7594304407015443, "kl": 0.01493593393328562, "entropy": 1.6185218966255586, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -15.099349911251796, "episode_reward_min": -1526.1998380201178, "episode_reward_mean": -758.8631000465834, "episode_len_mean": 137.09, "episode_media": {}, "episodes_timesteps_total": 13709, "policy_reward_min": {"policy_0": -1526.1998380201178}, "policy_reward_max": {"policy_0": -15.099349911251796}, "policy_reward_mean": {"policy_0": -758.8631000465834}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1044.6310195347291, -666.1165562697396, -80.88279899012592, -958.9202610167346, -379.58263024545505, -531.8632993117233, -203.7143357882413, -1254.8078308378656, -241.8685542652465, -523.4823589901024, -575.9878150981552, -1030.0056462659672, -942.9829328587981, -1088.0681616924835, -344.5737898188065, -798.4749343037691, -1002.118245375352, -190.41410641991592, -671.0479612611831, -958.0573036633567, -369.51518219385053, -452.33121570051816, -786.0692201167906, -1039.3394190914148, -33.42277164243082, -1025.5416610985574, -953.3112836025656, -1202.8637682793617, -941.6263505711117, -969.2892374903407, -1162.834216357094, -985.0868487358431, -540.0780435486508, -1315.8868013546792, -973.9411040340432, -1044.537423211077, -975.9620311014575, -1026.8317769812666, -912.3640561894143, -1107.0417712953717, -788.5852927059668, -15.099349911251796, -1158.43004848389, -759.3403175900955, -884.3543980883601, -711.663509989529, -1075.133918441973, -1200.4670126456847, -390.3855724003099, -1120.301026010149, -1526.1998380201178, -589.4574376948399, -35.08651735037479, -863.1545907545615, -407.4530751046479, -886.7896431648568, -1171.843850388195, -950.1410002794777, -914.1529829403463, -498.6007586437806, -729.0320951336682, -906.7972677791571, -779.0893484452101, -1125.5814726015778, -836.3417544008305, -999.3931423028146, -558.3515911587766, -51.07302569092924, -961.2247938650274, -701.8657878545014, -1333.2904471412442, -63.17912069463242, -506.4711430001059, -859.1089438786934, -1393.557207232059, -292.5524299284859, -968.9942080717145, -685.8459757852382, -645.9026207308718, -237.888757704099, -226.76968097462264, -863.1391156043636, -1281.8390283007084, -1444.1846131949903, -992.9200207966576, -576.7068218399136, -328.99781079849225, -1078.5487864002234, -153.95505594693472, -1004.9090585908671, -131.6867125739209, -719.5706520738921, -352.9452291830894, -616.001977691883, -568.5438588703103, -237.93777109693275, -1355.3204070173454, -391.79121438216447, -1003.8601446569407, -669.0260460524605], "episode_lengths": [150, 150, 53, 150, 97, 150, 99, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 143, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 54, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 57, 150, 150, 150, 49, 150, 150, 150, 150, 150, 150, 150, 76, 77, 150, 150, 150, 150, 132, 150, 150, 81, 150, 61, 150, 104, 150, 150, 79, 150, 145, 150, 150], "policy_policy_0_reward": [-1044.6310195347291, -666.1165562697396, -80.88279899012592, -958.9202610167346, -379.58263024545505, -531.8632993117233, -203.7143357882413, -1254.8078308378656, -241.8685542652465, -523.4823589901024, -575.9878150981552, -1030.0056462659672, -942.9829328587981, -1088.0681616924835, -344.5737898188065, -798.4749343037691, -1002.118245375352, -190.41410641991592, -671.0479612611831, -958.0573036633567, -369.51518219385053, -452.33121570051816, -786.0692201167906, -1039.3394190914148, -33.42277164243082, -1025.5416610985574, -953.3112836025656, -1202.8637682793617, -941.6263505711117, -969.2892374903407, -1162.834216357094, -985.0868487358431, -540.0780435486508, -1315.8868013546792, -973.9411040340432, -1044.537423211077, -975.9620311014575, -1026.8317769812666, -912.3640561894143, -1107.0417712953717, -788.5852927059668, -15.099349911251796, -1158.43004848389, -759.3403175900955, -884.3543980883601, -711.663509989529, -1075.133918441973, -1200.4670126456847, -390.3855724003099, -1120.301026010149, -1526.1998380201178, -589.4574376948399, -35.08651735037479, -863.1545907545615, -407.4530751046479, -886.7896431648568, -1171.843850388195, -950.1410002794777, -914.1529829403463, -498.6007586437806, -729.0320951336682, -906.7972677791571, -779.0893484452101, -1125.5814726015778, -836.3417544008305, -999.3931423028146, -558.3515911587766, -51.07302569092924, -961.2247938650274, -701.8657878545014, -1333.2904471412442, -63.17912069463242, -506.4711430001059, -859.1089438786934, -1393.557207232059, -292.5524299284859, -968.9942080717145, -685.8459757852382, -645.9026207308718, -237.888757704099, -226.76968097462264, -863.1391156043636, -1281.8390283007084, -1444.1846131949903, -992.9200207966576, -576.7068218399136, -328.99781079849225, -1078.5487864002234, -153.95505594693472, -1004.9090585908671, -131.6867125739209, -719.5706520738921, -352.9452291830894, -616.001977691883, -568.5438588703103, -237.93777109693275, -1355.3204070173454, -391.79121438216447, -1003.8601446569407, -669.0260460524605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5544401951854817, "mean_inference_ms": 1.6815410157002117, "mean_action_processing_ms": 0.27962330188483714, "mean_env_wait_ms": 3.0397261065277417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012336254119873047, "StateBufferConnector_ms": 0.007836341857910156, "ViewRequirementAgentConnector_ms": 0.19001126289367676}, "num_episodes": 35, "episode_return_max": -15.099349911251796, "episode_return_min": -1526.1998380201178, "episode_return_mean": -758.8631000465834, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.72573506884964, "num_env_steps_trained_throughput_per_sec": 307.72573506884964, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12611.943, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12611.876, "sample_time_ms": 1067.302, "learn_time_ms": 11479.312, "learn_throughput": 348.453, "synch_weights_time_ms": 64.505}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "92003_00016", "date": "2024-08-03_05-03-51", "timestamp": 1722641631, "time_this_iter_s": 13.01063060760498, "time_total_s": 171.1409034729004, "pid": 484683, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b1352b490>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 171.1409034729004, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 17.716666666666665, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 48.274406079451246, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.664875740309556, "policy_loss": -0.01562639885911873, "vf_loss": 6.674265417456627, "vf_explained_var": 0.8239988603318731, "kl": 0.021305457218780553, "entropy": 1.5492098737508058, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -15.099349911251796, "episode_reward_min": -1526.1998380201178, "episode_reward_mean": -776.3920402238646, "episode_len_mean": 139.15, "episode_media": {}, "episodes_timesteps_total": 13915, "policy_reward_min": {"policy_0": -1526.1998380201178}, "policy_reward_max": {"policy_0": -15.099349911251796}, "policy_reward_mean": {"policy_0": -776.3920402238646}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-941.6263505711117, -969.2892374903407, -1162.834216357094, -985.0868487358431, -540.0780435486508, -1315.8868013546792, -973.9411040340432, -1044.537423211077, -975.9620311014575, -1026.8317769812666, -912.3640561894143, -1107.0417712953717, -788.5852927059668, -15.099349911251796, -1158.43004848389, -759.3403175900955, -884.3543980883601, -711.663509989529, -1075.133918441973, -1200.4670126456847, -390.3855724003099, -1120.301026010149, -1526.1998380201178, -589.4574376948399, -35.08651735037479, -863.1545907545615, -407.4530751046479, -886.7896431648568, -1171.843850388195, -950.1410002794777, -914.1529829403463, -498.6007586437806, -729.0320951336682, -906.7972677791571, -779.0893484452101, -1125.5814726015778, -836.3417544008305, -999.3931423028146, -558.3515911587766, -51.07302569092924, -961.2247938650274, -701.8657878545014, -1333.2904471412442, -63.17912069463242, -506.4711430001059, -859.1089438786934, -1393.557207232059, -292.5524299284859, -968.9942080717145, -685.8459757852382, -645.9026207308718, -237.888757704099, -226.76968097462264, -863.1391156043636, -1281.8390283007084, -1444.1846131949903, -992.9200207966576, -576.7068218399136, -328.99781079849225, -1078.5487864002234, -153.95505594693472, -1004.9090585908671, -131.6867125739209, -719.5706520738921, -352.9452291830894, -616.001977691883, -568.5438588703103, -237.93777109693275, -1355.3204070173454, -391.79121438216447, -1003.8601446569407, -669.0260460524605, -817.0608538241387, -706.0798495555697, -142.67398537855348, -349.53995187879144, -708.1510301087472, -415.72813757930146, -1121.7102169201846, -329.84287090755345, -1076.12696945869, -301.7422139973343, -828.9552875211488, -527.212518628178, -1272.7144369905677, -747.7294738512029, -1171.0740715014938, -409.2743619122329, -766.1278941911488, -922.1247935096079, -183.57662955173953, -1344.1514276528706, -1153.9536920183918, -1308.728995535148, -744.25417245909, -1243.372661800394, -1018.5776290669668, -152.36245189620337, -960.2074635238337, -379.83504024226244], "episode_lengths": [150, 150, 150, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 54, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 57, 150, 150, 150, 49, 150, 150, 150, 150, 150, 150, 150, 76, 77, 150, 150, 150, 150, 132, 150, 150, 81, 150, 61, 150, 104, 150, 150, 79, 150, 145, 150, 150, 150, 150, 79, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 99, 150, 145], "policy_policy_0_reward": [-941.6263505711117, -969.2892374903407, -1162.834216357094, -985.0868487358431, -540.0780435486508, -1315.8868013546792, -973.9411040340432, -1044.537423211077, -975.9620311014575, -1026.8317769812666, -912.3640561894143, -1107.0417712953717, -788.5852927059668, -15.099349911251796, -1158.43004848389, -759.3403175900955, -884.3543980883601, -711.663509989529, -1075.133918441973, -1200.4670126456847, -390.3855724003099, -1120.301026010149, -1526.1998380201178, -589.4574376948399, -35.08651735037479, -863.1545907545615, -407.4530751046479, -886.7896431648568, -1171.843850388195, -950.1410002794777, -914.1529829403463, -498.6007586437806, -729.0320951336682, -906.7972677791571, -779.0893484452101, -1125.5814726015778, -836.3417544008305, -999.3931423028146, -558.3515911587766, -51.07302569092924, -961.2247938650274, -701.8657878545014, -1333.2904471412442, -63.17912069463242, -506.4711430001059, -859.1089438786934, -1393.557207232059, -292.5524299284859, -968.9942080717145, -685.8459757852382, -645.9026207308718, -237.888757704099, -226.76968097462264, -863.1391156043636, -1281.8390283007084, -1444.1846131949903, -992.9200207966576, -576.7068218399136, -328.99781079849225, -1078.5487864002234, -153.95505594693472, -1004.9090585908671, -131.6867125739209, -719.5706520738921, -352.9452291830894, -616.001977691883, -568.5438588703103, -237.93777109693275, -1355.3204070173454, -391.79121438216447, -1003.8601446569407, -669.0260460524605, -817.0608538241387, -706.0798495555697, -142.67398537855348, -349.53995187879144, -708.1510301087472, -415.72813757930146, -1121.7102169201846, -329.84287090755345, -1076.12696945869, -301.7422139973343, -828.9552875211488, -527.212518628178, -1272.7144369905677, -747.7294738512029, -1171.0740715014938, -409.2743619122329, -766.1278941911488, -922.1247935096079, -183.57662955173953, -1344.1514276528706, -1153.9536920183918, -1308.728995535148, -744.25417245909, -1243.372661800394, -1018.5776290669668, -152.36245189620337, -960.2074635238337, -379.83504024226244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5537459436182557, "mean_inference_ms": 1.680317094315493, "mean_action_processing_ms": 0.27927525236828876, "mean_env_wait_ms": 3.0448495526676957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012914419174194336, "StateBufferConnector_ms": 0.007911205291748047, "ViewRequirementAgentConnector_ms": 0.19924068450927734}, "num_episodes": 28, "episode_return_max": -15.099349911251796, "episode_return_min": -1526.1998380201178, "episode_return_mean": -776.3920402238646, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.64067305717515, "num_env_steps_trained_throughput_per_sec": 309.64067305717515, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12598.812, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12598.745, "sample_time_ms": 1072.296, "learn_time_ms": 11461.294, "learn_throughput": 349.001, "synch_weights_time_ms": 64.396}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "92003_00016", "date": "2024-08-03_05-04-03", "timestamp": 1722641643, "time_this_iter_s": 12.929671049118042, "time_total_s": 184.07057452201843, "pid": 484683, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b30fa3e20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 184.07057452201843, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 17.68947368421053, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 62.40248481631279, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.459436485668023, "policy_loss": -0.01351293060288299, "vf_loss": 6.46610538115104, "vf_explained_var": 0.8567935513332486, "kl": 0.015577476774099845, "entropy": 1.6582560284684102, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -51.07302569092924, "episode_reward_min": -1444.1846131949903, "episode_reward_mean": -737.9546829210034, "episode_len_mean": 139.18, "episode_media": {}, "episodes_timesteps_total": 13918, "policy_reward_min": {"policy_0": -1444.1846131949903}, "policy_reward_max": {"policy_0": -51.07302569092924}, "policy_reward_mean": {"policy_0": -737.9546829210034}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-886.7896431648568, -1171.843850388195, -950.1410002794777, -914.1529829403463, -498.6007586437806, -729.0320951336682, -906.7972677791571, -779.0893484452101, -1125.5814726015778, -836.3417544008305, -999.3931423028146, -558.3515911587766, -51.07302569092924, -961.2247938650274, -701.8657878545014, -1333.2904471412442, -63.17912069463242, -506.4711430001059, -859.1089438786934, -1393.557207232059, -292.5524299284859, -968.9942080717145, -685.8459757852382, -645.9026207308718, -237.888757704099, -226.76968097462264, -863.1391156043636, -1281.8390283007084, -1444.1846131949903, -992.9200207966576, -576.7068218399136, -328.99781079849225, -1078.5487864002234, -153.95505594693472, -1004.9090585908671, -131.6867125739209, -719.5706520738921, -352.9452291830894, -616.001977691883, -568.5438588703103, -237.93777109693275, -1355.3204070173454, -391.79121438216447, -1003.8601446569407, -669.0260460524605, -817.0608538241387, -706.0798495555697, -142.67398537855348, -349.53995187879144, -708.1510301087472, -415.72813757930146, -1121.7102169201846, -329.84287090755345, -1076.12696945869, -301.7422139973343, -828.9552875211488, -527.212518628178, -1272.7144369905677, -747.7294738512029, -1171.0740715014938, -409.2743619122329, -766.1278941911488, -922.1247935096079, -183.57662955173953, -1344.1514276528706, -1153.9536920183918, -1308.728995535148, -744.25417245909, -1243.372661800394, -1018.5776290669668, -152.36245189620337, -960.2074635238337, -379.83504024226244, -934.2455519989347, -432.12565889865783, -1044.3389871401596, -330.13628153494096, -231.7788593662017, -1036.5943152554048, -846.6971930955386, -1115.8543331055446, -703.4452103418383, -620.3235388491834, -992.6688297694305, -530.9240387420294, -624.8734274619669, -1059.7508567329762, -970.4126498278833, -599.6678865022459, -1077.5696965163954, -1281.3011374346736, -1113.7753012328187, -248.74264732487126, -533.7060109719946, -375.40334124928455, -1036.2433458507323, -583.206167824957, -330.7869881359872, -87.28496477482332, -894.9986158365236], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 57, 150, 150, 150, 49, 150, 150, 150, 150, 150, 150, 150, 76, 77, 150, 150, 150, 150, 132, 150, 150, 81, 150, 61, 150, 104, 150, 150, 79, 150, 145, 150, 150, 150, 150, 79, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 99, 150, 145, 150, 150, 150, 121, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 136, 150, 150, 108, 65, 150], "policy_policy_0_reward": [-886.7896431648568, -1171.843850388195, -950.1410002794777, -914.1529829403463, -498.6007586437806, -729.0320951336682, -906.7972677791571, -779.0893484452101, -1125.5814726015778, -836.3417544008305, -999.3931423028146, -558.3515911587766, -51.07302569092924, -961.2247938650274, -701.8657878545014, -1333.2904471412442, -63.17912069463242, -506.4711430001059, -859.1089438786934, -1393.557207232059, -292.5524299284859, -968.9942080717145, -685.8459757852382, -645.9026207308718, -237.888757704099, -226.76968097462264, -863.1391156043636, -1281.8390283007084, -1444.1846131949903, -992.9200207966576, -576.7068218399136, -328.99781079849225, -1078.5487864002234, -153.95505594693472, -1004.9090585908671, -131.6867125739209, -719.5706520738921, -352.9452291830894, -616.001977691883, -568.5438588703103, -237.93777109693275, -1355.3204070173454, -391.79121438216447, -1003.8601446569407, -669.0260460524605, -817.0608538241387, -706.0798495555697, -142.67398537855348, -349.53995187879144, -708.1510301087472, -415.72813757930146, -1121.7102169201846, -329.84287090755345, -1076.12696945869, -301.7422139973343, -828.9552875211488, -527.212518628178, -1272.7144369905677, -747.7294738512029, -1171.0740715014938, -409.2743619122329, -766.1278941911488, -922.1247935096079, -183.57662955173953, -1344.1514276528706, -1153.9536920183918, -1308.728995535148, -744.25417245909, -1243.372661800394, -1018.5776290669668, -152.36245189620337, -960.2074635238337, -379.83504024226244, -934.2455519989347, -432.12565889865783, -1044.3389871401596, -330.13628153494096, -231.7788593662017, -1036.5943152554048, -846.6971930955386, -1115.8543331055446, -703.4452103418383, -620.3235388491834, -992.6688297694305, -530.9240387420294, -624.8734274619669, -1059.7508567329762, -970.4126498278833, -599.6678865022459, -1077.5696965163954, -1281.3011374346736, -1113.7753012328187, -248.74264732487126, -533.7060109719946, -375.40334124928455, -1036.2433458507323, -583.206167824957, -330.7869881359872, -87.28496477482332, -894.9986158365236]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5532437606131768, "mean_inference_ms": 1.6796656139486341, "mean_action_processing_ms": 0.27900722849095305, "mean_env_wait_ms": 3.0499529217397368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012597322463989258, "StateBufferConnector_ms": 0.007858991622924805, "ViewRequirementAgentConnector_ms": 0.19965314865112305}, "num_episodes": 27, "episode_return_max": -51.07302569092924, "episode_return_min": -1444.1846131949903, "episode_return_mean": -737.9546829210034, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.0587622313807, "num_env_steps_trained_throughput_per_sec": 299.0587622313807, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12610.603, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12610.534, "sample_time_ms": 1070.813, "learn_time_ms": 11474.547, "learn_throughput": 348.598, "synch_weights_time_ms": 64.408}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "92003_00016", "date": "2024-08-03_05-04-17", "timestamp": 1722641657, "time_this_iter_s": 13.388446569442749, "time_total_s": 197.45902109146118, "pid": 484683, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b30fa2200>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 197.45902109146118, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 17.40526315789474, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 75.39164729217688, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.845251673956712, "policy_loss": -0.014595234069080714, "vf_loss": 5.852406586706638, "vf_explained_var": 0.9062632209310929, "kl": 0.01687021587961986, "entropy": 1.5126121651381255, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -24.59544672294223, "episode_reward_min": -1355.3204070173454, "episode_reward_mean": -684.4602004825113, "episode_len_mean": 137.26, "episode_media": {}, "episodes_timesteps_total": 13726, "policy_reward_min": {"policy_0": -1355.3204070173454}, "policy_reward_max": {"policy_0": -24.59544672294223}, "policy_reward_mean": {"policy_0": -684.4602004825113}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-576.7068218399136, -328.99781079849225, -1078.5487864002234, -153.95505594693472, -1004.9090585908671, -131.6867125739209, -719.5706520738921, -352.9452291830894, -616.001977691883, -568.5438588703103, -237.93777109693275, -1355.3204070173454, -391.79121438216447, -1003.8601446569407, -669.0260460524605, -817.0608538241387, -706.0798495555697, -142.67398537855348, -349.53995187879144, -708.1510301087472, -415.72813757930146, -1121.7102169201846, -329.84287090755345, -1076.12696945869, -301.7422139973343, -828.9552875211488, -527.212518628178, -1272.7144369905677, -747.7294738512029, -1171.0740715014938, -409.2743619122329, -766.1278941911488, -922.1247935096079, -183.57662955173953, -1344.1514276528706, -1153.9536920183918, -1308.728995535148, -744.25417245909, -1243.372661800394, -1018.5776290669668, -152.36245189620337, -960.2074635238337, -379.83504024226244, -934.2455519989347, -432.12565889865783, -1044.3389871401596, -330.13628153494096, -231.7788593662017, -1036.5943152554048, -846.6971930955386, -1115.8543331055446, -703.4452103418383, -620.3235388491834, -992.6688297694305, -530.9240387420294, -624.8734274619669, -1059.7508567329762, -970.4126498278833, -599.6678865022459, -1077.5696965163954, -1281.3011374346736, -1113.7753012328187, -248.74264732487126, -533.7060109719946, -375.40334124928455, -1036.2433458507323, -583.206167824957, -330.7869881359872, -87.28496477482332, -894.9986158365236, -1059.2179359311017, -656.6125434827823, -60.710147302159896, -914.4180537373167, -343.9693932703775, -981.5280188619106, -124.20536402002816, -604.1133841932742, -1172.4878764657985, -1157.3656343680143, -24.59544672294223, -665.9552193157826, -652.3912273043976, -245.98052969401016, -1004.7016393734664, -201.35228837297225, -705.7618002276979, -49.078018036336545, -348.2637590731327, -697.0796144527562, -963.3086180765026, -549.6191182523917, -862.661483517369, -711.4599346252974, -1232.0060428426516, -395.99265861393275, -989.845948980858, -435.5652080067467, -478.68385950111406, -227.54281721527175], "episode_lengths": [132, 150, 150, 81, 150, 61, 150, 104, 150, 150, 79, 150, 145, 150, 150, 150, 150, 79, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 99, 150, 145, 150, 150, 150, 121, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 136, 150, 150, 108, 65, 150, 150, 150, 64, 150, 124, 150, 62, 150, 150, 150, 54, 150, 150, 110, 150, 101, 150, 68, 150, 150, 150, 150, 150, 144, 150, 134, 150, 150, 150, 106], "policy_policy_0_reward": [-576.7068218399136, -328.99781079849225, -1078.5487864002234, -153.95505594693472, -1004.9090585908671, -131.6867125739209, -719.5706520738921, -352.9452291830894, -616.001977691883, -568.5438588703103, -237.93777109693275, -1355.3204070173454, -391.79121438216447, -1003.8601446569407, -669.0260460524605, -817.0608538241387, -706.0798495555697, -142.67398537855348, -349.53995187879144, -708.1510301087472, -415.72813757930146, -1121.7102169201846, -329.84287090755345, -1076.12696945869, -301.7422139973343, -828.9552875211488, -527.212518628178, -1272.7144369905677, -747.7294738512029, -1171.0740715014938, -409.2743619122329, -766.1278941911488, -922.1247935096079, -183.57662955173953, -1344.1514276528706, -1153.9536920183918, -1308.728995535148, -744.25417245909, -1243.372661800394, -1018.5776290669668, -152.36245189620337, -960.2074635238337, -379.83504024226244, -934.2455519989347, -432.12565889865783, -1044.3389871401596, -330.13628153494096, -231.7788593662017, -1036.5943152554048, -846.6971930955386, -1115.8543331055446, -703.4452103418383, -620.3235388491834, -992.6688297694305, -530.9240387420294, -624.8734274619669, -1059.7508567329762, -970.4126498278833, -599.6678865022459, -1077.5696965163954, -1281.3011374346736, -1113.7753012328187, -248.74264732487126, -533.7060109719946, -375.40334124928455, -1036.2433458507323, -583.206167824957, -330.7869881359872, -87.28496477482332, -894.9986158365236, -1059.2179359311017, -656.6125434827823, -60.710147302159896, -914.4180537373167, -343.9693932703775, -981.5280188619106, -124.20536402002816, -604.1133841932742, -1172.4878764657985, -1157.3656343680143, -24.59544672294223, -665.9552193157826, -652.3912273043976, -245.98052969401016, -1004.7016393734664, -201.35228837297225, -705.7618002276979, -49.078018036336545, -348.2637590731327, -697.0796144527562, -963.3086180765026, -549.6191182523917, -862.661483517369, -711.4599346252974, -1232.0060428426516, -395.99265861393275, -989.845948980858, -435.5652080067467, -478.68385950111406, -227.54281721527175]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5534855976144443, "mean_inference_ms": 1.68140497162287, "mean_action_processing_ms": 0.27904869966203505, "mean_env_wait_ms": 3.0565847010104066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012977361679077148, "StateBufferConnector_ms": 0.007922172546386719, "ViewRequirementAgentConnector_ms": 0.201432466506958}, "num_episodes": 30, "episode_return_max": -24.59544672294223, "episode_return_min": -1355.3204070173454, "episode_return_mean": -684.4602004825113, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.85996346924463, "num_env_steps_trained_throughput_per_sec": 304.85996346924463, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12599.868, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12599.798, "sample_time_ms": 1071.76, "learn_time_ms": 11461.379, "learn_throughput": 348.998, "synch_weights_time_ms": 65.878}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "92003_00016", "date": "2024-08-03_05-04-30", "timestamp": 1722641670, "time_this_iter_s": 13.132936954498291, "time_total_s": 210.59195804595947, "pid": 484683, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b13579120>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 210.59195804595947, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 18.27777777777778, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 60.868962145845096, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.589769805967808, "policy_loss": -0.019920642923292084, "vf_loss": 6.600979001820088, "vf_explained_var": 0.881281917107602, "kl": 0.019771532094879776, "entropy": 1.8574208619693915, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -24.59544672294223, "episode_reward_min": -1364.331623023147, "episode_reward_mean": -731.2457128479809, "episode_len_mean": 138.84, "episode_media": {}, "episodes_timesteps_total": 13884, "policy_reward_min": {"policy_0": -1364.331623023147}, "policy_reward_max": {"policy_0": -24.59544672294223}, "policy_reward_mean": {"policy_0": -731.2457128479809}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-527.212518628178, -1272.7144369905677, -747.7294738512029, -1171.0740715014938, -409.2743619122329, -766.1278941911488, -922.1247935096079, -183.57662955173953, -1344.1514276528706, -1153.9536920183918, -1308.728995535148, -744.25417245909, -1243.372661800394, -1018.5776290669668, -152.36245189620337, -960.2074635238337, -379.83504024226244, -934.2455519989347, -432.12565889865783, -1044.3389871401596, -330.13628153494096, -231.7788593662017, -1036.5943152554048, -846.6971930955386, -1115.8543331055446, -703.4452103418383, -620.3235388491834, -992.6688297694305, -530.9240387420294, -624.8734274619669, -1059.7508567329762, -970.4126498278833, -599.6678865022459, -1077.5696965163954, -1281.3011374346736, -1113.7753012328187, -248.74264732487126, -533.7060109719946, -375.40334124928455, -1036.2433458507323, -583.206167824957, -330.7869881359872, -87.28496477482332, -894.9986158365236, -1059.2179359311017, -656.6125434827823, -60.710147302159896, -914.4180537373167, -343.9693932703775, -981.5280188619106, -124.20536402002816, -604.1133841932742, -1172.4878764657985, -1157.3656343680143, -24.59544672294223, -665.9552193157826, -652.3912273043976, -245.98052969401016, -1004.7016393734664, -201.35228837297225, -705.7618002276979, -49.078018036336545, -348.2637590731327, -697.0796144527562, -963.3086180765026, -549.6191182523917, -862.661483517369, -711.4599346252974, -1232.0060428426516, -395.99265861393275, -989.845948980858, -435.5652080067467, -478.68385950111406, -227.54281721527175, -1060.9107785952378, -118.45179681065187, -871.9600575511867, -231.50221598896286, -625.8057090570913, -639.0430305122535, -389.8989227487094, -1178.3661798039232, -939.8957811940589, -1217.2918703454964, -1293.5689345756905, -883.8411071135582, -371.99201859364246, -652.4859464147497, -852.2092437599838, -1062.23184813721, -1209.2483690031343, -131.4491836607461, -1037.6769567887768, -1196.4287854424376, -1053.2634342900103, -1364.331623023147, -491.64552487351534, -640.3731422231035, -846.3775424199489, -305.7141479251251], "episode_lengths": [150, 150, 139, 150, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 99, 150, 145, 150, 150, 150, 121, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 136, 150, 150, 108, 65, 150, 150, 150, 64, 150, 124, 150, 62, 150, 150, 150, 54, 150, 150, 110, 150, 101, 150, 68, 150, 150, 150, 150, 150, 144, 150, 134, 150, 150, 150, 106, 150, 80, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 150, 94], "policy_policy_0_reward": [-527.212518628178, -1272.7144369905677, -747.7294738512029, -1171.0740715014938, -409.2743619122329, -766.1278941911488, -922.1247935096079, -183.57662955173953, -1344.1514276528706, -1153.9536920183918, -1308.728995535148, -744.25417245909, -1243.372661800394, -1018.5776290669668, -152.36245189620337, -960.2074635238337, -379.83504024226244, -934.2455519989347, -432.12565889865783, -1044.3389871401596, -330.13628153494096, -231.7788593662017, -1036.5943152554048, -846.6971930955386, -1115.8543331055446, -703.4452103418383, -620.3235388491834, -992.6688297694305, -530.9240387420294, -624.8734274619669, -1059.7508567329762, -970.4126498278833, -599.6678865022459, -1077.5696965163954, -1281.3011374346736, -1113.7753012328187, -248.74264732487126, -533.7060109719946, -375.40334124928455, -1036.2433458507323, -583.206167824957, -330.7869881359872, -87.28496477482332, -894.9986158365236, -1059.2179359311017, -656.6125434827823, -60.710147302159896, -914.4180537373167, -343.9693932703775, -981.5280188619106, -124.20536402002816, -604.1133841932742, -1172.4878764657985, -1157.3656343680143, -24.59544672294223, -665.9552193157826, -652.3912273043976, -245.98052969401016, -1004.7016393734664, -201.35228837297225, -705.7618002276979, -49.078018036336545, -348.2637590731327, -697.0796144527562, -963.3086180765026, -549.6191182523917, -862.661483517369, -711.4599346252974, -1232.0060428426516, -395.99265861393275, -989.845948980858, -435.5652080067467, -478.68385950111406, -227.54281721527175, -1060.9107785952378, -118.45179681065187, -871.9600575511867, -231.50221598896286, -625.8057090570913, -639.0430305122535, -389.8989227487094, -1178.3661798039232, -939.8957811940589, -1217.2918703454964, -1293.5689345756905, -883.8411071135582, -371.99201859364246, -652.4859464147497, -852.2092437599838, -1062.23184813721, -1209.2483690031343, -131.4491836607461, -1037.6769567887768, -1196.4287854424376, -1053.2634342900103, -1364.331623023147, -491.64552487351534, -640.3731422231035, -846.3775424199489, -305.7141479251251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5530209421625337, "mean_inference_ms": 1.6801717177165103, "mean_action_processing_ms": 0.2787363157235645, "mean_env_wait_ms": 3.059647454201248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012742996215820312, "StateBufferConnector_ms": 0.007860898971557617, "ViewRequirementAgentConnector_ms": 0.20014595985412598}, "num_episodes": 26, "episode_return_max": -24.59544672294223, "episode_return_min": -1364.331623023147, "episode_return_mean": -731.2457128479809, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.34219949076004, "num_env_steps_trained_throughput_per_sec": 315.34219949076004, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12570.802, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12570.732, "sample_time_ms": 1073.934, "learn_time_ms": 11430.375, "learn_throughput": 349.945, "synch_weights_time_ms": 65.643}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "92003_00016", "date": "2024-08-03_05-04-43", "timestamp": 1722641683, "time_this_iter_s": 12.69815444946289, "time_total_s": 223.29011249542236, "pid": 484683, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b13579870>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 223.29011249542236, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 18.01111111111111, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 80.24074624478817, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.733115803450346, "policy_loss": -0.008784189878497273, "vf_loss": 5.735185301800569, "vf_explained_var": 0.873384004769226, "kl": 0.015290790095241391, "entropy": 1.6615699568142495, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -24.59544672294223, "episode_reward_min": -1404.652958833799, "episode_reward_mean": -729.4155291284967, "episode_len_mean": 137.33, "episode_media": {}, "episodes_timesteps_total": 13733, "policy_reward_min": {"policy_0": -1404.652958833799}, "policy_reward_max": {"policy_0": -24.59544672294223}, "policy_reward_mean": {"policy_0": -729.4155291284967}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1059.7508567329762, -970.4126498278833, -599.6678865022459, -1077.5696965163954, -1281.3011374346736, -1113.7753012328187, -248.74264732487126, -533.7060109719946, -375.40334124928455, -1036.2433458507323, -583.206167824957, -330.7869881359872, -87.28496477482332, -894.9986158365236, -1059.2179359311017, -656.6125434827823, -60.710147302159896, -914.4180537373167, -343.9693932703775, -981.5280188619106, -124.20536402002816, -604.1133841932742, -1172.4878764657985, -1157.3656343680143, -24.59544672294223, -665.9552193157826, -652.3912273043976, -245.98052969401016, -1004.7016393734664, -201.35228837297225, -705.7618002276979, -49.078018036336545, -348.2637590731327, -697.0796144527562, -963.3086180765026, -549.6191182523917, -862.661483517369, -711.4599346252974, -1232.0060428426516, -395.99265861393275, -989.845948980858, -435.5652080067467, -478.68385950111406, -227.54281721527175, -1060.9107785952378, -118.45179681065187, -871.9600575511867, -231.50221598896286, -625.8057090570913, -639.0430305122535, -389.8989227487094, -1178.3661798039232, -939.8957811940589, -1217.2918703454964, -1293.5689345756905, -883.8411071135582, -371.99201859364246, -652.4859464147497, -852.2092437599838, -1062.23184813721, -1209.2483690031343, -131.4491836607461, -1037.6769567887768, -1196.4287854424376, -1053.2634342900103, -1364.331623023147, -491.64552487351534, -640.3731422231035, -846.3775424199489, -305.7141479251251, -111.15647256326697, -385.71789602032044, -1274.7842004711822, -363.4739057388002, -84.79926143069164, -888.3847817992151, -206.67751308995267, -258.3323863502438, -849.3446346023808, -1305.3122904035176, -899.408645052859, -1137.5404591423628, -1104.6709876813145, -825.2223396347362, -1275.4337998301703, -988.5123481016847, -448.8068117112939, -839.5585597179813, -527.2042434660814, -600.9542854394108, -544.3796478888311, -1404.652958833799, -280.3331289038059, -671.421378495505, -811.7553906378722, -1399.2545315689797, -924.8380507794678, -1148.037607121522, -903.4037884051298, -1102.893263060374], "episode_lengths": [150, 150, 150, 150, 150, 150, 113, 150, 136, 150, 150, 108, 65, 150, 150, 150, 64, 150, 124, 150, 62, 150, 150, 150, 54, 150, 150, 110, 150, 101, 150, 68, 150, 150, 150, 150, 150, 144, 150, 134, 150, 150, 150, 106, 150, 80, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 150, 94, 68, 150, 150, 107, 51, 150, 138, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1059.7508567329762, -970.4126498278833, -599.6678865022459, -1077.5696965163954, -1281.3011374346736, -1113.7753012328187, -248.74264732487126, -533.7060109719946, -375.40334124928455, -1036.2433458507323, -583.206167824957, -330.7869881359872, -87.28496477482332, -894.9986158365236, -1059.2179359311017, -656.6125434827823, -60.710147302159896, -914.4180537373167, -343.9693932703775, -981.5280188619106, -124.20536402002816, -604.1133841932742, -1172.4878764657985, -1157.3656343680143, -24.59544672294223, -665.9552193157826, -652.3912273043976, -245.98052969401016, -1004.7016393734664, -201.35228837297225, -705.7618002276979, -49.078018036336545, -348.2637590731327, -697.0796144527562, -963.3086180765026, -549.6191182523917, -862.661483517369, -711.4599346252974, -1232.0060428426516, -395.99265861393275, -989.845948980858, -435.5652080067467, -478.68385950111406, -227.54281721527175, -1060.9107785952378, -118.45179681065187, -871.9600575511867, -231.50221598896286, -625.8057090570913, -639.0430305122535, -389.8989227487094, -1178.3661798039232, -939.8957811940589, -1217.2918703454964, -1293.5689345756905, -883.8411071135582, -371.99201859364246, -652.4859464147497, -852.2092437599838, -1062.23184813721, -1209.2483690031343, -131.4491836607461, -1037.6769567887768, -1196.4287854424376, -1053.2634342900103, -1364.331623023147, -491.64552487351534, -640.3731422231035, -846.3775424199489, -305.7141479251251, -111.15647256326697, -385.71789602032044, -1274.7842004711822, -363.4739057388002, -84.79926143069164, -888.3847817992151, -206.67751308995267, -258.3323863502438, -849.3446346023808, -1305.3122904035176, -899.408645052859, -1137.5404591423628, -1104.6709876813145, -825.2223396347362, -1275.4337998301703, -988.5123481016847, -448.8068117112939, -839.5585597179813, -527.2042434660814, -600.9542854394108, -544.3796478888311, -1404.652958833799, -280.3331289038059, -671.421378495505, -811.7553906378722, -1399.2545315689797, -924.8380507794678, -1148.037607121522, -903.4037884051298, -1102.893263060374]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5528812891210418, "mean_inference_ms": 1.680208725203679, "mean_action_processing_ms": 0.27856817510268433, "mean_env_wait_ms": 3.065233380906069, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012506961822509766, "StateBufferConnector_ms": 0.007931232452392578, "ViewRequirementAgentConnector_ms": 0.19383764266967773}, "num_episodes": 30, "episode_return_max": -24.59544672294223, "episode_return_min": -1404.652958833799, "episode_return_mean": -729.4155291284967, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.2636551632535, "num_env_steps_trained_throughput_per_sec": 304.2636551632535, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12568.464, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12568.391, "sample_time_ms": 1081.111, "learn_time_ms": 11421.338, "learn_throughput": 350.222, "synch_weights_time_ms": 65.162}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "92003_00016", "date": "2024-08-03_05-04-56", "timestamp": 1722641696, "time_this_iter_s": 13.159266710281372, "time_total_s": 236.44937920570374, "pid": 484683, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b30fa3400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 236.44937920570374, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 17.657894736842106, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 91.03932974338531, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.66128436550498, "policy_loss": -0.012731420532994283, "vf_loss": 5.66796876663963, "vf_explained_var": 0.9198313759018978, "kl": 0.013787653776375938, "entropy": 1.5743871529897053, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -41.054189555975945, "episode_reward_min": -1404.652958833799, "episode_reward_mean": -719.5921957257326, "episode_len_mean": 137.61, "episode_media": {}, "episodes_timesteps_total": 13761, "policy_reward_min": {"policy_0": -1404.652958833799}, "policy_reward_max": {"policy_0": -41.054189555975945}, "policy_reward_mean": {"policy_0": -719.5921957257326}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-49.078018036336545, -348.2637590731327, -697.0796144527562, -963.3086180765026, -549.6191182523917, -862.661483517369, -711.4599346252974, -1232.0060428426516, -395.99265861393275, -989.845948980858, -435.5652080067467, -478.68385950111406, -227.54281721527175, -1060.9107785952378, -118.45179681065187, -871.9600575511867, -231.50221598896286, -625.8057090570913, -639.0430305122535, -389.8989227487094, -1178.3661798039232, -939.8957811940589, -1217.2918703454964, -1293.5689345756905, -883.8411071135582, -371.99201859364246, -652.4859464147497, -852.2092437599838, -1062.23184813721, -1209.2483690031343, -131.4491836607461, -1037.6769567887768, -1196.4287854424376, -1053.2634342900103, -1364.331623023147, -491.64552487351534, -640.3731422231035, -846.3775424199489, -305.7141479251251, -111.15647256326697, -385.71789602032044, -1274.7842004711822, -363.4739057388002, -84.79926143069164, -888.3847817992151, -206.67751308995267, -258.3323863502438, -849.3446346023808, -1305.3122904035176, -899.408645052859, -1137.5404591423628, -1104.6709876813145, -825.2223396347362, -1275.4337998301703, -988.5123481016847, -448.8068117112939, -839.5585597179813, -527.2042434660814, -600.9542854394108, -544.3796478888311, -1404.652958833799, -280.3331289038059, -671.421378495505, -811.7553906378722, -1399.2545315689797, -924.8380507794678, -1148.037607121522, -903.4037884051298, -1102.893263060374, -1045.4450102594888, -240.36166003166323, -458.04926458309745, -41.054189555975945, -59.73619311239371, -1060.3599936428939, -1149.2959981752153, -1139.2677413541553, -406.3101341046328, -138.8369886079892, -664.9129153886323, -982.7170703664178, -1358.9753767478078, -1214.7800603812848, -961.7711785593862, -1048.0859240192042, -863.2662469464763, -354.0103871687785, -655.5056157590785, -417.22922171111645, -608.5203305259637, -629.4153982139188, -482.90488915030204, -160.80251348370209, -737.3422620963805, -350.94109860714286, -587.7994095125282, -382.19516395637675, -115.61429416575648, -1083.5602214842288, -386.81602091180997], "episode_lengths": [68, 150, 150, 150, 150, 150, 144, 150, 134, 150, 150, 150, 106, 150, 80, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 150, 94, 68, 150, 150, 107, 51, 150, 138, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 59, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150, 150, 150, 122, 150, 122, 150, 150, 150, 71, 150, 93, 150, 150, 78, 150, 150], "policy_policy_0_reward": [-49.078018036336545, -348.2637590731327, -697.0796144527562, -963.3086180765026, -549.6191182523917, -862.661483517369, -711.4599346252974, -1232.0060428426516, -395.99265861393275, -989.845948980858, -435.5652080067467, -478.68385950111406, -227.54281721527175, -1060.9107785952378, -118.45179681065187, -871.9600575511867, -231.50221598896286, -625.8057090570913, -639.0430305122535, -389.8989227487094, -1178.3661798039232, -939.8957811940589, -1217.2918703454964, -1293.5689345756905, -883.8411071135582, -371.99201859364246, -652.4859464147497, -852.2092437599838, -1062.23184813721, -1209.2483690031343, -131.4491836607461, -1037.6769567887768, -1196.4287854424376, -1053.2634342900103, -1364.331623023147, -491.64552487351534, -640.3731422231035, -846.3775424199489, -305.7141479251251, -111.15647256326697, -385.71789602032044, -1274.7842004711822, -363.4739057388002, -84.79926143069164, -888.3847817992151, -206.67751308995267, -258.3323863502438, -849.3446346023808, -1305.3122904035176, -899.408645052859, -1137.5404591423628, -1104.6709876813145, -825.2223396347362, -1275.4337998301703, -988.5123481016847, -448.8068117112939, -839.5585597179813, -527.2042434660814, -600.9542854394108, -544.3796478888311, -1404.652958833799, -280.3331289038059, -671.421378495505, -811.7553906378722, -1399.2545315689797, -924.8380507794678, -1148.037607121522, -903.4037884051298, -1102.893263060374, -1045.4450102594888, -240.36166003166323, -458.04926458309745, -41.054189555975945, -59.73619311239371, -1060.3599936428939, -1149.2959981752153, -1139.2677413541553, -406.3101341046328, -138.8369886079892, -664.9129153886323, -982.7170703664178, -1358.9753767478078, -1214.7800603812848, -961.7711785593862, -1048.0859240192042, -863.2662469464763, -354.0103871687785, -655.5056157590785, -417.22922171111645, -608.5203305259637, -629.4153982139188, -482.90488915030204, -160.80251348370209, -737.3422620963805, -350.94109860714286, -587.7994095125282, -382.19516395637675, -115.61429416575648, -1083.5602214842288, -386.81602091180997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5523351977927752, "mean_inference_ms": 1.6794047287296061, "mean_action_processing_ms": 0.27824809318326493, "mean_env_wait_ms": 3.0655477213385636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01244974136352539, "StateBufferConnector_ms": 0.008037805557250977, "ViewRequirementAgentConnector_ms": 0.1942901611328125}, "num_episodes": 31, "episode_return_max": -41.054189555975945, "episode_return_min": -1404.652958833799, "episode_return_mean": -719.5921957257326, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 432.9651950736385, "num_env_steps_trained_throughput_per_sec": 432.9651950736385, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12202.88, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12202.805, "sample_time_ms": 1071.294, "learn_time_ms": 11066.323, "learn_throughput": 361.457, "synch_weights_time_ms": 64.406}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "92003_00016", "date": "2024-08-03_05-05-05", "timestamp": 1722641705, "time_this_iter_s": 9.251537799835205, "time_total_s": 245.70091700553894, "pid": 484683, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b30fa2950>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 245.70091700553894, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 20.815384615384616, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 107.0070838769277, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.274215055753787, "policy_loss": -0.007673390004977894, "vf_loss": 5.276629523684581, "vf_explained_var": 0.8885460161914428, "kl": 0.012040392557779974, "entropy": 1.5923770774155854, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -41.054189555975945, "episode_reward_min": -1404.652958833799, "episode_reward_mean": -730.211100798447, "episode_len_mean": 137.85, "episode_media": {}, "episodes_timesteps_total": 13785, "policy_reward_min": {"policy_0": -1404.652958833799}, "policy_reward_max": {"policy_0": -41.054189555975945}, "policy_reward_mean": {"policy_0": -730.211100798447}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-852.2092437599838, -1062.23184813721, -1209.2483690031343, -131.4491836607461, -1037.6769567887768, -1196.4287854424376, -1053.2634342900103, -1364.331623023147, -491.64552487351534, -640.3731422231035, -846.3775424199489, -305.7141479251251, -111.15647256326697, -385.71789602032044, -1274.7842004711822, -363.4739057388002, -84.79926143069164, -888.3847817992151, -206.67751308995267, -258.3323863502438, -849.3446346023808, -1305.3122904035176, -899.408645052859, -1137.5404591423628, -1104.6709876813145, -825.2223396347362, -1275.4337998301703, -988.5123481016847, -448.8068117112939, -839.5585597179813, -527.2042434660814, -600.9542854394108, -544.3796478888311, -1404.652958833799, -280.3331289038059, -671.421378495505, -811.7553906378722, -1399.2545315689797, -924.8380507794678, -1148.037607121522, -903.4037884051298, -1102.893263060374, -1045.4450102594888, -240.36166003166323, -458.04926458309745, -41.054189555975945, -59.73619311239371, -1060.3599936428939, -1149.2959981752153, -1139.2677413541553, -406.3101341046328, -138.8369886079892, -664.9129153886323, -982.7170703664178, -1358.9753767478078, -1214.7800603812848, -961.7711785593862, -1048.0859240192042, -863.2662469464763, -354.0103871687785, -655.5056157590785, -417.22922171111645, -608.5203305259637, -629.4153982139188, -482.90488915030204, -160.80251348370209, -737.3422620963805, -350.94109860714286, -587.7994095125282, -382.19516395637675, -115.61429416575648, -1083.5602214842288, -386.81602091180997, -327.86046394739196, -558.2979112408277, -1143.3156265262585, -849.5689896752237, -1333.4116138845764, -944.6135572984995, -184.92428291555825, -1033.993887393474, -729.132085433042, -1015.4416126285822, -715.4322191745684, -685.6921692054848, -686.2837931485502, -408.8384484202988, -631.5077431013225, -103.06879773511594, -577.5042309767749, -502.01011341121034, -649.4873219190914, -1146.491082033274, -791.0311726216695, -495.5974467200726, -1345.0407415036136, -357.9451146451144, -739.497198125272, -422.72667509311776, -1099.2976389930318], "episode_lengths": [150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 150, 94, 68, 150, 150, 107, 51, 150, 138, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 59, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150, 150, 150, 122, 150, 122, 150, 150, 150, 71, 150, 93, 150, 150, 78, 150, 150, 150, 125, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 75, 150, 143, 150, 150, 150, 113, 150, 150, 150, 112, 150], "policy_policy_0_reward": [-852.2092437599838, -1062.23184813721, -1209.2483690031343, -131.4491836607461, -1037.6769567887768, -1196.4287854424376, -1053.2634342900103, -1364.331623023147, -491.64552487351534, -640.3731422231035, -846.3775424199489, -305.7141479251251, -111.15647256326697, -385.71789602032044, -1274.7842004711822, -363.4739057388002, -84.79926143069164, -888.3847817992151, -206.67751308995267, -258.3323863502438, -849.3446346023808, -1305.3122904035176, -899.408645052859, -1137.5404591423628, -1104.6709876813145, -825.2223396347362, -1275.4337998301703, -988.5123481016847, -448.8068117112939, -839.5585597179813, -527.2042434660814, -600.9542854394108, -544.3796478888311, -1404.652958833799, -280.3331289038059, -671.421378495505, -811.7553906378722, -1399.2545315689797, -924.8380507794678, -1148.037607121522, -903.4037884051298, -1102.893263060374, -1045.4450102594888, -240.36166003166323, -458.04926458309745, -41.054189555975945, -59.73619311239371, -1060.3599936428939, -1149.2959981752153, -1139.2677413541553, -406.3101341046328, -138.8369886079892, -664.9129153886323, -982.7170703664178, -1358.9753767478078, -1214.7800603812848, -961.7711785593862, -1048.0859240192042, -863.2662469464763, -354.0103871687785, -655.5056157590785, -417.22922171111645, -608.5203305259637, -629.4153982139188, -482.90488915030204, -160.80251348370209, -737.3422620963805, -350.94109860714286, -587.7994095125282, -382.19516395637675, -115.61429416575648, -1083.5602214842288, -386.81602091180997, -327.86046394739196, -558.2979112408277, -1143.3156265262585, -849.5689896752237, -1333.4116138845764, -944.6135572984995, -184.92428291555825, -1033.993887393474, -729.132085433042, -1015.4416126285822, -715.4322191745684, -685.6921692054848, -686.2837931485502, -408.8384484202988, -631.5077431013225, -103.06879773511594, -577.5042309767749, -502.01011341121034, -649.4873219190914, -1146.491082033274, -791.0311726216695, -495.5974467200726, -1345.0407415036136, -357.9451146451144, -739.497198125272, -422.72667509311776, -1099.2976389930318]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5520156941809323, "mean_inference_ms": 1.6782227243344539, "mean_action_processing_ms": 0.2780344061545991, "mean_env_wait_ms": 3.0702002687954693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012107133865356445, "StateBufferConnector_ms": 0.008127212524414062, "ViewRequirementAgentConnector_ms": 0.19526195526123047}, "num_episodes": 27, "episode_return_max": -41.054189555975945, "episode_return_min": -1404.652958833799, "episode_return_mean": -730.211100798447, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.5176954074828, "num_env_steps_trained_throughput_per_sec": 318.5176954074828, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12412.862, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12412.787, "sample_time_ms": 1068.973, "learn_time_ms": 11278.241, "learn_throughput": 354.665, "synch_weights_time_ms": 64.783}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "92003_00016", "date": "2024-08-03_05-05-18", "timestamp": 1722641718, "time_this_iter_s": 12.570518493652344, "time_total_s": 258.2714354991913, "pid": 484683, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b30fa16c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 258.2714354991913, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 17.883333333333333, "ram_util_percent": 27.93333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 126.90302155216536, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.8380698596437774, "policy_loss": -0.0060793112982840585, "vf_loss": 4.838623253504435, "vf_explained_var": 0.944741895608604, "kl": 0.012619048011189685, "entropy": 1.5265716701745986, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -41.054189555975945, "episode_reward_min": -1473.8020755005796, "episode_reward_mean": -716.4725729743035, "episode_len_mean": 136.06, "episode_media": {}, "episodes_timesteps_total": 13606, "policy_reward_min": {"policy_0": -1473.8020755005796}, "policy_reward_max": {"policy_0": -41.054189555975945}, "policy_reward_mean": {"policy_0": -716.4725729743035}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-544.3796478888311, -1404.652958833799, -280.3331289038059, -671.421378495505, -811.7553906378722, -1399.2545315689797, -924.8380507794678, -1148.037607121522, -903.4037884051298, -1102.893263060374, -1045.4450102594888, -240.36166003166323, -458.04926458309745, -41.054189555975945, -59.73619311239371, -1060.3599936428939, -1149.2959981752153, -1139.2677413541553, -406.3101341046328, -138.8369886079892, -664.9129153886323, -982.7170703664178, -1358.9753767478078, -1214.7800603812848, -961.7711785593862, -1048.0859240192042, -863.2662469464763, -354.0103871687785, -655.5056157590785, -417.22922171111645, -608.5203305259637, -629.4153982139188, -482.90488915030204, -160.80251348370209, -737.3422620963805, -350.94109860714286, -587.7994095125282, -382.19516395637675, -115.61429416575648, -1083.5602214842288, -386.81602091180997, -327.86046394739196, -558.2979112408277, -1143.3156265262585, -849.5689896752237, -1333.4116138845764, -944.6135572984995, -184.92428291555825, -1033.993887393474, -729.132085433042, -1015.4416126285822, -715.4322191745684, -685.6921692054848, -686.2837931485502, -408.8384484202988, -631.5077431013225, -103.06879773511594, -577.5042309767749, -502.01011341121034, -649.4873219190914, -1146.491082033274, -791.0311726216695, -495.5974467200726, -1345.0407415036136, -357.9451146451144, -739.497198125272, -422.72667509311776, -1099.2976389930318, -672.6620035777698, -189.70847981647444, -1366.59631547115, -211.28504424311797, -368.9016061941561, -682.0665278203561, -756.0993608897026, -1115.5992920082274, -398.68341411977724, -1040.596240998066, -1245.7409638587992, -1197.7347228115407, -126.67689765002875, -843.2057366284994, -525.8467626208769, -361.8886207727178, -718.1036570313635, -938.974325030318, -1392.3288313463208, -1320.9290391890386, -1473.8020755005796, -1044.345144068465, -71.92961000752807, -713.3697478656146, -130.32032615273363, -83.26805656461976, -733.6160720003436, -136.91643550808612, -969.2317270632069, -1131.2135515342732, -573.8016820468011, -656.950570989691], "episode_lengths": [150, 150, 125, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 59, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150, 150, 150, 122, 150, 122, 150, 150, 150, 71, 150, 93, 150, 150, 78, 150, 150, 150, 125, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 75, 150, 143, 150, 150, 150, 113, 150, 150, 150, 112, 150, 150, 69, 150, 68, 150, 150, 150, 150, 98, 150, 150, 150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 150, 57, 150, 56, 97, 150, 91, 150, 150, 150, 150], "policy_policy_0_reward": [-544.3796478888311, -1404.652958833799, -280.3331289038059, -671.421378495505, -811.7553906378722, -1399.2545315689797, -924.8380507794678, -1148.037607121522, -903.4037884051298, -1102.893263060374, -1045.4450102594888, -240.36166003166323, -458.04926458309745, -41.054189555975945, -59.73619311239371, -1060.3599936428939, -1149.2959981752153, -1139.2677413541553, -406.3101341046328, -138.8369886079892, -664.9129153886323, -982.7170703664178, -1358.9753767478078, -1214.7800603812848, -961.7711785593862, -1048.0859240192042, -863.2662469464763, -354.0103871687785, -655.5056157590785, -417.22922171111645, -608.5203305259637, -629.4153982139188, -482.90488915030204, -160.80251348370209, -737.3422620963805, -350.94109860714286, -587.7994095125282, -382.19516395637675, -115.61429416575648, -1083.5602214842288, -386.81602091180997, -327.86046394739196, -558.2979112408277, -1143.3156265262585, -849.5689896752237, -1333.4116138845764, -944.6135572984995, -184.92428291555825, -1033.993887393474, -729.132085433042, -1015.4416126285822, -715.4322191745684, -685.6921692054848, -686.2837931485502, -408.8384484202988, -631.5077431013225, -103.06879773511594, -577.5042309767749, -502.01011341121034, -649.4873219190914, -1146.491082033274, -791.0311726216695, -495.5974467200726, -1345.0407415036136, -357.9451146451144, -739.497198125272, -422.72667509311776, -1099.2976389930318, -672.6620035777698, -189.70847981647444, -1366.59631547115, -211.28504424311797, -368.9016061941561, -682.0665278203561, -756.0993608897026, -1115.5992920082274, -398.68341411977724, -1040.596240998066, -1245.7409638587992, -1197.7347228115407, -126.67689765002875, -843.2057366284994, -525.8467626208769, -361.8886207727178, -718.1036570313635, -938.974325030318, -1392.3288313463208, -1320.9290391890386, -1473.8020755005796, -1044.345144068465, -71.92961000752807, -713.3697478656146, -130.32032615273363, -83.26805656461976, -733.6160720003436, -136.91643550808612, -969.2317270632069, -1131.2135515342732, -573.8016820468011, -656.950570989691]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5526585349435218, "mean_inference_ms": 1.678685519425404, "mean_action_processing_ms": 0.2781875968595092, "mean_env_wait_ms": 3.072558720860843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011845588684082031, "StateBufferConnector_ms": 0.008001089096069336, "ViewRequirementAgentConnector_ms": 0.19335365295410156}, "num_episodes": 32, "episode_return_max": -41.054189555975945, "episode_return_min": -1473.8020755005796, "episode_return_mean": -716.4725729743035, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.04414946365586, "num_env_steps_trained_throughput_per_sec": 316.04414946365586, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12579.138, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12579.062, "sample_time_ms": 1076.622, "learn_time_ms": 11436.084, "learn_throughput": 349.77, "synch_weights_time_ms": 65.555}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "92003_00016", "date": "2024-08-03_05-05-31", "timestamp": 1722641731, "time_this_iter_s": 12.668025732040405, "time_total_s": 270.9394612312317, "pid": 484683, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b1352b130>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 270.9394612312317, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 17.844444444444445, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 110.41990280548731, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.989636759708325, "policy_loss": -0.017639758666822065, "vf_loss": 4.999130815267563, "vf_explained_var": 0.9503375581155221, "kl": 0.018472883079387763, "entropy": 1.6712091263383626, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -19.498940541089112, "episode_reward_min": -1473.8020755005796, "episode_reward_mean": -691.3095454852008, "episode_len_mean": 135.4, "episode_media": {}, "episodes_timesteps_total": 13540, "policy_reward_min": {"policy_0": -1473.8020755005796}, "policy_reward_max": {"policy_0": -19.498940541089112}, "policy_reward_mean": {"policy_0": -691.3095454852008}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-482.90488915030204, -160.80251348370209, -737.3422620963805, -350.94109860714286, -587.7994095125282, -382.19516395637675, -115.61429416575648, -1083.5602214842288, -386.81602091180997, -327.86046394739196, -558.2979112408277, -1143.3156265262585, -849.5689896752237, -1333.4116138845764, -944.6135572984995, -184.92428291555825, -1033.993887393474, -729.132085433042, -1015.4416126285822, -715.4322191745684, -685.6921692054848, -686.2837931485502, -408.8384484202988, -631.5077431013225, -103.06879773511594, -577.5042309767749, -502.01011341121034, -649.4873219190914, -1146.491082033274, -791.0311726216695, -495.5974467200726, -1345.0407415036136, -357.9451146451144, -739.497198125272, -422.72667509311776, -1099.2976389930318, -672.6620035777698, -189.70847981647444, -1366.59631547115, -211.28504424311797, -368.9016061941561, -682.0665278203561, -756.0993608897026, -1115.5992920082274, -398.68341411977724, -1040.596240998066, -1245.7409638587992, -1197.7347228115407, -126.67689765002875, -843.2057366284994, -525.8467626208769, -361.8886207727178, -718.1036570313635, -938.974325030318, -1392.3288313463208, -1320.9290391890386, -1473.8020755005796, -1044.345144068465, -71.92961000752807, -713.3697478656146, -130.32032615273363, -83.26805656461976, -733.6160720003436, -136.91643550808612, -969.2317270632069, -1131.2135515342732, -573.8016820468011, -656.950570989691, -1144.7327107000685, -707.2133262512463, -194.1361196189138, -1008.4217965793332, -932.5291135357234, -1265.5050663095979, -850.4854541154155, -577.7706825081962, -649.9872244553699, -658.66765045281, -739.6523765872234, -540.1735047613429, -609.6278239975474, -1112.4488984959016, -1370.3802547282012, -809.9580800489111, -909.3356999853944, -231.80086729446282, -536.972793395724, -1145.6294587537325, -167.46999575082594, -1193.4133620319305, -78.12269223330291, -306.7723856057447, -738.004772632797, -837.9555778839879, -949.6272241215098, -967.4266444075392, -323.9085991150423, -66.94227045908481, -528.0025286426418, -19.498940541089112], "episode_lengths": [150, 71, 150, 93, 150, 150, 78, 150, 150, 150, 125, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 75, 150, 143, 150, 150, 150, 113, 150, 150, 150, 112, 150, 150, 69, 150, 68, 150, 150, 150, 150, 98, 150, 150, 150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 150, 57, 150, 56, 97, 150, 91, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 107, 150, 74, 150, 144, 150, 150, 150, 136, 56, 150, 55], "policy_policy_0_reward": [-482.90488915030204, -160.80251348370209, -737.3422620963805, -350.94109860714286, -587.7994095125282, -382.19516395637675, -115.61429416575648, -1083.5602214842288, -386.81602091180997, -327.86046394739196, -558.2979112408277, -1143.3156265262585, -849.5689896752237, -1333.4116138845764, -944.6135572984995, -184.92428291555825, -1033.993887393474, -729.132085433042, -1015.4416126285822, -715.4322191745684, -685.6921692054848, -686.2837931485502, -408.8384484202988, -631.5077431013225, -103.06879773511594, -577.5042309767749, -502.01011341121034, -649.4873219190914, -1146.491082033274, -791.0311726216695, -495.5974467200726, -1345.0407415036136, -357.9451146451144, -739.497198125272, -422.72667509311776, -1099.2976389930318, -672.6620035777698, -189.70847981647444, -1366.59631547115, -211.28504424311797, -368.9016061941561, -682.0665278203561, -756.0993608897026, -1115.5992920082274, -398.68341411977724, -1040.596240998066, -1245.7409638587992, -1197.7347228115407, -126.67689765002875, -843.2057366284994, -525.8467626208769, -361.8886207727178, -718.1036570313635, -938.974325030318, -1392.3288313463208, -1320.9290391890386, -1473.8020755005796, -1044.345144068465, -71.92961000752807, -713.3697478656146, -130.32032615273363, -83.26805656461976, -733.6160720003436, -136.91643550808612, -969.2317270632069, -1131.2135515342732, -573.8016820468011, -656.950570989691, -1144.7327107000685, -707.2133262512463, -194.1361196189138, -1008.4217965793332, -932.5291135357234, -1265.5050663095979, -850.4854541154155, -577.7706825081962, -649.9872244553699, -658.66765045281, -739.6523765872234, -540.1735047613429, -609.6278239975474, -1112.4488984959016, -1370.3802547282012, -809.9580800489111, -909.3356999853944, -231.80086729446282, -536.972793395724, -1145.6294587537325, -167.46999575082594, -1193.4133620319305, -78.12269223330291, -306.7723856057447, -738.004772632797, -837.9555778839879, -949.6272241215098, -967.4266444075392, -323.9085991150423, -66.94227045908481, -528.0025286426418, -19.498940541089112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.552347422189582, "mean_inference_ms": 1.6784004690007268, "mean_action_processing_ms": 0.2778791295938588, "mean_env_wait_ms": 3.0747564322940737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011904716491699219, "StateBufferConnector_ms": 0.007960081100463867, "ViewRequirementAgentConnector_ms": 0.1909923553466797}, "num_episodes": 32, "episode_return_max": -19.498940541089112, "episode_return_min": -1473.8020755005796, "episode_return_mean": -691.3095454852008, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.0810479401986, "num_env_steps_trained_throughput_per_sec": 309.0810479401986, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12563.896, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12563.818, "sample_time_ms": 1077.968, "learn_time_ms": 11420.066, "learn_throughput": 350.261, "synch_weights_time_ms": 64.981}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "92003_00016", "date": "2024-08-03_05-05-44", "timestamp": 1722641744, "time_this_iter_s": 12.956423997879028, "time_total_s": 283.8958852291107, "pid": 484683, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b13578af0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 283.8958852291107, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 17.657894736842106, "ram_util_percent": 27.95263157894737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 127.79363685647647, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.930259579916795, "policy_loss": -0.008752328099217267, "vf_loss": 4.931645768880844, "vf_explained_var": 0.9557532646382848, "kl": 0.01671864884574464, "entropy": 1.572728274638454, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -13.82300136019714, "episode_reward_min": -1473.8020755005796, "episode_reward_mean": -707.7173934704432, "episode_len_mean": 133.81, "episode_media": {}, "episodes_timesteps_total": 13381, "policy_reward_min": {"policy_0": -1473.8020755005796}, "policy_reward_max": {"policy_0": -13.82300136019714}, "policy_reward_mean": {"policy_0": -707.7173934704432}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-791.0311726216695, -495.5974467200726, -1345.0407415036136, -357.9451146451144, -739.497198125272, -422.72667509311776, -1099.2976389930318, -672.6620035777698, -189.70847981647444, -1366.59631547115, -211.28504424311797, -368.9016061941561, -682.0665278203561, -756.0993608897026, -1115.5992920082274, -398.68341411977724, -1040.596240998066, -1245.7409638587992, -1197.7347228115407, -126.67689765002875, -843.2057366284994, -525.8467626208769, -361.8886207727178, -718.1036570313635, -938.974325030318, -1392.3288313463208, -1320.9290391890386, -1473.8020755005796, -1044.345144068465, -71.92961000752807, -713.3697478656146, -130.32032615273363, -83.26805656461976, -733.6160720003436, -136.91643550808612, -969.2317270632069, -1131.2135515342732, -573.8016820468011, -656.950570989691, -1144.7327107000685, -707.2133262512463, -194.1361196189138, -1008.4217965793332, -932.5291135357234, -1265.5050663095979, -850.4854541154155, -577.7706825081962, -649.9872244553699, -658.66765045281, -739.6523765872234, -540.1735047613429, -609.6278239975474, -1112.4488984959016, -1370.3802547282012, -809.9580800489111, -909.3356999853944, -231.80086729446282, -536.972793395724, -1145.6294587537325, -167.46999575082594, -1193.4133620319305, -78.12269223330291, -306.7723856057447, -738.004772632797, -837.9555778839879, -949.6272241215098, -967.4266444075392, -323.9085991150423, -66.94227045908481, -528.0025286426418, -19.498940541089112, -938.9733870533197, -436.5393169431562, -80.88157921997717, -908.8590429264, -488.8180039838228, -1234.9097857573217, -669.4739164093934, -73.73843900273425, -893.1572332434152, -1197.430514910233, -13.82300136019714, -210.00685279869265, -1243.910255827482, -687.5515258087518, -1056.996689103649, -714.3289326692556, -426.11004693431477, -959.2348388043988, -155.36368163463754, -944.1588098724997, -749.2690908574606, -756.8347874674404, -629.5498362091975, -41.26065397503432, -598.9683653564999, -718.7467795296703, -1050.283113964872, -1080.133957399228, -1196.3241829385117], "episode_lengths": [150, 113, 150, 150, 150, 112, 150, 150, 69, 150, 68, 150, 150, 150, 150, 98, 150, 150, 150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 150, 57, 150, 56, 97, 150, 91, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 107, 150, 74, 150, 144, 150, 150, 150, 136, 56, 150, 55, 150, 107, 78, 150, 150, 150, 150, 72, 150, 150, 41, 98, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 130, 43, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-791.0311726216695, -495.5974467200726, -1345.0407415036136, -357.9451146451144, -739.497198125272, -422.72667509311776, -1099.2976389930318, -672.6620035777698, -189.70847981647444, -1366.59631547115, -211.28504424311797, -368.9016061941561, -682.0665278203561, -756.0993608897026, -1115.5992920082274, -398.68341411977724, -1040.596240998066, -1245.7409638587992, -1197.7347228115407, -126.67689765002875, -843.2057366284994, -525.8467626208769, -361.8886207727178, -718.1036570313635, -938.974325030318, -1392.3288313463208, -1320.9290391890386, -1473.8020755005796, -1044.345144068465, -71.92961000752807, -713.3697478656146, -130.32032615273363, -83.26805656461976, -733.6160720003436, -136.91643550808612, -969.2317270632069, -1131.2135515342732, -573.8016820468011, -656.950570989691, -1144.7327107000685, -707.2133262512463, -194.1361196189138, -1008.4217965793332, -932.5291135357234, -1265.5050663095979, -850.4854541154155, -577.7706825081962, -649.9872244553699, -658.66765045281, -739.6523765872234, -540.1735047613429, -609.6278239975474, -1112.4488984959016, -1370.3802547282012, -809.9580800489111, -909.3356999853944, -231.80086729446282, -536.972793395724, -1145.6294587537325, -167.46999575082594, -1193.4133620319305, -78.12269223330291, -306.7723856057447, -738.004772632797, -837.9555778839879, -949.6272241215098, -967.4266444075392, -323.9085991150423, -66.94227045908481, -528.0025286426418, -19.498940541089112, -938.9733870533197, -436.5393169431562, -80.88157921997717, -908.8590429264, -488.8180039838228, -1234.9097857573217, -669.4739164093934, -73.73843900273425, -893.1572332434152, -1197.430514910233, -13.82300136019714, -210.00685279869265, -1243.910255827482, -687.5515258087518, -1056.996689103649, -714.3289326692556, -426.11004693431477, -959.2348388043988, -155.36368163463754, -944.1588098724997, -749.2690908574606, -756.8347874674404, -629.5498362091975, -41.26065397503432, -598.9683653564999, -718.7467795296703, -1050.283113964872, -1080.133957399228, -1196.3241829385117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5527131414886564, "mean_inference_ms": 1.6782010235950207, "mean_action_processing_ms": 0.27779827131242524, "mean_env_wait_ms": 3.074309587149746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01888275146484375, "StateBufferConnector_ms": 0.008390188217163086, "ViewRequirementAgentConnector_ms": 0.19270801544189453}, "num_episodes": 29, "episode_return_max": -13.82300136019714, "episode_return_min": -1473.8020755005796, "episode_return_mean": -707.7173934704432, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 334.9744681342993, "num_env_steps_trained_throughput_per_sec": 334.9744681342993, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12458.158, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12458.08, "sample_time_ms": 1075.781, "learn_time_ms": 11316.19, "learn_throughput": 353.476, "synch_weights_time_ms": 65.304}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "92003_00016", "date": "2024-08-03_05-05-56", "timestamp": 1722641756, "time_this_iter_s": 11.953829050064087, "time_total_s": 295.8497142791748, "pid": 484683, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b30fa16c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 295.8497142791748, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 18.323529411764707, "ram_util_percent": 27.988235294117644}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 148.94847770631313, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.98161550189058, "policy_loss": -0.012020029844522166, "vf_loss": 3.987212668855985, "vf_explained_var": 0.9622424164786935, "kl": 0.01464003405647721, "entropy": 1.6513923009236653, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -13.82300136019714, "episode_reward_min": -1473.8020755005796, "episode_reward_mean": -730.3358968222145, "episode_len_mean": 136.24, "episode_media": {}, "episodes_timesteps_total": 13624, "policy_reward_min": {"policy_0": -1473.8020755005796}, "policy_reward_max": {"policy_0": -13.82300136019714}, "policy_reward_mean": {"policy_0": -730.3358968222145}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1392.3288313463208, -1320.9290391890386, -1473.8020755005796, -1044.345144068465, -71.92961000752807, -713.3697478656146, -130.32032615273363, -83.26805656461976, -733.6160720003436, -136.91643550808612, -969.2317270632069, -1131.2135515342732, -573.8016820468011, -656.950570989691, -1144.7327107000685, -707.2133262512463, -194.1361196189138, -1008.4217965793332, -932.5291135357234, -1265.5050663095979, -850.4854541154155, -577.7706825081962, -649.9872244553699, -658.66765045281, -739.6523765872234, -540.1735047613429, -609.6278239975474, -1112.4488984959016, -1370.3802547282012, -809.9580800489111, -909.3356999853944, -231.80086729446282, -536.972793395724, -1145.6294587537325, -167.46999575082594, -1193.4133620319305, -78.12269223330291, -306.7723856057447, -738.004772632797, -837.9555778839879, -949.6272241215098, -967.4266444075392, -323.9085991150423, -66.94227045908481, -528.0025286426418, -19.498940541089112, -938.9733870533197, -436.5393169431562, -80.88157921997717, -908.8590429264, -488.8180039838228, -1234.9097857573217, -669.4739164093934, -73.73843900273425, -893.1572332434152, -1197.430514910233, -13.82300136019714, -210.00685279869265, -1243.910255827482, -687.5515258087518, -1056.996689103649, -714.3289326692556, -426.11004693431477, -959.2348388043988, -155.36368163463754, -944.1588098724997, -749.2690908574606, -756.8347874674404, -629.5498362091975, -41.26065397503432, -598.9683653564999, -718.7467795296703, -1050.283113964872, -1080.133957399228, -1196.3241829385117, -994.4404543089187, -718.7672271544434, -955.2753762237, -46.25877845249903, -915.4027597421428, -1167.596124113327, -827.6595622995236, -519.8915305907536, -952.7856032213227, -1192.1446748390074, -1415.2857146137028, -791.9682836583015, -645.1819021116681, -1155.1910810877712, -850.5513046131699, -667.9176587752005, -691.8327397837149, -766.5448660126173, -1128.1964048770035, -993.9315957007842, -678.6818000151295, -852.7103713600487, -368.28937675632807, -276.30209627683297, -700.5490078340641], "episode_lengths": [150, 150, 150, 150, 57, 150, 56, 97, 150, 91, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 107, 150, 74, 150, 144, 150, 150, 150, 136, 56, 150, 55, 150, 107, 78, 150, 150, 150, 150, 72, 150, 150, 41, 98, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 130, 43, 150, 150, 150, 150, 150, 150, 150, 150, 64, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 114, 150], "policy_policy_0_reward": [-1392.3288313463208, -1320.9290391890386, -1473.8020755005796, -1044.345144068465, -71.92961000752807, -713.3697478656146, -130.32032615273363, -83.26805656461976, -733.6160720003436, -136.91643550808612, -969.2317270632069, -1131.2135515342732, -573.8016820468011, -656.950570989691, -1144.7327107000685, -707.2133262512463, -194.1361196189138, -1008.4217965793332, -932.5291135357234, -1265.5050663095979, -850.4854541154155, -577.7706825081962, -649.9872244553699, -658.66765045281, -739.6523765872234, -540.1735047613429, -609.6278239975474, -1112.4488984959016, -1370.3802547282012, -809.9580800489111, -909.3356999853944, -231.80086729446282, -536.972793395724, -1145.6294587537325, -167.46999575082594, -1193.4133620319305, -78.12269223330291, -306.7723856057447, -738.004772632797, -837.9555778839879, -949.6272241215098, -967.4266444075392, -323.9085991150423, -66.94227045908481, -528.0025286426418, -19.498940541089112, -938.9733870533197, -436.5393169431562, -80.88157921997717, -908.8590429264, -488.8180039838228, -1234.9097857573217, -669.4739164093934, -73.73843900273425, -893.1572332434152, -1197.430514910233, -13.82300136019714, -210.00685279869265, -1243.910255827482, -687.5515258087518, -1056.996689103649, -714.3289326692556, -426.11004693431477, -959.2348388043988, -155.36368163463754, -944.1588098724997, -749.2690908574606, -756.8347874674404, -629.5498362091975, -41.26065397503432, -598.9683653564999, -718.7467795296703, -1050.283113964872, -1080.133957399228, -1196.3241829385117, -994.4404543089187, -718.7672271544434, -955.2753762237, -46.25877845249903, -915.4027597421428, -1167.596124113327, -827.6595622995236, -519.8915305907536, -952.7856032213227, -1192.1446748390074, -1415.2857146137028, -791.9682836583015, -645.1819021116681, -1155.1910810877712, -850.5513046131699, -667.9176587752005, -691.8327397837149, -766.5448660126173, -1128.1964048770035, -993.9315957007842, -678.6818000151295, -852.7103713600487, -368.28937675632807, -276.30209627683297, -700.5490078340641]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5525968254514599, "mean_inference_ms": 1.6793786853337374, "mean_action_processing_ms": 0.2777277473903948, "mean_env_wait_ms": 3.0764035249436166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018829345703125, "StateBufferConnector_ms": 0.008280515670776367, "ViewRequirementAgentConnector_ms": 0.1906895637512207}, "num_episodes": 25, "episode_return_max": -13.82300136019714, "episode_return_min": -1473.8020755005796, "episode_return_mean": -730.3358968222145, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.44313790784827, "num_env_steps_trained_throughput_per_sec": 307.44313790784827, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12467.391, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12467.315, "sample_time_ms": 1066.347, "learn_time_ms": 11336.504, "learn_throughput": 352.842, "synch_weights_time_ms": 63.668}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "92003_00016", "date": "2024-08-03_05-06-09", "timestamp": 1722641769, "time_this_iter_s": 13.02229642868042, "time_total_s": 308.8720107078552, "pid": 484683, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b135289d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 308.8720107078552, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 17.63888888888889, "ram_util_percent": 27.97222222222222}}
