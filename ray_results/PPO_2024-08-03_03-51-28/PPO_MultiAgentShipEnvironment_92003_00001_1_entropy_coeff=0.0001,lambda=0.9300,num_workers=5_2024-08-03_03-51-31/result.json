{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1968200136596958, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.4266405860583, "policy_loss": -0.003045999159803614, "vf_loss": 9.428168964385986, "vf_explained_var": 0.025152223495145638, "kl": 0.008296855434794755, "entropy": 1.4173864552130302, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -101.79394672713785, "episode_reward_min": -1264.565788761769, "episode_reward_mean": -686.7215968910199, "episode_len_mean": 130.07142857142858, "episode_media": {}, "episodes_timesteps_total": 3642, "policy_reward_min": {"policy_0": -1264.565788761769}, "policy_reward_max": {"policy_0": -101.79394672713785}, "policy_reward_mean": {"policy_0": -686.7215968910199}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-937.7809192355558, -106.17653510536417, -458.24379066243785, -933.1838832032306, -1264.565788761769, -867.773263056519, -214.54966147103113, -884.2367108233699, -704.6892623039556, -987.852527102973, -809.0336124925384, -818.2163263627388, -101.79394672713785, -269.14163981570846, -117.17955594474141, -705.8721866752039, -927.8423870218777, -786.8681818728511, -148.85669363438976, -208.36458416391253, -215.63633708224702, -922.3513892344051, -835.7589038168563, -771.5377767100655, -1210.6042071821023, -1027.745347170902, -1098.6873561479276, -893.6619391667483], "episode_lengths": [150, 62, 120, 150, 150, 150, 93, 150, 150, 150, 150, 150, 77, 95, 71, 150, 150, 150, 84, 80, 110, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-937.7809192355558, -106.17653510536417, -458.24379066243785, -933.1838832032306, -1264.565788761769, -867.773263056519, -214.54966147103113, -884.2367108233699, -704.6892623039556, -987.852527102973, -809.0336124925384, -818.2163263627388, -101.79394672713785, -269.14163981570846, -117.17955594474141, -705.8721866752039, -927.8423870218777, -786.8681818728511, -148.85669363438976, -208.36458416391253, -215.63633708224702, -922.3513892344051, -835.7589038168563, -771.5377767100655, -1210.6042071821023, -1027.745347170902, -1098.6873561479276, -893.6619391667483]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31028239085369413, "mean_inference_ms": 0.9583044821764878, "mean_action_processing_ms": 0.17217370901214948, "mean_env_wait_ms": 1.6919823919193875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006224427904401507, "StateBufferConnector_ms": 0.0047011034829275945, "ViewRequirementAgentConnector_ms": 0.10394879749843053}, "num_episodes": 28, "episode_return_max": -101.79394672713785, "episode_return_min": -1264.565788761769, "episode_return_mean": -686.7215968910199, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 273.6456249150832, "num_env_steps_trained_throughput_per_sec": 273.6456249150832, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 14617.457, "restore_workers_time_ms": 0.021, "training_step_time_ms": 14617.392, "sample_time_ms": 2653.887, "learn_time_ms": 11949.779, "learn_throughput": 334.734, "synch_weights_time_ms": 12.505}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "92003_00001", "date": "2024-08-03_04-26-01", "timestamp": 1722639361, "time_this_iter_s": 14.623112201690674, "time_total_s": 14.623112201690674, "pid": 479117, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c7ab370>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14.623112201690674, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 32.828571428571436, "ram_util_percent": 37.857142857142854}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7000131411477923, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.327434660991033, "policy_loss": -0.012522720556686788, "vf_loss": 9.33733302851518, "vf_explained_var": 0.15876662706335384, "kl": 0.013822229173198747, "entropy": 1.4011960346251726, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -27.698229012026, "episode_reward_min": -1264.565788761769, "episode_reward_mean": -704.6853623221793, "episode_len_mean": 136.47368421052633, "episode_media": {}, "episodes_timesteps_total": 7779, "policy_reward_min": {"policy_0": -1264.565788761769}, "policy_reward_max": {"policy_0": -27.698229012026}, "policy_reward_mean": {"policy_0": -704.6853623221793}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-937.7809192355558, -106.17653510536417, -458.24379066243785, -933.1838832032306, -1264.565788761769, -867.773263056519, -214.54966147103113, -884.2367108233699, -704.6892623039556, -987.852527102973, -809.0336124925384, -818.2163263627388, -101.79394672713785, -269.14163981570846, -117.17955594474141, -705.8721866752039, -927.8423870218777, -786.8681818728511, -148.85669363438976, -208.36458416391253, -215.63633708224702, -922.3513892344051, -835.7589038168563, -771.5377767100655, -1210.6042071821023, -1027.745347170902, -1098.6873561479276, -893.6619391667483, -382.223673911412, -949.0869086831735, -634.5562521630611, -781.4173858044643, -440.7360551620993, -677.8213869256948, -901.0444792048113, -802.4070741362206, -1067.5940880035448, -625.2144757964253, -928.454956457884, -841.0671377728997, -889.9246331862014, -1090.3164692161272, -1043.9516078786626, -919.6992099710441, -218.65600498840385, -575.8912224142972, -1046.036251971102, -120.32483308969287, -1129.2934565537814, -449.57211747368507, -27.698229012026, -905.9225276812059, -586.5515409843579, -1059.246245238287, -504.0994705305924, -712.9505679649776, -627.1026772395263], "episode_lengths": [150, 62, 120, 150, 150, 150, 93, 150, 150, 150, 150, 150, 77, 95, 71, 150, 150, 150, 84, 80, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 66, 150, 131, 46, 150, 150, 150, 144, 150, 150], "policy_policy_0_reward": [-937.7809192355558, -106.17653510536417, -458.24379066243785, -933.1838832032306, -1264.565788761769, -867.773263056519, -214.54966147103113, -884.2367108233699, -704.6892623039556, -987.852527102973, -809.0336124925384, -818.2163263627388, -101.79394672713785, -269.14163981570846, -117.17955594474141, -705.8721866752039, -927.8423870218777, -786.8681818728511, -148.85669363438976, -208.36458416391253, -215.63633708224702, -922.3513892344051, -835.7589038168563, -771.5377767100655, -1210.6042071821023, -1027.745347170902, -1098.6873561479276, -893.6619391667483, -382.223673911412, -949.0869086831735, -634.5562521630611, -781.4173858044643, -440.7360551620993, -677.8213869256948, -901.0444792048113, -802.4070741362206, -1067.5940880035448, -625.2144757964253, -928.454956457884, -841.0671377728997, -889.9246331862014, -1090.3164692161272, -1043.9516078786626, -919.6992099710441, -218.65600498840385, -575.8912224142972, -1046.036251971102, -120.32483308969287, -1129.2934565537814, -449.57211747368507, -27.698229012026, -905.9225276812059, -586.5515409843579, -1059.246245238287, -504.0994705305924, -712.9505679649776, -627.1026772395263]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30761192204657756, "mean_inference_ms": 0.9530260432631185, "mean_action_processing_ms": 0.17088450246469966, "mean_env_wait_ms": 1.6795872226499633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006475364952756648, "StateBufferConnector_ms": 0.004586838839346902, "ViewRequirementAgentConnector_ms": 0.10359329089783785}, "num_episodes": 29, "episode_return_max": -27.698229012026, "episode_return_min": -1264.565788761769, "episode_return_mean": -704.6853623221793, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.32170113895864, "num_env_steps_trained_throughput_per_sec": 266.32170113895864, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 14818.448, "restore_workers_time_ms": 0.02, "training_step_time_ms": 14818.388, "sample_time_ms": 2614.799, "learn_time_ms": 12188.252, "learn_throughput": 328.185, "synch_weights_time_ms": 14.35}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "92003_00001", "date": "2024-08-03_04-26-16", "timestamp": 1722639376, "time_this_iter_s": 15.028100728988647, "time_total_s": 29.65121293067932, "pid": 479117, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c787400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 29.65121293067932, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 18.37727272727273, "ram_util_percent": 38.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.706364628393203, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.533482816815376, "policy_loss": -0.010387374919567567, "vf_loss": 8.54120281090339, "vf_explained_var": 0.3257356541852156, "kl": 0.014041502173010182, "entropy": 1.4093243756641944, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -27.698229012026, "episode_reward_min": -1264.565788761769, "episode_reward_mean": -700.3141216122885, "episode_len_mean": 137.09411764705882, "episode_media": {}, "episodes_timesteps_total": 11653, "policy_reward_min": {"policy_0": -1264.565788761769}, "policy_reward_max": {"policy_0": -27.698229012026}, "policy_reward_mean": {"policy_0": -700.3141216122885}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-937.7809192355558, -106.17653510536417, -458.24379066243785, -933.1838832032306, -1264.565788761769, -867.773263056519, -214.54966147103113, -884.2367108233699, -704.6892623039556, -987.852527102973, -809.0336124925384, -818.2163263627388, -101.79394672713785, -269.14163981570846, -117.17955594474141, -705.8721866752039, -927.8423870218777, -786.8681818728511, -148.85669363438976, -208.36458416391253, -215.63633708224702, -922.3513892344051, -835.7589038168563, -771.5377767100655, -1210.6042071821023, -1027.745347170902, -1098.6873561479276, -893.6619391667483, -382.223673911412, -949.0869086831735, -634.5562521630611, -781.4173858044643, -440.7360551620993, -677.8213869256948, -901.0444792048113, -802.4070741362206, -1067.5940880035448, -625.2144757964253, -928.454956457884, -841.0671377728997, -889.9246331862014, -1090.3164692161272, -1043.9516078786626, -919.6992099710441, -218.65600498840385, -575.8912224142972, -1046.036251971102, -120.32483308969287, -1129.2934565537814, -449.57211747368507, -27.698229012026, -905.9225276812059, -586.5515409843579, -1059.246245238287, -504.0994705305924, -712.9505679649776, -627.1026772395263, -1107.2884034992742, -1152.1633118344646, -414.07154960903193, -393.4271201797584, -272.1712042081397, -794.7666818925245, -249.51377587292532, -519.2140149638454, -922.0976925196338, -935.3251311222724, -992.6970493127604, -463.34169583830686, -650.4300630498087, -582.5739077536332, -212.79404271846073, -618.7553348822228, -37.657564868068214, -409.6675344439127, -994.5818020543358, -896.476154283904, -744.6703648539668, -1058.249136423405, -994.2607618977642, -992.6670290229847, -917.0026999070238, -542.6165667983685, -814.7194524528911, -676.4346384166255], "episode_lengths": [150, 62, 120, 150, 150, 150, 93, 150, 150, 150, 150, 150, 77, 95, 71, 150, 150, 150, 84, 80, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 66, 150, 131, 46, 150, 150, 150, 144, 150, 150, 150, 150, 117, 111, 109, 150, 110, 150, 150, 150, 150, 150, 150, 150, 78, 150, 49, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-937.7809192355558, -106.17653510536417, -458.24379066243785, -933.1838832032306, -1264.565788761769, -867.773263056519, -214.54966147103113, -884.2367108233699, -704.6892623039556, -987.852527102973, -809.0336124925384, -818.2163263627388, -101.79394672713785, -269.14163981570846, -117.17955594474141, -705.8721866752039, -927.8423870218777, -786.8681818728511, -148.85669363438976, -208.36458416391253, -215.63633708224702, -922.3513892344051, -835.7589038168563, -771.5377767100655, -1210.6042071821023, -1027.745347170902, -1098.6873561479276, -893.6619391667483, -382.223673911412, -949.0869086831735, -634.5562521630611, -781.4173858044643, -440.7360551620993, -677.8213869256948, -901.0444792048113, -802.4070741362206, -1067.5940880035448, -625.2144757964253, -928.454956457884, -841.0671377728997, -889.9246331862014, -1090.3164692161272, -1043.9516078786626, -919.6992099710441, -218.65600498840385, -575.8912224142972, -1046.036251971102, -120.32483308969287, -1129.2934565537814, -449.57211747368507, -27.698229012026, -905.9225276812059, -586.5515409843579, -1059.246245238287, -504.0994705305924, -712.9505679649776, -627.1026772395263, -1107.2884034992742, -1152.1633118344646, -414.07154960903193, -393.4271201797584, -272.1712042081397, -794.7666818925245, -249.51377587292532, -519.2140149638454, -922.0976925196338, -935.3251311222724, -992.6970493127604, -463.34169583830686, -650.4300630498087, -582.5739077536332, -212.79404271846073, -618.7553348822228, -37.657564868068214, -409.6675344439127, -994.5818020543358, -896.476154283904, -744.6703648539668, -1058.249136423405, -994.2607618977642, -992.6670290229847, -917.0026999070238, -542.6165667983685, -814.7194524528911, -676.4346384166255]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30603773676222085, "mean_inference_ms": 0.950095964504963, "mean_action_processing_ms": 0.16991953476653718, "mean_env_wait_ms": 1.6735347264076712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006279103896197151, "StateBufferConnector_ms": 0.004458427429199219, "ViewRequirementAgentConnector_ms": 0.1025710386388442}, "num_episodes": 28, "episode_return_max": -27.698229012026, "episode_return_min": -1264.565788761769, "episode_return_mean": -700.3141216122885, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 334.5917840337058, "num_env_steps_trained_throughput_per_sec": 334.5917840337058, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 13863.927, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13863.856, "sample_time_ms": 2571.866, "learn_time_ms": 11267.426, "learn_throughput": 355.006, "synch_weights_time_ms": 23.422}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "92003_00001", "date": "2024-08-03_04-26-28", "timestamp": 1722639388, "time_this_iter_s": 11.962481260299683, "time_total_s": 41.613694190979004, "pid": 479117, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c785bd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 41.613694190979004, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 26.023529411764706, "ram_util_percent": 38.01176470588236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.654835570603609, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.650549128154914, "policy_loss": -0.008596840073975424, "vf_loss": 8.656200574338436, "vf_explained_var": 0.6023782437667251, "kl": 0.015455545916999353, "entropy": 1.45727118079861, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -18.741344800801222, "episode_reward_min": -1210.6042071821023, "episode_reward_mean": -713.2421225870107, "episode_len_mean": 138.95, "episode_media": {}, "episodes_timesteps_total": 13895, "policy_reward_min": {"policy_0": -1210.6042071821023}, "policy_reward_max": {"policy_0": -18.741344800801222}, "policy_reward_mean": {"policy_0": -713.2421225870107}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-101.79394672713785, -269.14163981570846, -117.17955594474141, -705.8721866752039, -927.8423870218777, -786.8681818728511, -148.85669363438976, -208.36458416391253, -215.63633708224702, -922.3513892344051, -835.7589038168563, -771.5377767100655, -1210.6042071821023, -1027.745347170902, -1098.6873561479276, -893.6619391667483, -382.223673911412, -949.0869086831735, -634.5562521630611, -781.4173858044643, -440.7360551620993, -677.8213869256948, -901.0444792048113, -802.4070741362206, -1067.5940880035448, -625.2144757964253, -928.454956457884, -841.0671377728997, -889.9246331862014, -1090.3164692161272, -1043.9516078786626, -919.6992099710441, -218.65600498840385, -575.8912224142972, -1046.036251971102, -120.32483308969287, -1129.2934565537814, -449.57211747368507, -27.698229012026, -905.9225276812059, -586.5515409843579, -1059.246245238287, -504.0994705305924, -712.9505679649776, -627.1026772395263, -1107.2884034992742, -1152.1633118344646, -414.07154960903193, -393.4271201797584, -272.1712042081397, -794.7666818925245, -249.51377587292532, -519.2140149638454, -922.0976925196338, -935.3251311222724, -992.6970493127604, -463.34169583830686, -650.4300630498087, -582.5739077536332, -212.79404271846073, -618.7553348822228, -37.657564868068214, -409.6675344439127, -994.5818020543358, -896.476154283904, -744.6703648539668, -1058.249136423405, -994.2607618977642, -992.6670290229847, -917.0026999070238, -542.6165667983685, -814.7194524528911, -676.4346384166255, -909.6656157332856, -677.201626327626, -486.1886585335921, -911.1758449807771, -1069.1518792867753, -389.2710576564144, -1000.8628174599438, -1172.1017678360495, -991.472510026883, -876.9936773449876, -18.741344800801222, -1150.1950062029725, -855.940832555277, -738.0291250347915, -861.4222562968848, -858.488699090995, -873.4565264825771, -999.4741511344224, -704.8027003553974, -505.42794066997993, -819.9729249220368, -200.74774851020294, -928.8072763193163, -707.6562147091985, -767.665217808666, -960.5044270820571, -348.3963550761132], "episode_lengths": [77, 95, 71, 150, 150, 150, 84, 80, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 66, 150, 131, 46, 150, 150, 150, 144, 150, 150, 150, 150, 117, 111, 109, 150, 110, 150, 150, 150, 150, 150, 150, 150, 78, 150, 49, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 35, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 150, 117], "policy_policy_0_reward": [-101.79394672713785, -269.14163981570846, -117.17955594474141, -705.8721866752039, -927.8423870218777, -786.8681818728511, -148.85669363438976, -208.36458416391253, -215.63633708224702, -922.3513892344051, -835.7589038168563, -771.5377767100655, -1210.6042071821023, -1027.745347170902, -1098.6873561479276, -893.6619391667483, -382.223673911412, -949.0869086831735, -634.5562521630611, -781.4173858044643, -440.7360551620993, -677.8213869256948, -901.0444792048113, -802.4070741362206, -1067.5940880035448, -625.2144757964253, -928.454956457884, -841.0671377728997, -889.9246331862014, -1090.3164692161272, -1043.9516078786626, -919.6992099710441, -218.65600498840385, -575.8912224142972, -1046.036251971102, -120.32483308969287, -1129.2934565537814, -449.57211747368507, -27.698229012026, -905.9225276812059, -586.5515409843579, -1059.246245238287, -504.0994705305924, -712.9505679649776, -627.1026772395263, -1107.2884034992742, -1152.1633118344646, -414.07154960903193, -393.4271201797584, -272.1712042081397, -794.7666818925245, -249.51377587292532, -519.2140149638454, -922.0976925196338, -935.3251311222724, -992.6970493127604, -463.34169583830686, -650.4300630498087, -582.5739077536332, -212.79404271846073, -618.7553348822228, -37.657564868068214, -409.6675344439127, -994.5818020543358, -896.476154283904, -744.6703648539668, -1058.249136423405, -994.2607618977642, -992.6670290229847, -917.0026999070238, -542.6165667983685, -814.7194524528911, -676.4346384166255, -909.6656157332856, -677.201626327626, -486.1886585335921, -911.1758449807771, -1069.1518792867753, -389.2710576564144, -1000.8628174599438, -1172.1017678360495, -991.472510026883, -876.9936773449876, -18.741344800801222, -1150.1950062029725, -855.940832555277, -738.0291250347915, -861.4222562968848, -858.488699090995, -873.4565264825771, -999.4741511344224, -704.8027003553974, -505.42794066997993, -819.9729249220368, -200.74774851020294, -928.8072763193163, -707.6562147091985, -767.665217808666, -960.5044270820571, -348.3963550761132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3096411608262969, "mean_inference_ms": 0.9709758901067232, "mean_action_processing_ms": 0.17184258881682146, "mean_env_wait_ms": 1.6952848606045612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006531238555908203, "StateBufferConnector_ms": 0.004606008529663086, "ViewRequirementAgentConnector_ms": 0.1077725887298584}, "num_episodes": 27, "episode_return_max": -18.741344800801222, "episode_return_min": -1210.6042071821023, "episode_return_mean": -713.2421225870107, "episodes_this_iter": 27}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 254.28875032079347, "num_env_steps_trained_throughput_per_sec": 254.28875032079347, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 14330.486, "restore_workers_time_ms": 0.025, "training_step_time_ms": 14330.414, "sample_time_ms": 2761.786, "learn_time_ms": 11546.301, "learn_throughput": 346.431, "synch_weights_time_ms": 21.266}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "92003_00001", "date": "2024-08-03_04-26-44", "timestamp": 1722639404, "time_this_iter_s": 15.73957633972168, "time_total_s": 57.353270530700684, "pid": 479117, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c7aacb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 57.353270530700684, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 25.390909090909087, "ram_util_percent": 38.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34.6015738149484, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.909227056801319, "policy_loss": -0.012832915590358122, "vf_loss": 6.918401442468166, "vf_explained_var": 0.8060308191304405, "kl": 0.018993072049609816, "entropy": 1.4008370064198972, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -12.104703549391129, "episode_reward_min": -1209.5390662102536, "episode_reward_mean": -730.7406208268176, "episode_len_mean": 141.15, "episode_media": {}, "episodes_timesteps_total": 14115, "policy_reward_min": {"policy_0": -1209.5390662102536}, "policy_reward_max": {"policy_0": -12.104703549391129}, "policy_reward_mean": {"policy_0": -730.7406208268176}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1090.3164692161272, -1043.9516078786626, -919.6992099710441, -218.65600498840385, -575.8912224142972, -1046.036251971102, -120.32483308969287, -1129.2934565537814, -449.57211747368507, -27.698229012026, -905.9225276812059, -586.5515409843579, -1059.246245238287, -504.0994705305924, -712.9505679649776, -627.1026772395263, -1107.2884034992742, -1152.1633118344646, -414.07154960903193, -393.4271201797584, -272.1712042081397, -794.7666818925245, -249.51377587292532, -519.2140149638454, -922.0976925196338, -935.3251311222724, -992.6970493127604, -463.34169583830686, -650.4300630498087, -582.5739077536332, -212.79404271846073, -618.7553348822228, -37.657564868068214, -409.6675344439127, -994.5818020543358, -896.476154283904, -744.6703648539668, -1058.249136423405, -994.2607618977642, -992.6670290229847, -917.0026999070238, -542.6165667983685, -814.7194524528911, -676.4346384166255, -909.6656157332856, -677.201626327626, -486.1886585335921, -911.1758449807771, -1069.1518792867753, -389.2710576564144, -1000.8628174599438, -1172.1017678360495, -991.472510026883, -876.9936773449876, -18.741344800801222, -1150.1950062029725, -855.940832555277, -738.0291250347915, -861.4222562968848, -858.488699090995, -873.4565264825771, -999.4741511344224, -704.8027003553974, -505.42794066997993, -819.9729249220368, -200.74774851020294, -928.8072763193163, -707.6562147091985, -767.665217808666, -960.5044270820571, -348.3963550761132, -742.9955425182336, -794.4429223423089, -440.83231433171306, -694.8092558265646, -156.2746070972277, -611.6050075656302, -805.8696054562776, -1010.5362210689609, -781.6633724840237, -345.2444562006685, -831.0055265320673, -788.1808499170886, -625.2152859208635, -1209.5390662102536, -961.5773649743625, -827.692401029098, -603.7853056386526, -910.3356473016012, -835.5357845729964, -902.2117259596237, -854.7696871776647, -847.0869487813666, -1042.9049520775247, -1072.8349830746654, -12.104703549391129, -988.0051788663379, -769.7627577721672, -473.25099486137344, -973.228294446934], "episode_lengths": [150, 150, 150, 150, 150, 150, 66, 150, 131, 46, 150, 150, 150, 144, 150, 150, 150, 150, 117, 111, 109, 150, 110, 150, 150, 150, 150, 150, 150, 150, 78, 150, 49, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 35, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 150, 117, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 36, 150, 150, 150, 150], "policy_policy_0_reward": [-1090.3164692161272, -1043.9516078786626, -919.6992099710441, -218.65600498840385, -575.8912224142972, -1046.036251971102, -120.32483308969287, -1129.2934565537814, -449.57211747368507, -27.698229012026, -905.9225276812059, -586.5515409843579, -1059.246245238287, -504.0994705305924, -712.9505679649776, -627.1026772395263, -1107.2884034992742, -1152.1633118344646, -414.07154960903193, -393.4271201797584, -272.1712042081397, -794.7666818925245, -249.51377587292532, -519.2140149638454, -922.0976925196338, -935.3251311222724, -992.6970493127604, -463.34169583830686, -650.4300630498087, -582.5739077536332, -212.79404271846073, -618.7553348822228, -37.657564868068214, -409.6675344439127, -994.5818020543358, -896.476154283904, -744.6703648539668, -1058.249136423405, -994.2607618977642, -992.6670290229847, -917.0026999070238, -542.6165667983685, -814.7194524528911, -676.4346384166255, -909.6656157332856, -677.201626327626, -486.1886585335921, -911.1758449807771, -1069.1518792867753, -389.2710576564144, -1000.8628174599438, -1172.1017678360495, -991.472510026883, -876.9936773449876, -18.741344800801222, -1150.1950062029725, -855.940832555277, -738.0291250347915, -861.4222562968848, -858.488699090995, -873.4565264825771, -999.4741511344224, -704.8027003553974, -505.42794066997993, -819.9729249220368, -200.74774851020294, -928.8072763193163, -707.6562147091985, -767.665217808666, -960.5044270820571, -348.3963550761132, -742.9955425182336, -794.4429223423089, -440.83231433171306, -694.8092558265646, -156.2746070972277, -611.6050075656302, -805.8696054562776, -1010.5362210689609, -781.6633724840237, -345.2444562006685, -831.0055265320673, -788.1808499170886, -625.2152859208635, -1209.5390662102536, -961.5773649743625, -827.692401029098, -603.7853056386526, -910.3356473016012, -835.5357845729964, -902.2117259596237, -854.7696871776647, -847.0869487813666, -1042.9049520775247, -1072.8349830746654, -12.104703549391129, -988.0051788663379, -769.7627577721672, -473.25099486137344, -973.228294446934]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31177068974356187, "mean_inference_ms": 0.9864542557852718, "mean_action_processing_ms": 0.1729741041862313, "mean_env_wait_ms": 1.7109319892685753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006265163421630859, "StateBufferConnector_ms": 0.004502534866333008, "ViewRequirementAgentConnector_ms": 0.1078639030456543}, "num_episodes": 29, "episode_return_max": -12.104703549391129, "episode_return_min": -1209.5390662102536, "episode_return_mean": -730.7406208268176, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 255.93763238541877, "num_env_steps_trained_throughput_per_sec": 255.93763238541877, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 14590.153, "restore_workers_time_ms": 0.024, "training_step_time_ms": 14590.082, "sample_time_ms": 2726.857, "learn_time_ms": 11838.455, "learn_throughput": 337.882, "synch_weights_time_ms": 23.666}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "92003_00001", "date": "2024-08-03_04-26-59", "timestamp": 1722639419, "time_this_iter_s": 15.658321857452393, "time_total_s": 73.01159238815308, "pid": 479117, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b580e9ea0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 73.01159238815308, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 23.58636363636364, "ram_util_percent": 38.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 52.68485871752103, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.179023133963346, "policy_loss": -0.004655187047319487, "vf_loss": 6.181247445195913, "vf_explained_var": 0.8605923236658176, "kl": 0.012797924119968229, "entropy": 1.286955338343978, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -12.104703549391129, "episode_reward_min": -1388.1538566802612, "episode_reward_mean": -704.2569226406491, "episode_len_mean": 140.4, "episode_media": {}, "episodes_timesteps_total": 14040, "policy_reward_min": {"policy_0": -1388.1538566802612}, "policy_reward_max": {"policy_0": -12.104703549391129}, "policy_reward_mean": {"policy_0": -704.2569226406491}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-582.5739077536332, -212.79404271846073, -618.7553348822228, -37.657564868068214, -409.6675344439127, -994.5818020543358, -896.476154283904, -744.6703648539668, -1058.249136423405, -994.2607618977642, -992.6670290229847, -917.0026999070238, -542.6165667983685, -814.7194524528911, -676.4346384166255, -909.6656157332856, -677.201626327626, -486.1886585335921, -911.1758449807771, -1069.1518792867753, -389.2710576564144, -1000.8628174599438, -1172.1017678360495, -991.472510026883, -876.9936773449876, -18.741344800801222, -1150.1950062029725, -855.940832555277, -738.0291250347915, -861.4222562968848, -858.488699090995, -873.4565264825771, -999.4741511344224, -704.8027003553974, -505.42794066997993, -819.9729249220368, -200.74774851020294, -928.8072763193163, -707.6562147091985, -767.665217808666, -960.5044270820571, -348.3963550761132, -742.9955425182336, -794.4429223423089, -440.83231433171306, -694.8092558265646, -156.2746070972277, -611.6050075656302, -805.8696054562776, -1010.5362210689609, -781.6633724840237, -345.2444562006685, -831.0055265320673, -788.1808499170886, -625.2152859208635, -1209.5390662102536, -961.5773649743625, -827.692401029098, -603.7853056386526, -910.3356473016012, -835.5357845729964, -902.2117259596237, -854.7696871776647, -847.0869487813666, -1042.9049520775247, -1072.8349830746654, -12.104703549391129, -988.0051788663379, -769.7627577721672, -473.25099486137344, -973.228294446934, -1388.1538566802612, -679.4188915227546, -466.44479285445857, -169.55422032609883, -908.5768022326176, -912.4906682640144, -638.1699804330065, -534.5679220523771, -816.922988480958, -364.44817107414315, -573.5410892585057, -34.641452296456876, -945.1392331855894, -157.34849104747235, -714.0234635249718, -555.9033915470103, -877.472769977019, -99.79639143961268, -592.1498309527058, -658.4478636734707, -616.1512343497536, -523.45769157692, -967.9479899417565, -928.4999516531387, -862.2585905176398, -251.0165070076723, -280.52272726303744, -429.25264851254514, -289.1306958477131], "episode_lengths": [150, 78, 150, 49, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 35, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 150, 117, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 36, 150, 150, 150, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 65, 150, 77, 150, 119, 150, 82, 150, 150, 150, 150, 150, 150, 150, 78, 101, 150, 150], "policy_policy_0_reward": [-582.5739077536332, -212.79404271846073, -618.7553348822228, -37.657564868068214, -409.6675344439127, -994.5818020543358, -896.476154283904, -744.6703648539668, -1058.249136423405, -994.2607618977642, -992.6670290229847, -917.0026999070238, -542.6165667983685, -814.7194524528911, -676.4346384166255, -909.6656157332856, -677.201626327626, -486.1886585335921, -911.1758449807771, -1069.1518792867753, -389.2710576564144, -1000.8628174599438, -1172.1017678360495, -991.472510026883, -876.9936773449876, -18.741344800801222, -1150.1950062029725, -855.940832555277, -738.0291250347915, -861.4222562968848, -858.488699090995, -873.4565264825771, -999.4741511344224, -704.8027003553974, -505.42794066997993, -819.9729249220368, -200.74774851020294, -928.8072763193163, -707.6562147091985, -767.665217808666, -960.5044270820571, -348.3963550761132, -742.9955425182336, -794.4429223423089, -440.83231433171306, -694.8092558265646, -156.2746070972277, -611.6050075656302, -805.8696054562776, -1010.5362210689609, -781.6633724840237, -345.2444562006685, -831.0055265320673, -788.1808499170886, -625.2152859208635, -1209.5390662102536, -961.5773649743625, -827.692401029098, -603.7853056386526, -910.3356473016012, -835.5357845729964, -902.2117259596237, -854.7696871776647, -847.0869487813666, -1042.9049520775247, -1072.8349830746654, -12.104703549391129, -988.0051788663379, -769.7627577721672, -473.25099486137344, -973.228294446934, -1388.1538566802612, -679.4188915227546, -466.44479285445857, -169.55422032609883, -908.5768022326176, -912.4906682640144, -638.1699804330065, -534.5679220523771, -816.922988480958, -364.44817107414315, -573.5410892585057, -34.641452296456876, -945.1392331855894, -157.34849104747235, -714.0234635249718, -555.9033915470103, -877.472769977019, -99.79639143961268, -592.1498309527058, -658.4478636734707, -616.1512343497536, -523.45769157692, -967.9479899417565, -928.4999516531387, -862.2585905176398, -251.0165070076723, -280.52272726303744, -429.25264851254514, -289.1306958477131]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3241038791523516, "mean_inference_ms": 1.0336956748182125, "mean_action_processing_ms": 0.17923491382629209, "mean_env_wait_ms": 1.7723139352567672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009053945541381836, "StateBufferConnector_ms": 0.005620002746582031, "ViewRequirementAgentConnector_ms": 0.13058161735534668}, "num_episodes": 29, "episode_return_max": -12.104703549391129, "episode_return_min": -1388.1538566802612, "episode_return_mean": -704.2569226406491, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 232.80278469452614, "num_env_steps_trained_throughput_per_sec": 232.80278469452614, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 15022.118, "restore_workers_time_ms": 0.025, "training_step_time_ms": 15022.045, "sample_time_ms": 2963.926, "learn_time_ms": 12034.887, "learn_throughput": 332.367, "synch_weights_time_ms": 22.183}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "92003_00001", "date": "2024-08-03_04-27-17", "timestamp": 1722639437, "time_this_iter_s": 17.189905881881714, "time_total_s": 90.20149827003479, "pid": 479117, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c7aa3b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 90.20149827003479, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 33.188, "ram_util_percent": 38.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 73.72149471541246, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.188322840879361, "policy_loss": -0.011028495055506937, "vf_loss": 5.196152124553919, "vf_explained_var": 0.896618493894736, "kl": 0.01664669504998529, "entropy": 1.30118757126232, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -12.104703549391129, "episode_reward_min": -1388.1538566802612, "episode_reward_mean": -681.1620896869553, "episode_len_mean": 141.4, "episode_media": {}, "episodes_timesteps_total": 14140, "policy_reward_min": {"policy_0": -1388.1538566802612}, "policy_reward_max": {"policy_0": -12.104703549391129}, "policy_reward_mean": {"policy_0": -681.1620896869553}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-861.4222562968848, -858.488699090995, -873.4565264825771, -999.4741511344224, -704.8027003553974, -505.42794066997993, -819.9729249220368, -200.74774851020294, -928.8072763193163, -707.6562147091985, -767.665217808666, -960.5044270820571, -348.3963550761132, -742.9955425182336, -794.4429223423089, -440.83231433171306, -694.8092558265646, -156.2746070972277, -611.6050075656302, -805.8696054562776, -1010.5362210689609, -781.6633724840237, -345.2444562006685, -831.0055265320673, -788.1808499170886, -625.2152859208635, -1209.5390662102536, -961.5773649743625, -827.692401029098, -603.7853056386526, -910.3356473016012, -835.5357845729964, -902.2117259596237, -854.7696871776647, -847.0869487813666, -1042.9049520775247, -1072.8349830746654, -12.104703549391129, -988.0051788663379, -769.7627577721672, -473.25099486137344, -973.228294446934, -1388.1538566802612, -679.4188915227546, -466.44479285445857, -169.55422032609883, -908.5768022326176, -912.4906682640144, -638.1699804330065, -534.5679220523771, -816.922988480958, -364.44817107414315, -573.5410892585057, -34.641452296456876, -945.1392331855894, -157.34849104747235, -714.0234635249718, -555.9033915470103, -877.472769977019, -99.79639143961268, -592.1498309527058, -658.4478636734707, -616.1512343497536, -523.45769157692, -967.9479899417565, -928.4999516531387, -862.2585905176398, -251.0165070076723, -280.52272726303744, -429.25264851254514, -289.1306958477131, -666.2176825182122, -644.2755990341611, -526.5572405807892, -359.03907739140254, -1046.8904091626725, -121.04914425036196, -393.7817729790638, -229.2389942211371, -506.8716331830871, -617.9934567842978, -1144.168971389714, -843.4995962615609, -752.3431830206283, -1076.8208617323257, -870.0597420777168, -626.9892250764096, -605.854494949198, -771.7288364044741, -916.2219975755194, -696.3377729068333, -649.5703862882681, -300.3638203974307, -991.1505076585362, -660.3682526644365, -672.3192923083169, -542.2346432567529, -644.4223370351174, -805.1217724168677, -749.1447556630775], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 150, 117, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 36, 150, 150, 150, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 65, 150, 77, 150, 119, 150, 82, 150, 150, 150, 150, 150, 150, 150, 78, 101, 150, 150, 150, 150, 135, 106, 150, 89, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-861.4222562968848, -858.488699090995, -873.4565264825771, -999.4741511344224, -704.8027003553974, -505.42794066997993, -819.9729249220368, -200.74774851020294, -928.8072763193163, -707.6562147091985, -767.665217808666, -960.5044270820571, -348.3963550761132, -742.9955425182336, -794.4429223423089, -440.83231433171306, -694.8092558265646, -156.2746070972277, -611.6050075656302, -805.8696054562776, -1010.5362210689609, -781.6633724840237, -345.2444562006685, -831.0055265320673, -788.1808499170886, -625.2152859208635, -1209.5390662102536, -961.5773649743625, -827.692401029098, -603.7853056386526, -910.3356473016012, -835.5357845729964, -902.2117259596237, -854.7696871776647, -847.0869487813666, -1042.9049520775247, -1072.8349830746654, -12.104703549391129, -988.0051788663379, -769.7627577721672, -473.25099486137344, -973.228294446934, -1388.1538566802612, -679.4188915227546, -466.44479285445857, -169.55422032609883, -908.5768022326176, -912.4906682640144, -638.1699804330065, -534.5679220523771, -816.922988480958, -364.44817107414315, -573.5410892585057, -34.641452296456876, -945.1392331855894, -157.34849104747235, -714.0234635249718, -555.9033915470103, -877.472769977019, -99.79639143961268, -592.1498309527058, -658.4478636734707, -616.1512343497536, -523.45769157692, -967.9479899417565, -928.4999516531387, -862.2585905176398, -251.0165070076723, -280.52272726303744, -429.25264851254514, -289.1306958477131, -666.2176825182122, -644.2755990341611, -526.5572405807892, -359.03907739140254, -1046.8904091626725, -121.04914425036196, -393.7817729790638, -229.2389942211371, -506.8716331830871, -617.9934567842978, -1144.168971389714, -843.4995962615609, -752.3431830206283, -1076.8208617323257, -870.0597420777168, -626.9892250764096, -605.854494949198, -771.7288364044741, -916.2219975755194, -696.3377729068333, -649.5703862882681, -300.3638203974307, -991.1505076585362, -660.3682526644365, -672.3192923083169, -542.2346432567529, -644.4223370351174, -805.1217724168677, -749.1447556630775]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3329685711905593, "mean_inference_ms": 1.0635527010325587, "mean_action_processing_ms": 0.1835864124697233, "mean_env_wait_ms": 1.8139641169807939, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008933782577514648, "StateBufferConnector_ms": 0.005526304244995117, "ViewRequirementAgentConnector_ms": 0.12911415100097656}, "num_episodes": 29, "episode_return_max": -12.104703549391129, "episode_return_min": -1388.1538566802612, "episode_return_mean": -681.1620896869553, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.5952155861065, "num_env_steps_trained_throughput_per_sec": 267.5952155861065, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 15011.524, "restore_workers_time_ms": 0.024, "training_step_time_ms": 15011.453, "sample_time_ms": 2916.384, "learn_time_ms": 12072.612, "learn_throughput": 331.328, "synch_weights_time_ms": 21.453}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "92003_00001", "date": "2024-08-03_04-27-32", "timestamp": 1722639452, "time_this_iter_s": 14.956739902496338, "time_total_s": 105.15823817253113, "pid": 479117, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c7a9ab0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 105.15823817253113, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 18.804761904761904, "ram_util_percent": 38.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 64.66350091099739, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.980056989689668, "policy_loss": -0.012215214958026384, "vf_loss": 5.98942280113697, "vf_explained_var": 0.9374797385185957, "kl": 0.014923796716478447, "entropy": 1.353572860856851, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -1.9787974044785184, "episode_reward_min": -1388.1538566802612, "episode_reward_mean": -655.3852063249547, "episode_len_mean": 135.94, "episode_media": {}, "episodes_timesteps_total": 13594, "policy_reward_min": {"policy_0": -1388.1538566802612}, "policy_reward_max": {"policy_0": -1.9787974044785184}, "policy_reward_mean": {"policy_0": -655.3852063249547}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-910.3356473016012, -835.5357845729964, -902.2117259596237, -854.7696871776647, -847.0869487813666, -1042.9049520775247, -1072.8349830746654, -12.104703549391129, -988.0051788663379, -769.7627577721672, -473.25099486137344, -973.228294446934, -1388.1538566802612, -679.4188915227546, -466.44479285445857, -169.55422032609883, -908.5768022326176, -912.4906682640144, -638.1699804330065, -534.5679220523771, -816.922988480958, -364.44817107414315, -573.5410892585057, -34.641452296456876, -945.1392331855894, -157.34849104747235, -714.0234635249718, -555.9033915470103, -877.472769977019, -99.79639143961268, -592.1498309527058, -658.4478636734707, -616.1512343497536, -523.45769157692, -967.9479899417565, -928.4999516531387, -862.2585905176398, -251.0165070076723, -280.52272726303744, -429.25264851254514, -289.1306958477131, -666.2176825182122, -644.2755990341611, -526.5572405807892, -359.03907739140254, -1046.8904091626725, -121.04914425036196, -393.7817729790638, -229.2389942211371, -506.8716331830871, -617.9934567842978, -1144.168971389714, -843.4995962615609, -752.3431830206283, -1076.8208617323257, -870.0597420777168, -626.9892250764096, -605.854494949198, -771.7288364044741, -916.2219975755194, -696.3377729068333, -649.5703862882681, -300.3638203974307, -991.1505076585362, -660.3682526644365, -672.3192923083169, -542.2346432567529, -644.4223370351174, -805.1217724168677, -749.1447556630775, -130.49854483966968, -873.1632580023258, -311.0581263152245, -1111.3949466934098, -298.56647855001864, -10.295250193271762, -1.9787974044785184, -992.7021289976389, -694.4478593835203, -1139.9343617453753, -654.5586837078488, -916.380668234734, -38.77439456550904, -56.07370374594449, -993.2269982532621, -1105.0534118834832, -772.9414755553377, -912.1515985635227, -703.305014090571, -872.718403237614, -745.6668739755667, -209.2674762756257, -1036.037612443751, -769.2767868598287, -606.0860100406536, -700.8650324202666, -341.1672343936849, -740.027254969085, -1010.1879846756918, -442.5968373548471], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 36, 150, 150, 150, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 65, 150, 77, 150, 119, 150, 82, 150, 150, 150, 150, 150, 150, 150, 78, 101, 150, 150, 150, 150, 135, 106, 150, 89, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 150, 99, 150, 101, 43, 39, 150, 150, 150, 150, 150, 58, 74, 150, 150, 150, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 150, 150, 108], "policy_policy_0_reward": [-910.3356473016012, -835.5357845729964, -902.2117259596237, -854.7696871776647, -847.0869487813666, -1042.9049520775247, -1072.8349830746654, -12.104703549391129, -988.0051788663379, -769.7627577721672, -473.25099486137344, -973.228294446934, -1388.1538566802612, -679.4188915227546, -466.44479285445857, -169.55422032609883, -908.5768022326176, -912.4906682640144, -638.1699804330065, -534.5679220523771, -816.922988480958, -364.44817107414315, -573.5410892585057, -34.641452296456876, -945.1392331855894, -157.34849104747235, -714.0234635249718, -555.9033915470103, -877.472769977019, -99.79639143961268, -592.1498309527058, -658.4478636734707, -616.1512343497536, -523.45769157692, -967.9479899417565, -928.4999516531387, -862.2585905176398, -251.0165070076723, -280.52272726303744, -429.25264851254514, -289.1306958477131, -666.2176825182122, -644.2755990341611, -526.5572405807892, -359.03907739140254, -1046.8904091626725, -121.04914425036196, -393.7817729790638, -229.2389942211371, -506.8716331830871, -617.9934567842978, -1144.168971389714, -843.4995962615609, -752.3431830206283, -1076.8208617323257, -870.0597420777168, -626.9892250764096, -605.854494949198, -771.7288364044741, -916.2219975755194, -696.3377729068333, -649.5703862882681, -300.3638203974307, -991.1505076585362, -660.3682526644365, -672.3192923083169, -542.2346432567529, -644.4223370351174, -805.1217724168677, -749.1447556630775, -130.49854483966968, -873.1632580023258, -311.0581263152245, -1111.3949466934098, -298.56647855001864, -10.295250193271762, -1.9787974044785184, -992.7021289976389, -694.4478593835203, -1139.9343617453753, -654.5586837078488, -916.380668234734, -38.77439456550904, -56.07370374594449, -993.2269982532621, -1105.0534118834832, -772.9414755553377, -912.1515985635227, -703.305014090571, -872.718403237614, -745.6668739755667, -209.2674762756257, -1036.037612443751, -769.2767868598287, -606.0860100406536, -700.8650324202666, -341.1672343936849, -740.027254969085, -1010.1879846756918, -442.5968373548471]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3380658125922375, "mean_inference_ms": 1.089103723907414, "mean_action_processing_ms": 0.18603488944441415, "mean_env_wait_ms": 1.8362377403632864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009016036987304688, "StateBufferConnector_ms": 0.005544185638427734, "ViewRequirementAgentConnector_ms": 0.1289539337158203}, "num_episodes": 30, "episode_return_max": -1.9787974044785184, "episode_return_min": -1388.1538566802612, "episode_return_mean": -655.3852063249547, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 270.9257403834268, "num_env_steps_trained_throughput_per_sec": 270.9257403834268, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 14980.609, "restore_workers_time_ms": 0.024, "training_step_time_ms": 14980.539, "sample_time_ms": 2911.935, "learn_time_ms": 12046.631, "learn_throughput": 332.043, "synch_weights_time_ms": 20.987}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "92003_00001", "date": "2024-08-03_04-27-46", "timestamp": 1722639466, "time_this_iter_s": 14.772768020629883, "time_total_s": 119.93100619316101, "pid": 479117, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c7a9d80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 119.93100619316101, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 33.81904761904762, "ram_util_percent": 38.16190476190478}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 95.37053004105886, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.101959597567717, "policy_loss": -0.012203262451900324, "vf_loss": 5.11079223776857, "vf_explained_var": 0.8993309289837877, "kl": 0.017510835449108232, "entropy": 1.3153957205514113, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -1.9787974044785184, "episode_reward_min": -1323.8241821502122, "episode_reward_mean": -663.5946535153355, "episode_len_mean": 136.95, "episode_media": {}, "episodes_timesteps_total": 13695, "policy_reward_min": {"policy_0": -1323.8241821502122}, "policy_reward_max": {"policy_0": -1.9787974044785184}, "policy_reward_mean": {"policy_0": -663.5946535153355}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-592.1498309527058, -658.4478636734707, -616.1512343497536, -523.45769157692, -967.9479899417565, -928.4999516531387, -862.2585905176398, -251.0165070076723, -280.52272726303744, -429.25264851254514, -289.1306958477131, -666.2176825182122, -644.2755990341611, -526.5572405807892, -359.03907739140254, -1046.8904091626725, -121.04914425036196, -393.7817729790638, -229.2389942211371, -506.8716331830871, -617.9934567842978, -1144.168971389714, -843.4995962615609, -752.3431830206283, -1076.8208617323257, -870.0597420777168, -626.9892250764096, -605.854494949198, -771.7288364044741, -916.2219975755194, -696.3377729068333, -649.5703862882681, -300.3638203974307, -991.1505076585362, -660.3682526644365, -672.3192923083169, -542.2346432567529, -644.4223370351174, -805.1217724168677, -749.1447556630775, -130.49854483966968, -873.1632580023258, -311.0581263152245, -1111.3949466934098, -298.56647855001864, -10.295250193271762, -1.9787974044785184, -992.7021289976389, -694.4478593835203, -1139.9343617453753, -654.5586837078488, -916.380668234734, -38.77439456550904, -56.07370374594449, -993.2269982532621, -1105.0534118834832, -772.9414755553377, -912.1515985635227, -703.305014090571, -872.718403237614, -745.6668739755667, -209.2674762756257, -1036.037612443751, -769.2767868598287, -606.0860100406536, -700.8650324202666, -341.1672343936849, -740.027254969085, -1010.1879846756918, -442.5968373548471, -1000.7473573461222, -1020.9186599529131, -640.8619002164763, -1033.8230439169395, -671.094143218982, -183.66797450843418, -1250.260034554364, -1050.3795153387018, -640.4066260815988, -1234.283406114738, -384.3822133839313, -769.4956375956033, -566.2601554409347, -539.6884406379626, -230.13001710407198, -812.6830713822216, -850.104221203, -591.9683637703779, -144.56201225483858, -770.3828452379997, -1323.8241821502122, -730.3593462986092, -600.8317495902618, -1025.3400799131982, -647.5533793021918, -630.3367161043399, -352.65948939988516, -546.5597921114093, -109.25728385597287, -986.7692956907779], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 78, 101, 150, 150, 150, 150, 135, 106, 150, 89, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 150, 99, 150, 101, 43, 39, 150, 150, 150, 150, 150, 58, 74, 150, 150, 150, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 144, 98, 150, 150, 138, 150, 144, 150, 150, 150, 80, 150, 150, 150, 74, 150, 150, 150, 150, 150, 150, 150, 113, 150, 76, 150], "policy_policy_0_reward": [-592.1498309527058, -658.4478636734707, -616.1512343497536, -523.45769157692, -967.9479899417565, -928.4999516531387, -862.2585905176398, -251.0165070076723, -280.52272726303744, -429.25264851254514, -289.1306958477131, -666.2176825182122, -644.2755990341611, -526.5572405807892, -359.03907739140254, -1046.8904091626725, -121.04914425036196, -393.7817729790638, -229.2389942211371, -506.8716331830871, -617.9934567842978, -1144.168971389714, -843.4995962615609, -752.3431830206283, -1076.8208617323257, -870.0597420777168, -626.9892250764096, -605.854494949198, -771.7288364044741, -916.2219975755194, -696.3377729068333, -649.5703862882681, -300.3638203974307, -991.1505076585362, -660.3682526644365, -672.3192923083169, -542.2346432567529, -644.4223370351174, -805.1217724168677, -749.1447556630775, -130.49854483966968, -873.1632580023258, -311.0581263152245, -1111.3949466934098, -298.56647855001864, -10.295250193271762, -1.9787974044785184, -992.7021289976389, -694.4478593835203, -1139.9343617453753, -654.5586837078488, -916.380668234734, -38.77439456550904, -56.07370374594449, -993.2269982532621, -1105.0534118834832, -772.9414755553377, -912.1515985635227, -703.305014090571, -872.718403237614, -745.6668739755667, -209.2674762756257, -1036.037612443751, -769.2767868598287, -606.0860100406536, -700.8650324202666, -341.1672343936849, -740.027254969085, -1010.1879846756918, -442.5968373548471, -1000.7473573461222, -1020.9186599529131, -640.8619002164763, -1033.8230439169395, -671.094143218982, -183.66797450843418, -1250.260034554364, -1050.3795153387018, -640.4066260815988, -1234.283406114738, -384.3822133839313, -769.4956375956033, -566.2601554409347, -539.6884406379626, -230.13001710407198, -812.6830713822216, -850.104221203, -591.9683637703779, -144.56201225483858, -770.3828452379997, -1323.8241821502122, -730.3593462986092, -600.8317495902618, -1025.3400799131982, -647.5533793021918, -630.3367161043399, -352.65948939988516, -546.5597921114093, -109.25728385597287, -986.7692956907779]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3375745056807544, "mean_inference_ms": 1.0943402661968136, "mean_action_processing_ms": 0.1856064506625459, "mean_env_wait_ms": 1.8310837522960282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006639242172241211, "StateBufferConnector_ms": 0.004700660705566406, "ViewRequirementAgentConnector_ms": 0.11284875869750977}, "num_episodes": 30, "episode_return_max": -1.9787974044785184, "episode_return_min": -1323.8241821502122, "episode_return_mean": -663.5946535153355, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.1079416762041, "num_env_steps_trained_throughput_per_sec": 269.1079416762041, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 14967.646, "restore_workers_time_ms": 0.024, "training_step_time_ms": 14967.576, "sample_time_ms": 2878.655, "learn_time_ms": 12067.533, "learn_throughput": 331.468, "synch_weights_time_ms": 20.414}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "92003_00001", "date": "2024-08-03_04-28-01", "timestamp": 1722639481, "time_this_iter_s": 14.87389087677002, "time_total_s": 134.80489706993103, "pid": 479117, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b580e8430>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 134.80489706993103, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 18.585714285714285, "ram_util_percent": 38.20000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 93.03482181429862, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.299831014126539, "policy_loss": -0.006253581691998989, "vf_loss": 5.303336224704981, "vf_explained_var": 0.9186876612404983, "kl": 0.01439643700294559, "entropy": 1.3092377660175165, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -1.9787974044785184, "episode_reward_min": -1323.8241821502122, "episode_reward_mean": -681.5089415140434, "episode_len_mean": 136.96, "episode_media": {}, "episodes_timesteps_total": 13696, "policy_reward_min": {"policy_0": -1323.8241821502122}, "policy_reward_max": {"policy_0": -1.9787974044785184}, "policy_reward_mean": {"policy_0": -681.5089415140434}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-771.7288364044741, -916.2219975755194, -696.3377729068333, -649.5703862882681, -300.3638203974307, -991.1505076585362, -660.3682526644365, -672.3192923083169, -542.2346432567529, -644.4223370351174, -805.1217724168677, -749.1447556630775, -130.49854483966968, -873.1632580023258, -311.0581263152245, -1111.3949466934098, -298.56647855001864, -10.295250193271762, -1.9787974044785184, -992.7021289976389, -694.4478593835203, -1139.9343617453753, -654.5586837078488, -916.380668234734, -38.77439456550904, -56.07370374594449, -993.2269982532621, -1105.0534118834832, -772.9414755553377, -912.1515985635227, -703.305014090571, -872.718403237614, -745.6668739755667, -209.2674762756257, -1036.037612443751, -769.2767868598287, -606.0860100406536, -700.8650324202666, -341.1672343936849, -740.027254969085, -1010.1879846756918, -442.5968373548471, -1000.7473573461222, -1020.9186599529131, -640.8619002164763, -1033.8230439169395, -671.094143218982, -183.66797450843418, -1250.260034554364, -1050.3795153387018, -640.4066260815988, -1234.283406114738, -384.3822133839313, -769.4956375956033, -566.2601554409347, -539.6884406379626, -230.13001710407198, -812.6830713822216, -850.104221203, -591.9683637703779, -144.56201225483858, -770.3828452379997, -1323.8241821502122, -730.3593462986092, -600.8317495902618, -1025.3400799131982, -647.5533793021918, -630.3367161043399, -352.65948939988516, -546.5597921114093, -109.25728385597287, -986.7692956907779, -944.5463337661147, -467.58520874215895, -610.2442008900208, -733.1208928903076, -923.4195442530485, -151.64111293809756, -814.7460236136468, -874.522180611698, -467.5043279123848, -1005.8765266044318, -1186.803925931678, -677.9330562039013, -580.4897738987615, -596.5095007235616, -1143.9366167200499, -302.585690693303, -1065.177626443289, -1257.2001434116962, -759.3543272510494, -788.0351291134746, -27.55017357602364, -516.8694062307716, -658.6733582929292, -512.6810675474775, -774.913784689502, -533.0123953858401, -475.8586678770271, -371.1246195676378], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 150, 99, 150, 101, 43, 39, 150, 150, 150, 150, 150, 58, 74, 150, 150, 150, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 144, 98, 150, 150, 138, 150, 144, 150, 150, 150, 80, 150, 150, 150, 74, 150, 150, 150, 150, 150, 150, 150, 113, 150, 76, 150, 150, 150, 130, 144, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 123, 150, 150, 150, 150, 50, 118, 150, 150, 150, 150, 150, 95], "policy_policy_0_reward": [-771.7288364044741, -916.2219975755194, -696.3377729068333, -649.5703862882681, -300.3638203974307, -991.1505076585362, -660.3682526644365, -672.3192923083169, -542.2346432567529, -644.4223370351174, -805.1217724168677, -749.1447556630775, -130.49854483966968, -873.1632580023258, -311.0581263152245, -1111.3949466934098, -298.56647855001864, -10.295250193271762, -1.9787974044785184, -992.7021289976389, -694.4478593835203, -1139.9343617453753, -654.5586837078488, -916.380668234734, -38.77439456550904, -56.07370374594449, -993.2269982532621, -1105.0534118834832, -772.9414755553377, -912.1515985635227, -703.305014090571, -872.718403237614, -745.6668739755667, -209.2674762756257, -1036.037612443751, -769.2767868598287, -606.0860100406536, -700.8650324202666, -341.1672343936849, -740.027254969085, -1010.1879846756918, -442.5968373548471, -1000.7473573461222, -1020.9186599529131, -640.8619002164763, -1033.8230439169395, -671.094143218982, -183.66797450843418, -1250.260034554364, -1050.3795153387018, -640.4066260815988, -1234.283406114738, -384.3822133839313, -769.4956375956033, -566.2601554409347, -539.6884406379626, -230.13001710407198, -812.6830713822216, -850.104221203, -591.9683637703779, -144.56201225483858, -770.3828452379997, -1323.8241821502122, -730.3593462986092, -600.8317495902618, -1025.3400799131982, -647.5533793021918, -630.3367161043399, -352.65948939988516, -546.5597921114093, -109.25728385597287, -986.7692956907779, -944.5463337661147, -467.58520874215895, -610.2442008900208, -733.1208928903076, -923.4195442530485, -151.64111293809756, -814.7460236136468, -874.522180611698, -467.5043279123848, -1005.8765266044318, -1186.803925931678, -677.9330562039013, -580.4897738987615, -596.5095007235616, -1143.9366167200499, -302.585690693303, -1065.177626443289, -1257.2001434116962, -759.3543272510494, -788.0351291134746, -27.55017357602364, -516.8694062307716, -658.6733582929292, -512.6810675474775, -774.913784689502, -533.0123953858401, -475.8586678770271, -371.1246195676378]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33390142319868477, "mean_inference_ms": 1.0878298163186269, "mean_action_processing_ms": 0.18363288870367342, "mean_env_wait_ms": 1.8144419258542217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057599544525146484, "StateBufferConnector_ms": 0.0044291019439697266, "ViewRequirementAgentConnector_ms": 0.1071157455444336}, "num_episodes": 28, "episode_return_max": -1.9787974044785184, "episode_return_min": -1323.8241821502122, "episode_return_mean": -681.5089415140434, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 270.9443661496671, "num_env_steps_trained_throughput_per_sec": 270.9443661496671, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 14947.2, "restore_workers_time_ms": 0.023, "training_step_time_ms": 14947.132, "sample_time_ms": 2842.995, "learn_time_ms": 12082.987, "learn_throughput": 331.044, "synch_weights_time_ms": 20.155}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "92003_00001", "date": "2024-08-03_04-28-16", "timestamp": 1722639496, "time_this_iter_s": 14.769082307815552, "time_total_s": 149.57397937774658, "pid": 479117, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c7a9ab0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 149.57397937774658, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 31.823809523809523, "ram_util_percent": 38.290476190476184}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 109.49670269290606, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.229110004752874, "policy_loss": -0.00846292446561468, "vf_loss": 5.234059854596853, "vf_explained_var": 0.9501039613038301, "kl": 0.018215354010438507, "entropy": 1.3000093264505268, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -27.55017357602364, "episode_reward_min": -1323.8241821502122, "episode_reward_mean": -714.2918325602456, "episode_len_mean": 139.51, "episode_media": {}, "episodes_timesteps_total": 13951, "policy_reward_min": {"policy_0": -1323.8241821502122}, "policy_reward_max": {"policy_0": -27.55017357602364}, "policy_reward_mean": {"policy_0": -714.2918325602456}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-772.9414755553377, -912.1515985635227, -703.305014090571, -872.718403237614, -745.6668739755667, -209.2674762756257, -1036.037612443751, -769.2767868598287, -606.0860100406536, -700.8650324202666, -341.1672343936849, -740.027254969085, -1010.1879846756918, -442.5968373548471, -1000.7473573461222, -1020.9186599529131, -640.8619002164763, -1033.8230439169395, -671.094143218982, -183.66797450843418, -1250.260034554364, -1050.3795153387018, -640.4066260815988, -1234.283406114738, -384.3822133839313, -769.4956375956033, -566.2601554409347, -539.6884406379626, -230.13001710407198, -812.6830713822216, -850.104221203, -591.9683637703779, -144.56201225483858, -770.3828452379997, -1323.8241821502122, -730.3593462986092, -600.8317495902618, -1025.3400799131982, -647.5533793021918, -630.3367161043399, -352.65948939988516, -546.5597921114093, -109.25728385597287, -986.7692956907779, -944.5463337661147, -467.58520874215895, -610.2442008900208, -733.1208928903076, -923.4195442530485, -151.64111293809756, -814.7460236136468, -874.522180611698, -467.5043279123848, -1005.8765266044318, -1186.803925931678, -677.9330562039013, -580.4897738987615, -596.5095007235616, -1143.9366167200499, -302.585690693303, -1065.177626443289, -1257.2001434116962, -759.3543272510494, -788.0351291134746, -27.55017357602364, -516.8694062307716, -658.6733582929292, -512.6810675474775, -774.913784689502, -533.0123953858401, -475.8586678770271, -371.1246195676378, -620.8221826689806, -948.1020273558901, -320.2207839215298, -729.5335631766658, -524.620649204952, -115.70678705315397, -1084.7835794389428, -1138.208620502329, -199.0194535704636, -1004.9560322559296, -982.5110547199575, -1292.4847286437293, -896.523494255733, -607.693131263898, -1248.938506837031, -652.1561493941656, -972.1384283744788, -396.36372547484586, -848.1115799816688, -1101.5734686433664, -981.2467568999214, -512.6145677704926, -982.426006059521, -755.1761957333944, -232.90941019491623, -681.8795975175162, -89.33152157181189, -1085.3290892262553], "episode_lengths": [150, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 144, 98, 150, 150, 138, 150, 144, 150, 150, 150, 80, 150, 150, 150, 74, 150, 150, 150, 150, 150, 150, 150, 113, 150, 76, 150, 150, 150, 130, 144, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 123, 150, 150, 150, 150, 50, 118, 150, 150, 150, 150, 150, 95, 150, 150, 92, 150, 150, 70, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 133, 150, 60, 150], "policy_policy_0_reward": [-772.9414755553377, -912.1515985635227, -703.305014090571, -872.718403237614, -745.6668739755667, -209.2674762756257, -1036.037612443751, -769.2767868598287, -606.0860100406536, -700.8650324202666, -341.1672343936849, -740.027254969085, -1010.1879846756918, -442.5968373548471, -1000.7473573461222, -1020.9186599529131, -640.8619002164763, -1033.8230439169395, -671.094143218982, -183.66797450843418, -1250.260034554364, -1050.3795153387018, -640.4066260815988, -1234.283406114738, -384.3822133839313, -769.4956375956033, -566.2601554409347, -539.6884406379626, -230.13001710407198, -812.6830713822216, -850.104221203, -591.9683637703779, -144.56201225483858, -770.3828452379997, -1323.8241821502122, -730.3593462986092, -600.8317495902618, -1025.3400799131982, -647.5533793021918, -630.3367161043399, -352.65948939988516, -546.5597921114093, -109.25728385597287, -986.7692956907779, -944.5463337661147, -467.58520874215895, -610.2442008900208, -733.1208928903076, -923.4195442530485, -151.64111293809756, -814.7460236136468, -874.522180611698, -467.5043279123848, -1005.8765266044318, -1186.803925931678, -677.9330562039013, -580.4897738987615, -596.5095007235616, -1143.9366167200499, -302.585690693303, -1065.177626443289, -1257.2001434116962, -759.3543272510494, -788.0351291134746, -27.55017357602364, -516.8694062307716, -658.6733582929292, -512.6810675474775, -774.913784689502, -533.0123953858401, -475.8586678770271, -371.1246195676378, -620.8221826689806, -948.1020273558901, -320.2207839215298, -729.5335631766658, -524.620649204952, -115.70678705315397, -1084.7835794389428, -1138.208620502329, -199.0194535704636, -1004.9560322559296, -982.5110547199575, -1292.4847286437293, -896.523494255733, -607.693131263898, -1248.938506837031, -652.1561493941656, -972.1384283744788, -396.36372547484586, -848.1115799816688, -1101.5734686433664, -981.2467568999214, -512.6145677704926, -982.426006059521, -755.1761957333944, -232.90941019491623, -681.8795975175162, -89.33152157181189, -1085.3290892262553]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33120920561345213, "mean_inference_ms": 1.0777495638813623, "mean_action_processing_ms": 0.18203237814725676, "mean_env_wait_ms": 1.8012751996318501, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005658864974975586, "StateBufferConnector_ms": 0.004328012466430664, "ViewRequirementAgentConnector_ms": 0.10427427291870117}, "num_episodes": 28, "episode_return_max": -27.55017357602364, "episode_return_min": -1323.8241821502122, "episode_return_mean": -714.2918325602456, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.07921374066876, "num_env_steps_trained_throughput_per_sec": 264.07921374066876, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 15000.153, "restore_workers_time_ms": 0.023, "training_step_time_ms": 15000.085, "sample_time_ms": 2832.289, "learn_time_ms": 12145.59, "learn_throughput": 329.338, "synch_weights_time_ms": 21.257}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "92003_00001", "date": "2024-08-03_04-28-31", "timestamp": 1722639511, "time_this_iter_s": 15.155213117599487, "time_total_s": 164.72919249534607, "pid": 479117, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b580ebbe0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 164.72919249534607, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 18.599999999999998, "ram_util_percent": 38.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 119.1851870894432, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.279849041750034, "policy_loss": -0.007863175765184376, "vf_loss": 4.284467372546593, "vf_explained_var": 0.9593010988086462, "kl": 0.016793836895036916, "entropy": 1.1392737081895272, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -27.55017357602364, "episode_reward_min": -1323.8241821502122, "episode_reward_mean": -698.3896684020073, "episode_len_mean": 140.31, "episode_media": {}, "episodes_timesteps_total": 14031, "policy_reward_min": {"policy_0": -1323.8241821502122}, "policy_reward_max": {"policy_0": -27.55017357602364}, "policy_reward_mean": {"policy_0": -698.3896684020073}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-850.104221203, -591.9683637703779, -144.56201225483858, -770.3828452379997, -1323.8241821502122, -730.3593462986092, -600.8317495902618, -1025.3400799131982, -647.5533793021918, -630.3367161043399, -352.65948939988516, -546.5597921114093, -109.25728385597287, -986.7692956907779, -944.5463337661147, -467.58520874215895, -610.2442008900208, -733.1208928903076, -923.4195442530485, -151.64111293809756, -814.7460236136468, -874.522180611698, -467.5043279123848, -1005.8765266044318, -1186.803925931678, -677.9330562039013, -580.4897738987615, -596.5095007235616, -1143.9366167200499, -302.585690693303, -1065.177626443289, -1257.2001434116962, -759.3543272510494, -788.0351291134746, -27.55017357602364, -516.8694062307716, -658.6733582929292, -512.6810675474775, -774.913784689502, -533.0123953858401, -475.8586678770271, -371.1246195676378, -620.8221826689806, -948.1020273558901, -320.2207839215298, -729.5335631766658, -524.620649204952, -115.70678705315397, -1084.7835794389428, -1138.208620502329, -199.0194535704636, -1004.9560322559296, -982.5110547199575, -1292.4847286437293, -896.523494255733, -607.693131263898, -1248.938506837031, -652.1561493941656, -972.1384283744788, -396.36372547484586, -848.1115799816688, -1101.5734686433664, -981.2467568999214, -512.6145677704926, -982.426006059521, -755.1761957333944, -232.90941019491623, -681.8795975175162, -89.33152157181189, -1085.3290892262553, -346.1211634498978, -711.2411129550424, -834.8979501376031, -1183.4698880886522, -1183.9939546236549, -1140.1998954962817, -520.6220300829714, -355.01065725393755, -605.7006162853197, -554.5719565268807, -594.8283873885828, -762.8626853985667, -925.1513441635728, -432.56289537319014, -112.56834382953946, -726.3737192228976, -610.6262738492738, -400.8503845022764, -457.2975705476883, -221.13567971071703, -597.9813925631979, -826.3201277206613, -894.4051748912273, -849.7153590692743, -643.1397222335477, -954.9474347732572, -469.7035670876171, -1117.5039251803496, -645.2610509637133, -622.0971124568235], "episode_lengths": [150, 150, 74, 150, 150, 150, 150, 150, 150, 150, 113, 150, 76, 150, 150, 150, 130, 144, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 123, 150, 150, 150, 150, 50, 118, 150, 150, 150, 150, 150, 95, 150, 150, 92, 150, 150, 70, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 133, 150, 60, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 66, 150, 140, 150, 150, 105, 150, 150, 150, 150, 150, 150, 139, 150, 150, 150], "policy_policy_0_reward": [-850.104221203, -591.9683637703779, -144.56201225483858, -770.3828452379997, -1323.8241821502122, -730.3593462986092, -600.8317495902618, -1025.3400799131982, -647.5533793021918, -630.3367161043399, -352.65948939988516, -546.5597921114093, -109.25728385597287, -986.7692956907779, -944.5463337661147, -467.58520874215895, -610.2442008900208, -733.1208928903076, -923.4195442530485, -151.64111293809756, -814.7460236136468, -874.522180611698, -467.5043279123848, -1005.8765266044318, -1186.803925931678, -677.9330562039013, -580.4897738987615, -596.5095007235616, -1143.9366167200499, -302.585690693303, -1065.177626443289, -1257.2001434116962, -759.3543272510494, -788.0351291134746, -27.55017357602364, -516.8694062307716, -658.6733582929292, -512.6810675474775, -774.913784689502, -533.0123953858401, -475.8586678770271, -371.1246195676378, -620.8221826689806, -948.1020273558901, -320.2207839215298, -729.5335631766658, -524.620649204952, -115.70678705315397, -1084.7835794389428, -1138.208620502329, -199.0194535704636, -1004.9560322559296, -982.5110547199575, -1292.4847286437293, -896.523494255733, -607.693131263898, -1248.938506837031, -652.1561493941656, -972.1384283744788, -396.36372547484586, -848.1115799816688, -1101.5734686433664, -981.2467568999214, -512.6145677704926, -982.426006059521, -755.1761957333944, -232.90941019491623, -681.8795975175162, -89.33152157181189, -1085.3290892262553, -346.1211634498978, -711.2411129550424, -834.8979501376031, -1183.4698880886522, -1183.9939546236549, -1140.1998954962817, -520.6220300829714, -355.01065725393755, -605.7006162853197, -554.5719565268807, -594.8283873885828, -762.8626853985667, -925.1513441635728, -432.56289537319014, -112.56834382953946, -726.3737192228976, -610.6262738492738, -400.8503845022764, -457.2975705476883, -221.13567971071703, -597.9813925631979, -826.3201277206613, -894.4051748912273, -849.7153590692743, -643.1397222335477, -954.9474347732572, -469.7035670876171, -1117.5039251803496, -645.2610509637133, -622.0971124568235]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3285263673309116, "mean_inference_ms": 1.0633672753099923, "mean_action_processing_ms": 0.1803115411875622, "mean_env_wait_ms": 1.7850866621698116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005797147750854492, "StateBufferConnector_ms": 0.004347801208496094, "ViewRequirementAgentConnector_ms": 0.10471010208129883}, "num_episodes": 30, "episode_return_max": -27.55017357602364, "episode_return_min": -1323.8241821502122, "episode_return_mean": -698.3896684020073, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.70679230284, "num_env_steps_trained_throughput_per_sec": 274.70679230284, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 14954.308, "restore_workers_time_ms": 0.024, "training_step_time_ms": 14954.238, "sample_time_ms": 2831.122, "learn_time_ms": 12100.904, "learn_throughput": 330.554, "synch_weights_time_ms": 21.265}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "92003_00001", "date": "2024-08-03_04-28-46", "timestamp": 1722639526, "time_this_iter_s": 14.56832504272461, "time_total_s": 179.29751753807068, "pid": 479117, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b580eb640>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 179.29751753807068, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 43.83, "ram_util_percent": 38.394999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 131.20211805502575, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.105604108422995, "policy_loss": -0.011308240846847183, "vf_loss": 4.111793068051338, "vf_explained_var": 0.9679784172525009, "kl": 0.026242510674940923, "entropy": 1.2922468035792312, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -27.55017357602364, "episode_reward_min": -1333.4993144039618, "episode_reward_mean": -692.5671126375001, "episode_len_mean": 138.85, "episode_media": {}, "episodes_timesteps_total": 13885, "policy_reward_min": {"policy_0": -1333.4993144039618}, "policy_reward_max": {"policy_0": -27.55017357602364}, "policy_reward_mean": {"policy_0": -692.5671126375001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-596.5095007235616, -1143.9366167200499, -302.585690693303, -1065.177626443289, -1257.2001434116962, -759.3543272510494, -788.0351291134746, -27.55017357602364, -516.8694062307716, -658.6733582929292, -512.6810675474775, -774.913784689502, -533.0123953858401, -475.8586678770271, -371.1246195676378, -620.8221826689806, -948.1020273558901, -320.2207839215298, -729.5335631766658, -524.620649204952, -115.70678705315397, -1084.7835794389428, -1138.208620502329, -199.0194535704636, -1004.9560322559296, -982.5110547199575, -1292.4847286437293, -896.523494255733, -607.693131263898, -1248.938506837031, -652.1561493941656, -972.1384283744788, -396.36372547484586, -848.1115799816688, -1101.5734686433664, -981.2467568999214, -512.6145677704926, -982.426006059521, -755.1761957333944, -232.90941019491623, -681.8795975175162, -89.33152157181189, -1085.3290892262553, -346.1211634498978, -711.2411129550424, -834.8979501376031, -1183.4698880886522, -1183.9939546236549, -1140.1998954962817, -520.6220300829714, -355.01065725393755, -605.7006162853197, -554.5719565268807, -594.8283873885828, -762.8626853985667, -925.1513441635728, -432.56289537319014, -112.56834382953946, -726.3737192228976, -610.6262738492738, -400.8503845022764, -457.2975705476883, -221.13567971071703, -597.9813925631979, -826.3201277206613, -894.4051748912273, -849.7153590692743, -643.1397222335477, -954.9474347732572, -469.7035670876171, -1117.5039251803496, -645.2610509637133, -622.0971124568235, -1333.4993144039618, -351.1185814459978, -920.349990468193, -1180.5925717852233, -321.31733223496394, -50.02414325674889, -988.6628807231986, -1083.2614114703813, -932.2559769855471, -183.67213065718997, -627.7655101788702, -923.0323846816685, -636.1867515140976, -978.4676753735507, -577.8502648180021, -625.6048454076117, -835.2902838964035, -1000.4970563980902, -814.7915138132853, -909.1796824865658, -173.99694604445918, -122.06705895375013, -87.35977463424396, -419.46448247267654, -731.7574421868752, -874.1269459014238, -484.49333649563096], "episode_lengths": [150, 150, 123, 150, 150, 150, 150, 50, 118, 150, 150, 150, 150, 150, 95, 150, 150, 92, 150, 150, 70, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 133, 150, 60, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 66, 150, 140, 150, 150, 105, 150, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 90, 56, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 54, 83, 150, 150, 150, 150], "policy_policy_0_reward": [-596.5095007235616, -1143.9366167200499, -302.585690693303, -1065.177626443289, -1257.2001434116962, -759.3543272510494, -788.0351291134746, -27.55017357602364, -516.8694062307716, -658.6733582929292, -512.6810675474775, -774.913784689502, -533.0123953858401, -475.8586678770271, -371.1246195676378, -620.8221826689806, -948.1020273558901, -320.2207839215298, -729.5335631766658, -524.620649204952, -115.70678705315397, -1084.7835794389428, -1138.208620502329, -199.0194535704636, -1004.9560322559296, -982.5110547199575, -1292.4847286437293, -896.523494255733, -607.693131263898, -1248.938506837031, -652.1561493941656, -972.1384283744788, -396.36372547484586, -848.1115799816688, -1101.5734686433664, -981.2467568999214, -512.6145677704926, -982.426006059521, -755.1761957333944, -232.90941019491623, -681.8795975175162, -89.33152157181189, -1085.3290892262553, -346.1211634498978, -711.2411129550424, -834.8979501376031, -1183.4698880886522, -1183.9939546236549, -1140.1998954962817, -520.6220300829714, -355.01065725393755, -605.7006162853197, -554.5719565268807, -594.8283873885828, -762.8626853985667, -925.1513441635728, -432.56289537319014, -112.56834382953946, -726.3737192228976, -610.6262738492738, -400.8503845022764, -457.2975705476883, -221.13567971071703, -597.9813925631979, -826.3201277206613, -894.4051748912273, -849.7153590692743, -643.1397222335477, -954.9474347732572, -469.7035670876171, -1117.5039251803496, -645.2610509637133, -622.0971124568235, -1333.4993144039618, -351.1185814459978, -920.349990468193, -1180.5925717852233, -321.31733223496394, -50.02414325674889, -988.6628807231986, -1083.2614114703813, -932.2559769855471, -183.67213065718997, -627.7655101788702, -923.0323846816685, -636.1867515140976, -978.4676753735507, -577.8502648180021, -625.6048454076117, -835.2902838964035, -1000.4970563980902, -814.7915138132853, -909.1796824865658, -173.99694604445918, -122.06705895375013, -87.35977463424396, -419.46448247267654, -731.7574421868752, -874.1269459014238, -484.49333649563096]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3270420575874382, "mean_inference_ms": 1.053937986101392, "mean_action_processing_ms": 0.17926198643632665, "mean_env_wait_ms": 1.7770692446300063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006125211715698242, "StateBufferConnector_ms": 0.004415035247802734, "ViewRequirementAgentConnector_ms": 0.10660982131958008}, "num_episodes": 27, "episode_return_max": -27.55017357602364, "episode_return_min": -1333.4993144039618, "episode_return_mean": -692.5671126375001, "episodes_this_iter": 27}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 258.3889385268949, "num_env_steps_trained_throughput_per_sec": 258.3889385268949, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 15306.875, "restore_workers_time_ms": 0.024, "training_step_time_ms": 15306.806, "sample_time_ms": 2862.053, "learn_time_ms": 12425.198, "learn_throughput": 321.926, "synch_weights_time_ms": 18.68}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "92003_00001", "date": "2024-08-03_04-29-02", "timestamp": 1722639542, "time_this_iter_s": 15.486031532287598, "time_total_s": 194.78354907035828, "pid": 479117, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b580e9630>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 194.78354907035828, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 18.769565217391303, "ram_util_percent": 38.31739130434781}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 145.62342856725056, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.045132688432932, "policy_loss": -0.009475490623541798, "vf_loss": 4.049758997559548, "vf_explained_var": 0.9754930645848314, "kl": 0.016567659045813345, "entropy": 1.2111831166471043, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -50.02414325674889, "episode_reward_min": -1333.4993144039618, "episode_reward_mean": -692.1551342105698, "episode_len_mean": 140.43, "episode_media": {}, "episodes_timesteps_total": 14043, "policy_reward_min": {"policy_0": -1333.4993144039618}, "policy_reward_max": {"policy_0": -50.02414325674889}, "policy_reward_mean": {"policy_0": -692.1551342105698}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1248.938506837031, -652.1561493941656, -972.1384283744788, -396.36372547484586, -848.1115799816688, -1101.5734686433664, -981.2467568999214, -512.6145677704926, -982.426006059521, -755.1761957333944, -232.90941019491623, -681.8795975175162, -89.33152157181189, -1085.3290892262553, -346.1211634498978, -711.2411129550424, -834.8979501376031, -1183.4698880886522, -1183.9939546236549, -1140.1998954962817, -520.6220300829714, -355.01065725393755, -605.7006162853197, -554.5719565268807, -594.8283873885828, -762.8626853985667, -925.1513441635728, -432.56289537319014, -112.56834382953946, -726.3737192228976, -610.6262738492738, -400.8503845022764, -457.2975705476883, -221.13567971071703, -597.9813925631979, -826.3201277206613, -894.4051748912273, -849.7153590692743, -643.1397222335477, -954.9474347732572, -469.7035670876171, -1117.5039251803496, -645.2610509637133, -622.0971124568235, -1333.4993144039618, -351.1185814459978, -920.349990468193, -1180.5925717852233, -321.31733223496394, -50.02414325674889, -988.6628807231986, -1083.2614114703813, -932.2559769855471, -183.67213065718997, -627.7655101788702, -923.0323846816685, -636.1867515140976, -978.4676753735507, -577.8502648180021, -625.6048454076117, -835.2902838964035, -1000.4970563980902, -814.7915138132853, -909.1796824865658, -173.99694604445918, -122.06705895375013, -87.35977463424396, -419.46448247267654, -731.7574421868752, -874.1269459014238, -484.49333649563096, -720.2005033613788, -488.09584228225344, -718.8861535308031, -562.8433112162961, -203.81443704296547, -886.4858682481531, -1026.878284396443, -717.595188500733, -971.6428846568864, -1148.7356913421706, -506.65452936930177, -223.59970827124982, -758.8517627806096, -847.2537613161319, -833.3996923071861, -636.5456685134527, -799.176383729721, -957.7589923501043, -666.1516388479167, -389.3003465776417, -444.0885305164156, -918.7207899773845, -904.1474332269395, -516.659123193188, -1070.4320894663138, -269.12484888474467, -242.00565917301884, -912.1660697530239, -866.2555600303426], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 133, 150, 60, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 66, 150, 140, 150, 150, 105, 150, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 90, 56, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 54, 83, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 150, 150, 115, 114, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 112, 128, 150, 150], "policy_policy_0_reward": [-1248.938506837031, -652.1561493941656, -972.1384283744788, -396.36372547484586, -848.1115799816688, -1101.5734686433664, -981.2467568999214, -512.6145677704926, -982.426006059521, -755.1761957333944, -232.90941019491623, -681.8795975175162, -89.33152157181189, -1085.3290892262553, -346.1211634498978, -711.2411129550424, -834.8979501376031, -1183.4698880886522, -1183.9939546236549, -1140.1998954962817, -520.6220300829714, -355.01065725393755, -605.7006162853197, -554.5719565268807, -594.8283873885828, -762.8626853985667, -925.1513441635728, -432.56289537319014, -112.56834382953946, -726.3737192228976, -610.6262738492738, -400.8503845022764, -457.2975705476883, -221.13567971071703, -597.9813925631979, -826.3201277206613, -894.4051748912273, -849.7153590692743, -643.1397222335477, -954.9474347732572, -469.7035670876171, -1117.5039251803496, -645.2610509637133, -622.0971124568235, -1333.4993144039618, -351.1185814459978, -920.349990468193, -1180.5925717852233, -321.31733223496394, -50.02414325674889, -988.6628807231986, -1083.2614114703813, -932.2559769855471, -183.67213065718997, -627.7655101788702, -923.0323846816685, -636.1867515140976, -978.4676753735507, -577.8502648180021, -625.6048454076117, -835.2902838964035, -1000.4970563980902, -814.7915138132853, -909.1796824865658, -173.99694604445918, -122.06705895375013, -87.35977463424396, -419.46448247267654, -731.7574421868752, -874.1269459014238, -484.49333649563096, -720.2005033613788, -488.09584228225344, -718.8861535308031, -562.8433112162961, -203.81443704296547, -886.4858682481531, -1026.878284396443, -717.595188500733, -971.6428846568864, -1148.7356913421706, -506.65452936930177, -223.59970827124982, -758.8517627806096, -847.2537613161319, -833.3996923071861, -636.5456685134527, -799.176383729721, -957.7589923501043, -666.1516388479167, -389.3003465776417, -444.0885305164156, -918.7207899773845, -904.1474332269395, -516.659123193188, -1070.4320894663138, -269.12484888474467, -242.00565917301884, -912.1660697530239, -866.2555600303426]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32527827402558573, "mean_inference_ms": 1.0444662927889643, "mean_action_processing_ms": 0.17811244361080095, "mean_env_wait_ms": 1.7671456665218863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006058692932128906, "StateBufferConnector_ms": 0.004354000091552734, "ViewRequirementAgentConnector_ms": 0.1052701473236084}, "num_episodes": 29, "episode_return_max": -50.02414325674889, "episode_return_min": -1333.4993144039618, "episode_return_mean": -692.1551342105698, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.9181586177639, "num_env_steps_trained_throughput_per_sec": 288.9181586177639, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 15118.336, "restore_workers_time_ms": 0.024, "training_step_time_ms": 15118.266, "sample_time_ms": 2782.08, "learn_time_ms": 12316.595, "learn_throughput": 324.765, "synch_weights_time_ms": 18.721}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "92003_00001", "date": "2024-08-03_04-29-15", "timestamp": 1722639555, "time_this_iter_s": 13.851699113845825, "time_total_s": 208.6352481842041, "pid": 479117, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b580eb5b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 208.6352481842041, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 18.784210526315793, "ram_util_percent": 38.37894736842105}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 164.67050531903902, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.8021782732258242, "policy_loss": -0.010181789695343469, "vf_loss": 3.808292444422841, "vf_explained_var": 0.9793311051403483, "kl": 0.013968603507366133, "entropy": 1.2296876901139815, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -48.637938221799125, "episode_reward_min": -1333.4993144039618, "episode_reward_mean": -658.5191872403782, "episode_len_mean": 137.33, "episode_media": {}, "episodes_timesteps_total": 13733, "policy_reward_min": {"policy_0": -1333.4993144039618}, "policy_reward_max": {"policy_0": -48.637938221799125}, "policy_reward_mean": {"policy_0": -658.5191872403782}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-400.8503845022764, -457.2975705476883, -221.13567971071703, -597.9813925631979, -826.3201277206613, -894.4051748912273, -849.7153590692743, -643.1397222335477, -954.9474347732572, -469.7035670876171, -1117.5039251803496, -645.2610509637133, -622.0971124568235, -1333.4993144039618, -351.1185814459978, -920.349990468193, -1180.5925717852233, -321.31733223496394, -50.02414325674889, -988.6628807231986, -1083.2614114703813, -932.2559769855471, -183.67213065718997, -627.7655101788702, -923.0323846816685, -636.1867515140976, -978.4676753735507, -577.8502648180021, -625.6048454076117, -835.2902838964035, -1000.4970563980902, -814.7915138132853, -909.1796824865658, -173.99694604445918, -122.06705895375013, -87.35977463424396, -419.46448247267654, -731.7574421868752, -874.1269459014238, -484.49333649563096, -720.2005033613788, -488.09584228225344, -718.8861535308031, -562.8433112162961, -203.81443704296547, -886.4858682481531, -1026.878284396443, -717.595188500733, -971.6428846568864, -1148.7356913421706, -506.65452936930177, -223.59970827124982, -758.8517627806096, -847.2537613161319, -833.3996923071861, -636.5456685134527, -799.176383729721, -957.7589923501043, -666.1516388479167, -389.3003465776417, -444.0885305164156, -918.7207899773845, -904.1474332269395, -516.659123193188, -1070.4320894663138, -269.12484888474467, -242.00565917301884, -912.1660697530239, -866.2555600303426, -324.2972640813242, -120.16812322250625, -890.1133730916441, -541.3884024672749, -1060.5107624089762, -110.79711459790923, -194.47831634750605, -654.489525505111, -119.27520802050321, -519.1484162609363, -127.89067849693677, -863.6907601391596, -378.7404305273704, -48.637938221799125, -681.7529333739922, -1058.8227350956001, -442.74831877075593, -1126.486559480675, -807.4485238393252, -804.9071021985842, -127.06599931847742, -658.5948612133582, -279.3289247099585, -855.1369095423184, -890.829670177068, -1065.887037540202, -765.4464720668509, -873.36599531652, -758.6270428343543, -1053.686048094838, -573.6417338242541], "episode_lengths": [150, 150, 105, 150, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 90, 56, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 54, 83, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 150, 150, 115, 114, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 112, 128, 150, 150, 150, 93, 150, 150, 150, 80, 110, 150, 69, 149, 73, 150, 128, 51, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-400.8503845022764, -457.2975705476883, -221.13567971071703, -597.9813925631979, -826.3201277206613, -894.4051748912273, -849.7153590692743, -643.1397222335477, -954.9474347732572, -469.7035670876171, -1117.5039251803496, -645.2610509637133, -622.0971124568235, -1333.4993144039618, -351.1185814459978, -920.349990468193, -1180.5925717852233, -321.31733223496394, -50.02414325674889, -988.6628807231986, -1083.2614114703813, -932.2559769855471, -183.67213065718997, -627.7655101788702, -923.0323846816685, -636.1867515140976, -978.4676753735507, -577.8502648180021, -625.6048454076117, -835.2902838964035, -1000.4970563980902, -814.7915138132853, -909.1796824865658, -173.99694604445918, -122.06705895375013, -87.35977463424396, -419.46448247267654, -731.7574421868752, -874.1269459014238, -484.49333649563096, -720.2005033613788, -488.09584228225344, -718.8861535308031, -562.8433112162961, -203.81443704296547, -886.4858682481531, -1026.878284396443, -717.595188500733, -971.6428846568864, -1148.7356913421706, -506.65452936930177, -223.59970827124982, -758.8517627806096, -847.2537613161319, -833.3996923071861, -636.5456685134527, -799.176383729721, -957.7589923501043, -666.1516388479167, -389.3003465776417, -444.0885305164156, -918.7207899773845, -904.1474332269395, -516.659123193188, -1070.4320894663138, -269.12484888474467, -242.00565917301884, -912.1660697530239, -866.2555600303426, -324.2972640813242, -120.16812322250625, -890.1133730916441, -541.3884024672749, -1060.5107624089762, -110.79711459790923, -194.47831634750605, -654.489525505111, -119.27520802050321, -519.1484162609363, -127.89067849693677, -863.6907601391596, -378.7404305273704, -48.637938221799125, -681.7529333739922, -1058.8227350956001, -442.74831877075593, -1126.486559480675, -807.4485238393252, -804.9071021985842, -127.06599931847742, -658.5948612133582, -279.3289247099585, -855.1369095423184, -890.829670177068, -1065.887037540202, -765.4464720668509, -873.36599531652, -758.6270428343543, -1053.686048094838, -573.6417338242541]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3283340146034396, "mean_inference_ms": 1.0500590311438587, "mean_action_processing_ms": 0.1791822768522578, "mean_env_wait_ms": 1.7785229403666758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007533550262451172, "StateBufferConnector_ms": 0.005247831344604492, "ViewRequirementAgentConnector_ms": 0.1403214931488037}, "num_episodes": 31, "episode_return_max": -48.637938221799125, "episode_return_min": -1333.4993144039618, "episode_return_mean": -658.5191872403782, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 236.78594896368068, "num_env_steps_trained_throughput_per_sec": 236.78594896368068, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 15244.744, "restore_workers_time_ms": 0.024, "training_step_time_ms": 15244.674, "sample_time_ms": 2950.705, "learn_time_ms": 12275.886, "learn_throughput": 325.842, "synch_weights_time_ms": 17.266}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "92003_00001", "date": "2024-08-03_04-29-32", "timestamp": 1722639572, "time_this_iter_s": 16.901726007461548, "time_total_s": 225.53697419166565, "pid": 479117, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c70aef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 225.53697419166565, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 31.72083333333333, "ram_util_percent": 38.39583333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 142.11003406246502, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.687607029577096, "policy_loss": -0.0083539035578724, "vf_loss": 3.691665649910768, "vf_explained_var": 0.9870549882451694, "kl": 0.014733497080957643, "entropy": 1.2475149132311345, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -12.044330844372192, "episode_reward_min": -1200.301266703636, "episode_reward_mean": -647.3833552223255, "episode_len_mean": 135.73, "episode_media": {}, "episodes_timesteps_total": 13573, "policy_reward_min": {"policy_0": -1200.301266703636}, "policy_reward_max": {"policy_0": -12.044330844372192}, "policy_reward_mean": {"policy_0": -647.3833552223255}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-835.2902838964035, -1000.4970563980902, -814.7915138132853, -909.1796824865658, -173.99694604445918, -122.06705895375013, -87.35977463424396, -419.46448247267654, -731.7574421868752, -874.1269459014238, -484.49333649563096, -720.2005033613788, -488.09584228225344, -718.8861535308031, -562.8433112162961, -203.81443704296547, -886.4858682481531, -1026.878284396443, -717.595188500733, -971.6428846568864, -1148.7356913421706, -506.65452936930177, -223.59970827124982, -758.8517627806096, -847.2537613161319, -833.3996923071861, -636.5456685134527, -799.176383729721, -957.7589923501043, -666.1516388479167, -389.3003465776417, -444.0885305164156, -918.7207899773845, -904.1474332269395, -516.659123193188, -1070.4320894663138, -269.12484888474467, -242.00565917301884, -912.1660697530239, -866.2555600303426, -324.2972640813242, -120.16812322250625, -890.1133730916441, -541.3884024672749, -1060.5107624089762, -110.79711459790923, -194.47831634750605, -654.489525505111, -119.27520802050321, -519.1484162609363, -127.89067849693677, -863.6907601391596, -378.7404305273704, -48.637938221799125, -681.7529333739922, -1058.8227350956001, -442.74831877075593, -1126.486559480675, -807.4485238393252, -804.9071021985842, -127.06599931847742, -658.5948612133582, -279.3289247099585, -855.1369095423184, -890.829670177068, -1065.887037540202, -765.4464720668509, -873.36599531652, -758.6270428343543, -1053.686048094838, -573.6417338242541, -937.8980114040539, -875.1231543766053, -229.05255232774917, -910.910854288441, -483.9043510703239, -231.67529092271786, -566.3266744682713, -418.3521449518689, -769.0538780537839, -672.6243596700168, -1070.188645876447, -957.371151384518, -736.5073838602615, -1200.301266703636, -154.15021687181851, -794.2645423966303, -12.044330844372192, -661.3506381336264, -824.603198895554, -653.8518284583079, -746.9576516948142, -1107.3370937045463, -561.4170952650102, -894.3360226081215, -634.1311147345476, -21.729790440311117, -1149.9656368088788, -1003.9385014606225, -21.069683624426524], "episode_lengths": [150, 150, 150, 150, 96, 54, 83, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 150, 150, 115, 114, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 112, 128, 150, 150, 150, 93, 150, 150, 150, 80, 110, 150, 69, 149, 73, 150, 128, 51, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 81, 150, 48, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 49], "policy_policy_0_reward": [-835.2902838964035, -1000.4970563980902, -814.7915138132853, -909.1796824865658, -173.99694604445918, -122.06705895375013, -87.35977463424396, -419.46448247267654, -731.7574421868752, -874.1269459014238, -484.49333649563096, -720.2005033613788, -488.09584228225344, -718.8861535308031, -562.8433112162961, -203.81443704296547, -886.4858682481531, -1026.878284396443, -717.595188500733, -971.6428846568864, -1148.7356913421706, -506.65452936930177, -223.59970827124982, -758.8517627806096, -847.2537613161319, -833.3996923071861, -636.5456685134527, -799.176383729721, -957.7589923501043, -666.1516388479167, -389.3003465776417, -444.0885305164156, -918.7207899773845, -904.1474332269395, -516.659123193188, -1070.4320894663138, -269.12484888474467, -242.00565917301884, -912.1660697530239, -866.2555600303426, -324.2972640813242, -120.16812322250625, -890.1133730916441, -541.3884024672749, -1060.5107624089762, -110.79711459790923, -194.47831634750605, -654.489525505111, -119.27520802050321, -519.1484162609363, -127.89067849693677, -863.6907601391596, -378.7404305273704, -48.637938221799125, -681.7529333739922, -1058.8227350956001, -442.74831877075593, -1126.486559480675, -807.4485238393252, -804.9071021985842, -127.06599931847742, -658.5948612133582, -279.3289247099585, -855.1369095423184, -890.829670177068, -1065.887037540202, -765.4464720668509, -873.36599531652, -758.6270428343543, -1053.686048094838, -573.6417338242541, -937.8980114040539, -875.1231543766053, -229.05255232774917, -910.910854288441, -483.9043510703239, -231.67529092271786, -566.3266744682713, -418.3521449518689, -769.0538780537839, -672.6243596700168, -1070.188645876447, -957.371151384518, -736.5073838602615, -1200.301266703636, -154.15021687181851, -794.2645423966303, -12.044330844372192, -661.3506381336264, -824.603198895554, -653.8518284583079, -746.9576516948142, -1107.3370937045463, -561.4170952650102, -894.3360226081215, -634.1311147345476, -21.729790440311117, -1149.9656368088788, -1003.9385014606225, -21.069683624426524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33097759401303123, "mean_inference_ms": 1.0560207939710509, "mean_action_processing_ms": 0.1802215193298524, "mean_env_wait_ms": 1.7894487853462642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00750422477722168, "StateBufferConnector_ms": 0.005219697952270508, "ViewRequirementAgentConnector_ms": 0.1396622657775879}, "num_episodes": 29, "episode_return_max": -12.044330844372192, "episode_return_min": -1200.301266703636, "episode_return_mean": -647.3833552223255, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.4533126551149, "num_env_steps_trained_throughput_per_sec": 269.4533126551149, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 15011.038, "restore_workers_time_ms": 0.023, "training_step_time_ms": 15010.971, "sample_time_ms": 2792.507, "learn_time_ms": 12200.652, "learn_throughput": 327.851, "synch_weights_time_ms": 17.003}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "92003_00001", "date": "2024-08-03_04-29-47", "timestamp": 1722639587, "time_this_iter_s": 14.84835410118103, "time_total_s": 240.38532829284668, "pid": 479117, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b580e9630>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 240.38532829284668, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 18.58571428571429, "ram_util_percent": 38.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 191.83486980001132, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.396944675097863, "policy_loss": -0.009743129371781834, "vf_loss": 3.4022335125754277, "vf_explained_var": 0.9783632331217329, "kl": 0.015319019052306744, "entropy": 1.4141399135192236, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -12.044330844372192, "episode_reward_min": -1266.802147488606, "episode_reward_mean": -700.4178722912702, "episode_len_mean": 138.68, "episode_media": {}, "episodes_timesteps_total": 13868, "policy_reward_min": {"policy_0": -1266.802147488606}, "policy_reward_max": {"policy_0": -12.044330844372192}, "policy_reward_mean": {"policy_0": -700.4178722912702}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799.176383729721, -957.7589923501043, -666.1516388479167, -389.3003465776417, -444.0885305164156, -918.7207899773845, -904.1474332269395, -516.659123193188, -1070.4320894663138, -269.12484888474467, -242.00565917301884, -912.1660697530239, -866.2555600303426, -324.2972640813242, -120.16812322250625, -890.1133730916441, -541.3884024672749, -1060.5107624089762, -110.79711459790923, -194.47831634750605, -654.489525505111, -119.27520802050321, -519.1484162609363, -127.89067849693677, -863.6907601391596, -378.7404305273704, -48.637938221799125, -681.7529333739922, -1058.8227350956001, -442.74831877075593, -1126.486559480675, -807.4485238393252, -804.9071021985842, -127.06599931847742, -658.5948612133582, -279.3289247099585, -855.1369095423184, -890.829670177068, -1065.887037540202, -765.4464720668509, -873.36599531652, -758.6270428343543, -1053.686048094838, -573.6417338242541, -937.8980114040539, -875.1231543766053, -229.05255232774917, -910.910854288441, -483.9043510703239, -231.67529092271786, -566.3266744682713, -418.3521449518689, -769.0538780537839, -672.6243596700168, -1070.188645876447, -957.371151384518, -736.5073838602615, -1200.301266703636, -154.15021687181851, -794.2645423966303, -12.044330844372192, -661.3506381336264, -824.603198895554, -653.8518284583079, -746.9576516948142, -1107.3370937045463, -561.4170952650102, -894.3360226081215, -634.1311147345476, -21.729790440311117, -1149.9656368088788, -1003.9385014606225, -21.069683624426524, -924.8443003629826, -1030.4942599374433, -1266.802147488606, -1028.9513231690373, -1092.2128225977303, -187.25930393139512, -1007.6968779040092, -733.63233852664, -551.8457905401883, -921.2564068416262, -738.3127086616174, -818.9652953393444, -1007.1173929972625, -743.8137369838735, -1092.924362090369, -966.9857086489479, -1041.8402871899268, -770.1387088841759, -430.96599776803373, -911.530658959795, -860.2222859445718, -918.5405646657715, -777.0648902108031, -775.9589062315307, -977.1910712368712, -639.562777908668, -791.8285922926636], "episode_lengths": [150, 150, 150, 150, 103, 150, 150, 150, 150, 112, 128, 150, 150, 150, 93, 150, 150, 150, 80, 110, 150, 69, 149, 73, 150, 128, 51, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 81, 150, 48, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 49, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-799.176383729721, -957.7589923501043, -666.1516388479167, -389.3003465776417, -444.0885305164156, -918.7207899773845, -904.1474332269395, -516.659123193188, -1070.4320894663138, -269.12484888474467, -242.00565917301884, -912.1660697530239, -866.2555600303426, -324.2972640813242, -120.16812322250625, -890.1133730916441, -541.3884024672749, -1060.5107624089762, -110.79711459790923, -194.47831634750605, -654.489525505111, -119.27520802050321, -519.1484162609363, -127.89067849693677, -863.6907601391596, -378.7404305273704, -48.637938221799125, -681.7529333739922, -1058.8227350956001, -442.74831877075593, -1126.486559480675, -807.4485238393252, -804.9071021985842, -127.06599931847742, -658.5948612133582, -279.3289247099585, -855.1369095423184, -890.829670177068, -1065.887037540202, -765.4464720668509, -873.36599531652, -758.6270428343543, -1053.686048094838, -573.6417338242541, -937.8980114040539, -875.1231543766053, -229.05255232774917, -910.910854288441, -483.9043510703239, -231.67529092271786, -566.3266744682713, -418.3521449518689, -769.0538780537839, -672.6243596700168, -1070.188645876447, -957.371151384518, -736.5073838602615, -1200.301266703636, -154.15021687181851, -794.2645423966303, -12.044330844372192, -661.3506381336264, -824.603198895554, -653.8518284583079, -746.9576516948142, -1107.3370937045463, -561.4170952650102, -894.3360226081215, -634.1311147345476, -21.729790440311117, -1149.9656368088788, -1003.9385014606225, -21.069683624426524, -924.8443003629826, -1030.4942599374433, -1266.802147488606, -1028.9513231690373, -1092.2128225977303, -187.25930393139512, -1007.6968779040092, -733.63233852664, -551.8457905401883, -921.2564068416262, -738.3127086616174, -818.9652953393444, -1007.1173929972625, -743.8137369838735, -1092.924362090369, -966.9857086489479, -1041.8402871899268, -770.1387088841759, -430.96599776803373, -911.530658959795, -860.2222859445718, -918.5405646657715, -777.0648902108031, -775.9589062315307, -977.1910712368712, -639.562777908668, -791.8285922926636]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33302920252072465, "mean_inference_ms": 1.0598546728641116, "mean_action_processing_ms": 0.18091879277594772, "mean_env_wait_ms": 1.7973626343259053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007178306579589844, "StateBufferConnector_ms": 0.005072593688964844, "ViewRequirementAgentConnector_ms": 0.13606834411621094}, "num_episodes": 27, "episode_return_max": -12.044330844372192, "episode_return_min": -1266.802147488606, "episode_return_mean": -700.4178722912702, "episodes_this_iter": 27}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 284.13837945217364, "num_env_steps_trained_throughput_per_sec": 284.13837945217364, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 14924.008, "restore_workers_time_ms": 0.023, "training_step_time_ms": 14923.941, "sample_time_ms": 2750.748, "learn_time_ms": 12155.524, "learn_throughput": 329.068, "synch_weights_time_ms": 16.861}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "92003_00001", "date": "2024-08-03_04-30-01", "timestamp": 1722639601, "time_this_iter_s": 14.084879398345947, "time_total_s": 254.47020769119263, "pid": 479117, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b5814d090>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 254.47020769119263, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 14.533333333333335, "ram_util_percent": 16.161904761904765}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 182.91590326428414, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.794146098693212, "policy_loss": -0.010085048143325063, "vf_loss": 3.8002758574982485, "vf_explained_var": 0.9769494103888671, "kl": 0.013616952234345581, "entropy": 1.2979520636921127, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -12.044330844372192, "episode_reward_min": -1344.6780344170443, "episode_reward_mean": -740.3959267504622, "episode_len_mean": 141.03, "episode_media": {}, "episodes_timesteps_total": 14103, "policy_reward_min": {"policy_0": -1344.6780344170443}, "policy_reward_max": {"policy_0": -12.044330844372192}, "policy_reward_mean": {"policy_0": -740.3959267504622}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1058.8227350956001, -442.74831877075593, -1126.486559480675, -807.4485238393252, -804.9071021985842, -127.06599931847742, -658.5948612133582, -279.3289247099585, -855.1369095423184, -890.829670177068, -1065.887037540202, -765.4464720668509, -873.36599531652, -758.6270428343543, -1053.686048094838, -573.6417338242541, -937.8980114040539, -875.1231543766053, -229.05255232774917, -910.910854288441, -483.9043510703239, -231.67529092271786, -566.3266744682713, -418.3521449518689, -769.0538780537839, -672.6243596700168, -1070.188645876447, -957.371151384518, -736.5073838602615, -1200.301266703636, -154.15021687181851, -794.2645423966303, -12.044330844372192, -661.3506381336264, -824.603198895554, -653.8518284583079, -746.9576516948142, -1107.3370937045463, -561.4170952650102, -894.3360226081215, -634.1311147345476, -21.729790440311117, -1149.9656368088788, -1003.9385014606225, -21.069683624426524, -924.8443003629826, -1030.4942599374433, -1266.802147488606, -1028.9513231690373, -1092.2128225977303, -187.25930393139512, -1007.6968779040092, -733.63233852664, -551.8457905401883, -921.2564068416262, -738.3127086616174, -818.9652953393444, -1007.1173929972625, -743.8137369838735, -1092.924362090369, -966.9857086489479, -1041.8402871899268, -770.1387088841759, -430.96599776803373, -911.530658959795, -860.2222859445718, -918.5405646657715, -777.0648902108031, -775.9589062315307, -977.1910712368712, -639.562777908668, -791.8285922926636, -506.00360919922525, -203.94654214501, -745.1183895368947, -1032.976470299395, -455.678110231029, -664.4856188065334, -1344.6780344170443, -643.7015760380232, -737.1955024373787, -384.42671810124256, -1151.8126884246901, -867.4922619090773, -840.7235476934281, -525.2562817298692, -700.7920168778143, -965.847219844599, -1084.8917357062776, -885.0133799185445, -122.86395427815252, -932.7434060660376, -253.24714057739885, -740.7584747166293, -709.0622001421249, -80.22720552594632, -804.428681622006, -851.8227673960041, -449.24957170160985, -904.7290530669289], "episode_lengths": [150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 81, 150, 48, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 49, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 139, 97, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 66, 150, 120, 150, 150, 58, 150, 150, 150, 150], "policy_policy_0_reward": [-1058.8227350956001, -442.74831877075593, -1126.486559480675, -807.4485238393252, -804.9071021985842, -127.06599931847742, -658.5948612133582, -279.3289247099585, -855.1369095423184, -890.829670177068, -1065.887037540202, -765.4464720668509, -873.36599531652, -758.6270428343543, -1053.686048094838, -573.6417338242541, -937.8980114040539, -875.1231543766053, -229.05255232774917, -910.910854288441, -483.9043510703239, -231.67529092271786, -566.3266744682713, -418.3521449518689, -769.0538780537839, -672.6243596700168, -1070.188645876447, -957.371151384518, -736.5073838602615, -1200.301266703636, -154.15021687181851, -794.2645423966303, -12.044330844372192, -661.3506381336264, -824.603198895554, -653.8518284583079, -746.9576516948142, -1107.3370937045463, -561.4170952650102, -894.3360226081215, -634.1311147345476, -21.729790440311117, -1149.9656368088788, -1003.9385014606225, -21.069683624426524, -924.8443003629826, -1030.4942599374433, -1266.802147488606, -1028.9513231690373, -1092.2128225977303, -187.25930393139512, -1007.6968779040092, -733.63233852664, -551.8457905401883, -921.2564068416262, -738.3127086616174, -818.9652953393444, -1007.1173929972625, -743.8137369838735, -1092.924362090369, -966.9857086489479, -1041.8402871899268, -770.1387088841759, -430.96599776803373, -911.530658959795, -860.2222859445718, -918.5405646657715, -777.0648902108031, -775.9589062315307, -977.1910712368712, -639.562777908668, -791.8285922926636, -506.00360919922525, -203.94654214501, -745.1183895368947, -1032.976470299395, -455.678110231029, -664.4856188065334, -1344.6780344170443, -643.7015760380232, -737.1955024373787, -384.42671810124256, -1151.8126884246901, -867.4922619090773, -840.7235476934281, -525.2562817298692, -700.7920168778143, -965.847219844599, -1084.8917357062776, -885.0133799185445, -122.86395427815252, -932.7434060660376, -253.24714057739885, -740.7584747166293, -709.0622001421249, -80.22720552594632, -804.428681622006, -851.8227673960041, -449.24957170160985, -904.7290530669289]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33253212148988714, "mean_inference_ms": 1.0569523771515836, "mean_action_processing_ms": 0.18065675163174585, "mean_env_wait_ms": 1.7955459313949433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006292104721069336, "StateBufferConnector_ms": 0.004575014114379883, "ViewRequirementAgentConnector_ms": 0.1137998104095459}, "num_episodes": 28, "episode_return_max": -12.044330844372192, "episode_return_min": -1344.6780344170443, "episode_return_mean": -740.3959267504622, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 282.3788349176046, "num_env_steps_trained_throughput_per_sec": 282.3788349176046, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 14864.125, "restore_workers_time_ms": 0.023, "training_step_time_ms": 14864.058, "sample_time_ms": 2692.452, "learn_time_ms": 12154.259, "learn_throughput": 329.103, "synch_weights_time_ms": 16.553}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "92003_00001", "date": "2024-08-03_04-30-16", "timestamp": 1722639616, "time_this_iter_s": 14.172666072845459, "time_total_s": 268.6428737640381, "pid": 479117, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c7aa560>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 268.6428737640381, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 12.665000000000003, "ram_util_percent": 16.110000000000007}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 203.90692330002784, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.500771896044413, "policy_loss": -0.011403346011502436, "vf_loss": 3.5082639286915462, "vf_explained_var": 0.978483349767824, "kl": 0.013525986353730956, "entropy": 1.4645816557109357, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -12.044330844372192, "episode_reward_min": -1344.6780344170443, "episode_reward_mean": -750.8365964391797, "episode_len_mean": 139.22, "episode_media": {}, "episodes_timesteps_total": 13922, "policy_reward_min": {"policy_0": -1344.6780344170443}, "policy_reward_max": {"policy_0": -12.044330844372192}, "policy_reward_mean": {"policy_0": -750.8365964391797}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154.15021687181851, -794.2645423966303, -12.044330844372192, -661.3506381336264, -824.603198895554, -653.8518284583079, -746.9576516948142, -1107.3370937045463, -561.4170952650102, -894.3360226081215, -634.1311147345476, -21.729790440311117, -1149.9656368088788, -1003.9385014606225, -21.069683624426524, -924.8443003629826, -1030.4942599374433, -1266.802147488606, -1028.9513231690373, -1092.2128225977303, -187.25930393139512, -1007.6968779040092, -733.63233852664, -551.8457905401883, -921.2564068416262, -738.3127086616174, -818.9652953393444, -1007.1173929972625, -743.8137369838735, -1092.924362090369, -966.9857086489479, -1041.8402871899268, -770.1387088841759, -430.96599776803373, -911.530658959795, -860.2222859445718, -918.5405646657715, -777.0648902108031, -775.9589062315307, -977.1910712368712, -639.562777908668, -791.8285922926636, -506.00360919922525, -203.94654214501, -745.1183895368947, -1032.976470299395, -455.678110231029, -664.4856188065334, -1344.6780344170443, -643.7015760380232, -737.1955024373787, -384.42671810124256, -1151.8126884246901, -867.4922619090773, -840.7235476934281, -525.2562817298692, -700.7920168778143, -965.847219844599, -1084.8917357062776, -885.0133799185445, -122.86395427815252, -932.7434060660376, -253.24714057739885, -740.7584747166293, -709.0622001421249, -80.22720552594632, -804.428681622006, -851.8227673960041, -449.24957170160985, -904.7290530669289, -780.112891034896, -616.082316231556, -1296.6045033907972, -627.5219145667368, -884.697554266919, -511.64715163317277, -1022.9792940833969, -1052.9031194941724, -940.5298475851476, -66.39490983065535, -932.2743898442648, -868.4490143779543, -766.3162114250758, -217.2662903269189, -787.7276373264732, -802.3627531036868, -816.3497062728002, -832.3389244140255, -1181.8567494184538, -1016.5741212381821, -955.8773773949843, -919.8545525447224, -979.3494055280637, -943.5224801716997, -337.6897230294765, -252.26965646368234, -231.43046427855236, -965.2613517083371, -977.3898304743091, -661.7464807944642], "episode_lengths": [81, 150, 48, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 49, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 139, 97, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 66, 150, 120, 150, 150, 58, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 77, 74, 150, 150, 137], "policy_policy_0_reward": [-154.15021687181851, -794.2645423966303, -12.044330844372192, -661.3506381336264, -824.603198895554, -653.8518284583079, -746.9576516948142, -1107.3370937045463, -561.4170952650102, -894.3360226081215, -634.1311147345476, -21.729790440311117, -1149.9656368088788, -1003.9385014606225, -21.069683624426524, -924.8443003629826, -1030.4942599374433, -1266.802147488606, -1028.9513231690373, -1092.2128225977303, -187.25930393139512, -1007.6968779040092, -733.63233852664, -551.8457905401883, -921.2564068416262, -738.3127086616174, -818.9652953393444, -1007.1173929972625, -743.8137369838735, -1092.924362090369, -966.9857086489479, -1041.8402871899268, -770.1387088841759, -430.96599776803373, -911.530658959795, -860.2222859445718, -918.5405646657715, -777.0648902108031, -775.9589062315307, -977.1910712368712, -639.562777908668, -791.8285922926636, -506.00360919922525, -203.94654214501, -745.1183895368947, -1032.976470299395, -455.678110231029, -664.4856188065334, -1344.6780344170443, -643.7015760380232, -737.1955024373787, -384.42671810124256, -1151.8126884246901, -867.4922619090773, -840.7235476934281, -525.2562817298692, -700.7920168778143, -965.847219844599, -1084.8917357062776, -885.0133799185445, -122.86395427815252, -932.7434060660376, -253.24714057739885, -740.7584747166293, -709.0622001421249, -80.22720552594632, -804.428681622006, -851.8227673960041, -449.24957170160985, -904.7290530669289, -780.112891034896, -616.082316231556, -1296.6045033907972, -627.5219145667368, -884.697554266919, -511.64715163317277, -1022.9792940833969, -1052.9031194941724, -940.5298475851476, -66.39490983065535, -932.2743898442648, -868.4490143779543, -766.3162114250758, -217.2662903269189, -787.7276373264732, -802.3627531036868, -816.3497062728002, -832.3389244140255, -1181.8567494184538, -1016.5741212381821, -955.8773773949843, -919.8545525447224, -979.3494055280637, -943.5224801716997, -337.6897230294765, -252.26965646368234, -231.43046427855236, -965.2613517083371, -977.3898304743091, -661.7464807944642]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3290586550757535, "mean_inference_ms": 1.044988868832209, "mean_action_processing_ms": 0.17902193834237023, "mean_env_wait_ms": 1.7779831805839053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005227804183959961, "StateBufferConnector_ms": 0.003994464874267578, "ViewRequirementAgentConnector_ms": 0.09622955322265625}, "num_episodes": 30, "episode_return_max": -12.044330844372192, "episode_return_min": -1344.6780344170443, "episode_return_mean": -750.8365964391797, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.4075611294159, "num_env_steps_trained_throughput_per_sec": 281.4075611294159, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 14799.159, "restore_workers_time_ms": 0.023, "training_step_time_ms": 14799.093, "sample_time_ms": 2661.736, "learn_time_ms": 12120.109, "learn_throughput": 330.03, "synch_weights_time_ms": 16.468}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "92003_00001", "date": "2024-08-03_04-30-30", "timestamp": 1722639630, "time_this_iter_s": 14.221815347671509, "time_total_s": 282.8646891117096, "pid": 479117, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8ad3d90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 282.8646891117096, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 12.495000000000001, "ram_util_percent": 16.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 163.12780680060388, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.4569626806924743, "policy_loss": -0.010545246337035982, "vf_loss": 3.4631009315450987, "vf_explained_var": 0.9800563257808487, "kl": 0.015086710152839581, "entropy": 1.1901777969052394, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -25.87370996628636, "episode_reward_min": -1344.6780344170443, "episode_reward_mean": -715.4535156757718, "episode_len_mean": 139.84, "episode_media": {}, "episodes_timesteps_total": 13984, "policy_reward_min": {"policy_0": -1344.6780344170443}, "policy_reward_max": {"policy_0": -25.87370996628636}, "policy_reward_mean": {"policy_0": -715.4535156757718}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-966.9857086489479, -1041.8402871899268, -770.1387088841759, -430.96599776803373, -911.530658959795, -860.2222859445718, -918.5405646657715, -777.0648902108031, -775.9589062315307, -977.1910712368712, -639.562777908668, -791.8285922926636, -506.00360919922525, -203.94654214501, -745.1183895368947, -1032.976470299395, -455.678110231029, -664.4856188065334, -1344.6780344170443, -643.7015760380232, -737.1955024373787, -384.42671810124256, -1151.8126884246901, -867.4922619090773, -840.7235476934281, -525.2562817298692, -700.7920168778143, -965.847219844599, -1084.8917357062776, -885.0133799185445, -122.86395427815252, -932.7434060660376, -253.24714057739885, -740.7584747166293, -709.0622001421249, -80.22720552594632, -804.428681622006, -851.8227673960041, -449.24957170160985, -904.7290530669289, -780.112891034896, -616.082316231556, -1296.6045033907972, -627.5219145667368, -884.697554266919, -511.64715163317277, -1022.9792940833969, -1052.9031194941724, -940.5298475851476, -66.39490983065535, -932.2743898442648, -868.4490143779543, -766.3162114250758, -217.2662903269189, -787.7276373264732, -802.3627531036868, -816.3497062728002, -832.3389244140255, -1181.8567494184538, -1016.5741212381821, -955.8773773949843, -919.8545525447224, -979.3494055280637, -943.5224801716997, -337.6897230294765, -252.26965646368234, -231.43046427855236, -965.2613517083371, -977.3898304743091, -661.7464807944642, -682.9902992831805, -493.82338560150407, -687.661116611806, -955.1787527412857, -217.356264066016, -705.7686826741981, -821.3829996171447, -435.8213500626564, -663.7627564336968, -372.9741368622617, -1233.919878382164, -718.8404252668149, -872.7038713578253, -25.87370996628636, -873.4636221009014, -836.5811316290442, -872.1665090841359, -916.723267007845, -447.34577297505984, -740.6033249093881, -78.66543068731497, -402.19999818348305, -325.076817281244, -1120.4400699572445, -207.54192846107458, -810.6692749348464, -753.7927051317544, -618.9075427640898, -883.4561912350389, -73.27712170363532], "episode_lengths": [150, 150, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 139, 97, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 66, 150, 120, 150, 150, 58, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 77, 74, 150, 150, 137, 150, 150, 150, 150, 122, 150, 150, 123, 150, 150, 150, 150, 150, 53, 150, 150, 150, 150, 150, 142, 62, 150, 149, 150, 116, 150, 150, 150, 150, 85], "policy_policy_0_reward": [-966.9857086489479, -1041.8402871899268, -770.1387088841759, -430.96599776803373, -911.530658959795, -860.2222859445718, -918.5405646657715, -777.0648902108031, -775.9589062315307, -977.1910712368712, -639.562777908668, -791.8285922926636, -506.00360919922525, -203.94654214501, -745.1183895368947, -1032.976470299395, -455.678110231029, -664.4856188065334, -1344.6780344170443, -643.7015760380232, -737.1955024373787, -384.42671810124256, -1151.8126884246901, -867.4922619090773, -840.7235476934281, -525.2562817298692, -700.7920168778143, -965.847219844599, -1084.8917357062776, -885.0133799185445, -122.86395427815252, -932.7434060660376, -253.24714057739885, -740.7584747166293, -709.0622001421249, -80.22720552594632, -804.428681622006, -851.8227673960041, -449.24957170160985, -904.7290530669289, -780.112891034896, -616.082316231556, -1296.6045033907972, -627.5219145667368, -884.697554266919, -511.64715163317277, -1022.9792940833969, -1052.9031194941724, -940.5298475851476, -66.39490983065535, -932.2743898442648, -868.4490143779543, -766.3162114250758, -217.2662903269189, -787.7276373264732, -802.3627531036868, -816.3497062728002, -832.3389244140255, -1181.8567494184538, -1016.5741212381821, -955.8773773949843, -919.8545525447224, -979.3494055280637, -943.5224801716997, -337.6897230294765, -252.26965646368234, -231.43046427855236, -965.2613517083371, -977.3898304743091, -661.7464807944642, -682.9902992831805, -493.82338560150407, -687.661116611806, -955.1787527412857, -217.356264066016, -705.7686826741981, -821.3829996171447, -435.8213500626564, -663.7627564336968, -372.9741368622617, -1233.919878382164, -718.8404252668149, -872.7038713578253, -25.87370996628636, -873.4636221009014, -836.5811316290442, -872.1665090841359, -916.723267007845, -447.34577297505984, -740.6033249093881, -78.66543068731497, -402.19999818348305, -325.076817281244, -1120.4400699572445, -207.54192846107458, -810.6692749348464, -753.7927051317544, -618.9075427640898, -883.4561912350389, -73.27712170363532]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32578441139207387, "mean_inference_ms": 1.0340976635774395, "mean_action_processing_ms": 0.17757142711469548, "mean_env_wait_ms": 1.763401210183976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005234718322753906, "StateBufferConnector_ms": 0.003920078277587891, "ViewRequirementAgentConnector_ms": 0.0943303108215332}, "num_episodes": 30, "episode_return_max": -25.87370996628636, "episode_return_min": -1344.6780344170443, "episode_return_mean": -715.4535156757718, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 279.03693994371434, "num_env_steps_trained_throughput_per_sec": 279.03693994371434, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 14756.343, "restore_workers_time_ms": 0.023, "training_step_time_ms": 14756.277, "sample_time_ms": 2638.008, "learn_time_ms": 12101.362, "learn_throughput": 330.541, "synch_weights_time_ms": 16.173}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "92003_00001", "date": "2024-08-03_04-30-44", "timestamp": 1722639644, "time_this_iter_s": 14.343239784240723, "time_total_s": 297.2079288959503, "pid": 479117, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b580ebb50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 297.2079288959503, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 12.640000000000002, "ram_util_percent": 16.115000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 208.27743035356204, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.377338456114133, "policy_loss": -0.010912247533754756, "vf_loss": 3.383788935591777, "vf_explained_var": 0.9879528764635325, "kl": 0.015423042759690982, "entropy": 1.651432366296649, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -25.87370996628636, "episode_reward_min": -1296.6045033907972, "episode_reward_mean": -728.9767983417929, "episode_len_mean": 139.65, "episode_media": {}, "episodes_timesteps_total": 13965, "policy_reward_min": {"policy_0": -1296.6045033907972}, "policy_reward_max": {"policy_0": -25.87370996628636}, "policy_reward_mean": {"policy_0": -728.9767983417929}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-525.2562817298692, -700.7920168778143, -965.847219844599, -1084.8917357062776, -885.0133799185445, -122.86395427815252, -932.7434060660376, -253.24714057739885, -740.7584747166293, -709.0622001421249, -80.22720552594632, -804.428681622006, -851.8227673960041, -449.24957170160985, -904.7290530669289, -780.112891034896, -616.082316231556, -1296.6045033907972, -627.5219145667368, -884.697554266919, -511.64715163317277, -1022.9792940833969, -1052.9031194941724, -940.5298475851476, -66.39490983065535, -932.2743898442648, -868.4490143779543, -766.3162114250758, -217.2662903269189, -787.7276373264732, -802.3627531036868, -816.3497062728002, -832.3389244140255, -1181.8567494184538, -1016.5741212381821, -955.8773773949843, -919.8545525447224, -979.3494055280637, -943.5224801716997, -337.6897230294765, -252.26965646368234, -231.43046427855236, -965.2613517083371, -977.3898304743091, -661.7464807944642, -682.9902992831805, -493.82338560150407, -687.661116611806, -955.1787527412857, -217.356264066016, -705.7686826741981, -821.3829996171447, -435.8213500626564, -663.7627564336968, -372.9741368622617, -1233.919878382164, -718.8404252668149, -872.7038713578253, -25.87370996628636, -873.4636221009014, -836.5811316290442, -872.1665090841359, -916.723267007845, -447.34577297505984, -740.6033249093881, -78.66543068731497, -402.19999818348305, -325.076817281244, -1120.4400699572445, -207.54192846107458, -810.6692749348464, -753.7927051317544, -618.9075427640898, -883.4561912350389, -73.27712170363532, -909.8866492991137, -1098.808127377072, -351.13928140111636, -612.6907871722397, -1067.8463159151313, -1035.646163074013, -468.01687492287385, -845.9301245535311, -1000.5054461488209, -326.2437574674515, -934.921862634394, -703.9920028665338, -1147.206240136553, -1049.5462159644726, -338.87689191542086, -940.7323532079528, -1232.9992838379724, -836.6392260042326, -765.3982411636308, -1104.7680934081252, -704.6810977336035, -942.1457166387323, -442.62492356847775, -1274.157965035881, -656.9941443354905], "episode_lengths": [150, 150, 150, 150, 150, 66, 150, 120, 150, 150, 58, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 77, 74, 150, 150, 137, 150, 150, 150, 150, 122, 150, 150, 123, 150, 150, 150, 150, 150, 53, 150, 150, 150, 150, 150, 142, 62, 150, 149, 150, 116, 150, 150, 150, 150, 85, 150, 150, 105, 150, 150, 150, 150, 150, 150, 89, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-525.2562817298692, -700.7920168778143, -965.847219844599, -1084.8917357062776, -885.0133799185445, -122.86395427815252, -932.7434060660376, -253.24714057739885, -740.7584747166293, -709.0622001421249, -80.22720552594632, -804.428681622006, -851.8227673960041, -449.24957170160985, -904.7290530669289, -780.112891034896, -616.082316231556, -1296.6045033907972, -627.5219145667368, -884.697554266919, -511.64715163317277, -1022.9792940833969, -1052.9031194941724, -940.5298475851476, -66.39490983065535, -932.2743898442648, -868.4490143779543, -766.3162114250758, -217.2662903269189, -787.7276373264732, -802.3627531036868, -816.3497062728002, -832.3389244140255, -1181.8567494184538, -1016.5741212381821, -955.8773773949843, -919.8545525447224, -979.3494055280637, -943.5224801716997, -337.6897230294765, -252.26965646368234, -231.43046427855236, -965.2613517083371, -977.3898304743091, -661.7464807944642, -682.9902992831805, -493.82338560150407, -687.661116611806, -955.1787527412857, -217.356264066016, -705.7686826741981, -821.3829996171447, -435.8213500626564, -663.7627564336968, -372.9741368622617, -1233.919878382164, -718.8404252668149, -872.7038713578253, -25.87370996628636, -873.4636221009014, -836.5811316290442, -872.1665090841359, -916.723267007845, -447.34577297505984, -740.6033249093881, -78.66543068731497, -402.19999818348305, -325.076817281244, -1120.4400699572445, -207.54192846107458, -810.6692749348464, -753.7927051317544, -618.9075427640898, -883.4561912350389, -73.27712170363532, -909.8866492991137, -1098.808127377072, -351.13928140111636, -612.6907871722397, -1067.8463159151313, -1035.646163074013, -468.01687492287385, -845.9301245535311, -1000.5054461488209, -326.2437574674515, -934.921862634394, -703.9920028665338, -1147.206240136553, -1049.5462159644726, -338.87689191542086, -940.7323532079528, -1232.9992838379724, -836.6392260042326, -765.3982411636308, -1104.7680934081252, -704.6810977336035, -942.1457166387323, -442.62492356847775, -1274.157965035881, -656.9941443354905]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3237134476471008, "mean_inference_ms": 1.026372724419978, "mean_action_processing_ms": 0.1765713646830944, "mean_env_wait_ms": 1.7536478152776442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0053517818450927734, "StateBufferConnector_ms": 0.003955841064453125, "ViewRequirementAgentConnector_ms": 0.09487533569335938}, "num_episodes": 25, "episode_return_max": -25.87370996628636, "episode_return_min": -1296.6045033907972, "episode_return_mean": -728.9767983417929, "episodes_this_iter": 25}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 275.3785421374874, "num_env_steps_trained_throughput_per_sec": 275.3785421374874, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 14694.192, "restore_workers_time_ms": 0.023, "training_step_time_ms": 14694.126, "sample_time_ms": 2617.786, "learn_time_ms": 12060.309, "learn_throughput": 331.666, "synch_weights_time_ms": 15.298}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "92003_00001", "date": "2024-08-03_04-30-59", "timestamp": 1722639659, "time_this_iter_s": 14.532151460647583, "time_total_s": 311.7400803565979, "pid": 479117, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b580eb6d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 311.7400803565979, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 12.428571428571429, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 168.31911308566728, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.807992849126458, "policy_loss": -0.009205955039942638, "vf_loss": 3.8130335540821156, "vf_explained_var": 0.971421581444641, "kl": 0.014322625828875384, "entropy": 1.3155083927015463, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -0.4327053036267988, "episode_reward_min": -1274.157965035881, "episode_reward_mean": -702.9541703082228, "episode_len_mean": 138.85, "episode_media": {}, "episodes_timesteps_total": 13885, "policy_reward_min": {"policy_0": -1274.157965035881}, "policy_reward_max": {"policy_0": -0.4327053036267988}, "policy_reward_mean": {"policy_0": -702.9541703082228}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-816.3497062728002, -832.3389244140255, -1181.8567494184538, -1016.5741212381821, -955.8773773949843, -919.8545525447224, -979.3494055280637, -943.5224801716997, -337.6897230294765, -252.26965646368234, -231.43046427855236, -965.2613517083371, -977.3898304743091, -661.7464807944642, -682.9902992831805, -493.82338560150407, -687.661116611806, -955.1787527412857, -217.356264066016, -705.7686826741981, -821.3829996171447, -435.8213500626564, -663.7627564336968, -372.9741368622617, -1233.919878382164, -718.8404252668149, -872.7038713578253, -25.87370996628636, -873.4636221009014, -836.5811316290442, -872.1665090841359, -916.723267007845, -447.34577297505984, -740.6033249093881, -78.66543068731497, -402.19999818348305, -325.076817281244, -1120.4400699572445, -207.54192846107458, -810.6692749348464, -753.7927051317544, -618.9075427640898, -883.4561912350389, -73.27712170363532, -909.8866492991137, -1098.808127377072, -351.13928140111636, -612.6907871722397, -1067.8463159151313, -1035.646163074013, -468.01687492287385, -845.9301245535311, -1000.5054461488209, -326.2437574674515, -934.921862634394, -703.9920028665338, -1147.206240136553, -1049.5462159644726, -338.87689191542086, -940.7323532079528, -1232.9992838379724, -836.6392260042326, -765.3982411636308, -1104.7680934081252, -704.6810977336035, -942.1457166387323, -442.62492356847775, -1274.157965035881, -656.9941443354905, -584.4451179523327, -1085.7455561926688, -823.8054621206062, -450.2922144630079, -850.1268229614786, -870.2195894727276, -916.8589565348705, -782.6882944403499, -1264.5355628725042, -307.46977663768286, -647.5190833428352, -845.0786250106843, -471.59936156434577, -945.8601555646308, -280.7157433997584, -393.1938910431419, -1011.0962360278453, -204.25043905128823, -540.2672980022037, -322.3196778597892, -539.5854065371734, -283.8581415866972, -423.36559094164255, -0.4327053036267988, -877.1207442979343, -422.0013005494952, -462.2996868353408, -776.156716501622, -1001.7780670457956, -868.1012732790648, -329.75258694160465], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 77, 74, 150, 150, 137, 150, 150, 150, 150, 122, 150, 150, 123, 150, 150, 150, 150, 150, 53, 150, 150, 150, 150, 150, 142, 62, 150, 149, 150, 116, 150, 150, 150, 150, 85, 150, 150, 105, 150, 150, 150, 150, 150, 150, 89, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 150, 89, 150, 150, 150, 150, 88, 150, 150, 98, 150, 143, 150, 122, 150, 40, 150, 111, 150, 150, 150, 150, 96], "policy_policy_0_reward": [-816.3497062728002, -832.3389244140255, -1181.8567494184538, -1016.5741212381821, -955.8773773949843, -919.8545525447224, -979.3494055280637, -943.5224801716997, -337.6897230294765, -252.26965646368234, -231.43046427855236, -965.2613517083371, -977.3898304743091, -661.7464807944642, -682.9902992831805, -493.82338560150407, -687.661116611806, -955.1787527412857, -217.356264066016, -705.7686826741981, -821.3829996171447, -435.8213500626564, -663.7627564336968, -372.9741368622617, -1233.919878382164, -718.8404252668149, -872.7038713578253, -25.87370996628636, -873.4636221009014, -836.5811316290442, -872.1665090841359, -916.723267007845, -447.34577297505984, -740.6033249093881, -78.66543068731497, -402.19999818348305, -325.076817281244, -1120.4400699572445, -207.54192846107458, -810.6692749348464, -753.7927051317544, -618.9075427640898, -883.4561912350389, -73.27712170363532, -909.8866492991137, -1098.808127377072, -351.13928140111636, -612.6907871722397, -1067.8463159151313, -1035.646163074013, -468.01687492287385, -845.9301245535311, -1000.5054461488209, -326.2437574674515, -934.921862634394, -703.9920028665338, -1147.206240136553, -1049.5462159644726, -338.87689191542086, -940.7323532079528, -1232.9992838379724, -836.6392260042326, -765.3982411636308, -1104.7680934081252, -704.6810977336035, -942.1457166387323, -442.62492356847775, -1274.157965035881, -656.9941443354905, -584.4451179523327, -1085.7455561926688, -823.8054621206062, -450.2922144630079, -850.1268229614786, -870.2195894727276, -916.8589565348705, -782.6882944403499, -1264.5355628725042, -307.46977663768286, -647.5190833428352, -845.0786250106843, -471.59936156434577, -945.8601555646308, -280.7157433997584, -393.1938910431419, -1011.0962360278453, -204.25043905128823, -540.2672980022037, -322.3196778597892, -539.5854065371734, -283.8581415866972, -423.36559094164255, -0.4327053036267988, -877.1207442979343, -422.0013005494952, -462.2996868353408, -776.156716501622, -1001.7780670457956, -868.1012732790648, -329.75258694160465]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3212849798299097, "mean_inference_ms": 1.017700786698979, "mean_action_processing_ms": 0.1754247948318822, "mean_env_wait_ms": 1.742485451833614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005385637283325195, "StateBufferConnector_ms": 0.004076480865478516, "ViewRequirementAgentConnector_ms": 0.09881591796875}, "num_episodes": 31, "episode_return_max": -0.4327053036267988, "episode_return_min": -1274.157965035881, "episode_return_mean": -702.9541703082228, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 279.7390998362771, "num_env_steps_trained_throughput_per_sec": 279.7390998362771, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 14667.997, "restore_workers_time_ms": 0.022, "training_step_time_ms": 14667.934, "sample_time_ms": 2597.235, "learn_time_ms": 12054.808, "learn_throughput": 331.818, "synch_weights_time_ms": 15.157}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "92003_00001", "date": "2024-08-03_04-31-13", "timestamp": 1722639673, "time_this_iter_s": 14.30841851234436, "time_total_s": 326.04849886894226, "pid": 479117, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b5814d510>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 326.04849886894226, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 12.566666666666666, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 260.33117069005965, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.461785943433642, "policy_loss": -0.013012616709359767, "vf_loss": 3.469868696605166, "vf_explained_var": 0.9834811499963204, "kl": 0.01690591041403119, "entropy": 1.4190976900358996, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -0.4327053036267988, "episode_reward_min": -1274.157965035881, "episode_reward_mean": -710.9459413323764, "episode_len_mean": 139.27, "episode_media": {}, "episodes_timesteps_total": 13927, "policy_reward_min": {"policy_0": -1274.157965035881}, "policy_reward_max": {"policy_0": -0.4327053036267988}, "policy_reward_mean": {"policy_0": -710.9459413323764}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-873.4636221009014, -836.5811316290442, -872.1665090841359, -916.723267007845, -447.34577297505984, -740.6033249093881, -78.66543068731497, -402.19999818348305, -325.076817281244, -1120.4400699572445, -207.54192846107458, -810.6692749348464, -753.7927051317544, -618.9075427640898, -883.4561912350389, -73.27712170363532, -909.8866492991137, -1098.808127377072, -351.13928140111636, -612.6907871722397, -1067.8463159151313, -1035.646163074013, -468.01687492287385, -845.9301245535311, -1000.5054461488209, -326.2437574674515, -934.921862634394, -703.9920028665338, -1147.206240136553, -1049.5462159644726, -338.87689191542086, -940.7323532079528, -1232.9992838379724, -836.6392260042326, -765.3982411636308, -1104.7680934081252, -704.6810977336035, -942.1457166387323, -442.62492356847775, -1274.157965035881, -656.9941443354905, -584.4451179523327, -1085.7455561926688, -823.8054621206062, -450.2922144630079, -850.1268229614786, -870.2195894727276, -916.8589565348705, -782.6882944403499, -1264.5355628725042, -307.46977663768286, -647.5190833428352, -845.0786250106843, -471.59936156434577, -945.8601555646308, -280.7157433997584, -393.1938910431419, -1011.0962360278453, -204.25043905128823, -540.2672980022037, -322.3196778597892, -539.5854065371734, -283.8581415866972, -423.36559094164255, -0.4327053036267988, -877.1207442979343, -422.0013005494952, -462.2996868353408, -776.156716501622, -1001.7780670457956, -868.1012732790648, -329.75258694160465, -811.72654405282, -1020.261903921065, -1097.5624479365586, -647.5574486663954, -137.3302752169592, -737.6638812723561, -602.6933281531346, -1051.5442833479808, -275.8953707640231, -450.49579648648347, -719.9114558541123, -420.6638563460147, -905.1635438811173, -899.398660888949, -1194.096344891508, -846.6963376110751, -756.8251180466788, -523.6867174541435, -1059.3319192577626, -744.5571432236655, -568.0884188562688, -1078.7802151885276, -29.263883026720322, -804.9653611748936, -1210.350532497095, -417.4280694129703, -1000.3397879371795, -746.4669097074915], "episode_lengths": [150, 150, 150, 150, 150, 142, 62, 150, 149, 150, 116, 150, 150, 150, 150, 85, 150, 150, 105, 150, 150, 150, 150, 150, 150, 89, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 150, 89, 150, 150, 150, 150, 88, 150, 150, 98, 150, 143, 150, 122, 150, 40, 150, 111, 150, 150, 150, 150, 96, 150, 150, 150, 150, 88, 150, 150, 150, 116, 131, 150, 121, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 36, 150, 150, 136, 150, 150], "policy_policy_0_reward": [-873.4636221009014, -836.5811316290442, -872.1665090841359, -916.723267007845, -447.34577297505984, -740.6033249093881, -78.66543068731497, -402.19999818348305, -325.076817281244, -1120.4400699572445, -207.54192846107458, -810.6692749348464, -753.7927051317544, -618.9075427640898, -883.4561912350389, -73.27712170363532, -909.8866492991137, -1098.808127377072, -351.13928140111636, -612.6907871722397, -1067.8463159151313, -1035.646163074013, -468.01687492287385, -845.9301245535311, -1000.5054461488209, -326.2437574674515, -934.921862634394, -703.9920028665338, -1147.206240136553, -1049.5462159644726, -338.87689191542086, -940.7323532079528, -1232.9992838379724, -836.6392260042326, -765.3982411636308, -1104.7680934081252, -704.6810977336035, -942.1457166387323, -442.62492356847775, -1274.157965035881, -656.9941443354905, -584.4451179523327, -1085.7455561926688, -823.8054621206062, -450.2922144630079, -850.1268229614786, -870.2195894727276, -916.8589565348705, -782.6882944403499, -1264.5355628725042, -307.46977663768286, -647.5190833428352, -845.0786250106843, -471.59936156434577, -945.8601555646308, -280.7157433997584, -393.1938910431419, -1011.0962360278453, -204.25043905128823, -540.2672980022037, -322.3196778597892, -539.5854065371734, -283.8581415866972, -423.36559094164255, -0.4327053036267988, -877.1207442979343, -422.0013005494952, -462.2996868353408, -776.156716501622, -1001.7780670457956, -868.1012732790648, -329.75258694160465, -811.72654405282, -1020.261903921065, -1097.5624479365586, -647.5574486663954, -137.3302752169592, -737.6638812723561, -602.6933281531346, -1051.5442833479808, -275.8953707640231, -450.49579648648347, -719.9114558541123, -420.6638563460147, -905.1635438811173, -899.398660888949, -1194.096344891508, -846.6963376110751, -756.8251180466788, -523.6867174541435, -1059.3319192577626, -744.5571432236655, -568.0884188562688, -1078.7802151885276, -29.263883026720322, -804.9653611748936, -1210.350532497095, -417.4280694129703, -1000.3397879371795, -746.4669097074915]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3195048405076605, "mean_inference_ms": 1.0108306878481121, "mean_action_processing_ms": 0.17457378436485482, "mean_env_wait_ms": 1.7353837801342025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005483865737915039, "StateBufferConnector_ms": 0.0041120052337646484, "ViewRequirementAgentConnector_ms": 0.09887433052062988}, "num_episodes": 28, "episode_return_max": -0.4327053036267988, "episode_return_min": -1274.157965035881, "episode_return_mean": -710.9459413323764, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.4099353620922, "num_env_steps_trained_throughput_per_sec": 281.4099353620922, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 14541.357, "restore_workers_time_ms": 0.022, "training_step_time_ms": 14541.294, "sample_time_ms": 2552.36, "learn_time_ms": 11973.139, "learn_throughput": 334.081, "synch_weights_time_ms": 15.062}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "92003_00001", "date": "2024-08-03_04-31-27", "timestamp": 1722639687, "time_this_iter_s": 14.222033739089966, "time_total_s": 340.2705326080322, "pid": 479117, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b580ebb50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 340.2705326080322, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 12.535, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 221.40601216157276, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.7396898324290913, "policy_loss": -0.015186312615696806, "vf_loss": 3.7502325353523096, "vf_explained_var": 0.98918759804219, "kl": 0.01596170824826309, "entropy": 1.4490449945131938, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -0.4327053036267988, "episode_reward_min": -1358.396530393522, "episode_reward_mean": -731.5012929391341, "episode_len_mean": 141.08, "episode_media": {}, "episodes_timesteps_total": 14108, "policy_reward_min": {"policy_0": -1358.396530393522}, "policy_reward_max": {"policy_0": -0.4327053036267988}, "policy_reward_mean": {"policy_0": -731.5012929391341}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1049.5462159644726, -338.87689191542086, -940.7323532079528, -1232.9992838379724, -836.6392260042326, -765.3982411636308, -1104.7680934081252, -704.6810977336035, -942.1457166387323, -442.62492356847775, -1274.157965035881, -656.9941443354905, -584.4451179523327, -1085.7455561926688, -823.8054621206062, -450.2922144630079, -850.1268229614786, -870.2195894727276, -916.8589565348705, -782.6882944403499, -1264.5355628725042, -307.46977663768286, -647.5190833428352, -845.0786250106843, -471.59936156434577, -945.8601555646308, -280.7157433997584, -393.1938910431419, -1011.0962360278453, -204.25043905128823, -540.2672980022037, -322.3196778597892, -539.5854065371734, -283.8581415866972, -423.36559094164255, -0.4327053036267988, -877.1207442979343, -422.0013005494952, -462.2996868353408, -776.156716501622, -1001.7780670457956, -868.1012732790648, -329.75258694160465, -811.72654405282, -1020.261903921065, -1097.5624479365586, -647.5574486663954, -137.3302752169592, -737.6638812723561, -602.6933281531346, -1051.5442833479808, -275.8953707640231, -450.49579648648347, -719.9114558541123, -420.6638563460147, -905.1635438811173, -899.398660888949, -1194.096344891508, -846.6963376110751, -756.8251180466788, -523.6867174541435, -1059.3319192577626, -744.5571432236655, -568.0884188562688, -1078.7802151885276, -29.263883026720322, -804.9653611748936, -1210.350532497095, -417.4280694129703, -1000.3397879371795, -746.4669097074915, -761.0686263092769, -773.5158601759784, -1031.181870340564, -695.5681325588271, -114.60156994227755, -651.5934783326462, -921.1805411521958, -254.72569202005258, -975.9167823737938, -972.0195650511897, -997.8211437272827, -586.373659943309, -888.0745862520738, -454.931106191515, -350.12554268987407, -1154.0986374779463, -272.899904112705, -424.9049728593952, -1358.396530393522, -977.6364720513893, -1230.8324221215269, -1194.320733190418, -810.5201344839527, -824.2757446742283, -751.2539114767767, -983.1485882024112, -922.1728192329681, -741.0117932354749, -445.10868111715934], "episode_lengths": [150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 150, 89, 150, 150, 150, 150, 88, 150, 150, 98, 150, 143, 150, 122, 150, 40, 150, 111, 150, 150, 150, 150, 96, 150, 150, 150, 150, 88, 150, 150, 150, 116, 131, 150, 121, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 36, 150, 150, 136, 150, 150, 150, 150, 150, 150, 72, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 133, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1049.5462159644726, -338.87689191542086, -940.7323532079528, -1232.9992838379724, -836.6392260042326, -765.3982411636308, -1104.7680934081252, -704.6810977336035, -942.1457166387323, -442.62492356847775, -1274.157965035881, -656.9941443354905, -584.4451179523327, -1085.7455561926688, -823.8054621206062, -450.2922144630079, -850.1268229614786, -870.2195894727276, -916.8589565348705, -782.6882944403499, -1264.5355628725042, -307.46977663768286, -647.5190833428352, -845.0786250106843, -471.59936156434577, -945.8601555646308, -280.7157433997584, -393.1938910431419, -1011.0962360278453, -204.25043905128823, -540.2672980022037, -322.3196778597892, -539.5854065371734, -283.8581415866972, -423.36559094164255, -0.4327053036267988, -877.1207442979343, -422.0013005494952, -462.2996868353408, -776.156716501622, -1001.7780670457956, -868.1012732790648, -329.75258694160465, -811.72654405282, -1020.261903921065, -1097.5624479365586, -647.5574486663954, -137.3302752169592, -737.6638812723561, -602.6933281531346, -1051.5442833479808, -275.8953707640231, -450.49579648648347, -719.9114558541123, -420.6638563460147, -905.1635438811173, -899.398660888949, -1194.096344891508, -846.6963376110751, -756.8251180466788, -523.6867174541435, -1059.3319192577626, -744.5571432236655, -568.0884188562688, -1078.7802151885276, -29.263883026720322, -804.9653611748936, -1210.350532497095, -417.4280694129703, -1000.3397879371795, -746.4669097074915, -761.0686263092769, -773.5158601759784, -1031.181870340564, -695.5681325588271, -114.60156994227755, -651.5934783326462, -921.1805411521958, -254.72569202005258, -975.9167823737938, -972.0195650511897, -997.8211437272827, -586.373659943309, -888.0745862520738, -454.931106191515, -350.12554268987407, -1154.0986374779463, -272.899904112705, -424.9049728593952, -1358.396530393522, -977.6364720513893, -1230.8324221215269, -1194.320733190418, -810.5201344839527, -824.2757446742283, -751.2539114767767, -983.1485882024112, -922.1728192329681, -741.0117932354749, -445.10868111715934]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31767159068837164, "mean_inference_ms": 1.0039235719071373, "mean_action_processing_ms": 0.1736651388057176, "mean_env_wait_ms": 1.7266429801752217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005394935607910156, "StateBufferConnector_ms": 0.004120588302612305, "ViewRequirementAgentConnector_ms": 0.09935545921325684}, "num_episodes": 29, "episode_return_max": -0.4327053036267988, "episode_return_min": -1358.396530393522, "episode_return_mean": -731.5012929391341, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 280.84360737822584, "num_env_steps_trained_throughput_per_sec": 280.84360737822584, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 14581.162, "restore_workers_time_ms": 0.021, "training_step_time_ms": 14581.1, "sample_time_ms": 2538.527, "learn_time_ms": 12026.597, "learn_throughput": 332.596, "synch_weights_time_ms": 15.247}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "92003_00001", "date": "2024-08-03_04-31-42", "timestamp": 1722639702, "time_this_iter_s": 14.249537706375122, "time_total_s": 354.52007031440735, "pid": 479117, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b580eb250>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 354.52007031440735, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 12.639999999999997, "ram_util_percent": 16.195}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 207.44956363836926, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.559015368546049, "policy_loss": -0.011289838883870591, "vf_loss": 3.5654065159459907, "vf_explained_var": 0.9873331888889273, "kl": 0.016719618759422423, "entropy": 1.171926635565857, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -0.4327053036267988, "episode_reward_min": -1358.396530393522, "episode_reward_mean": -708.9881722791413, "episode_len_mean": 140.13, "episode_media": {}, "episodes_timesteps_total": 14013, "policy_reward_min": {"policy_0": -1358.396530393522}, "policy_reward_max": {"policy_0": -0.4327053036267988}, "policy_reward_mean": {"policy_0": -708.9881722791413}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011.0962360278453, -204.25043905128823, -540.2672980022037, -322.3196778597892, -539.5854065371734, -283.8581415866972, -423.36559094164255, -0.4327053036267988, -877.1207442979343, -422.0013005494952, -462.2996868353408, -776.156716501622, -1001.7780670457956, -868.1012732790648, -329.75258694160465, -811.72654405282, -1020.261903921065, -1097.5624479365586, -647.5574486663954, -137.3302752169592, -737.6638812723561, -602.6933281531346, -1051.5442833479808, -275.8953707640231, -450.49579648648347, -719.9114558541123, -420.6638563460147, -905.1635438811173, -899.398660888949, -1194.096344891508, -846.6963376110751, -756.8251180466788, -523.6867174541435, -1059.3319192577626, -744.5571432236655, -568.0884188562688, -1078.7802151885276, -29.263883026720322, -804.9653611748936, -1210.350532497095, -417.4280694129703, -1000.3397879371795, -746.4669097074915, -761.0686263092769, -773.5158601759784, -1031.181870340564, -695.5681325588271, -114.60156994227755, -651.5934783326462, -921.1805411521958, -254.72569202005258, -975.9167823737938, -972.0195650511897, -997.8211437272827, -586.373659943309, -888.0745862520738, -454.931106191515, -350.12554268987407, -1154.0986374779463, -272.899904112705, -424.9049728593952, -1358.396530393522, -977.6364720513893, -1230.8324221215269, -1194.320733190418, -810.5201344839527, -824.2757446742283, -751.2539114767767, -983.1485882024112, -922.1728192329681, -741.0117932354749, -445.10868111715934, -143.28165427880893, -1096.8787300378242, -1237.5376999861965, -795.3771284848066, -906.1683883277942, -544.1927007686324, -993.2444332127703, -636.8790433613219, -750.0785576628839, -1135.2095892005605, -555.071896772927, -805.8808540795986, -162.0800034204856, -126.18269163763789, -899.938794868216, -613.0716940830979, -769.8996950002341, -759.7851257509282, -482.92317951187556, -607.331442520852, -984.4490221062695, -608.2105536180193, -758.8360730621805, -645.112257822535, -761.6253165732766, -369.9032232218512, -494.90059759392744, -914.3559534228251], "episode_lengths": [150, 98, 150, 143, 150, 122, 150, 40, 150, 111, 150, 150, 150, 150, 96, 150, 150, 150, 150, 88, 150, 150, 150, 116, 131, 150, 121, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 36, 150, 150, 136, 150, 150, 150, 150, 150, 150, 72, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 133, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 84, 87, 150, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150, 112, 122, 150], "policy_policy_0_reward": [-1011.0962360278453, -204.25043905128823, -540.2672980022037, -322.3196778597892, -539.5854065371734, -283.8581415866972, -423.36559094164255, -0.4327053036267988, -877.1207442979343, -422.0013005494952, -462.2996868353408, -776.156716501622, -1001.7780670457956, -868.1012732790648, -329.75258694160465, -811.72654405282, -1020.261903921065, -1097.5624479365586, -647.5574486663954, -137.3302752169592, -737.6638812723561, -602.6933281531346, -1051.5442833479808, -275.8953707640231, -450.49579648648347, -719.9114558541123, -420.6638563460147, -905.1635438811173, -899.398660888949, -1194.096344891508, -846.6963376110751, -756.8251180466788, -523.6867174541435, -1059.3319192577626, -744.5571432236655, -568.0884188562688, -1078.7802151885276, -29.263883026720322, -804.9653611748936, -1210.350532497095, -417.4280694129703, -1000.3397879371795, -746.4669097074915, -761.0686263092769, -773.5158601759784, -1031.181870340564, -695.5681325588271, -114.60156994227755, -651.5934783326462, -921.1805411521958, -254.72569202005258, -975.9167823737938, -972.0195650511897, -997.8211437272827, -586.373659943309, -888.0745862520738, -454.931106191515, -350.12554268987407, -1154.0986374779463, -272.899904112705, -424.9049728593952, -1358.396530393522, -977.6364720513893, -1230.8324221215269, -1194.320733190418, -810.5201344839527, -824.2757446742283, -751.2539114767767, -983.1485882024112, -922.1728192329681, -741.0117932354749, -445.10868111715934, -143.28165427880893, -1096.8787300378242, -1237.5376999861965, -795.3771284848066, -906.1683883277942, -544.1927007686324, -993.2444332127703, -636.8790433613219, -750.0785576628839, -1135.2095892005605, -555.071896772927, -805.8808540795986, -162.0800034204856, -126.18269163763789, -899.938794868216, -613.0716940830979, -769.8996950002341, -759.7851257509282, -482.92317951187556, -607.331442520852, -984.4490221062695, -608.2105536180193, -758.8360730621805, -645.112257822535, -761.6253165732766, -369.9032232218512, -494.90059759392744, -914.3559534228251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3161811668582706, "mean_inference_ms": 0.9985687132498545, "mean_action_processing_ms": 0.17296029173834665, "mean_env_wait_ms": 1.7200423742769533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00520014762878418, "StateBufferConnector_ms": 0.0039882659912109375, "ViewRequirementAgentConnector_ms": 0.09572339057922363}, "num_episodes": 28, "episode_return_max": -0.4327053036267988, "episode_return_min": -1358.396530393522, "episode_return_mean": -708.9881722791413, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 282.83914584992635, "num_env_steps_trained_throughput_per_sec": 282.83914584992635, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 14306.104, "restore_workers_time_ms": 0.021, "training_step_time_ms": 14306.043, "sample_time_ms": 2343.567, "learn_time_ms": 11946.991, "learn_throughput": 334.812, "synch_weights_time_ms": 14.756}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "92003_00001", "date": "2024-08-03_04-31-56", "timestamp": 1722639716, "time_this_iter_s": 14.151220321655273, "time_total_s": 368.6712906360626, "pid": 479117, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b580e9360>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 368.6712906360626, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 12.565, "ram_util_percent": 16.199999999999996}}
